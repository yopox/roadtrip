(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(i){if(i.ep)return;i.ep=!0;const a=r(i);fetch(i.href,a)}})();var Jk=typeof globalThis<"u"?globalThis:typeof window<"u"||typeof window<"u"?window:typeof self<"u"?self:{};function Uu(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Xk={exports:{}},K0={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var LK=Symbol.for("react.transitional.element"),BK=Symbol.for("react.fragment");function Qk(t,e,r){var n=null;if(r!==void 0&&(n=""+r),e.key!==void 0&&(n=""+e.key),"key"in e){r={};for(var i in e)i!=="key"&&(r[i]=e[i])}else r=e;return e=r.ref,{$$typeof:LK,type:t,key:n,ref:e!==void 0?e:null,props:r}}K0.Fragment=BK;K0.jsx=Qk;K0.jsxs=Qk;Xk.exports=K0;var O=Xk.exports,e5={exports:{}};function t5(){throw new Error("setTimeout has not been defined")}function r5(){throw new Error("clearTimeout has not been defined")}var bs=t5,_s=r5;typeof window.setTimeout=="function"&&(bs=setTimeout);typeof window.clearTimeout=="function"&&(_s=clearTimeout);function n5(t){if(bs===setTimeout)return setTimeout(t,0);if((bs===t5||!bs)&&setTimeout)return bs=setTimeout,setTimeout(t,0);try{return bs(t,0)}catch{try{return bs.call(null,t,0)}catch{return bs.call(this,t,0)}}}function NK(t){if(_s===clearTimeout)return clearTimeout(t);if((_s===r5||!_s)&&clearTimeout)return _s=clearTimeout,clearTimeout(t);try{return _s(t)}catch{try{return _s.call(null,t)}catch{return _s.call(this,t)}}}var Ao=[],ed=!1,eu,Eg=-1;function UK(){!ed||!eu||(ed=!1,eu.length?Ao=eu.concat(Ao):Eg=-1,Ao.length&&i5())}function i5(){if(!ed){var t=n5(UK);ed=!0;for(var e=Ao.length;e;){for(eu=Ao,Ao=[];++Eg<e;)eu&&eu[Eg].run();Eg=-1,e=Ao.length}eu=null,ed=!1,NK(t)}}function FK(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];Ao.push(new a5(t,e)),Ao.length===1&&!ed&&n5(i5)}function a5(t,e){this.fun=t,this.array=e}a5.prototype.run=function(){this.fun.apply(null,this.array)};var jK="browser",VK="browser",zK=!0,KK={},HK=[],WK="",GK={},qK={},ZK={};function Fu(){}var YK=Fu,JK=Fu,XK=Fu,QK=Fu,eH=Fu,tH=Fu,rH=Fu;function nH(t){throw new Error("process.binding is not supported")}function iH(){return"/"}function aH(t){throw new Error("process.chdir is not supported")}function oH(){return 0}var Dc=window.performance||{},sH=Dc.now||Dc.mozNow||Dc.msNow||Dc.oNow||Dc.webkitNow||function(){return new Date().getTime()};function lH(t){var e=sH.call(Dc)*.001,r=Math.floor(e),n=Math.floor(e%1*1e9);return t&&(r=r-t[0],n=n-t[1],n<0&&(r--,n+=1e9)),[r,n]}var uH=new Date;function cH(){var t=new Date,e=t-uH;return e/1e3}var yi={nextTick:FK,title:jK,browser:zK,env:KK,argv:HK,version:WK,versions:GK,on:YK,addListener:JK,once:XK,off:QK,removeListener:eH,removeAllListeners:tH,emit:rH,binding:nH,cwd:iH,chdir:aH,umask:oH,hrtime:lH,platform:VK,release:qK,config:ZK,uptime:cH},ht={},pC=Symbol.for("react.transitional.element"),dH=Symbol.for("react.portal"),fH=Symbol.for("react.fragment"),hH=Symbol.for("react.strict_mode"),pH=Symbol.for("react.profiler"),mH=Symbol.for("react.consumer"),vH=Symbol.for("react.context"),gH=Symbol.for("react.forward_ref"),yH=Symbol.for("react.suspense"),bH=Symbol.for("react.memo"),o5=Symbol.for("react.lazy"),mD=Symbol.iterator;function _H(t){return t===null||typeof t!="object"?null:(t=mD&&t[mD]||t["@@iterator"],typeof t=="function"?t:null)}var s5={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},l5=Object.assign,u5={};function uf(t,e,r){this.props=t,this.context=e,this.refs=u5,this.updater=r||s5}uf.prototype.isReactComponent={};uf.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};uf.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function c5(){}c5.prototype=uf.prototype;function mC(t,e,r){this.props=t,this.context=e,this.refs=u5,this.updater=r||s5}var vC=mC.prototype=new c5;vC.constructor=mC;l5(vC,uf.prototype);vC.isPureReactComponent=!0;var vD=Array.isArray,cr={H:null,A:null,T:null,S:null,V:null},d5=Object.prototype.hasOwnProperty;function gC(t,e,r,n,i,a){return r=a.ref,{$$typeof:pC,type:t,key:e,ref:r!==void 0?r:null,props:a}}function SH(t,e){return gC(t.type,e,void 0,void 0,void 0,t.props)}function yC(t){return typeof t=="object"&&t!==null&&t.$$typeof===pC}function wH(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var gD=/\/+/g;function U_(t,e){return typeof t=="object"&&t!==null&&t.key!=null?wH(""+t.key):e.toString(36)}function yD(){}function EH(t){switch(t.status){case"fulfilled":return t.value;case"rejected":throw t.reason;default:switch(typeof t.status=="string"?t.then(yD,yD):(t.status="pending",t.then(function(e){t.status==="pending"&&(t.status="fulfilled",t.value=e)},function(e){t.status==="pending"&&(t.status="rejected",t.reason=e)})),t.status){case"fulfilled":return t.value;case"rejected":throw t.reason}}throw t}function Rc(t,e,r,n,i){var a=typeof t;(a==="undefined"||a==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(a){case"bigint":case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case pC:case dH:o=!0;break;case o5:return o=t._init,Rc(o(t._payload),e,r,n,i)}}if(o)return i=i(t),o=n===""?"."+U_(t,0):n,vD(i)?(r="",o!=null&&(r=o.replace(gD,"$&/")+"/"),Rc(i,e,r,"",function(c){return c})):i!=null&&(yC(i)&&(i=SH(i,r+(i.key==null||t&&t.key===i.key?"":(""+i.key).replace(gD,"$&/")+"/")+o)),e.push(i)),1;o=0;var s=n===""?".":n+":";if(vD(t))for(var l=0;l<t.length;l++)n=t[l],a=s+U_(n,l),o+=Rc(n,e,r,a,i);else if(l=_H(t),typeof l=="function")for(t=l.call(t),l=0;!(n=t.next()).done;)n=n.value,a=s+U_(n,l++),o+=Rc(n,e,r,a,i);else if(a==="object"){if(typeof t.then=="function")return Rc(EH(t),e,r,n,i);throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.")}return o}function Dv(t,e,r){if(t==null)return t;var n=[],i=0;return Rc(t,n,"","",function(a){return e.call(r,a,i++)}),n}function xH(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var bD=typeof reportError=="function"?reportError:function(t){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var e=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof t=="object"&&t!==null&&typeof t.message=="string"?String(t.message):String(t),error:t});if(!window.dispatchEvent(e))return}else if(typeof yi=="object"&&typeof yi.emit=="function"){yi.emit("uncaughtException",t);return}console.error(t)};function CH(){}ht.Children={map:Dv,forEach:function(t,e,r){Dv(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return Dv(t,function(){e++}),e},toArray:function(t){return Dv(t,function(e){return e})||[]},only:function(t){if(!yC(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};ht.Component=uf;ht.Fragment=fH;ht.Profiler=pH;ht.PureComponent=mC;ht.StrictMode=hH;ht.Suspense=yH;ht.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=cr;ht.__COMPILER_RUNTIME={__proto__:null,c:function(t){return cr.H.useMemoCache(t)}};ht.cache=function(t){return function(){return t.apply(null,arguments)}};ht.cloneElement=function(t,e,r){if(t==null)throw Error("The argument must be a React element, but you passed "+t+".");var n=l5({},t.props),i=t.key,a=void 0;if(e!=null)for(o in e.ref!==void 0&&(a=void 0),e.key!==void 0&&(i=""+e.key),e)!d5.call(e,o)||o==="key"||o==="__self"||o==="__source"||o==="ref"&&e.ref===void 0||(n[o]=e[o]);var o=arguments.length-2;if(o===1)n.children=r;else if(1<o){for(var s=Array(o),l=0;l<o;l++)s[l]=arguments[l+2];n.children=s}return gC(t.type,i,void 0,void 0,a,n)};ht.createContext=function(t){return t={$$typeof:vH,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null},t.Provider=t,t.Consumer={$$typeof:mH,_context:t},t};ht.createElement=function(t,e,r){var n,i={},a=null;if(e!=null)for(n in e.key!==void 0&&(a=""+e.key),e)d5.call(e,n)&&n!=="key"&&n!=="__self"&&n!=="__source"&&(i[n]=e[n]);var o=arguments.length-2;if(o===1)i.children=r;else if(1<o){for(var s=Array(o),l=0;l<o;l++)s[l]=arguments[l+2];i.children=s}if(t&&t.defaultProps)for(n in o=t.defaultProps,o)i[n]===void 0&&(i[n]=o[n]);return gC(t,a,void 0,void 0,null,i)};ht.createRef=function(){return{current:null}};ht.forwardRef=function(t){return{$$typeof:gH,render:t}};ht.isValidElement=yC;ht.lazy=function(t){return{$$typeof:o5,_payload:{_status:-1,_result:t},_init:xH}};ht.memo=function(t,e){return{$$typeof:bH,type:t,compare:e===void 0?null:e}};ht.startTransition=function(t){var e=cr.T,r={};cr.T=r;try{var n=t(),i=cr.S;i!==null&&i(r,n),typeof n=="object"&&n!==null&&typeof n.then=="function"&&n.then(CH,bD)}catch(a){bD(a)}finally{cr.T=e}};ht.unstable_useCacheRefresh=function(){return cr.H.useCacheRefresh()};ht.use=function(t){return cr.H.use(t)};ht.useActionState=function(t,e,r){return cr.H.useActionState(t,e,r)};ht.useCallback=function(t,e){return cr.H.useCallback(t,e)};ht.useContext=function(t){return cr.H.useContext(t)};ht.useDebugValue=function(){};ht.useDeferredValue=function(t,e){return cr.H.useDeferredValue(t,e)};ht.useEffect=function(t,e,r){var n=cr.H;if(typeof r=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return n.useEffect(t,e)};ht.useId=function(){return cr.H.useId()};ht.useImperativeHandle=function(t,e,r){return cr.H.useImperativeHandle(t,e,r)};ht.useInsertionEffect=function(t,e){return cr.H.useInsertionEffect(t,e)};ht.useLayoutEffect=function(t,e){return cr.H.useLayoutEffect(t,e)};ht.useMemo=function(t,e){return cr.H.useMemo(t,e)};ht.useOptimistic=function(t,e){return cr.H.useOptimistic(t,e)};ht.useReducer=function(t,e,r){return cr.H.useReducer(t,e,r)};ht.useRef=function(t){return cr.H.useRef(t)};ht.useState=function(t){return cr.H.useState(t)};ht.useSyncExternalStore=function(t,e,r){return cr.H.useSyncExternalStore(t,e,r)};ht.useTransition=function(){return cr.H.useTransition()};ht.version="19.1.0";e5.exports=ht;var D=e5.exports;const We=Uu(D);var f5={exports:{}},H0={},h5={exports:{}},p5={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(Z,te){var H=Z.length;Z.push(te);e:for(;0<H;){var fe=H-1>>>1,ne=Z[fe];if(0<i(ne,te))Z[fe]=te,Z[H]=ne,H=fe;else break e}}function r(Z){return Z.length===0?null:Z[0]}function n(Z){if(Z.length===0)return null;var te=Z[0],H=Z.pop();if(H!==te){Z[0]=H;e:for(var fe=0,ne=Z.length,he=ne>>>1;fe<he;){var oe=2*(fe+1)-1,me=Z[oe],ee=oe+1,Y=Z[ee];if(0>i(me,H))ee<ne&&0>i(Y,me)?(Z[fe]=Y,Z[ee]=H,fe=ee):(Z[fe]=me,Z[oe]=H,fe=oe);else if(ee<ne&&0>i(Y,H))Z[fe]=Y,Z[ee]=H,fe=ee;else break e}}return te}function i(Z,te){var H=Z.sortIndex-te.sortIndex;return H!==0?H:Z.id-te.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var a=performance;t.unstable_now=function(){return a.now()}}else{var o=Date,s=o.now();t.unstable_now=function(){return o.now()-s}}var l=[],c=[],d=1,h=null,p=3,m=!1,g=!1,y=!1,R=!1,b=typeof setTimeout=="function"?setTimeout:null,_=typeof clearTimeout=="function"?clearTimeout:null,x=typeof setImmediate<"u"?setImmediate:null;function T(Z){for(var te=r(c);te!==null;){if(te.callback===null)n(c);else if(te.startTime<=Z)n(c),te.sortIndex=te.expirationTime,e(l,te);else break;te=r(c)}}function I(Z){if(y=!1,T(Z),!g)if(r(l)!==null)g=!0,C||(C=!0,J());else{var te=r(c);te!==null&&ie(I,te.startTime-Z)}}var C=!1,k=-1,S=5,V=-1;function z(){return R?!0:!(t.unstable_now()-V<S)}function j(){if(R=!1,C){var Z=t.unstable_now();V=Z;var te=!0;try{e:{g=!1,y&&(y=!1,_(k),k=-1),m=!0;var H=p;try{t:{for(T(Z),h=r(l);h!==null&&!(h.expirationTime>Z&&z());){var fe=h.callback;if(typeof fe=="function"){h.callback=null,p=h.priorityLevel;var ne=fe(h.expirationTime<=Z);if(Z=t.unstable_now(),typeof ne=="function"){h.callback=ne,T(Z),te=!0;break t}h===r(l)&&n(l),T(Z)}else n(l);h=r(l)}if(h!==null)te=!0;else{var he=r(c);he!==null&&ie(I,he.startTime-Z),te=!1}}break e}finally{h=null,p=H,m=!1}te=void 0}}finally{te?J():C=!1}}}var J;if(typeof x=="function")J=function(){x(j)};else if(typeof MessageChannel<"u"){var $=new MessageChannel,le=$.port2;$.port1.onmessage=j,J=function(){le.postMessage(null)}}else J=function(){b(j,0)};function ie(Z,te){k=b(function(){Z(t.unstable_now())},te)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(Z){Z.callback=null},t.unstable_forceFrameRate=function(Z){0>Z||125<Z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):S=0<Z?Math.floor(1e3/Z):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_next=function(Z){switch(p){case 1:case 2:case 3:var te=3;break;default:te=p}var H=p;p=te;try{return Z()}finally{p=H}},t.unstable_requestPaint=function(){R=!0},t.unstable_runWithPriority=function(Z,te){switch(Z){case 1:case 2:case 3:case 4:case 5:break;default:Z=3}var H=p;p=Z;try{return te()}finally{p=H}},t.unstable_scheduleCallback=function(Z,te,H){var fe=t.unstable_now();switch(typeof H=="object"&&H!==null?(H=H.delay,H=typeof H=="number"&&0<H?fe+H:fe):H=fe,Z){case 1:var ne=-1;break;case 2:ne=250;break;case 5:ne=1073741823;break;case 4:ne=1e4;break;default:ne=5e3}return ne=H+ne,Z={id:d++,callback:te,priorityLevel:Z,startTime:H,expirationTime:ne,sortIndex:-1},H>fe?(Z.sortIndex=H,e(c,Z),r(l)===null&&Z===r(c)&&(y?(_(k),k=-1):y=!0,ie(I,H-fe))):(Z.sortIndex=ne,e(l,Z),g||m||(g=!0,C||(C=!0,J()))),Z},t.unstable_shouldYield=z,t.unstable_wrapCallback=function(Z){var te=p;return function(){var H=p;p=te;try{return Z.apply(this,arguments)}finally{p=H}}}})(p5);h5.exports=p5;var TH=h5.exports,m5={exports:{}},Un={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var DH=D;function v5(t){var e="https://react.dev/errors/"+t;if(1<arguments.length){e+="?args[]="+encodeURIComponent(arguments[1]);for(var r=2;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r])}return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function fs(){}var On={d:{f:fs,r:function(){throw Error(v5(522))},D:fs,C:fs,L:fs,m:fs,X:fs,S:fs,M:fs},p:0,findDOMNode:null},RH=Symbol.for("react.portal");function MH(t,e,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:RH,key:n==null?null:""+n,children:t,containerInfo:e,implementation:r}}var jh=DH.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function W0(t,e){if(t==="font")return"";if(typeof e=="string")return e==="use-credentials"?e:""}Un.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=On;Un.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)throw Error(v5(299));return MH(t,e,null,r)};Un.flushSync=function(t){var e=jh.T,r=On.p;try{if(jh.T=null,On.p=2,t)return t()}finally{jh.T=e,On.p=r,On.d.f()}};Un.preconnect=function(t,e){typeof t=="string"&&(e?(e=e.crossOrigin,e=typeof e=="string"?e==="use-credentials"?e:"":void 0):e=null,On.d.C(t,e))};Un.prefetchDNS=function(t){typeof t=="string"&&On.d.D(t)};Un.preinit=function(t,e){if(typeof t=="string"&&e&&typeof e.as=="string"){var r=e.as,n=W0(r,e.crossOrigin),i=typeof e.integrity=="string"?e.integrity:void 0,a=typeof e.fetchPriority=="string"?e.fetchPriority:void 0;r==="style"?On.d.S(t,typeof e.precedence=="string"?e.precedence:void 0,{crossOrigin:n,integrity:i,fetchPriority:a}):r==="script"&&On.d.X(t,{crossOrigin:n,integrity:i,fetchPriority:a,nonce:typeof e.nonce=="string"?e.nonce:void 0})}};Un.preinitModule=function(t,e){if(typeof t=="string")if(typeof e=="object"&&e!==null){if(e.as==null||e.as==="script"){var r=W0(e.as,e.crossOrigin);On.d.M(t,{crossOrigin:r,integrity:typeof e.integrity=="string"?e.integrity:void 0,nonce:typeof e.nonce=="string"?e.nonce:void 0})}}else e==null&&On.d.M(t)};Un.preload=function(t,e){if(typeof t=="string"&&typeof e=="object"&&e!==null&&typeof e.as=="string"){var r=e.as,n=W0(r,e.crossOrigin);On.d.L(t,r,{crossOrigin:n,integrity:typeof e.integrity=="string"?e.integrity:void 0,nonce:typeof e.nonce=="string"?e.nonce:void 0,type:typeof e.type=="string"?e.type:void 0,fetchPriority:typeof e.fetchPriority=="string"?e.fetchPriority:void 0,referrerPolicy:typeof e.referrerPolicy=="string"?e.referrerPolicy:void 0,imageSrcSet:typeof e.imageSrcSet=="string"?e.imageSrcSet:void 0,imageSizes:typeof e.imageSizes=="string"?e.imageSizes:void 0,media:typeof e.media=="string"?e.media:void 0})}};Un.preloadModule=function(t,e){if(typeof t=="string")if(e){var r=W0(e.as,e.crossOrigin);On.d.m(t,{as:typeof e.as=="string"&&e.as!=="script"?e.as:void 0,crossOrigin:r,integrity:typeof e.integrity=="string"?e.integrity:void 0})}else On.d.m(t)};Un.requestFormReset=function(t){On.d.r(t)};Un.unstable_batchedUpdates=function(t,e){return t(e)};Un.useFormState=function(t,e,r){return jh.H.useFormState(t,e,r)};Un.useFormStatus=function(){return jh.H.useHostTransitionStatus()};Un.version="19.1.0";function g5(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(g5)}catch(t){console.error(t)}}g5(),m5.exports=Un;var G0=m5.exports;const IH=Uu(G0);/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Hr=TH,y5=D,PH=G0;function De(t){var e="https://react.dev/errors/"+t;if(1<arguments.length){e+="?args[]="+encodeURIComponent(arguments[1]);for(var r=2;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r])}return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function b5(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function hm(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function _5(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function _D(t){if(hm(t)!==t)throw Error(De(188))}function AH(t){var e=t.alternate;if(!e){if(e=hm(t),e===null)throw Error(De(188));return e!==t?null:t}for(var r=t,n=e;;){var i=r.return;if(i===null)break;var a=i.alternate;if(a===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===a.child){for(a=i.child;a;){if(a===r)return _D(i),t;if(a===n)return _D(i),e;a=a.sibling}throw Error(De(188))}if(r.return!==n.return)r=i,n=a;else{for(var o=!1,s=i.child;s;){if(s===r){o=!0,r=i,n=a;break}if(s===n){o=!0,n=i,r=a;break}s=s.sibling}if(!o){for(s=a.child;s;){if(s===r){o=!0,r=a,n=i;break}if(s===n){o=!0,n=a,r=i;break}s=s.sibling}if(!o)throw Error(De(189))}}if(r.alternate!==n)throw Error(De(190))}if(r.tag!==3)throw Error(De(188));return r.stateNode.current===r?t:e}function S5(t){var e=t.tag;if(e===5||e===26||e===27||e===6)return t;for(t=t.child;t!==null;){if(e=S5(t),e!==null)return e;t=t.sibling}return null}var tr=Object.assign,kH=Symbol.for("react.element"),Rv=Symbol.for("react.transitional.element"),xh=Symbol.for("react.portal"),Bc=Symbol.for("react.fragment"),w5=Symbol.for("react.strict_mode"),Hw=Symbol.for("react.profiler"),OH=Symbol.for("react.provider"),E5=Symbol.for("react.consumer"),ko=Symbol.for("react.context"),bC=Symbol.for("react.forward_ref"),Ww=Symbol.for("react.suspense"),Gw=Symbol.for("react.suspense_list"),_C=Symbol.for("react.memo"),Ms=Symbol.for("react.lazy"),qw=Symbol.for("react.activity"),$H=Symbol.for("react.memo_cache_sentinel"),SD=Symbol.iterator;function Yf(t){return t===null||typeof t!="object"?null:(t=SD&&t[SD]||t["@@iterator"],typeof t=="function"?t:null)}var LH=Symbol.for("react.client.reference");function Zw(t){if(t==null)return null;if(typeof t=="function")return t.$$typeof===LH?null:t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Bc:return"Fragment";case Hw:return"Profiler";case w5:return"StrictMode";case Ww:return"Suspense";case Gw:return"SuspenseList";case qw:return"Activity"}if(typeof t=="object")switch(t.$$typeof){case xh:return"Portal";case ko:return(t.displayName||"Context")+".Provider";case E5:return(t._context.displayName||"Context")+".Consumer";case bC:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case _C:return e=t.displayName||null,e!==null?e:Zw(t.type)||"Memo";case Ms:e=t._payload,t=t._init;try{return Zw(t(e))}catch{}}return null}var Ch=Array.isArray,Qe=y5.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,$t=PH.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,uu={pending:!1,data:null,method:null,action:null},Yw=[],Nc=-1;function uo(t){return{current:t}}function on(t){0>Nc||(t.current=Yw[Nc],Yw[Nc]=null,Nc--)}function dr(t,e){Nc++,Yw[Nc]=t.current,t.current=e}var Ja=uo(null),gp=uo(null),Zs=uo(null),fy=uo(null);function hy(t,e){switch(dr(Zs,e),dr(gp,t),dr(Ja,null),e.nodeType){case 9:case 11:t=(t=e.documentElement)&&(t=t.namespaceURI)?TR(t):0;break;default:if(t=e.tagName,e=e.namespaceURI)e=TR(e),t=F$(e,t);else switch(t){case"svg":t=1;break;case"math":t=2;break;default:t=0}}on(Ja),dr(Ja,t)}function Id(){on(Ja),on(gp),on(Zs)}function Jw(t){t.memoizedState!==null&&dr(fy,t);var e=Ja.current,r=F$(e,t.type);e!==r&&(dr(gp,t),dr(Ja,r))}function py(t){gp.current===t&&(on(Ja),on(gp)),fy.current===t&&(on(fy),Dp._currentValue=uu)}var Xw=Object.prototype.hasOwnProperty,SC=Hr.unstable_scheduleCallback,F_=Hr.unstable_cancelCallback,BH=Hr.unstable_shouldYield,NH=Hr.unstable_requestPaint,Xa=Hr.unstable_now,UH=Hr.unstable_getCurrentPriorityLevel,x5=Hr.unstable_ImmediatePriority,C5=Hr.unstable_UserBlockingPriority,my=Hr.unstable_NormalPriority,FH=Hr.unstable_LowPriority,T5=Hr.unstable_IdlePriority,jH=Hr.log,VH=Hr.unstable_setDisableYieldValue,pm=null,wi=null;function Us(t){if(typeof jH=="function"&&VH(t),wi&&typeof wi.setStrictMode=="function")try{wi.setStrictMode(pm,t)}catch{}}var Ei=Math.clz32?Math.clz32:HH,zH=Math.log,KH=Math.LN2;function HH(t){return t>>>=0,t===0?32:31-(zH(t)/KH|0)|0}var Mv=256,Iv=4194304;function zl(t){var e=t&42;if(e!==0)return e;switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return t&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return t}}function q0(t,e,r){var n=t.pendingLanes;if(n===0)return 0;var i=0,a=t.suspendedLanes,o=t.pingedLanes;t=t.warmLanes;var s=n&134217727;return s!==0?(n=s&~a,n!==0?i=zl(n):(o&=s,o!==0?i=zl(o):r||(r=s&~t,r!==0&&(i=zl(r))))):(s=n&~a,s!==0?i=zl(s):o!==0?i=zl(o):r||(r=n&~t,r!==0&&(i=zl(r)))),i===0?0:e!==0&&e!==i&&!(e&a)&&(a=i&-i,r=e&-e,a>=r||a===32&&(r&4194048)!==0)?e:i}function mm(t,e){return(t.pendingLanes&~(t.suspendedLanes&~t.pingedLanes)&e)===0}function WH(t,e){switch(t){case 1:case 2:case 4:case 8:case 64:return e+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function D5(){var t=Mv;return Mv<<=1,!(Mv&4194048)&&(Mv=256),t}function R5(){var t=Iv;return Iv<<=1,!(Iv&62914560)&&(Iv=4194304),t}function j_(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function vm(t,e){t.pendingLanes|=e,e!==268435456&&(t.suspendedLanes=0,t.pingedLanes=0,t.warmLanes=0)}function GH(t,e,r,n,i,a){var o=t.pendingLanes;t.pendingLanes=r,t.suspendedLanes=0,t.pingedLanes=0,t.warmLanes=0,t.expiredLanes&=r,t.entangledLanes&=r,t.errorRecoveryDisabledLanes&=r,t.shellSuspendCounter=0;var s=t.entanglements,l=t.expirationTimes,c=t.hiddenUpdates;for(r=o&~r;0<r;){var d=31-Ei(r),h=1<<d;s[d]=0,l[d]=-1;var p=c[d];if(p!==null)for(c[d]=null,d=0;d<p.length;d++){var m=p[d];m!==null&&(m.lane&=-536870913)}r&=~h}n!==0&&M5(t,n,0),a!==0&&i===0&&t.tag!==0&&(t.suspendedLanes|=a&~(o&~e))}function M5(t,e,r){t.pendingLanes|=e,t.suspendedLanes&=~e;var n=31-Ei(e);t.entangledLanes|=e,t.entanglements[n]=t.entanglements[n]|1073741824|r&4194090}function I5(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var n=31-Ei(r),i=1<<n;i&e|t[n]&e&&(t[n]|=e),r&=~i}}function wC(t){switch(t){case 2:t=1;break;case 8:t=4;break;case 32:t=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:t=128;break;case 268435456:t=134217728;break;default:t=0}return t}function EC(t){return t&=-t,2<t?8<t?t&134217727?32:268435456:8:2}function P5(){var t=$t.p;return t!==0?t:(t=window.event,t===void 0?32:Y$(t.type))}function qH(t,e){var r=$t.p;try{return $t.p=t,e()}finally{$t.p=r}}var bl=Math.random().toString(36).slice(2),En="__reactFiber$"+bl,ti="__reactProps$"+bl,cf="__reactContainer$"+bl,Qw="__reactEvents$"+bl,ZH="__reactListeners$"+bl,YH="__reactHandles$"+bl,wD="__reactResources$"+bl,gm="__reactMarker$"+bl;function xC(t){delete t[En],delete t[ti],delete t[Qw],delete t[ZH],delete t[YH]}function Uc(t){var e=t[En];if(e)return e;for(var r=t.parentNode;r;){if(e=r[cf]||r[En]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=MR(t);t!==null;){if(r=t[En])return r;t=MR(t)}return e}t=r,r=t.parentNode}return null}function df(t){if(t=t[En]||t[cf]){var e=t.tag;if(e===5||e===6||e===13||e===26||e===27||e===3)return t}return null}function Th(t){var e=t.tag;if(e===5||e===26||e===27||e===6)return t.stateNode;throw Error(De(33))}function td(t){var e=t[wD];return e||(e=t[wD]={hoistableStyles:new Map,hoistableScripts:new Map}),e}function tn(t){t[gm]=!0}var A5=new Set,k5={};function ju(t,e){Pd(t,e),Pd(t+"Capture",e)}function Pd(t,e){for(k5[t]=e,t=0;t<e.length;t++)A5.add(e[t])}var JH=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),ED={},xD={};function XH(t){return Xw.call(xD,t)?!0:Xw.call(ED,t)?!1:JH.test(t)?xD[t]=!0:(ED[t]=!0,!1)}function xg(t,e,r){if(XH(e))if(r===null)t.removeAttribute(e);else{switch(typeof r){case"undefined":case"function":case"symbol":t.removeAttribute(e);return;case"boolean":var n=e.toLowerCase().slice(0,5);if(n!=="data-"&&n!=="aria-"){t.removeAttribute(e);return}}t.setAttribute(e,""+r)}}function Pv(t,e,r){if(r===null)t.removeAttribute(e);else{switch(typeof r){case"undefined":case"function":case"symbol":case"boolean":t.removeAttribute(e);return}t.setAttribute(e,""+r)}}function bo(t,e,r,n){if(n===null)t.removeAttribute(r);else{switch(typeof n){case"undefined":case"function":case"symbol":case"boolean":t.removeAttribute(r);return}t.setAttributeNS(e,r,""+n)}}var V_,CD;function Mc(t){if(V_===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);V_=e&&e[1]||"",CD=-1<r.stack.indexOf(`
    at`)?" (<anonymous>)":-1<r.stack.indexOf("@")?"@unknown:0:0":""}return`
`+V_+t+CD}var z_=!1;function K_(t,e){if(!t||z_)return"";z_=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var n={DetermineComponentFrameRoot:function(){try{if(e){var h=function(){throw Error()};if(Object.defineProperty(h.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(h,[])}catch(m){var p=m}Reflect.construct(t,[],h)}else{try{h.call()}catch(m){p=m}t.call(h.prototype)}}else{try{throw Error()}catch(m){p=m}(h=t())&&typeof h.catch=="function"&&h.catch(function(){})}}catch(m){if(m&&p&&typeof m.stack=="string")return[m.stack,p.stack]}return[null,null]}};n.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var i=Object.getOwnPropertyDescriptor(n.DetermineComponentFrameRoot,"name");i&&i.configurable&&Object.defineProperty(n.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var a=n.DetermineComponentFrameRoot(),o=a[0],s=a[1];if(o&&s){var l=o.split(`
`),c=s.split(`
`);for(i=n=0;n<l.length&&!l[n].includes("DetermineComponentFrameRoot");)n++;for(;i<c.length&&!c[i].includes("DetermineComponentFrameRoot");)i++;if(n===l.length||i===c.length)for(n=l.length-1,i=c.length-1;1<=n&&0<=i&&l[n]!==c[i];)i--;for(;1<=n&&0<=i;n--,i--)if(l[n]!==c[i]){if(n!==1||i!==1)do if(n--,i--,0>i||l[n]!==c[i]){var d=`
`+l[n].replace(" at new "," at ");return t.displayName&&d.includes("<anonymous>")&&(d=d.replace("<anonymous>",t.displayName)),d}while(1<=n&&0<=i);break}}}finally{z_=!1,Error.prepareStackTrace=r}return(r=t?t.displayName||t.name:"")?Mc(r):""}function QH(t){switch(t.tag){case 26:case 27:case 5:return Mc(t.type);case 16:return Mc("Lazy");case 13:return Mc("Suspense");case 19:return Mc("SuspenseList");case 0:case 15:return K_(t.type,!1);case 11:return K_(t.type.render,!1);case 1:return K_(t.type,!0);case 31:return Mc("Activity");default:return""}}function TD(t){try{var e="";do e+=QH(t),t=t.return;while(t);return e}catch(r){return`
Error generating stack: `+r.message+`
`+r.stack}}function Wi(t){switch(typeof t){case"bigint":case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function O5(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function eW(t){var e=O5(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,a=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){n=""+o,a.call(this,o)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(o){n=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function vy(t){t._valueTracker||(t._valueTracker=eW(t))}function $5(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),n="";return t&&(n=O5(t)?t.checked?"true":"false":t.value),t=n,t!==r?(e.setValue(t),!0):!1}function gy(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}var tW=/[\n"\\]/g;function Yi(t){return t.replace(tW,function(e){return"\\"+e.charCodeAt(0).toString(16)+" "})}function eE(t,e,r,n,i,a,o,s){t.name="",o!=null&&typeof o!="function"&&typeof o!="symbol"&&typeof o!="boolean"?t.type=o:t.removeAttribute("type"),e!=null?o==="number"?(e===0&&t.value===""||t.value!=e)&&(t.value=""+Wi(e)):t.value!==""+Wi(e)&&(t.value=""+Wi(e)):o!=="submit"&&o!=="reset"||t.removeAttribute("value"),e!=null?tE(t,o,Wi(e)):r!=null?tE(t,o,Wi(r)):n!=null&&t.removeAttribute("value"),i==null&&a!=null&&(t.defaultChecked=!!a),i!=null&&(t.checked=i&&typeof i!="function"&&typeof i!="symbol"),s!=null&&typeof s!="function"&&typeof s!="symbol"&&typeof s!="boolean"?t.name=""+Wi(s):t.removeAttribute("name")}function L5(t,e,r,n,i,a,o,s){if(a!=null&&typeof a!="function"&&typeof a!="symbol"&&typeof a!="boolean"&&(t.type=a),e!=null||r!=null){if(!(a!=="submit"&&a!=="reset"||e!=null))return;r=r!=null?""+Wi(r):"",e=e!=null?""+Wi(e):r,s||e===t.value||(t.value=e),t.defaultValue=e}n=n??i,n=typeof n!="function"&&typeof n!="symbol"&&!!n,t.checked=s?t.checked:!!n,t.defaultChecked=!!n,o!=null&&typeof o!="function"&&typeof o!="symbol"&&typeof o!="boolean"&&(t.name=o)}function tE(t,e,r){e==="number"&&gy(t.ownerDocument)===t||t.defaultValue===""+r||(t.defaultValue=""+r)}function rd(t,e,r,n){if(t=t.options,e){e={};for(var i=0;i<r.length;i++)e["$"+r[i]]=!0;for(r=0;r<t.length;r++)i=e.hasOwnProperty("$"+t[r].value),t[r].selected!==i&&(t[r].selected=i),i&&n&&(t[r].defaultSelected=!0)}else{for(r=""+Wi(r),e=null,i=0;i<t.length;i++){if(t[i].value===r){t[i].selected=!0,n&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function B5(t,e,r){if(e!=null&&(e=""+Wi(e),e!==t.value&&(t.value=e),r==null)){t.defaultValue!==e&&(t.defaultValue=e);return}t.defaultValue=r!=null?""+Wi(r):""}function N5(t,e,r,n){if(e==null){if(n!=null){if(r!=null)throw Error(De(92));if(Ch(n)){if(1<n.length)throw Error(De(93));n=n[0]}r=n}r==null&&(r=""),e=r}r=Wi(e),t.defaultValue=r,n=t.textContent,n===r&&n!==""&&n!==null&&(t.value=n)}function Ad(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var rW=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function DD(t,e,r){var n=e.indexOf("--")===0;r==null||typeof r=="boolean"||r===""?n?t.setProperty(e,""):e==="float"?t.cssFloat="":t[e]="":n?t.setProperty(e,r):typeof r!="number"||r===0||rW.has(e)?e==="float"?t.cssFloat=r:t[e]=(""+r).trim():t[e]=r+"px"}function U5(t,e,r){if(e!=null&&typeof e!="object")throw Error(De(62));if(t=t.style,r!=null){for(var n in r)!r.hasOwnProperty(n)||e!=null&&e.hasOwnProperty(n)||(n.indexOf("--")===0?t.setProperty(n,""):n==="float"?t.cssFloat="":t[n]="");for(var i in e)n=e[i],e.hasOwnProperty(i)&&r[i]!==n&&DD(t,i,n)}else for(var a in e)e.hasOwnProperty(a)&&DD(t,a,e[a])}function CC(t){if(t.indexOf("-")===-1)return!1;switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var nW=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),iW=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Cg(t){return iW.test(""+t)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":t}var rE=null;function TC(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Fc=null,nd=null;function RD(t){var e=df(t);if(e&&(t=e.stateNode)){var r=t[ti]||null;e:switch(t=e.stateNode,e.type){case"input":if(eE(t,r.value,r.defaultValue,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll('input[name="'+Yi(""+e)+'"][type="radio"]'),e=0;e<r.length;e++){var n=r[e];if(n!==t&&n.form===t.form){var i=n[ti]||null;if(!i)throw Error(De(90));eE(n,i.value,i.defaultValue,i.defaultValue,i.checked,i.defaultChecked,i.type,i.name)}}for(e=0;e<r.length;e++)n=r[e],n.form===t.form&&$5(n)}break e;case"textarea":B5(t,r.value,r.defaultValue);break e;case"select":e=r.value,e!=null&&rd(t,!!r.multiple,e,!1)}}}var H_=!1;function F5(t,e,r){if(H_)return t(e,r);H_=!0;try{var n=t(e);return n}finally{if(H_=!1,(Fc!==null||nd!==null)&&(ib(),Fc&&(e=Fc,t=nd,nd=Fc=null,RD(e),t)))for(e=0;e<t.length;e++)RD(t[e])}}function yp(t,e){var r=t.stateNode;if(r===null)return null;var n=r[ti]||null;if(n===null)return null;r=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(De(231,e,typeof r));return r}var Yo=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),nE=!1;if(Yo)try{var Jf={};Object.defineProperty(Jf,"passive",{get:function(){nE=!0}}),window.addEventListener("test",Jf,Jf),window.removeEventListener("test",Jf,Jf)}catch{nE=!1}var Fs=null,DC=null,Tg=null;function j5(){if(Tg)return Tg;var t,e=DC,r=e.length,n,i="value"in Fs?Fs.value:Fs.textContent,a=i.length;for(t=0;t<r&&e[t]===i[t];t++);var o=r-t;for(n=1;n<=o&&e[r-n]===i[a-n];n++);return Tg=i.slice(t,1<n?1-n:void 0)}function Dg(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Av(){return!0}function MD(){return!1}function ri(t){function e(r,n,i,a,o){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=a,this.target=o,this.currentTarget=null;for(var s in t)t.hasOwnProperty(s)&&(r=t[s],this[s]=r?r(a):a[s]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?Av:MD,this.isPropagationStopped=MD,this}return tr(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Av)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Av)},persist:function(){},isPersistent:Av}),e}var Vu={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Z0=ri(Vu),ym=tr({},Vu,{view:0,detail:0}),aW=ri(ym),W_,G_,Xf,Y0=tr({},ym,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:RC,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Xf&&(Xf&&t.type==="mousemove"?(W_=t.screenX-Xf.screenX,G_=t.screenY-Xf.screenY):G_=W_=0,Xf=t),W_)},movementY:function(t){return"movementY"in t?t.movementY:G_}}),ID=ri(Y0),oW=tr({},Y0,{dataTransfer:0}),sW=ri(oW),lW=tr({},ym,{relatedTarget:0}),q_=ri(lW),uW=tr({},Vu,{animationName:0,elapsedTime:0,pseudoElement:0}),cW=ri(uW),dW=tr({},Vu,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),fW=ri(dW),hW=tr({},Vu,{data:0}),PD=ri(hW),pW={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},mW={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},vW={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function gW(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=vW[t])?!!e[t]:!1}function RC(){return gW}var yW=tr({},ym,{key:function(t){if(t.key){var e=pW[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Dg(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?mW[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:RC,charCode:function(t){return t.type==="keypress"?Dg(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Dg(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),bW=ri(yW),_W=tr({},Y0,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),AD=ri(_W),SW=tr({},ym,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:RC}),wW=ri(SW),EW=tr({},Vu,{propertyName:0,elapsedTime:0,pseudoElement:0}),xW=ri(EW),CW=tr({},Y0,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),TW=ri(CW),DW=tr({},Vu,{newState:0,oldState:0}),RW=ri(DW),MW=[9,13,27,32],MC=Yo&&"CompositionEvent"in window,Vh=null;Yo&&"documentMode"in document&&(Vh=document.documentMode);var IW=Yo&&"TextEvent"in window&&!Vh,V5=Yo&&(!MC||Vh&&8<Vh&&11>=Vh),kD=" ",OD=!1;function z5(t,e){switch(t){case"keyup":return MW.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function K5(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var jc=!1;function PW(t,e){switch(t){case"compositionend":return K5(e);case"keypress":return e.which!==32?null:(OD=!0,kD);case"textInput":return t=e.data,t===kD&&OD?null:t;default:return null}}function AW(t,e){if(jc)return t==="compositionend"||!MC&&z5(t,e)?(t=j5(),Tg=DC=Fs=null,jc=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return V5&&e.locale!=="ko"?null:e.data;default:return null}}var kW={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function $D(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!kW[t.type]:e==="textarea"}function H5(t,e,r,n){Fc?nd?nd.push(n):nd=[n]:Fc=n,e=$y(e,"onChange"),0<e.length&&(r=new Z0("onChange","change",null,r,n),t.push({event:r,listeners:e}))}var zh=null,bp=null;function OW(t){B$(t,0)}function J0(t){var e=Th(t);if($5(e))return t}function LD(t,e){if(t==="change")return e}var W5=!1;if(Yo){var Z_;if(Yo){var Y_="oninput"in document;if(!Y_){var BD=document.createElement("div");BD.setAttribute("oninput","return;"),Y_=typeof BD.oninput=="function"}Z_=Y_}else Z_=!1;W5=Z_&&(!document.documentMode||9<document.documentMode)}function ND(){zh&&(zh.detachEvent("onpropertychange",G5),bp=zh=null)}function G5(t){if(t.propertyName==="value"&&J0(bp)){var e=[];H5(e,bp,t,TC(t)),F5(OW,e)}}function $W(t,e,r){t==="focusin"?(ND(),zh=e,bp=r,zh.attachEvent("onpropertychange",G5)):t==="focusout"&&ND()}function LW(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return J0(bp)}function BW(t,e){if(t==="click")return J0(e)}function NW(t,e){if(t==="input"||t==="change")return J0(e)}function UW(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Di=typeof Object.is=="function"?Object.is:UW;function _p(t,e){if(Di(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!Xw.call(e,i)||!Di(t[i],e[i]))return!1}return!0}function UD(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function FD(t,e){var r=UD(t);t=0;for(var n;r;){if(r.nodeType===3){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=UD(r)}}function q5(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?q5(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Z5(t){t=t!=null&&t.ownerDocument!=null&&t.ownerDocument.defaultView!=null?t.ownerDocument.defaultView:window;for(var e=gy(t.document);e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=gy(t.document)}return e}function IC(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}var FW=Yo&&"documentMode"in document&&11>=document.documentMode,Vc=null,iE=null,Kh=null,aE=!1;function jD(t,e,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;aE||Vc==null||Vc!==gy(n)||(n=Vc,"selectionStart"in n&&IC(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Kh&&_p(Kh,n)||(Kh=n,n=$y(iE,"onSelect"),0<n.length&&(e=new Z0("onSelect","select",null,e,r),t.push({event:e,listeners:n}),e.target=Vc)))}function Al(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var zc={animationend:Al("Animation","AnimationEnd"),animationiteration:Al("Animation","AnimationIteration"),animationstart:Al("Animation","AnimationStart"),transitionrun:Al("Transition","TransitionRun"),transitionstart:Al("Transition","TransitionStart"),transitioncancel:Al("Transition","TransitionCancel"),transitionend:Al("Transition","TransitionEnd")},J_={},Y5={};Yo&&(Y5=document.createElement("div").style,"AnimationEvent"in window||(delete zc.animationend.animation,delete zc.animationiteration.animation,delete zc.animationstart.animation),"TransitionEvent"in window||delete zc.transitionend.transition);function zu(t){if(J_[t])return J_[t];if(!zc[t])return t;var e=zc[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in Y5)return J_[t]=e[r];return t}var J5=zu("animationend"),X5=zu("animationiteration"),Q5=zu("animationstart"),jW=zu("transitionrun"),VW=zu("transitionstart"),zW=zu("transitioncancel"),eO=zu("transitionend"),tO=new Map,oE="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");oE.push("scrollEnd");function Da(t,e){tO.set(t,e),ju(e,[t])}var VD=new WeakMap;function Ji(t,e){if(typeof t=="object"&&t!==null){var r=VD.get(t);return r!==void 0?r:(e={value:t,source:e,stack:TD(e)},VD.set(t,e),e)}return{value:t,source:e,stack:TD(e)}}var zi=[],Kc=0,PC=0;function X0(){for(var t=Kc,e=PC=Kc=0;e<t;){var r=zi[e];zi[e++]=null;var n=zi[e];zi[e++]=null;var i=zi[e];zi[e++]=null;var a=zi[e];if(zi[e++]=null,n!==null&&i!==null){var o=n.pending;o===null?i.next=i:(i.next=o.next,o.next=i),n.pending=i}a!==0&&rO(r,i,a)}}function Q0(t,e,r,n){zi[Kc++]=t,zi[Kc++]=e,zi[Kc++]=r,zi[Kc++]=n,PC|=n,t.lanes|=n,t=t.alternate,t!==null&&(t.lanes|=n)}function AC(t,e,r,n){return Q0(t,e,r,n),yy(t)}function ff(t,e){return Q0(t,null,null,e),yy(t)}function rO(t,e,r){t.lanes|=r;var n=t.alternate;n!==null&&(n.lanes|=r);for(var i=!1,a=t.return;a!==null;)a.childLanes|=r,n=a.alternate,n!==null&&(n.childLanes|=r),a.tag===22&&(t=a.stateNode,t===null||t._visibility&1||(i=!0)),t=a,a=a.return;return t.tag===3?(a=t.stateNode,i&&e!==null&&(i=31-Ei(r),t=a.hiddenUpdates,n=t[i],n===null?t[i]=[e]:n.push(e),e.lane=r|536870912),a):null}function yy(t){if(50<ep)throw ep=0,DE=null,Error(De(185));for(var e=t.return;e!==null;)t=e,e=t.return;return t.tag===3?t.stateNode:null}var Hc={};function KW(t,e,r,n){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function bi(t,e,r,n){return new KW(t,e,r,n)}function kC(t){return t=t.prototype,!(!t||!t.isReactComponent)}function zo(t,e){var r=t.alternate;return r===null?(r=bi(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&65011712,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r.refCleanup=t.refCleanup,r}function nO(t,e){t.flags&=65011714;var r=t.alternate;return r===null?(t.childLanes=0,t.lanes=e,t.child=null,t.subtreeFlags=0,t.memoizedProps=null,t.memoizedState=null,t.updateQueue=null,t.dependencies=null,t.stateNode=null):(t.childLanes=r.childLanes,t.lanes=r.lanes,t.child=r.child,t.subtreeFlags=0,t.deletions=null,t.memoizedProps=r.memoizedProps,t.memoizedState=r.memoizedState,t.updateQueue=r.updateQueue,t.type=r.type,e=r.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),t}function Rg(t,e,r,n,i,a){var o=0;if(n=t,typeof t=="function")kC(t)&&(o=1);else if(typeof t=="string")o=WG(t,r,Ja.current)?26:t==="html"||t==="head"||t==="body"?27:5;else e:switch(t){case qw:return t=bi(31,r,e,i),t.elementType=qw,t.lanes=a,t;case Bc:return cu(r.children,i,a,e);case w5:o=8,i|=24;break;case Hw:return t=bi(12,r,e,i|2),t.elementType=Hw,t.lanes=a,t;case Ww:return t=bi(13,r,e,i),t.elementType=Ww,t.lanes=a,t;case Gw:return t=bi(19,r,e,i),t.elementType=Gw,t.lanes=a,t;default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case OH:case ko:o=10;break e;case E5:o=9;break e;case bC:o=11;break e;case _C:o=14;break e;case Ms:o=16,n=null;break e}o=29,r=Error(De(130,t===null?"null":typeof t,"")),n=null}return e=bi(o,r,e,i),e.elementType=t,e.type=n,e.lanes=a,e}function cu(t,e,r,n){return t=bi(7,t,n,e),t.lanes=r,t}function X_(t,e,r){return t=bi(6,t,null,e),t.lanes=r,t}function Q_(t,e,r){return e=bi(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}var Wc=[],Gc=0,by=null,_y=0,Gi=[],qi=0,du=null,Oo=1,$o="";function Kl(t,e){Wc[Gc++]=_y,Wc[Gc++]=by,by=t,_y=e}function iO(t,e,r){Gi[qi++]=Oo,Gi[qi++]=$o,Gi[qi++]=du,du=t;var n=Oo;t=$o;var i=32-Ei(n)-1;n&=~(1<<i),r+=1;var a=32-Ei(e)+i;if(30<a){var o=i-i%5;a=(n&(1<<o)-1).toString(32),n>>=o,i-=o,Oo=1<<32-Ei(e)+i|r<<i|n,$o=a+t}else Oo=1<<a|r<<i|n,$o=t}function OC(t){t.return!==null&&(Kl(t,1),iO(t,1,0))}function $C(t){for(;t===by;)by=Wc[--Gc],Wc[Gc]=null,_y=Wc[--Gc],Wc[Gc]=null;for(;t===du;)du=Gi[--qi],Gi[qi]=null,$o=Gi[--qi],Gi[qi]=null,Oo=Gi[--qi],Gi[qi]=null}var kn=null,_r=null,kt=!1,fu=null,Ha=!1,sE=Error(De(519));function wu(t){var e=Error(De(418,""));throw Sp(Ji(e,t)),sE}function zD(t){var e=t.stateNode,r=t.type,n=t.memoizedProps;switch(e[En]=t,e[ti]=n,r){case"dialog":_t("cancel",e),_t("close",e);break;case"iframe":case"object":case"embed":_t("load",e);break;case"video":case"audio":for(r=0;r<xp.length;r++)_t(xp[r],e);break;case"source":_t("error",e);break;case"img":case"image":case"link":_t("error",e),_t("load",e);break;case"details":_t("toggle",e);break;case"input":_t("invalid",e),L5(e,n.value,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name,!0),vy(e);break;case"select":_t("invalid",e);break;case"textarea":_t("invalid",e),N5(e,n.value,n.defaultValue,n.children),vy(e)}r=n.children,typeof r!="string"&&typeof r!="number"&&typeof r!="bigint"||e.textContent===""+r||n.suppressHydrationWarning===!0||U$(e.textContent,r)?(n.popover!=null&&(_t("beforetoggle",e),_t("toggle",e)),n.onScroll!=null&&_t("scroll",e),n.onScrollEnd!=null&&_t("scrollend",e),n.onClick!=null&&(e.onclick=sb),e=!0):e=!1,e||wu(t)}function KD(t){for(kn=t.return;kn;)switch(kn.tag){case 5:case 13:Ha=!1;return;case 27:case 3:Ha=!0;return;default:kn=kn.return}}function Qf(t){if(t!==kn)return!1;if(!kt)return KD(t),kt=!0,!1;var e=t.tag,r;if((r=e!==3&&e!==27)&&((r=e===5)&&(r=t.type,r=!(r!=="form"&&r!=="button")||kE(t.type,t.memoizedProps)),r=!r),r&&_r&&wu(t),KD(t),e===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(De(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8)if(r=t.data,r==="/$"){if(e===0){_r=_a(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++;t=t.nextSibling}_r=null}}else e===27?(e=_r,_l(t.type)?(t=LE,LE=null,_r=t):_r=e):_r=kn?_a(t.stateNode.nextSibling):null;return!0}function bm(){_r=kn=null,kt=!1}function HD(){var t=fu;return t!==null&&(Zn===null?Zn=t:Zn.push.apply(Zn,t),fu=null),t}function Sp(t){fu===null?fu=[t]:fu.push(t)}var lE=uo(null),Ku=null,Lo=null;function Os(t,e,r){dr(lE,e._currentValue),e._currentValue=r}function Ko(t){t._currentValue=lE.current,on(lE)}function uE(t,e,r){for(;t!==null;){var n=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),t===r)break;t=t.return}}function cE(t,e,r,n){var i=t.child;for(i!==null&&(i.return=t);i!==null;){var a=i.dependencies;if(a!==null){var o=i.child;a=a.firstContext;e:for(;a!==null;){var s=a;a=i;for(var l=0;l<e.length;l++)if(s.context===e[l]){a.lanes|=r,s=a.alternate,s!==null&&(s.lanes|=r),uE(a.return,r,t),n||(o=null);break e}a=s.next}}else if(i.tag===18){if(o=i.return,o===null)throw Error(De(341));o.lanes|=r,a=o.alternate,a!==null&&(a.lanes|=r),uE(o,r,t),o=null}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===t){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}}function _m(t,e,r,n){t=null;for(var i=e,a=!1;i!==null;){if(!a){if(i.flags&524288)a=!0;else if(i.flags&262144)break}if(i.tag===10){var o=i.alternate;if(o===null)throw Error(De(387));if(o=o.memoizedProps,o!==null){var s=i.type;Di(i.pendingProps.value,o.value)||(t!==null?t.push(s):t=[s])}}else if(i===fy.current){if(o=i.alternate,o===null)throw Error(De(387));o.memoizedState.memoizedState!==i.memoizedState.memoizedState&&(t!==null?t.push(Dp):t=[Dp])}i=i.return}t!==null&&cE(e,t,r,n),e.flags|=262144}function Sy(t){for(t=t.firstContext;t!==null;){if(!Di(t.context._currentValue,t.memoizedValue))return!0;t=t.next}return!1}function Eu(t){Ku=t,Lo=null,t=t.dependencies,t!==null&&(t.firstContext=null)}function xn(t){return aO(Ku,t)}function kv(t,e){return Ku===null&&Eu(t),aO(t,e)}function aO(t,e){var r=e._currentValue;if(e={context:e,memoizedValue:r,next:null},Lo===null){if(t===null)throw Error(De(308));Lo=e,t.dependencies={lanes:0,firstContext:e},t.flags|=524288}else Lo=Lo.next=e;return r}var HW=typeof AbortController<"u"?AbortController:function(){var t=[],e=this.signal={aborted:!1,addEventListener:function(r,n){t.push(n)}};this.abort=function(){e.aborted=!0,t.forEach(function(r){return r()})}},WW=Hr.unstable_scheduleCallback,GW=Hr.unstable_NormalPriority,Vr={$$typeof:ko,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function LC(){return{controller:new HW,data:new Map,refCount:0}}function Sm(t){t.refCount--,t.refCount===0&&WW(GW,function(){t.controller.abort()})}var Hh=null,dE=0,kd=0,id=null;function qW(t,e){if(Hh===null){var r=Hh=[];dE=0,kd=aT(),id={status:"pending",value:void 0,then:function(n){r.push(n)}}}return dE++,e.then(WD,WD),e}function WD(){if(--dE===0&&Hh!==null){id!==null&&(id.status="fulfilled");var t=Hh;Hh=null,kd=0,id=null;for(var e=0;e<t.length;e++)(0,t[e])()}}function ZW(t,e){var r=[],n={status:"pending",value:null,reason:null,then:function(i){r.push(i)}};return t.then(function(){n.status="fulfilled",n.value=e;for(var i=0;i<r.length;i++)(0,r[i])(e)},function(i){for(n.status="rejected",n.reason=i,i=0;i<r.length;i++)(0,r[i])(void 0)}),n}var GD=Qe.S;Qe.S=function(t,e){typeof e=="object"&&e!==null&&typeof e.then=="function"&&qW(t,e),GD!==null&&GD(t,e)};var hu=uo(null);function BC(){var t=hu.current;return t!==null?t:Xt.pooledCache}function Mg(t,e){e===null?dr(hu,hu.current):dr(hu,e.pool)}function oO(){var t=BC();return t===null?null:{parent:Vr._currentValue,pool:t}}var wm=Error(De(460)),sO=Error(De(474)),eb=Error(De(542)),fE={then:function(){}};function qD(t){return t=t.status,t==="fulfilled"||t==="rejected"}function Ov(){}function lO(t,e,r){switch(r=t[r],r===void 0?t.push(e):r!==e&&(e.then(Ov,Ov),e=r),e.status){case"fulfilled":return e.value;case"rejected":throw t=e.reason,YD(t),t;default:if(typeof e.status=="string")e.then(Ov,Ov);else{if(t=Xt,t!==null&&100<t.shellSuspendCounter)throw Error(De(482));t=e,t.status="pending",t.then(function(n){if(e.status==="pending"){var i=e;i.status="fulfilled",i.value=n}},function(n){if(e.status==="pending"){var i=e;i.status="rejected",i.reason=n}})}switch(e.status){case"fulfilled":return e.value;case"rejected":throw t=e.reason,YD(t),t}throw Wh=e,wm}}var Wh=null;function ZD(){if(Wh===null)throw Error(De(459));var t=Wh;return Wh=null,t}function YD(t){if(t===wm||t===eb)throw Error(De(483))}var Is=!1;function NC(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function hE(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,callbacks:null})}function Ys(t){return{lane:t,tag:0,payload:null,callback:null,next:null}}function Js(t,e,r){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,Ut&2){var i=n.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),n.pending=e,e=yy(t),rO(t,null,r),e}return Q0(t,n,e,r),yy(t)}function Gh(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194048)!==0)){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,I5(t,r)}}function eS(t,e){var r=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,a=null;if(r=r.firstBaseUpdate,r!==null){do{var o={lane:r.lane,tag:r.tag,payload:r.payload,callback:null,next:null};a===null?i=a=o:a=a.next=o,r=r.next}while(r!==null);a===null?i=a=e:a=a.next=e}else i=a=e;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:a,shared:n.shared,callbacks:n.callbacks},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}var pE=!1;function qh(){if(pE){var t=id;if(t!==null)throw t}}function Zh(t,e,r,n){pE=!1;var i=t.updateQueue;Is=!1;var a=i.firstBaseUpdate,o=i.lastBaseUpdate,s=i.shared.pending;if(s!==null){i.shared.pending=null;var l=s,c=l.next;l.next=null,o===null?a=c:o.next=c,o=l;var d=t.alternate;d!==null&&(d=d.updateQueue,s=d.lastBaseUpdate,s!==o&&(s===null?d.firstBaseUpdate=c:s.next=c,d.lastBaseUpdate=l))}if(a!==null){var h=i.baseState;o=0,d=c=l=null,s=a;do{var p=s.lane&-536870913,m=p!==s.lane;if(m?(Ct&p)===p:(n&p)===p){p!==0&&p===kd&&(pE=!0),d!==null&&(d=d.next={lane:0,tag:s.tag,payload:s.payload,callback:null,next:null});e:{var g=t,y=s;p=e;var R=r;switch(y.tag){case 1:if(g=y.payload,typeof g=="function"){h=g.call(R,h,p);break e}h=g;break e;case 3:g.flags=g.flags&-65537|128;case 0:if(g=y.payload,p=typeof g=="function"?g.call(R,h,p):g,p==null)break e;h=tr({},h,p);break e;case 2:Is=!0}}p=s.callback,p!==null&&(t.flags|=64,m&&(t.flags|=8192),m=i.callbacks,m===null?i.callbacks=[p]:m.push(p))}else m={lane:p,tag:s.tag,payload:s.payload,callback:s.callback,next:null},d===null?(c=d=m,l=h):d=d.next=m,o|=p;if(s=s.next,s===null){if(s=i.shared.pending,s===null)break;m=s,s=m.next,m.next=null,i.lastBaseUpdate=m,i.shared.pending=null}}while(!0);d===null&&(l=h),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=d,a===null&&(i.shared.lanes=0),ul|=o,t.lanes=o,t.memoizedState=h}}function uO(t,e){if(typeof t!="function")throw Error(De(191,t));t.call(e)}function cO(t,e){var r=t.callbacks;if(r!==null)for(t.callbacks=null,t=0;t<r.length;t++)uO(r[t],e)}var Od=uo(null),wy=uo(0);function JD(t,e){t=Qo,dr(wy,t),dr(Od,e),Qo=t|e.baseLanes}function mE(){dr(wy,Qo),dr(Od,Od.current)}function UC(){Qo=wy.current,on(Od),on(wy)}var sl=0,mt=null,Vt=null,Or=null,Ey=!1,ad=!1,xu=!1,xy=0,wp=0,od=null,YW=0;function Er(){throw Error(De(321))}function FC(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!Di(t[r],e[r]))return!1;return!0}function jC(t,e,r,n,i,a){return sl=a,mt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Qe.H=t===null||t.memoizedState===null?jO:VO,xu=!1,a=r(n,i),xu=!1,ad&&(a=fO(e,r,n,i)),dO(t),a}function dO(t){Qe.H=Cy;var e=Vt!==null&&Vt.next!==null;if(sl=0,Or=Vt=mt=null,Ey=!1,wp=0,od=null,e)throw Error(De(300));t===null||nn||(t=t.dependencies,t!==null&&Sy(t)&&(nn=!0))}function fO(t,e,r,n){mt=t;var i=0;do{if(ad&&(od=null),wp=0,ad=!1,25<=i)throw Error(De(301));if(i+=1,Or=Vt=null,t.updateQueue!=null){var a=t.updateQueue;a.lastEffect=null,a.events=null,a.stores=null,a.memoCache!=null&&(a.memoCache.index=0)}Qe.H=nG,a=e(r,n)}while(ad);return a}function JW(){var t=Qe.H,e=t.useState()[0];return e=typeof e.then=="function"?Em(e):e,t=t.useState()[0],(Vt!==null?Vt.memoizedState:null)!==t&&(mt.flags|=1024),e}function VC(){var t=xy!==0;return xy=0,t}function zC(t,e,r){e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r}function KC(t){if(Ey){for(t=t.memoizedState;t!==null;){var e=t.queue;e!==null&&(e.pending=null),t=t.next}Ey=!1}sl=0,Or=Vt=mt=null,ad=!1,wp=xy=0,od=null}function Gn(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Or===null?mt.memoizedState=Or=t:Or=Or.next=t,Or}function Lr(){if(Vt===null){var t=mt.alternate;t=t!==null?t.memoizedState:null}else t=Vt.next;var e=Or===null?mt.memoizedState:Or.next;if(e!==null)Or=e,Vt=t;else{if(t===null)throw mt.alternate===null?Error(De(467)):Error(De(310));Vt=t,t={memoizedState:Vt.memoizedState,baseState:Vt.baseState,baseQueue:Vt.baseQueue,queue:Vt.queue,next:null},Or===null?mt.memoizedState=Or=t:Or=Or.next=t}return Or}function HC(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Em(t){var e=wp;return wp+=1,od===null&&(od=[]),t=lO(od,t,e),e=mt,(Or===null?e.memoizedState:Or.next)===null&&(e=e.alternate,Qe.H=e===null||e.memoizedState===null?jO:VO),t}function tb(t){if(t!==null&&typeof t=="object"){if(typeof t.then=="function")return Em(t);if(t.$$typeof===ko)return xn(t)}throw Error(De(438,String(t)))}function WC(t){var e=null,r=mt.updateQueue;if(r!==null&&(e=r.memoCache),e==null){var n=mt.alternate;n!==null&&(n=n.updateQueue,n!==null&&(n=n.memoCache,n!=null&&(e={data:n.data.map(function(i){return i.slice()}),index:0})))}if(e==null&&(e={data:[],index:0}),r===null&&(r=HC(),mt.updateQueue=r),r.memoCache=e,r=e.data[e.index],r===void 0)for(r=e.data[e.index]=Array(t),n=0;n<t;n++)r[n]=$H;return e.index++,r}function Jo(t,e){return typeof e=="function"?e(t):e}function Ig(t){var e=Lr();return GC(e,Vt,t)}function GC(t,e,r){var n=t.queue;if(n===null)throw Error(De(311));n.lastRenderedReducer=r;var i=t.baseQueue,a=n.pending;if(a!==null){if(i!==null){var o=i.next;i.next=a.next,a.next=o}e.baseQueue=i=a,n.pending=null}if(a=t.baseState,i===null)t.memoizedState=a;else{e=i.next;var s=o=null,l=null,c=e,d=!1;do{var h=c.lane&-536870913;if(h!==c.lane?(Ct&h)===h:(sl&h)===h){var p=c.revertLane;if(p===0)l!==null&&(l=l.next={lane:0,revertLane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),h===kd&&(d=!0);else if((sl&p)===p){c=c.next,p===kd&&(d=!0);continue}else h={lane:0,revertLane:c.revertLane,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null},l===null?(s=l=h,o=a):l=l.next=h,mt.lanes|=p,ul|=p;h=c.action,xu&&r(a,h),a=c.hasEagerState?c.eagerState:r(a,h)}else p={lane:h,revertLane:c.revertLane,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null},l===null?(s=l=p,o=a):l=l.next=p,mt.lanes|=h,ul|=h;c=c.next}while(c!==null&&c!==e);if(l===null?o=a:l.next=s,!Di(a,t.memoizedState)&&(nn=!0,d&&(r=id,r!==null)))throw r;t.memoizedState=a,t.baseState=o,t.baseQueue=l,n.lastRenderedState=a}return i===null&&(n.lanes=0),[t.memoizedState,n.dispatch]}function tS(t){var e=Lr(),r=e.queue;if(r===null)throw Error(De(311));r.lastRenderedReducer=t;var n=r.dispatch,i=r.pending,a=e.memoizedState;if(i!==null){r.pending=null;var o=i=i.next;do a=t(a,o.action),o=o.next;while(o!==i);Di(a,e.memoizedState)||(nn=!0),e.memoizedState=a,e.baseQueue===null&&(e.baseState=a),r.lastRenderedState=a}return[a,n]}function hO(t,e,r){var n=mt,i=Lr(),a=kt;if(a){if(r===void 0)throw Error(De(407));r=r()}else r=e();var o=!Di((Vt||i).memoizedState,r);o&&(i.memoizedState=r,nn=!0),i=i.queue;var s=vO.bind(null,n,i,t);if(xm(2048,8,s,[t]),i.getSnapshot!==e||o||Or!==null&&Or.memoizedState.tag&1){if(n.flags|=2048,$d(9,rb(),mO.bind(null,n,i,r,e),null),Xt===null)throw Error(De(349));a||sl&124||pO(n,e,r)}return r}function pO(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=mt.updateQueue,e===null?(e=HC(),mt.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function mO(t,e,r,n){e.value=r,e.getSnapshot=n,gO(e)&&yO(t)}function vO(t,e,r){return r(function(){gO(e)&&yO(t)})}function gO(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!Di(t,r)}catch{return!0}}function yO(t){var e=ff(t,2);e!==null&&Ci(e,t,2)}function vE(t){var e=Gn();if(typeof t=="function"){var r=t;if(t=r(),xu){Us(!0);try{r()}finally{Us(!1)}}}return e.memoizedState=e.baseState=t,e.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Jo,lastRenderedState:t},e}function bO(t,e,r,n){return t.baseState=r,GC(t,Vt,typeof n=="function"?n:Jo)}function XW(t,e,r,n,i){if(nb(t))throw Error(De(485));if(t=e.action,t!==null){var a={payload:i,action:t,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(o){a.listeners.push(o)}};Qe.T!==null?r(!0):a.isTransition=!1,n(a),r=e.pending,r===null?(a.next=e.pending=a,_O(e,a)):(a.next=r.next,e.pending=r.next=a)}}function _O(t,e){var r=e.action,n=e.payload,i=t.state;if(e.isTransition){var a=Qe.T,o={};Qe.T=o;try{var s=r(i,n),l=Qe.S;l!==null&&l(o,s),XD(t,e,s)}catch(c){gE(t,e,c)}finally{Qe.T=a}}else try{a=r(i,n),XD(t,e,a)}catch(c){gE(t,e,c)}}function XD(t,e,r){r!==null&&typeof r=="object"&&typeof r.then=="function"?r.then(function(n){QD(t,e,n)},function(n){return gE(t,e,n)}):QD(t,e,r)}function QD(t,e,r){e.status="fulfilled",e.value=r,SO(e),t.state=r,e=t.pending,e!==null&&(r=e.next,r===e?t.pending=null:(r=r.next,e.next=r,_O(t,r)))}function gE(t,e,r){var n=t.pending;if(t.pending=null,n!==null){n=n.next;do e.status="rejected",e.reason=r,SO(e),e=e.next;while(e!==n)}t.action=null}function SO(t){t=t.listeners;for(var e=0;e<t.length;e++)(0,t[e])()}function wO(t,e){return e}function eR(t,e){if(kt){var r=Xt.formState;if(r!==null){e:{var n=mt;if(kt){if(_r){t:{for(var i=_r,a=Ha;i.nodeType!==8;){if(!a){i=null;break t}if(i=_a(i.nextSibling),i===null){i=null;break t}}a=i.data,i=a==="F!"||a==="F"?i:null}if(i){_r=_a(i.nextSibling),n=i.data==="F!";break e}}wu(n)}n=!1}n&&(e=r[0])}}return r=Gn(),r.memoizedState=r.baseState=e,n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:wO,lastRenderedState:e},r.queue=n,r=NO.bind(null,mt,n),n.dispatch=r,n=vE(!1),a=JC.bind(null,mt,!1,n.queue),n=Gn(),i={state:e,dispatch:null,action:t,pending:null},n.queue=i,r=XW.bind(null,mt,i,a,r),i.dispatch=r,n.memoizedState=t,[e,r,!1]}function tR(t){var e=Lr();return EO(e,Vt,t)}function EO(t,e,r){if(e=GC(t,e,wO)[0],t=Ig(Jo)[0],typeof e=="object"&&e!==null&&typeof e.then=="function")try{var n=Em(e)}catch(o){throw o===wm?eb:o}else n=e;e=Lr();var i=e.queue,a=i.dispatch;return r!==e.memoizedState&&(mt.flags|=2048,$d(9,rb(),QW.bind(null,i,r),null)),[n,a,t]}function QW(t,e){t.action=e}function rR(t){var e=Lr(),r=Vt;if(r!==null)return EO(e,r,t);Lr(),e=e.memoizedState,r=Lr();var n=r.queue.dispatch;return r.memoizedState=t,[e,n,!1]}function $d(t,e,r,n){return t={tag:t,create:r,deps:n,inst:e,next:null},e=mt.updateQueue,e===null&&(e=HC(),mt.updateQueue=e),r=e.lastEffect,r===null?e.lastEffect=t.next=t:(n=r.next,r.next=t,t.next=n,e.lastEffect=t),t}function rb(){return{destroy:void 0,resource:void 0}}function xO(){return Lr().memoizedState}function Pg(t,e,r,n){var i=Gn();n=n===void 0?null:n,mt.flags|=t,i.memoizedState=$d(1|e,rb(),r,n)}function xm(t,e,r,n){var i=Lr();n=n===void 0?null:n;var a=i.memoizedState.inst;Vt!==null&&n!==null&&FC(n,Vt.memoizedState.deps)?i.memoizedState=$d(e,a,r,n):(mt.flags|=t,i.memoizedState=$d(1|e,a,r,n))}function nR(t,e){Pg(8390656,8,t,e)}function CO(t,e){xm(2048,8,t,e)}function TO(t,e){return xm(4,2,t,e)}function DO(t,e){return xm(4,4,t,e)}function RO(t,e){if(typeof e=="function"){t=t();var r=e(t);return function(){typeof r=="function"?r():e(null)}}if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function MO(t,e,r){r=r!=null?r.concat([t]):null,xm(4,4,RO.bind(null,e,t),r)}function qC(){}function IO(t,e){var r=Lr();e=e===void 0?null:e;var n=r.memoizedState;return e!==null&&FC(e,n[1])?n[0]:(r.memoizedState=[t,e],t)}function PO(t,e){var r=Lr();e=e===void 0?null:e;var n=r.memoizedState;if(e!==null&&FC(e,n[1]))return n[0];if(n=t(),xu){Us(!0);try{t()}finally{Us(!1)}}return r.memoizedState=[n,e],n}function ZC(t,e,r){return r===void 0||sl&1073741824?t.memoizedState=e:(t.memoizedState=r,t=S$(),mt.lanes|=t,ul|=t,r)}function AO(t,e,r,n){return Di(r,e)?r:Od.current!==null?(t=ZC(t,r,n),Di(t,e)||(nn=!0),t):sl&42?(t=S$(),mt.lanes|=t,ul|=t,e):(nn=!0,t.memoizedState=r)}function kO(t,e,r,n,i){var a=$t.p;$t.p=a!==0&&8>a?a:8;var o=Qe.T,s={};Qe.T=s,JC(t,!1,e,r);try{var l=i(),c=Qe.S;if(c!==null&&c(s,l),l!==null&&typeof l=="object"&&typeof l.then=="function"){var d=ZW(l,n);Yh(t,e,d,xi(t))}else Yh(t,e,n,xi(t))}catch(h){Yh(t,e,{then:function(){},status:"rejected",reason:h},xi())}finally{$t.p=a,Qe.T=o}}function eG(){}function yE(t,e,r,n){if(t.tag!==5)throw Error(De(476));var i=OO(t).queue;kO(t,i,e,uu,r===null?eG:function(){return $O(t),r(n)})}function OO(t){var e=t.memoizedState;if(e!==null)return e;e={memoizedState:uu,baseState:uu,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Jo,lastRenderedState:uu},next:null};var r={};return e.next={memoizedState:r,baseState:r,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Jo,lastRenderedState:r},next:null},t.memoizedState=e,t=t.alternate,t!==null&&(t.memoizedState=e),e}function $O(t){var e=OO(t).next.queue;Yh(t,e,{},xi())}function YC(){return xn(Dp)}function LO(){return Lr().memoizedState}function BO(){return Lr().memoizedState}function tG(t){for(var e=t.return;e!==null;){switch(e.tag){case 24:case 3:var r=xi();t=Ys(r);var n=Js(e,t,r);n!==null&&(Ci(n,e,r),Gh(n,e,r)),e={cache:LC()},t.payload=e;return}e=e.return}}function rG(t,e,r){var n=xi();r={lane:n,revertLane:0,action:r,hasEagerState:!1,eagerState:null,next:null},nb(t)?UO(e,r):(r=AC(t,e,r,n),r!==null&&(Ci(r,t,n),FO(r,e,n)))}function NO(t,e,r){var n=xi();Yh(t,e,r,n)}function Yh(t,e,r,n){var i={lane:n,revertLane:0,action:r,hasEagerState:!1,eagerState:null,next:null};if(nb(t))UO(e,i);else{var a=t.alternate;if(t.lanes===0&&(a===null||a.lanes===0)&&(a=e.lastRenderedReducer,a!==null))try{var o=e.lastRenderedState,s=a(o,r);if(i.hasEagerState=!0,i.eagerState=s,Di(s,o))return Q0(t,e,i,0),Xt===null&&X0(),!1}catch{}finally{}if(r=AC(t,e,i,n),r!==null)return Ci(r,t,n),FO(r,e,n),!0}return!1}function JC(t,e,r,n){if(n={lane:2,revertLane:aT(),action:n,hasEagerState:!1,eagerState:null,next:null},nb(t)){if(e)throw Error(De(479))}else e=AC(t,r,n,2),e!==null&&Ci(e,t,2)}function nb(t){var e=t.alternate;return t===mt||e!==null&&e===mt}function UO(t,e){ad=Ey=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function FO(t,e,r){if(r&4194048){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,I5(t,r)}}var Cy={readContext:xn,use:tb,useCallback:Er,useContext:Er,useEffect:Er,useImperativeHandle:Er,useLayoutEffect:Er,useInsertionEffect:Er,useMemo:Er,useReducer:Er,useRef:Er,useState:Er,useDebugValue:Er,useDeferredValue:Er,useTransition:Er,useSyncExternalStore:Er,useId:Er,useHostTransitionStatus:Er,useFormState:Er,useActionState:Er,useOptimistic:Er,useMemoCache:Er,useCacheRefresh:Er},jO={readContext:xn,use:tb,useCallback:function(t,e){return Gn().memoizedState=[t,e===void 0?null:e],t},useContext:xn,useEffect:nR,useImperativeHandle:function(t,e,r){r=r!=null?r.concat([t]):null,Pg(4194308,4,RO.bind(null,e,t),r)},useLayoutEffect:function(t,e){return Pg(4194308,4,t,e)},useInsertionEffect:function(t,e){Pg(4,2,t,e)},useMemo:function(t,e){var r=Gn();e=e===void 0?null:e;var n=t();if(xu){Us(!0);try{t()}finally{Us(!1)}}return r.memoizedState=[n,e],n},useReducer:function(t,e,r){var n=Gn();if(r!==void 0){var i=r(e);if(xu){Us(!0);try{r(e)}finally{Us(!1)}}}else i=e;return n.memoizedState=n.baseState=i,t={pending:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:i},n.queue=t,t=t.dispatch=rG.bind(null,mt,t),[n.memoizedState,t]},useRef:function(t){var e=Gn();return t={current:t},e.memoizedState=t},useState:function(t){t=vE(t);var e=t.queue,r=NO.bind(null,mt,e);return e.dispatch=r,[t.memoizedState,r]},useDebugValue:qC,useDeferredValue:function(t,e){var r=Gn();return ZC(r,t,e)},useTransition:function(){var t=vE(!1);return t=kO.bind(null,mt,t.queue,!0,!1),Gn().memoizedState=t,[!1,t]},useSyncExternalStore:function(t,e,r){var n=mt,i=Gn();if(kt){if(r===void 0)throw Error(De(407));r=r()}else{if(r=e(),Xt===null)throw Error(De(349));Ct&124||pO(n,e,r)}i.memoizedState=r;var a={value:r,getSnapshot:e};return i.queue=a,nR(vO.bind(null,n,a,t),[t]),n.flags|=2048,$d(9,rb(),mO.bind(null,n,a,r,e),null),r},useId:function(){var t=Gn(),e=Xt.identifierPrefix;if(kt){var r=$o,n=Oo;r=(n&~(1<<32-Ei(n)-1)).toString(32)+r,e=""+e+"R"+r,r=xy++,0<r&&(e+="H"+r.toString(32)),e+=""}else r=YW++,e=""+e+"r"+r.toString(32)+"";return t.memoizedState=e},useHostTransitionStatus:YC,useFormState:eR,useActionState:eR,useOptimistic:function(t){var e=Gn();e.memoizedState=e.baseState=t;var r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return e.queue=r,e=JC.bind(null,mt,!0,r),r.dispatch=e,[t,e]},useMemoCache:WC,useCacheRefresh:function(){return Gn().memoizedState=tG.bind(null,mt)}},VO={readContext:xn,use:tb,useCallback:IO,useContext:xn,useEffect:CO,useImperativeHandle:MO,useInsertionEffect:TO,useLayoutEffect:DO,useMemo:PO,useReducer:Ig,useRef:xO,useState:function(){return Ig(Jo)},useDebugValue:qC,useDeferredValue:function(t,e){var r=Lr();return AO(r,Vt.memoizedState,t,e)},useTransition:function(){var t=Ig(Jo)[0],e=Lr().memoizedState;return[typeof t=="boolean"?t:Em(t),e]},useSyncExternalStore:hO,useId:LO,useHostTransitionStatus:YC,useFormState:tR,useActionState:tR,useOptimistic:function(t,e){var r=Lr();return bO(r,Vt,t,e)},useMemoCache:WC,useCacheRefresh:BO},nG={readContext:xn,use:tb,useCallback:IO,useContext:xn,useEffect:CO,useImperativeHandle:MO,useInsertionEffect:TO,useLayoutEffect:DO,useMemo:PO,useReducer:tS,useRef:xO,useState:function(){return tS(Jo)},useDebugValue:qC,useDeferredValue:function(t,e){var r=Lr();return Vt===null?ZC(r,t,e):AO(r,Vt.memoizedState,t,e)},useTransition:function(){var t=tS(Jo)[0],e=Lr().memoizedState;return[typeof t=="boolean"?t:Em(t),e]},useSyncExternalStore:hO,useId:LO,useHostTransitionStatus:YC,useFormState:rR,useActionState:rR,useOptimistic:function(t,e){var r=Lr();return Vt!==null?bO(r,Vt,t,e):(r.baseState=t,[t,r.queue.dispatch])},useMemoCache:WC,useCacheRefresh:BO},sd=null,Ep=0;function $v(t){var e=Ep;return Ep+=1,sd===null&&(sd=[]),lO(sd,t,e)}function eh(t,e){e=e.props.ref,t.ref=e!==void 0?e:null}function Lv(t,e){throw e.$$typeof===kH?Error(De(525)):(t=Object.prototype.toString.call(e),Error(De(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)))}function iR(t){var e=t._init;return e(t._payload)}function zO(t){function e(b,_){if(t){var x=b.deletions;x===null?(b.deletions=[_],b.flags|=16):x.push(_)}}function r(b,_){if(!t)return null;for(;_!==null;)e(b,_),_=_.sibling;return null}function n(b){for(var _=new Map;b!==null;)b.key!==null?_.set(b.key,b):_.set(b.index,b),b=b.sibling;return _}function i(b,_){return b=zo(b,_),b.index=0,b.sibling=null,b}function a(b,_,x){return b.index=x,t?(x=b.alternate,x!==null?(x=x.index,x<_?(b.flags|=67108866,_):x):(b.flags|=67108866,_)):(b.flags|=1048576,_)}function o(b){return t&&b.alternate===null&&(b.flags|=67108866),b}function s(b,_,x,T){return _===null||_.tag!==6?(_=X_(x,b.mode,T),_.return=b,_):(_=i(_,x),_.return=b,_)}function l(b,_,x,T){var I=x.type;return I===Bc?d(b,_,x.props.children,T,x.key):_!==null&&(_.elementType===I||typeof I=="object"&&I!==null&&I.$$typeof===Ms&&iR(I)===_.type)?(_=i(_,x.props),eh(_,x),_.return=b,_):(_=Rg(x.type,x.key,x.props,null,b.mode,T),eh(_,x),_.return=b,_)}function c(b,_,x,T){return _===null||_.tag!==4||_.stateNode.containerInfo!==x.containerInfo||_.stateNode.implementation!==x.implementation?(_=Q_(x,b.mode,T),_.return=b,_):(_=i(_,x.children||[]),_.return=b,_)}function d(b,_,x,T,I){return _===null||_.tag!==7?(_=cu(x,b.mode,T,I),_.return=b,_):(_=i(_,x),_.return=b,_)}function h(b,_,x){if(typeof _=="string"&&_!==""||typeof _=="number"||typeof _=="bigint")return _=X_(""+_,b.mode,x),_.return=b,_;if(typeof _=="object"&&_!==null){switch(_.$$typeof){case Rv:return x=Rg(_.type,_.key,_.props,null,b.mode,x),eh(x,_),x.return=b,x;case xh:return _=Q_(_,b.mode,x),_.return=b,_;case Ms:var T=_._init;return _=T(_._payload),h(b,_,x)}if(Ch(_)||Yf(_))return _=cu(_,b.mode,x,null),_.return=b,_;if(typeof _.then=="function")return h(b,$v(_),x);if(_.$$typeof===ko)return h(b,kv(b,_),x);Lv(b,_)}return null}function p(b,_,x,T){var I=_!==null?_.key:null;if(typeof x=="string"&&x!==""||typeof x=="number"||typeof x=="bigint")return I!==null?null:s(b,_,""+x,T);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case Rv:return x.key===I?l(b,_,x,T):null;case xh:return x.key===I?c(b,_,x,T):null;case Ms:return I=x._init,x=I(x._payload),p(b,_,x,T)}if(Ch(x)||Yf(x))return I!==null?null:d(b,_,x,T,null);if(typeof x.then=="function")return p(b,_,$v(x),T);if(x.$$typeof===ko)return p(b,_,kv(b,x),T);Lv(b,x)}return null}function m(b,_,x,T,I){if(typeof T=="string"&&T!==""||typeof T=="number"||typeof T=="bigint")return b=b.get(x)||null,s(_,b,""+T,I);if(typeof T=="object"&&T!==null){switch(T.$$typeof){case Rv:return b=b.get(T.key===null?x:T.key)||null,l(_,b,T,I);case xh:return b=b.get(T.key===null?x:T.key)||null,c(_,b,T,I);case Ms:var C=T._init;return T=C(T._payload),m(b,_,x,T,I)}if(Ch(T)||Yf(T))return b=b.get(x)||null,d(_,b,T,I,null);if(typeof T.then=="function")return m(b,_,x,$v(T),I);if(T.$$typeof===ko)return m(b,_,x,kv(_,T),I);Lv(_,T)}return null}function g(b,_,x,T){for(var I=null,C=null,k=_,S=_=0,V=null;k!==null&&S<x.length;S++){k.index>S?(V=k,k=null):V=k.sibling;var z=p(b,k,x[S],T);if(z===null){k===null&&(k=V);break}t&&k&&z.alternate===null&&e(b,k),_=a(z,_,S),C===null?I=z:C.sibling=z,C=z,k=V}if(S===x.length)return r(b,k),kt&&Kl(b,S),I;if(k===null){for(;S<x.length;S++)k=h(b,x[S],T),k!==null&&(_=a(k,_,S),C===null?I=k:C.sibling=k,C=k);return kt&&Kl(b,S),I}for(k=n(k);S<x.length;S++)V=m(k,b,S,x[S],T),V!==null&&(t&&V.alternate!==null&&k.delete(V.key===null?S:V.key),_=a(V,_,S),C===null?I=V:C.sibling=V,C=V);return t&&k.forEach(function(j){return e(b,j)}),kt&&Kl(b,S),I}function y(b,_,x,T){if(x==null)throw Error(De(151));for(var I=null,C=null,k=_,S=_=0,V=null,z=x.next();k!==null&&!z.done;S++,z=x.next()){k.index>S?(V=k,k=null):V=k.sibling;var j=p(b,k,z.value,T);if(j===null){k===null&&(k=V);break}t&&k&&j.alternate===null&&e(b,k),_=a(j,_,S),C===null?I=j:C.sibling=j,C=j,k=V}if(z.done)return r(b,k),kt&&Kl(b,S),I;if(k===null){for(;!z.done;S++,z=x.next())z=h(b,z.value,T),z!==null&&(_=a(z,_,S),C===null?I=z:C.sibling=z,C=z);return kt&&Kl(b,S),I}for(k=n(k);!z.done;S++,z=x.next())z=m(k,b,S,z.value,T),z!==null&&(t&&z.alternate!==null&&k.delete(z.key===null?S:z.key),_=a(z,_,S),C===null?I=z:C.sibling=z,C=z);return t&&k.forEach(function(J){return e(b,J)}),kt&&Kl(b,S),I}function R(b,_,x,T){if(typeof x=="object"&&x!==null&&x.type===Bc&&x.key===null&&(x=x.props.children),typeof x=="object"&&x!==null){switch(x.$$typeof){case Rv:e:{for(var I=x.key;_!==null;){if(_.key===I){if(I=x.type,I===Bc){if(_.tag===7){r(b,_.sibling),T=i(_,x.props.children),T.return=b,b=T;break e}}else if(_.elementType===I||typeof I=="object"&&I!==null&&I.$$typeof===Ms&&iR(I)===_.type){r(b,_.sibling),T=i(_,x.props),eh(T,x),T.return=b,b=T;break e}r(b,_);break}else e(b,_);_=_.sibling}x.type===Bc?(T=cu(x.props.children,b.mode,T,x.key),T.return=b,b=T):(T=Rg(x.type,x.key,x.props,null,b.mode,T),eh(T,x),T.return=b,b=T)}return o(b);case xh:e:{for(I=x.key;_!==null;){if(_.key===I)if(_.tag===4&&_.stateNode.containerInfo===x.containerInfo&&_.stateNode.implementation===x.implementation){r(b,_.sibling),T=i(_,x.children||[]),T.return=b,b=T;break e}else{r(b,_);break}else e(b,_);_=_.sibling}T=Q_(x,b.mode,T),T.return=b,b=T}return o(b);case Ms:return I=x._init,x=I(x._payload),R(b,_,x,T)}if(Ch(x))return g(b,_,x,T);if(Yf(x)){if(I=Yf(x),typeof I!="function")throw Error(De(150));return x=I.call(x),y(b,_,x,T)}if(typeof x.then=="function")return R(b,_,$v(x),T);if(x.$$typeof===ko)return R(b,_,kv(b,x),T);Lv(b,x)}return typeof x=="string"&&x!==""||typeof x=="number"||typeof x=="bigint"?(x=""+x,_!==null&&_.tag===6?(r(b,_.sibling),T=i(_,x),T.return=b,b=T):(r(b,_),T=X_(x,b.mode,T),T.return=b,b=T),o(b)):r(b,_)}return function(b,_,x,T){try{Ep=0;var I=R(b,_,x,T);return sd=null,I}catch(k){if(k===wm||k===eb)throw k;var C=bi(29,k,null,b.mode);return C.lanes=T,C.return=b,C}finally{}}}var Ld=zO(!0),KO=zO(!1),na=uo(null),Qa=null;function $s(t){var e=t.alternate;dr(zr,zr.current&1),dr(na,t),Qa===null&&(e===null||Od.current!==null||e.memoizedState!==null)&&(Qa=t)}function HO(t){if(t.tag===22){if(dr(zr,zr.current),dr(na,t),Qa===null){var e=t.alternate;e!==null&&e.memoizedState!==null&&(Qa=t)}}else Ls()}function Ls(){dr(zr,zr.current),dr(na,na.current)}function Bo(t){on(na),Qa===t&&(Qa=null),on(zr)}var zr=uo(0);function Ty(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||$E(r)))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}function rS(t,e,r,n){e=t.memoizedState,r=r(n,e),r=r==null?e:tr({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var bE={enqueueSetState:function(t,e,r){t=t._reactInternals;var n=xi(),i=Ys(n);i.payload=e,r!=null&&(i.callback=r),e=Js(t,i,n),e!==null&&(Ci(e,t,n),Gh(e,t,n))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var n=xi(),i=Ys(n);i.tag=1,i.payload=e,r!=null&&(i.callback=r),e=Js(t,i,n),e!==null&&(Ci(e,t,n),Gh(e,t,n))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=xi(),n=Ys(r);n.tag=2,e!=null&&(n.callback=e),e=Js(t,n,r),e!==null&&(Ci(e,t,r),Gh(e,t,r))}};function aR(t,e,r,n,i,a,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,a,o):e.prototype&&e.prototype.isPureReactComponent?!_p(r,n)||!_p(i,a):!0}function oR(t,e,r,n){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,n),e.state!==t&&bE.enqueueReplaceState(e,e.state,null)}function Cu(t,e){var r=e;if("ref"in e){r={};for(var n in e)n!=="ref"&&(r[n]=e[n])}if(t=t.defaultProps){r===e&&(r=tr({},r));for(var i in t)r[i]===void 0&&(r[i]=t[i])}return r}var Dy=typeof reportError=="function"?reportError:function(t){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var e=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof t=="object"&&t!==null&&typeof t.message=="string"?String(t.message):String(t),error:t});if(!window.dispatchEvent(e))return}else if(typeof yi=="object"&&typeof yi.emit=="function"){yi.emit("uncaughtException",t);return}console.error(t)};function WO(t){Dy(t)}function GO(t){console.error(t)}function qO(t){Dy(t)}function Ry(t,e){try{var r=t.onUncaughtError;r(e.value,{componentStack:e.stack})}catch(n){setTimeout(function(){throw n})}}function sR(t,e,r){try{var n=t.onCaughtError;n(r.value,{componentStack:r.stack,errorBoundary:e.tag===1?e.stateNode:null})}catch(i){setTimeout(function(){throw i})}}function _E(t,e,r){return r=Ys(r),r.tag=3,r.payload={element:null},r.callback=function(){Ry(t,e)},r}function ZO(t){return t=Ys(t),t.tag=3,t}function YO(t,e,r,n){var i=r.type.getDerivedStateFromError;if(typeof i=="function"){var a=n.value;t.payload=function(){return i(a)},t.callback=function(){sR(e,r,n)}}var o=r.stateNode;o!==null&&typeof o.componentDidCatch=="function"&&(t.callback=function(){sR(e,r,n),typeof i!="function"&&(Xs===null?Xs=new Set([this]):Xs.add(this));var s=n.stack;this.componentDidCatch(n.value,{componentStack:s!==null?s:""})})}function iG(t,e,r,n,i){if(r.flags|=32768,n!==null&&typeof n=="object"&&typeof n.then=="function"){if(e=r.alternate,e!==null&&_m(e,r,i,!0),r=na.current,r!==null){switch(r.tag){case 13:return Qa===null?RE():r.alternate===null&&Sr===0&&(Sr=3),r.flags&=-257,r.flags|=65536,r.lanes=i,n===fE?r.flags|=16384:(e=r.updateQueue,e===null?r.updateQueue=new Set([n]):e.add(n),hS(t,n,i)),!1;case 22:return r.flags|=65536,n===fE?r.flags|=16384:(e=r.updateQueue,e===null?(e={transitions:null,markerInstances:null,retryQueue:new Set([n])},r.updateQueue=e):(r=e.retryQueue,r===null?e.retryQueue=new Set([n]):r.add(n)),hS(t,n,i)),!1}throw Error(De(435,r.tag))}return hS(t,n,i),RE(),!1}if(kt)return e=na.current,e!==null?(!(e.flags&65536)&&(e.flags|=256),e.flags|=65536,e.lanes=i,n!==sE&&(t=Error(De(422),{cause:n}),Sp(Ji(t,r)))):(n!==sE&&(e=Error(De(423),{cause:n}),Sp(Ji(e,r))),t=t.current.alternate,t.flags|=65536,i&=-i,t.lanes|=i,n=Ji(n,r),i=_E(t.stateNode,n,i),eS(t,i),Sr!==4&&(Sr=2)),!1;var a=Error(De(520),{cause:n});if(a=Ji(a,r),Qh===null?Qh=[a]:Qh.push(a),Sr!==4&&(Sr=2),e===null)return!0;n=Ji(n,r),r=e;do{switch(r.tag){case 3:return r.flags|=65536,t=i&-i,r.lanes|=t,t=_E(r.stateNode,n,t),eS(r,t),!1;case 1:if(e=r.type,a=r.stateNode,(r.flags&128)===0&&(typeof e.getDerivedStateFromError=="function"||a!==null&&typeof a.componentDidCatch=="function"&&(Xs===null||!Xs.has(a))))return r.flags|=65536,i&=-i,r.lanes|=i,i=ZO(i),YO(i,t,r,n),eS(r,i),!1}r=r.return}while(r!==null);return!1}var JO=Error(De(461)),nn=!1;function fn(t,e,r,n){e.child=t===null?KO(e,null,r,n):Ld(e,t.child,r,n)}function lR(t,e,r,n,i){r=r.render;var a=e.ref;if("ref"in n){var o={};for(var s in n)s!=="ref"&&(o[s]=n[s])}else o=n;return Eu(e),n=jC(t,e,r,o,a,i),s=VC(),t!==null&&!nn?(zC(t,e,i),Xo(t,e,i)):(kt&&s&&OC(e),e.flags|=1,fn(t,e,n,i),e.child)}function uR(t,e,r,n,i){if(t===null){var a=r.type;return typeof a=="function"&&!kC(a)&&a.defaultProps===void 0&&r.compare===null?(e.tag=15,e.type=a,XO(t,e,a,n,i)):(t=Rg(r.type,null,n,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(a=t.child,!XC(t,i)){var o=a.memoizedProps;if(r=r.compare,r=r!==null?r:_p,r(o,n)&&t.ref===e.ref)return Xo(t,e,i)}return e.flags|=1,t=zo(a,n),t.ref=e.ref,t.return=e,e.child=t}function XO(t,e,r,n,i){if(t!==null){var a=t.memoizedProps;if(_p(a,n)&&t.ref===e.ref)if(nn=!1,e.pendingProps=n=a,XC(t,i))t.flags&131072&&(nn=!0);else return e.lanes=t.lanes,Xo(t,e,i)}return SE(t,e,r,n,i)}function QO(t,e,r){var n=e.pendingProps,i=n.children,a=t!==null?t.memoizedState:null;if(n.mode==="hidden"){if(e.flags&128){if(n=a!==null?a.baseLanes|r:r,t!==null){for(i=e.child=t.child,a=0;i!==null;)a=a|i.lanes|i.childLanes,i=i.sibling;e.childLanes=a&~n}else e.childLanes=0,e.child=null;return cR(t,e,n,r)}if(r&536870912)e.memoizedState={baseLanes:0,cachePool:null},t!==null&&Mg(e,a!==null?a.cachePool:null),a!==null?JD(e,a):mE(),HO(e);else return e.lanes=e.childLanes=536870912,cR(t,e,a!==null?a.baseLanes|r:r,r)}else a!==null?(Mg(e,a.cachePool),JD(e,a),Ls(),e.memoizedState=null):(t!==null&&Mg(e,null),mE(),Ls());return fn(t,e,i,r),e.child}function cR(t,e,r,n){var i=BC();return i=i===null?null:{parent:Vr._currentValue,pool:i},e.memoizedState={baseLanes:r,cachePool:i},t!==null&&Mg(e,null),mE(),HO(e),t!==null&&_m(t,e,n,!0),null}function Ag(t,e){var r=e.ref;if(r===null)t!==null&&t.ref!==null&&(e.flags|=4194816);else{if(typeof r!="function"&&typeof r!="object")throw Error(De(284));(t===null||t.ref!==r)&&(e.flags|=4194816)}}function SE(t,e,r,n,i){return Eu(e),r=jC(t,e,r,n,void 0,i),n=VC(),t!==null&&!nn?(zC(t,e,i),Xo(t,e,i)):(kt&&n&&OC(e),e.flags|=1,fn(t,e,r,i),e.child)}function dR(t,e,r,n,i,a){return Eu(e),e.updateQueue=null,r=fO(e,n,r,i),dO(t),n=VC(),t!==null&&!nn?(zC(t,e,a),Xo(t,e,a)):(kt&&n&&OC(e),e.flags|=1,fn(t,e,r,a),e.child)}function fR(t,e,r,n,i){if(Eu(e),e.stateNode===null){var a=Hc,o=r.contextType;typeof o=="object"&&o!==null&&(a=xn(o)),a=new r(n,a),e.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,a.updater=bE,e.stateNode=a,a._reactInternals=e,a=e.stateNode,a.props=n,a.state=e.memoizedState,a.refs={},NC(e),o=r.contextType,a.context=typeof o=="object"&&o!==null?xn(o):Hc,a.state=e.memoizedState,o=r.getDerivedStateFromProps,typeof o=="function"&&(rS(e,r,o,n),a.state=e.memoizedState),typeof r.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(o=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),o!==a.state&&bE.enqueueReplaceState(a,a.state,null),Zh(e,n,a,i),qh(),a.state=e.memoizedState),typeof a.componentDidMount=="function"&&(e.flags|=4194308),n=!0}else if(t===null){a=e.stateNode;var s=e.memoizedProps,l=Cu(r,s);a.props=l;var c=a.context,d=r.contextType;o=Hc,typeof d=="object"&&d!==null&&(o=xn(d));var h=r.getDerivedStateFromProps;d=typeof h=="function"||typeof a.getSnapshotBeforeUpdate=="function",s=e.pendingProps!==s,d||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(s||c!==o)&&oR(e,a,n,o),Is=!1;var p=e.memoizedState;a.state=p,Zh(e,n,a,i),qh(),c=e.memoizedState,s||p!==c||Is?(typeof h=="function"&&(rS(e,r,h,n),c=e.memoizedState),(l=Is||aR(e,r,l,n,p,c,o))?(d||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=c),a.props=n,a.state=c,a.context=o,n=l):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{a=e.stateNode,hE(t,e),o=e.memoizedProps,d=Cu(r,o),a.props=d,h=e.pendingProps,p=a.context,c=r.contextType,l=Hc,typeof c=="object"&&c!==null&&(l=xn(c)),s=r.getDerivedStateFromProps,(c=typeof s=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==h||p!==l)&&oR(e,a,n,l),Is=!1,p=e.memoizedState,a.state=p,Zh(e,n,a,i),qh();var m=e.memoizedState;o!==h||p!==m||Is||t!==null&&t.dependencies!==null&&Sy(t.dependencies)?(typeof s=="function"&&(rS(e,r,s,n),m=e.memoizedState),(d=Is||aR(e,r,d,n,p,m,l)||t!==null&&t.dependencies!==null&&Sy(t.dependencies))?(c||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(n,m,l),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(n,m,l)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||o===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=m),a.props=n,a.state=m,a.context=l,n=d):(typeof a.componentDidUpdate!="function"||o===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),n=!1)}return a=n,Ag(t,e),n=(e.flags&128)!==0,a||n?(a=e.stateNode,r=n&&typeof r.getDerivedStateFromError!="function"?null:a.render(),e.flags|=1,t!==null&&n?(e.child=Ld(e,t.child,null,i),e.child=Ld(e,null,r,i)):fn(t,e,r,i),e.memoizedState=a.state,t=e.child):t=Xo(t,e,i),t}function hR(t,e,r,n){return bm(),e.flags|=256,fn(t,e,r,n),e.child}var nS={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function iS(t){return{baseLanes:t,cachePool:oO()}}function aS(t,e,r){return t=t!==null?t.childLanes&~r:0,e&&(t|=ea),t}function e$(t,e,r){var n=e.pendingProps,i=!1,a=(e.flags&128)!==0,o;if((o=a)||(o=t!==null&&t.memoizedState===null?!1:(zr.current&2)!==0),o&&(i=!0,e.flags&=-129),o=(e.flags&32)!==0,e.flags&=-33,t===null){if(kt){if(i?$s(e):Ls(),kt){var s=_r,l;if(l=s){e:{for(l=s,s=Ha;l.nodeType!==8;){if(!s){s=null;break e}if(l=_a(l.nextSibling),l===null){s=null;break e}}s=l}s!==null?(e.memoizedState={dehydrated:s,treeContext:du!==null?{id:Oo,overflow:$o}:null,retryLane:536870912,hydrationErrors:null},l=bi(18,null,null,0),l.stateNode=s,l.return=e,e.child=l,kn=e,_r=null,l=!0):l=!1}l||wu(e)}if(s=e.memoizedState,s!==null&&(s=s.dehydrated,s!==null))return $E(s)?e.lanes=32:e.lanes=536870912,null;Bo(e)}return s=n.children,n=n.fallback,i?(Ls(),i=e.mode,s=My({mode:"hidden",children:s},i),n=cu(n,i,r,null),s.return=e,n.return=e,s.sibling=n,e.child=s,i=e.child,i.memoizedState=iS(r),i.childLanes=aS(t,o,r),e.memoizedState=nS,n):($s(e),wE(e,s))}if(l=t.memoizedState,l!==null&&(s=l.dehydrated,s!==null)){if(a)e.flags&256?($s(e),e.flags&=-257,e=oS(t,e,r)):e.memoizedState!==null?(Ls(),e.child=t.child,e.flags|=128,e=null):(Ls(),i=n.fallback,s=e.mode,n=My({mode:"visible",children:n.children},s),i=cu(i,s,r,null),i.flags|=2,n.return=e,i.return=e,n.sibling=i,e.child=n,Ld(e,t.child,null,r),n=e.child,n.memoizedState=iS(r),n.childLanes=aS(t,o,r),e.memoizedState=nS,e=i);else if($s(e),$E(s)){if(o=s.nextSibling&&s.nextSibling.dataset,o)var c=o.dgst;o=c,n=Error(De(419)),n.stack="",n.digest=o,Sp({value:n,source:null,stack:null}),e=oS(t,e,r)}else if(nn||_m(t,e,r,!1),o=(r&t.childLanes)!==0,nn||o){if(o=Xt,o!==null&&(n=r&-r,n=n&42?1:wC(n),n=n&(o.suspendedLanes|r)?0:n,n!==0&&n!==l.retryLane))throw l.retryLane=n,ff(t,n),Ci(o,t,n),JO;s.data==="$?"||RE(),e=oS(t,e,r)}else s.data==="$?"?(e.flags|=192,e.child=t.child,e=null):(t=l.treeContext,_r=_a(s.nextSibling),kn=e,kt=!0,fu=null,Ha=!1,t!==null&&(Gi[qi++]=Oo,Gi[qi++]=$o,Gi[qi++]=du,Oo=t.id,$o=t.overflow,du=e),e=wE(e,n.children),e.flags|=4096);return e}return i?(Ls(),i=n.fallback,s=e.mode,l=t.child,c=l.sibling,n=zo(l,{mode:"hidden",children:n.children}),n.subtreeFlags=l.subtreeFlags&65011712,c!==null?i=zo(c,i):(i=cu(i,s,r,null),i.flags|=2),i.return=e,n.return=e,n.sibling=i,e.child=n,n=i,i=e.child,s=t.child.memoizedState,s===null?s=iS(r):(l=s.cachePool,l!==null?(c=Vr._currentValue,l=l.parent!==c?{parent:c,pool:c}:l):l=oO(),s={baseLanes:s.baseLanes|r,cachePool:l}),i.memoizedState=s,i.childLanes=aS(t,o,r),e.memoizedState=nS,n):($s(e),r=t.child,t=r.sibling,r=zo(r,{mode:"visible",children:n.children}),r.return=e,r.sibling=null,t!==null&&(o=e.deletions,o===null?(e.deletions=[t],e.flags|=16):o.push(t)),e.child=r,e.memoizedState=null,r)}function wE(t,e){return e=My({mode:"visible",children:e},t.mode),e.return=t,t.child=e}function My(t,e){return t=bi(22,t,null,e),t.lanes=0,t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},t}function oS(t,e,r){return Ld(e,t.child,null,r),t=wE(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function pR(t,e,r){t.lanes|=e;var n=t.alternate;n!==null&&(n.lanes|=e),uE(t.return,e,r)}function sS(t,e,r,n,i){var a=t.memoizedState;a===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(a.isBackwards=e,a.rendering=null,a.renderingStartTime=0,a.last=n,a.tail=r,a.tailMode=i)}function t$(t,e,r){var n=e.pendingProps,i=n.revealOrder,a=n.tail;if(fn(t,e,n.children,r),n=zr.current,n&2)n=n&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&pR(t,r,e);else if(t.tag===19)pR(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}switch(dr(zr,n),i){case"forwards":for(r=e.child,i=null;r!==null;)t=r.alternate,t!==null&&Ty(t)===null&&(i=r),r=r.sibling;r=i,r===null?(i=e.child,e.child=null):(i=r.sibling,r.sibling=null),sS(e,!1,i,r,a);break;case"backwards":for(r=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&Ty(t)===null){e.child=i;break}t=i.sibling,i.sibling=r,r=i,i=t}sS(e,!0,r,null,a);break;case"together":sS(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Xo(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),ul|=e.lanes,!(r&e.childLanes))if(t!==null){if(_m(t,e,r,!1),(r&e.childLanes)===0)return null}else return null;if(t!==null&&e.child!==t.child)throw Error(De(153));if(e.child!==null){for(t=e.child,r=zo(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=zo(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function XC(t,e){return t.lanes&e?!0:(t=t.dependencies,!!(t!==null&&Sy(t)))}function aG(t,e,r){switch(e.tag){case 3:hy(e,e.stateNode.containerInfo),Os(e,Vr,t.memoizedState.cache),bm();break;case 27:case 5:Jw(e);break;case 4:hy(e,e.stateNode.containerInfo);break;case 10:Os(e,e.type,e.memoizedProps.value);break;case 13:var n=e.memoizedState;if(n!==null)return n.dehydrated!==null?($s(e),e.flags|=128,null):r&e.child.childLanes?e$(t,e,r):($s(e),t=Xo(t,e,r),t!==null?t.sibling:null);$s(e);break;case 19:var i=(t.flags&128)!==0;if(n=(r&e.childLanes)!==0,n||(_m(t,e,r,!1),n=(r&e.childLanes)!==0),i){if(n)return t$(t,e,r);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),dr(zr,zr.current),n)break;return null;case 22:case 23:return e.lanes=0,QO(t,e,r);case 24:Os(e,Vr,t.memoizedState.cache)}return Xo(t,e,r)}function r$(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps)nn=!0;else{if(!XC(t,r)&&!(e.flags&128))return nn=!1,aG(t,e,r);nn=!!(t.flags&131072)}else nn=!1,kt&&e.flags&1048576&&iO(e,_y,e.index);switch(e.lanes=0,e.tag){case 16:e:{t=e.pendingProps;var n=e.elementType,i=n._init;if(n=i(n._payload),e.type=n,typeof n=="function")kC(n)?(t=Cu(n,t),e.tag=1,e=fR(null,e,n,t,r)):(e.tag=0,e=SE(null,e,n,t,r));else{if(n!=null){if(i=n.$$typeof,i===bC){e.tag=11,e=lR(null,e,n,t,r);break e}else if(i===_C){e.tag=14,e=uR(null,e,n,t,r);break e}}throw e=Zw(n)||n,Error(De(306,e,""))}}return e;case 0:return SE(t,e,e.type,e.pendingProps,r);case 1:return n=e.type,i=Cu(n,e.pendingProps),fR(t,e,n,i,r);case 3:e:{if(hy(e,e.stateNode.containerInfo),t===null)throw Error(De(387));n=e.pendingProps;var a=e.memoizedState;i=a.element,hE(t,e),Zh(e,n,null,r);var o=e.memoizedState;if(n=o.cache,Os(e,Vr,n),n!==a.cache&&cE(e,[Vr],r,!0),qh(),n=o.element,a.isDehydrated)if(a={element:n,isDehydrated:!1,cache:o.cache},e.updateQueue.baseState=a,e.memoizedState=a,e.flags&256){e=hR(t,e,n,r);break e}else if(n!==i){i=Ji(Error(De(424)),e),Sp(i),e=hR(t,e,n,r);break e}else{switch(t=e.stateNode.containerInfo,t.nodeType){case 9:t=t.body;break;default:t=t.nodeName==="HTML"?t.ownerDocument.body:t}for(_r=_a(t.firstChild),kn=e,kt=!0,fu=null,Ha=!0,r=KO(e,null,n,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling}else{if(bm(),n===i){e=Xo(t,e,r);break e}fn(t,e,n,r)}e=e.child}return e;case 26:return Ag(t,e),t===null?(r=PR(e.type,null,e.pendingProps,null))?e.memoizedState=r:kt||(r=e.type,t=e.pendingProps,n=Ly(Zs.current).createElement(r),n[En]=e,n[ti]=t,mn(n,r,t),tn(n),e.stateNode=n):e.memoizedState=PR(e.type,t.memoizedProps,e.pendingProps,t.memoizedState),null;case 27:return Jw(e),t===null&&kt&&(n=e.stateNode=V$(e.type,e.pendingProps,Zs.current),kn=e,Ha=!0,i=_r,_l(e.type)?(LE=i,_r=_a(n.firstChild)):_r=i),fn(t,e,e.pendingProps.children,r),Ag(t,e),t===null&&(e.flags|=4194304),e.child;case 5:return t===null&&kt&&((i=n=_r)&&(n=kG(n,e.type,e.pendingProps,Ha),n!==null?(e.stateNode=n,kn=e,_r=_a(n.firstChild),Ha=!1,i=!0):i=!1),i||wu(e)),Jw(e),i=e.type,a=e.pendingProps,o=t!==null?t.memoizedProps:null,n=a.children,kE(i,a)?n=null:o!==null&&kE(i,o)&&(e.flags|=32),e.memoizedState!==null&&(i=jC(t,e,JW,null,null,r),Dp._currentValue=i),Ag(t,e),fn(t,e,n,r),e.child;case 6:return t===null&&kt&&((t=r=_r)&&(r=OG(r,e.pendingProps,Ha),r!==null?(e.stateNode=r,kn=e,_r=null,t=!0):t=!1),t||wu(e)),null;case 13:return e$(t,e,r);case 4:return hy(e,e.stateNode.containerInfo),n=e.pendingProps,t===null?e.child=Ld(e,null,n,r):fn(t,e,n,r),e.child;case 11:return lR(t,e,e.type,e.pendingProps,r);case 7:return fn(t,e,e.pendingProps,r),e.child;case 8:return fn(t,e,e.pendingProps.children,r),e.child;case 12:return fn(t,e,e.pendingProps.children,r),e.child;case 10:return n=e.pendingProps,Os(e,e.type,n.value),fn(t,e,n.children,r),e.child;case 9:return i=e.type._context,n=e.pendingProps.children,Eu(e),i=xn(i),n=n(i),e.flags|=1,fn(t,e,n,r),e.child;case 14:return uR(t,e,e.type,e.pendingProps,r);case 15:return XO(t,e,e.type,e.pendingProps,r);case 19:return t$(t,e,r);case 31:return n=e.pendingProps,r=e.mode,n={mode:n.mode,children:n.children},t===null?(r=My(n,r),r.ref=e.ref,e.child=r,r.return=e,e=r):(r=zo(t.child,n),r.ref=e.ref,e.child=r,r.return=e,e=r),e;case 22:return QO(t,e,r);case 24:return Eu(e),n=xn(Vr),t===null?(i=BC(),i===null&&(i=Xt,a=LC(),i.pooledCache=a,a.refCount++,a!==null&&(i.pooledCacheLanes|=r),i=a),e.memoizedState={parent:n,cache:i},NC(e),Os(e,Vr,i)):(t.lanes&r&&(hE(t,e),Zh(e,null,null,r),qh()),i=t.memoizedState,a=e.memoizedState,i.parent!==n?(i={parent:n,cache:n},e.memoizedState=i,e.lanes===0&&(e.memoizedState=e.updateQueue.baseState=i),Os(e,Vr,n)):(n=a.cache,Os(e,Vr,n),n!==i.cache&&cE(e,[Vr],r,!0))),fn(t,e,e.pendingProps.children,r),e.child;case 29:throw e.pendingProps}throw Error(De(156,e.tag))}function _o(t){t.flags|=4}function mR(t,e){if(e.type!=="stylesheet"||e.state.loading&4)t.flags&=-16777217;else if(t.flags|=16777216,!H$(e)){if(e=na.current,e!==null&&((Ct&4194048)===Ct?Qa!==null:(Ct&62914560)!==Ct&&!(Ct&536870912)||e!==Qa))throw Wh=fE,sO;t.flags|=8192}}function Bv(t,e){e!==null&&(t.flags|=4),t.flags&16384&&(e=t.tag!==22?R5():536870912,t.lanes|=e,Bd|=e)}function th(t,e){if(!kt)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function mr(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,n=0;if(e)for(var i=t.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&65011712,n|=i.flags&65011712,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=n,t.childLanes=r,e}function oG(t,e,r){var n=e.pendingProps;switch($C(e),e.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return mr(e),null;case 1:return mr(e),null;case 3:return r=e.stateNode,n=null,t!==null&&(n=t.memoizedState.cache),e.memoizedState.cache!==n&&(e.flags|=2048),Ko(Vr),Id(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Qf(e)?_o(e):t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,HD())),mr(e),null;case 26:return r=e.memoizedState,t===null?(_o(e),r!==null?(mr(e),mR(e,r)):(mr(e),e.flags&=-16777217)):r?r!==t.memoizedState?(_o(e),mr(e),mR(e,r)):(mr(e),e.flags&=-16777217):(t.memoizedProps!==n&&_o(e),mr(e),e.flags&=-16777217),null;case 27:py(e),r=Zs.current;var i=e.type;if(t!==null&&e.stateNode!=null)t.memoizedProps!==n&&_o(e);else{if(!n){if(e.stateNode===null)throw Error(De(166));return mr(e),null}t=Ja.current,Qf(e)?zD(e):(t=V$(i,n,r),e.stateNode=t,_o(e))}return mr(e),null;case 5:if(py(e),r=e.type,t!==null&&e.stateNode!=null)t.memoizedProps!==n&&_o(e);else{if(!n){if(e.stateNode===null)throw Error(De(166));return mr(e),null}if(t=Ja.current,Qf(e))zD(e);else{switch(i=Ly(Zs.current),t){case 1:t=i.createElementNS("http://www.w3.org/2000/svg",r);break;case 2:t=i.createElementNS("http://www.w3.org/1998/Math/MathML",r);break;default:switch(r){case"svg":t=i.createElementNS("http://www.w3.org/2000/svg",r);break;case"math":t=i.createElementNS("http://www.w3.org/1998/Math/MathML",r);break;case"script":t=i.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild);break;case"select":t=typeof n.is=="string"?i.createElement("select",{is:n.is}):i.createElement("select"),n.multiple?t.multiple=!0:n.size&&(t.size=n.size);break;default:t=typeof n.is=="string"?i.createElement(r,{is:n.is}):i.createElement(r)}}t[En]=e,t[ti]=n;e:for(i=e.child;i!==null;){if(i.tag===5||i.tag===6)t.appendChild(i.stateNode);else if(i.tag!==4&&i.tag!==27&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===e)break e;for(;i.sibling===null;){if(i.return===null||i.return===e)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}e.stateNode=t;e:switch(mn(t,r,n),r){case"button":case"input":case"select":case"textarea":t=!!n.autoFocus;break e;case"img":t=!0;break e;default:t=!1}t&&_o(e)}}return mr(e),e.flags&=-16777217,null;case 6:if(t&&e.stateNode!=null)t.memoizedProps!==n&&_o(e);else{if(typeof n!="string"&&e.stateNode===null)throw Error(De(166));if(t=Zs.current,Qf(e)){if(t=e.stateNode,r=e.memoizedProps,n=null,i=kn,i!==null)switch(i.tag){case 27:case 5:n=i.memoizedProps}t[En]=e,t=!!(t.nodeValue===r||n!==null&&n.suppressHydrationWarning===!0||U$(t.nodeValue,r)),t||wu(e)}else t=Ly(t).createTextNode(n),t[En]=e,e.stateNode=t}return mr(e),null;case 13:if(n=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(i=Qf(e),n!==null&&n.dehydrated!==null){if(t===null){if(!i)throw Error(De(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(De(317));i[En]=e}else bm(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;mr(e),i=!1}else i=HD(),t!==null&&t.memoizedState!==null&&(t.memoizedState.hydrationErrors=i),i=!0;if(!i)return e.flags&256?(Bo(e),e):(Bo(e),null)}if(Bo(e),e.flags&128)return e.lanes=r,e;if(r=n!==null,t=t!==null&&t.memoizedState!==null,r){n=e.child,i=null,n.alternate!==null&&n.alternate.memoizedState!==null&&n.alternate.memoizedState.cachePool!==null&&(i=n.alternate.memoizedState.cachePool.pool);var a=null;n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(a=n.memoizedState.cachePool.pool),a!==i&&(n.flags|=2048)}return r!==t&&r&&(e.child.flags|=8192),Bv(e,e.updateQueue),mr(e),null;case 4:return Id(),t===null&&oT(e.stateNode.containerInfo),mr(e),null;case 10:return Ko(e.type),mr(e),null;case 19:if(on(zr),i=e.memoizedState,i===null)return mr(e),null;if(n=(e.flags&128)!==0,a=i.rendering,a===null)if(n)th(i,!1);else{if(Sr!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(a=Ty(t),a!==null){for(e.flags|=128,th(i,!1),t=a.updateQueue,e.updateQueue=t,Bv(e,t),e.subtreeFlags=0,t=r,r=e.child;r!==null;)nO(r,t),r=r.sibling;return dr(zr,zr.current&1|2),e.child}t=t.sibling}i.tail!==null&&Xa()>Py&&(e.flags|=128,n=!0,th(i,!1),e.lanes=4194304)}else{if(!n)if(t=Ty(a),t!==null){if(e.flags|=128,n=!0,t=t.updateQueue,e.updateQueue=t,Bv(e,t),th(i,!0),i.tail===null&&i.tailMode==="hidden"&&!a.alternate&&!kt)return mr(e),null}else 2*Xa()-i.renderingStartTime>Py&&r!==536870912&&(e.flags|=128,n=!0,th(i,!1),e.lanes=4194304);i.isBackwards?(a.sibling=e.child,e.child=a):(t=i.last,t!==null?t.sibling=a:e.child=a,i.last=a)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=Xa(),e.sibling=null,t=zr.current,dr(zr,n?t&1|2:t&1),e):(mr(e),null);case 22:case 23:return Bo(e),UC(),n=e.memoizedState!==null,t!==null?t.memoizedState!==null!==n&&(e.flags|=8192):n&&(e.flags|=8192),n?r&536870912&&!(e.flags&128)&&(mr(e),e.subtreeFlags&6&&(e.flags|=8192)):mr(e),r=e.updateQueue,r!==null&&Bv(e,r.retryQueue),r=null,t!==null&&t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(r=t.memoizedState.cachePool.pool),n=null,e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(n=e.memoizedState.cachePool.pool),n!==r&&(e.flags|=2048),t!==null&&on(hu),null;case 24:return r=null,t!==null&&(r=t.memoizedState.cache),e.memoizedState.cache!==r&&(e.flags|=2048),Ko(Vr),mr(e),null;case 25:return null;case 30:return null}throw Error(De(156,e.tag))}function sG(t,e){switch($C(e),e.tag){case 1:return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Ko(Vr),Id(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 26:case 27:case 5:return py(e),null;case 13:if(Bo(e),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(De(340));bm()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return on(zr),null;case 4:return Id(),null;case 10:return Ko(e.type),null;case 22:case 23:return Bo(e),UC(),t!==null&&on(hu),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 24:return Ko(Vr),null;case 25:return null;default:return null}}function n$(t,e){switch($C(e),e.tag){case 3:Ko(Vr),Id();break;case 26:case 27:case 5:py(e);break;case 4:Id();break;case 13:Bo(e);break;case 19:on(zr);break;case 10:Ko(e.type);break;case 22:case 23:Bo(e),UC(),t!==null&&on(hu);break;case 24:Ko(Vr)}}function Cm(t,e){try{var r=e.updateQueue,n=r!==null?r.lastEffect:null;if(n!==null){var i=n.next;r=i;do{if((r.tag&t)===t){n=void 0;var a=r.create,o=r.inst;n=a(),o.destroy=n}r=r.next}while(r!==i)}}catch(s){Gt(e,e.return,s)}}function ll(t,e,r){try{var n=e.updateQueue,i=n!==null?n.lastEffect:null;if(i!==null){var a=i.next;n=a;do{if((n.tag&t)===t){var o=n.inst,s=o.destroy;if(s!==void 0){o.destroy=void 0,i=e;var l=r,c=s;try{c()}catch(d){Gt(i,l,d)}}}n=n.next}while(n!==a)}}catch(d){Gt(e,e.return,d)}}function i$(t){var e=t.updateQueue;if(e!==null){var r=t.stateNode;try{cO(e,r)}catch(n){Gt(t,t.return,n)}}}function a$(t,e,r){r.props=Cu(t.type,t.memoizedProps),r.state=t.memoizedState;try{r.componentWillUnmount()}catch(n){Gt(t,e,n)}}function Jh(t,e){try{var r=t.ref;if(r!==null){switch(t.tag){case 26:case 27:case 5:var n=t.stateNode;break;case 30:n=t.stateNode;break;default:n=t.stateNode}typeof r=="function"?t.refCleanup=r(n):r.current=n}}catch(i){Gt(t,e,i)}}function Ga(t,e){var r=t.ref,n=t.refCleanup;if(r!==null)if(typeof n=="function")try{n()}catch(i){Gt(t,e,i)}finally{t.refCleanup=null,t=t.alternate,t!=null&&(t.refCleanup=null)}else if(typeof r=="function")try{r(null)}catch(i){Gt(t,e,i)}else r.current=null}function o$(t){var e=t.type,r=t.memoizedProps,n=t.stateNode;try{e:switch(e){case"button":case"input":case"select":case"textarea":r.autoFocus&&n.focus();break e;case"img":r.src?n.src=r.src:r.srcSet&&(n.srcset=r.srcSet)}}catch(i){Gt(t,t.return,i)}}function lS(t,e,r){try{var n=t.stateNode;RG(n,t.type,r,e),n[ti]=e}catch(i){Gt(t,t.return,i)}}function s$(t){return t.tag===5||t.tag===3||t.tag===26||t.tag===27&&_l(t.type)||t.tag===4}function uS(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||s$(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.tag===27&&_l(t.type)||t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function EE(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?(r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r).insertBefore(t,e):(e=r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r,e.appendChild(t),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=sb));else if(n!==4&&(n===27&&_l(t.type)&&(r=t.stateNode,e=null),t=t.child,t!==null))for(EE(t,e,r),t=t.sibling;t!==null;)EE(t,e,r),t=t.sibling}function Iy(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(n!==4&&(n===27&&_l(t.type)&&(r=t.stateNode),t=t.child,t!==null))for(Iy(t,e,r),t=t.sibling;t!==null;)Iy(t,e,r),t=t.sibling}function l$(t){var e=t.stateNode,r=t.memoizedProps;try{for(var n=t.type,i=e.attributes;i.length;)e.removeAttributeNode(i[0]);mn(e,n,r),e[En]=t,e[ti]=r}catch(a){Gt(t,t.return,a)}}var Ro=!1,Cr=!1,cS=!1,vR=typeof WeakSet=="function"?WeakSet:Set,Qr=null;function lG(t,e){if(t=t.containerInfo,PE=Fy,t=Z5(t),IC(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,a=n.focusNode;n=n.focusOffset;try{r.nodeType,a.nodeType}catch{r=null;break e}var o=0,s=-1,l=-1,c=0,d=0,h=t,p=null;t:for(;;){for(var m;h!==r||i!==0&&h.nodeType!==3||(s=o+i),h!==a||n!==0&&h.nodeType!==3||(l=o+n),h.nodeType===3&&(o+=h.nodeValue.length),(m=h.firstChild)!==null;)p=h,h=m;for(;;){if(h===t)break t;if(p===r&&++c===i&&(s=o),p===a&&++d===n&&(l=o),(m=h.nextSibling)!==null)break;h=p,p=h.parentNode}h=m}r=s===-1||l===-1?null:{start:s,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(AE={focusedElem:t,selectionRange:r},Fy=!1,Qr=e;Qr!==null;)if(e=Qr,t=e.child,(e.subtreeFlags&1024)!==0&&t!==null)t.return=e,Qr=t;else for(;Qr!==null;){switch(e=Qr,a=e.alternate,t=e.flags,e.tag){case 0:break;case 11:case 15:break;case 1:if(t&1024&&a!==null){t=void 0,r=e,i=a.memoizedProps,a=a.memoizedState,n=r.stateNode;try{var g=Cu(r.type,i,r.elementType===r.type);t=n.getSnapshotBeforeUpdate(g,a),n.__reactInternalSnapshotBeforeUpdate=t}catch(y){Gt(r,r.return,y)}}break;case 3:if(t&1024){if(t=e.stateNode.containerInfo,r=t.nodeType,r===9)OE(t);else if(r===1)switch(t.nodeName){case"HEAD":case"HTML":case"BODY":OE(t);break;default:t.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if(t&1024)throw Error(De(163))}if(t=e.sibling,t!==null){t.return=e.return,Qr=t;break}Qr=e.return}}function u$(t,e,r){var n=r.flags;switch(r.tag){case 0:case 11:case 15:hs(t,r),n&4&&Cm(5,r);break;case 1:if(hs(t,r),n&4)if(t=r.stateNode,e===null)try{t.componentDidMount()}catch(o){Gt(r,r.return,o)}else{var i=Cu(r.type,e.memoizedProps);e=e.memoizedState;try{t.componentDidUpdate(i,e,t.__reactInternalSnapshotBeforeUpdate)}catch(o){Gt(r,r.return,o)}}n&64&&i$(r),n&512&&Jh(r,r.return);break;case 3:if(hs(t,r),n&64&&(t=r.updateQueue,t!==null)){if(e=null,r.child!==null)switch(r.child.tag){case 27:case 5:e=r.child.stateNode;break;case 1:e=r.child.stateNode}try{cO(t,e)}catch(o){Gt(r,r.return,o)}}break;case 27:e===null&&n&4&&l$(r);case 26:case 5:hs(t,r),e===null&&n&4&&o$(r),n&512&&Jh(r,r.return);break;case 12:hs(t,r);break;case 13:hs(t,r),n&4&&f$(t,r),n&64&&(t=r.memoizedState,t!==null&&(t=t.dehydrated,t!==null&&(r=gG.bind(null,r),$G(t,r))));break;case 22:if(n=r.memoizedState!==null||Ro,!n){e=e!==null&&e.memoizedState!==null||Cr,i=Ro;var a=Cr;Ro=n,(Cr=e)&&!a?Ss(t,r,(r.subtreeFlags&8772)!==0):hs(t,r),Ro=i,Cr=a}break;case 30:break;default:hs(t,r)}}function c$(t){var e=t.alternate;e!==null&&(t.alternate=null,c$(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&xC(e)),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}var sr=null,qn=!1;function So(t,e,r){for(r=r.child;r!==null;)d$(t,e,r),r=r.sibling}function d$(t,e,r){if(wi&&typeof wi.onCommitFiberUnmount=="function")try{wi.onCommitFiberUnmount(pm,r)}catch{}switch(r.tag){case 26:Cr||Ga(r,e),So(t,e,r),r.memoizedState?r.memoizedState.count--:r.stateNode&&(r=r.stateNode,r.parentNode.removeChild(r));break;case 27:Cr||Ga(r,e);var n=sr,i=qn;_l(r.type)&&(sr=r.stateNode,qn=!1),So(t,e,r),tp(r.stateNode),sr=n,qn=i;break;case 5:Cr||Ga(r,e);case 6:if(n=sr,i=qn,sr=null,So(t,e,r),sr=n,qn=i,sr!==null)if(qn)try{(sr.nodeType===9?sr.body:sr.nodeName==="HTML"?sr.ownerDocument.body:sr).removeChild(r.stateNode)}catch(a){Gt(r,e,a)}else try{sr.removeChild(r.stateNode)}catch(a){Gt(r,e,a)}break;case 18:sr!==null&&(qn?(t=sr,RR(t.nodeType===9?t.body:t.nodeName==="HTML"?t.ownerDocument.body:t,r.stateNode),Ip(t)):RR(sr,r.stateNode));break;case 4:n=sr,i=qn,sr=r.stateNode.containerInfo,qn=!0,So(t,e,r),sr=n,qn=i;break;case 0:case 11:case 14:case 15:Cr||ll(2,r,e),Cr||ll(4,r,e),So(t,e,r);break;case 1:Cr||(Ga(r,e),n=r.stateNode,typeof n.componentWillUnmount=="function"&&a$(r,e,n)),So(t,e,r);break;case 21:So(t,e,r);break;case 22:Cr=(n=Cr)||r.memoizedState!==null,So(t,e,r),Cr=n;break;default:So(t,e,r)}}function f$(t,e){if(e.memoizedState===null&&(t=e.alternate,t!==null&&(t=t.memoizedState,t!==null&&(t=t.dehydrated,t!==null))))try{Ip(t)}catch(r){Gt(e,e.return,r)}}function uG(t){switch(t.tag){case 13:case 19:var e=t.stateNode;return e===null&&(e=t.stateNode=new vR),e;case 22:return t=t.stateNode,e=t._retryCache,e===null&&(e=t._retryCache=new vR),e;default:throw Error(De(435,t.tag))}}function dS(t,e){var r=uG(t);e.forEach(function(n){var i=yG.bind(null,t,n);r.has(n)||(r.add(n),n.then(i,i))})}function oi(t,e){var r=e.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n],a=t,o=e,s=o;e:for(;s!==null;){switch(s.tag){case 27:if(_l(s.type)){sr=s.stateNode,qn=!1;break e}break;case 5:sr=s.stateNode,qn=!1;break e;case 3:case 4:sr=s.stateNode.containerInfo,qn=!0;break e}s=s.return}if(sr===null)throw Error(De(160));d$(a,o,i),sr=null,qn=!1,a=i.alternate,a!==null&&(a.return=null),i.return=null}if(e.subtreeFlags&13878)for(e=e.child;e!==null;)h$(e,t),e=e.sibling}var ma=null;function h$(t,e){var r=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:oi(e,t),si(t),n&4&&(ll(3,t,t.return),Cm(3,t),ll(5,t,t.return));break;case 1:oi(e,t),si(t),n&512&&(Cr||r===null||Ga(r,r.return)),n&64&&Ro&&(t=t.updateQueue,t!==null&&(n=t.callbacks,n!==null&&(r=t.shared.hiddenCallbacks,t.shared.hiddenCallbacks=r===null?n:r.concat(n))));break;case 26:var i=ma;if(oi(e,t),si(t),n&512&&(Cr||r===null||Ga(r,r.return)),n&4){var a=r!==null?r.memoizedState:null;if(n=t.memoizedState,r===null)if(n===null)if(t.stateNode===null){e:{n=t.type,r=t.memoizedProps,i=i.ownerDocument||i;t:switch(n){case"title":a=i.getElementsByTagName("title")[0],(!a||a[gm]||a[En]||a.namespaceURI==="http://www.w3.org/2000/svg"||a.hasAttribute("itemprop"))&&(a=i.createElement(n),i.head.insertBefore(a,i.querySelector("head > title"))),mn(a,n,r),a[En]=t,tn(a),n=a;break e;case"link":var o=kR("link","href",i).get(n+(r.href||""));if(o){for(var s=0;s<o.length;s++)if(a=o[s],a.getAttribute("href")===(r.href==null||r.href===""?null:r.href)&&a.getAttribute("rel")===(r.rel==null?null:r.rel)&&a.getAttribute("title")===(r.title==null?null:r.title)&&a.getAttribute("crossorigin")===(r.crossOrigin==null?null:r.crossOrigin)){o.splice(s,1);break t}}a=i.createElement(n),mn(a,n,r),i.head.appendChild(a);break;case"meta":if(o=kR("meta","content",i).get(n+(r.content||""))){for(s=0;s<o.length;s++)if(a=o[s],a.getAttribute("content")===(r.content==null?null:""+r.content)&&a.getAttribute("name")===(r.name==null?null:r.name)&&a.getAttribute("property")===(r.property==null?null:r.property)&&a.getAttribute("http-equiv")===(r.httpEquiv==null?null:r.httpEquiv)&&a.getAttribute("charset")===(r.charSet==null?null:r.charSet)){o.splice(s,1);break t}}a=i.createElement(n),mn(a,n,r),i.head.appendChild(a);break;default:throw Error(De(468,n))}a[En]=t,tn(a),n=a}t.stateNode=n}else OR(i,t.type,t.stateNode);else t.stateNode=AR(i,n,t.memoizedProps);else a!==n?(a===null?r.stateNode!==null&&(r=r.stateNode,r.parentNode.removeChild(r)):a.count--,n===null?OR(i,t.type,t.stateNode):AR(i,n,t.memoizedProps)):n===null&&t.stateNode!==null&&lS(t,t.memoizedProps,r.memoizedProps)}break;case 27:oi(e,t),si(t),n&512&&(Cr||r===null||Ga(r,r.return)),r!==null&&n&4&&lS(t,t.memoizedProps,r.memoizedProps);break;case 5:if(oi(e,t),si(t),n&512&&(Cr||r===null||Ga(r,r.return)),t.flags&32){i=t.stateNode;try{Ad(i,"")}catch(m){Gt(t,t.return,m)}}n&4&&t.stateNode!=null&&(i=t.memoizedProps,lS(t,i,r!==null?r.memoizedProps:i)),n&1024&&(cS=!0);break;case 6:if(oi(e,t),si(t),n&4){if(t.stateNode===null)throw Error(De(162));n=t.memoizedProps,r=t.stateNode;try{r.nodeValue=n}catch(m){Gt(t,t.return,m)}}break;case 3:if($g=null,i=ma,ma=By(e.containerInfo),oi(e,t),ma=i,si(t),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Ip(e.containerInfo)}catch(m){Gt(t,t.return,m)}cS&&(cS=!1,p$(t));break;case 4:n=ma,ma=By(t.stateNode.containerInfo),oi(e,t),si(t),ma=n;break;case 12:oi(e,t),si(t);break;case 13:oi(e,t),si(t),t.child.flags&8192&&t.memoizedState!==null!=(r!==null&&r.memoizedState!==null)&&(nT=Xa()),n&4&&(n=t.updateQueue,n!==null&&(t.updateQueue=null,dS(t,n)));break;case 22:i=t.memoizedState!==null;var l=r!==null&&r.memoizedState!==null,c=Ro,d=Cr;if(Ro=c||i,Cr=d||l,oi(e,t),Cr=d,Ro=c,si(t),n&8192)e:for(e=t.stateNode,e._visibility=i?e._visibility&-2:e._visibility|1,i&&(r===null||l||Ro||Cr||Hl(t)),r=null,e=t;;){if(e.tag===5||e.tag===26){if(r===null){l=r=e;try{if(a=l.stateNode,i)o=a.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none";else{s=l.stateNode;var h=l.memoizedProps.style,p=h!=null&&h.hasOwnProperty("display")?h.display:null;s.style.display=p==null||typeof p=="boolean"?"":(""+p).trim()}}catch(m){Gt(l,l.return,m)}}}else if(e.tag===6){if(r===null){l=e;try{l.stateNode.nodeValue=i?"":l.memoizedProps}catch(m){Gt(l,l.return,m)}}}else if((e.tag!==22&&e.tag!==23||e.memoizedState===null||e===t)&&e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;r===e&&(r=null),e=e.return}r===e&&(r=null),e.sibling.return=e.return,e=e.sibling}n&4&&(n=t.updateQueue,n!==null&&(r=n.retryQueue,r!==null&&(n.retryQueue=null,dS(t,r))));break;case 19:oi(e,t),si(t),n&4&&(n=t.updateQueue,n!==null&&(t.updateQueue=null,dS(t,n)));break;case 30:break;case 21:break;default:oi(e,t),si(t)}}function si(t){var e=t.flags;if(e&2){try{for(var r,n=t.return;n!==null;){if(s$(n)){r=n;break}n=n.return}if(r==null)throw Error(De(160));switch(r.tag){case 27:var i=r.stateNode,a=uS(t);Iy(t,a,i);break;case 5:var o=r.stateNode;r.flags&32&&(Ad(o,""),r.flags&=-33);var s=uS(t);Iy(t,s,o);break;case 3:case 4:var l=r.stateNode.containerInfo,c=uS(t);EE(t,c,l);break;default:throw Error(De(161))}}catch(d){Gt(t,t.return,d)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function p$(t){if(t.subtreeFlags&1024)for(t=t.child;t!==null;){var e=t;p$(e),e.tag===5&&e.flags&1024&&e.stateNode.reset(),t=t.sibling}}function hs(t,e){if(e.subtreeFlags&8772)for(e=e.child;e!==null;)u$(t,e.alternate,e),e=e.sibling}function Hl(t){for(t=t.child;t!==null;){var e=t;switch(e.tag){case 0:case 11:case 14:case 15:ll(4,e,e.return),Hl(e);break;case 1:Ga(e,e.return);var r=e.stateNode;typeof r.componentWillUnmount=="function"&&a$(e,e.return,r),Hl(e);break;case 27:tp(e.stateNode);case 26:case 5:Ga(e,e.return),Hl(e);break;case 22:e.memoizedState===null&&Hl(e);break;case 30:Hl(e);break;default:Hl(e)}t=t.sibling}}function Ss(t,e,r){for(r=r&&(e.subtreeFlags&8772)!==0,e=e.child;e!==null;){var n=e.alternate,i=t,a=e,o=a.flags;switch(a.tag){case 0:case 11:case 15:Ss(i,a,r),Cm(4,a);break;case 1:if(Ss(i,a,r),n=a,i=n.stateNode,typeof i.componentDidMount=="function")try{i.componentDidMount()}catch(c){Gt(n,n.return,c)}if(n=a,i=n.updateQueue,i!==null){var s=n.stateNode;try{var l=i.shared.hiddenCallbacks;if(l!==null)for(i.shared.hiddenCallbacks=null,i=0;i<l.length;i++)uO(l[i],s)}catch(c){Gt(n,n.return,c)}}r&&o&64&&i$(a),Jh(a,a.return);break;case 27:l$(a);case 26:case 5:Ss(i,a,r),r&&n===null&&o&4&&o$(a),Jh(a,a.return);break;case 12:Ss(i,a,r);break;case 13:Ss(i,a,r),r&&o&4&&f$(i,a);break;case 22:a.memoizedState===null&&Ss(i,a,r),Jh(a,a.return);break;case 30:break;default:Ss(i,a,r)}e=e.sibling}}function QC(t,e){var r=null;t!==null&&t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(r=t.memoizedState.cachePool.pool),t=null,e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(t=e.memoizedState.cachePool.pool),t!==r&&(t!=null&&t.refCount++,r!=null&&Sm(r))}function eT(t,e){t=null,e.alternate!==null&&(t=e.alternate.memoizedState.cache),e=e.memoizedState.cache,e!==t&&(e.refCount++,t!=null&&Sm(t))}function ka(t,e,r,n){if(e.subtreeFlags&10256)for(e=e.child;e!==null;)m$(t,e,r,n),e=e.sibling}function m$(t,e,r,n){var i=e.flags;switch(e.tag){case 0:case 11:case 15:ka(t,e,r,n),i&2048&&Cm(9,e);break;case 1:ka(t,e,r,n);break;case 3:ka(t,e,r,n),i&2048&&(t=null,e.alternate!==null&&(t=e.alternate.memoizedState.cache),e=e.memoizedState.cache,e!==t&&(e.refCount++,t!=null&&Sm(t)));break;case 12:if(i&2048){ka(t,e,r,n),t=e.stateNode;try{var a=e.memoizedProps,o=a.id,s=a.onPostCommit;typeof s=="function"&&s(o,e.alternate===null?"mount":"update",t.passiveEffectDuration,-0)}catch(l){Gt(e,e.return,l)}}else ka(t,e,r,n);break;case 13:ka(t,e,r,n);break;case 23:break;case 22:a=e.stateNode,o=e.alternate,e.memoizedState!==null?a._visibility&2?ka(t,e,r,n):Xh(t,e):a._visibility&2?ka(t,e,r,n):(a._visibility|=2,Ic(t,e,r,n,(e.subtreeFlags&10256)!==0)),i&2048&&QC(o,e);break;case 24:ka(t,e,r,n),i&2048&&eT(e.alternate,e);break;default:ka(t,e,r,n)}}function Ic(t,e,r,n,i){for(i=i&&(e.subtreeFlags&10256)!==0,e=e.child;e!==null;){var a=t,o=e,s=r,l=n,c=o.flags;switch(o.tag){case 0:case 11:case 15:Ic(a,o,s,l,i),Cm(8,o);break;case 23:break;case 22:var d=o.stateNode;o.memoizedState!==null?d._visibility&2?Ic(a,o,s,l,i):Xh(a,o):(d._visibility|=2,Ic(a,o,s,l,i)),i&&c&2048&&QC(o.alternate,o);break;case 24:Ic(a,o,s,l,i),i&&c&2048&&eT(o.alternate,o);break;default:Ic(a,o,s,l,i)}e=e.sibling}}function Xh(t,e){if(e.subtreeFlags&10256)for(e=e.child;e!==null;){var r=t,n=e,i=n.flags;switch(n.tag){case 22:Xh(r,n),i&2048&&QC(n.alternate,n);break;case 24:Xh(r,n),i&2048&&eT(n.alternate,n);break;default:Xh(r,n)}e=e.sibling}}var Dh=8192;function dc(t){if(t.subtreeFlags&Dh)for(t=t.child;t!==null;)v$(t),t=t.sibling}function v$(t){switch(t.tag){case 26:dc(t),t.flags&Dh&&t.memoizedState!==null&&qG(ma,t.memoizedState,t.memoizedProps);break;case 5:dc(t);break;case 3:case 4:var e=ma;ma=By(t.stateNode.containerInfo),dc(t),ma=e;break;case 22:t.memoizedState===null&&(e=t.alternate,e!==null&&e.memoizedState!==null?(e=Dh,Dh=16777216,dc(t),Dh=e):dc(t));break;default:dc(t)}}function g$(t){var e=t.alternate;if(e!==null&&(t=e.child,t!==null)){e.child=null;do e=t.sibling,t.sibling=null,t=e;while(t!==null)}}function rh(t){var e=t.deletions;if(t.flags&16){if(e!==null)for(var r=0;r<e.length;r++){var n=e[r];Qr=n,b$(n,t)}g$(t)}if(t.subtreeFlags&10256)for(t=t.child;t!==null;)y$(t),t=t.sibling}function y$(t){switch(t.tag){case 0:case 11:case 15:rh(t),t.flags&2048&&ll(9,t,t.return);break;case 3:rh(t);break;case 12:rh(t);break;case 22:var e=t.stateNode;t.memoizedState!==null&&e._visibility&2&&(t.return===null||t.return.tag!==13)?(e._visibility&=-3,kg(t)):rh(t);break;default:rh(t)}}function kg(t){var e=t.deletions;if(t.flags&16){if(e!==null)for(var r=0;r<e.length;r++){var n=e[r];Qr=n,b$(n,t)}g$(t)}for(t=t.child;t!==null;){switch(e=t,e.tag){case 0:case 11:case 15:ll(8,e,e.return),kg(e);break;case 22:r=e.stateNode,r._visibility&2&&(r._visibility&=-3,kg(e));break;default:kg(e)}t=t.sibling}}function b$(t,e){for(;Qr!==null;){var r=Qr;switch(r.tag){case 0:case 11:case 15:ll(8,r,e);break;case 23:case 22:if(r.memoizedState!==null&&r.memoizedState.cachePool!==null){var n=r.memoizedState.cachePool.pool;n!=null&&n.refCount++}break;case 24:Sm(r.memoizedState.cache)}if(n=r.child,n!==null)n.return=r,Qr=n;else e:for(r=t;Qr!==null;){n=Qr;var i=n.sibling,a=n.return;if(c$(n),n===r){Qr=null;break e}if(i!==null){i.return=a,Qr=i;break e}Qr=a}}}var cG={getCacheForType:function(t){var e=xn(Vr),r=e.data.get(t);return r===void 0&&(r=t(),e.data.set(t,r)),r}},dG=typeof WeakMap=="function"?WeakMap:Map,Ut=0,Xt=null,St=null,Ct=0,Nt=0,vi=null,js=!1,hf=!1,tT=!1,Qo=0,Sr=0,ul=0,pu=0,rT=0,ea=0,Bd=0,Qh=null,Zn=null,xE=!1,nT=0,Py=1/0,Ay=null,Xs=null,hn=0,Qs=null,Nd=null,ld=0,CE=0,TE=null,_$=null,ep=0,DE=null;function xi(){if(Ut&2&&Ct!==0)return Ct&-Ct;if(Qe.T!==null){var t=kd;return t!==0?t:aT()}return P5()}function S$(){ea===0&&(ea=!(Ct&536870912)||kt?D5():536870912);var t=na.current;return t!==null&&(t.flags|=32),ea}function Ci(t,e,r){(t===Xt&&(Nt===2||Nt===9)||t.cancelPendingCommit!==null)&&(Ud(t,0),Vs(t,Ct,ea,!1)),vm(t,r),(!(Ut&2)||t!==Xt)&&(t===Xt&&(!(Ut&2)&&(pu|=r),Sr===4&&Vs(t,Ct,ea,!1)),co(t))}function w$(t,e,r){if(Ut&6)throw Error(De(327));var n=!r&&(e&124)===0&&(e&t.expiredLanes)===0||mm(t,e),i=n?pG(t,e):fS(t,e,!0),a=n;do{if(i===0){hf&&!n&&Vs(t,e,0,!1);break}else{if(r=t.current.alternate,a&&!fG(r)){i=fS(t,e,!1),a=!1;continue}if(i===2){if(a=e,t.errorRecoveryDisabledLanes&a)var o=0;else o=t.pendingLanes&-536870913,o=o!==0?o:o&536870912?536870912:0;if(o!==0){e=o;e:{var s=t;i=Qh;var l=s.current.memoizedState.isDehydrated;if(l&&(Ud(s,o).flags|=256),o=fS(s,o,!1),o!==2){if(tT&&!l){s.errorRecoveryDisabledLanes|=a,pu|=a,i=4;break e}a=Zn,Zn=i,a!==null&&(Zn===null?Zn=a:Zn.push.apply(Zn,a))}i=o}if(a=!1,i!==2)continue}}if(i===1){Ud(t,0),Vs(t,e,0,!0);break}e:{switch(n=t,a=i,a){case 0:case 1:throw Error(De(345));case 4:if((e&4194048)!==e)break;case 6:Vs(n,e,ea,!js);break e;case 2:Zn=null;break;case 3:case 5:break;default:throw Error(De(329))}if((e&62914560)===e&&(i=nT+300-Xa(),10<i)){if(Vs(n,e,ea,!js),q0(n,0,!0)!==0)break e;n.timeoutHandle=j$(gR.bind(null,n,r,Zn,Ay,xE,e,ea,pu,Bd,js,a,2,-0,0),i);break e}gR(n,r,Zn,Ay,xE,e,ea,pu,Bd,js,a,0,-0,0)}}break}while(!0);co(t)}function gR(t,e,r,n,i,a,o,s,l,c,d,h,p,m){if(t.timeoutHandle=-1,h=e.subtreeFlags,(h&8192||(h&16785408)===16785408)&&(Tp={stylesheets:null,count:0,unsuspend:GG},v$(e),h=ZG(),h!==null)){t.cancelPendingCommit=h(bR.bind(null,t,e,a,r,n,i,o,s,l,d,1,p,m)),Vs(t,a,o,!c);return}bR(t,e,a,r,n,i,o,s,l)}function fG(t){for(var e=t;;){var r=e.tag;if((r===0||r===11||r===15)&&e.flags&16384&&(r=e.updateQueue,r!==null&&(r=r.stores,r!==null)))for(var n=0;n<r.length;n++){var i=r[n],a=i.getSnapshot;i=i.value;try{if(!Di(a(),i))return!1}catch{return!1}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Vs(t,e,r,n){e&=~rT,e&=~pu,t.suspendedLanes|=e,t.pingedLanes&=~e,n&&(t.warmLanes|=e),n=t.expirationTimes;for(var i=e;0<i;){var a=31-Ei(i),o=1<<a;n[a]=-1,i&=~o}r!==0&&M5(t,r,e)}function ib(){return Ut&6?!0:(Tm(0),!1)}function iT(){if(St!==null){if(Nt===0)var t=St.return;else t=St,Lo=Ku=null,KC(t),sd=null,Ep=0,t=St;for(;t!==null;)n$(t.alternate,t),t=t.return;St=null}}function Ud(t,e){var r=t.timeoutHandle;r!==-1&&(t.timeoutHandle=-1,IG(r)),r=t.cancelPendingCommit,r!==null&&(t.cancelPendingCommit=null,r()),iT(),Xt=t,St=r=zo(t.current,null),Ct=e,Nt=0,vi=null,js=!1,hf=mm(t,e),tT=!1,Bd=ea=rT=pu=ul=Sr=0,Zn=Qh=null,xE=!1,e&8&&(e|=e&32);var n=t.entangledLanes;if(n!==0)for(t=t.entanglements,n&=e;0<n;){var i=31-Ei(n),a=1<<i;e|=t[i],n&=~a}return Qo=e,X0(),r}function E$(t,e){mt=null,Qe.H=Cy,e===wm||e===eb?(e=ZD(),Nt=3):e===sO?(e=ZD(),Nt=4):Nt=e===JO?8:e!==null&&typeof e=="object"&&typeof e.then=="function"?6:1,vi=e,St===null&&(Sr=1,Ry(t,Ji(e,t.current)))}function x$(){var t=Qe.H;return Qe.H=Cy,t===null?Cy:t}function C$(){var t=Qe.A;return Qe.A=cG,t}function RE(){Sr=4,js||(Ct&4194048)!==Ct&&na.current!==null||(hf=!0),!(ul&134217727)&&!(pu&134217727)||Xt===null||Vs(Xt,Ct,ea,!1)}function fS(t,e,r){var n=Ut;Ut|=2;var i=x$(),a=C$();(Xt!==t||Ct!==e)&&(Ay=null,Ud(t,e)),e=!1;var o=Sr;e:do try{if(Nt!==0&&St!==null){var s=St,l=vi;switch(Nt){case 8:iT(),o=6;break e;case 3:case 2:case 9:case 6:na.current===null&&(e=!0);var c=Nt;if(Nt=0,vi=null,qc(t,s,l,c),r&&hf){o=0;break e}break;default:c=Nt,Nt=0,vi=null,qc(t,s,l,c)}}hG(),o=Sr;break}catch(d){E$(t,d)}while(!0);return e&&t.shellSuspendCounter++,Lo=Ku=null,Ut=n,Qe.H=i,Qe.A=a,St===null&&(Xt=null,Ct=0,X0()),o}function hG(){for(;St!==null;)T$(St)}function pG(t,e){var r=Ut;Ut|=2;var n=x$(),i=C$();Xt!==t||Ct!==e?(Ay=null,Py=Xa()+500,Ud(t,e)):hf=mm(t,e);e:do try{if(Nt!==0&&St!==null){e=St;var a=vi;t:switch(Nt){case 1:Nt=0,vi=null,qc(t,e,a,1);break;case 2:case 9:if(qD(a)){Nt=0,vi=null,yR(e);break}e=function(){Nt!==2&&Nt!==9||Xt!==t||(Nt=7),co(t)},a.then(e,e);break e;case 3:Nt=7;break e;case 4:Nt=5;break e;case 7:qD(a)?(Nt=0,vi=null,yR(e)):(Nt=0,vi=null,qc(t,e,a,7));break;case 5:var o=null;switch(St.tag){case 26:o=St.memoizedState;case 5:case 27:var s=St;if(!o||H$(o)){Nt=0,vi=null;var l=s.sibling;if(l!==null)St=l;else{var c=s.return;c!==null?(St=c,ab(c)):St=null}break t}}Nt=0,vi=null,qc(t,e,a,5);break;case 6:Nt=0,vi=null,qc(t,e,a,6);break;case 8:iT(),Sr=6;break e;default:throw Error(De(462))}}mG();break}catch(d){E$(t,d)}while(!0);return Lo=Ku=null,Qe.H=n,Qe.A=i,Ut=r,St!==null?0:(Xt=null,Ct=0,X0(),Sr)}function mG(){for(;St!==null&&!BH();)T$(St)}function T$(t){var e=r$(t.alternate,t,Qo);t.memoizedProps=t.pendingProps,e===null?ab(t):St=e}function yR(t){var e=t,r=e.alternate;switch(e.tag){case 15:case 0:e=dR(r,e,e.pendingProps,e.type,void 0,Ct);break;case 11:e=dR(r,e,e.pendingProps,e.type.render,e.ref,Ct);break;case 5:KC(e);default:n$(r,e),e=St=nO(e,Qo),e=r$(r,e,Qo)}t.memoizedProps=t.pendingProps,e===null?ab(t):St=e}function qc(t,e,r,n){Lo=Ku=null,KC(e),sd=null,Ep=0;var i=e.return;try{if(iG(t,i,e,r,Ct)){Sr=1,Ry(t,Ji(r,t.current)),St=null;return}}catch(a){if(i!==null)throw St=i,a;Sr=1,Ry(t,Ji(r,t.current)),St=null;return}e.flags&32768?(kt||n===1?t=!0:hf||Ct&536870912?t=!1:(js=t=!0,(n===2||n===9||n===3||n===6)&&(n=na.current,n!==null&&n.tag===13&&(n.flags|=16384))),D$(e,t)):ab(e)}function ab(t){var e=t;do{if(e.flags&32768){D$(e,js);return}t=e.return;var r=oG(e.alternate,e,Qo);if(r!==null){St=r;return}if(e=e.sibling,e!==null){St=e;return}St=e=t}while(e!==null);Sr===0&&(Sr=5)}function D$(t,e){do{var r=sG(t.alternate,t);if(r!==null){r.flags&=32767,St=r;return}if(r=t.return,r!==null&&(r.flags|=32768,r.subtreeFlags=0,r.deletions=null),!e&&(t=t.sibling,t!==null)){St=t;return}St=t=r}while(t!==null);Sr=6,St=null}function bR(t,e,r,n,i,a,o,s,l){t.cancelPendingCommit=null;do ob();while(hn!==0);if(Ut&6)throw Error(De(327));if(e!==null){if(e===t.current)throw Error(De(177));if(a=e.lanes|e.childLanes,a|=PC,GH(t,r,a,o,s,l),t===Xt&&(St=Xt=null,Ct=0),Nd=e,Qs=t,ld=r,CE=a,TE=i,_$=n,e.subtreeFlags&10256||e.flags&10256?(t.callbackNode=null,t.callbackPriority=0,bG(my,function(){return A$(),null})):(t.callbackNode=null,t.callbackPriority=0),n=(e.flags&13878)!==0,e.subtreeFlags&13878||n){n=Qe.T,Qe.T=null,i=$t.p,$t.p=2,o=Ut,Ut|=4;try{lG(t,e,r)}finally{Ut=o,$t.p=i,Qe.T=n}}hn=1,R$(),M$(),I$()}}function R$(){if(hn===1){hn=0;var t=Qs,e=Nd,r=(e.flags&13878)!==0;if(e.subtreeFlags&13878||r){r=Qe.T,Qe.T=null;var n=$t.p;$t.p=2;var i=Ut;Ut|=4;try{h$(e,t);var a=AE,o=Z5(t.containerInfo),s=a.focusedElem,l=a.selectionRange;if(o!==s&&s&&s.ownerDocument&&q5(s.ownerDocument.documentElement,s)){if(l!==null&&IC(s)){var c=l.start,d=l.end;if(d===void 0&&(d=c),"selectionStart"in s)s.selectionStart=c,s.selectionEnd=Math.min(d,s.value.length);else{var h=s.ownerDocument||document,p=h&&h.defaultView||window;if(p.getSelection){var m=p.getSelection(),g=s.textContent.length,y=Math.min(l.start,g),R=l.end===void 0?y:Math.min(l.end,g);!m.extend&&y>R&&(o=R,R=y,y=o);var b=FD(s,y),_=FD(s,R);if(b&&_&&(m.rangeCount!==1||m.anchorNode!==b.node||m.anchorOffset!==b.offset||m.focusNode!==_.node||m.focusOffset!==_.offset)){var x=h.createRange();x.setStart(b.node,b.offset),m.removeAllRanges(),y>R?(m.addRange(x),m.extend(_.node,_.offset)):(x.setEnd(_.node,_.offset),m.addRange(x))}}}}for(h=[],m=s;m=m.parentNode;)m.nodeType===1&&h.push({element:m,left:m.scrollLeft,top:m.scrollTop});for(typeof s.focus=="function"&&s.focus(),s=0;s<h.length;s++){var T=h[s];T.element.scrollLeft=T.left,T.element.scrollTop=T.top}}Fy=!!PE,AE=PE=null}finally{Ut=i,$t.p=n,Qe.T=r}}t.current=e,hn=2}}function M$(){if(hn===2){hn=0;var t=Qs,e=Nd,r=(e.flags&8772)!==0;if(e.subtreeFlags&8772||r){r=Qe.T,Qe.T=null;var n=$t.p;$t.p=2;var i=Ut;Ut|=4;try{u$(t,e.alternate,e)}finally{Ut=i,$t.p=n,Qe.T=r}}hn=3}}function I$(){if(hn===4||hn===3){hn=0,NH();var t=Qs,e=Nd,r=ld,n=_$;e.subtreeFlags&10256||e.flags&10256?hn=5:(hn=0,Nd=Qs=null,P$(t,t.pendingLanes));var i=t.pendingLanes;if(i===0&&(Xs=null),EC(r),e=e.stateNode,wi&&typeof wi.onCommitFiberRoot=="function")try{wi.onCommitFiberRoot(pm,e,void 0,(e.current.flags&128)===128)}catch{}if(n!==null){e=Qe.T,i=$t.p,$t.p=2,Qe.T=null;try{for(var a=t.onRecoverableError,o=0;o<n.length;o++){var s=n[o];a(s.value,{componentStack:s.stack})}}finally{Qe.T=e,$t.p=i}}ld&3&&ob(),co(t),i=t.pendingLanes,r&4194090&&i&42?t===DE?ep++:(ep=0,DE=t):ep=0,Tm(0)}}function P$(t,e){(t.pooledCacheLanes&=e)===0&&(e=t.pooledCache,e!=null&&(t.pooledCache=null,Sm(e)))}function ob(t){return R$(),M$(),I$(),A$()}function A$(){if(hn!==5)return!1;var t=Qs,e=CE;CE=0;var r=EC(ld),n=Qe.T,i=$t.p;try{$t.p=32>r?32:r,Qe.T=null,r=TE,TE=null;var a=Qs,o=ld;if(hn=0,Nd=Qs=null,ld=0,Ut&6)throw Error(De(331));var s=Ut;if(Ut|=4,y$(a.current),m$(a,a.current,o,r),Ut=s,Tm(0,!1),wi&&typeof wi.onPostCommitFiberRoot=="function")try{wi.onPostCommitFiberRoot(pm,a)}catch{}return!0}finally{$t.p=i,Qe.T=n,P$(t,e)}}function _R(t,e,r){e=Ji(r,e),e=_E(t.stateNode,e,2),t=Js(t,e,2),t!==null&&(vm(t,2),co(t))}function Gt(t,e,r){if(t.tag===3)_R(t,t,r);else for(;e!==null;){if(e.tag===3){_R(e,t,r);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Xs===null||!Xs.has(n))){t=Ji(r,t),r=ZO(2),n=Js(e,r,2),n!==null&&(YO(r,n,e,t),vm(n,2),co(n));break}}e=e.return}}function hS(t,e,r){var n=t.pingCache;if(n===null){n=t.pingCache=new dG;var i=new Set;n.set(e,i)}else i=n.get(e),i===void 0&&(i=new Set,n.set(e,i));i.has(r)||(tT=!0,i.add(r),t=vG.bind(null,t,e,r),e.then(t,t))}function vG(t,e,r){var n=t.pingCache;n!==null&&n.delete(e),t.pingedLanes|=t.suspendedLanes&r,t.warmLanes&=~r,Xt===t&&(Ct&r)===r&&(Sr===4||Sr===3&&(Ct&62914560)===Ct&&300>Xa()-nT?!(Ut&2)&&Ud(t,0):rT|=r,Bd===Ct&&(Bd=0)),co(t)}function k$(t,e){e===0&&(e=R5()),t=ff(t,e),t!==null&&(vm(t,e),co(t))}function gG(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),k$(t,r)}function yG(t,e){var r=0;switch(t.tag){case 13:var n=t.stateNode,i=t.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=t.stateNode;break;case 22:n=t.stateNode._retryCache;break;default:throw Error(De(314))}n!==null&&n.delete(e),k$(t,r)}function bG(t,e){return SC(t,e)}var ky=null,Pc=null,ME=!1,Oy=!1,pS=!1,mu=0;function co(t){t!==Pc&&t.next===null&&(Pc===null?ky=Pc=t:Pc=Pc.next=t),Oy=!0,ME||(ME=!0,SG())}function Tm(t,e){if(!pS&&Oy){pS=!0;do for(var r=!1,n=ky;n!==null;){if(t!==0){var i=n.pendingLanes;if(i===0)var a=0;else{var o=n.suspendedLanes,s=n.pingedLanes;a=(1<<31-Ei(42|t)+1)-1,a&=i&~(o&~s),a=a&201326741?a&201326741|1:a?a|2:0}a!==0&&(r=!0,SR(n,a))}else a=Ct,a=q0(n,n===Xt?a:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),!(a&3)||mm(n,a)||(r=!0,SR(n,a));n=n.next}while(r);pS=!1}}function _G(){O$()}function O$(){Oy=ME=!1;var t=0;mu!==0&&(MG()&&(t=mu),mu=0);for(var e=Xa(),r=null,n=ky;n!==null;){var i=n.next,a=$$(n,e);a===0?(n.next=null,r===null?ky=i:r.next=i,i===null&&(Pc=r)):(r=n,(t!==0||a&3)&&(Oy=!0)),n=i}Tm(t)}function $$(t,e){for(var r=t.suspendedLanes,n=t.pingedLanes,i=t.expirationTimes,a=t.pendingLanes&-62914561;0<a;){var o=31-Ei(a),s=1<<o,l=i[o];l===-1?(!(s&r)||s&n)&&(i[o]=WH(s,e)):l<=e&&(t.expiredLanes|=s),a&=~s}if(e=Xt,r=Ct,r=q0(t,t===e?r:0,t.cancelPendingCommit!==null||t.timeoutHandle!==-1),n=t.callbackNode,r===0||t===e&&(Nt===2||Nt===9)||t.cancelPendingCommit!==null)return n!==null&&n!==null&&F_(n),t.callbackNode=null,t.callbackPriority=0;if(!(r&3)||mm(t,r)){if(e=r&-r,e===t.callbackPriority)return e;switch(n!==null&&F_(n),EC(r)){case 2:case 8:r=C5;break;case 32:r=my;break;case 268435456:r=T5;break;default:r=my}return n=L$.bind(null,t),r=SC(r,n),t.callbackPriority=e,t.callbackNode=r,e}return n!==null&&n!==null&&F_(n),t.callbackPriority=2,t.callbackNode=null,2}function L$(t,e){if(hn!==0&&hn!==5)return t.callbackNode=null,t.callbackPriority=0,null;var r=t.callbackNode;if(ob()&&t.callbackNode!==r)return null;var n=Ct;return n=q0(t,t===Xt?n:0,t.cancelPendingCommit!==null||t.timeoutHandle!==-1),n===0?null:(w$(t,n,e),$$(t,Xa()),t.callbackNode!=null&&t.callbackNode===r?L$.bind(null,t):null)}function SR(t,e){if(ob())return null;w$(t,e,!0)}function SG(){PG(function(){Ut&6?SC(x5,_G):O$()})}function aT(){return mu===0&&(mu=D5()),mu}function wR(t){return t==null||typeof t=="symbol"||typeof t=="boolean"?null:typeof t=="function"?t:Cg(""+t)}function ER(t,e){var r=e.ownerDocument.createElement("input");return r.name=e.name,r.value=e.value,t.id&&r.setAttribute("form",t.id),e.parentNode.insertBefore(r,e),t=new FormData(t),r.parentNode.removeChild(r),t}function wG(t,e,r,n,i){if(e==="submit"&&r&&r.stateNode===i){var a=wR((i[ti]||null).action),o=n.submitter;o&&(e=(e=o[ti]||null)?wR(e.formAction):o.getAttribute("formAction"),e!==null&&(a=e,o=null));var s=new Z0("action","action",null,n,i);t.push({event:s,listeners:[{instance:null,listener:function(){if(n.defaultPrevented){if(mu!==0){var l=o?ER(i,o):new FormData(i);yE(r,{pending:!0,data:l,method:i.method,action:a},null,l)}}else typeof a=="function"&&(s.preventDefault(),l=o?ER(i,o):new FormData(i),yE(r,{pending:!0,data:l,method:i.method,action:a},a,l))},currentTarget:i}]})}}for(var mS=0;mS<oE.length;mS++){var vS=oE[mS],EG=vS.toLowerCase(),xG=vS[0].toUpperCase()+vS.slice(1);Da(EG,"on"+xG)}Da(J5,"onAnimationEnd");Da(X5,"onAnimationIteration");Da(Q5,"onAnimationStart");Da("dblclick","onDoubleClick");Da("focusin","onFocus");Da("focusout","onBlur");Da(jW,"onTransitionRun");Da(VW,"onTransitionStart");Da(zW,"onTransitionCancel");Da(eO,"onTransitionEnd");Pd("onMouseEnter",["mouseout","mouseover"]);Pd("onMouseLeave",["mouseout","mouseover"]);Pd("onPointerEnter",["pointerout","pointerover"]);Pd("onPointerLeave",["pointerout","pointerover"]);ju("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ju("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ju("onBeforeInput",["compositionend","keypress","textInput","paste"]);ju("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ju("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ju("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var xp="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),CG=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(xp));function B$(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var n=t[r],i=n.event;n=n.listeners;e:{var a=void 0;if(e)for(var o=n.length-1;0<=o;o--){var s=n[o],l=s.instance,c=s.currentTarget;if(s=s.listener,l!==a&&i.isPropagationStopped())break e;a=s,i.currentTarget=c;try{a(i)}catch(d){Dy(d)}i.currentTarget=null,a=l}else for(o=0;o<n.length;o++){if(s=n[o],l=s.instance,c=s.currentTarget,s=s.listener,l!==a&&i.isPropagationStopped())break e;a=s,i.currentTarget=c;try{a(i)}catch(d){Dy(d)}i.currentTarget=null,a=l}}}}function _t(t,e){var r=e[Qw];r===void 0&&(r=e[Qw]=new Set);var n=t+"__bubble";r.has(n)||(N$(e,t,2,!1),r.add(n))}function gS(t,e,r){var n=0;e&&(n|=4),N$(r,t,n,e)}var Nv="_reactListening"+Math.random().toString(36).slice(2);function oT(t){if(!t[Nv]){t[Nv]=!0,A5.forEach(function(r){r!=="selectionchange"&&(CG.has(r)||gS(r,!1,t),gS(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Nv]||(e[Nv]=!0,gS("selectionchange",!1,e))}}function N$(t,e,r,n){switch(Y$(e)){case 2:var i=XG;break;case 8:i=QG;break;default:i=cT}r=i.bind(null,e,r,t),i=void 0,!nE||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),n?i!==void 0?t.addEventListener(e,r,{capture:!0,passive:i}):t.addEventListener(e,r,!0):i!==void 0?t.addEventListener(e,r,{passive:i}):t.addEventListener(e,r,!1)}function yS(t,e,r,n,i){var a=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var o=n.tag;if(o===3||o===4){var s=n.stateNode.containerInfo;if(s===i)break;if(o===4)for(o=n.return;o!==null;){var l=o.tag;if((l===3||l===4)&&o.stateNode.containerInfo===i)return;o=o.return}for(;s!==null;){if(o=Uc(s),o===null)return;if(l=o.tag,l===5||l===6||l===26||l===27){n=a=o;continue e}s=s.parentNode}}n=n.return}F5(function(){var c=a,d=TC(r),h=[];e:{var p=tO.get(t);if(p!==void 0){var m=Z0,g=t;switch(t){case"keypress":if(Dg(r)===0)break e;case"keydown":case"keyup":m=bW;break;case"focusin":g="focus",m=q_;break;case"focusout":g="blur",m=q_;break;case"beforeblur":case"afterblur":m=q_;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=ID;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=sW;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=wW;break;case J5:case X5:case Q5:m=cW;break;case eO:m=xW;break;case"scroll":case"scrollend":m=aW;break;case"wheel":m=TW;break;case"copy":case"cut":case"paste":m=fW;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=AD;break;case"toggle":case"beforetoggle":m=RW}var y=(e&4)!==0,R=!y&&(t==="scroll"||t==="scrollend"),b=y?p!==null?p+"Capture":null:p;y=[];for(var _=c,x;_!==null;){var T=_;if(x=T.stateNode,T=T.tag,T!==5&&T!==26&&T!==27||x===null||b===null||(T=yp(_,b),T!=null&&y.push(Cp(_,T,x))),R)break;_=_.return}0<y.length&&(p=new m(p,g,null,r,d),h.push({event:p,listeners:y}))}}if(!(e&7)){e:{if(p=t==="mouseover"||t==="pointerover",m=t==="mouseout"||t==="pointerout",p&&r!==rE&&(g=r.relatedTarget||r.fromElement)&&(Uc(g)||g[cf]))break e;if((m||p)&&(p=d.window===d?d:(p=d.ownerDocument)?p.defaultView||p.parentWindow:window,m?(g=r.relatedTarget||r.toElement,m=c,g=g?Uc(g):null,g!==null&&(R=hm(g),y=g.tag,g!==R||y!==5&&y!==27&&y!==6)&&(g=null)):(m=null,g=c),m!==g)){if(y=ID,T="onMouseLeave",b="onMouseEnter",_="mouse",(t==="pointerout"||t==="pointerover")&&(y=AD,T="onPointerLeave",b="onPointerEnter",_="pointer"),R=m==null?p:Th(m),x=g==null?p:Th(g),p=new y(T,_+"leave",m,r,d),p.target=R,p.relatedTarget=x,T=null,Uc(d)===c&&(y=new y(b,_+"enter",g,r,d),y.target=x,y.relatedTarget=R,T=y),R=T,m&&g)t:{for(y=m,b=g,_=0,x=y;x;x=fc(x))_++;for(x=0,T=b;T;T=fc(T))x++;for(;0<_-x;)y=fc(y),_--;for(;0<x-_;)b=fc(b),x--;for(;_--;){if(y===b||b!==null&&y===b.alternate)break t;y=fc(y),b=fc(b)}y=null}else y=null;m!==null&&xR(h,p,m,y,!1),g!==null&&R!==null&&xR(h,R,g,y,!0)}}e:{if(p=c?Th(c):window,m=p.nodeName&&p.nodeName.toLowerCase(),m==="select"||m==="input"&&p.type==="file")var I=LD;else if($D(p))if(W5)I=NW;else{I=LW;var C=$W}else m=p.nodeName,!m||m.toLowerCase()!=="input"||p.type!=="checkbox"&&p.type!=="radio"?c&&CC(c.elementType)&&(I=LD):I=BW;if(I&&(I=I(t,c))){H5(h,I,r,d);break e}C&&C(t,p,c),t==="focusout"&&c&&p.type==="number"&&c.memoizedProps.value!=null&&tE(p,"number",p.value)}switch(C=c?Th(c):window,t){case"focusin":($D(C)||C.contentEditable==="true")&&(Vc=C,iE=c,Kh=null);break;case"focusout":Kh=iE=Vc=null;break;case"mousedown":aE=!0;break;case"contextmenu":case"mouseup":case"dragend":aE=!1,jD(h,r,d);break;case"selectionchange":if(FW)break;case"keydown":case"keyup":jD(h,r,d)}var k;if(MC)e:{switch(t){case"compositionstart":var S="onCompositionStart";break e;case"compositionend":S="onCompositionEnd";break e;case"compositionupdate":S="onCompositionUpdate";break e}S=void 0}else jc?z5(t,r)&&(S="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(S="onCompositionStart");S&&(V5&&r.locale!=="ko"&&(jc||S!=="onCompositionStart"?S==="onCompositionEnd"&&jc&&(k=j5()):(Fs=d,DC="value"in Fs?Fs.value:Fs.textContent,jc=!0)),C=$y(c,S),0<C.length&&(S=new PD(S,t,null,r,d),h.push({event:S,listeners:C}),k?S.data=k:(k=K5(r),k!==null&&(S.data=k)))),(k=IW?PW(t,r):AW(t,r))&&(S=$y(c,"onBeforeInput"),0<S.length&&(C=new PD("onBeforeInput","beforeinput",null,r,d),h.push({event:C,listeners:S}),C.data=k)),wG(h,t,c,r,d)}B$(h,e)})}function Cp(t,e,r){return{instance:t,listener:e,currentTarget:r}}function $y(t,e){for(var r=e+"Capture",n=[];t!==null;){var i=t,a=i.stateNode;if(i=i.tag,i!==5&&i!==26&&i!==27||a===null||(i=yp(t,r),i!=null&&n.unshift(Cp(t,i,a)),i=yp(t,e),i!=null&&n.push(Cp(t,i,a))),t.tag===3)return n;t=t.return}return[]}function fc(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5&&t.tag!==27);return t||null}function xR(t,e,r,n,i){for(var a=e._reactName,o=[];r!==null&&r!==n;){var s=r,l=s.alternate,c=s.stateNode;if(s=s.tag,l!==null&&l===n)break;s!==5&&s!==26&&s!==27||c===null||(l=c,i?(c=yp(r,a),c!=null&&o.unshift(Cp(r,c,l))):i||(c=yp(r,a),c!=null&&o.push(Cp(r,c,l)))),r=r.return}o.length!==0&&t.push({event:e,listeners:o})}var TG=/\r\n?/g,DG=/\u0000|\uFFFD/g;function CR(t){return(typeof t=="string"?t:""+t).replace(TG,`
`).replace(DG,"")}function U$(t,e){return e=CR(e),CR(t)===e}function sb(){}function Ft(t,e,r,n,i,a){switch(r){case"children":typeof n=="string"?e==="body"||e==="textarea"&&n===""||Ad(t,n):(typeof n=="number"||typeof n=="bigint")&&e!=="body"&&Ad(t,""+n);break;case"className":Pv(t,"class",n);break;case"tabIndex":Pv(t,"tabindex",n);break;case"dir":case"role":case"viewBox":case"width":case"height":Pv(t,r,n);break;case"style":U5(t,n,a);break;case"data":if(e!=="object"){Pv(t,"data",n);break}case"src":case"href":if(n===""&&(e!=="a"||r!=="href")){t.removeAttribute(r);break}if(n==null||typeof n=="function"||typeof n=="symbol"||typeof n=="boolean"){t.removeAttribute(r);break}n=Cg(""+n),t.setAttribute(r,n);break;case"action":case"formAction":if(typeof n=="function"){t.setAttribute(r,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof a=="function"&&(r==="formAction"?(e!=="input"&&Ft(t,e,"name",i.name,i,null),Ft(t,e,"formEncType",i.formEncType,i,null),Ft(t,e,"formMethod",i.formMethod,i,null),Ft(t,e,"formTarget",i.formTarget,i,null)):(Ft(t,e,"encType",i.encType,i,null),Ft(t,e,"method",i.method,i,null),Ft(t,e,"target",i.target,i,null)));if(n==null||typeof n=="symbol"||typeof n=="boolean"){t.removeAttribute(r);break}n=Cg(""+n),t.setAttribute(r,n);break;case"onClick":n!=null&&(t.onclick=sb);break;case"onScroll":n!=null&&_t("scroll",t);break;case"onScrollEnd":n!=null&&_t("scrollend",t);break;case"dangerouslySetInnerHTML":if(n!=null){if(typeof n!="object"||!("__html"in n))throw Error(De(61));if(r=n.__html,r!=null){if(i.children!=null)throw Error(De(60));t.innerHTML=r}}break;case"multiple":t.multiple=n&&typeof n!="function"&&typeof n!="symbol";break;case"muted":t.muted=n&&typeof n!="function"&&typeof n!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(n==null||typeof n=="function"||typeof n=="boolean"||typeof n=="symbol"){t.removeAttribute("xlink:href");break}r=Cg(""+n),t.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",r);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":n!=null&&typeof n!="function"&&typeof n!="symbol"?t.setAttribute(r,""+n):t.removeAttribute(r);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":n&&typeof n!="function"&&typeof n!="symbol"?t.setAttribute(r,""):t.removeAttribute(r);break;case"capture":case"download":n===!0?t.setAttribute(r,""):n!==!1&&n!=null&&typeof n!="function"&&typeof n!="symbol"?t.setAttribute(r,n):t.removeAttribute(r);break;case"cols":case"rows":case"size":case"span":n!=null&&typeof n!="function"&&typeof n!="symbol"&&!isNaN(n)&&1<=n?t.setAttribute(r,n):t.removeAttribute(r);break;case"rowSpan":case"start":n==null||typeof n=="function"||typeof n=="symbol"||isNaN(n)?t.removeAttribute(r):t.setAttribute(r,n);break;case"popover":_t("beforetoggle",t),_t("toggle",t),xg(t,"popover",n);break;case"xlinkActuate":bo(t,"http://www.w3.org/1999/xlink","xlink:actuate",n);break;case"xlinkArcrole":bo(t,"http://www.w3.org/1999/xlink","xlink:arcrole",n);break;case"xlinkRole":bo(t,"http://www.w3.org/1999/xlink","xlink:role",n);break;case"xlinkShow":bo(t,"http://www.w3.org/1999/xlink","xlink:show",n);break;case"xlinkTitle":bo(t,"http://www.w3.org/1999/xlink","xlink:title",n);break;case"xlinkType":bo(t,"http://www.w3.org/1999/xlink","xlink:type",n);break;case"xmlBase":bo(t,"http://www.w3.org/XML/1998/namespace","xml:base",n);break;case"xmlLang":bo(t,"http://www.w3.org/XML/1998/namespace","xml:lang",n);break;case"xmlSpace":bo(t,"http://www.w3.org/XML/1998/namespace","xml:space",n);break;case"is":xg(t,"is",n);break;case"innerText":case"textContent":break;default:(!(2<r.length)||r[0]!=="o"&&r[0]!=="O"||r[1]!=="n"&&r[1]!=="N")&&(r=nW.get(r)||r,xg(t,r,n))}}function IE(t,e,r,n,i,a){switch(r){case"style":U5(t,n,a);break;case"dangerouslySetInnerHTML":if(n!=null){if(typeof n!="object"||!("__html"in n))throw Error(De(61));if(r=n.__html,r!=null){if(i.children!=null)throw Error(De(60));t.innerHTML=r}}break;case"children":typeof n=="string"?Ad(t,n):(typeof n=="number"||typeof n=="bigint")&&Ad(t,""+n);break;case"onScroll":n!=null&&_t("scroll",t);break;case"onScrollEnd":n!=null&&_t("scrollend",t);break;case"onClick":n!=null&&(t.onclick=sb);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!k5.hasOwnProperty(r))e:{if(r[0]==="o"&&r[1]==="n"&&(i=r.endsWith("Capture"),e=r.slice(2,i?r.length-7:void 0),a=t[ti]||null,a=a!=null?a[r]:null,typeof a=="function"&&t.removeEventListener(e,a,i),typeof n=="function")){typeof a!="function"&&a!==null&&(r in t?t[r]=null:t.hasAttribute(r)&&t.removeAttribute(r)),t.addEventListener(e,n,i);break e}r in t?t[r]=n:n===!0?t.setAttribute(r,""):xg(t,r,n)}}}function mn(t,e,r){switch(e){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":_t("error",t),_t("load",t);var n=!1,i=!1,a;for(a in r)if(r.hasOwnProperty(a)){var o=r[a];if(o!=null)switch(a){case"src":n=!0;break;case"srcSet":i=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(De(137,e));default:Ft(t,e,a,o,r,null)}}i&&Ft(t,e,"srcSet",r.srcSet,r,null),n&&Ft(t,e,"src",r.src,r,null);return;case"input":_t("invalid",t);var s=a=o=i=null,l=null,c=null;for(n in r)if(r.hasOwnProperty(n)){var d=r[n];if(d!=null)switch(n){case"name":i=d;break;case"type":o=d;break;case"checked":l=d;break;case"defaultChecked":c=d;break;case"value":a=d;break;case"defaultValue":s=d;break;case"children":case"dangerouslySetInnerHTML":if(d!=null)throw Error(De(137,e));break;default:Ft(t,e,n,d,r,null)}}L5(t,a,s,l,c,o,i,!1),vy(t);return;case"select":_t("invalid",t),n=o=a=null;for(i in r)if(r.hasOwnProperty(i)&&(s=r[i],s!=null))switch(i){case"value":a=s;break;case"defaultValue":o=s;break;case"multiple":n=s;default:Ft(t,e,i,s,r,null)}e=a,r=o,t.multiple=!!n,e!=null?rd(t,!!n,e,!1):r!=null&&rd(t,!!n,r,!0);return;case"textarea":_t("invalid",t),a=i=n=null;for(o in r)if(r.hasOwnProperty(o)&&(s=r[o],s!=null))switch(o){case"value":n=s;break;case"defaultValue":i=s;break;case"children":a=s;break;case"dangerouslySetInnerHTML":if(s!=null)throw Error(De(91));break;default:Ft(t,e,o,s,r,null)}N5(t,n,i,a),vy(t);return;case"option":for(l in r)if(r.hasOwnProperty(l)&&(n=r[l],n!=null))switch(l){case"selected":t.selected=n&&typeof n!="function"&&typeof n!="symbol";break;default:Ft(t,e,l,n,r,null)}return;case"dialog":_t("beforetoggle",t),_t("toggle",t),_t("cancel",t),_t("close",t);break;case"iframe":case"object":_t("load",t);break;case"video":case"audio":for(n=0;n<xp.length;n++)_t(xp[n],t);break;case"image":_t("error",t),_t("load",t);break;case"details":_t("toggle",t);break;case"embed":case"source":case"link":_t("error",t),_t("load",t);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(c in r)if(r.hasOwnProperty(c)&&(n=r[c],n!=null))switch(c){case"children":case"dangerouslySetInnerHTML":throw Error(De(137,e));default:Ft(t,e,c,n,r,null)}return;default:if(CC(e)){for(d in r)r.hasOwnProperty(d)&&(n=r[d],n!==void 0&&IE(t,e,d,n,r,void 0));return}}for(s in r)r.hasOwnProperty(s)&&(n=r[s],n!=null&&Ft(t,e,s,n,r,null))}function RG(t,e,r,n){switch(e){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var i=null,a=null,o=null,s=null,l=null,c=null,d=null;for(m in r){var h=r[m];if(r.hasOwnProperty(m)&&h!=null)switch(m){case"checked":break;case"value":break;case"defaultValue":l=h;default:n.hasOwnProperty(m)||Ft(t,e,m,null,n,h)}}for(var p in n){var m=n[p];if(h=r[p],n.hasOwnProperty(p)&&(m!=null||h!=null))switch(p){case"type":a=m;break;case"name":i=m;break;case"checked":c=m;break;case"defaultChecked":d=m;break;case"value":o=m;break;case"defaultValue":s=m;break;case"children":case"dangerouslySetInnerHTML":if(m!=null)throw Error(De(137,e));break;default:m!==h&&Ft(t,e,p,m,n,h)}}eE(t,o,s,l,c,d,a,i);return;case"select":m=o=s=p=null;for(a in r)if(l=r[a],r.hasOwnProperty(a)&&l!=null)switch(a){case"value":break;case"multiple":m=l;default:n.hasOwnProperty(a)||Ft(t,e,a,null,n,l)}for(i in n)if(a=n[i],l=r[i],n.hasOwnProperty(i)&&(a!=null||l!=null))switch(i){case"value":p=a;break;case"defaultValue":s=a;break;case"multiple":o=a;default:a!==l&&Ft(t,e,i,a,n,l)}e=s,r=o,n=m,p!=null?rd(t,!!r,p,!1):!!n!=!!r&&(e!=null?rd(t,!!r,e,!0):rd(t,!!r,r?[]:"",!1));return;case"textarea":m=p=null;for(s in r)if(i=r[s],r.hasOwnProperty(s)&&i!=null&&!n.hasOwnProperty(s))switch(s){case"value":break;case"children":break;default:Ft(t,e,s,null,n,i)}for(o in n)if(i=n[o],a=r[o],n.hasOwnProperty(o)&&(i!=null||a!=null))switch(o){case"value":p=i;break;case"defaultValue":m=i;break;case"children":break;case"dangerouslySetInnerHTML":if(i!=null)throw Error(De(91));break;default:i!==a&&Ft(t,e,o,i,n,a)}B5(t,p,m);return;case"option":for(var g in r)if(p=r[g],r.hasOwnProperty(g)&&p!=null&&!n.hasOwnProperty(g))switch(g){case"selected":t.selected=!1;break;default:Ft(t,e,g,null,n,p)}for(l in n)if(p=n[l],m=r[l],n.hasOwnProperty(l)&&p!==m&&(p!=null||m!=null))switch(l){case"selected":t.selected=p&&typeof p!="function"&&typeof p!="symbol";break;default:Ft(t,e,l,p,n,m)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var y in r)p=r[y],r.hasOwnProperty(y)&&p!=null&&!n.hasOwnProperty(y)&&Ft(t,e,y,null,n,p);for(c in n)if(p=n[c],m=r[c],n.hasOwnProperty(c)&&p!==m&&(p!=null||m!=null))switch(c){case"children":case"dangerouslySetInnerHTML":if(p!=null)throw Error(De(137,e));break;default:Ft(t,e,c,p,n,m)}return;default:if(CC(e)){for(var R in r)p=r[R],r.hasOwnProperty(R)&&p!==void 0&&!n.hasOwnProperty(R)&&IE(t,e,R,void 0,n,p);for(d in n)p=n[d],m=r[d],!n.hasOwnProperty(d)||p===m||p===void 0&&m===void 0||IE(t,e,d,p,n,m);return}}for(var b in r)p=r[b],r.hasOwnProperty(b)&&p!=null&&!n.hasOwnProperty(b)&&Ft(t,e,b,null,n,p);for(h in n)p=n[h],m=r[h],!n.hasOwnProperty(h)||p===m||p==null&&m==null||Ft(t,e,h,p,n,m)}var PE=null,AE=null;function Ly(t){return t.nodeType===9?t:t.ownerDocument}function TR(t){switch(t){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function F$(t,e){if(t===0)switch(e){case"svg":return 1;case"math":return 2;default:return 0}return t===1&&e==="foreignObject"?0:t}function kE(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.children=="bigint"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var bS=null;function MG(){var t=window.event;return t&&t.type==="popstate"?t===bS?!1:(bS=t,!0):(bS=null,!1)}var j$=typeof setTimeout=="function"?setTimeout:void 0,IG=typeof clearTimeout=="function"?clearTimeout:void 0,DR=typeof Promise=="function"?Promise:void 0,PG=typeof queueMicrotask=="function"?queueMicrotask:typeof DR<"u"?function(t){return DR.resolve(null).then(t).catch(AG)}:j$;function AG(t){setTimeout(function(){throw t})}function _l(t){return t==="head"}function RR(t,e){var r=e,n=0,i=0;do{var a=r.nextSibling;if(t.removeChild(r),a&&a.nodeType===8)if(r=a.data,r==="/$"){if(0<n&&8>n){r=n;var o=t.ownerDocument;if(r&1&&tp(o.documentElement),r&2&&tp(o.body),r&4)for(r=o.head,tp(r),o=r.firstChild;o;){var s=o.nextSibling,l=o.nodeName;o[gm]||l==="SCRIPT"||l==="STYLE"||l==="LINK"&&o.rel.toLowerCase()==="stylesheet"||r.removeChild(o),o=s}}if(i===0){t.removeChild(a),Ip(e);return}i--}else r==="$"||r==="$?"||r==="$!"?i++:n=r.charCodeAt(0)-48;else n=0;r=a}while(r);Ip(e)}function OE(t){var e=t.firstChild;for(e&&e.nodeType===10&&(e=e.nextSibling);e;){var r=e;switch(e=e.nextSibling,r.nodeName){case"HTML":case"HEAD":case"BODY":OE(r),xC(r);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(r.rel.toLowerCase()==="stylesheet")continue}t.removeChild(r)}}function kG(t,e,r,n){for(;t.nodeType===1;){var i=r;if(t.nodeName.toLowerCase()!==e.toLowerCase()){if(!n&&(t.nodeName!=="INPUT"||t.type!=="hidden"))break}else if(n){if(!t[gm])switch(e){case"meta":if(!t.hasAttribute("itemprop"))break;return t;case"link":if(a=t.getAttribute("rel"),a==="stylesheet"&&t.hasAttribute("data-precedence"))break;if(a!==i.rel||t.getAttribute("href")!==(i.href==null||i.href===""?null:i.href)||t.getAttribute("crossorigin")!==(i.crossOrigin==null?null:i.crossOrigin)||t.getAttribute("title")!==(i.title==null?null:i.title))break;return t;case"style":if(t.hasAttribute("data-precedence"))break;return t;case"script":if(a=t.getAttribute("src"),(a!==(i.src==null?null:i.src)||t.getAttribute("type")!==(i.type==null?null:i.type)||t.getAttribute("crossorigin")!==(i.crossOrigin==null?null:i.crossOrigin))&&a&&t.hasAttribute("async")&&!t.hasAttribute("itemprop"))break;return t;default:return t}}else if(e==="input"&&t.type==="hidden"){var a=i.name==null?null:""+i.name;if(i.type==="hidden"&&t.getAttribute("name")===a)return t}else return t;if(t=_a(t.nextSibling),t===null)break}return null}function OG(t,e,r){if(e==="")return null;for(;t.nodeType!==3;)if((t.nodeType!==1||t.nodeName!=="INPUT"||t.type!=="hidden")&&!r||(t=_a(t.nextSibling),t===null))return null;return t}function $E(t){return t.data==="$!"||t.data==="$?"&&t.ownerDocument.readyState==="complete"}function $G(t,e){var r=t.ownerDocument;if(t.data!=="$?"||r.readyState==="complete")e();else{var n=function(){e(),r.removeEventListener("DOMContentLoaded",n)};r.addEventListener("DOMContentLoaded",n),t._reactRetry=n}}function _a(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?"||e==="F!"||e==="F")break;if(e==="/$")return null}}return t}var LE=null;function MR(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}function V$(t,e,r){switch(e=Ly(r),t){case"html":if(t=e.documentElement,!t)throw Error(De(452));return t;case"head":if(t=e.head,!t)throw Error(De(453));return t;case"body":if(t=e.body,!t)throw Error(De(454));return t;default:throw Error(De(451))}}function tp(t){for(var e=t.attributes;e.length;)t.removeAttributeNode(e[0]);xC(t)}var ia=new Map,IR=new Set;function By(t){return typeof t.getRootNode=="function"?t.getRootNode():t.nodeType===9?t:t.ownerDocument}var rs=$t.d;$t.d={f:LG,r:BG,D:NG,C:UG,L:FG,m:jG,X:zG,S:VG,M:KG};function LG(){var t=rs.f(),e=ib();return t||e}function BG(t){var e=df(t);e!==null&&e.tag===5&&e.type==="form"?$O(e):rs.r(t)}var pf=typeof document>"u"?null:document;function z$(t,e,r){var n=pf;if(n&&typeof e=="string"&&e){var i=Yi(e);i='link[rel="'+t+'"][href="'+i+'"]',typeof r=="string"&&(i+='[crossorigin="'+r+'"]'),IR.has(i)||(IR.add(i),t={rel:t,crossOrigin:r,href:e},n.querySelector(i)===null&&(e=n.createElement("link"),mn(e,"link",t),tn(e),n.head.appendChild(e)))}}function NG(t){rs.D(t),z$("dns-prefetch",t,null)}function UG(t,e){rs.C(t,e),z$("preconnect",t,e)}function FG(t,e,r){rs.L(t,e,r);var n=pf;if(n&&t&&e){var i='link[rel="preload"][as="'+Yi(e)+'"]';e==="image"&&r&&r.imageSrcSet?(i+='[imagesrcset="'+Yi(r.imageSrcSet)+'"]',typeof r.imageSizes=="string"&&(i+='[imagesizes="'+Yi(r.imageSizes)+'"]')):i+='[href="'+Yi(t)+'"]';var a=i;switch(e){case"style":a=Fd(t);break;case"script":a=mf(t)}ia.has(a)||(t=tr({rel:"preload",href:e==="image"&&r&&r.imageSrcSet?void 0:t,as:e},r),ia.set(a,t),n.querySelector(i)!==null||e==="style"&&n.querySelector(Dm(a))||e==="script"&&n.querySelector(Rm(a))||(e=n.createElement("link"),mn(e,"link",t),tn(e),n.head.appendChild(e)))}}function jG(t,e){rs.m(t,e);var r=pf;if(r&&t){var n=e&&typeof e.as=="string"?e.as:"script",i='link[rel="modulepreload"][as="'+Yi(n)+'"][href="'+Yi(t)+'"]',a=i;switch(n){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":a=mf(t)}if(!ia.has(a)&&(t=tr({rel:"modulepreload",href:t},e),ia.set(a,t),r.querySelector(i)===null)){switch(n){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(r.querySelector(Rm(a)))return}n=r.createElement("link"),mn(n,"link",t),tn(n),r.head.appendChild(n)}}}function VG(t,e,r){rs.S(t,e,r);var n=pf;if(n&&t){var i=td(n).hoistableStyles,a=Fd(t);e=e||"default";var o=i.get(a);if(!o){var s={loading:0,preload:null};if(o=n.querySelector(Dm(a)))s.loading=5;else{t=tr({rel:"stylesheet",href:t,"data-precedence":e},r),(r=ia.get(a))&&sT(t,r);var l=o=n.createElement("link");tn(l),mn(l,"link",t),l._p=new Promise(function(c,d){l.onload=c,l.onerror=d}),l.addEventListener("load",function(){s.loading|=1}),l.addEventListener("error",function(){s.loading|=2}),s.loading|=4,Og(o,e,n)}o={type:"stylesheet",instance:o,count:1,state:s},i.set(a,o)}}}function zG(t,e){rs.X(t,e);var r=pf;if(r&&t){var n=td(r).hoistableScripts,i=mf(t),a=n.get(i);a||(a=r.querySelector(Rm(i)),a||(t=tr({src:t,async:!0},e),(e=ia.get(i))&&lT(t,e),a=r.createElement("script"),tn(a),mn(a,"link",t),r.head.appendChild(a)),a={type:"script",instance:a,count:1,state:null},n.set(i,a))}}function KG(t,e){rs.M(t,e);var r=pf;if(r&&t){var n=td(r).hoistableScripts,i=mf(t),a=n.get(i);a||(a=r.querySelector(Rm(i)),a||(t=tr({src:t,async:!0,type:"module"},e),(e=ia.get(i))&&lT(t,e),a=r.createElement("script"),tn(a),mn(a,"link",t),r.head.appendChild(a)),a={type:"script",instance:a,count:1,state:null},n.set(i,a))}}function PR(t,e,r,n){var i=(i=Zs.current)?By(i):null;if(!i)throw Error(De(446));switch(t){case"meta":case"title":return null;case"style":return typeof r.precedence=="string"&&typeof r.href=="string"?(e=Fd(r.href),r=td(i).hoistableStyles,n=r.get(e),n||(n={type:"style",instance:null,count:0,state:null},r.set(e,n)),n):{type:"void",instance:null,count:0,state:null};case"link":if(r.rel==="stylesheet"&&typeof r.href=="string"&&typeof r.precedence=="string"){t=Fd(r.href);var a=td(i).hoistableStyles,o=a.get(t);if(o||(i=i.ownerDocument||i,o={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},a.set(t,o),(a=i.querySelector(Dm(t)))&&!a._p&&(o.instance=a,o.state.loading=5),ia.has(t)||(r={rel:"preload",as:"style",href:r.href,crossOrigin:r.crossOrigin,integrity:r.integrity,media:r.media,hrefLang:r.hrefLang,referrerPolicy:r.referrerPolicy},ia.set(t,r),a||HG(i,t,r,o.state))),e&&n===null)throw Error(De(528,""));return o}if(e&&n!==null)throw Error(De(529,""));return null;case"script":return e=r.async,r=r.src,typeof r=="string"&&e&&typeof e!="function"&&typeof e!="symbol"?(e=mf(r),r=td(i).hoistableScripts,n=r.get(e),n||(n={type:"script",instance:null,count:0,state:null},r.set(e,n)),n):{type:"void",instance:null,count:0,state:null};default:throw Error(De(444,t))}}function Fd(t){return'href="'+Yi(t)+'"'}function Dm(t){return'link[rel="stylesheet"]['+t+"]"}function K$(t){return tr({},t,{"data-precedence":t.precedence,precedence:null})}function HG(t,e,r,n){t.querySelector('link[rel="preload"][as="style"]['+e+"]")?n.loading=1:(e=t.createElement("link"),n.preload=e,e.addEventListener("load",function(){return n.loading|=1}),e.addEventListener("error",function(){return n.loading|=2}),mn(e,"link",r),tn(e),t.head.appendChild(e))}function mf(t){return'[src="'+Yi(t)+'"]'}function Rm(t){return"script[async]"+t}function AR(t,e,r){if(e.count++,e.instance===null)switch(e.type){case"style":var n=t.querySelector('style[data-href~="'+Yi(r.href)+'"]');if(n)return e.instance=n,tn(n),n;var i=tr({},r,{"data-href":r.href,"data-precedence":r.precedence,href:null,precedence:null});return n=(t.ownerDocument||t).createElement("style"),tn(n),mn(n,"style",i),Og(n,r.precedence,t),e.instance=n;case"stylesheet":i=Fd(r.href);var a=t.querySelector(Dm(i));if(a)return e.state.loading|=4,e.instance=a,tn(a),a;n=K$(r),(i=ia.get(i))&&sT(n,i),a=(t.ownerDocument||t).createElement("link"),tn(a);var o=a;return o._p=new Promise(function(s,l){o.onload=s,o.onerror=l}),mn(a,"link",n),e.state.loading|=4,Og(a,r.precedence,t),e.instance=a;case"script":return a=mf(r.src),(i=t.querySelector(Rm(a)))?(e.instance=i,tn(i),i):(n=r,(i=ia.get(a))&&(n=tr({},r),lT(n,i)),t=t.ownerDocument||t,i=t.createElement("script"),tn(i),mn(i,"link",n),t.head.appendChild(i),e.instance=i);case"void":return null;default:throw Error(De(443,e.type))}else e.type==="stylesheet"&&!(e.state.loading&4)&&(n=e.instance,e.state.loading|=4,Og(n,r.precedence,t));return e.instance}function Og(t,e,r){for(var n=r.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),i=n.length?n[n.length-1]:null,a=i,o=0;o<n.length;o++){var s=n[o];if(s.dataset.precedence===e)a=s;else if(a!==i)break}a?a.parentNode.insertBefore(t,a.nextSibling):(e=r.nodeType===9?r.head:r,e.insertBefore(t,e.firstChild))}function sT(t,e){t.crossOrigin==null&&(t.crossOrigin=e.crossOrigin),t.referrerPolicy==null&&(t.referrerPolicy=e.referrerPolicy),t.title==null&&(t.title=e.title)}function lT(t,e){t.crossOrigin==null&&(t.crossOrigin=e.crossOrigin),t.referrerPolicy==null&&(t.referrerPolicy=e.referrerPolicy),t.integrity==null&&(t.integrity=e.integrity)}var $g=null;function kR(t,e,r){if($g===null){var n=new Map,i=$g=new Map;i.set(r,n)}else i=$g,n=i.get(r),n||(n=new Map,i.set(r,n));if(n.has(t))return n;for(n.set(t,null),r=r.getElementsByTagName(t),i=0;i<r.length;i++){var a=r[i];if(!(a[gm]||a[En]||t==="link"&&a.getAttribute("rel")==="stylesheet")&&a.namespaceURI!=="http://www.w3.org/2000/svg"){var o=a.getAttribute(e)||"";o=t+o;var s=n.get(o);s?s.push(a):n.set(o,[a])}}return n}function OR(t,e,r){t=t.ownerDocument||t,t.head.insertBefore(r,e==="title"?t.querySelector("head > title"):null)}function WG(t,e,r){if(r===1||e.itemProp!=null)return!1;switch(t){case"meta":case"title":return!0;case"style":if(typeof e.precedence!="string"||typeof e.href!="string"||e.href==="")break;return!0;case"link":if(typeof e.rel!="string"||typeof e.href!="string"||e.href===""||e.onLoad||e.onError)break;switch(e.rel){case"stylesheet":return t=e.disabled,typeof e.precedence=="string"&&t==null;default:return!0}case"script":if(e.async&&typeof e.async!="function"&&typeof e.async!="symbol"&&!e.onLoad&&!e.onError&&e.src&&typeof e.src=="string")return!0}return!1}function H$(t){return!(t.type==="stylesheet"&&!(t.state.loading&3))}var Tp=null;function GG(){}function qG(t,e,r){if(Tp===null)throw Error(De(475));var n=Tp;if(e.type==="stylesheet"&&(typeof r.media!="string"||matchMedia(r.media).matches!==!1)&&!(e.state.loading&4)){if(e.instance===null){var i=Fd(r.href),a=t.querySelector(Dm(i));if(a){t=a._p,t!==null&&typeof t=="object"&&typeof t.then=="function"&&(n.count++,n=Ny.bind(n),t.then(n,n)),e.state.loading|=4,e.instance=a,tn(a);return}a=t.ownerDocument||t,r=K$(r),(i=ia.get(i))&&sT(r,i),a=a.createElement("link"),tn(a);var o=a;o._p=new Promise(function(s,l){o.onload=s,o.onerror=l}),mn(a,"link",r),e.instance=a}n.stylesheets===null&&(n.stylesheets=new Map),n.stylesheets.set(e,t),(t=e.state.preload)&&!(e.state.loading&3)&&(n.count++,e=Ny.bind(n),t.addEventListener("load",e),t.addEventListener("error",e))}}function ZG(){if(Tp===null)throw Error(De(475));var t=Tp;return t.stylesheets&&t.count===0&&BE(t,t.stylesheets),0<t.count?function(e){var r=setTimeout(function(){if(t.stylesheets&&BE(t,t.stylesheets),t.unsuspend){var n=t.unsuspend;t.unsuspend=null,n()}},6e4);return t.unsuspend=e,function(){t.unsuspend=null,clearTimeout(r)}}:null}function Ny(){if(this.count--,this.count===0){if(this.stylesheets)BE(this,this.stylesheets);else if(this.unsuspend){var t=this.unsuspend;this.unsuspend=null,t()}}}var Uy=null;function BE(t,e){t.stylesheets=null,t.unsuspend!==null&&(t.count++,Uy=new Map,e.forEach(YG,t),Uy=null,Ny.call(t))}function YG(t,e){if(!(e.state.loading&4)){var r=Uy.get(t);if(r)var n=r.get(null);else{r=new Map,Uy.set(t,r);for(var i=t.querySelectorAll("link[data-precedence],style[data-precedence]"),a=0;a<i.length;a++){var o=i[a];(o.nodeName==="LINK"||o.getAttribute("media")!=="not all")&&(r.set(o.dataset.precedence,o),n=o)}n&&r.set(null,n)}i=e.instance,o=i.getAttribute("data-precedence"),a=r.get(o)||n,a===n&&r.set(null,i),r.set(o,i),this.count++,n=Ny.bind(this),i.addEventListener("load",n),i.addEventListener("error",n),a?a.parentNode.insertBefore(i,a.nextSibling):(t=t.nodeType===9?t.head:t,t.insertBefore(i,t.firstChild)),e.state.loading|=4}}var Dp={$$typeof:ko,Provider:null,Consumer:null,_currentValue:uu,_currentValue2:uu,_threadCount:0};function JG(t,e,r,n,i,a,o,s){this.tag=1,this.containerInfo=t,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=j_(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=j_(0),this.hiddenUpdates=j_(null),this.identifierPrefix=n,this.onUncaughtError=i,this.onCaughtError=a,this.onRecoverableError=o,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=s,this.incompleteTransitions=new Map}function W$(t,e,r,n,i,a,o,s,l,c,d,h){return t=new JG(t,e,r,o,s,l,c,h),e=1,a===!0&&(e|=24),a=bi(3,null,null,e),t.current=a,a.stateNode=t,e=LC(),e.refCount++,t.pooledCache=e,e.refCount++,a.memoizedState={element:n,isDehydrated:r,cache:e},NC(a),t}function G$(t){return t?(t=Hc,t):Hc}function q$(t,e,r,n,i,a){i=G$(i),n.context===null?n.context=i:n.pendingContext=i,n=Ys(e),n.payload={element:r},a=a===void 0?null:a,a!==null&&(n.callback=a),r=Js(t,n,e),r!==null&&(Ci(r,t,e),Gh(r,t,e))}function $R(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function uT(t,e){$R(t,e),(t=t.alternate)&&$R(t,e)}function Z$(t){if(t.tag===13){var e=ff(t,67108864);e!==null&&Ci(e,t,67108864),uT(t,67108864)}}var Fy=!0;function XG(t,e,r,n){var i=Qe.T;Qe.T=null;var a=$t.p;try{$t.p=2,cT(t,e,r,n)}finally{$t.p=a,Qe.T=i}}function QG(t,e,r,n){var i=Qe.T;Qe.T=null;var a=$t.p;try{$t.p=8,cT(t,e,r,n)}finally{$t.p=a,Qe.T=i}}function cT(t,e,r,n){if(Fy){var i=NE(n);if(i===null)yS(t,e,n,jy,r),LR(t,n);else if(tq(i,t,e,r,n))n.stopPropagation();else if(LR(t,n),e&4&&-1<eq.indexOf(t)){for(;i!==null;){var a=df(i);if(a!==null)switch(a.tag){case 3:if(a=a.stateNode,a.current.memoizedState.isDehydrated){var o=zl(a.pendingLanes);if(o!==0){var s=a;for(s.pendingLanes|=2,s.entangledLanes|=2;o;){var l=1<<31-Ei(o);s.entanglements[1]|=l,o&=~l}co(a),!(Ut&6)&&(Py=Xa()+500,Tm(0))}}break;case 13:s=ff(a,2),s!==null&&Ci(s,a,2),ib(),uT(a,2)}if(a=NE(n),a===null&&yS(t,e,n,jy,r),a===i)break;i=a}i!==null&&n.stopPropagation()}else yS(t,e,n,null,r)}}function NE(t){return t=TC(t),dT(t)}var jy=null;function dT(t){if(jy=null,t=Uc(t),t!==null){var e=hm(t);if(e===null)t=null;else{var r=e.tag;if(r===13){if(t=_5(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null)}}return jy=t,null}function Y$(t){switch(t){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(UH()){case x5:return 2;case C5:return 8;case my:case FH:return 32;case T5:return 268435456;default:return 32}default:return 32}}var UE=!1,el=null,tl=null,rl=null,Rp=new Map,Mp=new Map,Bs=[],eq="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function LR(t,e){switch(t){case"focusin":case"focusout":el=null;break;case"dragenter":case"dragleave":tl=null;break;case"mouseover":case"mouseout":rl=null;break;case"pointerover":case"pointerout":Rp.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Mp.delete(e.pointerId)}}function nh(t,e,r,n,i,a){return t===null||t.nativeEvent!==a?(t={blockedOn:e,domEventName:r,eventSystemFlags:n,nativeEvent:a,targetContainers:[i]},e!==null&&(e=df(e),e!==null&&Z$(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function tq(t,e,r,n,i){switch(e){case"focusin":return el=nh(el,t,e,r,n,i),!0;case"dragenter":return tl=nh(tl,t,e,r,n,i),!0;case"mouseover":return rl=nh(rl,t,e,r,n,i),!0;case"pointerover":var a=i.pointerId;return Rp.set(a,nh(Rp.get(a)||null,t,e,r,n,i)),!0;case"gotpointercapture":return a=i.pointerId,Mp.set(a,nh(Mp.get(a)||null,t,e,r,n,i)),!0}return!1}function J$(t){var e=Uc(t.target);if(e!==null){var r=hm(e);if(r!==null){if(e=r.tag,e===13){if(e=_5(r),e!==null){t.blockedOn=e,qH(t.priority,function(){if(r.tag===13){var n=xi();n=wC(n);var i=ff(r,n);i!==null&&Ci(i,r,n),uT(r,n)}});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Lg(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=NE(t.nativeEvent);if(r===null){r=t.nativeEvent;var n=new r.constructor(r.type,r);rE=n,r.target.dispatchEvent(n),rE=null}else return e=df(r),e!==null&&Z$(e),t.blockedOn=r,!1;e.shift()}return!0}function BR(t,e,r){Lg(t)&&r.delete(e)}function rq(){UE=!1,el!==null&&Lg(el)&&(el=null),tl!==null&&Lg(tl)&&(tl=null),rl!==null&&Lg(rl)&&(rl=null),Rp.forEach(BR),Mp.forEach(BR)}function Uv(t,e){t.blockedOn===e&&(t.blockedOn=null,UE||(UE=!0,Hr.unstable_scheduleCallback(Hr.unstable_NormalPriority,rq)))}var Fv=null;function NR(t){Fv!==t&&(Fv=t,Hr.unstable_scheduleCallback(Hr.unstable_NormalPriority,function(){Fv===t&&(Fv=null);for(var e=0;e<t.length;e+=3){var r=t[e],n=t[e+1],i=t[e+2];if(typeof n!="function"){if(dT(n||r)===null)continue;break}var a=df(r);a!==null&&(t.splice(e,3),e-=3,yE(a,{pending:!0,data:i,method:r.method,action:n},n,i))}}))}function Ip(t){function e(l){return Uv(l,t)}el!==null&&Uv(el,t),tl!==null&&Uv(tl,t),rl!==null&&Uv(rl,t),Rp.forEach(e),Mp.forEach(e);for(var r=0;r<Bs.length;r++){var n=Bs[r];n.blockedOn===t&&(n.blockedOn=null)}for(;0<Bs.length&&(r=Bs[0],r.blockedOn===null);)J$(r),r.blockedOn===null&&Bs.shift();if(r=(t.ownerDocument||t).$$reactFormReplay,r!=null)for(n=0;n<r.length;n+=3){var i=r[n],a=r[n+1],o=i[ti]||null;if(typeof a=="function")o||NR(r);else if(o){var s=null;if(a&&a.hasAttribute("formAction")){if(i=a,o=a[ti]||null)s=o.formAction;else if(dT(i)!==null)continue}else s=o.action;typeof s=="function"?r[n+1]=s:(r.splice(n,3),n-=3),NR(r)}}}function fT(t){this._internalRoot=t}lb.prototype.render=fT.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(De(409));var r=e.current,n=xi();q$(r,n,t,e,null,null)};lb.prototype.unmount=fT.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;q$(t.current,2,null,t,null,null),ib(),e[cf]=null}};function lb(t){this._internalRoot=t}lb.prototype.unstable_scheduleHydration=function(t){if(t){var e=P5();t={blockedOn:null,target:t,priority:e};for(var r=0;r<Bs.length&&e!==0&&e<Bs[r].priority;r++);Bs.splice(r,0,t),r===0&&J$(t)}};var UR=y5.version;if(UR!=="19.1.0")throw Error(De(527,UR,"19.1.0"));$t.findDOMNode=function(t){var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(De(188)):(t=Object.keys(t).join(","),Error(De(268,t)));return t=AH(e),t=t!==null?S5(t):null,t=t===null?null:t.stateNode,t};var nq={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:Qe,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var jv=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!jv.isDisabled&&jv.supportsFiber)try{pm=jv.inject(nq),wi=jv}catch{}}H0.createRoot=function(t,e){if(!b5(t))throw Error(De(299));var r=!1,n="",i=WO,a=GO,o=qO,s=null;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onUncaughtError!==void 0&&(i=e.onUncaughtError),e.onCaughtError!==void 0&&(a=e.onCaughtError),e.onRecoverableError!==void 0&&(o=e.onRecoverableError),e.unstable_transitionCallbacks!==void 0&&(s=e.unstable_transitionCallbacks)),e=W$(t,1,!1,null,null,r,n,i,a,o,s,null),t[cf]=e.current,oT(t),new fT(e)};H0.hydrateRoot=function(t,e,r){if(!b5(t))throw Error(De(299));var n=!1,i="",a=WO,o=GO,s=qO,l=null,c=null;return r!=null&&(r.unstable_strictMode===!0&&(n=!0),r.identifierPrefix!==void 0&&(i=r.identifierPrefix),r.onUncaughtError!==void 0&&(a=r.onUncaughtError),r.onCaughtError!==void 0&&(o=r.onCaughtError),r.onRecoverableError!==void 0&&(s=r.onRecoverableError),r.unstable_transitionCallbacks!==void 0&&(l=r.unstable_transitionCallbacks),r.formState!==void 0&&(c=r.formState)),e=W$(t,1,!0,e,r??null,n,i,a,o,s,l,c),e.context=G$(null),r=e.current,n=xi(),n=wC(n),i=Ys(n),i.callback=null,Js(r,i,n),r=n,e.current.lanes=r,vm(e,r),co(e),t[cf]=e.current,oT(t),new lb(e)};H0.version="19.1.0";function X$(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(X$)}catch(t){console.error(t)}}X$(),f5.exports=H0;var iq=f5.exports;const aq=Uu(iq);function oq(t,e){const r=D.useRef(e);D.useEffect(function(){e!==r.current&&t.attributionControl!=null&&(r.current!=null&&t.attributionControl.removeAttribution(r.current),e!=null&&t.attributionControl.addAttribution(e)),r.current=e},[t,e])}const sq=1;function lq(t){return Object.freeze({__version:sq,map:t})}function uq(t,e){return Object.freeze({...t,...e})}const hT=D.createContext(null);function pT(){const t=D.use(hT);if(t==null)throw new Error("No context provided: useLeafletContext() can only be used in a descendant of <MapContainer>");return t}function cq(t){function e(r,n){const{instance:i,context:a}=t(r).current;D.useImperativeHandle(n,()=>i);const{children:o}=r;return o==null?null:We.createElement(hT,{value:a},o)}return D.forwardRef(e)}function dq(t){function e(r,n){const{instance:i}=t(r).current;return D.useImperativeHandle(n,()=>i),null}return D.forwardRef(e)}function Q$(t,e){const r=D.useRef(void 0);D.useEffect(function(){return e!=null&&t.instance.on(e),r.current=e,function(){r.current!=null&&t.instance.off(r.current),r.current=null}},[t,e])}function mT(t,e){const r=t.pane??e.pane;return r?{...t,pane:r}:t}var FE={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */(function(t,e){(function(r,n){n(e)})(Jk,function(r){var n="1.9.4";function i(u){var f,v,w,A;for(v=1,w=arguments.length;v<w;v++){A=arguments[v];for(f in A)u[f]=A[f]}return u}var a=Object.create||function(){function u(){}return function(f){return u.prototype=f,new u}}();function o(u,f){var v=Array.prototype.slice;if(u.bind)return u.bind.apply(u,v.call(arguments,1));var w=v.call(arguments,2);return function(){return u.apply(f,w.length?w.concat(v.call(arguments)):arguments)}}var s=0;function l(u){return"_leaflet_id"in u||(u._leaflet_id=++s),u._leaflet_id}function c(u,f,v){var w,A,W,de;return de=function(){w=!1,A&&(W.apply(v,A),A=!1)},W=function(){w?A=arguments:(u.apply(v,arguments),setTimeout(de,f),w=!0)},W}function d(u,f,v){var w=f[1],A=f[0],W=w-A;return u===w&&v?u:((u-A)%W+W)%W+A}function h(){return!1}function p(u,f){if(f===!1)return u;var v=Math.pow(10,f===void 0?6:f);return Math.round(u*v)/v}function m(u){return u.trim?u.trim():u.replace(/^\s+|\s+$/g,"")}function g(u){return m(u).split(/\s+/)}function y(u,f){Object.prototype.hasOwnProperty.call(u,"options")||(u.options=u.options?a(u.options):{});for(var v in f)u.options[v]=f[v];return u.options}function R(u,f,v){var w=[];for(var A in u)w.push(encodeURIComponent(v?A.toUpperCase():A)+"="+encodeURIComponent(u[A]));return(!f||f.indexOf("?")===-1?"?":"&")+w.join("&")}var b=/\{ *([\w_ -]+) *\}/g;function _(u,f){return u.replace(b,function(v,w){var A=f[w];if(A===void 0)throw new Error("No value provided for variable "+v);return typeof A=="function"&&(A=A(f)),A})}var x=Array.isArray||function(u){return Object.prototype.toString.call(u)==="[object Array]"};function T(u,f){for(var v=0;v<u.length;v++)if(u[v]===f)return v;return-1}var I="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function C(u){return window["webkit"+u]||window["moz"+u]||window["ms"+u]}var k=0;function S(u){var f=+new Date,v=Math.max(0,16-(f-k));return k=f+v,window.setTimeout(u,v)}var V=window.requestAnimationFrame||C("RequestAnimationFrame")||S,z=window.cancelAnimationFrame||C("CancelAnimationFrame")||C("CancelRequestAnimationFrame")||function(u){window.clearTimeout(u)};function j(u,f,v){if(v&&V===S)u.call(f);else return V.call(window,o(u,f))}function J(u){u&&z.call(window,u)}var $={__proto__:null,extend:i,create:a,bind:o,get lastId(){return s},stamp:l,throttle:c,wrapNum:d,falseFn:h,formatNum:p,trim:m,splitWords:g,setOptions:y,getParamString:R,template:_,isArray:x,indexOf:T,emptyImageUrl:I,requestFn:V,cancelFn:z,requestAnimFrame:j,cancelAnimFrame:J};function le(){}le.extend=function(u){var f=function(){y(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},v=f.__super__=this.prototype,w=a(v);w.constructor=f,f.prototype=w;for(var A in this)Object.prototype.hasOwnProperty.call(this,A)&&A!=="prototype"&&A!=="__super__"&&(f[A]=this[A]);return u.statics&&i(f,u.statics),u.includes&&(ie(u.includes),i.apply(null,[w].concat(u.includes))),i(w,u),delete w.statics,delete w.includes,w.options&&(w.options=v.options?a(v.options):{},i(w.options,u.options)),w._initHooks=[],w.callInitHooks=function(){if(!this._initHooksCalled){v.callInitHooks&&v.callInitHooks.call(this),this._initHooksCalled=!0;for(var W=0,de=w._initHooks.length;W<de;W++)w._initHooks[W].call(this)}},f},le.include=function(u){var f=this.prototype.options;return i(this.prototype,u),u.options&&(this.prototype.options=f,this.mergeOptions(u.options)),this},le.mergeOptions=function(u){return i(this.prototype.options,u),this},le.addInitHook=function(u){var f=Array.prototype.slice.call(arguments,1),v=typeof u=="function"?u:function(){this[u].apply(this,f)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(v),this};function ie(u){if(!(typeof L>"u"||!L||!L.Mixin)){u=x(u)?u:[u];for(var f=0;f<u.length;f++)u[f]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var Z={on:function(u,f,v){if(typeof u=="object")for(var w in u)this._on(w,u[w],f);else{u=g(u);for(var A=0,W=u.length;A<W;A++)this._on(u[A],f,v)}return this},off:function(u,f,v){if(!arguments.length)delete this._events;else if(typeof u=="object")for(var w in u)this._off(w,u[w],f);else{u=g(u);for(var A=arguments.length===1,W=0,de=u.length;W<de;W++)A?this._off(u[W]):this._off(u[W],f,v)}return this},_on:function(u,f,v,w){if(typeof f!="function"){console.warn("wrong listener type: "+typeof f);return}if(this._listens(u,f,v)===!1){v===this&&(v=void 0);var A={fn:f,ctx:v};w&&(A.once=!0),this._events=this._events||{},this._events[u]=this._events[u]||[],this._events[u].push(A)}},_off:function(u,f,v){var w,A,W;if(this._events&&(w=this._events[u],!!w)){if(arguments.length===1){if(this._firingCount)for(A=0,W=w.length;A<W;A++)w[A].fn=h;delete this._events[u];return}if(typeof f!="function"){console.warn("wrong listener type: "+typeof f);return}var de=this._listens(u,f,v);if(de!==!1){var ye=w[de];this._firingCount&&(ye.fn=h,this._events[u]=w=w.slice()),w.splice(de,1)}}},fire:function(u,f,v){if(!this.listens(u,v))return this;var w=i({},f,{type:u,target:this,sourceTarget:f&&f.sourceTarget||this});if(this._events){var A=this._events[u];if(A){this._firingCount=this._firingCount+1||1;for(var W=0,de=A.length;W<de;W++){var ye=A[W],Se=ye.fn;ye.once&&this.off(u,Se,ye.ctx),Se.call(ye.ctx||this,w)}this._firingCount--}}return v&&this._propagateEvent(w),this},listens:function(u,f,v,w){typeof u!="string"&&console.warn('"string" type argument expected');var A=f;typeof f!="function"&&(w=!!f,A=void 0,v=void 0);var W=this._events&&this._events[u];if(W&&W.length&&this._listens(u,A,v)!==!1)return!0;if(w){for(var de in this._eventParents)if(this._eventParents[de].listens(u,f,v,w))return!0}return!1},_listens:function(u,f,v){if(!this._events)return!1;var w=this._events[u]||[];if(!f)return!!w.length;v===this&&(v=void 0);for(var A=0,W=w.length;A<W;A++)if(w[A].fn===f&&w[A].ctx===v)return A;return!1},once:function(u,f,v){if(typeof u=="object")for(var w in u)this._on(w,u[w],f,!0);else{u=g(u);for(var A=0,W=u.length;A<W;A++)this._on(u[A],f,v,!0)}return this},addEventParent:function(u){return this._eventParents=this._eventParents||{},this._eventParents[l(u)]=u,this},removeEventParent:function(u){return this._eventParents&&delete this._eventParents[l(u)],this},_propagateEvent:function(u){for(var f in this._eventParents)this._eventParents[f].fire(u.type,i({layer:u.target,propagatedFrom:u.target},u),!0)}};Z.addEventListener=Z.on,Z.removeEventListener=Z.clearAllEventListeners=Z.off,Z.addOneTimeEventListener=Z.once,Z.fireEvent=Z.fire,Z.hasEventListeners=Z.listens;var te=le.extend(Z);function H(u,f,v){this.x=v?Math.round(u):u,this.y=v?Math.round(f):f}var fe=Math.trunc||function(u){return u>0?Math.floor(u):Math.ceil(u)};H.prototype={clone:function(){return new H(this.x,this.y)},add:function(u){return this.clone()._add(ne(u))},_add:function(u){return this.x+=u.x,this.y+=u.y,this},subtract:function(u){return this.clone()._subtract(ne(u))},_subtract:function(u){return this.x-=u.x,this.y-=u.y,this},divideBy:function(u){return this.clone()._divideBy(u)},_divideBy:function(u){return this.x/=u,this.y/=u,this},multiplyBy:function(u){return this.clone()._multiplyBy(u)},_multiplyBy:function(u){return this.x*=u,this.y*=u,this},scaleBy:function(u){return new H(this.x*u.x,this.y*u.y)},unscaleBy:function(u){return new H(this.x/u.x,this.y/u.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=fe(this.x),this.y=fe(this.y),this},distanceTo:function(u){u=ne(u);var f=u.x-this.x,v=u.y-this.y;return Math.sqrt(f*f+v*v)},equals:function(u){return u=ne(u),u.x===this.x&&u.y===this.y},contains:function(u){return u=ne(u),Math.abs(u.x)<=Math.abs(this.x)&&Math.abs(u.y)<=Math.abs(this.y)},toString:function(){return"Point("+p(this.x)+", "+p(this.y)+")"}};function ne(u,f,v){return u instanceof H?u:x(u)?new H(u[0],u[1]):u==null?u:typeof u=="object"&&"x"in u&&"y"in u?new H(u.x,u.y):new H(u,f,v)}function he(u,f){if(u)for(var v=f?[u,f]:u,w=0,A=v.length;w<A;w++)this.extend(v[w])}he.prototype={extend:function(u){var f,v;if(!u)return this;if(u instanceof H||typeof u[0]=="number"||"x"in u)f=v=ne(u);else if(u=oe(u),f=u.min,v=u.max,!f||!v)return this;return!this.min&&!this.max?(this.min=f.clone(),this.max=v.clone()):(this.min.x=Math.min(f.x,this.min.x),this.max.x=Math.max(v.x,this.max.x),this.min.y=Math.min(f.y,this.min.y),this.max.y=Math.max(v.y,this.max.y)),this},getCenter:function(u){return ne((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,u)},getBottomLeft:function(){return ne(this.min.x,this.max.y)},getTopRight:function(){return ne(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(u){var f,v;return typeof u[0]=="number"||u instanceof H?u=ne(u):u=oe(u),u instanceof he?(f=u.min,v=u.max):f=v=u,f.x>=this.min.x&&v.x<=this.max.x&&f.y>=this.min.y&&v.y<=this.max.y},intersects:function(u){u=oe(u);var f=this.min,v=this.max,w=u.min,A=u.max,W=A.x>=f.x&&w.x<=v.x,de=A.y>=f.y&&w.y<=v.y;return W&&de},overlaps:function(u){u=oe(u);var f=this.min,v=this.max,w=u.min,A=u.max,W=A.x>f.x&&w.x<v.x,de=A.y>f.y&&w.y<v.y;return W&&de},isValid:function(){return!!(this.min&&this.max)},pad:function(u){var f=this.min,v=this.max,w=Math.abs(f.x-v.x)*u,A=Math.abs(f.y-v.y)*u;return oe(ne(f.x-w,f.y-A),ne(v.x+w,v.y+A))},equals:function(u){return u?(u=oe(u),this.min.equals(u.getTopLeft())&&this.max.equals(u.getBottomRight())):!1}};function oe(u,f){return!u||u instanceof he?u:new he(u,f)}function me(u,f){if(u)for(var v=f?[u,f]:u,w=0,A=v.length;w<A;w++)this.extend(v[w])}me.prototype={extend:function(u){var f=this._southWest,v=this._northEast,w,A;if(u instanceof Y)w=u,A=u;else if(u instanceof me){if(w=u._southWest,A=u._northEast,!w||!A)return this}else return u?this.extend(q(u)||ee(u)):this;return!f&&!v?(this._southWest=new Y(w.lat,w.lng),this._northEast=new Y(A.lat,A.lng)):(f.lat=Math.min(w.lat,f.lat),f.lng=Math.min(w.lng,f.lng),v.lat=Math.max(A.lat,v.lat),v.lng=Math.max(A.lng,v.lng)),this},pad:function(u){var f=this._southWest,v=this._northEast,w=Math.abs(f.lat-v.lat)*u,A=Math.abs(f.lng-v.lng)*u;return new me(new Y(f.lat-w,f.lng-A),new Y(v.lat+w,v.lng+A))},getCenter:function(){return new Y((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new Y(this.getNorth(),this.getWest())},getSouthEast:function(){return new Y(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(u){typeof u[0]=="number"||u instanceof Y||"lat"in u?u=q(u):u=ee(u);var f=this._southWest,v=this._northEast,w,A;return u instanceof me?(w=u.getSouthWest(),A=u.getNorthEast()):w=A=u,w.lat>=f.lat&&A.lat<=v.lat&&w.lng>=f.lng&&A.lng<=v.lng},intersects:function(u){u=ee(u);var f=this._southWest,v=this._northEast,w=u.getSouthWest(),A=u.getNorthEast(),W=A.lat>=f.lat&&w.lat<=v.lat,de=A.lng>=f.lng&&w.lng<=v.lng;return W&&de},overlaps:function(u){u=ee(u);var f=this._southWest,v=this._northEast,w=u.getSouthWest(),A=u.getNorthEast(),W=A.lat>f.lat&&w.lat<v.lat,de=A.lng>f.lng&&w.lng<v.lng;return W&&de},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(u,f){return u?(u=ee(u),this._southWest.equals(u.getSouthWest(),f)&&this._northEast.equals(u.getNorthEast(),f)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function ee(u,f){return u instanceof me?u:new me(u,f)}function Y(u,f,v){if(isNaN(u)||isNaN(f))throw new Error("Invalid LatLng object: ("+u+", "+f+")");this.lat=+u,this.lng=+f,v!==void 0&&(this.alt=+v)}Y.prototype={equals:function(u,f){if(!u)return!1;u=q(u);var v=Math.max(Math.abs(this.lat-u.lat),Math.abs(this.lng-u.lng));return v<=(f===void 0?1e-9:f)},toString:function(u){return"LatLng("+p(this.lat,u)+", "+p(this.lng,u)+")"},distanceTo:function(u){return F.distance(this,q(u))},wrap:function(){return F.wrapLatLng(this)},toBounds:function(u){var f=180*u/40075017,v=f/Math.cos(Math.PI/180*this.lat);return ee([this.lat-f,this.lng-v],[this.lat+f,this.lng+v])},clone:function(){return new Y(this.lat,this.lng,this.alt)}};function q(u,f,v){return u instanceof Y?u:x(u)&&typeof u[0]!="object"?u.length===3?new Y(u[0],u[1],u[2]):u.length===2?new Y(u[0],u[1]):null:u==null?u:typeof u=="object"&&"lat"in u?new Y(u.lat,"lng"in u?u.lng:u.lon,u.alt):f===void 0?null:new Y(u,f,v)}var X={latLngToPoint:function(u,f){var v=this.projection.project(u),w=this.scale(f);return this.transformation._transform(v,w)},pointToLatLng:function(u,f){var v=this.scale(f),w=this.transformation.untransform(u,v);return this.projection.unproject(w)},project:function(u){return this.projection.project(u)},unproject:function(u){return this.projection.unproject(u)},scale:function(u){return 256*Math.pow(2,u)},zoom:function(u){return Math.log(u/256)/Math.LN2},getProjectedBounds:function(u){if(this.infinite)return null;var f=this.projection.bounds,v=this.scale(u),w=this.transformation.transform(f.min,v),A=this.transformation.transform(f.max,v);return new he(w,A)},infinite:!1,wrapLatLng:function(u){var f=this.wrapLng?d(u.lng,this.wrapLng,!0):u.lng,v=this.wrapLat?d(u.lat,this.wrapLat,!0):u.lat,w=u.alt;return new Y(v,f,w)},wrapLatLngBounds:function(u){var f=u.getCenter(),v=this.wrapLatLng(f),w=f.lat-v.lat,A=f.lng-v.lng;if(w===0&&A===0)return u;var W=u.getSouthWest(),de=u.getNorthEast(),ye=new Y(W.lat-w,W.lng-A),Se=new Y(de.lat-w,de.lng-A);return new me(ye,Se)}},F=i({},X,{wrapLng:[-180,180],R:6371e3,distance:function(u,f){var v=Math.PI/180,w=u.lat*v,A=f.lat*v,W=Math.sin((f.lat-u.lat)*v/2),de=Math.sin((f.lng-u.lng)*v/2),ye=W*W+Math.cos(w)*Math.cos(A)*de*de,Se=2*Math.atan2(Math.sqrt(ye),Math.sqrt(1-ye));return this.R*Se}}),se=6378137,N={R:se,MAX_LATITUDE:85.0511287798,project:function(u){var f=Math.PI/180,v=this.MAX_LATITUDE,w=Math.max(Math.min(v,u.lat),-v),A=Math.sin(w*f);return new H(this.R*u.lng*f,this.R*Math.log((1+A)/(1-A))/2)},unproject:function(u){var f=180/Math.PI;return new Y((2*Math.atan(Math.exp(u.y/this.R))-Math.PI/2)*f,u.x*f/this.R)},bounds:function(){var u=se*Math.PI;return new he([-u,-u],[u,u])}()};function ce(u,f,v,w){if(x(u)){this._a=u[0],this._b=u[1],this._c=u[2],this._d=u[3];return}this._a=u,this._b=f,this._c=v,this._d=w}ce.prototype={transform:function(u,f){return this._transform(u.clone(),f)},_transform:function(u,f){return f=f||1,u.x=f*(this._a*u.x+this._b),u.y=f*(this._c*u.y+this._d),u},untransform:function(u,f){return f=f||1,new H((u.x/f-this._b)/this._a,(u.y/f-this._d)/this._c)}};function ue(u,f,v,w){return new ce(u,f,v,w)}var pe=i({},F,{code:"EPSG:3857",projection:N,transformation:function(){var u=.5/(Math.PI*N.R);return ue(u,.5,-u,.5)}()}),be=i({},pe,{code:"EPSG:900913"});function we(u){return document.createElementNS("http://www.w3.org/2000/svg",u)}function Ce(u,f){var v="",w,A,W,de,ye,Se;for(w=0,W=u.length;w<W;w++){for(ye=u[w],A=0,de=ye.length;A<de;A++)Se=ye[A],v+=(A?"L":"M")+Se.x+" "+Se.y;v+=f?Ve.svg?"z":"x":""}return v||"M0 0"}var $e=document.documentElement.style,Ne="ActiveXObject"in window,Ie=Ne&&!document.addEventListener,Ge="msLaunchUri"in navigator&&!("documentMode"in document),nt=un("webkit"),ze=un("android"),Pe=un("android 2")||un("android 3"),vt=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),Tt=ze&&un("Google")&&vt<537&&!("AudioNode"in window),ir=!!window.opera,B=!Ge&&un("chrome"),M=un("gecko")&&!nt&&!ir&&!Ne,P=!B&&un("safari"),G=un("phantom"),re="OTransition"in $e,Q=navigator.platform.indexOf("Win")===0,ae=Ne&&"transition"in $e,ve="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!Pe,xe="MozPerspective"in $e,Me=!window.L_DISABLE_3D&&(ae||ve||xe)&&!re&&!G,Ee=typeof orientation<"u"||un("mobile"),ke=Ee&&nt,pt=Ee&&ve,gt=!window.PointerEvent&&window.MSPointerEvent,hr=!!(window.PointerEvent||gt),Dn="ontouchstart"in window||!!window.TouchEvent,yn=!window.L_NO_TOUCH&&(Dn||hr),Lf=Ee&&ir,ni=Ee&&M,Bf=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,it=function(){var u=!1;try{var f=Object.defineProperty({},"passive",{get:function(){u=!0}});window.addEventListener("testPassiveEventSupport",h,f),window.removeEventListener("testPassiveEventSupport",h,f)}catch{}return u}(),Xe=function(){return!!document.createElement("canvas").getContext}(),Br=!!(document.createElementNS&&we("svg").createSVGRect),ca=!!Br&&function(){var u=document.createElement("div");return u.innerHTML="<svg/>",(u.firstChild&&u.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"}(),ki=!Br&&function(){try{var u=document.createElement("div");u.innerHTML='<v:shape adj="1"/>';var f=u.firstChild;return f.style.behavior="url(#default#VML)",f&&typeof f.adj=="object"}catch{return!1}}(),jn=navigator.platform.indexOf("Mac")===0,ii=navigator.platform.indexOf("Linux")===0;function un(u){return navigator.userAgent.toLowerCase().indexOf(u)>=0}var Ve={ie:Ne,ielt9:Ie,edge:Ge,webkit:nt,android:ze,android23:Pe,androidStock:Tt,opera:ir,chrome:B,gecko:M,safari:P,phantom:G,opera12:re,win:Q,ie3d:ae,webkit3d:ve,gecko3d:xe,any3d:Me,mobile:Ee,mobileWebkit:ke,mobileWebkit3d:pt,msPointer:gt,pointer:hr,touch:yn,touchNative:Dn,mobileOpera:Lf,mobileGecko:ni,retina:Bf,passiveEvents:it,canvas:Xe,svg:Br,vml:ki,inlineSvg:ca,mac:jn,linux:ii},ai=Ve.msPointer?"MSPointerDown":"pointerdown",tc=Ve.msPointer?"MSPointerMove":"pointermove",Tl=Ve.msPointer?"MSPointerUp":"pointerup",lv=Ve.msPointer?"MSPointerCancel":"pointercancel",at={touchstart:ai,touchmove:tc,touchend:Tl,touchcancel:lv},us={touchstart:Lz,touchmove:uv,touchend:uv,touchcancel:uv},rc={},C3=!1;function Pz(u,f,v){return f==="touchstart"&&$z(),us[f]?(v=us[f].bind(this,v),u.addEventListener(at[f],v,!1),v):(console.warn("wrong event specified:",f),h)}function Az(u,f,v){if(!at[f]){console.warn("wrong event specified:",f);return}u.removeEventListener(at[f],v,!1)}function kz(u){rc[u.pointerId]=u}function Oz(u){rc[u.pointerId]&&(rc[u.pointerId]=u)}function T3(u){delete rc[u.pointerId]}function $z(){C3||(document.addEventListener(ai,kz,!0),document.addEventListener(tc,Oz,!0),document.addEventListener(Tl,T3,!0),document.addEventListener(lv,T3,!0),C3=!0)}function uv(u,f){if(f.pointerType!==(f.MSPOINTER_TYPE_MOUSE||"mouse")){f.touches=[];for(var v in rc)f.touches.push(rc[v]);f.changedTouches=[f],u(f)}}function Lz(u,f){f.MSPOINTER_TYPE_TOUCH&&f.pointerType===f.MSPOINTER_TYPE_TOUCH&&cn(f),uv(u,f)}function Bz(u){var f={},v,w;for(w in u)v=u[w],f[w]=v&&v.bind?v.bind(u):v;return u=f,f.type="dblclick",f.detail=2,f.isTrusted=!1,f._simulated=!0,f}var Nz=200;function Uz(u,f){u.addEventListener("dblclick",f);var v=0,w;function A(W){if(W.detail!==1){w=W.detail;return}if(!(W.pointerType==="mouse"||W.sourceCapabilities&&!W.sourceCapabilities.firesTouchEvents)){var de=P3(W);if(!(de.some(function(Se){return Se instanceof HTMLLabelElement&&Se.attributes.for})&&!de.some(function(Se){return Se instanceof HTMLInputElement||Se instanceof HTMLSelectElement}))){var ye=Date.now();ye-v<=Nz?(w++,w===2&&f(Bz(W))):w=1,v=ye}}}return u.addEventListener("click",A),{dblclick:f,simDblclick:A}}function Fz(u,f){u.removeEventListener("dblclick",f.dblclick),u.removeEventListener("click",f.simDblclick)}var p_=fv(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),Nf=fv(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),D3=Nf==="webkitTransition"||Nf==="OTransition"?Nf+"End":"transitionend";function R3(u){return typeof u=="string"?document.getElementById(u):u}function Uf(u,f){var v=u.style[f]||u.currentStyle&&u.currentStyle[f];if((!v||v==="auto")&&document.defaultView){var w=document.defaultView.getComputedStyle(u,null);v=w?w[f]:null}return v==="auto"?null:v}function Mt(u,f,v){var w=document.createElement(u);return w.className=f||"",v&&v.appendChild(w),w}function pr(u){var f=u.parentNode;f&&f.removeChild(u)}function cv(u){for(;u.firstChild;)u.removeChild(u.firstChild)}function nc(u){var f=u.parentNode;f&&f.lastChild!==u&&f.appendChild(u)}function ic(u){var f=u.parentNode;f&&f.firstChild!==u&&f.insertBefore(u,f.firstChild)}function m_(u,f){if(u.classList!==void 0)return u.classList.contains(f);var v=dv(u);return v.length>0&&new RegExp("(^|\\s)"+f+"(\\s|$)").test(v)}function ft(u,f){if(u.classList!==void 0)for(var v=g(f),w=0,A=v.length;w<A;w++)u.classList.add(v[w]);else if(!m_(u,f)){var W=dv(u);v_(u,(W?W+" ":"")+f)}}function wr(u,f){u.classList!==void 0?u.classList.remove(f):v_(u,m((" "+dv(u)+" ").replace(" "+f+" "," ")))}function v_(u,f){u.className.baseVal===void 0?u.className=f:u.className.baseVal=f}function dv(u){return u.correspondingElement&&(u=u.correspondingElement),u.className.baseVal===void 0?u.className:u.className.baseVal}function Oi(u,f){"opacity"in u.style?u.style.opacity=f:"filter"in u.style&&jz(u,f)}function jz(u,f){var v=!1,w="DXImageTransform.Microsoft.Alpha";try{v=u.filters.item(w)}catch{if(f===1)return}f=Math.round(f*100),v?(v.Enabled=f!==100,v.Opacity=f):u.style.filter+=" progid:"+w+"(opacity="+f+")"}function fv(u){for(var f=document.documentElement.style,v=0;v<u.length;v++)if(u[v]in f)return u[v];return!1}function Dl(u,f,v){var w=f||new H(0,0);u.style[p_]=(Ve.ie3d?"translate("+w.x+"px,"+w.y+"px)":"translate3d("+w.x+"px,"+w.y+"px,0)")+(v?" scale("+v+")":"")}function Mr(u,f){u._leaflet_pos=f,Ve.any3d?Dl(u,f):(u.style.left=f.x+"px",u.style.top=f.y+"px")}function Rl(u){return u._leaflet_pos||new H(0,0)}var Ff,jf,g_;if("onselectstart"in document)Ff=function(){lt(window,"selectstart",cn)},jf=function(){Zt(window,"selectstart",cn)};else{var Vf=fv(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);Ff=function(){if(Vf){var u=document.documentElement.style;g_=u[Vf],u[Vf]="none"}},jf=function(){Vf&&(document.documentElement.style[Vf]=g_,g_=void 0)}}function y_(){lt(window,"dragstart",cn)}function b_(){Zt(window,"dragstart",cn)}var hv,__;function S_(u){for(;u.tabIndex===-1;)u=u.parentNode;u.style&&(pv(),hv=u,__=u.style.outlineStyle,u.style.outlineStyle="none",lt(window,"keydown",pv))}function pv(){hv&&(hv.style.outlineStyle=__,hv=void 0,__=void 0,Zt(window,"keydown",pv))}function M3(u){do u=u.parentNode;while((!u.offsetWidth||!u.offsetHeight)&&u!==document.body);return u}function w_(u){var f=u.getBoundingClientRect();return{x:f.width/u.offsetWidth||1,y:f.height/u.offsetHeight||1,boundingClientRect:f}}var Vz={__proto__:null,TRANSFORM:p_,TRANSITION:Nf,TRANSITION_END:D3,get:R3,getStyle:Uf,create:Mt,remove:pr,empty:cv,toFront:nc,toBack:ic,hasClass:m_,addClass:ft,removeClass:wr,setClass:v_,getClass:dv,setOpacity:Oi,testProp:fv,setTransform:Dl,setPosition:Mr,getPosition:Rl,get disableTextSelection(){return Ff},get enableTextSelection(){return jf},disableImageDrag:y_,enableImageDrag:b_,preventOutline:S_,restoreOutline:pv,getSizedParentNode:M3,getScale:w_};function lt(u,f,v,w){if(f&&typeof f=="object")for(var A in f)x_(u,A,f[A],v);else{f=g(f);for(var W=0,de=f.length;W<de;W++)x_(u,f[W],v,w)}return this}var Ia="_leaflet_events";function Zt(u,f,v,w){if(arguments.length===1)I3(u),delete u[Ia];else if(f&&typeof f=="object")for(var A in f)C_(u,A,f[A],v);else if(f=g(f),arguments.length===2)I3(u,function(ye){return T(f,ye)!==-1});else for(var W=0,de=f.length;W<de;W++)C_(u,f[W],v,w);return this}function I3(u,f){for(var v in u[Ia]){var w=v.split(/\d/)[0];(!f||f(w))&&C_(u,w,null,null,v)}}var E_={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function x_(u,f,v,w){var A=f+l(v)+(w?"_"+l(w):"");if(u[Ia]&&u[Ia][A])return this;var W=function(ye){return v.call(w||u,ye||window.event)},de=W;!Ve.touchNative&&Ve.pointer&&f.indexOf("touch")===0?W=Pz(u,f,W):Ve.touch&&f==="dblclick"?W=Uz(u,W):"addEventListener"in u?f==="touchstart"||f==="touchmove"||f==="wheel"||f==="mousewheel"?u.addEventListener(E_[f]||f,W,Ve.passiveEvents?{passive:!1}:!1):f==="mouseenter"||f==="mouseleave"?(W=function(ye){ye=ye||window.event,D_(u,ye)&&de(ye)},u.addEventListener(E_[f],W,!1)):u.addEventListener(f,de,!1):u.attachEvent("on"+f,W),u[Ia]=u[Ia]||{},u[Ia][A]=W}function C_(u,f,v,w,A){A=A||f+l(v)+(w?"_"+l(w):"");var W=u[Ia]&&u[Ia][A];if(!W)return this;!Ve.touchNative&&Ve.pointer&&f.indexOf("touch")===0?Az(u,f,W):Ve.touch&&f==="dblclick"?Fz(u,W):"removeEventListener"in u?u.removeEventListener(E_[f]||f,W,!1):u.detachEvent("on"+f,W),u[Ia][A]=null}function Ml(u){return u.stopPropagation?u.stopPropagation():u.originalEvent?u.originalEvent._stopped=!0:u.cancelBubble=!0,this}function T_(u){return x_(u,"wheel",Ml),this}function zf(u){return lt(u,"mousedown touchstart dblclick contextmenu",Ml),u._leaflet_disable_click=!0,this}function cn(u){return u.preventDefault?u.preventDefault():u.returnValue=!1,this}function Il(u){return cn(u),Ml(u),this}function P3(u){if(u.composedPath)return u.composedPath();for(var f=[],v=u.target;v;)f.push(v),v=v.parentNode;return f}function A3(u,f){if(!f)return new H(u.clientX,u.clientY);var v=w_(f),w=v.boundingClientRect;return new H((u.clientX-w.left)/v.x-f.clientLeft,(u.clientY-w.top)/v.y-f.clientTop)}var zz=Ve.linux&&Ve.chrome?window.devicePixelRatio:Ve.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function k3(u){return Ve.edge?u.wheelDeltaY/2:u.deltaY&&u.deltaMode===0?-u.deltaY/zz:u.deltaY&&u.deltaMode===1?-u.deltaY*20:u.deltaY&&u.deltaMode===2?-u.deltaY*60:u.deltaX||u.deltaZ?0:u.wheelDelta?(u.wheelDeltaY||u.wheelDelta)/2:u.detail&&Math.abs(u.detail)<32765?-u.detail*20:u.detail?u.detail/-32765*60:0}function D_(u,f){var v=f.relatedTarget;if(!v)return!0;try{for(;v&&v!==u;)v=v.parentNode}catch{return!1}return v!==u}var Kz={__proto__:null,on:lt,off:Zt,stopPropagation:Ml,disableScrollPropagation:T_,disableClickPropagation:zf,preventDefault:cn,stop:Il,getPropagationPath:P3,getMousePosition:A3,getWheelDelta:k3,isExternalTarget:D_,addListener:lt,removeListener:Zt},O3=te.extend({run:function(u,f,v,w){this.stop(),this._el=u,this._inProgress=!0,this._duration=v||.25,this._easeOutPower=1/Math.max(w||.5,.2),this._startPos=Rl(u),this._offset=f.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=j(this._animate,this),this._step()},_step:function(u){var f=+new Date-this._startTime,v=this._duration*1e3;f<v?this._runFrame(this._easeOut(f/v),u):(this._runFrame(1),this._complete())},_runFrame:function(u,f){var v=this._startPos.add(this._offset.multiplyBy(u));f&&v._round(),Mr(this._el,v),this.fire("step")},_complete:function(){J(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(u){return 1-Math.pow(1-u,this._easeOutPower)}}),xt=te.extend({options:{crs:pe,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(u,f){f=y(this,f),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(u),this._initLayout(),this._onResize=o(this._onResize,this),this._initEvents(),f.maxBounds&&this.setMaxBounds(f.maxBounds),f.zoom!==void 0&&(this._zoom=this._limitZoom(f.zoom)),f.center&&f.zoom!==void 0&&this.setView(q(f.center),f.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=Nf&&Ve.any3d&&!Ve.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),lt(this._proxy,D3,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(u,f,v){if(f=f===void 0?this._zoom:this._limitZoom(f),u=this._limitCenter(q(u),f,this.options.maxBounds),v=v||{},this._stop(),this._loaded&&!v.reset&&v!==!0){v.animate!==void 0&&(v.zoom=i({animate:v.animate},v.zoom),v.pan=i({animate:v.animate,duration:v.duration},v.pan));var w=this._zoom!==f?this._tryAnimatedZoom&&this._tryAnimatedZoom(u,f,v.zoom):this._tryAnimatedPan(u,v.pan);if(w)return clearTimeout(this._sizeTimer),this}return this._resetView(u,f,v.pan&&v.pan.noMoveStart),this},setZoom:function(u,f){return this._loaded?this.setView(this.getCenter(),u,{zoom:f}):(this._zoom=u,this)},zoomIn:function(u,f){return u=u||(Ve.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+u,f)},zoomOut:function(u,f){return u=u||(Ve.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-u,f)},setZoomAround:function(u,f,v){var w=this.getZoomScale(f),A=this.getSize().divideBy(2),W=u instanceof H?u:this.latLngToContainerPoint(u),de=W.subtract(A).multiplyBy(1-1/w),ye=this.containerPointToLatLng(A.add(de));return this.setView(ye,f,{zoom:v})},_getBoundsCenterZoom:function(u,f){f=f||{},u=u.getBounds?u.getBounds():ee(u);var v=ne(f.paddingTopLeft||f.padding||[0,0]),w=ne(f.paddingBottomRight||f.padding||[0,0]),A=this.getBoundsZoom(u,!1,v.add(w));if(A=typeof f.maxZoom=="number"?Math.min(f.maxZoom,A):A,A===1/0)return{center:u.getCenter(),zoom:A};var W=w.subtract(v).divideBy(2),de=this.project(u.getSouthWest(),A),ye=this.project(u.getNorthEast(),A),Se=this.unproject(de.add(ye).divideBy(2).add(W),A);return{center:Se,zoom:A}},fitBounds:function(u,f){if(u=ee(u),!u.isValid())throw new Error("Bounds are not valid.");var v=this._getBoundsCenterZoom(u,f);return this.setView(v.center,v.zoom,f)},fitWorld:function(u){return this.fitBounds([[-90,-180],[90,180]],u)},panTo:function(u,f){return this.setView(u,this._zoom,{pan:f})},panBy:function(u,f){if(u=ne(u).round(),f=f||{},!u.x&&!u.y)return this.fire("moveend");if(f.animate!==!0&&!this.getSize().contains(u))return this._resetView(this.unproject(this.project(this.getCenter()).add(u)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new O3,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),f.noMoveStart||this.fire("movestart"),f.animate!==!1){ft(this._mapPane,"leaflet-pan-anim");var v=this._getMapPanePos().subtract(u).round();this._panAnim.run(this._mapPane,v,f.duration||.25,f.easeLinearity)}else this._rawPanBy(u),this.fire("move").fire("moveend");return this},flyTo:function(u,f,v){if(v=v||{},v.animate===!1||!Ve.any3d)return this.setView(u,f,v);this._stop();var w=this.project(this.getCenter()),A=this.project(u),W=this.getSize(),de=this._zoom;u=q(u),f=f===void 0?de:f;var ye=Math.max(W.x,W.y),Se=ye*this.getZoomScale(de,f),Re=A.distanceTo(w)||1,Fe=1.42,Ye=Fe*Fe;function yt(Ir){var Tv=Ir?-1:1,AK=Ir?Se:ye,kK=Se*Se-ye*ye+Tv*Ye*Ye*Re*Re,OK=2*AK*Ye*Re,N_=kK/OK,pD=Math.sqrt(N_*N_+1)-N_,$K=pD<1e-9?-18:Math.log(pD);return $K}function Rn(Ir){return(Math.exp(Ir)-Math.exp(-Ir))/2}function Gr(Ir){return(Math.exp(Ir)+Math.exp(-Ir))/2}function Li(Ir){return Rn(Ir)/Gr(Ir)}var Vn=yt(0);function cc(Ir){return ye*(Gr(Vn)/Gr(Vn+Fe*Ir))}function RK(Ir){return ye*(Gr(Vn)*Li(Vn+Fe*Ir)-Rn(Vn))/Ye}function MK(Ir){return 1-Math.pow(1-Ir,1.5)}var IK=Date.now(),fD=(yt(1)-Vn)/Fe,PK=v.duration?1e3*v.duration:1e3*fD*.8;function hD(){var Ir=(Date.now()-IK)/PK,Tv=MK(Ir)*fD;Ir<=1?(this._flyToFrame=j(hD,this),this._move(this.unproject(w.add(A.subtract(w).multiplyBy(RK(Tv)/Re)),de),this.getScaleZoom(ye/cc(Tv),de),{flyTo:!0})):this._move(u,f)._moveEnd(!0)}return this._moveStart(!0,v.noMoveStart),hD.call(this),this},flyToBounds:function(u,f){var v=this._getBoundsCenterZoom(u,f);return this.flyTo(v.center,v.zoom,f)},setMaxBounds:function(u){return u=ee(u),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),u.isValid()?(this.options.maxBounds=u,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(u){var f=this.options.minZoom;return this.options.minZoom=u,this._loaded&&f!==u&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(u):this},setMaxZoom:function(u){var f=this.options.maxZoom;return this.options.maxZoom=u,this._loaded&&f!==u&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(u):this},panInsideBounds:function(u,f){this._enforcingBounds=!0;var v=this.getCenter(),w=this._limitCenter(v,this._zoom,ee(u));return v.equals(w)||this.panTo(w,f),this._enforcingBounds=!1,this},panInside:function(u,f){f=f||{};var v=ne(f.paddingTopLeft||f.padding||[0,0]),w=ne(f.paddingBottomRight||f.padding||[0,0]),A=this.project(this.getCenter()),W=this.project(u),de=this.getPixelBounds(),ye=oe([de.min.add(v),de.max.subtract(w)]),Se=ye.getSize();if(!ye.contains(W)){this._enforcingBounds=!0;var Re=W.subtract(ye.getCenter()),Fe=ye.extend(W).getSize().subtract(Se);A.x+=Re.x<0?-Fe.x:Fe.x,A.y+=Re.y<0?-Fe.y:Fe.y,this.panTo(this.unproject(A),f),this._enforcingBounds=!1}return this},invalidateSize:function(u){if(!this._loaded)return this;u=i({animate:!1,pan:!0},u===!0?{animate:!0}:u);var f=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var v=this.getSize(),w=f.divideBy(2).round(),A=v.divideBy(2).round(),W=w.subtract(A);return!W.x&&!W.y?this:(u.animate&&u.pan?this.panBy(W):(u.pan&&this._rawPanBy(W),this.fire("move"),u.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(o(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:f,newSize:v}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(u){if(u=this._locateOptions=i({timeout:1e4,watch:!1},u),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var f=o(this._handleGeolocationResponse,this),v=o(this._handleGeolocationError,this);return u.watch?this._locationWatchId=navigator.geolocation.watchPosition(f,v,u):navigator.geolocation.getCurrentPosition(f,v,u),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(u){if(this._container._leaflet_id){var f=u.code,v=u.message||(f===1?"permission denied":f===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:f,message:"Geolocation error: "+v+"."})}},_handleGeolocationResponse:function(u){if(this._container._leaflet_id){var f=u.coords.latitude,v=u.coords.longitude,w=new Y(f,v),A=w.toBounds(u.coords.accuracy*2),W=this._locateOptions;if(W.setView){var de=this.getBoundsZoom(A);this.setView(w,W.maxZoom?Math.min(de,W.maxZoom):de)}var ye={latlng:w,bounds:A,timestamp:u.timestamp};for(var Se in u.coords)typeof u.coords[Se]=="number"&&(ye[Se]=u.coords[Se]);this.fire("locationfound",ye)}},addHandler:function(u,f){if(!f)return this;var v=this[u]=new f(this);return this._handlers.push(v),this.options[u]&&v.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),pr(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(J(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var u;for(u in this._layers)this._layers[u].remove();for(u in this._panes)pr(this._panes[u]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(u,f){var v="leaflet-pane"+(u?" leaflet-"+u.replace("Pane","")+"-pane":""),w=Mt("div",v,f||this._mapPane);return u&&(this._panes[u]=w),w},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var u=this.getPixelBounds(),f=this.unproject(u.getBottomLeft()),v=this.unproject(u.getTopRight());return new me(f,v)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(u,f,v){u=ee(u),v=ne(v||[0,0]);var w=this.getZoom()||0,A=this.getMinZoom(),W=this.getMaxZoom(),de=u.getNorthWest(),ye=u.getSouthEast(),Se=this.getSize().subtract(v),Re=oe(this.project(ye,w),this.project(de,w)).getSize(),Fe=Ve.any3d?this.options.zoomSnap:1,Ye=Se.x/Re.x,yt=Se.y/Re.y,Rn=f?Math.max(Ye,yt):Math.min(Ye,yt);return w=this.getScaleZoom(Rn,w),Fe&&(w=Math.round(w/(Fe/100))*(Fe/100),w=f?Math.ceil(w/Fe)*Fe:Math.floor(w/Fe)*Fe),Math.max(A,Math.min(W,w))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new H(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(u,f){var v=this._getTopLeftPoint(u,f);return new he(v,v.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(u){return this.options.crs.getProjectedBounds(u===void 0?this.getZoom():u)},getPane:function(u){return typeof u=="string"?this._panes[u]:u},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(u,f){var v=this.options.crs;return f=f===void 0?this._zoom:f,v.scale(u)/v.scale(f)},getScaleZoom:function(u,f){var v=this.options.crs;f=f===void 0?this._zoom:f;var w=v.zoom(u*v.scale(f));return isNaN(w)?1/0:w},project:function(u,f){return f=f===void 0?this._zoom:f,this.options.crs.latLngToPoint(q(u),f)},unproject:function(u,f){return f=f===void 0?this._zoom:f,this.options.crs.pointToLatLng(ne(u),f)},layerPointToLatLng:function(u){var f=ne(u).add(this.getPixelOrigin());return this.unproject(f)},latLngToLayerPoint:function(u){var f=this.project(q(u))._round();return f._subtract(this.getPixelOrigin())},wrapLatLng:function(u){return this.options.crs.wrapLatLng(q(u))},wrapLatLngBounds:function(u){return this.options.crs.wrapLatLngBounds(ee(u))},distance:function(u,f){return this.options.crs.distance(q(u),q(f))},containerPointToLayerPoint:function(u){return ne(u).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(u){return ne(u).add(this._getMapPanePos())},containerPointToLatLng:function(u){var f=this.containerPointToLayerPoint(ne(u));return this.layerPointToLatLng(f)},latLngToContainerPoint:function(u){return this.layerPointToContainerPoint(this.latLngToLayerPoint(q(u)))},mouseEventToContainerPoint:function(u){return A3(u,this._container)},mouseEventToLayerPoint:function(u){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(u))},mouseEventToLatLng:function(u){return this.layerPointToLatLng(this.mouseEventToLayerPoint(u))},_initContainer:function(u){var f=this._container=R3(u);if(f){if(f._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");lt(f,"scroll",this._onScroll,this),this._containerId=l(f)},_initLayout:function(){var u=this._container;this._fadeAnimated=this.options.fadeAnimation&&Ve.any3d,ft(u,"leaflet-container"+(Ve.touch?" leaflet-touch":"")+(Ve.retina?" leaflet-retina":"")+(Ve.ielt9?" leaflet-oldie":"")+(Ve.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var f=Uf(u,"position");f!=="absolute"&&f!=="relative"&&f!=="fixed"&&f!=="sticky"&&(u.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var u=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),Mr(this._mapPane,new H(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(ft(u.markerPane,"leaflet-zoom-hide"),ft(u.shadowPane,"leaflet-zoom-hide"))},_resetView:function(u,f,v){Mr(this._mapPane,new H(0,0));var w=!this._loaded;this._loaded=!0,f=this._limitZoom(f),this.fire("viewprereset");var A=this._zoom!==f;this._moveStart(A,v)._move(u,f)._moveEnd(A),this.fire("viewreset"),w&&this.fire("load")},_moveStart:function(u,f){return u&&this.fire("zoomstart"),f||this.fire("movestart"),this},_move:function(u,f,v,w){f===void 0&&(f=this._zoom);var A=this._zoom!==f;return this._zoom=f,this._lastCenter=u,this._pixelOrigin=this._getNewPixelOrigin(u),w?v&&v.pinch&&this.fire("zoom",v):((A||v&&v.pinch)&&this.fire("zoom",v),this.fire("move",v)),this},_moveEnd:function(u){return u&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return J(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(u){Mr(this._mapPane,this._getMapPanePos().subtract(u))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(u){this._targets={},this._targets[l(this._container)]=this;var f=u?Zt:lt;f(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&f(window,"resize",this._onResize,this),Ve.any3d&&this.options.transform3DLimit&&(u?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){J(this._resizeRequest),this._resizeRequest=j(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var u=this._getMapPanePos();Math.max(Math.abs(u.x),Math.abs(u.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(u,f){for(var v=[],w,A=f==="mouseout"||f==="mouseover",W=u.target||u.srcElement,de=!1;W;){if(w=this._targets[l(W)],w&&(f==="click"||f==="preclick")&&this._draggableMoved(w)){de=!0;break}if(w&&w.listens(f,!0)&&(A&&!D_(W,u)||(v.push(w),A))||W===this._container)break;W=W.parentNode}return!v.length&&!de&&!A&&this.listens(f,!0)&&(v=[this]),v},_isClickDisabled:function(u){for(;u&&u!==this._container;){if(u._leaflet_disable_click)return!0;u=u.parentNode}},_handleDOMEvent:function(u){var f=u.target||u.srcElement;if(!(!this._loaded||f._leaflet_disable_events||u.type==="click"&&this._isClickDisabled(f))){var v=u.type;v==="mousedown"&&S_(f),this._fireDOMEvent(u,v)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(u,f,v){if(u.type==="click"){var w=i({},u);w.type="preclick",this._fireDOMEvent(w,w.type,v)}var A=this._findEventTargets(u,f);if(v){for(var W=[],de=0;de<v.length;de++)v[de].listens(f,!0)&&W.push(v[de]);A=W.concat(A)}if(A.length){f==="contextmenu"&&cn(u);var ye=A[0],Se={originalEvent:u};if(u.type!=="keypress"&&u.type!=="keydown"&&u.type!=="keyup"){var Re=ye.getLatLng&&(!ye._radius||ye._radius<=10);Se.containerPoint=Re?this.latLngToContainerPoint(ye.getLatLng()):this.mouseEventToContainerPoint(u),Se.layerPoint=this.containerPointToLayerPoint(Se.containerPoint),Se.latlng=Re?ye.getLatLng():this.layerPointToLatLng(Se.layerPoint)}for(de=0;de<A.length;de++)if(A[de].fire(f,Se,!0),Se.originalEvent._stopped||A[de].options.bubblingMouseEvents===!1&&T(this._mouseEvents,f)!==-1)return}},_draggableMoved:function(u){return u=u.dragging&&u.dragging.enabled()?u:this,u.dragging&&u.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var u=0,f=this._handlers.length;u<f;u++)this._handlers[u].disable()},whenReady:function(u,f){return this._loaded?u.call(f||this,{target:this}):this.on("load",u,f),this},_getMapPanePos:function(){return Rl(this._mapPane)||new H(0,0)},_moved:function(){var u=this._getMapPanePos();return u&&!u.equals([0,0])},_getTopLeftPoint:function(u,f){var v=u&&f!==void 0?this._getNewPixelOrigin(u,f):this.getPixelOrigin();return v.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(u,f){var v=this.getSize()._divideBy(2);return this.project(u,f)._subtract(v)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(u,f,v){var w=this._getNewPixelOrigin(v,f);return this.project(u,f)._subtract(w)},_latLngBoundsToNewLayerBounds:function(u,f,v){var w=this._getNewPixelOrigin(v,f);return oe([this.project(u.getSouthWest(),f)._subtract(w),this.project(u.getNorthWest(),f)._subtract(w),this.project(u.getSouthEast(),f)._subtract(w),this.project(u.getNorthEast(),f)._subtract(w)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(u){return this.latLngToLayerPoint(u).subtract(this._getCenterLayerPoint())},_limitCenter:function(u,f,v){if(!v)return u;var w=this.project(u,f),A=this.getSize().divideBy(2),W=new he(w.subtract(A),w.add(A)),de=this._getBoundsOffset(W,v,f);return Math.abs(de.x)<=1&&Math.abs(de.y)<=1?u:this.unproject(w.add(de),f)},_limitOffset:function(u,f){if(!f)return u;var v=this.getPixelBounds(),w=new he(v.min.add(u),v.max.add(u));return u.add(this._getBoundsOffset(w,f))},_getBoundsOffset:function(u,f,v){var w=oe(this.project(f.getNorthEast(),v),this.project(f.getSouthWest(),v)),A=w.min.subtract(u.min),W=w.max.subtract(u.max),de=this._rebound(A.x,-W.x),ye=this._rebound(A.y,-W.y);return new H(de,ye)},_rebound:function(u,f){return u+f>0?Math.round(u-f)/2:Math.max(0,Math.ceil(u))-Math.max(0,Math.floor(f))},_limitZoom:function(u){var f=this.getMinZoom(),v=this.getMaxZoom(),w=Ve.any3d?this.options.zoomSnap:1;return w&&(u=Math.round(u/w)*w),Math.max(f,Math.min(v,u))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){wr(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(u,f){var v=this._getCenterOffset(u)._trunc();return(f&&f.animate)!==!0&&!this.getSize().contains(v)?!1:(this.panBy(v,f),!0)},_createAnimProxy:function(){var u=this._proxy=Mt("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(u),this.on("zoomanim",function(f){var v=p_,w=this._proxy.style[v];Dl(this._proxy,this.project(f.center,f.zoom),this.getZoomScale(f.zoom,1)),w===this._proxy.style[v]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){pr(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var u=this.getCenter(),f=this.getZoom();Dl(this._proxy,this.project(u,f),this.getZoomScale(f,1))},_catchTransitionEnd:function(u){this._animatingZoom&&u.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(u,f,v){if(this._animatingZoom)return!0;if(v=v||{},!this._zoomAnimated||v.animate===!1||this._nothingToAnimate()||Math.abs(f-this._zoom)>this.options.zoomAnimationThreshold)return!1;var w=this.getZoomScale(f),A=this._getCenterOffset(u)._divideBy(1-1/w);return v.animate!==!0&&!this.getSize().contains(A)?!1:(j(function(){this._moveStart(!0,v.noMoveStart||!1)._animateZoom(u,f,!0)},this),!0)},_animateZoom:function(u,f,v,w){this._mapPane&&(v&&(this._animatingZoom=!0,this._animateToCenter=u,this._animateToZoom=f,ft(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:u,zoom:f,noUpdate:w}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(o(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&wr(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function Hz(u,f){return new xt(u,f)}var da=le.extend({options:{position:"topright"},initialize:function(u){y(this,u)},getPosition:function(){return this.options.position},setPosition:function(u){var f=this._map;return f&&f.removeControl(this),this.options.position=u,f&&f.addControl(this),this},getContainer:function(){return this._container},addTo:function(u){this.remove(),this._map=u;var f=this._container=this.onAdd(u),v=this.getPosition(),w=u._controlCorners[v];return ft(f,"leaflet-control"),v.indexOf("bottom")!==-1?w.insertBefore(f,w.firstChild):w.appendChild(f),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(pr(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(u){this._map&&u&&u.screenX>0&&u.screenY>0&&this._map.getContainer().focus()}}),Kf=function(u){return new da(u)};xt.include({addControl:function(u){return u.addTo(this),this},removeControl:function(u){return u.remove(),this},_initControlPos:function(){var u=this._controlCorners={},f="leaflet-",v=this._controlContainer=Mt("div",f+"control-container",this._container);function w(A,W){var de=f+A+" "+f+W;u[A+W]=Mt("div",de,v)}w("top","left"),w("top","right"),w("bottom","left"),w("bottom","right")},_clearControlPos:function(){for(var u in this._controlCorners)pr(this._controlCorners[u]);pr(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var $3=da.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(u,f,v,w){return v<w?-1:w<v?1:0}},initialize:function(u,f,v){y(this,v),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var w in u)this._addLayer(u[w],w);for(w in f)this._addLayer(f[w],w,!0)},onAdd:function(u){this._initLayout(),this._update(),this._map=u,u.on("zoomend",this._checkDisabledLayers,this);for(var f=0;f<this._layers.length;f++)this._layers[f].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(u){return da.prototype.addTo.call(this,u),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var u=0;u<this._layers.length;u++)this._layers[u].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(u,f){return this._addLayer(u,f),this._map?this._update():this},addOverlay:function(u,f){return this._addLayer(u,f,!0),this._map?this._update():this},removeLayer:function(u){u.off("add remove",this._onLayerChange,this);var f=this._getLayer(l(u));return f&&this._layers.splice(this._layers.indexOf(f),1),this._map?this._update():this},expand:function(){ft(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var u=this._map.getSize().y-(this._container.offsetTop+50);return u<this._section.clientHeight?(ft(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=u+"px"):wr(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return wr(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var u="leaflet-control-layers",f=this._container=Mt("div",u),v=this.options.collapsed;f.setAttribute("aria-haspopup",!0),zf(f),T_(f);var w=this._section=Mt("section",u+"-list");v&&(this._map.on("click",this.collapse,this),lt(f,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var A=this._layersLink=Mt("a",u+"-toggle",f);A.href="#",A.title="Layers",A.setAttribute("role","button"),lt(A,{keydown:function(W){W.keyCode===13&&this._expandSafely()},click:function(W){cn(W),this._expandSafely()}},this),v||this.expand(),this._baseLayersList=Mt("div",u+"-base",w),this._separator=Mt("div",u+"-separator",w),this._overlaysList=Mt("div",u+"-overlays",w),f.appendChild(w)},_getLayer:function(u){for(var f=0;f<this._layers.length;f++)if(this._layers[f]&&l(this._layers[f].layer)===u)return this._layers[f]},_addLayer:function(u,f,v){this._map&&u.on("add remove",this._onLayerChange,this),this._layers.push({layer:u,name:f,overlay:v}),this.options.sortLayers&&this._layers.sort(o(function(w,A){return this.options.sortFunction(w.layer,A.layer,w.name,A.name)},this)),this.options.autoZIndex&&u.setZIndex&&(this._lastZIndex++,u.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;cv(this._baseLayersList),cv(this._overlaysList),this._layerControlInputs=[];var u,f,v,w,A=0;for(v=0;v<this._layers.length;v++)w=this._layers[v],this._addItem(w),f=f||w.overlay,u=u||!w.overlay,A+=w.overlay?0:1;return this.options.hideSingleBase&&(u=u&&A>1,this._baseLayersList.style.display=u?"":"none"),this._separator.style.display=f&&u?"":"none",this},_onLayerChange:function(u){this._handlingClick||this._update();var f=this._getLayer(l(u.target)),v=f.overlay?u.type==="add"?"overlayadd":"overlayremove":u.type==="add"?"baselayerchange":null;v&&this._map.fire(v,f)},_createRadioElement:function(u,f){var v='<input type="radio" class="leaflet-control-layers-selector" name="'+u+'"'+(f?' checked="checked"':"")+"/>",w=document.createElement("div");return w.innerHTML=v,w.firstChild},_addItem:function(u){var f=document.createElement("label"),v=this._map.hasLayer(u.layer),w;u.overlay?(w=document.createElement("input"),w.type="checkbox",w.className="leaflet-control-layers-selector",w.defaultChecked=v):w=this._createRadioElement("leaflet-base-layers_"+l(this),v),this._layerControlInputs.push(w),w.layerId=l(u.layer),lt(w,"click",this._onInputClick,this);var A=document.createElement("span");A.innerHTML=" "+u.name;var W=document.createElement("span");f.appendChild(W),W.appendChild(w),W.appendChild(A);var de=u.overlay?this._overlaysList:this._baseLayersList;return de.appendChild(f),this._checkDisabledLayers(),f},_onInputClick:function(){if(!this._preventClick){var u=this._layerControlInputs,f,v,w=[],A=[];this._handlingClick=!0;for(var W=u.length-1;W>=0;W--)f=u[W],v=this._getLayer(f.layerId).layer,f.checked?w.push(v):f.checked||A.push(v);for(W=0;W<A.length;W++)this._map.hasLayer(A[W])&&this._map.removeLayer(A[W]);for(W=0;W<w.length;W++)this._map.hasLayer(w[W])||this._map.addLayer(w[W]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var u=this._layerControlInputs,f,v,w=this._map.getZoom(),A=u.length-1;A>=0;A--)f=u[A],v=this._getLayer(f.layerId).layer,f.disabled=v.options.minZoom!==void 0&&w<v.options.minZoom||v.options.maxZoom!==void 0&&w>v.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var u=this._section;this._preventClick=!0,lt(u,"click",cn),this.expand();var f=this;setTimeout(function(){Zt(u,"click",cn),f._preventClick=!1})}}),Wz=function(u,f,v){return new $3(u,f,v)},R_=da.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(u){var f="leaflet-control-zoom",v=Mt("div",f+" leaflet-bar"),w=this.options;return this._zoomInButton=this._createButton(w.zoomInText,w.zoomInTitle,f+"-in",v,this._zoomIn),this._zoomOutButton=this._createButton(w.zoomOutText,w.zoomOutTitle,f+"-out",v,this._zoomOut),this._updateDisabled(),u.on("zoomend zoomlevelschange",this._updateDisabled,this),v},onRemove:function(u){u.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(u){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(u.shiftKey?3:1))},_zoomOut:function(u){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(u.shiftKey?3:1))},_createButton:function(u,f,v,w,A){var W=Mt("a",v,w);return W.innerHTML=u,W.href="#",W.title=f,W.setAttribute("role","button"),W.setAttribute("aria-label",f),zf(W),lt(W,"click",Il),lt(W,"click",A,this),lt(W,"click",this._refocusOnMap,this),W},_updateDisabled:function(){var u=this._map,f="leaflet-disabled";wr(this._zoomInButton,f),wr(this._zoomOutButton,f),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||u._zoom===u.getMinZoom())&&(ft(this._zoomOutButton,f),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||u._zoom===u.getMaxZoom())&&(ft(this._zoomInButton,f),this._zoomInButton.setAttribute("aria-disabled","true"))}});xt.mergeOptions({zoomControl:!0}),xt.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new R_,this.addControl(this.zoomControl))});var Gz=function(u){return new R_(u)},L3=da.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(u){var f="leaflet-control-scale",v=Mt("div",f),w=this.options;return this._addScales(w,f+"-line",v),u.on(w.updateWhenIdle?"moveend":"move",this._update,this),u.whenReady(this._update,this),v},onRemove:function(u){u.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(u,f,v){u.metric&&(this._mScale=Mt("div",f,v)),u.imperial&&(this._iScale=Mt("div",f,v))},_update:function(){var u=this._map,f=u.getSize().y/2,v=u.distance(u.containerPointToLatLng([0,f]),u.containerPointToLatLng([this.options.maxWidth,f]));this._updateScales(v)},_updateScales:function(u){this.options.metric&&u&&this._updateMetric(u),this.options.imperial&&u&&this._updateImperial(u)},_updateMetric:function(u){var f=this._getRoundNum(u),v=f<1e3?f+" m":f/1e3+" km";this._updateScale(this._mScale,v,f/u)},_updateImperial:function(u){var f=u*3.2808399,v,w,A;f>5280?(v=f/5280,w=this._getRoundNum(v),this._updateScale(this._iScale,w+" mi",w/v)):(A=this._getRoundNum(f),this._updateScale(this._iScale,A+" ft",A/f))},_updateScale:function(u,f,v){u.style.width=Math.round(this.options.maxWidth*v)+"px",u.innerHTML=f},_getRoundNum:function(u){var f=Math.pow(10,(Math.floor(u)+"").length-1),v=u/f;return v=v>=10?10:v>=5?5:v>=3?3:v>=2?2:1,f*v}}),qz=function(u){return new L3(u)},Zz='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',M_=da.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(Ve.inlineSvg?Zz+" ":"")+"Leaflet</a>"},initialize:function(u){y(this,u),this._attributions={}},onAdd:function(u){u.attributionControl=this,this._container=Mt("div","leaflet-control-attribution"),zf(this._container);for(var f in u._layers)u._layers[f].getAttribution&&this.addAttribution(u._layers[f].getAttribution());return this._update(),u.on("layeradd",this._addAttribution,this),this._container},onRemove:function(u){u.off("layeradd",this._addAttribution,this)},_addAttribution:function(u){u.layer.getAttribution&&(this.addAttribution(u.layer.getAttribution()),u.layer.once("remove",function(){this.removeAttribution(u.layer.getAttribution())},this))},setPrefix:function(u){return this.options.prefix=u,this._update(),this},addAttribution:function(u){return u?(this._attributions[u]||(this._attributions[u]=0),this._attributions[u]++,this._update(),this):this},removeAttribution:function(u){return u?(this._attributions[u]&&(this._attributions[u]--,this._update()),this):this},_update:function(){if(this._map){var u=[];for(var f in this._attributions)this._attributions[f]&&u.push(f);var v=[];this.options.prefix&&v.push(this.options.prefix),u.length&&v.push(u.join(", ")),this._container.innerHTML=v.join(' <span aria-hidden="true">|</span> ')}}});xt.mergeOptions({attributionControl:!0}),xt.addInitHook(function(){this.options.attributionControl&&new M_().addTo(this)});var Yz=function(u){return new M_(u)};da.Layers=$3,da.Zoom=R_,da.Scale=L3,da.Attribution=M_,Kf.layers=Wz,Kf.zoom=Gz,Kf.scale=qz,Kf.attribution=Yz;var Pa=le.extend({initialize:function(u){this._map=u},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});Pa.addTo=function(u,f){return u.addHandler(f,this),this};var Jz={Events:Z},B3=Ve.touch?"touchstart mousedown":"mousedown",cs=te.extend({options:{clickTolerance:3},initialize:function(u,f,v,w){y(this,w),this._element=u,this._dragStartTarget=f||u,this._preventOutline=v},enable:function(){this._enabled||(lt(this._dragStartTarget,B3,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(cs._dragging===this&&this.finishDrag(!0),Zt(this._dragStartTarget,B3,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(u){if(this._enabled&&(this._moved=!1,!m_(this._element,"leaflet-zoom-anim"))){if(u.touches&&u.touches.length!==1){cs._dragging===this&&this.finishDrag();return}if(!(cs._dragging||u.shiftKey||u.which!==1&&u.button!==1&&!u.touches)&&(cs._dragging=this,this._preventOutline&&S_(this._element),y_(),Ff(),!this._moving)){this.fire("down");var f=u.touches?u.touches[0]:u,v=M3(this._element);this._startPoint=new H(f.clientX,f.clientY),this._startPos=Rl(this._element),this._parentScale=w_(v);var w=u.type==="mousedown";lt(document,w?"mousemove":"touchmove",this._onMove,this),lt(document,w?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(u){if(this._enabled){if(u.touches&&u.touches.length>1){this._moved=!0;return}var f=u.touches&&u.touches.length===1?u.touches[0]:u,v=new H(f.clientX,f.clientY)._subtract(this._startPoint);!v.x&&!v.y||Math.abs(v.x)+Math.abs(v.y)<this.options.clickTolerance||(v.x/=this._parentScale.x,v.y/=this._parentScale.y,cn(u),this._moved||(this.fire("dragstart"),this._moved=!0,ft(document.body,"leaflet-dragging"),this._lastTarget=u.target||u.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),ft(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(v),this._moving=!0,this._lastEvent=u,this._updatePosition())}},_updatePosition:function(){var u={originalEvent:this._lastEvent};this.fire("predrag",u),Mr(this._element,this._newPos),this.fire("drag",u)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(u){wr(document.body,"leaflet-dragging"),this._lastTarget&&(wr(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),Zt(document,"mousemove touchmove",this._onMove,this),Zt(document,"mouseup touchend touchcancel",this._onUp,this),b_(),jf();var f=this._moved&&this._moving;this._moving=!1,cs._dragging=!1,f&&this.fire("dragend",{noInertia:u,distance:this._newPos.distanceTo(this._startPos)})}});function N3(u,f,v){var w,A=[1,4,2,8],W,de,ye,Se,Re,Fe,Ye,yt;for(W=0,Fe=u.length;W<Fe;W++)u[W]._code=Pl(u[W],f);for(ye=0;ye<4;ye++){for(Ye=A[ye],w=[],W=0,Fe=u.length,de=Fe-1;W<Fe;de=W++)Se=u[W],Re=u[de],Se._code&Ye?Re._code&Ye||(yt=mv(Re,Se,Ye,f,v),yt._code=Pl(yt,f),w.push(yt)):(Re._code&Ye&&(yt=mv(Re,Se,Ye,f,v),yt._code=Pl(yt,f),w.push(yt)),w.push(Se));u=w}return u}function U3(u,f){var v,w,A,W,de,ye,Se,Re,Fe;if(!u||u.length===0)throw new Error("latlngs not passed");$i(u)||(console.warn("latlngs are not flat! Only the first ring will be used"),u=u[0]);var Ye=q([0,0]),yt=ee(u),Rn=yt.getNorthWest().distanceTo(yt.getSouthWest())*yt.getNorthEast().distanceTo(yt.getNorthWest());Rn<1700&&(Ye=I_(u));var Gr=u.length,Li=[];for(v=0;v<Gr;v++){var Vn=q(u[v]);Li.push(f.project(q([Vn.lat-Ye.lat,Vn.lng-Ye.lng])))}for(ye=Se=Re=0,v=0,w=Gr-1;v<Gr;w=v++)A=Li[v],W=Li[w],de=A.y*W.x-W.y*A.x,Se+=(A.x+W.x)*de,Re+=(A.y+W.y)*de,ye+=de*3;ye===0?Fe=Li[0]:Fe=[Se/ye,Re/ye];var cc=f.unproject(ne(Fe));return q([cc.lat+Ye.lat,cc.lng+Ye.lng])}function I_(u){for(var f=0,v=0,w=0,A=0;A<u.length;A++){var W=q(u[A]);f+=W.lat,v+=W.lng,w++}return q([f/w,v/w])}var Xz={__proto__:null,clipPolygon:N3,polygonCenter:U3,centroid:I_};function F3(u,f){if(!f||!u.length)return u.slice();var v=f*f;return u=tK(u,v),u=eK(u,v),u}function j3(u,f,v){return Math.sqrt(Hf(u,f,v,!0))}function Qz(u,f,v){return Hf(u,f,v)}function eK(u,f){var v=u.length,w=typeof Uint8Array<"u"?Uint8Array:Array,A=new w(v);A[0]=A[v-1]=1,P_(u,A,f,0,v-1);var W,de=[];for(W=0;W<v;W++)A[W]&&de.push(u[W]);return de}function P_(u,f,v,w,A){var W=0,de,ye,Se;for(ye=w+1;ye<=A-1;ye++)Se=Hf(u[ye],u[w],u[A],!0),Se>W&&(de=ye,W=Se);W>v&&(f[de]=1,P_(u,f,v,w,de),P_(u,f,v,de,A))}function tK(u,f){for(var v=[u[0]],w=1,A=0,W=u.length;w<W;w++)rK(u[w],u[A])>f&&(v.push(u[w]),A=w);return A<W-1&&v.push(u[W-1]),v}var V3;function z3(u,f,v,w,A){var W=w?V3:Pl(u,v),de=Pl(f,v),ye,Se,Re;for(V3=de;;){if(!(W|de))return[u,f];if(W&de)return!1;ye=W||de,Se=mv(u,f,ye,v,A),Re=Pl(Se,v),ye===W?(u=Se,W=Re):(f=Se,de=Re)}}function mv(u,f,v,w,A){var W=f.x-u.x,de=f.y-u.y,ye=w.min,Se=w.max,Re,Fe;return v&8?(Re=u.x+W*(Se.y-u.y)/de,Fe=Se.y):v&4?(Re=u.x+W*(ye.y-u.y)/de,Fe=ye.y):v&2?(Re=Se.x,Fe=u.y+de*(Se.x-u.x)/W):v&1&&(Re=ye.x,Fe=u.y+de*(ye.x-u.x)/W),new H(Re,Fe,A)}function Pl(u,f){var v=0;return u.x<f.min.x?v|=1:u.x>f.max.x&&(v|=2),u.y<f.min.y?v|=4:u.y>f.max.y&&(v|=8),v}function rK(u,f){var v=f.x-u.x,w=f.y-u.y;return v*v+w*w}function Hf(u,f,v,w){var A=f.x,W=f.y,de=v.x-A,ye=v.y-W,Se=de*de+ye*ye,Re;return Se>0&&(Re=((u.x-A)*de+(u.y-W)*ye)/Se,Re>1?(A=v.x,W=v.y):Re>0&&(A+=de*Re,W+=ye*Re)),de=u.x-A,ye=u.y-W,w?de*de+ye*ye:new H(A,W)}function $i(u){return!x(u[0])||typeof u[0][0]!="object"&&typeof u[0][0]<"u"}function K3(u){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),$i(u)}function H3(u,f){var v,w,A,W,de,ye,Se,Re;if(!u||u.length===0)throw new Error("latlngs not passed");$i(u)||(console.warn("latlngs are not flat! Only the first ring will be used"),u=u[0]);var Fe=q([0,0]),Ye=ee(u),yt=Ye.getNorthWest().distanceTo(Ye.getSouthWest())*Ye.getNorthEast().distanceTo(Ye.getNorthWest());yt<1700&&(Fe=I_(u));var Rn=u.length,Gr=[];for(v=0;v<Rn;v++){var Li=q(u[v]);Gr.push(f.project(q([Li.lat-Fe.lat,Li.lng-Fe.lng])))}for(v=0,w=0;v<Rn-1;v++)w+=Gr[v].distanceTo(Gr[v+1])/2;if(w===0)Re=Gr[0];else for(v=0,W=0;v<Rn-1;v++)if(de=Gr[v],ye=Gr[v+1],A=de.distanceTo(ye),W+=A,W>w){Se=(W-w)/A,Re=[ye.x-Se*(ye.x-de.x),ye.y-Se*(ye.y-de.y)];break}var Vn=f.unproject(ne(Re));return q([Vn.lat+Fe.lat,Vn.lng+Fe.lng])}var nK={__proto__:null,simplify:F3,pointToSegmentDistance:j3,closestPointOnSegment:Qz,clipSegment:z3,_getEdgeIntersection:mv,_getBitCode:Pl,_sqClosestPointOnSegment:Hf,isFlat:$i,_flat:K3,polylineCenter:H3},A_={project:function(u){return new H(u.lng,u.lat)},unproject:function(u){return new Y(u.y,u.x)},bounds:new he([-180,-90],[180,90])},k_={R:6378137,R_MINOR:6356752314245179e-9,bounds:new he([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(u){var f=Math.PI/180,v=this.R,w=u.lat*f,A=this.R_MINOR/v,W=Math.sqrt(1-A*A),de=W*Math.sin(w),ye=Math.tan(Math.PI/4-w/2)/Math.pow((1-de)/(1+de),W/2);return w=-v*Math.log(Math.max(ye,1e-10)),new H(u.lng*f*v,w)},unproject:function(u){for(var f=180/Math.PI,v=this.R,w=this.R_MINOR/v,A=Math.sqrt(1-w*w),W=Math.exp(-u.y/v),de=Math.PI/2-2*Math.atan(W),ye=0,Se=.1,Re;ye<15&&Math.abs(Se)>1e-7;ye++)Re=A*Math.sin(de),Re=Math.pow((1-Re)/(1+Re),A/2),Se=Math.PI/2-2*Math.atan(W*Re)-de,de+=Se;return new Y(de*f,u.x*f/v)}},iK={__proto__:null,LonLat:A_,Mercator:k_,SphericalMercator:N},aK=i({},F,{code:"EPSG:3395",projection:k_,transformation:function(){var u=.5/(Math.PI*k_.R);return ue(u,.5,-u,.5)}()}),W3=i({},F,{code:"EPSG:4326",projection:A_,transformation:ue(1/180,1,-1/180,.5)}),oK=i({},X,{projection:A_,transformation:ue(1,0,-1,0),scale:function(u){return Math.pow(2,u)},zoom:function(u){return Math.log(u)/Math.LN2},distance:function(u,f){var v=f.lng-u.lng,w=f.lat-u.lat;return Math.sqrt(v*v+w*w)},infinite:!0});X.Earth=F,X.EPSG3395=aK,X.EPSG3857=pe,X.EPSG900913=be,X.EPSG4326=W3,X.Simple=oK;var fa=te.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(u){return u.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(u){return u&&u.removeLayer(this),this},getPane:function(u){return this._map.getPane(u?this.options[u]||u:this.options.pane)},addInteractiveTarget:function(u){return this._map._targets[l(u)]=this,this},removeInteractiveTarget:function(u){return delete this._map._targets[l(u)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(u){var f=u.target;if(f.hasLayer(this)){if(this._map=f,this._zoomAnimated=f._zoomAnimated,this.getEvents){var v=this.getEvents();f.on(v,this),this.once("remove",function(){f.off(v,this)},this)}this.onAdd(f),this.fire("add"),f.fire("layeradd",{layer:this})}}});xt.include({addLayer:function(u){if(!u._layerAdd)throw new Error("The provided object is not a Layer.");var f=l(u);return this._layers[f]?this:(this._layers[f]=u,u._mapToAdd=this,u.beforeAdd&&u.beforeAdd(this),this.whenReady(u._layerAdd,u),this)},removeLayer:function(u){var f=l(u);return this._layers[f]?(this._loaded&&u.onRemove(this),delete this._layers[f],this._loaded&&(this.fire("layerremove",{layer:u}),u.fire("remove")),u._map=u._mapToAdd=null,this):this},hasLayer:function(u){return l(u)in this._layers},eachLayer:function(u,f){for(var v in this._layers)u.call(f,this._layers[v]);return this},_addLayers:function(u){u=u?x(u)?u:[u]:[];for(var f=0,v=u.length;f<v;f++)this.addLayer(u[f])},_addZoomLimit:function(u){(!isNaN(u.options.maxZoom)||!isNaN(u.options.minZoom))&&(this._zoomBoundLayers[l(u)]=u,this._updateZoomLevels())},_removeZoomLimit:function(u){var f=l(u);this._zoomBoundLayers[f]&&(delete this._zoomBoundLayers[f],this._updateZoomLevels())},_updateZoomLevels:function(){var u=1/0,f=-1/0,v=this._getZoomSpan();for(var w in this._zoomBoundLayers){var A=this._zoomBoundLayers[w].options;u=A.minZoom===void 0?u:Math.min(u,A.minZoom),f=A.maxZoom===void 0?f:Math.max(f,A.maxZoom)}this._layersMaxZoom=f===-1/0?void 0:f,this._layersMinZoom=u===1/0?void 0:u,v!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var ac=fa.extend({initialize:function(u,f){y(this,f),this._layers={};var v,w;if(u)for(v=0,w=u.length;v<w;v++)this.addLayer(u[v])},addLayer:function(u){var f=this.getLayerId(u);return this._layers[f]=u,this._map&&this._map.addLayer(u),this},removeLayer:function(u){var f=u in this._layers?u:this.getLayerId(u);return this._map&&this._layers[f]&&this._map.removeLayer(this._layers[f]),delete this._layers[f],this},hasLayer:function(u){var f=typeof u=="number"?u:this.getLayerId(u);return f in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(u){var f=Array.prototype.slice.call(arguments,1),v,w;for(v in this._layers)w=this._layers[v],w[u]&&w[u].apply(w,f);return this},onAdd:function(u){this.eachLayer(u.addLayer,u)},onRemove:function(u){this.eachLayer(u.removeLayer,u)},eachLayer:function(u,f){for(var v in this._layers)u.call(f,this._layers[v]);return this},getLayer:function(u){return this._layers[u]},getLayers:function(){var u=[];return this.eachLayer(u.push,u),u},setZIndex:function(u){return this.invoke("setZIndex",u)},getLayerId:function(u){return l(u)}}),sK=function(u,f){return new ac(u,f)},mo=ac.extend({addLayer:function(u){return this.hasLayer(u)?this:(u.addEventParent(this),ac.prototype.addLayer.call(this,u),this.fire("layeradd",{layer:u}))},removeLayer:function(u){return this.hasLayer(u)?(u in this._layers&&(u=this._layers[u]),u.removeEventParent(this),ac.prototype.removeLayer.call(this,u),this.fire("layerremove",{layer:u})):this},setStyle:function(u){return this.invoke("setStyle",u)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var u=new me;for(var f in this._layers){var v=this._layers[f];u.extend(v.getBounds?v.getBounds():v.getLatLng())}return u}}),lK=function(u,f){return new mo(u,f)},oc=le.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(u){y(this,u)},createIcon:function(u){return this._createIcon("icon",u)},createShadow:function(u){return this._createIcon("shadow",u)},_createIcon:function(u,f){var v=this._getIconUrl(u);if(!v){if(u==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var w=this._createImg(v,f&&f.tagName==="IMG"?f:null);return this._setIconStyles(w,u),(this.options.crossOrigin||this.options.crossOrigin==="")&&(w.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),w},_setIconStyles:function(u,f){var v=this.options,w=v[f+"Size"];typeof w=="number"&&(w=[w,w]);var A=ne(w),W=ne(f==="shadow"&&v.shadowAnchor||v.iconAnchor||A&&A.divideBy(2,!0));u.className="leaflet-marker-"+f+" "+(v.className||""),W&&(u.style.marginLeft=-W.x+"px",u.style.marginTop=-W.y+"px"),A&&(u.style.width=A.x+"px",u.style.height=A.y+"px")},_createImg:function(u,f){return f=f||document.createElement("img"),f.src=u,f},_getIconUrl:function(u){return Ve.retina&&this.options[u+"RetinaUrl"]||this.options[u+"Url"]}});function uK(u){return new oc(u)}var Wf=oc.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(u){return typeof Wf.imagePath!="string"&&(Wf.imagePath=this._detectIconPath()),(this.options.imagePath||Wf.imagePath)+oc.prototype._getIconUrl.call(this,u)},_stripUrl:function(u){var f=function(v,w,A){var W=w.exec(v);return W&&W[A]};return u=f(u,/^url\((['"])?(.+)\1\)$/,2),u&&f(u,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var u=Mt("div","leaflet-default-icon-path",document.body),f=Uf(u,"background-image")||Uf(u,"backgroundImage");if(document.body.removeChild(u),f=this._stripUrl(f),f)return f;var v=document.querySelector('link[href$="leaflet.css"]');return v?v.href.substring(0,v.href.length-11-1):""}}),G3=Pa.extend({initialize:function(u){this._marker=u},addHooks:function(){var u=this._marker._icon;this._draggable||(this._draggable=new cs(u,u,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),ft(u,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&wr(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(u){var f=this._marker,v=f._map,w=this._marker.options.autoPanSpeed,A=this._marker.options.autoPanPadding,W=Rl(f._icon),de=v.getPixelBounds(),ye=v.getPixelOrigin(),Se=oe(de.min._subtract(ye).add(A),de.max._subtract(ye).subtract(A));if(!Se.contains(W)){var Re=ne((Math.max(Se.max.x,W.x)-Se.max.x)/(de.max.x-Se.max.x)-(Math.min(Se.min.x,W.x)-Se.min.x)/(de.min.x-Se.min.x),(Math.max(Se.max.y,W.y)-Se.max.y)/(de.max.y-Se.max.y)-(Math.min(Se.min.y,W.y)-Se.min.y)/(de.min.y-Se.min.y)).multiplyBy(w);v.panBy(Re,{animate:!1}),this._draggable._newPos._add(Re),this._draggable._startPos._add(Re),Mr(f._icon,this._draggable._newPos),this._onDrag(u),this._panRequest=j(this._adjustPan.bind(this,u))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(u){this._marker.options.autoPan&&(J(this._panRequest),this._panRequest=j(this._adjustPan.bind(this,u)))},_onDrag:function(u){var f=this._marker,v=f._shadow,w=Rl(f._icon),A=f._map.layerPointToLatLng(w);v&&Mr(v,w),f._latlng=A,u.latlng=A,u.oldLatLng=this._oldLatLng,f.fire("move",u).fire("drag",u)},_onDragEnd:function(u){J(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",u)}}),vv=fa.extend({options:{icon:new Wf,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(u,f){y(this,f),this._latlng=q(u)},onAdd:function(u){this._zoomAnimated=this._zoomAnimated&&u.options.markerZoomAnimation,this._zoomAnimated&&u.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(u){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&u.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(u){var f=this._latlng;return this._latlng=q(u),this.update(),this.fire("move",{oldLatLng:f,latlng:this._latlng})},setZIndexOffset:function(u){return this.options.zIndexOffset=u,this.update()},getIcon:function(){return this.options.icon},setIcon:function(u){return this.options.icon=u,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var u=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(u)}return this},_initIcon:function(){var u=this.options,f="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),v=u.icon.createIcon(this._icon),w=!1;v!==this._icon&&(this._icon&&this._removeIcon(),w=!0,u.title&&(v.title=u.title),v.tagName==="IMG"&&(v.alt=u.alt||"")),ft(v,f),u.keyboard&&(v.tabIndex="0",v.setAttribute("role","button")),this._icon=v,u.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&lt(v,"focus",this._panOnFocus,this);var A=u.icon.createShadow(this._shadow),W=!1;A!==this._shadow&&(this._removeShadow(),W=!0),A&&(ft(A,f),A.alt=""),this._shadow=A,u.opacity<1&&this._updateOpacity(),w&&this.getPane().appendChild(this._icon),this._initInteraction(),A&&W&&this.getPane(u.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Zt(this._icon,"focus",this._panOnFocus,this),pr(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&pr(this._shadow),this._shadow=null},_setPos:function(u){this._icon&&Mr(this._icon,u),this._shadow&&Mr(this._shadow,u),this._zIndex=u.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(u){this._icon&&(this._icon.style.zIndex=this._zIndex+u)},_animateZoom:function(u){var f=this._map._latLngToNewLayerPoint(this._latlng,u.zoom,u.center).round();this._setPos(f)},_initInteraction:function(){if(this.options.interactive&&(ft(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),G3)){var u=this.options.draggable;this.dragging&&(u=this.dragging.enabled(),this.dragging.disable()),this.dragging=new G3(this),u&&this.dragging.enable()}},setOpacity:function(u){return this.options.opacity=u,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var u=this.options.opacity;this._icon&&Oi(this._icon,u),this._shadow&&Oi(this._shadow,u)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var u=this._map;if(u){var f=this.options.icon.options,v=f.iconSize?ne(f.iconSize):ne(0,0),w=f.iconAnchor?ne(f.iconAnchor):ne(0,0);u.panInside(this._latlng,{paddingTopLeft:w,paddingBottomRight:v.subtract(w)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function cK(u,f){return new vv(u,f)}var ds=fa.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(u){this._renderer=u.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(u){return y(this,u),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&u&&Object.prototype.hasOwnProperty.call(u,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),gv=ds.extend({options:{fill:!0,radius:10},initialize:function(u,f){y(this,f),this._latlng=q(u),this._radius=this.options.radius},setLatLng:function(u){var f=this._latlng;return this._latlng=q(u),this.redraw(),this.fire("move",{oldLatLng:f,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(u){return this.options.radius=this._radius=u,this.redraw()},getRadius:function(){return this._radius},setStyle:function(u){var f=u&&u.radius||this._radius;return ds.prototype.setStyle.call(this,u),this.setRadius(f),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var u=this._radius,f=this._radiusY||u,v=this._clickTolerance(),w=[u+v,f+v];this._pxBounds=new he(this._point.subtract(w),this._point.add(w))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(u){return u.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function dK(u,f){return new gv(u,f)}var O_=gv.extend({initialize:function(u,f,v){if(typeof f=="number"&&(f=i({},v,{radius:f})),y(this,f),this._latlng=q(u),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(u){return this._mRadius=u,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var u=[this._radius,this._radiusY||this._radius];return new me(this._map.layerPointToLatLng(this._point.subtract(u)),this._map.layerPointToLatLng(this._point.add(u)))},setStyle:ds.prototype.setStyle,_project:function(){var u=this._latlng.lng,f=this._latlng.lat,v=this._map,w=v.options.crs;if(w.distance===F.distance){var A=Math.PI/180,W=this._mRadius/F.R/A,de=v.project([f+W,u]),ye=v.project([f-W,u]),Se=de.add(ye).divideBy(2),Re=v.unproject(Se).lat,Fe=Math.acos((Math.cos(W*A)-Math.sin(f*A)*Math.sin(Re*A))/(Math.cos(f*A)*Math.cos(Re*A)))/A;(isNaN(Fe)||Fe===0)&&(Fe=W/Math.cos(Math.PI/180*f)),this._point=Se.subtract(v.getPixelOrigin()),this._radius=isNaN(Fe)?0:Se.x-v.project([Re,u-Fe]).x,this._radiusY=Se.y-de.y}else{var Ye=w.unproject(w.project(this._latlng).subtract([this._mRadius,0]));this._point=v.latLngToLayerPoint(this._latlng),this._radius=this._point.x-v.latLngToLayerPoint(Ye).x}this._updateBounds()}});function fK(u,f,v){return new O_(u,f,v)}var vo=ds.extend({options:{smoothFactor:1,noClip:!1},initialize:function(u,f){y(this,f),this._setLatLngs(u)},getLatLngs:function(){return this._latlngs},setLatLngs:function(u){return this._setLatLngs(u),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(u){for(var f=1/0,v=null,w=Hf,A,W,de=0,ye=this._parts.length;de<ye;de++)for(var Se=this._parts[de],Re=1,Fe=Se.length;Re<Fe;Re++){A=Se[Re-1],W=Se[Re];var Ye=w(u,A,W,!0);Ye<f&&(f=Ye,v=w(u,A,W))}return v&&(v.distance=Math.sqrt(f)),v},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return H3(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(u,f){return f=f||this._defaultShape(),u=q(u),f.push(u),this._bounds.extend(u),this.redraw()},_setLatLngs:function(u){this._bounds=new me,this._latlngs=this._convertLatLngs(u)},_defaultShape:function(){return $i(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(u){for(var f=[],v=$i(u),w=0,A=u.length;w<A;w++)v?(f[w]=q(u[w]),this._bounds.extend(f[w])):f[w]=this._convertLatLngs(u[w]);return f},_project:function(){var u=new he;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,u),this._bounds.isValid()&&u.isValid()&&(this._rawPxBounds=u,this._updateBounds())},_updateBounds:function(){var u=this._clickTolerance(),f=new H(u,u);this._rawPxBounds&&(this._pxBounds=new he([this._rawPxBounds.min.subtract(f),this._rawPxBounds.max.add(f)]))},_projectLatlngs:function(u,f,v){var w=u[0]instanceof Y,A=u.length,W,de;if(w){for(de=[],W=0;W<A;W++)de[W]=this._map.latLngToLayerPoint(u[W]),v.extend(de[W]);f.push(de)}else for(W=0;W<A;W++)this._projectLatlngs(u[W],f,v)},_clipPoints:function(){var u=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(u))){if(this.options.noClip){this._parts=this._rings;return}var f=this._parts,v,w,A,W,de,ye,Se;for(v=0,A=0,W=this._rings.length;v<W;v++)for(Se=this._rings[v],w=0,de=Se.length;w<de-1;w++)ye=z3(Se[w],Se[w+1],u,w,!0),ye&&(f[A]=f[A]||[],f[A].push(ye[0]),(ye[1]!==Se[w+1]||w===de-2)&&(f[A].push(ye[1]),A++))}},_simplifyPoints:function(){for(var u=this._parts,f=this.options.smoothFactor,v=0,w=u.length;v<w;v++)u[v]=F3(u[v],f)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(u,f){var v,w,A,W,de,ye,Se=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(u))return!1;for(v=0,W=this._parts.length;v<W;v++)for(ye=this._parts[v],w=0,de=ye.length,A=de-1;w<de;A=w++)if(!(!f&&w===0)&&j3(u,ye[A],ye[w])<=Se)return!0;return!1}});function hK(u,f){return new vo(u,f)}vo._flat=K3;var sc=vo.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return U3(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(u){var f=vo.prototype._convertLatLngs.call(this,u),v=f.length;return v>=2&&f[0]instanceof Y&&f[0].equals(f[v-1])&&f.pop(),f},_setLatLngs:function(u){vo.prototype._setLatLngs.call(this,u),$i(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return $i(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var u=this._renderer._bounds,f=this.options.weight,v=new H(f,f);if(u=new he(u.min.subtract(v),u.max.add(v)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(u))){if(this.options.noClip){this._parts=this._rings;return}for(var w=0,A=this._rings.length,W;w<A;w++)W=N3(this._rings[w],u,!0),W.length&&this._parts.push(W)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(u){var f=!1,v,w,A,W,de,ye,Se,Re;if(!this._pxBounds||!this._pxBounds.contains(u))return!1;for(W=0,Se=this._parts.length;W<Se;W++)for(v=this._parts[W],de=0,Re=v.length,ye=Re-1;de<Re;ye=de++)w=v[de],A=v[ye],w.y>u.y!=A.y>u.y&&u.x<(A.x-w.x)*(u.y-w.y)/(A.y-w.y)+w.x&&(f=!f);return f||vo.prototype._containsPoint.call(this,u,!0)}});function pK(u,f){return new sc(u,f)}var go=mo.extend({initialize:function(u,f){y(this,f),this._layers={},u&&this.addData(u)},addData:function(u){var f=x(u)?u:u.features,v,w,A;if(f){for(v=0,w=f.length;v<w;v++)A=f[v],(A.geometries||A.geometry||A.features||A.coordinates)&&this.addData(A);return this}var W=this.options;if(W.filter&&!W.filter(u))return this;var de=yv(u,W);return de?(de.feature=Sv(u),de.defaultOptions=de.options,this.resetStyle(de),W.onEachFeature&&W.onEachFeature(u,de),this.addLayer(de)):this},resetStyle:function(u){return u===void 0?this.eachLayer(this.resetStyle,this):(u.options=i({},u.defaultOptions),this._setLayerStyle(u,this.options.style),this)},setStyle:function(u){return this.eachLayer(function(f){this._setLayerStyle(f,u)},this)},_setLayerStyle:function(u,f){u.setStyle&&(typeof f=="function"&&(f=f(u.feature)),u.setStyle(f))}});function yv(u,f){var v=u.type==="Feature"?u.geometry:u,w=v?v.coordinates:null,A=[],W=f&&f.pointToLayer,de=f&&f.coordsToLatLng||$_,ye,Se,Re,Fe;if(!w&&!v)return null;switch(v.type){case"Point":return ye=de(w),q3(W,u,ye,f);case"MultiPoint":for(Re=0,Fe=w.length;Re<Fe;Re++)ye=de(w[Re]),A.push(q3(W,u,ye,f));return new mo(A);case"LineString":case"MultiLineString":return Se=bv(w,v.type==="LineString"?0:1,de),new vo(Se,f);case"Polygon":case"MultiPolygon":return Se=bv(w,v.type==="Polygon"?1:2,de),new sc(Se,f);case"GeometryCollection":for(Re=0,Fe=v.geometries.length;Re<Fe;Re++){var Ye=yv({geometry:v.geometries[Re],type:"Feature",properties:u.properties},f);Ye&&A.push(Ye)}return new mo(A);case"FeatureCollection":for(Re=0,Fe=v.features.length;Re<Fe;Re++){var yt=yv(v.features[Re],f);yt&&A.push(yt)}return new mo(A);default:throw new Error("Invalid GeoJSON object.")}}function q3(u,f,v,w){return u?u(f,v):new vv(v,w&&w.markersInheritOptions&&w)}function $_(u){return new Y(u[1],u[0],u[2])}function bv(u,f,v){for(var w=[],A=0,W=u.length,de;A<W;A++)de=f?bv(u[A],f-1,v):(v||$_)(u[A]),w.push(de);return w}function L_(u,f){return u=q(u),u.alt!==void 0?[p(u.lng,f),p(u.lat,f),p(u.alt,f)]:[p(u.lng,f),p(u.lat,f)]}function _v(u,f,v,w){for(var A=[],W=0,de=u.length;W<de;W++)A.push(f?_v(u[W],$i(u[W])?0:f-1,v,w):L_(u[W],w));return!f&&v&&A.length>0&&A.push(A[0].slice()),A}function lc(u,f){return u.feature?i({},u.feature,{geometry:f}):Sv(f)}function Sv(u){return u.type==="Feature"||u.type==="FeatureCollection"?u:{type:"Feature",properties:{},geometry:u}}var B_={toGeoJSON:function(u){return lc(this,{type:"Point",coordinates:L_(this.getLatLng(),u)})}};vv.include(B_),O_.include(B_),gv.include(B_),vo.include({toGeoJSON:function(u){var f=!$i(this._latlngs),v=_v(this._latlngs,f?1:0,!1,u);return lc(this,{type:(f?"Multi":"")+"LineString",coordinates:v})}}),sc.include({toGeoJSON:function(u){var f=!$i(this._latlngs),v=f&&!$i(this._latlngs[0]),w=_v(this._latlngs,v?2:f?1:0,!0,u);return f||(w=[w]),lc(this,{type:(v?"Multi":"")+"Polygon",coordinates:w})}}),ac.include({toMultiPoint:function(u){var f=[];return this.eachLayer(function(v){f.push(v.toGeoJSON(u).geometry.coordinates)}),lc(this,{type:"MultiPoint",coordinates:f})},toGeoJSON:function(u){var f=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(f==="MultiPoint")return this.toMultiPoint(u);var v=f==="GeometryCollection",w=[];return this.eachLayer(function(A){if(A.toGeoJSON){var W=A.toGeoJSON(u);if(v)w.push(W.geometry);else{var de=Sv(W);de.type==="FeatureCollection"?w.push.apply(w,de.features):w.push(de)}}}),v?lc(this,{geometries:w,type:"GeometryCollection"}):{type:"FeatureCollection",features:w}}});function Z3(u,f){return new go(u,f)}var mK=Z3,wv=fa.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(u,f,v){this._url=u,this._bounds=ee(f),y(this,v)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(ft(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){pr(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(u){return this.options.opacity=u,this._image&&this._updateOpacity(),this},setStyle:function(u){return u.opacity&&this.setOpacity(u.opacity),this},bringToFront:function(){return this._map&&nc(this._image),this},bringToBack:function(){return this._map&&ic(this._image),this},setUrl:function(u){return this._url=u,this._image&&(this._image.src=u),this},setBounds:function(u){return this._bounds=ee(u),this._map&&this._reset(),this},getEvents:function(){var u={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(u.zoomanim=this._animateZoom),u},setZIndex:function(u){return this.options.zIndex=u,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var u=this._url.tagName==="IMG",f=this._image=u?this._url:Mt("img");if(ft(f,"leaflet-image-layer"),this._zoomAnimated&&ft(f,"leaflet-zoom-animated"),this.options.className&&ft(f,this.options.className),f.onselectstart=h,f.onmousemove=h,f.onload=o(this.fire,this,"load"),f.onerror=o(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(f.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),u){this._url=f.src;return}f.src=this._url,f.alt=this.options.alt},_animateZoom:function(u){var f=this._map.getZoomScale(u.zoom),v=this._map._latLngBoundsToNewLayerBounds(this._bounds,u.zoom,u.center).min;Dl(this._image,v,f)},_reset:function(){var u=this._image,f=new he(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),v=f.getSize();Mr(u,f.min),u.style.width=v.x+"px",u.style.height=v.y+"px"},_updateOpacity:function(){Oi(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var u=this.options.errorOverlayUrl;u&&this._url!==u&&(this._url=u,this._image.src=u)},getCenter:function(){return this._bounds.getCenter()}}),vK=function(u,f,v){return new wv(u,f,v)},Y3=wv.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var u=this._url.tagName==="VIDEO",f=this._image=u?this._url:Mt("video");if(ft(f,"leaflet-image-layer"),this._zoomAnimated&&ft(f,"leaflet-zoom-animated"),this.options.className&&ft(f,this.options.className),f.onselectstart=h,f.onmousemove=h,f.onloadeddata=o(this.fire,this,"load"),u){for(var v=f.getElementsByTagName("source"),w=[],A=0;A<v.length;A++)w.push(v[A].src);this._url=v.length>0?w:[f.src];return}x(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(f.style,"objectFit")&&(f.style.objectFit="fill"),f.autoplay=!!this.options.autoplay,f.loop=!!this.options.loop,f.muted=!!this.options.muted,f.playsInline=!!this.options.playsInline;for(var W=0;W<this._url.length;W++){var de=Mt("source");de.src=this._url[W],f.appendChild(de)}}});function gK(u,f,v){return new Y3(u,f,v)}var J3=wv.extend({_initImage:function(){var u=this._image=this._url;ft(u,"leaflet-image-layer"),this._zoomAnimated&&ft(u,"leaflet-zoom-animated"),this.options.className&&ft(u,this.options.className),u.onselectstart=h,u.onmousemove=h}});function yK(u,f,v){return new J3(u,f,v)}var Aa=fa.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(u,f){u&&(u instanceof Y||x(u))?(this._latlng=q(u),y(this,f)):(y(this,u),this._source=f),this.options.content&&(this._content=this.options.content)},openOn:function(u){return u=arguments.length?u:this._source._map,u.hasLayer(this)||u.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(u){return this._map?this.close():(arguments.length?this._source=u:u=this._source,this._prepareOpen(),this.openOn(u._map)),this},onAdd:function(u){this._zoomAnimated=u._zoomAnimated,this._container||this._initLayout(),u._fadeAnimated&&Oi(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),u._fadeAnimated&&Oi(this._container,1),this.bringToFront(),this.options.interactive&&(ft(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(u){u._fadeAnimated?(Oi(this._container,0),this._removeTimeout=setTimeout(o(pr,void 0,this._container),200)):pr(this._container),this.options.interactive&&(wr(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(u){return this._latlng=q(u),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(u){return this._content=u,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var u={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(u.zoomanim=this._animateZoom),u},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&nc(this._container),this},bringToBack:function(){return this._map&&ic(this._container),this},_prepareOpen:function(u){var f=this._source;if(!f._map)return!1;if(f instanceof mo){f=null;var v=this._source._layers;for(var w in v)if(v[w]._map){f=v[w];break}if(!f)return!1;this._source=f}if(!u)if(f.getCenter)u=f.getCenter();else if(f.getLatLng)u=f.getLatLng();else if(f.getBounds)u=f.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(u),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var u=this._contentNode,f=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof f=="string")u.innerHTML=f;else{for(;u.hasChildNodes();)u.removeChild(u.firstChild);u.appendChild(f)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var u=this._map.latLngToLayerPoint(this._latlng),f=ne(this.options.offset),v=this._getAnchor();this._zoomAnimated?Mr(this._container,u.add(v)):f=f.add(u).add(v);var w=this._containerBottom=-f.y,A=this._containerLeft=-Math.round(this._containerWidth/2)+f.x;this._container.style.bottom=w+"px",this._container.style.left=A+"px"}},_getAnchor:function(){return[0,0]}});xt.include({_initOverlay:function(u,f,v,w){var A=f;return A instanceof u||(A=new u(w).setContent(f)),v&&A.setLatLng(v),A}}),fa.include({_initOverlay:function(u,f,v,w){var A=v;return A instanceof u?(y(A,w),A._source=this):(A=f&&!w?f:new u(w,this),A.setContent(v)),A}});var Ev=Aa.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(u){return u=arguments.length?u:this._source._map,!u.hasLayer(this)&&u._popup&&u._popup.options.autoClose&&u.removeLayer(u._popup),u._popup=this,Aa.prototype.openOn.call(this,u)},onAdd:function(u){Aa.prototype.onAdd.call(this,u),u.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof ds||this._source.on("preclick",Ml))},onRemove:function(u){Aa.prototype.onRemove.call(this,u),u.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof ds||this._source.off("preclick",Ml))},getEvents:function(){var u=Aa.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(u.preclick=this.close),this.options.keepInView&&(u.moveend=this._adjustPan),u},_initLayout:function(){var u="leaflet-popup",f=this._container=Mt("div",u+" "+(this.options.className||"")+" leaflet-zoom-animated"),v=this._wrapper=Mt("div",u+"-content-wrapper",f);if(this._contentNode=Mt("div",u+"-content",v),zf(f),T_(this._contentNode),lt(f,"contextmenu",Ml),this._tipContainer=Mt("div",u+"-tip-container",f),this._tip=Mt("div",u+"-tip",this._tipContainer),this.options.closeButton){var w=this._closeButton=Mt("a",u+"-close-button",f);w.setAttribute("role","button"),w.setAttribute("aria-label","Close popup"),w.href="#close",w.innerHTML='<span aria-hidden="true">&#215;</span>',lt(w,"click",function(A){cn(A),this.close()},this)}},_updateLayout:function(){var u=this._contentNode,f=u.style;f.width="",f.whiteSpace="nowrap";var v=u.offsetWidth;v=Math.min(v,this.options.maxWidth),v=Math.max(v,this.options.minWidth),f.width=v+1+"px",f.whiteSpace="",f.height="";var w=u.offsetHeight,A=this.options.maxHeight,W="leaflet-popup-scrolled";A&&w>A?(f.height=A+"px",ft(u,W)):wr(u,W),this._containerWidth=this._container.offsetWidth},_animateZoom:function(u){var f=this._map._latLngToNewLayerPoint(this._latlng,u.zoom,u.center),v=this._getAnchor();Mr(this._container,f.add(v))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var u=this._map,f=parseInt(Uf(this._container,"marginBottom"),10)||0,v=this._container.offsetHeight+f,w=this._containerWidth,A=new H(this._containerLeft,-v-this._containerBottom);A._add(Rl(this._container));var W=u.layerPointToContainerPoint(A),de=ne(this.options.autoPanPadding),ye=ne(this.options.autoPanPaddingTopLeft||de),Se=ne(this.options.autoPanPaddingBottomRight||de),Re=u.getSize(),Fe=0,Ye=0;W.x+w+Se.x>Re.x&&(Fe=W.x+w-Re.x+Se.x),W.x-Fe-ye.x<0&&(Fe=W.x-ye.x),W.y+v+Se.y>Re.y&&(Ye=W.y+v-Re.y+Se.y),W.y-Ye-ye.y<0&&(Ye=W.y-ye.y),(Fe||Ye)&&(this.options.keepInView&&(this._autopanning=!0),u.fire("autopanstart").panBy([Fe,Ye]))}},_getAnchor:function(){return ne(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),bK=function(u,f){return new Ev(u,f)};xt.mergeOptions({closePopupOnClick:!0}),xt.include({openPopup:function(u,f,v){return this._initOverlay(Ev,u,f,v).openOn(this),this},closePopup:function(u){return u=arguments.length?u:this._popup,u&&u.close(),this}}),fa.include({bindPopup:function(u,f){return this._popup=this._initOverlay(Ev,this._popup,u,f),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(u){return this._popup&&(this instanceof mo||(this._popup._source=this),this._popup._prepareOpen(u||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(u){return this._popup&&this._popup.setContent(u),this},getPopup:function(){return this._popup},_openPopup:function(u){if(!(!this._popup||!this._map)){Il(u);var f=u.layer||u.target;if(this._popup._source===f&&!(f instanceof ds)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(u.latlng);return}this._popup._source=f,this.openPopup(u.latlng)}},_movePopup:function(u){this._popup.setLatLng(u.latlng)},_onKeyPress:function(u){u.originalEvent.keyCode===13&&this._openPopup(u)}});var xv=Aa.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(u){Aa.prototype.onAdd.call(this,u),this.setOpacity(this.options.opacity),u.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(u){Aa.prototype.onRemove.call(this,u),u.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var u=Aa.prototype.getEvents.call(this);return this.options.permanent||(u.preclick=this.close),u},_initLayout:function(){var u="leaflet-tooltip",f=u+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=Mt("div",f),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+l(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(u){var f,v,w=this._map,A=this._container,W=w.latLngToContainerPoint(w.getCenter()),de=w.layerPointToContainerPoint(u),ye=this.options.direction,Se=A.offsetWidth,Re=A.offsetHeight,Fe=ne(this.options.offset),Ye=this._getAnchor();ye==="top"?(f=Se/2,v=Re):ye==="bottom"?(f=Se/2,v=0):ye==="center"?(f=Se/2,v=Re/2):ye==="right"?(f=0,v=Re/2):ye==="left"?(f=Se,v=Re/2):de.x<W.x?(ye="right",f=0,v=Re/2):(ye="left",f=Se+(Fe.x+Ye.x)*2,v=Re/2),u=u.subtract(ne(f,v,!0)).add(Fe).add(Ye),wr(A,"leaflet-tooltip-right"),wr(A,"leaflet-tooltip-left"),wr(A,"leaflet-tooltip-top"),wr(A,"leaflet-tooltip-bottom"),ft(A,"leaflet-tooltip-"+ye),Mr(A,u)},_updatePosition:function(){var u=this._map.latLngToLayerPoint(this._latlng);this._setPosition(u)},setOpacity:function(u){this.options.opacity=u,this._container&&Oi(this._container,u)},_animateZoom:function(u){var f=this._map._latLngToNewLayerPoint(this._latlng,u.zoom,u.center);this._setPosition(f)},_getAnchor:function(){return ne(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),_K=function(u,f){return new xv(u,f)};xt.include({openTooltip:function(u,f,v){return this._initOverlay(xv,u,f,v).openOn(this),this},closeTooltip:function(u){return u.close(),this}}),fa.include({bindTooltip:function(u,f){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(xv,this._tooltip,u,f),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(u){if(!(!u&&this._tooltipHandlersAdded)){var f=u?"off":"on",v={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?v.add=this._openTooltip:(v.mouseover=this._openTooltip,v.mouseout=this.closeTooltip,v.click=this._openTooltip,this._map?this._addFocusListeners():v.add=this._addFocusListeners),this._tooltip.options.sticky&&(v.mousemove=this._moveTooltip),this[f](v),this._tooltipHandlersAdded=!u}},openTooltip:function(u){return this._tooltip&&(this instanceof mo||(this._tooltip._source=this),this._tooltip._prepareOpen(u)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(u){return this._tooltip&&this._tooltip.setContent(u),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(u){var f=typeof u.getElement=="function"&&u.getElement();f&&(lt(f,"focus",function(){this._tooltip._source=u,this.openTooltip()},this),lt(f,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(u){var f=typeof u.getElement=="function"&&u.getElement();f&&f.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(u){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var f=this;this._map.once("moveend",function(){f._openOnceFlag=!1,f._openTooltip(u)});return}this._tooltip._source=u.layer||u.target,this.openTooltip(this._tooltip.options.sticky?u.latlng:void 0)}},_moveTooltip:function(u){var f=u.latlng,v,w;this._tooltip.options.sticky&&u.originalEvent&&(v=this._map.mouseEventToContainerPoint(u.originalEvent),w=this._map.containerPointToLayerPoint(v),f=this._map.layerPointToLatLng(w)),this._tooltip.setLatLng(f)}});var X3=oc.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(u){var f=u&&u.tagName==="DIV"?u:document.createElement("div"),v=this.options;if(v.html instanceof Element?(cv(f),f.appendChild(v.html)):f.innerHTML=v.html!==!1?v.html:"",v.bgPos){var w=ne(v.bgPos);f.style.backgroundPosition=-w.x+"px "+-w.y+"px"}return this._setIconStyles(f,"icon"),f},createShadow:function(){return null}});function SK(u){return new X3(u)}oc.Default=Wf;var Gf=fa.extend({options:{tileSize:256,opacity:1,updateWhenIdle:Ve.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(u){y(this,u)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(u){u._addZoomLimit(this)},onRemove:function(u){this._removeAllTiles(),pr(this._container),u._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(nc(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(ic(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(u){return this.options.opacity=u,this._updateOpacity(),this},setZIndex:function(u){return this.options.zIndex=u,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var u=this._clampZoom(this._map.getZoom());u!==this._tileZoom&&(this._tileZoom=u,this._updateLevels()),this._update()}return this},getEvents:function(){var u={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=c(this._onMoveEnd,this.options.updateInterval,this)),u.move=this._onMove),this._zoomAnimated&&(u.zoomanim=this._animateZoom),u},createTile:function(){return document.createElement("div")},getTileSize:function(){var u=this.options.tileSize;return u instanceof H?u:new H(u,u)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(u){for(var f=this.getPane().children,v=-u(-1/0,1/0),w=0,A=f.length,W;w<A;w++)W=f[w].style.zIndex,f[w]!==this._container&&W&&(v=u(v,+W));isFinite(v)&&(this.options.zIndex=v+u(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!Ve.ielt9){Oi(this._container,this.options.opacity);var u=+new Date,f=!1,v=!1;for(var w in this._tiles){var A=this._tiles[w];if(!(!A.current||!A.loaded)){var W=Math.min(1,(u-A.loaded)/200);Oi(A.el,W),W<1?f=!0:(A.active?v=!0:this._onOpaqueTile(A),A.active=!0)}}v&&!this._noPrune&&this._pruneTiles(),f&&(J(this._fadeFrame),this._fadeFrame=j(this._updateOpacity,this))}},_onOpaqueTile:h,_initContainer:function(){this._container||(this._container=Mt("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var u=this._tileZoom,f=this.options.maxZoom;if(u!==void 0){for(var v in this._levels)v=Number(v),this._levels[v].el.children.length||v===u?(this._levels[v].el.style.zIndex=f-Math.abs(u-v),this._onUpdateLevel(v)):(pr(this._levels[v].el),this._removeTilesAtZoom(v),this._onRemoveLevel(v),delete this._levels[v]);var w=this._levels[u],A=this._map;return w||(w=this._levels[u]={},w.el=Mt("div","leaflet-tile-container leaflet-zoom-animated",this._container),w.el.style.zIndex=f,w.origin=A.project(A.unproject(A.getPixelOrigin()),u).round(),w.zoom=u,this._setZoomTransform(w,A.getCenter(),A.getZoom()),h(w.el.offsetWidth),this._onCreateLevel(w)),this._level=w,w}},_onUpdateLevel:h,_onRemoveLevel:h,_onCreateLevel:h,_pruneTiles:function(){if(this._map){var u,f,v=this._map.getZoom();if(v>this.options.maxZoom||v<this.options.minZoom){this._removeAllTiles();return}for(u in this._tiles)f=this._tiles[u],f.retain=f.current;for(u in this._tiles)if(f=this._tiles[u],f.current&&!f.active){var w=f.coords;this._retainParent(w.x,w.y,w.z,w.z-5)||this._retainChildren(w.x,w.y,w.z,w.z+2)}for(u in this._tiles)this._tiles[u].retain||this._removeTile(u)}},_removeTilesAtZoom:function(u){for(var f in this._tiles)this._tiles[f].coords.z===u&&this._removeTile(f)},_removeAllTiles:function(){for(var u in this._tiles)this._removeTile(u)},_invalidateAll:function(){for(var u in this._levels)pr(this._levels[u].el),this._onRemoveLevel(Number(u)),delete this._levels[u];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(u,f,v,w){var A=Math.floor(u/2),W=Math.floor(f/2),de=v-1,ye=new H(+A,+W);ye.z=+de;var Se=this._tileCoordsToKey(ye),Re=this._tiles[Se];return Re&&Re.active?(Re.retain=!0,!0):(Re&&Re.loaded&&(Re.retain=!0),de>w?this._retainParent(A,W,de,w):!1)},_retainChildren:function(u,f,v,w){for(var A=2*u;A<2*u+2;A++)for(var W=2*f;W<2*f+2;W++){var de=new H(A,W);de.z=v+1;var ye=this._tileCoordsToKey(de),Se=this._tiles[ye];if(Se&&Se.active){Se.retain=!0;continue}else Se&&Se.loaded&&(Se.retain=!0);v+1<w&&this._retainChildren(A,W,v+1,w)}},_resetView:function(u){var f=u&&(u.pinch||u.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),f,f)},_animateZoom:function(u){this._setView(u.center,u.zoom,!0,u.noUpdate)},_clampZoom:function(u){var f=this.options;return f.minNativeZoom!==void 0&&u<f.minNativeZoom?f.minNativeZoom:f.maxNativeZoom!==void 0&&f.maxNativeZoom<u?f.maxNativeZoom:u},_setView:function(u,f,v,w){var A=Math.round(f);this.options.maxZoom!==void 0&&A>this.options.maxZoom||this.options.minZoom!==void 0&&A<this.options.minZoom?A=void 0:A=this._clampZoom(A);var W=this.options.updateWhenZooming&&A!==this._tileZoom;(!w||W)&&(this._tileZoom=A,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),A!==void 0&&this._update(u),v||this._pruneTiles(),this._noPrune=!!v),this._setZoomTransforms(u,f)},_setZoomTransforms:function(u,f){for(var v in this._levels)this._setZoomTransform(this._levels[v],u,f)},_setZoomTransform:function(u,f,v){var w=this._map.getZoomScale(v,u.zoom),A=u.origin.multiplyBy(w).subtract(this._map._getNewPixelOrigin(f,v)).round();Ve.any3d?Dl(u.el,A,w):Mr(u.el,A)},_resetGrid:function(){var u=this._map,f=u.options.crs,v=this._tileSize=this.getTileSize(),w=this._tileZoom,A=this._map.getPixelWorldBounds(this._tileZoom);A&&(this._globalTileRange=this._pxBoundsToTileRange(A)),this._wrapX=f.wrapLng&&!this.options.noWrap&&[Math.floor(u.project([0,f.wrapLng[0]],w).x/v.x),Math.ceil(u.project([0,f.wrapLng[1]],w).x/v.y)],this._wrapY=f.wrapLat&&!this.options.noWrap&&[Math.floor(u.project([f.wrapLat[0],0],w).y/v.x),Math.ceil(u.project([f.wrapLat[1],0],w).y/v.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(u){var f=this._map,v=f._animatingZoom?Math.max(f._animateToZoom,f.getZoom()):f.getZoom(),w=f.getZoomScale(v,this._tileZoom),A=f.project(u,this._tileZoom).floor(),W=f.getSize().divideBy(w*2);return new he(A.subtract(W),A.add(W))},_update:function(u){var f=this._map;if(f){var v=this._clampZoom(f.getZoom());if(u===void 0&&(u=f.getCenter()),this._tileZoom!==void 0){var w=this._getTiledPixelBounds(u),A=this._pxBoundsToTileRange(w),W=A.getCenter(),de=[],ye=this.options.keepBuffer,Se=new he(A.getBottomLeft().subtract([ye,-ye]),A.getTopRight().add([ye,-ye]));if(!(isFinite(A.min.x)&&isFinite(A.min.y)&&isFinite(A.max.x)&&isFinite(A.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var Re in this._tiles){var Fe=this._tiles[Re].coords;(Fe.z!==this._tileZoom||!Se.contains(new H(Fe.x,Fe.y)))&&(this._tiles[Re].current=!1)}if(Math.abs(v-this._tileZoom)>1){this._setView(u,v);return}for(var Ye=A.min.y;Ye<=A.max.y;Ye++)for(var yt=A.min.x;yt<=A.max.x;yt++){var Rn=new H(yt,Ye);if(Rn.z=this._tileZoom,!!this._isValidTile(Rn)){var Gr=this._tiles[this._tileCoordsToKey(Rn)];Gr?Gr.current=!0:de.push(Rn)}}if(de.sort(function(Vn,cc){return Vn.distanceTo(W)-cc.distanceTo(W)}),de.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var Li=document.createDocumentFragment();for(yt=0;yt<de.length;yt++)this._addTile(de[yt],Li);this._level.el.appendChild(Li)}}}},_isValidTile:function(u){var f=this._map.options.crs;if(!f.infinite){var v=this._globalTileRange;if(!f.wrapLng&&(u.x<v.min.x||u.x>v.max.x)||!f.wrapLat&&(u.y<v.min.y||u.y>v.max.y))return!1}if(!this.options.bounds)return!0;var w=this._tileCoordsToBounds(u);return ee(this.options.bounds).overlaps(w)},_keyToBounds:function(u){return this._tileCoordsToBounds(this._keyToTileCoords(u))},_tileCoordsToNwSe:function(u){var f=this._map,v=this.getTileSize(),w=u.scaleBy(v),A=w.add(v),W=f.unproject(w,u.z),de=f.unproject(A,u.z);return[W,de]},_tileCoordsToBounds:function(u){var f=this._tileCoordsToNwSe(u),v=new me(f[0],f[1]);return this.options.noWrap||(v=this._map.wrapLatLngBounds(v)),v},_tileCoordsToKey:function(u){return u.x+":"+u.y+":"+u.z},_keyToTileCoords:function(u){var f=u.split(":"),v=new H(+f[0],+f[1]);return v.z=+f[2],v},_removeTile:function(u){var f=this._tiles[u];f&&(pr(f.el),delete this._tiles[u],this.fire("tileunload",{tile:f.el,coords:this._keyToTileCoords(u)}))},_initTile:function(u){ft(u,"leaflet-tile");var f=this.getTileSize();u.style.width=f.x+"px",u.style.height=f.y+"px",u.onselectstart=h,u.onmousemove=h,Ve.ielt9&&this.options.opacity<1&&Oi(u,this.options.opacity)},_addTile:function(u,f){var v=this._getTilePos(u),w=this._tileCoordsToKey(u),A=this.createTile(this._wrapCoords(u),o(this._tileReady,this,u));this._initTile(A),this.createTile.length<2&&j(o(this._tileReady,this,u,null,A)),Mr(A,v),this._tiles[w]={el:A,coords:u,current:!0},f.appendChild(A),this.fire("tileloadstart",{tile:A,coords:u})},_tileReady:function(u,f,v){f&&this.fire("tileerror",{error:f,tile:v,coords:u});var w=this._tileCoordsToKey(u);v=this._tiles[w],v&&(v.loaded=+new Date,this._map._fadeAnimated?(Oi(v.el,0),J(this._fadeFrame),this._fadeFrame=j(this._updateOpacity,this)):(v.active=!0,this._pruneTiles()),f||(ft(v.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:v.el,coords:u})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),Ve.ielt9||!this._map._fadeAnimated?j(this._pruneTiles,this):setTimeout(o(this._pruneTiles,this),250)))},_getTilePos:function(u){return u.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(u){var f=new H(this._wrapX?d(u.x,this._wrapX):u.x,this._wrapY?d(u.y,this._wrapY):u.y);return f.z=u.z,f},_pxBoundsToTileRange:function(u){var f=this.getTileSize();return new he(u.min.unscaleBy(f).floor(),u.max.unscaleBy(f).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var u in this._tiles)if(!this._tiles[u].loaded)return!1;return!0}});function wK(u){return new Gf(u)}var uc=Gf.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(u,f){this._url=u,f=y(this,f),f.detectRetina&&Ve.retina&&f.maxZoom>0?(f.tileSize=Math.floor(f.tileSize/2),f.zoomReverse?(f.zoomOffset--,f.minZoom=Math.min(f.maxZoom,f.minZoom+1)):(f.zoomOffset++,f.maxZoom=Math.max(f.minZoom,f.maxZoom-1)),f.minZoom=Math.max(0,f.minZoom)):f.zoomReverse?f.minZoom=Math.min(f.maxZoom,f.minZoom):f.maxZoom=Math.max(f.minZoom,f.maxZoom),typeof f.subdomains=="string"&&(f.subdomains=f.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(u,f){return this._url===u&&f===void 0&&(f=!0),this._url=u,f||this.redraw(),this},createTile:function(u,f){var v=document.createElement("img");return lt(v,"load",o(this._tileOnLoad,this,f,v)),lt(v,"error",o(this._tileOnError,this,f,v)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(v.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(v.referrerPolicy=this.options.referrerPolicy),v.alt="",v.src=this.getTileUrl(u),v},getTileUrl:function(u){var f={r:Ve.retina?"@2x":"",s:this._getSubdomain(u),x:u.x,y:u.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var v=this._globalTileRange.max.y-u.y;this.options.tms&&(f.y=v),f["-y"]=v}return _(this._url,i(f,this.options))},_tileOnLoad:function(u,f){Ve.ielt9?setTimeout(o(u,this,null,f),0):u(null,f)},_tileOnError:function(u,f,v){var w=this.options.errorTileUrl;w&&f.getAttribute("src")!==w&&(f.src=w),u(v,f)},_onTileRemove:function(u){u.tile.onload=null},_getZoomForUrl:function(){var u=this._tileZoom,f=this.options.maxZoom,v=this.options.zoomReverse,w=this.options.zoomOffset;return v&&(u=f-u),u+w},_getSubdomain:function(u){var f=Math.abs(u.x+u.y)%this.options.subdomains.length;return this.options.subdomains[f]},_abortLoading:function(){var u,f;for(u in this._tiles)if(this._tiles[u].coords.z!==this._tileZoom&&(f=this._tiles[u].el,f.onload=h,f.onerror=h,!f.complete)){f.src=I;var v=this._tiles[u].coords;pr(f),delete this._tiles[u],this.fire("tileabort",{tile:f,coords:v})}},_removeTile:function(u){var f=this._tiles[u];if(f)return f.el.setAttribute("src",I),Gf.prototype._removeTile.call(this,u)},_tileReady:function(u,f,v){if(!(!this._map||v&&v.getAttribute("src")===I))return Gf.prototype._tileReady.call(this,u,f,v)}});function Q3(u,f){return new uc(u,f)}var eD=uc.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(u,f){this._url=u;var v=i({},this.defaultWmsParams);for(var w in f)w in this.options||(v[w]=f[w]);f=y(this,f);var A=f.detectRetina&&Ve.retina?2:1,W=this.getTileSize();v.width=W.x*A,v.height=W.y*A,this.wmsParams=v},onAdd:function(u){this._crs=this.options.crs||u.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var f=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[f]=this._crs.code,uc.prototype.onAdd.call(this,u)},getTileUrl:function(u){var f=this._tileCoordsToNwSe(u),v=this._crs,w=oe(v.project(f[0]),v.project(f[1])),A=w.min,W=w.max,de=(this._wmsVersion>=1.3&&this._crs===W3?[A.y,A.x,W.y,W.x]:[A.x,A.y,W.x,W.y]).join(","),ye=uc.prototype.getTileUrl.call(this,u);return ye+R(this.wmsParams,ye,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+de},setParams:function(u,f){return i(this.wmsParams,u),f||this.redraw(),this}});function EK(u,f){return new eD(u,f)}uc.WMS=eD,Q3.wms=EK;var yo=fa.extend({options:{padding:.1},initialize:function(u){y(this,u),l(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),ft(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var u={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(u.zoomanim=this._onAnimZoom),u},_onAnimZoom:function(u){this._updateTransform(u.center,u.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(u,f){var v=this._map.getZoomScale(f,this._zoom),w=this._map.getSize().multiplyBy(.5+this.options.padding),A=this._map.project(this._center,f),W=w.multiplyBy(-v).add(A).subtract(this._map._getNewPixelOrigin(u,f));Ve.any3d?Dl(this._container,W,v):Mr(this._container,W)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var u in this._layers)this._layers[u]._reset()},_onZoomEnd:function(){for(var u in this._layers)this._layers[u]._project()},_updatePaths:function(){for(var u in this._layers)this._layers[u]._update()},_update:function(){var u=this.options.padding,f=this._map.getSize(),v=this._map.containerPointToLayerPoint(f.multiplyBy(-u)).round();this._bounds=new he(v,v.add(f.multiplyBy(1+u*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),tD=yo.extend({options:{tolerance:0},getEvents:function(){var u=yo.prototype.getEvents.call(this);return u.viewprereset=this._onViewPreReset,u},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){yo.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var u=this._container=document.createElement("canvas");lt(u,"mousemove",this._onMouseMove,this),lt(u,"click dblclick mousedown mouseup contextmenu",this._onClick,this),lt(u,"mouseout",this._handleMouseOut,this),u._leaflet_disable_events=!0,this._ctx=u.getContext("2d")},_destroyContainer:function(){J(this._redrawRequest),delete this._ctx,pr(this._container),Zt(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var u;this._redrawBounds=null;for(var f in this._layers)u=this._layers[f],u._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){yo.prototype._update.call(this);var u=this._bounds,f=this._container,v=u.getSize(),w=Ve.retina?2:1;Mr(f,u.min),f.width=w*v.x,f.height=w*v.y,f.style.width=v.x+"px",f.style.height=v.y+"px",Ve.retina&&this._ctx.scale(2,2),this._ctx.translate(-u.min.x,-u.min.y),this.fire("update")}},_reset:function(){yo.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(u){this._updateDashArray(u),this._layers[l(u)]=u;var f=u._order={layer:u,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=f),this._drawLast=f,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(u){this._requestRedraw(u)},_removePath:function(u){var f=u._order,v=f.next,w=f.prev;v?v.prev=w:this._drawLast=w,w?w.next=v:this._drawFirst=v,delete u._order,delete this._layers[l(u)],this._requestRedraw(u)},_updatePath:function(u){this._extendRedrawBounds(u),u._project(),u._update(),this._requestRedraw(u)},_updateStyle:function(u){this._updateDashArray(u),this._requestRedraw(u)},_updateDashArray:function(u){if(typeof u.options.dashArray=="string"){var f=u.options.dashArray.split(/[, ]+/),v=[],w,A;for(A=0;A<f.length;A++){if(w=Number(f[A]),isNaN(w))return;v.push(w)}u.options._dashArray=v}else u.options._dashArray=u.options.dashArray},_requestRedraw:function(u){this._map&&(this._extendRedrawBounds(u),this._redrawRequest=this._redrawRequest||j(this._redraw,this))},_extendRedrawBounds:function(u){if(u._pxBounds){var f=(u.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new he,this._redrawBounds.extend(u._pxBounds.min.subtract([f,f])),this._redrawBounds.extend(u._pxBounds.max.add([f,f]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var u=this._redrawBounds;if(u){var f=u.getSize();this._ctx.clearRect(u.min.x,u.min.y,f.x,f.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var u,f=this._redrawBounds;if(this._ctx.save(),f){var v=f.getSize();this._ctx.beginPath(),this._ctx.rect(f.min.x,f.min.y,v.x,v.y),this._ctx.clip()}this._drawing=!0;for(var w=this._drawFirst;w;w=w.next)u=w.layer,(!f||u._pxBounds&&u._pxBounds.intersects(f))&&u._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(u,f){if(this._drawing){var v,w,A,W,de=u._parts,ye=de.length,Se=this._ctx;if(ye){for(Se.beginPath(),v=0;v<ye;v++){for(w=0,A=de[v].length;w<A;w++)W=de[v][w],Se[w?"lineTo":"moveTo"](W.x,W.y);f&&Se.closePath()}this._fillStroke(Se,u)}}},_updateCircle:function(u){if(!(!this._drawing||u._empty())){var f=u._point,v=this._ctx,w=Math.max(Math.round(u._radius),1),A=(Math.max(Math.round(u._radiusY),1)||w)/w;A!==1&&(v.save(),v.scale(1,A)),v.beginPath(),v.arc(f.x,f.y/A,w,0,Math.PI*2,!1),A!==1&&v.restore(),this._fillStroke(v,u)}},_fillStroke:function(u,f){var v=f.options;v.fill&&(u.globalAlpha=v.fillOpacity,u.fillStyle=v.fillColor||v.color,u.fill(v.fillRule||"evenodd")),v.stroke&&v.weight!==0&&(u.setLineDash&&u.setLineDash(f.options&&f.options._dashArray||[]),u.globalAlpha=v.opacity,u.lineWidth=v.weight,u.strokeStyle=v.color,u.lineCap=v.lineCap,u.lineJoin=v.lineJoin,u.stroke())},_onClick:function(u){for(var f=this._map.mouseEventToLayerPoint(u),v,w,A=this._drawFirst;A;A=A.next)v=A.layer,v.options.interactive&&v._containsPoint(f)&&(!(u.type==="click"||u.type==="preclick")||!this._map._draggableMoved(v))&&(w=v);this._fireEvent(w?[w]:!1,u)},_onMouseMove:function(u){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var f=this._map.mouseEventToLayerPoint(u);this._handleMouseHover(u,f)}},_handleMouseOut:function(u){var f=this._hoveredLayer;f&&(wr(this._container,"leaflet-interactive"),this._fireEvent([f],u,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(u,f){if(!this._mouseHoverThrottled){for(var v,w,A=this._drawFirst;A;A=A.next)v=A.layer,v.options.interactive&&v._containsPoint(f)&&(w=v);w!==this._hoveredLayer&&(this._handleMouseOut(u),w&&(ft(this._container,"leaflet-interactive"),this._fireEvent([w],u,"mouseover"),this._hoveredLayer=w)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,u),this._mouseHoverThrottled=!0,setTimeout(o(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(u,f,v){this._map._fireDOMEvent(f,v||f.type,u)},_bringToFront:function(u){var f=u._order;if(f){var v=f.next,w=f.prev;if(v)v.prev=w;else return;w?w.next=v:v&&(this._drawFirst=v),f.prev=this._drawLast,this._drawLast.next=f,f.next=null,this._drawLast=f,this._requestRedraw(u)}},_bringToBack:function(u){var f=u._order;if(f){var v=f.next,w=f.prev;if(w)w.next=v;else return;v?v.prev=w:w&&(this._drawLast=w),f.prev=null,f.next=this._drawFirst,this._drawFirst.prev=f,this._drawFirst=f,this._requestRedraw(u)}}});function rD(u){return Ve.canvas?new tD(u):null}var qf=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(u){return document.createElement("<lvml:"+u+' class="lvml">')}}catch{}return function(u){return document.createElement("<"+u+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),xK={_initContainer:function(){this._container=Mt("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(yo.prototype._update.call(this),this.fire("update"))},_initPath:function(u){var f=u._container=qf("shape");ft(f,"leaflet-vml-shape "+(this.options.className||"")),f.coordsize="1 1",u._path=qf("path"),f.appendChild(u._path),this._updateStyle(u),this._layers[l(u)]=u},_addPath:function(u){var f=u._container;this._container.appendChild(f),u.options.interactive&&u.addInteractiveTarget(f)},_removePath:function(u){var f=u._container;pr(f),u.removeInteractiveTarget(f),delete this._layers[l(u)]},_updateStyle:function(u){var f=u._stroke,v=u._fill,w=u.options,A=u._container;A.stroked=!!w.stroke,A.filled=!!w.fill,w.stroke?(f||(f=u._stroke=qf("stroke")),A.appendChild(f),f.weight=w.weight+"px",f.color=w.color,f.opacity=w.opacity,w.dashArray?f.dashStyle=x(w.dashArray)?w.dashArray.join(" "):w.dashArray.replace(/( *, *)/g," "):f.dashStyle="",f.endcap=w.lineCap.replace("butt","flat"),f.joinstyle=w.lineJoin):f&&(A.removeChild(f),u._stroke=null),w.fill?(v||(v=u._fill=qf("fill")),A.appendChild(v),v.color=w.fillColor||w.color,v.opacity=w.fillOpacity):v&&(A.removeChild(v),u._fill=null)},_updateCircle:function(u){var f=u._point.round(),v=Math.round(u._radius),w=Math.round(u._radiusY||v);this._setPath(u,u._empty()?"M0 0":"AL "+f.x+","+f.y+" "+v+","+w+" 0,"+65535*360)},_setPath:function(u,f){u._path.v=f},_bringToFront:function(u){nc(u._container)},_bringToBack:function(u){ic(u._container)}},Cv=Ve.vml?qf:we,Zf=yo.extend({_initContainer:function(){this._container=Cv("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=Cv("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){pr(this._container),Zt(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){yo.prototype._update.call(this);var u=this._bounds,f=u.getSize(),v=this._container;(!this._svgSize||!this._svgSize.equals(f))&&(this._svgSize=f,v.setAttribute("width",f.x),v.setAttribute("height",f.y)),Mr(v,u.min),v.setAttribute("viewBox",[u.min.x,u.min.y,f.x,f.y].join(" ")),this.fire("update")}},_initPath:function(u){var f=u._path=Cv("path");u.options.className&&ft(f,u.options.className),u.options.interactive&&ft(f,"leaflet-interactive"),this._updateStyle(u),this._layers[l(u)]=u},_addPath:function(u){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(u._path),u.addInteractiveTarget(u._path)},_removePath:function(u){pr(u._path),u.removeInteractiveTarget(u._path),delete this._layers[l(u)]},_updatePath:function(u){u._project(),u._update()},_updateStyle:function(u){var f=u._path,v=u.options;f&&(v.stroke?(f.setAttribute("stroke",v.color),f.setAttribute("stroke-opacity",v.opacity),f.setAttribute("stroke-width",v.weight),f.setAttribute("stroke-linecap",v.lineCap),f.setAttribute("stroke-linejoin",v.lineJoin),v.dashArray?f.setAttribute("stroke-dasharray",v.dashArray):f.removeAttribute("stroke-dasharray"),v.dashOffset?f.setAttribute("stroke-dashoffset",v.dashOffset):f.removeAttribute("stroke-dashoffset")):f.setAttribute("stroke","none"),v.fill?(f.setAttribute("fill",v.fillColor||v.color),f.setAttribute("fill-opacity",v.fillOpacity),f.setAttribute("fill-rule",v.fillRule||"evenodd")):f.setAttribute("fill","none"))},_updatePoly:function(u,f){this._setPath(u,Ce(u._parts,f))},_updateCircle:function(u){var f=u._point,v=Math.max(Math.round(u._radius),1),w=Math.max(Math.round(u._radiusY),1)||v,A="a"+v+","+w+" 0 1,0 ",W=u._empty()?"M0 0":"M"+(f.x-v)+","+f.y+A+v*2+",0 "+A+-v*2+",0 ";this._setPath(u,W)},_setPath:function(u,f){u._path.setAttribute("d",f)},_bringToFront:function(u){nc(u._path)},_bringToBack:function(u){ic(u._path)}});Ve.vml&&Zf.include(xK);function nD(u){return Ve.svg||Ve.vml?new Zf(u):null}xt.include({getRenderer:function(u){var f=u.options.renderer||this._getPaneRenderer(u.options.pane)||this.options.renderer||this._renderer;return f||(f=this._renderer=this._createRenderer()),this.hasLayer(f)||this.addLayer(f),f},_getPaneRenderer:function(u){if(u==="overlayPane"||u===void 0)return!1;var f=this._paneRenderers[u];return f===void 0&&(f=this._createRenderer({pane:u}),this._paneRenderers[u]=f),f},_createRenderer:function(u){return this.options.preferCanvas&&rD(u)||nD(u)}});var iD=sc.extend({initialize:function(u,f){sc.prototype.initialize.call(this,this._boundsToLatLngs(u),f)},setBounds:function(u){return this.setLatLngs(this._boundsToLatLngs(u))},_boundsToLatLngs:function(u){return u=ee(u),[u.getSouthWest(),u.getNorthWest(),u.getNorthEast(),u.getSouthEast()]}});function CK(u,f){return new iD(u,f)}Zf.create=Cv,Zf.pointsToPath=Ce,go.geometryToLayer=yv,go.coordsToLatLng=$_,go.coordsToLatLngs=bv,go.latLngToCoords=L_,go.latLngsToCoords=_v,go.getFeature=lc,go.asFeature=Sv,xt.mergeOptions({boxZoom:!0});var aD=Pa.extend({initialize:function(u){this._map=u,this._container=u._container,this._pane=u._panes.overlayPane,this._resetStateTimeout=0,u.on("unload",this._destroy,this)},addHooks:function(){lt(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){Zt(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){pr(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(u){if(!u.shiftKey||u.which!==1&&u.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),Ff(),y_(),this._startPoint=this._map.mouseEventToContainerPoint(u),lt(document,{contextmenu:Il,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(u){this._moved||(this._moved=!0,this._box=Mt("div","leaflet-zoom-box",this._container),ft(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(u);var f=new he(this._point,this._startPoint),v=f.getSize();Mr(this._box,f.min),this._box.style.width=v.x+"px",this._box.style.height=v.y+"px"},_finish:function(){this._moved&&(pr(this._box),wr(this._container,"leaflet-crosshair")),jf(),b_(),Zt(document,{contextmenu:Il,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(u){if(!(u.which!==1&&u.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(o(this._resetState,this),0);var f=new me(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(f).fire("boxzoomend",{boxZoomBounds:f})}},_onKeyDown:function(u){u.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});xt.addInitHook("addHandler","boxZoom",aD),xt.mergeOptions({doubleClickZoom:!0});var oD=Pa.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(u){var f=this._map,v=f.getZoom(),w=f.options.zoomDelta,A=u.originalEvent.shiftKey?v-w:v+w;f.options.doubleClickZoom==="center"?f.setZoom(A):f.setZoomAround(u.containerPoint,A)}});xt.addInitHook("addHandler","doubleClickZoom",oD),xt.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var sD=Pa.extend({addHooks:function(){if(!this._draggable){var u=this._map;this._draggable=new cs(u._mapPane,u._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),u.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),u.on("zoomend",this._onZoomEnd,this),u.whenReady(this._onZoomEnd,this))}ft(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){wr(this._map._container,"leaflet-grab"),wr(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var u=this._map;if(u._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var f=ee(this._map.options.maxBounds);this._offsetLimit=oe(this._map.latLngToContainerPoint(f.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(f.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;u.fire("movestart").fire("dragstart"),u.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(u){if(this._map.options.inertia){var f=this._lastTime=+new Date,v=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(v),this._times.push(f),this._prunePositions(f)}this._map.fire("move",u).fire("drag",u)},_prunePositions:function(u){for(;this._positions.length>1&&u-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var u=this._map.getSize().divideBy(2),f=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=f.subtract(u).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(u,f){return u-(u-f)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var u=this._draggable._newPos.subtract(this._draggable._startPos),f=this._offsetLimit;u.x<f.min.x&&(u.x=this._viscousLimit(u.x,f.min.x)),u.y<f.min.y&&(u.y=this._viscousLimit(u.y,f.min.y)),u.x>f.max.x&&(u.x=this._viscousLimit(u.x,f.max.x)),u.y>f.max.y&&(u.y=this._viscousLimit(u.y,f.max.y)),this._draggable._newPos=this._draggable._startPos.add(u)}},_onPreDragWrap:function(){var u=this._worldWidth,f=Math.round(u/2),v=this._initialWorldOffset,w=this._draggable._newPos.x,A=(w-f+v)%u+f-v,W=(w+f+v)%u-f-v,de=Math.abs(A+v)<Math.abs(W+v)?A:W;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=de},_onDragEnd:function(u){var f=this._map,v=f.options,w=!v.inertia||u.noInertia||this._times.length<2;if(f.fire("dragend",u),w)f.fire("moveend");else{this._prunePositions(+new Date);var A=this._lastPos.subtract(this._positions[0]),W=(this._lastTime-this._times[0])/1e3,de=v.easeLinearity,ye=A.multiplyBy(de/W),Se=ye.distanceTo([0,0]),Re=Math.min(v.inertiaMaxSpeed,Se),Fe=ye.multiplyBy(Re/Se),Ye=Re/(v.inertiaDeceleration*de),yt=Fe.multiplyBy(-Ye/2).round();!yt.x&&!yt.y?f.fire("moveend"):(yt=f._limitOffset(yt,f.options.maxBounds),j(function(){f.panBy(yt,{duration:Ye,easeLinearity:de,noMoveStart:!0,animate:!0})}))}}});xt.addInitHook("addHandler","dragging",sD),xt.mergeOptions({keyboard:!0,keyboardPanDelta:80});var lD=Pa.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(u){this._map=u,this._setPanDelta(u.options.keyboardPanDelta),this._setZoomDelta(u.options.zoomDelta)},addHooks:function(){var u=this._map._container;u.tabIndex<=0&&(u.tabIndex="0"),lt(u,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),Zt(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var u=document.body,f=document.documentElement,v=u.scrollTop||f.scrollTop,w=u.scrollLeft||f.scrollLeft;this._map._container.focus(),window.scrollTo(w,v)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(u){var f=this._panKeys={},v=this.keyCodes,w,A;for(w=0,A=v.left.length;w<A;w++)f[v.left[w]]=[-1*u,0];for(w=0,A=v.right.length;w<A;w++)f[v.right[w]]=[u,0];for(w=0,A=v.down.length;w<A;w++)f[v.down[w]]=[0,u];for(w=0,A=v.up.length;w<A;w++)f[v.up[w]]=[0,-1*u]},_setZoomDelta:function(u){var f=this._zoomKeys={},v=this.keyCodes,w,A;for(w=0,A=v.zoomIn.length;w<A;w++)f[v.zoomIn[w]]=u;for(w=0,A=v.zoomOut.length;w<A;w++)f[v.zoomOut[w]]=-u},_addHooks:function(){lt(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){Zt(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(u){if(!(u.altKey||u.ctrlKey||u.metaKey)){var f=u.keyCode,v=this._map,w;if(f in this._panKeys){if(!v._panAnim||!v._panAnim._inProgress)if(w=this._panKeys[f],u.shiftKey&&(w=ne(w).multiplyBy(3)),v.options.maxBounds&&(w=v._limitOffset(ne(w),v.options.maxBounds)),v.options.worldCopyJump){var A=v.wrapLatLng(v.unproject(v.project(v.getCenter()).add(w)));v.panTo(A)}else v.panBy(w)}else if(f in this._zoomKeys)v.setZoom(v.getZoom()+(u.shiftKey?3:1)*this._zoomKeys[f]);else if(f===27&&v._popup&&v._popup.options.closeOnEscapeKey)v.closePopup();else return;Il(u)}}});xt.addInitHook("addHandler","keyboard",lD),xt.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var uD=Pa.extend({addHooks:function(){lt(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){Zt(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(u){var f=k3(u),v=this._map.options.wheelDebounceTime;this._delta+=f,this._lastMousePos=this._map.mouseEventToContainerPoint(u),this._startTime||(this._startTime=+new Date);var w=Math.max(v-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(o(this._performZoom,this),w),Il(u)},_performZoom:function(){var u=this._map,f=u.getZoom(),v=this._map.options.zoomSnap||0;u._stop();var w=this._delta/(this._map.options.wheelPxPerZoomLevel*4),A=4*Math.log(2/(1+Math.exp(-Math.abs(w))))/Math.LN2,W=v?Math.ceil(A/v)*v:A,de=u._limitZoom(f+(this._delta>0?W:-W))-f;this._delta=0,this._startTime=null,de&&(u.options.scrollWheelZoom==="center"?u.setZoom(f+de):u.setZoomAround(this._lastMousePos,f+de))}});xt.addInitHook("addHandler","scrollWheelZoom",uD);var TK=600;xt.mergeOptions({tapHold:Ve.touchNative&&Ve.safari&&Ve.mobile,tapTolerance:15});var cD=Pa.extend({addHooks:function(){lt(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){Zt(this._map._container,"touchstart",this._onDown,this)},_onDown:function(u){if(clearTimeout(this._holdTimeout),u.touches.length===1){var f=u.touches[0];this._startPos=this._newPos=new H(f.clientX,f.clientY),this._holdTimeout=setTimeout(o(function(){this._cancel(),this._isTapValid()&&(lt(document,"touchend",cn),lt(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",f))},this),TK),lt(document,"touchend touchcancel contextmenu",this._cancel,this),lt(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function u(){Zt(document,"touchend",cn),Zt(document,"touchend touchcancel",u)},_cancel:function(){clearTimeout(this._holdTimeout),Zt(document,"touchend touchcancel contextmenu",this._cancel,this),Zt(document,"touchmove",this._onMove,this)},_onMove:function(u){var f=u.touches[0];this._newPos=new H(f.clientX,f.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(u,f){var v=new MouseEvent(u,{bubbles:!0,cancelable:!0,view:window,screenX:f.screenX,screenY:f.screenY,clientX:f.clientX,clientY:f.clientY});v._simulated=!0,f.target.dispatchEvent(v)}});xt.addInitHook("addHandler","tapHold",cD),xt.mergeOptions({touchZoom:Ve.touch,bounceAtZoomLimits:!0});var dD=Pa.extend({addHooks:function(){ft(this._map._container,"leaflet-touch-zoom"),lt(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){wr(this._map._container,"leaflet-touch-zoom"),Zt(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(u){var f=this._map;if(!(!u.touches||u.touches.length!==2||f._animatingZoom||this._zooming)){var v=f.mouseEventToContainerPoint(u.touches[0]),w=f.mouseEventToContainerPoint(u.touches[1]);this._centerPoint=f.getSize()._divideBy(2),this._startLatLng=f.containerPointToLatLng(this._centerPoint),f.options.touchZoom!=="center"&&(this._pinchStartLatLng=f.containerPointToLatLng(v.add(w)._divideBy(2))),this._startDist=v.distanceTo(w),this._startZoom=f.getZoom(),this._moved=!1,this._zooming=!0,f._stop(),lt(document,"touchmove",this._onTouchMove,this),lt(document,"touchend touchcancel",this._onTouchEnd,this),cn(u)}},_onTouchMove:function(u){if(!(!u.touches||u.touches.length!==2||!this._zooming)){var f=this._map,v=f.mouseEventToContainerPoint(u.touches[0]),w=f.mouseEventToContainerPoint(u.touches[1]),A=v.distanceTo(w)/this._startDist;if(this._zoom=f.getScaleZoom(A,this._startZoom),!f.options.bounceAtZoomLimits&&(this._zoom<f.getMinZoom()&&A<1||this._zoom>f.getMaxZoom()&&A>1)&&(this._zoom=f._limitZoom(this._zoom)),f.options.touchZoom==="center"){if(this._center=this._startLatLng,A===1)return}else{var W=v._add(w)._divideBy(2)._subtract(this._centerPoint);if(A===1&&W.x===0&&W.y===0)return;this._center=f.unproject(f.project(this._pinchStartLatLng,this._zoom).subtract(W),this._zoom)}this._moved||(f._moveStart(!0,!1),this._moved=!0),J(this._animRequest);var de=o(f._move,f,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=j(de,this,!0),cn(u)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,J(this._animRequest),Zt(document,"touchmove",this._onTouchMove,this),Zt(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});xt.addInitHook("addHandler","touchZoom",dD),xt.BoxZoom=aD,xt.DoubleClickZoom=oD,xt.Drag=sD,xt.Keyboard=lD,xt.ScrollWheelZoom=uD,xt.TapHold=cD,xt.TouchZoom=dD,r.Bounds=he,r.Browser=Ve,r.CRS=X,r.Canvas=tD,r.Circle=O_,r.CircleMarker=gv,r.Class=le,r.Control=da,r.DivIcon=X3,r.DivOverlay=Aa,r.DomEvent=Kz,r.DomUtil=Vz,r.Draggable=cs,r.Evented=te,r.FeatureGroup=mo,r.GeoJSON=go,r.GridLayer=Gf,r.Handler=Pa,r.Icon=oc,r.ImageOverlay=wv,r.LatLng=Y,r.LatLngBounds=me,r.Layer=fa,r.LayerGroup=ac,r.LineUtil=nK,r.Map=xt,r.Marker=vv,r.Mixin=Jz,r.Path=ds,r.Point=H,r.PolyUtil=Xz,r.Polygon=sc,r.Polyline=vo,r.Popup=Ev,r.PosAnimation=O3,r.Projection=iK,r.Rectangle=iD,r.Renderer=yo,r.SVG=Zf,r.SVGOverlay=J3,r.TileLayer=uc,r.Tooltip=xv,r.Transformation=ce,r.Util=$,r.VideoOverlay=Y3,r.bind=o,r.bounds=oe,r.canvas=rD,r.circle=fK,r.circleMarker=dK,r.control=Kf,r.divIcon=SK,r.extend=i,r.featureGroup=lK,r.geoJSON=Z3,r.geoJson=mK,r.gridLayer=wK,r.icon=uK,r.imageOverlay=vK,r.latLng=q,r.latLngBounds=ee,r.layerGroup=sK,r.map=Hz,r.marker=cK,r.point=ne,r.polygon=pK,r.polyline=hK,r.popup=bK,r.rectangle=CK,r.setOptions=y,r.stamp=l,r.svg=nD,r.svgOverlay=yK,r.tileLayer=Q3,r.tooltip=_K,r.transformation=ue,r.version=n,r.videoOverlay=gK;var DK=window.L;r.noConflict=function(){return window.L=DK,this},window.L=r})})(FE,FE.exports);var ub=FE.exports;const e6=Uu(ub);function t6(t,e,r){return Object.freeze({instance:t,context:e,container:r})}function r6(t,e){return e==null?function(n,i){const a=D.useRef(void 0);return a.current||(a.current=t(n,i)),a}:function(n,i){const a=D.useRef(void 0);a.current||(a.current=t(n,i));const o=D.useRef(n),{instance:s}=a.current;return D.useEffect(function(){o.current!==n&&(e(s,n,o.current),o.current=n)},[s,n,e]),a}}function n6(t,e){D.useEffect(function(){return(e.layerContainer??e.map).addLayer(t.instance),function(){var a;(a=e.layerContainer)==null||a.removeLayer(t.instance),e.map.removeLayer(t.instance)}},[e,t])}function fq(t){return function(r){const n=pT(),i=t(mT(r,n),n);return oq(n.map,r.attribution),Q$(i.current,r.eventHandlers),n6(i.current,n),i}}function hq(t,e){const r=D.useRef(void 0);D.useEffect(function(){if(e.pathOptions!==r.current){const i=e.pathOptions??{};t.instance.setStyle(i),r.current=i}},[t,e])}function pq(t){return function(r){const n=pT(),i=t(mT(r,n),n);return Q$(i.current,r.eventHandlers),n6(i.current,n),hq(i.current,r),i}}function mq(t,e){const r=r6(t,e),n=pq(r);return cq(n)}function vq(t,e){const r=r6(t,e),n=fq(r);return dq(n)}function gq(t,e,r){const{opacity:n,zIndex:i}=e;n!=null&&n!==r.opacity&&t.setOpacity(n),i!=null&&i!==r.zIndex&&t.setZIndex(i)}function i6(){return pT().map}function yq({bounds:t,boundsOptions:e,center:r,children:n,className:i,id:a,placeholder:o,style:s,whenReady:l,zoom:c,...d},h){const[p]=D.useState({className:i,id:a,style:s}),[m,g]=D.useState(null),y=D.useRef(void 0);D.useImperativeHandle(h,()=>(m==null?void 0:m.map)??null,[m]);const R=D.useCallback(_=>{if(_!==null&&!y.current){const x=new ub.Map(_,d);y.current=x,r!=null&&c!=null?x.setView(r,c):t!=null&&x.fitBounds(t,e),l!=null&&x.whenReady(l),g(lq(x))}},[]);D.useEffect(()=>()=>{m==null||m.map.remove()},[m]);const b=m?We.createElement(hT,{value:m},n):o??null;return We.createElement("div",{...p,ref:R},b)}const bq=D.forwardRef(yq),_q=mq(function({positions:e,...r},n){const i=new ub.Polyline(e,r);return t6(i,uq(n,{overlayContainer:i}))},function(e,r,n){r.positions!==n.positions&&e.setLatLngs(r.positions)}),Sq=vq(function({url:e,...r},n){const i=new ub.TileLayer(e,mT(r,n));return t6(i,n)},function(e,r,n){gq(e,r,n);const{url:i}=r;i!=null&&i!==n.url&&e.setUrl(i)}),_S=[{base:"bg-red-400",hover:"hover:bg-red-300",transparent:"bg-red-400/30",hex:"#f87171",light:"bg-red-200"},{base:"bg-orange-400",hover:"hover:bg-orange-300",transparent:"bg-orange-400/30",hex:"#fb923c",light:"bg-orange-200"},{base:"bg-amber-400",hover:"hover:bg-amber-300",transparent:"bg-amber-400/30",hex:"#fbbf24",light:"bg-amber-200"},{base:"bg-yellow-400",hover:"hover:bg-yellow-300",transparent:"bg-yellow-400/30",hex:"#facc15",light:"bg-yellow-200"},{base:"bg-lime-400",hover:"hover:bg-lime-300",transparent:"bg-lime-400/30",hex:"#a3e635",light:"bg-lime-200"},{base:"bg-green-400",hover:"hover:bg-green-300",transparent:"bg-green-400/30",hex:"#4ade80",light:"bg-green-200"},{base:"bg-emerald-400",hover:"hover:bg-emerald-300",transparent:"bg-emerald-400/30",hex:"#34d399",light:"bg-emerald-200"},{base:"bg-teal-400",hover:"hover:bg-teal-300",transparent:"bg-teal-400/30",hex:"#2dd4bf",light:"bg-teal-200"},{base:"bg-cyan-400",hover:"hover:bg-cyan-300",transparent:"bg-cyan-400/30",hex:"#22d3ee",light:"bg-cyan-200"},{base:"bg-sky-400",hover:"hover:bg-sky-300",transparent:"bg-sky-400/30",hex:"#38bdf8",light:"bg-sky-200"},{base:"bg-blue-400",hover:"hover:bg-blue-300",transparent:"bg-blue-400/30",hex:"#60a5fa",light:"bg-blue-200"},{base:"bg-indigo-400",hover:"hover:bg-indigo-300",transparent:"bg-indigo-400/30",hex:"#818cf8",light:"bg-indigo-200"},{base:"bg-violet-400",hover:"hover:bg-violet-300",transparent:"bg-violet-400/30",hex:"#a78bfa",light:"bg-violet-200"},{base:"bg-purple-400",hover:"hover:bg-purple-300",transparent:"bg-purple-400/30",hex:"#c084fc",light:"bg-purple-200"},{base:"bg-fuchsia-400",hover:"hover:bg-fuchsia-300",transparent:"bg-fuchsia-400/30",hex:"#e879f9",light:"bg-fuchsia-200"},{base:"bg-pink-400",hover:"hover:bg-pink-300",transparent:"bg-pink-400/30",hex:"#f472b6",light:"bg-pink-200"},{base:"bg-rose-400",hover:"hover:bg-rose-300",transparent:"bg-rose-400/30",hex:"#fb7185",light:"bg-rose-200"}];function ud(t,e){return t-e*Math.floor(t/e)}const a6=1721426;function tu(t,e,r,n){e=Mm(t,e);let i=e-1,a=-2;return r<=2?a=0:zs(e)&&(a=-1),a6-1+365*i+Math.floor(i/4)-Math.floor(i/100)+Math.floor(i/400)+Math.floor((367*r-362)/12+a+n)}function zs(t){return t%4===0&&(t%100!==0||t%400===0)}function Mm(t,e){return t==="BC"?1-e:e}function cb(t){let e="AD";return t<=0&&(e="BC",t=1-t),[e,t]}const wq={standard:[31,28,31,30,31,30,31,31,30,31,30,31],leapyear:[31,29,31,30,31,30,31,31,30,31,30,31]};class Nn{fromJulianDay(e){let r=e,n=r-a6,i=Math.floor(n/146097),a=ud(n,146097),o=Math.floor(a/36524),s=ud(a,36524),l=Math.floor(s/1461),c=ud(s,1461),d=Math.floor(c/365),h=i*400+o*100+l*4+d+(o!==4&&d!==4?1:0),[p,m]=cb(h),g=r-tu(p,m,1,1),y=2;r<tu(p,m,3,1)?y=0:zs(m)&&(y=1);let R=Math.floor(((g+y)*12+373)/367),b=r-tu(p,m,R,1)+1;return new Bt(p,m,R,b)}toJulianDay(e){return tu(e.era,e.year,e.month,e.day)}getDaysInMonth(e){return wq[zs(e.year)?"leapyear":"standard"][e.month-1]}getMonthsInYear(e){return 12}getDaysInYear(e){return zs(e.year)?366:365}getYearsInEra(e){return 9999}getEras(){return["BC","AD"]}isInverseEra(e){return e.era==="BC"}balanceDate(e){e.year<=0&&(e.era=e.era==="BC"?"AD":"BC",e.year=1-e.year)}constructor(){this.identifier="gregory"}}const Eq={"001":1,AD:1,AE:6,AF:6,AI:1,AL:1,AM:1,AN:1,AR:1,AT:1,AU:1,AX:1,AZ:1,BA:1,BE:1,BG:1,BH:6,BM:1,BN:1,BY:1,CH:1,CL:1,CM:1,CN:1,CR:1,CY:1,CZ:1,DE:1,DJ:6,DK:1,DZ:6,EC:1,EE:1,EG:6,ES:1,FI:1,FJ:1,FO:1,FR:1,GB:1,GE:1,GF:1,GP:1,GR:1,HR:1,HU:1,IE:1,IQ:6,IR:6,IS:1,IT:1,JO:6,KG:1,KW:6,KZ:1,LB:1,LI:1,LK:1,LT:1,LU:1,LV:1,LY:6,MC:1,MD:1,ME:1,MK:1,MN:1,MQ:1,MV:5,MY:1,NL:1,NO:1,NZ:1,OM:6,PL:1,QA:6,RE:1,RO:1,RS:1,RU:1,SD:6,SE:1,SI:1,SK:1,SM:1,SY:6,TJ:1,TM:1,TR:1,UA:1,UY:1,UZ:1,VA:1,VN:1,XK:1};function $r(t,e){return e=lr(e,t.calendar),t.era===e.era&&t.year===e.year&&t.month===e.month&&t.day===e.day}function FR(t,e){return e=lr(e,t.calendar),t=Tu(t),e=Tu(e),t.era===e.era&&t.year===e.year&&t.month===e.month}function jE(t,e){return t.calendar.identifier===e.calendar.identifier&&t.era===e.era&&t.year===e.year&&t.month===e.month&&t.day===e.day}function o6(t,e){return $r(t,fb(e))}const xq={sun:0,mon:1,tue:2,wed:3,thu:4,fri:5,sat:6};function db(t,e,r){let n=t.calendar.toJulianDay(t),i=r?xq[r]:Mq(e),a=Math.ceil(n+1-i)%7;return a<0&&(a+=7),a}function s6(t){return No(Date.now(),t)}function fb(t){return Qn(s6(t))}function l6(t,e){return t.calendar.toJulianDay(t)-e.calendar.toJulianDay(e)}function u6(t,e){return jR(t)-jR(e)}function jR(t){return t.hour*36e5+t.minute*6e4+t.second*1e3+t.millisecond}let SS=null;function hb(){return SS==null&&(SS=new Intl.DateTimeFormat().resolvedOptions().timeZone),SS}function Tu(t){return t.subtract({days:t.day-1})}function Vy(t){return t.add({days:t.calendar.getDaysInMonth(t)-t.day})}function zy(t){return Tu(t.subtract({months:t.month-1}))}function Cq(t){return t.calendar.getMinimumMonthInYear?t.calendar.getMinimumMonthInYear(t):1}function Tq(t){return t.calendar.getMinimumDayInMonth?t.calendar.getMinimumDayInMonth(t):1}function Pp(t,e,r){let n=db(t,e,r);return t.subtract({days:n})}function Dq(t,e,r){return Pp(t,e,r).add({days:6})}const VR=new Map;function Rq(t){if(Intl.Locale){let r=VR.get(t);return r||(r=new Intl.Locale(t).maximize().region,r&&VR.set(t,r)),r}let e=t.split("-")[1];return e==="u"?void 0:e}function Mq(t){let e=Rq(t);return e&&Eq[e]||0}function Iq(t,e,r){let n=t.calendar.getDaysInMonth(t);return Math.ceil((db(Tu(t),e,r)+n)/7)}function vT(t,e){return t&&e?t.compare(e)<=0?t:e:t||e}function gT(t,e){return t&&e?t.compare(e)>=0?t:e:t||e}function jd(t){t=lr(t,new Nn);let e=Mm(t.era,t.year);return c6(e,t.month,t.day,t.hour,t.minute,t.second,t.millisecond)}function c6(t,e,r,n,i,a,o){let s=new Date;return s.setUTCHours(n,i,a,o),s.setUTCFullYear(t,e-1,r),s.getTime()}function VE(t,e){if(e==="UTC")return 0;if(t>0&&e===hb())return new Date(t).getTimezoneOffset()*-6e4;let{year:r,month:n,day:i,hour:a,minute:o,second:s}=d6(t,e);return c6(r,n,i,a,o,s,0)-Math.floor(t/1e3)*1e3}const zR=new Map;function d6(t,e){let r=zR.get(e);r||(r=new Intl.DateTimeFormat("en-US",{timeZone:e,hour12:!1,era:"short",year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric"}),zR.set(e,r));let n=r.formatToParts(new Date(t)),i={};for(let a of n)a.type!=="literal"&&(i[a.type]=a.value);return{year:i.era==="BC"||i.era==="B"?-i.year+1:+i.year,month:+i.month,day:+i.day,hour:i.hour==="24"?0:+i.hour,minute:+i.minute,second:+i.second}}const KR=864e5;function Pq(t,e,r,n){return(r===n?[r]:[r,n]).filter(a=>Aq(t,e,a))}function Aq(t,e,r){let n=d6(r,e);return t.year===n.year&&t.month===n.month&&t.day===n.day&&t.hour===n.hour&&t.minute===n.minute&&t.second===n.second}function Mo(t,e,r="compatible"){let n=no(t);if(e==="UTC")return jd(n);if(e===hb()&&r==="compatible"){n=lr(n,new Nn);let l=new Date,c=Mm(n.era,n.year);return l.setFullYear(c,n.month-1,n.day),l.setHours(n.hour,n.minute,n.second,n.millisecond),l.getTime()}let i=jd(n),a=VE(i-KR,e),o=VE(i+KR,e),s=Pq(n,e,i-a,i-o);if(s.length===1)return s[0];if(s.length>1)switch(r){case"compatible":case"earlier":return s[0];case"later":return s[s.length-1];case"reject":throw new RangeError("Multiple possible absolute times found")}switch(r){case"earlier":return Math.min(i-a,i-o);case"compatible":case"later":return Math.max(i-a,i-o);case"reject":throw new RangeError("No such absolute time found")}}function f6(t,e,r="compatible"){return new Date(Mo(t,e,r))}function No(t,e){let r=VE(t,e),n=new Date(t+r),i=n.getUTCFullYear(),a=n.getUTCMonth()+1,o=n.getUTCDate(),s=n.getUTCHours(),l=n.getUTCMinutes(),c=n.getUTCSeconds(),d=n.getUTCMilliseconds();return new kp(i<1?"BC":"AD",i<1?-i+1:i,a,o,e,r,s,l,c,d)}function Qn(t){return new Bt(t.calendar,t.era,t.year,t.month,t.day)}function no(t,e){let r=0,n=0,i=0,a=0;if("timeZone"in t)({hour:r,minute:n,second:i,millisecond:a}=t);else if("hour"in t&&!e)return t;return e&&({hour:r,minute:n,second:i,millisecond:a}=e),new Ky(t.calendar,t.era,t.year,t.month,t.day,r,n,i,a)}function HR(t){return new Pm(t.hour,t.minute,t.second,t.millisecond)}function lr(t,e){if(t.calendar.identifier===e.identifier)return t;let r=e.fromJulianDay(t.calendar.toJulianDay(t)),n=t.copy();return n.calendar=e,n.era=r.era,n.year=r.year,n.month=r.month,n.day=r.day,Du(n),n}function h6(t,e,r){if(t instanceof kp)return t.timeZone===e?t:Oq(t,e);let n=Mo(t,e,r);return No(n,e)}function kq(t){let e=jd(t)-t.offset;return new Date(e)}function Oq(t,e){let r=jd(t)-t.offset;return lr(No(r,e),t.calendar)}const ih=36e5;function pb(t,e){let r=t.copy(),n="hour"in r?g6(r,e):0;zE(r,e.years||0),r.calendar.balanceYearMonth&&r.calendar.balanceYearMonth(r,t),r.month+=e.months||0,KE(r),p6(r),r.day+=(e.weeks||0)*7,r.day+=e.days||0,r.day+=n,$q(r),r.calendar.balanceDate&&r.calendar.balanceDate(r),r.year<1&&(r.year=1,r.month=1,r.day=1);let i=r.calendar.getYearsInEra(r);if(r.year>i){var a,o;let l=(a=(o=r.calendar).isInverseEra)===null||a===void 0?void 0:a.call(o,r);r.year=i,r.month=l?1:r.calendar.getMonthsInYear(r),r.day=l?1:r.calendar.getDaysInMonth(r)}r.month<1&&(r.month=1,r.day=1);let s=r.calendar.getMonthsInYear(r);return r.month>s&&(r.month=s,r.day=r.calendar.getDaysInMonth(r)),r.day=Math.max(1,Math.min(r.calendar.getDaysInMonth(r),r.day)),r}function zE(t,e){var r,n;!((r=(n=t.calendar).isInverseEra)===null||r===void 0)&&r.call(n,t)&&(e=-e),t.year+=e}function KE(t){for(;t.month<1;)zE(t,-1),t.month+=t.calendar.getMonthsInYear(t);let e=0;for(;t.month>(e=t.calendar.getMonthsInYear(t));)t.month-=e,zE(t,1)}function $q(t){for(;t.day<1;)t.month--,KE(t),t.day+=t.calendar.getDaysInMonth(t);for(;t.day>t.calendar.getDaysInMonth(t);)t.day-=t.calendar.getDaysInMonth(t),t.month++,KE(t)}function p6(t){t.month=Math.max(1,Math.min(t.calendar.getMonthsInYear(t),t.month)),t.day=Math.max(1,Math.min(t.calendar.getDaysInMonth(t),t.day))}function Du(t){t.calendar.constrainDate&&t.calendar.constrainDate(t),t.year=Math.max(1,Math.min(t.calendar.getYearsInEra(t),t.year)),p6(t)}function yT(t){let e={};for(let r in t)typeof t[r]=="number"&&(e[r]=-t[r]);return e}function m6(t,e){return pb(t,yT(e))}function bT(t,e){let r=t.copy();return e.era!=null&&(r.era=e.era),e.year!=null&&(r.year=e.year),e.month!=null&&(r.month=e.month),e.day!=null&&(r.day=e.day),Du(r),r}function Ap(t,e){let r=t.copy();return e.hour!=null&&(r.hour=e.hour),e.minute!=null&&(r.minute=e.minute),e.second!=null&&(r.second=e.second),e.millisecond!=null&&(r.millisecond=e.millisecond),v6(r),r}function Lq(t){t.second+=Math.floor(t.millisecond/1e3),t.millisecond=Vv(t.millisecond,1e3),t.minute+=Math.floor(t.second/60),t.second=Vv(t.second,60),t.hour+=Math.floor(t.minute/60),t.minute=Vv(t.minute,60);let e=Math.floor(t.hour/24);return t.hour=Vv(t.hour,24),e}function v6(t){t.millisecond=Math.max(0,Math.min(t.millisecond,1e3)),t.second=Math.max(0,Math.min(t.second,59)),t.minute=Math.max(0,Math.min(t.minute,59)),t.hour=Math.max(0,Math.min(t.hour,23))}function Vv(t,e){let r=t%e;return r<0&&(r+=e),r}function g6(t,e){return t.hour+=e.hours||0,t.minute+=e.minutes||0,t.second+=e.seconds||0,t.millisecond+=e.milliseconds||0,Lq(t)}function y6(t,e){let r=t.copy();return g6(r,e),r}function Bq(t,e){return y6(t,yT(e))}function _T(t,e,r,n){let i=t.copy();switch(e){case"era":{let s=t.calendar.getEras(),l=s.indexOf(t.era);if(l<0)throw new Error("Invalid era: "+t.era);l=Uo(l,r,0,s.length-1,n==null?void 0:n.round),i.era=s[l],Du(i);break}case"year":var a,o;!((a=(o=i.calendar).isInverseEra)===null||a===void 0)&&a.call(o,i)&&(r=-r),i.year=Uo(t.year,r,-1/0,9999,n==null?void 0:n.round),i.year===-1/0&&(i.year=1),i.calendar.balanceYearMonth&&i.calendar.balanceYearMonth(i,t);break;case"month":i.month=Uo(t.month,r,1,t.calendar.getMonthsInYear(t),n==null?void 0:n.round);break;case"day":i.day=Uo(t.day,r,1,t.calendar.getDaysInMonth(t),n==null?void 0:n.round);break;default:throw new Error("Unsupported field "+e)}return t.calendar.balanceDate&&t.calendar.balanceDate(i),Du(i),i}function ST(t,e,r,n){let i=t.copy();switch(e){case"hour":{let a=t.hour,o=0,s=23;if((n==null?void 0:n.hourCycle)===12){let l=a>=12;o=l?12:0,s=l?23:11}i.hour=Uo(a,r,o,s,n==null?void 0:n.round);break}case"minute":i.minute=Uo(t.minute,r,0,59,n==null?void 0:n.round);break;case"second":i.second=Uo(t.second,r,0,59,n==null?void 0:n.round);break;case"millisecond":i.millisecond=Uo(t.millisecond,r,0,999,n==null?void 0:n.round);break;default:throw new Error("Unsupported field "+e)}return i}function Uo(t,e,r,n,i=!1){if(i){t+=Math.sign(e),t<r&&(t=n);let a=Math.abs(e);e>0?t=Math.ceil(t/a)*a:t=Math.floor(t/a)*a,t>n&&(t=r)}else t+=e,t<r?t=n-(r-t-1):t>n&&(t=r+(t-n-1));return t}function b6(t,e){let r;if(e.years!=null&&e.years!==0||e.months!=null&&e.months!==0||e.weeks!=null&&e.weeks!==0||e.days!=null&&e.days!==0){let i=pb(no(t),{years:e.years,months:e.months,weeks:e.weeks,days:e.days});r=Mo(i,t.timeZone)}else r=jd(t)-t.offset;r+=e.milliseconds||0,r+=(e.seconds||0)*1e3,r+=(e.minutes||0)*6e4,r+=(e.hours||0)*36e5;let n=No(r,t.timeZone);return lr(n,t.calendar)}function Nq(t,e){return b6(t,yT(e))}function Uq(t,e,r,n){switch(e){case"hour":{let i=0,a=23;if((n==null?void 0:n.hourCycle)===12){let g=t.hour>=12;i=g?12:0,a=g?23:11}let o=no(t),s=lr(Ap(o,{hour:i}),new Nn),l=[Mo(s,t.timeZone,"earlier"),Mo(s,t.timeZone,"later")].filter(g=>No(g,t.timeZone).day===s.day)[0],c=lr(Ap(o,{hour:a}),new Nn),d=[Mo(c,t.timeZone,"earlier"),Mo(c,t.timeZone,"later")].filter(g=>No(g,t.timeZone).day===c.day).pop(),h=jd(t)-t.offset,p=Math.floor(h/ih),m=h%ih;return h=Uo(p,r,Math.floor(l/ih),Math.floor(d/ih),n==null?void 0:n.round)*ih+m,lr(No(h,t.timeZone),t.calendar)}case"minute":case"second":case"millisecond":return ST(t,e,r,n);case"era":case"year":case"month":case"day":{let i=_T(no(t),e,r,n),a=Mo(i,t.timeZone);return lr(No(a,t.timeZone),t.calendar)}default:throw new Error("Unsupported field "+e)}}function Fq(t,e,r){let n=no(t),i=Ap(bT(n,e),e);if(i.compare(n)===0)return t;let a=Mo(i,t.timeZone,r);return lr(No(a,t.timeZone),t.calendar)}function _6(t){return`${String(t.hour).padStart(2,"0")}:${String(t.minute).padStart(2,"0")}:${String(t.second).padStart(2,"0")}${t.millisecond?String(t.millisecond/1e3).slice(1):""}`}function S6(t){let e=lr(t,new Nn),r;return e.era==="BC"?r=e.year===1?"0000":"-"+String(Math.abs(1-e.year)).padStart(6,"00"):r=String(e.year).padStart(4,"0"),`${r}-${String(e.month).padStart(2,"0")}-${String(e.day).padStart(2,"0")}`}function w6(t){return`${S6(t)}T${_6(t)}`}function jq(t){let e=Math.sign(t)<0?"-":"+";t=Math.abs(t);let r=Math.floor(t/36e5),n=t%36e5/6e4;return`${e}${String(r).padStart(2,"0")}:${String(n).padStart(2,"0")}`}function Vq(t){return`${w6(t)}${jq(t.offset)}[${t.timeZone}]`}function zq(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Im(t,e,r){zq(t,e),e.set(t,r)}function wT(t){let e=typeof t[0]=="object"?t.shift():new Nn,r;if(typeof t[0]=="string")r=t.shift();else{let o=e.getEras();r=o[o.length-1]}let n=t.shift(),i=t.shift(),a=t.shift();return[e,r,n,i,a]}var Kq=new WeakMap;class Bt{copy(){return this.era?new Bt(this.calendar,this.era,this.year,this.month,this.day):new Bt(this.calendar,this.year,this.month,this.day)}add(e){return pb(this,e)}subtract(e){return m6(this,e)}set(e){return bT(this,e)}cycle(e,r,n){return _T(this,e,r,n)}toDate(e){return f6(this,e)}toString(){return S6(this)}compare(e){return l6(this,e)}constructor(...e){Im(this,Kq,{writable:!0,value:void 0});let[r,n,i,a,o]=wT(e);this.calendar=r,this.era=n,this.year=i,this.month=a,this.day=o,Du(this)}}var Hq=new WeakMap;class Pm{copy(){return new Pm(this.hour,this.minute,this.second,this.millisecond)}add(e){return y6(this,e)}subtract(e){return Bq(this,e)}set(e){return Ap(this,e)}cycle(e,r,n){return ST(this,e,r,n)}toString(){return _6(this)}compare(e){return u6(this,e)}constructor(e=0,r=0,n=0,i=0){Im(this,Hq,{writable:!0,value:void 0}),this.hour=e,this.minute=r,this.second=n,this.millisecond=i,v6(this)}}var Wq=new WeakMap;class Ky{copy(){return this.era?new Ky(this.calendar,this.era,this.year,this.month,this.day,this.hour,this.minute,this.second,this.millisecond):new Ky(this.calendar,this.year,this.month,this.day,this.hour,this.minute,this.second,this.millisecond)}add(e){return pb(this,e)}subtract(e){return m6(this,e)}set(e){return bT(Ap(this,e),e)}cycle(e,r,n){switch(e){case"era":case"year":case"month":case"day":return _T(this,e,r,n);default:return ST(this,e,r,n)}}toDate(e,r){return f6(this,e,r)}toString(){return w6(this)}compare(e){let r=l6(this,e);return r===0?u6(this,no(e)):r}constructor(...e){Im(this,Wq,{writable:!0,value:void 0});let[r,n,i,a,o]=wT(e);this.calendar=r,this.era=n,this.year=i,this.month=a,this.day=o,this.hour=e.shift()||0,this.minute=e.shift()||0,this.second=e.shift()||0,this.millisecond=e.shift()||0,Du(this)}}var Gq=new WeakMap;class kp{copy(){return this.era?new kp(this.calendar,this.era,this.year,this.month,this.day,this.timeZone,this.offset,this.hour,this.minute,this.second,this.millisecond):new kp(this.calendar,this.year,this.month,this.day,this.timeZone,this.offset,this.hour,this.minute,this.second,this.millisecond)}add(e){return b6(this,e)}subtract(e){return Nq(this,e)}set(e,r){return Fq(this,e,r)}cycle(e,r,n){return Uq(this,e,r,n)}toDate(){return kq(this)}toString(){return Vq(this)}toAbsoluteString(){return this.toDate().toISOString()}compare(e){return this.toDate().getTime()-h6(e,this.timeZone).toDate().getTime()}constructor(...e){Im(this,Gq,{writable:!0,value:void 0});let[r,n,i,a,o]=wT(e),s=e.shift(),l=e.shift();this.calendar=r,this.era=n,this.year=i,this.month=a,this.day=o,this.timeZone=s,this.offset=l,this.hour=e.shift()||0,this.minute=e.shift()||0,this.second=e.shift()||0,this.millisecond=e.shift()||0,Du(this)}}const cd=[[1868,9,8],[1912,7,30],[1926,12,25],[1989,1,8],[2019,5,1]],qq=[[1912,7,29],[1926,12,24],[1989,1,7],[2019,4,30]],Bg=[1867,1911,1925,1988,2018],Ps=["meiji","taisho","showa","heisei","reiwa"];function WR(t){const e=cd.findIndex(([r,n,i])=>t.year<r||t.year===r&&t.month<n||t.year===r&&t.month===n&&t.day<i);return e===-1?cd.length-1:e===0?0:e-1}function wS(t){let e=Bg[Ps.indexOf(t.era)];if(!e)throw new Error("Unknown era: "+t.era);return new Bt(t.year+e,t.month,t.day)}class Zq extends Nn{fromJulianDay(e){let r=super.fromJulianDay(e),n=WR(r);return new Bt(this,Ps[n],r.year-Bg[n],r.month,r.day)}toJulianDay(e){return super.toJulianDay(wS(e))}balanceDate(e){let r=wS(e),n=WR(r);Ps[n]!==e.era&&(e.era=Ps[n],e.year=r.year-Bg[n]),this.constrainDate(e)}constrainDate(e){let r=Ps.indexOf(e.era),n=qq[r];if(n!=null){let[i,a,o]=n,s=i-Bg[r];e.year=Math.max(1,Math.min(s,e.year)),e.year===s&&(e.month=Math.min(a,e.month),e.month===a&&(e.day=Math.min(o,e.day)))}if(e.year===1&&r>=0){let[,i,a]=cd[r];e.month=Math.max(i,e.month),e.month===i&&(e.day=Math.max(a,e.day))}}getEras(){return Ps}getYearsInEra(e){let r=Ps.indexOf(e.era),n=cd[r],i=cd[r+1];if(i==null)return 9999-n[0]+1;let a=i[0]-n[0];return(e.month<i[1]||e.month===i[1]&&e.day<i[2])&&a++,a}getDaysInMonth(e){return super.getDaysInMonth(wS(e))}getMinimumMonthInYear(e){let r=GR(e);return r?r[1]:1}getMinimumDayInMonth(e){let r=GR(e);return r&&e.month===r[1]?r[2]:1}constructor(...e){super(...e),this.identifier="japanese"}}function GR(t){if(t.year===1){let e=Ps.indexOf(t.era);return cd[e]}}const E6=-543;class Yq extends Nn{fromJulianDay(e){let r=super.fromJulianDay(e),n=Mm(r.era,r.year);return new Bt(this,n-E6,r.month,r.day)}toJulianDay(e){return super.toJulianDay(qR(e))}getEras(){return["BE"]}getDaysInMonth(e){return super.getDaysInMonth(qR(e))}balanceDate(){}constructor(...e){super(...e),this.identifier="buddhist"}}function qR(t){let[e,r]=cb(t.year+E6);return new Bt(e,r,t.month,t.day)}const Hy=1911;function x6(t){return t.era==="minguo"?t.year+Hy:1-t.year+Hy}function ZR(t){let e=t-Hy;return e>0?["minguo",e]:["before_minguo",1-e]}class Jq extends Nn{fromJulianDay(e){let r=super.fromJulianDay(e),n=Mm(r.era,r.year),[i,a]=ZR(n);return new Bt(this,i,a,r.month,r.day)}toJulianDay(e){return super.toJulianDay(YR(e))}getEras(){return["before_minguo","minguo"]}balanceDate(e){let[r,n]=ZR(x6(e));e.era=r,e.year=n}isInverseEra(e){return e.era==="before_minguo"}getDaysInMonth(e){return super.getDaysInMonth(YR(e))}getYearsInEra(e){return e.era==="before_minguo"?9999:9999-Hy}constructor(...e){super(...e),this.identifier="roc"}}function YR(t){let[e,r]=cb(x6(t));return new Bt(e,r,t.month,t.day)}const JR=1948320,XR=[0,31,62,93,124,155,186,216,246,276,306,336];class Xq{fromJulianDay(e){let r=e-JR,n=1+Math.floor((33*r+3)/12053),i=365*(n-1)+Math.floor((8*n+21)/33),a=r-i,o=a<216?Math.floor(a/31):Math.floor((a-6)/30),s=a-XR[o]+1;return new Bt(this,n,o+1,s)}toJulianDay(e){let r=JR-1+365*(e.year-1)+Math.floor((8*e.year+21)/33);return r+=XR[e.month-1],r+=e.day,r}getMonthsInYear(){return 12}getDaysInMonth(e){return e.month<=6?31:e.month<=11||ud(25*e.year+11,33)<8?30:29}getEras(){return["AP"]}getYearsInEra(){return 9377}constructor(){this.identifier="persian"}}const ES=78,QR=80;class Qq extends Nn{fromJulianDay(e){let r=super.fromJulianDay(e),n=r.year-ES,i=e-tu(r.era,r.year,1,1),a;i<QR?(n--,a=zs(r.year-1)?31:30,i+=a+155+90+10):(a=zs(r.year)?31:30,i-=QR);let o,s;if(i<a)o=1,s=i+1;else{let l=i-a;l<155?(o=Math.floor(l/31)+2,s=l%31+1):(l-=155,o=Math.floor(l/30)+7,s=l%30+1)}return new Bt(this,n,o,s)}toJulianDay(e){let r=e.year+ES,[n,i]=cb(r),a,o;return zs(i)?(a=31,o=tu(n,i,3,21)):(a=30,o=tu(n,i,3,22)),e.month===1?o+e.day-1:(o+=a+Math.min(e.month-2,5)*31,e.month>=8&&(o+=(e.month-7)*30),o+=e.day-1,o)}getDaysInMonth(e){return e.month===1&&zs(e.year+ES)||e.month>=2&&e.month<=6?31:30}getYearsInEra(){return 9919}getEras(){return["saka"]}balanceDate(){}constructor(...e){super(...e),this.identifier="indian"}}const Wy=1948440,eM=1948439,Ki=1300,hc=1600,eZ=460322;function Gy(t,e,r,n){return n+Math.ceil(29.5*(r-1))+(e-1)*354+Math.floor((3+11*e)/30)+t-1}function C6(t,e,r){let n=Math.floor((30*(r-e)+10646)/10631),i=Math.min(12,Math.ceil((r-(29+Gy(e,n,1,1)))/29.5)+1),a=r-Gy(e,n,i,1)+1;return new Bt(t,n,i,a)}function tM(t){return(14+11*t)%30<11}class ET{fromJulianDay(e){return C6(this,Wy,e)}toJulianDay(e){return Gy(Wy,e.year,e.month,e.day)}getDaysInMonth(e){let r=29+e.month%2;return e.month===12&&tM(e.year)&&r++,r}getMonthsInYear(){return 12}getDaysInYear(e){return tM(e.year)?355:354}getYearsInEra(){return 9665}getEras(){return["AH"]}constructor(){this.identifier="islamic-civil"}}class tZ extends ET{fromJulianDay(e){return C6(this,eM,e)}toJulianDay(e){return Gy(eM,e.year,e.month,e.day)}constructor(...e){super(...e),this.identifier="islamic-tbla"}}const rZ="qgpUDckO1AbqBmwDrQpVBakGkgepC9QF2gpcBS0NlQZKB1QLagutBa4ETwoXBYsGpQbVCtYCWwmdBE0KJg2VDawFtgm6AlsKKwWVCsoG6Qr0AnYJtgJWCcoKpAvSC9kF3AJtCU0FpQpSC6ULtAW2CVcFlwJLBaMGUgdlC2oFqworBZUMSg2lDcoF1gpXCasESwmlClILagt1BXYCtwhbBFUFqQW0BdoJ3QRuAjYJqgpUDbIN1QXaAlsJqwRVCkkLZAtxC7QFtQpVCiUNkg7JDtQG6QprCasEkwpJDaQNsg25CroEWworBZUKKgtVC1wFvQQ9Ah0JlQpKC1oLbQW2AjsJmwRVBqkGVAdqC2wFrQpVBSkLkgupC9QF2gpaBasKlQVJB2QHqgu1BbYCVgpNDiULUgtqC60FrgIvCZcESwalBqwG1gpdBZ0ETQoWDZUNqgW1BdoCWwmtBJUFygbkBuoK9QS2AlYJqgpUC9IL2QXqAm0JrQSVCkoLpQuyBbUJ1gSXCkcFkwZJB1ULagVrCisFiwpGDaMNygXWCtsEawJLCaUKUgtpC3UFdgG3CFsCKwVlBbQF2gntBG0BtgimClINqQ3UBdoKWwmrBFMGKQdiB6kLsgW1ClUFJQuSDckO0gbpCmsFqwRVCikNVA2qDbUJugQ7CpsETQqqCtUK2gJdCV4ELgqaDFUNsga5BroEXQotBZUKUguoC7QLuQXaAloJSgukDdEO6AZqC20FNQWVBkoNqA3UDdoGWwWdAisGFQtKC5ULqgWuCi4JjwwnBZUGqgbWCl0FnQI=";let HE,dd;function Ng(t){return eZ+dd[t-Ki]}function Rh(t,e){let r=t-Ki,n=1<<11-(e-1);return HE[r]&n?30:29}function rM(t,e){let r=Ng(t);for(let n=1;n<e;n++)r+=Rh(t,n);return r}function nM(t){return dd[t+1-Ki]-dd[t-Ki]}class nZ extends ET{fromJulianDay(e){let r=e-Wy,n=Ng(Ki),i=Ng(hc);if(r<n||r>i)return super.fromJulianDay(e);{let a=Ki-1,o=1,s=1;for(;s>0;){a++,s=r-Ng(a)+1;let l=nM(a);if(s===l){o=12;break}else if(s<l){let c=Rh(a,o);for(o=1;s>c;)s-=c,o++,c=Rh(a,o);break}}return new Bt(this,a,o,r-rM(a,o)+1)}}toJulianDay(e){return e.year<Ki||e.year>hc?super.toJulianDay(e):Wy+rM(e.year,e.month)+(e.day-1)}getDaysInMonth(e){return e.year<Ki||e.year>hc?super.getDaysInMonth(e):Rh(e.year,e.month)}getDaysInYear(e){return e.year<Ki||e.year>hc?super.getDaysInYear(e):nM(e.year)}constructor(){if(super(),this.identifier="islamic-umalqura",HE||(HE=new Uint16Array(Uint8Array.from(atob(rZ),e=>e.charCodeAt(0)).buffer)),!dd){dd=new Uint32Array(hc-Ki+1);let e=0;for(let r=Ki;r<=hc;r++){dd[r-Ki]=e;for(let n=1;n<=12;n++)e+=Rh(r,n)}}}}const iM=347997,T6=1080,D6=24*T6,iZ=29,aZ=12*T6+793,oZ=iZ*D6+aZ;function Jl(t){return ud(t*7+1,19)<7}function Ug(t){let e=Math.floor((235*t-234)/19),r=12084+13753*e,n=e*29+Math.floor(r/25920);return ud(3*(n+1),7)<3&&(n+=1),n}function sZ(t){let e=Ug(t-1),r=Ug(t);return Ug(t+1)-r===356?2:r-e===382?1:0}function rp(t){return Ug(t)+sZ(t)}function R6(t){return rp(t+1)-rp(t)}function lZ(t){let e=R6(t);switch(e>380&&(e-=30),e){case 353:return 0;case 354:return 1;case 355:return 2}}function zv(t,e){if(e>=6&&!Jl(t)&&e++,e===4||e===7||e===9||e===11||e===13)return 29;let r=lZ(t);return e===2?r===2?30:29:e===3?r===0?29:30:e===6?Jl(t)?30:0:30}class uZ{fromJulianDay(e){let r=e-iM,n=r*D6/oZ,i=Math.floor((19*n+234)/235)+1,a=rp(i),o=Math.floor(r-a);for(;o<1;)i--,a=rp(i),o=Math.floor(r-a);let s=1,l=0;for(;l<o;)l+=zv(i,s),s++;s--,l-=zv(i,s);let c=o-l;return new Bt(this,i,s,c)}toJulianDay(e){let r=rp(e.year);for(let n=1;n<e.month;n++)r+=zv(e.year,n);return r+e.day+iM}getDaysInMonth(e){return zv(e.year,e.month)}getMonthsInYear(e){return Jl(e.year)?13:12}getDaysInYear(e){return R6(e.year)}getYearsInEra(){return 9999}getEras(){return["AM"]}balanceYearMonth(e,r){r.year!==e.year&&(Jl(r.year)&&!Jl(e.year)&&r.month>6?e.month--:!Jl(r.year)&&Jl(e.year)&&r.month>6&&e.month++)}constructor(){this.identifier="hebrew"}}const WE=1723856,aM=1824665,GE=5500;function qy(t,e,r,n){return t+365*e+Math.floor(e/4)+30*(r-1)+n-1}function xT(t,e){let r=Math.floor(4*(e-t)/1461),n=1+Math.floor((e-qy(t,r,1,1))/30),i=e+1-qy(t,r,n,1);return[r,n,i]}function M6(t){return Math.floor(t%4/3)}function I6(t,e){return e%13!==0?30:M6(t)+5}class CT{fromJulianDay(e){let[r,n,i]=xT(WE,e),a="AM";return r<=0&&(a="AA",r+=GE),new Bt(this,a,r,n,i)}toJulianDay(e){let r=e.year;return e.era==="AA"&&(r-=GE),qy(WE,r,e.month,e.day)}getDaysInMonth(e){return I6(e.year,e.month)}getMonthsInYear(){return 13}getDaysInYear(e){return 365+M6(e.year)}getYearsInEra(e){return e.era==="AA"?9999:9991}getEras(){return["AA","AM"]}constructor(){this.identifier="ethiopic"}}class cZ extends CT{fromJulianDay(e){let[r,n,i]=xT(WE,e);return r+=GE,new Bt(this,"AA",r,n,i)}getEras(){return["AA"]}getYearsInEra(){return 9999}constructor(...e){super(...e),this.identifier="ethioaa"}}class dZ extends CT{fromJulianDay(e){let[r,n,i]=xT(aM,e),a="CE";return r<=0&&(a="BCE",r=1-r),new Bt(this,a,r,n,i)}toJulianDay(e){let r=e.year;return e.era==="BCE"&&(r=1-r),qy(aM,r,e.month,e.day)}getDaysInMonth(e){let r=e.year;return e.era==="BCE"&&(r=1-r),I6(r,e.month)}isInverseEra(e){return e.era==="BCE"}balanceDate(e){e.year<=0&&(e.era=e.era==="BCE"?"CE":"BCE",e.year=1-e.year)}getEras(){return["BCE","CE"]}getYearsInEra(e){return e.era==="BCE"?9999:9715}constructor(...e){super(...e),this.identifier="coptic"}}function TT(t){switch(t){case"buddhist":return new Yq;case"ethiopic":return new CT;case"ethioaa":return new cZ;case"coptic":return new dZ;case"hebrew":return new uZ;case"indian":return new Qq;case"islamic-civil":return new ET;case"islamic-tbla":return new tZ;case"islamic-umalqura":return new nZ;case"japanese":return new Zq;case"persian":return new Xq;case"roc":return new Jq;case"gregory":default:return new Nn}}let xS=new Map;class ba{format(e){return this.formatter.format(e)}formatToParts(e){return this.formatter.formatToParts(e)}formatRange(e,r){if(typeof this.formatter.formatRange=="function")return this.formatter.formatRange(e,r);if(r<e)throw new RangeError("End date must be >= start date");return`${this.formatter.format(e)}  ${this.formatter.format(r)}`}formatRangeToParts(e,r){if(typeof this.formatter.formatRangeToParts=="function")return this.formatter.formatRangeToParts(e,r);if(r<e)throw new RangeError("End date must be >= start date");let n=this.formatter.formatToParts(e),i=this.formatter.formatToParts(r);return[...n.map(a=>({...a,source:"startRange"})),{type:"literal",value:"  ",source:"shared"},...i.map(a=>({...a,source:"endRange"}))]}resolvedOptions(){let e=this.formatter.resolvedOptions();return pZ()&&(this.resolvedHourCycle||(this.resolvedHourCycle=mZ(e.locale,this.options)),e.hourCycle=this.resolvedHourCycle,e.hour12=this.resolvedHourCycle==="h11"||this.resolvedHourCycle==="h12"),e.calendar==="ethiopic-amete-alem"&&(e.calendar="ethioaa"),e}constructor(e,r={}){this.formatter=P6(e,r),this.options=r}}const fZ={true:{ja:"h11"},false:{}};function P6(t,e={}){if(typeof e.hour12=="boolean"&&hZ()){e={...e};let i=fZ[String(e.hour12)][t.split("-")[0]],a=e.hour12?"h12":"h23";e.hourCycle=i??a,delete e.hour12}let r=t+(e?Object.entries(e).sort((i,a)=>i[0]<a[0]?-1:1).join():"");if(xS.has(r))return xS.get(r);let n=new Intl.DateTimeFormat(t,e);return xS.set(r,n),n}let CS=null;function hZ(){return CS==null&&(CS=new Intl.DateTimeFormat("en-US",{hour:"numeric",hour12:!1}).format(new Date(2020,2,3,0))==="24"),CS}let TS=null;function pZ(){return TS==null&&(TS=new Intl.DateTimeFormat("fr",{hour:"numeric",hour12:!1}).resolvedOptions().hourCycle==="h12"),TS}function mZ(t,e){if(!e.timeStyle&&!e.hour)return;t=t.replace(/(-u-)?-nu-[a-zA-Z0-9]+/,""),t+=(t.includes("-u-")?"":"-u")+"-nu-latn";let r=P6(t,{...e,timeZone:void 0}),n=parseInt(r.formatToParts(new Date(2020,2,3,0)).find(a=>a.type==="hour").value,10),i=parseInt(r.formatToParts(new Date(2020,2,3,23)).find(a=>a.type==="hour").value,10);if(n===0&&i===23)return"h23";if(n===24&&i===23)return"h24";if(n===0&&i===11)return"h11";if(n===12&&i===11)return"h12";throw new Error("Unexpected hour cycle result")}function Sl(t={}){const{strict:e=!0,errorMessage:r="useContext: `context` is undefined. Seems you forgot to wrap component within the Provider",name:n}=t,i=D.createContext(void 0);i.displayName=n;function a(){var o;const s=D.useContext(i);if(!s&&e){const l=new Error(r);throw l.name="ContextError",(o=Error.captureStackTrace)==null||o.call(Error,l,a),l}return s}return[i.Provider,a,i]}function fr(t){const e=D.useRef(null);return D.useImperativeHandle(t,()=>e.current),e}function vZ(t,e){return t&&e&&t.x<e.x+e.width&&t.x+t.width>e.x&&t.y<e.y+e.height&&t.y+t.height>e.y}var A6=t=>t;function DT(t){return Array.isArray(t)}function gZ(t){return DT(t)&&t.length===0}function k6(t){const e=typeof t;return t!=null&&(e==="object"||e==="function")&&!DT(t)}function yZ(t){return k6(t)&&Object.keys(t).length===0}function qE(t){return DT(t)?gZ(t):k6(t)?yZ(t):t==null||t===""}function bZ(t){return typeof t=="function"}var Te=t=>t?"true":void 0;function O6(t){var e,r,n="";if(typeof t=="string"||typeof t=="number")n+=t;else if(typeof t=="object")if(Array.isArray(t))for(e=0;e<t.length;e++)t[e]&&(r=O6(t[e]))&&(n&&(n+=" "),n+=r);else for(e in t)t[e]&&(n&&(n+=" "),n+=e);return n}function qe(...t){for(var e=0,r,n,i="";e<t.length;)(r=t[e++])&&(n=O6(r))&&(i&&(i+=" "),i+=n);return i}var _Z=(...t)=>{let e=" ";for(const r of t)if(typeof r=="string"&&r.length>0){e=r;break}return e};function $6(t){return`${t}-${Math.floor(Math.random()*1e6)}`}function SZ(t){for(const e in t)e.startsWith("on")&&delete t[e];return t}function Ri(t){if(!t||typeof t!="object")return"";try{return JSON.stringify(t)}catch{return""}}function oM(t,e=0){let r;return function(...n){const i=()=>{r=void 0,t.apply(this,n)};r!==void 0&&clearTimeout(r),r=setTimeout(i,e)}}function RT(t,e,r){return Math.min(Math.max(t,e),r)}function wZ(t,e=100){return Math.min(Math.max(t,0),e)}var sM={};function MT(t,e,...r){const i=`[Hero UI]${e?` [${e}]`:" "}: ${t}`;typeof console>"u"||sM[i]||(sM[i]=!0)}function EZ(t){switch(t){case"buddhist":return 543;case"ethiopic":case"ethioaa":return-8;case"coptic":return-284;case"hebrew":return 3760;case"indian":return-78;case"islamic-civil":case"islamic-tbla":case"islamic-umalqura":return-579;case"persian":return-600;case"roc":case"japanese":case"gregory":default:return 0}}function xZ(t,e){if(t!=null){if(bZ(t)){t(e);return}try{t.current=e}catch{throw new Error(`Cannot assign value '${e}' to ref '${t}'`)}}}function CZ(...t){return e=>{t.forEach(r=>xZ(r,e))}}var TZ=(t,e)=>{var r;let n=[];const i=(r=D.Children.map(t,o=>D.isValidElement(o)&&o.type===e?(n.push(o),null):o))==null?void 0:r.filter(Boolean),a=n.length>=0?n:void 0;return[i,a]},DZ=new Set(["id","type","style","title","role","tabIndex","htmlFor","width","height","abbr","accept","acceptCharset","accessKey","action","allowFullScreen","allowTransparency","alt","async","autoComplete","autoFocus","autoPlay","cellPadding","cellSpacing","challenge","charset","checked","cite","class","className","cols","colSpan","command","content","contentEditable","contextMenu","controls","coords","crossOrigin","data","dateTime","default","defer","dir","disabled","download","draggable","dropzone","encType","enterKeyHint","for","form","formAction","formEncType","formMethod","formNoValidate","formTarget","frameBorder","headers","hidden","high","href","hrefLang","httpEquiv","icon","inputMode","isMap","itemId","itemProp","itemRef","itemScope","itemType","kind","label","lang","list","loop","manifest","max","maxLength","media","mediaGroup","method","min","minLength","multiple","muted","name","noValidate","open","optimum","pattern","ping","placeholder","poster","preload","radioGroup","referrerPolicy","readOnly","rel","required","rows","rowSpan","sandbox","scope","scoped","scrolling","seamless","selected","shape","size","sizes","slot","sortable","span","spellCheck","src","srcDoc","srcSet","start","step","target","translate","typeMustMatch","useMap","value","wmode","wrap"]),RZ=new Set(["onCopy","onCut","onPaste","onLoad","onError","onWheel","onScroll","onCompositionEnd","onCompositionStart","onCompositionUpdate","onKeyDown","onKeyPress","onKeyUp","onFocus","onBlur","onChange","onInput","onSubmit","onClick","onContextMenu","onDoubleClick","onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onPointerDown","onPointerEnter","onPointerLeave","onPointerUp","onSelect","onTouchCancel","onTouchEnd","onTouchMove","onTouchStart","onAnimationStart","onAnimationEnd","onAnimationIteration","onTransitionEnd"]),lM=/^(data-.*)$/,MZ=/^(aria-.*)$/,Kv=/^(on[A-Z].*)$/;function Mi(t,e={}){let{labelable:r=!0,enabled:n=!0,propNames:i,omitPropNames:a,omitEventNames:o,omitDataProps:s,omitEventProps:l}=e,c={};if(!n)return t;for(const d in t)a!=null&&a.has(d)||o!=null&&o.has(d)&&Kv.test(d)||Kv.test(d)&&!RZ.has(d)||s&&lM.test(d)||l&&Kv.test(d)||(Object.prototype.hasOwnProperty.call(t,d)&&(DZ.has(d)||r&&MZ.test(d)||i!=null&&i.has(d)||lM.test(d))||Kv.test(d))&&(c[d]=t[d]);return c}var[IZ,ln]=Sl({name:"ProviderContext",strict:!1});const PZ=new Set(["Arab","Syrc","Samr","Mand","Thaa","Mend","Nkoo","Adlm","Rohg","Hebr"]),AZ=new Set(["ae","ar","arc","bcc","bqi","ckb","dv","fa","glk","he","ku","mzn","nqo","pnb","ps","sd","ug","ur","yi"]);function L6(t){if(Intl.Locale){let r=new Intl.Locale(t).maximize(),n=typeof r.getTextInfo=="function"?r.getTextInfo():r.textInfo;if(n)return n.direction==="rtl";if(r.script)return PZ.has(r.script)}let e=t.split("-")[0];return AZ.has(e)}const IT={prefix:String(Math.round(Math.random()*1e10)),current:0},B6=We.createContext(IT),kZ=We.createContext(!1);let OZ=!!(typeof window<"u"&&window.document&&window.document.createElement),DS=new WeakMap;function $Z(t=!1){let e=D.useContext(B6),r=D.useRef(null);if(r.current===null&&!t){var n,i;let a=(i=We.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED)===null||i===void 0||(n=i.ReactCurrentOwner)===null||n===void 0?void 0:n.current;if(a){let o=DS.get(a);o==null?DS.set(a,{id:e.current,state:a.memoizedState}):a.memoizedState!==o.state&&(e.current=o.id,DS.delete(a))}r.current=++e.current}return r.current}function LZ(t){let e=D.useContext(B6);e===IT&&!OZ&&console.warn("When server rendering, you must wrap your application in an <SSRProvider> to ensure consistent ids are generated between the client and server.");let r=$Z(!!t),n=`react-aria${e.prefix}`;return t||`${n}-${r}`}function BZ(t){let e=We.useId(),[r]=D.useState(Am()),n=r?"react-aria":`react-aria${IT.prefix}`;return t||`${n}-${e}`}const NZ=typeof We.useId=="function"?BZ:LZ;function UZ(){return!1}function FZ(){return!0}function jZ(t){return()=>{}}function Am(){return typeof We.useSyncExternalStore=="function"?We.useSyncExternalStore(jZ,UZ,FZ):D.useContext(kZ)}const VZ=Symbol.for("react-aria.i18n.locale");function N6(){let t=typeof window<"u"&&window[VZ]||typeof navigator<"u"&&(navigator.language||navigator.userLanguage)||"en-US";try{Intl.DateTimeFormat.supportedLocalesOf([t])}catch{t="en-US"}return{locale:t,direction:L6(t)?"rtl":"ltr"}}let ZE=N6(),Mh=new Set;function uM(){ZE=N6();for(let t of Mh)t(ZE)}function U6(){let t=Am(),[e,r]=D.useState(ZE);return D.useEffect(()=>(Mh.size===0&&window.addEventListener("languagechange",uM),Mh.add(r),()=>{Mh.delete(r),Mh.size===0&&window.removeEventListener("languagechange",uM)}),[]),t?{locale:"en-US",direction:"ltr"}:e}const F6=We.createContext(null);function zZ(t){let{locale:e,children:r}=t,n=U6(),i=We.useMemo(()=>e?{locale:e,direction:L6(e)?"rtl":"ltr"}:n,[n,e]);return We.createElement(F6.Provider,{value:i},r)}function sn(){let t=U6();return D.useContext(F6)||t}const KZ=Symbol.for("react-aria.i18n.locale"),HZ=Symbol.for("react-aria.i18n.strings");let pc;class fo{getStringForLocale(e,r){let i=this.getStringsForLocale(r)[e];if(!i)throw new Error(`Could not find intl message ${e} in ${r} locale`);return i}getStringsForLocale(e){let r=this.strings[e];return r||(r=WZ(e,this.strings,this.defaultLocale),this.strings[e]=r),r}static getGlobalDictionaryForPackage(e){if(typeof window>"u")return null;let r=window[KZ];if(pc===void 0){let i=window[HZ];if(!i)return null;pc={};for(let a in i)pc[a]=new fo({[r]:i[a]},r)}let n=pc==null?void 0:pc[e];if(!n)throw new Error(`Strings for package "${e}" were not included by LocalizedStringProvider. Please add it to the list passed to createLocalizedStringDictionary.`);return n}constructor(e,r="en-US"){this.strings=Object.fromEntries(Object.entries(e).filter(([,n])=>n)),this.defaultLocale=r}}function WZ(t,e,r="en-US"){if(e[t])return e[t];let n=GZ(t);if(e[n])return e[n];for(let i in e)if(i.startsWith(n+"-"))return e[i];return e[r]}function GZ(t){return Intl.Locale?new Intl.Locale(t).language:t.split("-")[0]}const cM=new Map,dM=new Map;class PT{format(e,r){let n=this.strings.getStringForLocale(e,this.locale);return typeof n=="function"?n(r,this):n}plural(e,r,n="cardinal"){let i=r["="+e];if(i)return typeof i=="function"?i():i;let a=this.locale+":"+n,o=cM.get(a);o||(o=new Intl.PluralRules(this.locale,{type:n}),cM.set(a,o));let s=o.select(e);return i=r[s]||r.other,typeof i=="function"?i():i}number(e){let r=dM.get(this.locale);return r||(r=new Intl.NumberFormat(this.locale),dM.set(this.locale,r)),r.format(e)}select(e,r){let n=e[r]||e.other;return typeof n=="function"?n():n}constructor(e,r){this.locale=e,this.strings=r}}const fM=new WeakMap;function qZ(t){let e=fM.get(t);return e||(e=new fo(t),fM.set(t,e)),e}function j6(t,e){return e&&fo.getGlobalDictionaryForPackage(e)||qZ(t)}function Ra(t,e){let{locale:r}=sn(),n=j6(t,e);return D.useMemo(()=>new PT(r,n),[r,n])}const qt=typeof document<"u"?We.useLayoutEffect:()=>{};function rn(t){const e=D.useRef(null);return qt(()=>{e.current=t},[t]),D.useCallback((...r)=>{const n=e.current;return n==null?void 0:n(...r)},[])}function ZZ(t){let[e,r]=D.useState(t),n=D.useRef(null),i=rn(()=>{if(!n.current)return;let o=n.current.next();if(o.done){n.current=null;return}e===o.value?i():r(o.value)});qt(()=>{n.current&&i()});let a=rn(o=>{n.current=o(e),i()});return[e,a]}let YZ=!!(typeof window<"u"&&window.document&&window.document.createElement),fd=new Map,Ih;typeof FinalizationRegistry<"u"&&(Ih=new FinalizationRegistry(t=>{fd.delete(t)}));function Ii(t){let[e,r]=D.useState(t),n=D.useRef(null),i=NZ(e),a=D.useRef(null);if(Ih&&Ih.register(a,i),YZ){const o=fd.get(i);o&&!o.includes(n)?o.push(n):fd.set(i,[n])}return qt(()=>{let o=i;return()=>{Ih&&Ih.unregister(a),fd.delete(o)}},[i]),D.useEffect(()=>{let o=n.current;return o&&r(o),()=>{o&&(n.current=null)}}),i}function JZ(t,e){if(t===e)return t;let r=fd.get(t);if(r)return r.forEach(i=>i.current=e),e;let n=fd.get(e);return n?(n.forEach(i=>i.current=t),t):e}function nl(t=[]){let e=Ii(),[r,n]=ZZ(e),i=D.useCallback(()=>{n(function*(){yield e,yield document.getElementById(e)?e:void 0})},[e,n]);return qt(i,[e,i,...t]),r}function Tn(...t){return(...e)=>{for(let r of t)typeof r=="function"&&r(...e)}}const Ot=t=>{var e;return(e=t==null?void 0:t.ownerDocument)!==null&&e!==void 0?e:document},_i=t=>t&&"window"in t&&t.window===t?t:Ot(t).defaultView||window;function XZ(t){return t!==null&&typeof t=="object"&&"nodeType"in t&&typeof t.nodeType=="number"}function QZ(t){return XZ(t)&&t.nodeType===Node.DOCUMENT_FRAGMENT_NODE&&"host"in t}let eY=!1;function mb(){return eY}function or(t,e){if(!mb())return e&&t?t.contains(e):!1;if(!t||!e)return!1;let r=e;for(;r!==null;){if(r===t)return!0;r.tagName==="SLOT"&&r.assignedSlot?r=r.assignedSlot.parentNode:QZ(r)?r=r.host:r=r.parentNode}return!1}const vn=(t=document)=>{var e;if(!mb())return t.activeElement;let r=t.activeElement;for(;r&&"shadowRoot"in r&&(!((e=r.shadowRoot)===null||e===void 0)&&e.activeElement);)r=r.shadowRoot.activeElement;return r};function Pt(t){return mb()&&t.target.shadowRoot&&t.composedPath?t.composedPath()[0]:t.target}class tY{get currentNode(){return this._currentNode}set currentNode(e){if(!or(this.root,e))throw new Error("Cannot set currentNode to a node that is not contained by the root node.");const r=[];let n=e,i=e;for(this._currentNode=e;n&&n!==this.root;)if(n.nodeType===Node.DOCUMENT_FRAGMENT_NODE){const o=n,s=this._doc.createTreeWalker(o,this.whatToShow,{acceptNode:this._acceptNode});r.push(s),s.currentNode=i,this._currentSetFor.add(s),n=i=o.host}else n=n.parentNode;const a=this._doc.createTreeWalker(this.root,this.whatToShow,{acceptNode:this._acceptNode});r.push(a),a.currentNode=i,this._currentSetFor.add(a),this._walkerStack=r}get doc(){return this._doc}firstChild(){let e=this.currentNode,r=this.nextNode();return or(e,r)?(r&&(this.currentNode=r),r):(this.currentNode=e,null)}lastChild(){let r=this._walkerStack[0].lastChild();return r&&(this.currentNode=r),r}nextNode(){const e=this._walkerStack[0].nextNode();if(e){if(e.shadowRoot){var r;let i;if(typeof this.filter=="function"?i=this.filter(e):!((r=this.filter)===null||r===void 0)&&r.acceptNode&&(i=this.filter.acceptNode(e)),i===NodeFilter.FILTER_ACCEPT)return this.currentNode=e,e;let a=this.nextNode();return a&&(this.currentNode=a),a}return e&&(this.currentNode=e),e}else if(this._walkerStack.length>1){this._walkerStack.shift();let n=this.nextNode();return n&&(this.currentNode=n),n}else return null}previousNode(){const e=this._walkerStack[0];if(e.currentNode===e.root){if(this._currentSetFor.has(e))if(this._currentSetFor.delete(e),this._walkerStack.length>1){this._walkerStack.shift();let i=this.previousNode();return i&&(this.currentNode=i),i}else return null;return null}const r=e.previousNode();if(r){if(r.shadowRoot){var n;let a;if(typeof this.filter=="function"?a=this.filter(r):!((n=this.filter)===null||n===void 0)&&n.acceptNode&&(a=this.filter.acceptNode(r)),a===NodeFilter.FILTER_ACCEPT)return r&&(this.currentNode=r),r;let o=this.lastChild();return o&&(this.currentNode=o),o}return r&&(this.currentNode=r),r}else if(this._walkerStack.length>1){this._walkerStack.shift();let i=this.previousNode();return i&&(this.currentNode=i),i}else return null}nextSibling(){return null}previousSibling(){return null}parentNode(){return null}constructor(e,r,n,i){this._walkerStack=[],this._currentSetFor=new Set,this._acceptNode=o=>{if(o.nodeType===Node.ELEMENT_NODE){const l=o.shadowRoot;if(l){const c=this._doc.createTreeWalker(l,this.whatToShow,{acceptNode:this._acceptNode});return this._walkerStack.unshift(c),NodeFilter.FILTER_ACCEPT}else{var s;if(typeof this.filter=="function")return this.filter(o);if(!((s=this.filter)===null||s===void 0)&&s.acceptNode)return this.filter.acceptNode(o);if(this.filter===null)return NodeFilter.FILTER_ACCEPT}}return NodeFilter.FILTER_SKIP},this._doc=e,this.root=r,this.filter=i??null,this.whatToShow=n??NodeFilter.SHOW_ALL,this._currentNode=r,this._walkerStack.unshift(e.createTreeWalker(r,n,this._acceptNode));const a=r.shadowRoot;if(a){const o=this._doc.createTreeWalker(a,this.whatToShow,{acceptNode:this._acceptNode});this._walkerStack.unshift(o)}}}function rY(t,e,r,n){return mb()?new tY(t,e,r,n):t.createTreeWalker(e,r,n)}function V6(t){var e,r,n="";if(typeof t=="string"||typeof t=="number")n+=t;else if(typeof t=="object")if(Array.isArray(t)){var i=t.length;for(e=0;e<i;e++)t[e]&&(r=V6(t[e]))&&(n&&(n+=" "),n+=r)}else for(r in t)t[r]&&(n&&(n+=" "),n+=r);return n}function nY(){for(var t,e,r=0,n="",i=arguments.length;r<i;r++)(t=arguments[r])&&(e=V6(t))&&(n&&(n+=" "),n+=e);return n}function Oe(...t){let e={...t[0]};for(let r=1;r<t.length;r++){let n=t[r];for(let i in n){let a=e[i],o=n[i];typeof a=="function"&&typeof o=="function"&&i[0]==="o"&&i[1]==="n"&&i.charCodeAt(2)>=65&&i.charCodeAt(2)<=90?e[i]=Tn(a,o):(i==="className"||i==="UNSAFE_className")&&typeof a=="string"&&typeof o=="string"?e[i]=nY(a,o):i==="id"&&a&&o?e.id=JZ(a,o):e[i]=o!==void 0?o:a}}return e}function AT(...t){return t.length===1&&t[0]?t[0]:e=>{for(let r of t)typeof r=="function"?r(e):r!=null&&(r.current=e)}}const iY=new Set(["id"]),aY=new Set(["aria-label","aria-labelledby","aria-describedby","aria-details"]),oY=new Set(["href","hrefLang","target","rel","download","ping","referrerPolicy"]),sY=/^(data-.*)$/;function ho(t,e={}){let{labelable:r,isLink:n,propNames:i}=e,a={};for(const o in t)Object.prototype.hasOwnProperty.call(t,o)&&(iY.has(o)||r&&aY.has(o)||n&&oY.has(o)||i!=null&&i.has(o)||sY.test(o))&&(a[o]=t[o]);return a}function wn(t){if(lY())t.focus({preventScroll:!0});else{let e=uY(t);t.focus(),cY(e)}}let Hv=null;function lY(){if(Hv==null){Hv=!1;try{document.createElement("div").focus({get preventScroll(){return Hv=!0,!0}})}catch{}}return Hv}function uY(t){let e=t.parentNode,r=[],n=document.scrollingElement||document.documentElement;for(;e instanceof HTMLElement&&e!==n;)(e.offsetHeight<e.scrollHeight||e.offsetWidth<e.scrollWidth)&&r.push({element:e,scrollTop:e.scrollTop,scrollLeft:e.scrollLeft}),e=e.parentNode;return n instanceof HTMLElement&&r.push({element:n,scrollTop:n.scrollTop,scrollLeft:n.scrollLeft}),r}function cY(t){for(let{element:e,scrollTop:r,scrollLeft:n}of t)e.scrollTop=r,e.scrollLeft=n}function vb(t){var e;return typeof window>"u"||window.navigator==null?!1:((e=window.navigator.userAgentData)===null||e===void 0?void 0:e.brands.some(r=>t.test(r.brand)))||t.test(window.navigator.userAgent)}function kT(t){var e;return typeof window<"u"&&window.navigator!=null?t.test(((e=window.navigator.userAgentData)===null||e===void 0?void 0:e.platform)||window.navigator.platform):!1}function ns(t){let e=null;return()=>(e==null&&(e=t()),e)}const cl=ns(function(){return kT(/^Mac/i)}),dY=ns(function(){return kT(/^iPhone/i)}),z6=ns(function(){return kT(/^iPad/i)||cl()&&navigator.maxTouchPoints>1}),Hu=ns(function(){return dY()||z6()}),fY=ns(function(){return cl()||Hu()}),K6=ns(function(){return vb(/AppleWebKit/i)&&!H6()}),H6=ns(function(){return vb(/Chrome/i)}),km=ns(function(){return vb(/Android/i)}),hY=ns(function(){return vb(/Firefox/i)}),W6=D.createContext({isNative:!0,open:vY,useHref:t=>t});function pY(t){let{children:e,navigate:r,useHref:n}=t,i=D.useMemo(()=>({isNative:!1,open:(a,o,s,l)=>{G6(a,c=>{mY(c,o)?r(s,l):dl(c,o)})},useHref:n||(a=>a)}),[r,n]);return We.createElement(W6.Provider,{value:i},e)}function gb(){return D.useContext(W6)}function mY(t,e){let r=t.getAttribute("target");return(!r||r==="_self")&&t.origin===location.origin&&!t.hasAttribute("download")&&!e.metaKey&&!e.ctrlKey&&!e.altKey&&!e.shiftKey}function dl(t,e,r=!0){var n,i;let{metaKey:a,ctrlKey:o,altKey:s,shiftKey:l}=e;hY()&&(!((i=window.event)===null||i===void 0||(n=i.type)===null||n===void 0)&&n.startsWith("key"))&&t.target==="_blank"&&(cl()?a=!0:o=!0);let c=K6()&&cl()&&!z6()?new KeyboardEvent("keydown",{keyIdentifier:"Enter",metaKey:a,ctrlKey:o,altKey:s,shiftKey:l}):new MouseEvent("click",{metaKey:a,ctrlKey:o,altKey:s,shiftKey:l,bubbles:!0,cancelable:!0});dl.isOpening=r,wn(t),t.dispatchEvent(c),dl.isOpening=!1}dl.isOpening=!1;function G6(t,e){if(t instanceof HTMLAnchorElement)e(t);else if(t.hasAttribute("data-href")){let r=document.createElement("a");r.href=t.getAttribute("data-href"),t.hasAttribute("data-target")&&(r.target=t.getAttribute("data-target")),t.hasAttribute("data-rel")&&(r.rel=t.getAttribute("data-rel")),t.hasAttribute("data-download")&&(r.download=t.getAttribute("data-download")),t.hasAttribute("data-ping")&&(r.ping=t.getAttribute("data-ping")),t.hasAttribute("data-referrer-policy")&&(r.referrerPolicy=t.getAttribute("data-referrer-policy")),t.appendChild(r),e(r),t.removeChild(r)}}function vY(t,e){G6(t,r=>dl(r,e))}function gY(t){let e=gb();var r;const n=e.useHref((r=t==null?void 0:t.href)!==null&&r!==void 0?r:"");return{href:t!=null&&t.href?n:void 0,target:t==null?void 0:t.target,rel:t==null?void 0:t.rel,download:t==null?void 0:t.download,ping:t==null?void 0:t.ping,referrerPolicy:t==null?void 0:t.referrerPolicy}}let Ac=new Map,YE=new Set;function hM(){if(typeof window>"u")return;function t(n){return"propertyName"in n}let e=n=>{if(!t(n)||!n.target)return;let i=Ac.get(n.target);i||(i=new Set,Ac.set(n.target,i),n.target.addEventListener("transitioncancel",r,{once:!0})),i.add(n.propertyName)},r=n=>{if(!t(n)||!n.target)return;let i=Ac.get(n.target);if(i&&(i.delete(n.propertyName),i.size===0&&(n.target.removeEventListener("transitioncancel",r),Ac.delete(n.target)),Ac.size===0)){for(let a of YE)a();YE.clear()}};document.body.addEventListener("transitionrun",e),document.body.addEventListener("transitionend",r)}typeof document<"u"&&(document.readyState!=="loading"?hM():document.addEventListener("DOMContentLoaded",hM));function q6(t){requestAnimationFrame(()=>{Ac.size===0?t():YE.add(t)})}function yb(){let t=D.useRef(new Map),e=D.useCallback((i,a,o,s)=>{let l=s!=null&&s.once?(...c)=>{t.current.delete(o),o(...c)}:o;t.current.set(o,{type:a,eventTarget:i,fn:l,options:s}),i.addEventListener(a,l,s)},[]),r=D.useCallback((i,a,o,s)=>{var l;let c=((l=t.current.get(o))===null||l===void 0?void 0:l.fn)||o;i.removeEventListener(a,c,s),t.current.delete(o)},[]),n=D.useCallback(()=>{t.current.forEach((i,a)=>{r(i.eventTarget,i.type,a,i.options)})},[r]);return D.useEffect(()=>n,[n]),{addGlobalListener:e,removeGlobalListener:r,removeAllGlobalListeners:n}}function Om(t,e){let{id:r,"aria-label":n,"aria-labelledby":i}=t;return r=Ii(r),i&&n?i=[...new Set([r,...i.trim().split(/\s+/)])].join(" "):i&&(i=i.trim().split(/\s+/).join(" ")),!n&&!i&&e&&(n=e),{id:r,"aria-label":n,"aria-labelledby":i}}function yY(t){const e=D.useRef(null);return D.useMemo(()=>({get current(){return e.current},set current(r){e.current=r,typeof t=="function"?t(r):t&&(t.current=r)}}),[t])}function pM(t,e){const r=D.useRef(!0),n=D.useRef(null);D.useEffect(()=>(r.current=!0,()=>{r.current=!1}),[]),D.useEffect(()=>{let i=n.current;r.current?r.current=!1:(!i||e.some((a,o)=>!Object.is(a,i[o])))&&t(),n.current=e},e)}function mM(t,e){const r=D.useRef(!0),n=D.useRef(null);qt(()=>(r.current=!0,()=>{r.current=!1}),[]),qt(()=>{r.current?r.current=!1:(!n.current||e.some((i,a)=>!Object.is(i,n[a])))&&t(),n.current=e},e)}function bY(){return typeof window.ResizeObserver<"u"}function vM(t){const{ref:e,box:r,onResize:n}=t;D.useEffect(()=>{let i=e==null?void 0:e.current;if(i)if(bY()){const a=new window.ResizeObserver(o=>{o.length&&n()});return a.observe(i,{box:r}),()=>{i&&a.unobserve(i)}}else return window.addEventListener("resize",n,!1),()=>{window.removeEventListener("resize",n,!1)}},[n,e,r])}function Z6(t,e){qt(()=>{if(t&&t.ref&&e)return t.ref.current=e.current,()=>{t.ref&&(t.ref.current=null)}})}function Op(t,e){if(!t)return!1;let r=window.getComputedStyle(t),n=/(auto|scroll)/.test(r.overflow+r.overflowX+r.overflowY);return n&&e&&(n=t.scrollHeight!==t.clientHeight||t.scrollWidth!==t.clientWidth),n}function bb(t,e){let r=t;for(Op(r,e)&&(r=r.parentElement);r&&!Op(r,e);)r=r.parentElement;return r||document.scrollingElement||document.documentElement}function _Y(t,e){const r=[];for(;t&&t!==document.documentElement;)Op(t,e)&&r.push(t),t=t.parentElement;return r}let Hi=typeof document<"u"&&window.visualViewport;function SY(){let t=Am(),[e,r]=D.useState(()=>t?{width:0,height:0}:gM());return D.useEffect(()=>{let n=()=>{r(i=>{let a=gM();return a.width===i.width&&a.height===i.height?i:a})};return Hi?Hi.addEventListener("resize",n):window.addEventListener("resize",n),()=>{Hi?Hi.removeEventListener("resize",n):window.removeEventListener("resize",n)}},[]),e}function gM(){return{width:Hi&&(Hi==null?void 0:Hi.width)||window.innerWidth,height:Hi&&(Hi==null?void 0:Hi.height)||window.innerHeight}}let wY=0;const RS=new Map;function _b(t){let[e,r]=D.useState();return qt(()=>{if(!t)return;let n=RS.get(t);if(n)r(n.element.id);else{let i=`react-aria-description-${wY++}`;r(i);let a=document.createElement("div");a.id=i,a.style.display="none",a.textContent=t,document.body.appendChild(a),n={refCount:0,element:a},RS.set(t,n)}return n.refCount++,()=>{n&&--n.refCount===0&&(n.element.remove(),RS.delete(t))}},[t]),{"aria-describedby":t?e:void 0}}function qa(t,e,r,n){let i=rn(r),a=r==null;D.useEffect(()=>{if(a||!t.current)return;let o=t.current;return o.addEventListener(e,i,n),()=>{o.removeEventListener(e,i,n)}},[t,e,n,a,i])}function Y6(t,e){let r=yM(t,e,"left"),n=yM(t,e,"top"),i=e.offsetWidth,a=e.offsetHeight,o=t.scrollLeft,s=t.scrollTop,{borderTopWidth:l,borderLeftWidth:c,scrollPaddingTop:d,scrollPaddingRight:h,scrollPaddingBottom:p,scrollPaddingLeft:m}=getComputedStyle(t),g=o+parseInt(c,10),y=s+parseInt(l,10),R=g+t.clientWidth,b=y+t.clientHeight,_=parseInt(d,10)||0,x=parseInt(p,10)||0,T=parseInt(h,10)||0,I=parseInt(m,10)||0;r<=o+I?o=r-parseInt(c,10)-I:r+i>R-T&&(o+=r+i-R+T),n<=y+_?s=n-parseInt(l,10)-_:n+a>b-x&&(s+=n+a-b+x),t.scrollLeft=o,t.scrollTop=s}function yM(t,e,r){const n=r==="left"?"offsetLeft":"offsetTop";let i=0;for(;e.offsetParent&&(i+=e[n],e.offsetParent!==t);){if(e.offsetParent.contains(t)){i-=t[n];break}e=e.offsetParent}return i}function Zy(t,e){if(t&&document.contains(t)){let o=document.scrollingElement||document.documentElement;if(window.getComputedStyle(o).overflow==="hidden"){let l=_Y(t);for(let c of l)Y6(c,t)}else{var r;let{left:l,top:c}=t.getBoundingClientRect();t==null||(r=t.scrollIntoView)===null||r===void 0||r.call(t,{block:"nearest"});let{left:d,top:h}=t.getBoundingClientRect();if(Math.abs(l-d)>1||Math.abs(c-h)>1){var n,i,a;e==null||(i=e.containingElement)===null||i===void 0||(n=i.scrollIntoView)===null||n===void 0||n.call(i,{block:"center",inline:"center"}),(a=t.scrollIntoView)===null||a===void 0||a.call(t,{block:"nearest"})}}}}function JE(t){return t.mozInputSource===0&&t.isTrusted?!0:km()&&t.pointerType?t.type==="click"&&t.buttons===1:t.detail===0&&!t.pointerType}function EY(t){return!km()&&t.width===0&&t.height===0||t.width===1&&t.height===1&&t.pressure===0&&t.detail===0&&t.pointerType==="mouse"}function J6(t,e){let r=D.useRef(null);return t&&r.current&&e(t,r.current)&&(t=r.current),r.current=t,t}function X6(t,e,r){let n=D.useRef(e),i=rn(()=>{r&&r(n.current)});D.useEffect(()=>{var a;let o=t==null||(a=t.current)===null||a===void 0?void 0:a.form;return o==null||o.addEventListener("reset",i),()=>{o==null||o.removeEventListener("reset",i)}},[t,i])}const xY="react-aria-clear-focus",CY="react-aria-focus";function kc(t){return cl()?t.metaKey:t.ctrlKey}const OT=["input:not([disabled]):not([type=hidden])","select:not([disabled])","textarea:not([disabled])","button:not([disabled])","a[href]","area[href]","summary","iframe","object","embed","audio[controls]","video[controls]",'[contenteditable]:not([contenteditable^="false"])'],TY=OT.join(":not([hidden]),")+",[tabindex]:not([disabled]):not([hidden])";OT.push('[tabindex]:not([tabindex="-1"]):not([disabled])');const DY=OT.join(':not([hidden]):not([tabindex="-1"]),');function Q6(t){return t.matches(TY)}function RY(t){return t.matches(DY)}function Pi(t,e,r){let[n,i]=D.useState(t||e),a=D.useRef(t!==void 0),o=t!==void 0;D.useEffect(()=>{let c=a.current;c!==o&&console.warn(`WARN: A component changed from ${c?"controlled":"uncontrolled"} to ${o?"controlled":"uncontrolled"}.`),a.current=o},[o]);let s=o?t:n,l=D.useCallback((c,...d)=>{let h=(p,...m)=>{r&&(Object.is(s,p)||r(p,...m)),o||(s=p)};typeof c=="function"?(console.warn("We can not support a function callback. See Github Issues for details https://github.com/adobe/react-spectrum/issues/2320"),i((m,...g)=>{let y=c(o?s:m,...g);return h(y,...d),o?m:y})):(o||i(c),h(c,...d))},[o,s,r]);return[s,l]}function Yy(t,e=-1/0,r=1/0){return Math.min(Math.max(t,e),r)}function Si(t){t=J6(t??{},MY);let{locale:e}=sn();return D.useMemo(()=>new ba(e,t),[e,t])}function MY(t,e){if(t===e)return!0;let r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(let i of r)if(e[i]!==t[i])return!1;return!0}let MS=new Map,XE=!1;try{XE=new Intl.NumberFormat("de-DE",{signDisplay:"exceptZero"}).resolvedOptions().signDisplay==="exceptZero"}catch{}let Jy=!1;try{Jy=new Intl.NumberFormat("de-DE",{style:"unit",unit:"degree"}).resolvedOptions().style==="unit"}catch{}const eL={degree:{narrow:{default:"","ja-JP":" ","zh-TW":"","sl-SI":" "}}};class tL{format(e){let r="";if(!XE&&this.options.signDisplay!=null?r=PY(this.numberFormatter,this.options.signDisplay,e):r=this.numberFormatter.format(e),this.options.style==="unit"&&!Jy){var n;let{unit:i,unitDisplay:a="short",locale:o}=this.resolvedOptions();if(!i)return r;let s=(n=eL[i])===null||n===void 0?void 0:n[a];r+=s[o]||s.default}return r}formatToParts(e){return this.numberFormatter.formatToParts(e)}formatRange(e,r){if(typeof this.numberFormatter.formatRange=="function")return this.numberFormatter.formatRange(e,r);if(r<e)throw new RangeError("End date must be >= start date");return`${this.format(e)}  ${this.format(r)}`}formatRangeToParts(e,r){if(typeof this.numberFormatter.formatRangeToParts=="function")return this.numberFormatter.formatRangeToParts(e,r);if(r<e)throw new RangeError("End date must be >= start date");let n=this.numberFormatter.formatToParts(e),i=this.numberFormatter.formatToParts(r);return[...n.map(a=>({...a,source:"startRange"})),{type:"literal",value:"  ",source:"shared"},...i.map(a=>({...a,source:"endRange"}))]}resolvedOptions(){let e=this.numberFormatter.resolvedOptions();return!XE&&this.options.signDisplay!=null&&(e={...e,signDisplay:this.options.signDisplay}),!Jy&&this.options.style==="unit"&&(e={...e,style:"unit",unit:this.options.unit,unitDisplay:this.options.unitDisplay}),e}constructor(e,r={}){this.numberFormatter=IY(e,r),this.options=r}}function IY(t,e={}){let{numberingSystem:r}=e;if(r&&t.includes("-nu-")&&(t.includes("-u-")||(t+="-u-"),t+=`-nu-${r}`),e.style==="unit"&&!Jy){var n;let{unit:o,unitDisplay:s="short"}=e;if(!o)throw new Error('unit option must be provided with style: "unit"');if(!(!((n=eL[o])===null||n===void 0)&&n[s]))throw new Error(`Unsupported unit ${o} with unitDisplay = ${s}`);e={...e,style:"decimal"}}let i=t+(e?Object.entries(e).sort((o,s)=>o[0]<s[0]?-1:1).join():"");if(MS.has(i))return MS.get(i);let a=new Intl.NumberFormat(t,e);return MS.set(i,a),a}function PY(t,e,r){if(e==="auto")return t.format(r);if(e==="never")return t.format(Math.abs(r));{let n=!1;if(e==="always"?n=r>0||Object.is(r,0):e==="exceptZero"&&(Object.is(r,-0)||Object.is(r,0)?r=Math.abs(r):n=r>0),n){let i=t.format(-r),a=t.format(r),o=i.replace(a,"").replace(/\u200e|\u061C/,"");return[...o].length!==1&&console.warn("@react-aria/i18n polyfill for NumberFormat signDisplay: Unsupported case"),i.replace(a,"!!!").replace(o,"+").replace("!!!",a)}else return t.format(r)}}const AY=new RegExp("^.*\\(.*\\).*$"),kY=["latn","arab","hanidec","deva","beng"];class rL{parse(e){return IS(this.locale,this.options,e).parse(e)}isValidPartialNumber(e,r,n){return IS(this.locale,this.options,e).isValidPartialNumber(e,r,n)}getNumberingSystem(e){return IS(this.locale,this.options,e).options.numberingSystem}constructor(e,r={}){this.locale=e,this.options=r}}const bM=new Map;function IS(t,e,r){let n=_M(t,e);if(!t.includes("-nu-")&&!n.isValidPartialNumber(r)){for(let i of kY)if(i!==n.options.numberingSystem){let a=_M(t+(t.includes("-u-")?"-nu-":"-u-nu-")+i,e);if(a.isValidPartialNumber(r))return a}}return n}function _M(t,e){let r=t+(e?Object.entries(e).sort((i,a)=>i[0]<a[0]?-1:1).join():""),n=bM.get(r);return n||(n=new OY(t,e),bM.set(r,n)),n}class OY{parse(e){let r=this.sanitize(e);if(this.symbols.group&&(r=ah(r,this.symbols.group,"")),this.symbols.decimal&&(r=r.replace(this.symbols.decimal,".")),this.symbols.minusSign&&(r=r.replace(this.symbols.minusSign,"-")),r=r.replace(this.symbols.numeral,this.symbols.index),this.options.style==="percent"){let o=r.indexOf("-");r=r.replace("-","");let s=r.indexOf(".");s===-1&&(s=r.length),r=r.replace(".",""),s-2===0?r=`0.${r}`:s-2===-1?r=`0.0${r}`:s-2===-2?r="0.00":r=`${r.slice(0,s-2)}.${r.slice(s-2)}`,o>-1&&(r=`-${r}`)}let n=r?+r:NaN;if(isNaN(n))return NaN;if(this.options.style==="percent"){var i,a;let o={...this.options,style:"decimal",minimumFractionDigits:Math.min(((i=this.options.minimumFractionDigits)!==null&&i!==void 0?i:0)+2,20),maximumFractionDigits:Math.min(((a=this.options.maximumFractionDigits)!==null&&a!==void 0?a:0)+2,20)};return new rL(this.locale,o).parse(new tL(this.locale,o).format(n))}return this.options.currencySign==="accounting"&&AY.test(e)&&(n=-1*n),n}sanitize(e){return e=e.replace(this.symbols.literals,""),this.symbols.minusSign&&(e=e.replace("-",this.symbols.minusSign)),this.options.numberingSystem==="arab"&&(this.symbols.decimal&&(e=e.replace(",",this.symbols.decimal),e=e.replace("",this.symbols.decimal)),this.symbols.group&&(e=ah(e,".",this.symbols.group))),this.options.locale==="fr-FR"&&this.symbols.group&&(e=ah(e," ",this.symbols.group),e=ah(e,/\u00A0/g,this.symbols.group)),e}isValidPartialNumber(e,r=-1/0,n=1/0){return e=this.sanitize(e),this.symbols.minusSign&&e.startsWith(this.symbols.minusSign)&&r<0?e=e.slice(this.symbols.minusSign.length):this.symbols.plusSign&&e.startsWith(this.symbols.plusSign)&&n>0&&(e=e.slice(this.symbols.plusSign.length)),this.symbols.group&&e.startsWith(this.symbols.group)||this.symbols.decimal&&e.indexOf(this.symbols.decimal)>-1&&this.options.maximumFractionDigits===0?!1:(this.symbols.group&&(e=ah(e,this.symbols.group,"")),e=e.replace(this.symbols.numeral,""),this.symbols.decimal&&(e=e.replace(this.symbols.decimal,"")),e.length===0)}constructor(e,r={}){this.locale=e,this.formatter=new Intl.NumberFormat(e,r),this.options=this.formatter.resolvedOptions(),this.symbols=LY(e,this.formatter,this.options,r);var n,i;this.options.style==="percent"&&(((n=this.options.minimumFractionDigits)!==null&&n!==void 0?n:0)>18||((i=this.options.maximumFractionDigits)!==null&&i!==void 0?i:0)>18)&&console.warn("NumberParser cannot handle percentages with greater than 18 decimal places, please reduce the number in your options.")}}const SM=new Set(["decimal","fraction","integer","minusSign","plusSign","group"]),$Y=[0,4,2,1,11,20,3,7,100,21,.1,1.1];function LY(t,e,r,n){var i,a,o,s;let l=new Intl.NumberFormat(t,{...r,minimumSignificantDigits:1,maximumSignificantDigits:21,roundingIncrement:1,roundingPriority:"auto",roundingMode:"halfExpand"}),c=l.formatToParts(-10000.111),d=l.formatToParts(10000.111),h=$Y.map(z=>l.formatToParts(z));var p;let m=(p=(i=c.find(z=>z.type==="minusSign"))===null||i===void 0?void 0:i.value)!==null&&p!==void 0?p:"-",g=(a=d.find(z=>z.type==="plusSign"))===null||a===void 0?void 0:a.value;!g&&((n==null?void 0:n.signDisplay)==="exceptZero"||(n==null?void 0:n.signDisplay)==="always")&&(g="+");let R=(o=new Intl.NumberFormat(t,{...r,minimumFractionDigits:2,maximumFractionDigits:2}).formatToParts(.001).find(z=>z.type==="decimal"))===null||o===void 0?void 0:o.value,b=(s=c.find(z=>z.type==="group"))===null||s===void 0?void 0:s.value,_=c.filter(z=>!SM.has(z.type)).map(z=>wM(z.value)),x=h.flatMap(z=>z.filter(j=>!SM.has(j.type)).map(j=>wM(j.value))),T=[...new Set([..._,...x])].sort((z,j)=>j.length-z.length),I=T.length===0?new RegExp("[\\p{White_Space}]","gu"):new RegExp(`${T.join("|")}|[\\p{White_Space}]`,"gu"),C=[...new Intl.NumberFormat(r.locale,{useGrouping:!1}).format(9876543210)].reverse(),k=new Map(C.map((z,j)=>[z,j])),S=new RegExp(`[${C.join("")}]`,"g");return{minusSign:m,plusSign:g,decimal:R,group:b,literals:I,numeral:S,index:z=>String(k.get(z))}}function ah(t,e,r){return t.replaceAll?t.replaceAll(e,r):t.split(e).join(r)}function wM(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function BY(t={}){let{locale:e}=sn();return D.useMemo(()=>new tL(e,t),[e,t])}let PS=new Map;function nL(t){let{locale:e}=sn(),r=e+(t?Object.entries(t).sort((i,a)=>i[0]<a[0]?-1:1).join():"");if(PS.has(r))return PS.get(r);let n=new Intl.Collator(e,t);return PS.set(r,n),n}function NY(t){let e=nL({usage:"search",...t}),r=D.useCallback((a,o)=>o.length===0?!0:(a=a.normalize("NFC"),o=o.normalize("NFC"),e.compare(a.slice(0,o.length),o)===0),[e]),n=D.useCallback((a,o)=>o.length===0?!0:(a=a.normalize("NFC"),o=o.normalize("NFC"),e.compare(a.slice(-o.length),o)===0),[e]),i=D.useCallback((a,o)=>{if(o.length===0)return!0;a=a.normalize("NFC"),o=o.normalize("NFC");let s=0,l=o.length;for(;s+l<=a.length;s++){let c=a.slice(s,s+l);if(e.compare(o,c)===0)return!0}return!1},[e]);return D.useMemo(()=>({startsWith:r,endsWith:n,contains:i}),[r,n,i])}const Za={top:"top",bottom:"top",left:"left",right:"left"},Xy={top:"bottom",bottom:"top",left:"right",right:"left"},UY={top:"left",left:"top"},QE={top:"height",left:"width"},iL={width:"totalWidth",height:"totalHeight"},Wv={};let qr=typeof document<"u"?window.visualViewport:null;function EM(t){let e=0,r=0,n=0,i=0,a=0,o=0,s={};var l;let c=((l=qr==null?void 0:qr.scale)!==null&&l!==void 0?l:1)>1;if(t.tagName==="BODY"){let g=document.documentElement;n=g.clientWidth,i=g.clientHeight;var d;e=(d=qr==null?void 0:qr.width)!==null&&d!==void 0?d:n;var h;r=(h=qr==null?void 0:qr.height)!==null&&h!==void 0?h:i,s.top=g.scrollTop||t.scrollTop,s.left=g.scrollLeft||t.scrollLeft,qr&&(a=qr.offsetTop,o=qr.offsetLeft)}else({width:e,height:r,top:a,left:o}=hd(t)),s.top=t.scrollTop,s.left=t.scrollLeft,n=e,i=r;if(K6()&&(t.tagName==="BODY"||t.tagName==="HTML")&&c){s.top=0,s.left=0;var p;a=(p=qr==null?void 0:qr.pageTop)!==null&&p!==void 0?p:0;var m;o=(m=qr==null?void 0:qr.pageLeft)!==null&&m!==void 0?m:0}return{width:e,height:r,totalWidth:n,totalHeight:i,scroll:s,top:a,left:o}}function FY(t){return{top:t.scrollTop,left:t.scrollLeft,width:t.scrollWidth,height:t.scrollHeight}}function xM(t,e,r,n,i,a,o){var s;let l=(s=i.scroll[t])!==null&&s!==void 0?s:0,c=n[QE[t]],d=n.scroll[Za[t]]+a,h=c+n.scroll[Za[t]]-a,p=e-l+o[t]-n[Za[t]],m=e-l+r+o[t]-n[Za[t]];return p<d?d-p:m>h?Math.max(h-m,d-p):0}function jY(t){let e=window.getComputedStyle(t);return{top:parseInt(e.marginTop,10)||0,bottom:parseInt(e.marginBottom,10)||0,left:parseInt(e.marginLeft,10)||0,right:parseInt(e.marginRight,10)||0}}function CM(t){if(Wv[t])return Wv[t];let[e,r]=t.split(" "),n=Za[e]||"right",i=UY[n];Za[r]||(r="center");let a=QE[n],o=QE[i];return Wv[t]={placement:e,crossPlacement:r,axis:n,crossAxis:i,size:a,crossSize:o},Wv[t]}function AS(t,e,r,n,i,a,o,s,l,c){let{placement:d,crossPlacement:h,axis:p,crossAxis:m,size:g,crossSize:y}=n,R={};var b;R[m]=(b=t[m])!==null&&b!==void 0?b:0;var _,x,T,I;h==="center"?R[m]+=(((_=t[y])!==null&&_!==void 0?_:0)-((x=r[y])!==null&&x!==void 0?x:0))/2:h!==m&&(R[m]+=((T=t[y])!==null&&T!==void 0?T:0)-((I=r[y])!==null&&I!==void 0?I:0)),R[m]+=a;const C=t[m]-r[y]+l+c,k=t[m]+t[y]-l-c;if(R[m]=Yy(R[m],C,k),d===p){const S=s?o[g]:e[iL[g]];R[Xy[p]]=Math.floor(S-t[p]+i)}else R[p]=Math.floor(t[p]+t[g]+i);return R}function VY(t,e,r,n,i,a,o,s){const l=n?r.height:e[iL.height];var c;let d=t.top!=null?r.top+t.top:r.top+(l-((c=t.bottom)!==null&&c!==void 0?c:0)-o);var h,p,m,g,y,R;let b=s!=="top"?Math.max(0,e.height+e.top+((h=e.scroll.top)!==null&&h!==void 0?h:0)-d-(((p=i.top)!==null&&p!==void 0?p:0)+((m=i.bottom)!==null&&m!==void 0?m:0)+a)):Math.max(0,d+o-(e.top+((g=e.scroll.top)!==null&&g!==void 0?g:0))-(((y=i.top)!==null&&y!==void 0?y:0)+((R=i.bottom)!==null&&R!==void 0?R:0)+a));return Math.min(e.height-a*2,b)}function TM(t,e,r,n,i,a){let{placement:o,axis:s,size:l}=a;var c,d;if(o===s)return Math.max(0,r[s]-t[s]-((c=t.scroll[s])!==null&&c!==void 0?c:0)+e[s]-((d=n[s])!==null&&d!==void 0?d:0)-n[Xy[s]]-i);var h;return Math.max(0,t[l]+t[s]+t.scroll[s]-e[s]-r[s]-r[l]-((h=n[s])!==null&&h!==void 0?h:0)-n[Xy[s]]-i)}function zY(t,e,r,n,i,a,o,s,l,c,d,h,p,m,g,y){let R=CM(t),{size:b,crossAxis:_,crossSize:x,placement:T,crossPlacement:I}=R,C=AS(e,s,r,R,d,h,c,p,g,y),k=d,S=TM(s,c,e,i,a+d,R);if(o&&n[b]>S){let ee=CM(`${Xy[T]} ${I}`),Y=AS(e,s,r,ee,d,h,c,p,g,y);TM(s,c,e,i,a+d,ee)>S&&(R=ee,C=Y,k=d)}let V="bottom";R.axis==="top"?R.placement==="top"?V="top":R.placement==="bottom"&&(V="bottom"):R.crossAxis==="top"&&(R.crossPlacement==="top"?V="bottom":R.crossPlacement==="bottom"&&(V="top"));let z=xM(_,C[_],r[x],s,l,a,c);C[_]+=z;let j=VY(C,s,c,p,i,a,r.height,V);m&&m<j&&(j=m),r.height=Math.min(r.height,j),C=AS(e,s,r,R,k,h,c,p,g,y),z=xM(_,C[_],r[x],s,l,a,c),C[_]+=z;let J={},$=e[_]+.5*e[x]-C[_]-i[Za[_]];const le=g/2+y;var ie,Z,te,H;const fe=Za[_]==="left"?((ie=i.left)!==null&&ie!==void 0?ie:0)+((Z=i.right)!==null&&Z!==void 0?Z:0):((te=i.top)!==null&&te!==void 0?te:0)+((H=i.bottom)!==null&&H!==void 0?H:0),ne=r[x]-fe-g/2-y,he=e[_]+g/2-(C[_]+i[Za[_]]),oe=e[_]+e[x]-g/2-(C[_]+i[Za[_]]),me=Yy($,he,oe);return J[_]=Yy(me,le,ne),{position:C,maxHeight:j,arrowOffsetLeft:J.left,arrowOffsetTop:J.top,placement:R.placement}}function KY(t){let{placement:e,targetNode:r,overlayNode:n,scrollNode:i,padding:a,shouldFlip:o,boundaryElement:s,offset:l,crossOffset:c,maxHeight:d,arrowSize:h=0,arrowBoundaryOffset:p=0}=t,m=n instanceof HTMLElement?HY(n):document.documentElement,g=m===document.documentElement;const y=window.getComputedStyle(m).position;let R=!!y&&y!=="static",b=g?hd(r):DM(r,m);if(!g){let{marginTop:J,marginLeft:$}=window.getComputedStyle(r);b.top+=parseInt(J,10)||0,b.left+=parseInt($,10)||0}let _=hd(n),x=jY(n);var T,I;_.width+=((T=x.left)!==null&&T!==void 0?T:0)+((I=x.right)!==null&&I!==void 0?I:0);var C,k;_.height+=((C=x.top)!==null&&C!==void 0?C:0)+((k=x.bottom)!==null&&k!==void 0?k:0);let S=FY(i),V=EM(s),z=EM(m),j=s.tagName==="BODY"?hd(m):DM(m,s);return m.tagName==="HTML"&&s.tagName==="BODY"&&(z.scroll.top=0,z.scroll.left=0),zY(e,b,_,S,x,a,o,V,z,j,l,c,R,d,h,p)}function hd(t){let{top:e,left:r,width:n,height:i}=t.getBoundingClientRect(),{scrollTop:a,scrollLeft:o,clientTop:s,clientLeft:l}=document.documentElement;return{top:e+a-s,left:r+o-l,width:n,height:i}}function DM(t,e){let r=window.getComputedStyle(t),n;if(r.position==="fixed"){let{top:i,left:a,width:o,height:s}=t.getBoundingClientRect();n={top:i,left:a,width:o,height:s}}else{n=hd(t);let i=hd(e),a=window.getComputedStyle(e);i.top+=(parseInt(a.borderTopWidth,10)||0)-e.scrollTop,i.left+=(parseInt(a.borderLeftWidth,10)||0)-e.scrollLeft,n.top-=i.top,n.left-=i.left}return n.top-=parseInt(r.marginTop,10)||0,n.left-=parseInt(r.marginLeft,10)||0,n}function HY(t){let e=t.offsetParent;if(e&&e===document.body&&window.getComputedStyle(e).position==="static"&&!RM(e)&&(e=document.documentElement),e==null)for(e=t.parentElement;e&&!RM(e);)e=e.parentElement;return e||document.documentElement}function RM(t){let e=window.getComputedStyle(t);return e.transform!=="none"||/transform|perspective/.test(e.willChange)||e.filter!=="none"||e.contain==="paint"||"backdropFilter"in e&&e.backdropFilter!=="none"||"WebkitBackdropFilter"in e&&e.WebkitBackdropFilter!=="none"}const aL=new WeakMap;function WY(t){let{triggerRef:e,isOpen:r,onClose:n}=t;D.useEffect(()=>{if(!r||n===null)return;let i=a=>{let o=a.target;if(!e.current||o instanceof Node&&!o.contains(e.current)||a.target instanceof HTMLInputElement||a.target instanceof HTMLTextAreaElement)return;let s=n||aL.get(e.current);s&&s()};return window.addEventListener("scroll",i,!0),()=>{window.removeEventListener("scroll",i,!0)}},[r,n,e])}let xr=typeof document<"u"?window.visualViewport:null;function GY(t){let{direction:e}=sn(),{arrowSize:r=0,targetRef:n,overlayRef:i,scrollRef:a=i,placement:o="bottom",containerPadding:s=12,shouldFlip:l=!0,boundaryElement:c=typeof document<"u"?document.body:null,offset:d=0,crossOffset:h=0,shouldUpdatePosition:p=!0,isOpen:m=!0,onClose:g,maxHeight:y,arrowBoundaryOffset:R=0}=t,[b,_]=D.useState(null),x=[p,o,i.current,n.current,a.current,s,l,c,d,h,m,e,y,R,r],T=D.useRef(xr==null?void 0:xr.scale);D.useEffect(()=>{m&&(T.current=xr==null?void 0:xr.scale)},[m]);let I=D.useCallback(()=>{if(p===!1||!m||!i.current||!n.current||!c||(xr==null?void 0:xr.scale)!==T.current)return;let z=null;if(a.current&&a.current.contains(document.activeElement)){var j;let H=(j=document.activeElement)===null||j===void 0?void 0:j.getBoundingClientRect(),fe=a.current.getBoundingClientRect();var J;if(z={type:"top",offset:((J=H==null?void 0:H.top)!==null&&J!==void 0?J:0)-fe.top},z.offset>fe.height/2){z.type="bottom";var $;z.offset=(($=H==null?void 0:H.bottom)!==null&&$!==void 0?$:0)-fe.bottom}}let le=i.current;if(!y&&i.current){var ie;le.style.top="0px",le.style.bottom="";var Z;le.style.maxHeight=((Z=(ie=window.visualViewport)===null||ie===void 0?void 0:ie.height)!==null&&Z!==void 0?Z:window.innerHeight)+"px"}let te=KY({placement:ZY(o,e),overlayNode:i.current,targetNode:n.current,scrollNode:a.current||i.current,padding:s,shouldFlip:l,boundaryElement:c,offset:d,crossOffset:h,maxHeight:y,arrowSize:r,arrowBoundaryOffset:R});if(te.position){if(le.style.top="",le.style.bottom="",le.style.left="",le.style.right="",Object.keys(te.position).forEach(H=>le.style[H]=te.position[H]+"px"),le.style.maxHeight=te.maxHeight!=null?te.maxHeight+"px":"",z&&document.activeElement&&a.current){let H=document.activeElement.getBoundingClientRect(),fe=a.current.getBoundingClientRect(),ne=H[z.type]-fe[z.type];a.current.scrollTop+=ne-z.offset}_(te)}},x);qt(I,x),qY(I),vM({ref:i,onResize:I}),vM({ref:n,onResize:I});let C=D.useRef(!1);qt(()=>{let z,j=()=>{C.current=!0,clearTimeout(z),z=setTimeout(()=>{C.current=!1},500),I()},J=()=>{C.current&&j()};return xr==null||xr.addEventListener("resize",j),xr==null||xr.addEventListener("scroll",J),()=>{xr==null||xr.removeEventListener("resize",j),xr==null||xr.removeEventListener("scroll",J)}},[I]);let k=D.useCallback(()=>{C.current||g==null||g()},[g,C]);WY({triggerRef:n,isOpen:m,onClose:g&&k});var S,V;return{overlayProps:{style:{position:"absolute",zIndex:1e5,...b==null?void 0:b.position,maxHeight:(S=b==null?void 0:b.maxHeight)!==null&&S!==void 0?S:"100vh"}},placement:(V=b==null?void 0:b.placement)!==null&&V!==void 0?V:null,arrowProps:{"aria-hidden":"true",role:"presentation",style:{left:b==null?void 0:b.arrowOffsetLeft,top:b==null?void 0:b.arrowOffsetTop}},updatePosition:I}}function qY(t){qt(()=>(window.addEventListener("resize",t,!1),()=>{window.removeEventListener("resize",t,!1)}),[t])}function ZY(t,e){return e==="rtl"?t.replace("start","right").replace("end","left"):t.replace("start","left").replace("end","right")}function YY(t){const e=_i(t);if(!(t instanceof e.HTMLElement)&&!(t instanceof e.SVGElement))return!1;let{display:r,visibility:n}=t.style,i=r!=="none"&&n!=="hidden"&&n!=="collapse";if(i){const{getComputedStyle:a}=t.ownerDocument.defaultView;let{display:o,visibility:s}=a(t);i=o!=="none"&&s!=="hidden"&&s!=="collapse"}return i}function JY(t,e){return!t.hasAttribute("hidden")&&!t.hasAttribute("data-react-aria-prevent-focus")&&(t.nodeName==="DETAILS"&&e&&e.nodeName!=="SUMMARY"?t.hasAttribute("open"):!0)}function oL(t,e){return t.nodeName!=="#comment"&&YY(t)&&JY(t,e)&&(!t.parentElement||oL(t.parentElement,t))}let Zc="default",e1="",Fg=new WeakMap;function MM(t){if(Hu()){if(Zc==="default"){const e=Ot(t);e1=e.documentElement.style.webkitUserSelect,e.documentElement.style.webkitUserSelect="none"}Zc="disabled"}else if(t instanceof HTMLElement||t instanceof SVGElement){let e="userSelect"in t.style?"userSelect":"webkitUserSelect";Fg.set(t,t.style[e]),t.style[e]="none"}}function kS(t){if(Hu()){if(Zc!=="disabled")return;Zc="restoring",setTimeout(()=>{q6(()=>{if(Zc==="restoring"){const e=Ot(t);e.documentElement.style.webkitUserSelect==="none"&&(e.documentElement.style.webkitUserSelect=e1||""),e1="",Zc="default"}})},300)}else if((t instanceof HTMLElement||t instanceof SVGElement)&&t&&Fg.has(t)){let e=Fg.get(t),r="userSelect"in t.style?"userSelect":"webkitUserSelect";t.style[r]==="none"&&(t.style[r]=e),t.getAttribute("style")===""&&t.removeAttribute("style"),Fg.delete(t)}}const $T=We.createContext({register:()=>{}});$T.displayName="PressResponderContext";class sL{isDefaultPrevented(){return this.nativeEvent.defaultPrevented}preventDefault(){this.defaultPrevented=!0,this.nativeEvent.preventDefault()}stopPropagation(){this.nativeEvent.stopPropagation(),this.isPropagationStopped=()=>!0}isPropagationStopped(){return!1}persist(){}constructor(e,r){this.nativeEvent=r,this.target=r.target,this.currentTarget=r.currentTarget,this.relatedTarget=r.relatedTarget,this.bubbles=r.bubbles,this.cancelable=r.cancelable,this.defaultPrevented=r.defaultPrevented,this.eventPhase=r.eventPhase,this.isTrusted=r.isTrusted,this.timeStamp=r.timeStamp,this.type=e}}function lL(t){let e=D.useRef({isFocused:!1,observer:null});qt(()=>{const n=e.current;return()=>{n.observer&&(n.observer.disconnect(),n.observer=null)}},[]);let r=rn(n=>{t==null||t(n)});return D.useCallback(n=>{if(n.target instanceof HTMLButtonElement||n.target instanceof HTMLInputElement||n.target instanceof HTMLTextAreaElement||n.target instanceof HTMLSelectElement){e.current.isFocused=!0;let i=n.target,a=o=>{e.current.isFocused=!1,i.disabled&&r(new sL("blur",o)),e.current.observer&&(e.current.observer.disconnect(),e.current.observer=null)};i.addEventListener("focusout",a,{once:!0}),e.current.observer=new MutationObserver(()=>{if(e.current.isFocused&&i.disabled){var o;(o=e.current.observer)===null||o===void 0||o.disconnect();let s=i===document.activeElement?null:document.activeElement;i.dispatchEvent(new FocusEvent("blur",{relatedTarget:s})),i.dispatchEvent(new FocusEvent("focusout",{bubbles:!0,relatedTarget:s}))}}),e.current.observer.observe(i,{attributes:!0,attributeFilter:["disabled"]})}},[r])}let Qy=!1;function IM(t){for(;t&&!Q6(t);)t=t.parentElement;let e=_i(t),r=e.document.activeElement;if(!r||r===t)return;Qy=!0;let n=!1,i=d=>{(d.target===r||n)&&d.stopImmediatePropagation()},a=d=>{(d.target===r||n)&&(d.stopImmediatePropagation(),!t&&!n&&(n=!0,wn(r),l()))},o=d=>{(d.target===t||n)&&d.stopImmediatePropagation()},s=d=>{(d.target===t||n)&&(d.stopImmediatePropagation(),n||(n=!0,wn(r),l()))};e.addEventListener("blur",i,!0),e.addEventListener("focusout",a,!0),e.addEventListener("focusin",s,!0),e.addEventListener("focus",o,!0);let l=()=>{cancelAnimationFrame(c),e.removeEventListener("blur",i,!0),e.removeEventListener("focusout",a,!0),e.removeEventListener("focusin",s,!0),e.removeEventListener("focus",o,!0),Qy=!1,n=!1},c=requestAnimationFrame(l);return l}function XY(t,e){return e.get?e.get.call(t):e.value}function uL(t,e,r){if(!e.has(t))throw new TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}function QY(t,e){var r=uL(t,e,"get");return XY(t,r)}function eJ(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=r}}function PM(t,e,r){var n=uL(t,e,"set");return eJ(t,n,r),r}function tJ(t){let e=D.useContext($T);if(e){let{register:r,...n}=e;t=Oe(n,t),r()}return Z6(e,t.ref),t}var Gv=new WeakMap;class qv{continuePropagation(){PM(this,Gv,!1)}get shouldStopPropagation(){return QY(this,Gv)}constructor(e,r,n,i){Im(this,Gv,{writable:!0,value:void 0}),PM(this,Gv,!0);var a;let o=(a=i==null?void 0:i.target)!==null&&a!==void 0?a:n.currentTarget;const s=o==null?void 0:o.getBoundingClientRect();let l,c=0,d,h=null;n.clientX!=null&&n.clientY!=null&&(d=n.clientX,h=n.clientY),s&&(d!=null&&h!=null?(l=d-s.left,c=h-s.top):(l=s.width/2,c=s.height/2)),this.type=e,this.pointerType=r,this.target=n.currentTarget,this.shiftKey=n.shiftKey,this.metaKey=n.metaKey,this.ctrlKey=n.ctrlKey,this.altKey=n.altKey,this.x=l,this.y=c}}const AM=Symbol("linkClicked");function is(t){let{onPress:e,onPressChange:r,onPressStart:n,onPressEnd:i,onPressUp:a,isDisabled:o,isPressed:s,preventFocusOnPress:l,shouldCancelOnPointerExit:c,allowTextSelectionOnPress:d,ref:h,...p}=tJ(t),[m,g]=D.useState(!1),y=D.useRef({isPressed:!1,ignoreEmulatedMouseEvents:!1,didFirePressStart:!1,isTriggeringEvent:!1,activePointerId:null,target:null,isOverTarget:!1,pointerType:null,disposables:[]}),{addGlobalListener:R,removeAllGlobalListeners:b}=yb(),_=rn((S,V)=>{let z=y.current;if(o||z.didFirePressStart)return!1;let j=!0;if(z.isTriggeringEvent=!0,n){let J=new qv("pressstart",V,S);n(J),j=J.shouldStopPropagation}return r&&r(!0),z.isTriggeringEvent=!1,z.didFirePressStart=!0,g(!0),j}),x=rn((S,V,z=!0)=>{let j=y.current;if(!j.didFirePressStart)return!1;j.didFirePressStart=!1,j.isTriggeringEvent=!0;let J=!0;if(i){let $=new qv("pressend",V,S);i($),J=$.shouldStopPropagation}if(r&&r(!1),g(!1),e&&z&&!o){let $=new qv("press",V,S);e($),J&&(J=$.shouldStopPropagation)}return j.isTriggeringEvent=!1,J}),T=rn((S,V)=>{let z=y.current;if(o)return!1;if(a){z.isTriggeringEvent=!0;let j=new qv("pressup",V,S);return a(j),z.isTriggeringEvent=!1,j.shouldStopPropagation}return!0}),I=rn(S=>{let V=y.current;if(V.isPressed&&V.target){V.didFirePressStart&&V.pointerType!=null&&x(mc(V.target,S),V.pointerType,!1),V.isPressed=!1,V.isOverTarget=!1,V.activePointerId=null,V.pointerType=null,b(),d||kS(V.target);for(let z of V.disposables)z();V.disposables=[]}}),C=rn(S=>{c&&I(S)}),k=D.useMemo(()=>{let S=y.current,V={onKeyDown(j){if(OS(j.nativeEvent,j.currentTarget)&&or(j.currentTarget,Pt(j.nativeEvent))){var J;$M(Pt(j.nativeEvent),j.key)&&j.preventDefault();let $=!0;if(!S.isPressed&&!j.repeat){S.target=j.currentTarget,S.isPressed=!0,S.pointerType="keyboard",$=_(j,"keyboard");let le=j.currentTarget,ie=Z=>{OS(Z,le)&&!Z.repeat&&or(le,Pt(Z))&&S.target&&T(mc(S.target,Z),"keyboard")};R(Ot(j.currentTarget),"keyup",Tn(ie,z),!0)}$&&j.stopPropagation(),j.metaKey&&cl()&&((J=S.metaKeyEvents)===null||J===void 0||J.set(j.key,j.nativeEvent))}else j.key==="Meta"&&(S.metaKeyEvents=new Map)},onClick(j){if(!(j&&!or(j.currentTarget,Pt(j.nativeEvent)))&&j&&j.button===0&&!S.isTriggeringEvent&&!dl.isOpening){let J=!0;if(o&&j.preventDefault(),!S.ignoreEmulatedMouseEvents&&!S.isPressed&&(S.pointerType==="virtual"||JE(j.nativeEvent))){let $=_(j,"virtual"),le=T(j,"virtual"),ie=x(j,"virtual");J=$&&le&&ie}else if(S.isPressed&&S.pointerType!=="keyboard"){let $=S.pointerType||j.nativeEvent.pointerType||"virtual";J=x(mc(j.currentTarget,j),$,!0),S.isOverTarget=!1,I(j)}S.ignoreEmulatedMouseEvents=!1,J&&j.stopPropagation()}}},z=j=>{var J;if(S.isPressed&&S.target&&OS(j,S.target)){var $;$M(Pt(j),j.key)&&j.preventDefault();let ie=Pt(j);x(mc(S.target,j),"keyboard",or(S.target,Pt(j))),b(),j.key!=="Enter"&&LT(S.target)&&or(S.target,ie)&&!j[AM]&&(j[AM]=!0,dl(S.target,j,!1)),S.isPressed=!1,($=S.metaKeyEvents)===null||$===void 0||$.delete(j.key)}else if(j.key==="Meta"&&(!((J=S.metaKeyEvents)===null||J===void 0)&&J.size)){var le;let ie=S.metaKeyEvents;S.metaKeyEvents=void 0;for(let Z of ie.values())(le=S.target)===null||le===void 0||le.dispatchEvent(new KeyboardEvent("keyup",Z))}};if(typeof PointerEvent<"u"){V.onPointerDown=$=>{if($.button!==0||!or($.currentTarget,Pt($.nativeEvent)))return;if(EY($.nativeEvent)){S.pointerType="virtual";return}S.pointerType=$.pointerType;let le=!0;if(!S.isPressed){S.isPressed=!0,S.isOverTarget=!0,S.activePointerId=$.pointerId,S.target=$.currentTarget,d||MM(S.target),le=_($,S.pointerType);let ie=Pt($.nativeEvent);"releasePointerCapture"in ie&&ie.releasePointerCapture($.pointerId),R(Ot($.currentTarget),"pointerup",j,!1),R(Ot($.currentTarget),"pointercancel",J,!1)}le&&$.stopPropagation()},V.onMouseDown=$=>{if(or($.currentTarget,Pt($.nativeEvent))&&$.button===0){if(l){let le=IM($.target);le&&S.disposables.push(le)}$.stopPropagation()}},V.onPointerUp=$=>{!or($.currentTarget,Pt($.nativeEvent))||S.pointerType==="virtual"||$.button===0&&T($,S.pointerType||$.pointerType)},V.onPointerEnter=$=>{$.pointerId===S.activePointerId&&S.target&&!S.isOverTarget&&S.pointerType!=null&&(S.isOverTarget=!0,_(mc(S.target,$),S.pointerType))},V.onPointerLeave=$=>{$.pointerId===S.activePointerId&&S.target&&S.isOverTarget&&S.pointerType!=null&&(S.isOverTarget=!1,x(mc(S.target,$),S.pointerType,!1),C($))};let j=$=>{if($.pointerId===S.activePointerId&&S.isPressed&&$.button===0&&S.target){if(or(S.target,Pt($))&&S.pointerType!=null){let le=!1,ie=setTimeout(()=>{S.isPressed&&S.target instanceof HTMLElement&&(le?I($):(wn(S.target),S.target.click()))},80);R($.currentTarget,"click",()=>le=!0,!0),S.disposables.push(()=>clearTimeout(ie))}else I($);S.isOverTarget=!1}},J=$=>{I($)};V.onDragStart=$=>{or($.currentTarget,Pt($.nativeEvent))&&I($)}}else{V.onMouseDown=$=>{if($.button!==0||!or($.currentTarget,Pt($.nativeEvent)))return;if(S.ignoreEmulatedMouseEvents){$.stopPropagation();return}if(S.isPressed=!0,S.isOverTarget=!0,S.target=$.currentTarget,S.pointerType=JE($.nativeEvent)?"virtual":"mouse",G0.flushSync(()=>_($,S.pointerType))&&$.stopPropagation(),l){let ie=IM($.target);ie&&S.disposables.push(ie)}R(Ot($.currentTarget),"mouseup",j,!1)},V.onMouseEnter=$=>{if(!or($.currentTarget,Pt($.nativeEvent)))return;let le=!0;S.isPressed&&!S.ignoreEmulatedMouseEvents&&S.pointerType!=null&&(S.isOverTarget=!0,le=_($,S.pointerType)),le&&$.stopPropagation()},V.onMouseLeave=$=>{if(!or($.currentTarget,Pt($.nativeEvent)))return;let le=!0;S.isPressed&&!S.ignoreEmulatedMouseEvents&&S.pointerType!=null&&(S.isOverTarget=!1,le=x($,S.pointerType,!1),C($)),le&&$.stopPropagation()},V.onMouseUp=$=>{or($.currentTarget,Pt($.nativeEvent))&&!S.ignoreEmulatedMouseEvents&&$.button===0&&T($,S.pointerType||"mouse")};let j=$=>{if($.button===0){if(S.ignoreEmulatedMouseEvents){S.ignoreEmulatedMouseEvents=!1;return}S.target&&S.target.contains($.target)&&S.pointerType!=null||I($),S.isOverTarget=!1}};V.onTouchStart=$=>{if(!or($.currentTarget,Pt($.nativeEvent)))return;let le=rJ($.nativeEvent);if(!le)return;S.activePointerId=le.identifier,S.ignoreEmulatedMouseEvents=!0,S.isOverTarget=!0,S.isPressed=!0,S.target=$.currentTarget,S.pointerType="touch",d||MM(S.target),_(ps(S.target,$),S.pointerType)&&$.stopPropagation(),R(_i($.currentTarget),"scroll",J,!0)},V.onTouchMove=$=>{if(!or($.currentTarget,Pt($.nativeEvent)))return;if(!S.isPressed){$.stopPropagation();return}let le=kM($.nativeEvent,S.activePointerId),ie=!0;le&&OM(le,$.currentTarget)?!S.isOverTarget&&S.pointerType!=null&&(S.isOverTarget=!0,ie=_(ps(S.target,$),S.pointerType)):S.isOverTarget&&S.pointerType!=null&&(S.isOverTarget=!1,ie=x(ps(S.target,$),S.pointerType,!1),C(ps(S.target,$))),ie&&$.stopPropagation()},V.onTouchEnd=$=>{if(!or($.currentTarget,Pt($.nativeEvent)))return;if(!S.isPressed){$.stopPropagation();return}let le=kM($.nativeEvent,S.activePointerId),ie=!0;le&&OM(le,$.currentTarget)&&S.pointerType!=null?(T(ps(S.target,$),S.pointerType),ie=x(ps(S.target,$),S.pointerType)):S.isOverTarget&&S.pointerType!=null&&(ie=x(ps(S.target,$),S.pointerType,!1)),ie&&$.stopPropagation(),S.isPressed=!1,S.activePointerId=null,S.isOverTarget=!1,S.ignoreEmulatedMouseEvents=!0,S.target&&!d&&kS(S.target),b()},V.onTouchCancel=$=>{or($.currentTarget,Pt($.nativeEvent))&&($.stopPropagation(),S.isPressed&&I(ps(S.target,$)))};let J=$=>{S.isPressed&&or(Pt($),S.target)&&I({currentTarget:S.target,shiftKey:!1,ctrlKey:!1,metaKey:!1,altKey:!1})};V.onDragStart=$=>{or($.currentTarget,Pt($.nativeEvent))&&I($)}}return V},[R,o,l,b,d,I,C,x,_,T]);return D.useEffect(()=>{let S=y.current;return()=>{var V;d||kS((V=S.target)!==null&&V!==void 0?V:void 0);for(let z of S.disposables)z();S.disposables=[]}},[d]),{isPressed:s||m,pressProps:Oe(p,k)}}function LT(t){return t.tagName==="A"&&t.hasAttribute("href")}function OS(t,e){const{key:r,code:n}=t,i=e,a=i.getAttribute("role");return(r==="Enter"||r===" "||r==="Spacebar"||n==="Space")&&!(i instanceof _i(i).HTMLInputElement&&!cL(i,r)||i instanceof _i(i).HTMLTextAreaElement||i.isContentEditable)&&!((a==="link"||!a&&LT(i))&&r!=="Enter")}function rJ(t){const{targetTouches:e}=t;return e.length>0?e[0]:null}function kM(t,e){const r=t.changedTouches;for(let n=0;n<r.length;n++){const i=r[n];if(i.identifier===e)return i}return null}function ps(t,e){let r=0,n=0;return e.targetTouches&&e.targetTouches.length===1&&(r=e.targetTouches[0].clientX,n=e.targetTouches[0].clientY),{currentTarget:t,shiftKey:e.shiftKey,ctrlKey:e.ctrlKey,metaKey:e.metaKey,altKey:e.altKey,clientX:r,clientY:n}}function mc(t,e){let r=e.clientX,n=e.clientY;return{currentTarget:t,shiftKey:e.shiftKey,ctrlKey:e.ctrlKey,metaKey:e.metaKey,altKey:e.altKey,clientX:r,clientY:n}}function nJ(t){let e=0,r=0;return t.width!==void 0?e=t.width/2:t.radiusX!==void 0&&(e=t.radiusX),t.height!==void 0?r=t.height/2:t.radiusY!==void 0&&(r=t.radiusY),{top:t.clientY-r,right:t.clientX+e,bottom:t.clientY+r,left:t.clientX-e}}function iJ(t,e){return!(t.left>e.right||e.left>t.right||t.top>e.bottom||e.top>t.bottom)}function OM(t,e){let r=e.getBoundingClientRect(),n=nJ(t);return iJ(r,n)}function aJ(t){return t instanceof HTMLInputElement?!1:t instanceof HTMLButtonElement?t.type!=="submit"&&t.type!=="reset":!LT(t)}function $M(t,e){return t instanceof HTMLInputElement?!cL(t,e):aJ(t)}const oJ=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]);function cL(t,e){return t.type==="checkbox"||t.type==="radio"?e===" ":oJ.has(t.type)}let Wu=null,t1=new Set,np=new Map,Ru=!1,r1=!1;const sJ={Tab:!0,Escape:!0};function Sb(t,e){for(let r of t1)r(t,e)}function lJ(t){return!(t.metaKey||!cl()&&t.altKey||t.ctrlKey||t.key==="Control"||t.key==="Shift"||t.key==="Meta")}function e0(t){Ru=!0,lJ(t)&&(Wu="keyboard",Sb("keyboard",t))}function Zi(t){Wu="pointer",(t.type==="mousedown"||t.type==="pointerdown")&&(Ru=!0,Sb("pointer",t))}function dL(t){JE(t)&&(Ru=!0,Wu="virtual")}function fL(t){t.target===window||t.target===document||Qy||!t.isTrusted||(!Ru&&!r1&&(Wu="virtual",Sb("virtual",t)),Ru=!1,r1=!1)}function hL(){Qy||(Ru=!1,r1=!0)}function n1(t){if(typeof window>"u"||np.get(_i(t)))return;const e=_i(t),r=Ot(t);let n=e.HTMLElement.prototype.focus;e.HTMLElement.prototype.focus=function(){Ru=!0,n.apply(this,arguments)},r.addEventListener("keydown",e0,!0),r.addEventListener("keyup",e0,!0),r.addEventListener("click",dL,!0),e.addEventListener("focus",fL,!0),e.addEventListener("blur",hL,!1),typeof PointerEvent<"u"?(r.addEventListener("pointerdown",Zi,!0),r.addEventListener("pointermove",Zi,!0),r.addEventListener("pointerup",Zi,!0)):(r.addEventListener("mousedown",Zi,!0),r.addEventListener("mousemove",Zi,!0),r.addEventListener("mouseup",Zi,!0)),e.addEventListener("beforeunload",()=>{pL(t)},{once:!0}),np.set(e,{focus:n})}const pL=(t,e)=>{const r=_i(t),n=Ot(t);e&&n.removeEventListener("DOMContentLoaded",e),np.has(r)&&(r.HTMLElement.prototype.focus=np.get(r).focus,n.removeEventListener("keydown",e0,!0),n.removeEventListener("keyup",e0,!0),n.removeEventListener("click",dL,!0),r.removeEventListener("focus",fL,!0),r.removeEventListener("blur",hL,!1),typeof PointerEvent<"u"?(n.removeEventListener("pointerdown",Zi,!0),n.removeEventListener("pointermove",Zi,!0),n.removeEventListener("pointerup",Zi,!0)):(n.removeEventListener("mousedown",Zi,!0),n.removeEventListener("mousemove",Zi,!0),n.removeEventListener("mouseup",Zi,!0)),np.delete(r))};function uJ(t){const e=Ot(t);let r;return e.readyState!=="loading"?n1(t):(r=()=>{n1(t)},e.addEventListener("DOMContentLoaded",r)),()=>pL(t,r)}typeof document<"u"&&uJ();function Vd(){return Wu!=="pointer"}function il(){return Wu}function cJ(t){Wu=t,Sb(t,null)}const dJ=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]);function fJ(t,e,r){let n=Ot(r==null?void 0:r.target);const i=typeof window<"u"?_i(r==null?void 0:r.target).HTMLInputElement:HTMLInputElement,a=typeof window<"u"?_i(r==null?void 0:r.target).HTMLTextAreaElement:HTMLTextAreaElement,o=typeof window<"u"?_i(r==null?void 0:r.target).HTMLElement:HTMLElement,s=typeof window<"u"?_i(r==null?void 0:r.target).KeyboardEvent:KeyboardEvent;return t=t||n.activeElement instanceof i&&!dJ.has(n.activeElement.type)||n.activeElement instanceof a||n.activeElement instanceof o&&n.activeElement.isContentEditable,!(t&&e==="keyboard"&&r instanceof s&&!sJ[r.key])}function mL(t,e,r){n1(),D.useEffect(()=>{let n=(i,a)=>{fJ(!!(r!=null&&r.isTextInput),i,a)&&t(Vd())};return t1.add(n),()=>{t1.delete(n)}},e)}function Mu(t){const e=Ot(t),r=vn(e);if(il()==="virtual"){let n=r;q6(()=>{vn(e)===n&&t.isConnected&&wn(t)})}else wn(t)}function wb(t){let{isDisabled:e,onFocus:r,onBlur:n,onFocusChange:i}=t;const a=D.useCallback(l=>{if(l.target===l.currentTarget)return n&&n(l),i&&i(!1),!0},[n,i]),o=lL(a),s=D.useCallback(l=>{const c=Ot(l.target),d=c?vn(c):vn();l.target===l.currentTarget&&d===Pt(l.nativeEvent)&&(r&&r(l),i&&i(!0),o(l))},[i,r,o]);return{focusProps:{onFocus:!e&&(r||i||n)?s:void 0,onBlur:!e&&(n||i)?a:void 0}}}function LM(t){if(!t)return;let e=!0;return r=>{let n={...r,preventDefault(){r.preventDefault()},isDefaultPrevented(){return r.isDefaultPrevented()},stopPropagation(){e?console.error("stopPropagation is now the default behavior for events in React Spectrum. You can use continuePropagation() to revert this behavior."):e=!0},continuePropagation(){e=!1},isPropagationStopped(){return e}};t(n),e&&r.stopPropagation()}}function vL(t){return{keyboardProps:t.isDisabled?{}:{onKeyDown:LM(t.onKeyDown),onKeyUp:LM(t.onKeyUp)}}}let hJ=We.createContext(null);function pJ(t){let e=D.useContext(hJ)||{};Z6(e,t);let{ref:r,...n}=e;return n}function BT(t,e){let{focusProps:r}=wb(t),{keyboardProps:n}=vL(t),i=Oe(r,n),a=pJ(e),o=t.isDisabled?{}:a,s=D.useRef(t.autoFocus);D.useEffect(()=>{s.current&&e.current&&Mu(e.current),s.current=!1},[e]);let l=t.excludeFromTabOrder?-1:0;return t.isDisabled&&(l=void 0),{focusableProps:Oe({...i,tabIndex:l},o)}}function mJ({children:t}){let e=D.useMemo(()=>({register:()=>{}}),[]);return We.createElement($T.Provider,{value:e},t)}function wl(t){let{isDisabled:e,onBlurWithin:r,onFocusWithin:n,onFocusWithinChange:i}=t,a=D.useRef({isFocusWithin:!1}),{addGlobalListener:o,removeAllGlobalListeners:s}=yb(),l=D.useCallback(h=>{h.currentTarget.contains(h.target)&&a.current.isFocusWithin&&!h.currentTarget.contains(h.relatedTarget)&&(a.current.isFocusWithin=!1,s(),r&&r(h),i&&i(!1))},[r,i,a,s]),c=lL(l),d=D.useCallback(h=>{if(!h.currentTarget.contains(h.target))return;const p=Ot(h.target),m=vn(p);if(!a.current.isFocusWithin&&m===Pt(h.nativeEvent)){n&&n(h),i&&i(!0),a.current.isFocusWithin=!0,c(h);let g=h.currentTarget;o(p,"focus",y=>{if(a.current.isFocusWithin&&!or(g,y.target)){let R=new sL("blur",new p.defaultView.FocusEvent("blur",{relatedTarget:y.target}));R.target=g,R.currentTarget=g,l(R)}},{capture:!0})}},[n,i,c,o,l]);return e?{focusWithinProps:{onFocus:void 0,onBlur:void 0}}:{focusWithinProps:{onFocus:d,onBlur:l}}}let t0=!1,$S=0;function i1(){t0=!0,setTimeout(()=>{t0=!1},50)}function BM(t){t.pointerType==="touch"&&i1()}function vJ(){if(!(typeof document>"u"))return typeof PointerEvent<"u"?document.addEventListener("pointerup",BM):document.addEventListener("touchend",i1),$S++,()=>{$S--,!($S>0)&&(typeof PointerEvent<"u"?document.removeEventListener("pointerup",BM):document.removeEventListener("touchend",i1))}}function aa(t){let{onHoverStart:e,onHoverChange:r,onHoverEnd:n,isDisabled:i}=t,[a,o]=D.useState(!1),s=D.useRef({isHovered:!1,ignoreEmulatedMouseEvents:!1,pointerType:"",target:null}).current;D.useEffect(vJ,[]);let{addGlobalListener:l,removeAllGlobalListeners:c}=yb(),{hoverProps:d,triggerHoverEnd:h}=D.useMemo(()=>{let p=(y,R)=>{if(s.pointerType=R,i||R==="touch"||s.isHovered||!y.currentTarget.contains(y.target))return;s.isHovered=!0;let b=y.currentTarget;s.target=b,l(Ot(y.target),"pointerover",_=>{s.isHovered&&s.target&&!or(s.target,_.target)&&m(_,_.pointerType)},{capture:!0}),e&&e({type:"hoverstart",target:b,pointerType:R}),r&&r(!0),o(!0)},m=(y,R)=>{let b=s.target;s.pointerType="",s.target=null,!(R==="touch"||!s.isHovered||!b)&&(s.isHovered=!1,c(),n&&n({type:"hoverend",target:b,pointerType:R}),r&&r(!1),o(!1))},g={};return typeof PointerEvent<"u"?(g.onPointerEnter=y=>{t0&&y.pointerType==="mouse"||p(y,y.pointerType)},g.onPointerLeave=y=>{!i&&y.currentTarget.contains(y.target)&&m(y,y.pointerType)}):(g.onTouchStart=()=>{s.ignoreEmulatedMouseEvents=!0},g.onMouseEnter=y=>{!s.ignoreEmulatedMouseEvents&&!t0&&p(y,"mouse"),s.ignoreEmulatedMouseEvents=!1},g.onMouseLeave=y=>{!i&&y.currentTarget.contains(y.target)&&m(y,"mouse")}),{hoverProps:g,triggerHoverEnd:m}},[e,r,n,i,s,l,c]);return D.useEffect(()=>{i&&h({currentTarget:s.target},s.pointerType)},[i]),{hoverProps:d,isHovered:a}}function gJ(t){let{ref:e,onInteractOutside:r,isDisabled:n,onInteractOutsideStart:i}=t,a=D.useRef({isPointerDown:!1,ignoreEmulatedMouseEvents:!1}),o=rn(l=>{r&&Zv(l,e)&&(i&&i(l),a.current.isPointerDown=!0)}),s=rn(l=>{r&&r(l)});D.useEffect(()=>{let l=a.current;if(n)return;const c=e.current,d=Ot(c);if(typeof PointerEvent<"u"){let h=p=>{l.isPointerDown&&Zv(p,e)&&s(p),l.isPointerDown=!1};return d.addEventListener("pointerdown",o,!0),d.addEventListener("pointerup",h,!0),()=>{d.removeEventListener("pointerdown",o,!0),d.removeEventListener("pointerup",h,!0)}}else{let h=m=>{l.ignoreEmulatedMouseEvents?l.ignoreEmulatedMouseEvents=!1:l.isPointerDown&&Zv(m,e)&&s(m),l.isPointerDown=!1},p=m=>{l.ignoreEmulatedMouseEvents=!0,l.isPointerDown&&Zv(m,e)&&s(m),l.isPointerDown=!1};return d.addEventListener("mousedown",o,!0),d.addEventListener("mouseup",h,!0),d.addEventListener("touchstart",o,!0),d.addEventListener("touchend",p,!0),()=>{d.removeEventListener("mousedown",o,!0),d.removeEventListener("mouseup",h,!0),d.removeEventListener("touchstart",o,!0),d.removeEventListener("touchend",p,!0)}}},[e,n,o,s])}function Zv(t,e){if(t.button>0)return!1;if(t.target){const r=t.target.ownerDocument;if(!r||!r.documentElement.contains(t.target)||t.target.closest("[data-react-aria-top-layer]"))return!1}return e.current?!t.composedPath().includes(e.current):!1}const yJ=500;function gL(t){let{isDisabled:e,onLongPressStart:r,onLongPressEnd:n,onLongPress:i,threshold:a=yJ,accessibilityDescription:o}=t;const s=D.useRef(void 0);let{addGlobalListener:l,removeGlobalListener:c}=yb(),{pressProps:d}=is({isDisabled:e,onPressStart(p){if(p.continuePropagation(),(p.pointerType==="mouse"||p.pointerType==="touch")&&(r&&r({...p,type:"longpressstart"}),s.current=setTimeout(()=>{p.target.dispatchEvent(new PointerEvent("pointercancel",{bubbles:!0})),Ot(p.target).activeElement!==p.target&&wn(p.target),i&&i({...p,type:"longpress"}),s.current=void 0},a),p.pointerType==="touch")){let m=g=>{g.preventDefault()};l(p.target,"contextmenu",m,{once:!0}),l(window,"pointerup",()=>{setTimeout(()=>{c(p.target,"contextmenu",m)},30)},{once:!0})}},onPressEnd(p){s.current&&clearTimeout(s.current),n&&(p.pointerType==="mouse"||p.pointerType==="touch")&&n({...p,type:"longpressend"})}}),h=_b(i&&!e?o:void 0);return{longPressProps:Oe(d,h)}}const NM=We.createContext(null),a1="react-aria-focus-scope-restore";let Yt=null;function yL(t){let{children:e,contain:r,restoreFocus:n,autoFocus:i}=t,a=D.useRef(null),o=D.useRef(null),s=D.useRef([]),{parentNode:l}=D.useContext(NM)||{},c=D.useMemo(()=>new s1({scopeRef:s}),[s]);qt(()=>{let p=l||kr.root;if(kr.getTreeNode(p.scopeRef)&&Yt&&!r0(Yt,p.scopeRef)){let m=kr.getTreeNode(Yt);m&&(p=m)}p.addChild(c),kr.addNode(c)},[c,l]),qt(()=>{let p=kr.getTreeNode(s);p&&(p.contain=!!r)},[r]),qt(()=>{var p;let m=(p=a.current)===null||p===void 0?void 0:p.nextSibling,g=[],y=R=>R.stopPropagation();for(;m&&m!==o.current;)g.push(m),m.addEventListener(a1,y),m=m.nextSibling;return s.current=g,()=>{for(let R of g)R.removeEventListener(a1,y)}},[e]),EJ(s,n,r),_J(s,r),xJ(s,n,r),wJ(s,i),D.useEffect(()=>{const p=vn(Ot(s.current?s.current[0]:void 0));let m=null;if(oa(p,s.current)){for(let g of kr.traverse())g.scopeRef&&oa(p,g.scopeRef.current)&&(m=g);m===kr.getTreeNode(s)&&(Yt=m.scopeRef)}},[s]),qt(()=>()=>{var p,m,g;let y=(g=(m=kr.getTreeNode(s))===null||m===void 0||(p=m.parent)===null||p===void 0?void 0:p.scopeRef)!==null&&g!==void 0?g:null;(s===Yt||r0(s,Yt))&&(!y||kr.getTreeNode(y))&&(Yt=y),kr.removeTreeNode(s)},[s]);let d=D.useMemo(()=>bJ(s),[]),h=D.useMemo(()=>({focusManager:d,parentNode:c}),[c,d]);return We.createElement(NM.Provider,{value:h},We.createElement("span",{"data-focus-scope-start":!0,hidden:!0,ref:a}),e,We.createElement("span",{"data-focus-scope-end":!0,hidden:!0,ref:o}))}function bJ(t){return{focusNext(e={}){let r=t.current,{from:n,tabbable:i,wrap:a,accept:o}=e;var s;let l=n||vn(Ot((s=r[0])!==null&&s!==void 0?s:void 0)),c=r[0].previousElementSibling,d=ru(r),h=$n(d,{tabbable:i,accept:o},r);h.currentNode=oa(l,r)?l:c;let p=h.nextNode();return!p&&a&&(h.currentNode=c,p=h.nextNode()),p&&Jn(p,!0),p},focusPrevious(e={}){let r=t.current,{from:n,tabbable:i,wrap:a,accept:o}=e;var s;let l=n||vn(Ot((s=r[0])!==null&&s!==void 0?s:void 0)),c=r[r.length-1].nextElementSibling,d=ru(r),h=$n(d,{tabbable:i,accept:o},r);h.currentNode=oa(l,r)?l:c;let p=h.previousNode();return!p&&a&&(h.currentNode=c,p=h.previousNode()),p&&Jn(p,!0),p},focusFirst(e={}){let r=t.current,{tabbable:n,accept:i}=e,a=ru(r),o=$n(a,{tabbable:n,accept:i},r);o.currentNode=r[0].previousElementSibling;let s=o.nextNode();return s&&Jn(s,!0),s},focusLast(e={}){let r=t.current,{tabbable:n,accept:i}=e,a=ru(r),o=$n(a,{tabbable:n,accept:i},r);o.currentNode=r[r.length-1].nextElementSibling;let s=o.previousNode();return s&&Jn(s,!0),s}}}function ru(t){return t[0].parentElement}function Ph(t){let e=kr.getTreeNode(Yt);for(;e&&e.scopeRef!==t;){if(e.contain)return!1;e=e.parent}return!0}function _J(t,e){let r=D.useRef(void 0),n=D.useRef(void 0);qt(()=>{let i=t.current;if(!e){n.current&&(cancelAnimationFrame(n.current),n.current=void 0);return}const a=Ot(i?i[0]:void 0);let o=c=>{if(c.key!=="Tab"||c.altKey||c.ctrlKey||c.metaKey||!Ph(t)||c.isComposing)return;let d=vn(a),h=t.current;if(!h||!oa(d,h))return;let p=ru(h),m=$n(p,{tabbable:!0},h);if(!d)return;m.currentNode=d;let g=c.shiftKey?m.previousNode():m.nextNode();g||(m.currentNode=c.shiftKey?h[h.length-1].nextElementSibling:h[0].previousElementSibling,g=c.shiftKey?m.previousNode():m.nextNode()),c.preventDefault(),g&&Jn(g,!0)},s=c=>{(!Yt||r0(Yt,t))&&oa(Pt(c),t.current)?(Yt=t,r.current=Pt(c)):Ph(t)&&!Ks(Pt(c),t)?r.current?r.current.focus():Yt&&Yt.current&&o1(Yt.current):Ph(t)&&(r.current=Pt(c))},l=c=>{n.current&&cancelAnimationFrame(n.current),n.current=requestAnimationFrame(()=>{let d=il(),h=(d==="virtual"||d===null)&&km()&&H6(),p=vn(a);if(!h&&p&&Ph(t)&&!Ks(p,t)){Yt=t;let g=Pt(c);if(g&&g.isConnected){var m;r.current=g,(m=r.current)===null||m===void 0||m.focus()}else Yt.current&&o1(Yt.current)}})};return a.addEventListener("keydown",o,!1),a.addEventListener("focusin",s,!1),i==null||i.forEach(c=>c.addEventListener("focusin",s,!1)),i==null||i.forEach(c=>c.addEventListener("focusout",l,!1)),()=>{a.removeEventListener("keydown",o,!1),a.removeEventListener("focusin",s,!1),i==null||i.forEach(c=>c.removeEventListener("focusin",s,!1)),i==null||i.forEach(c=>c.removeEventListener("focusout",l,!1))}},[t,e]),qt(()=>()=>{n.current&&cancelAnimationFrame(n.current)},[n])}function bL(t){return Ks(t)}function oa(t,e){return!t||!e?!1:e.some(r=>r.contains(t))}function Ks(t,e=null){if(t instanceof Element&&t.closest("[data-react-aria-top-layer]"))return!0;for(let{scopeRef:r}of kr.traverse(kr.getTreeNode(e)))if(r&&oa(t,r.current))return!0;return!1}function SJ(t){return Ks(t,Yt)}function r0(t,e){var r;let n=(r=kr.getTreeNode(e))===null||r===void 0?void 0:r.parent;for(;n;){if(n.scopeRef===t)return!0;n=n.parent}return!1}function Jn(t,e=!1){if(t!=null&&!e)try{Mu(t)}catch{}else if(t!=null)try{t.focus()}catch{}}function _L(t,e=!0){let r=t[0].previousElementSibling,n=ru(t),i=$n(n,{tabbable:e},t);i.currentNode=r;let a=i.nextNode();return e&&!a&&(n=ru(t),i=$n(n,{tabbable:!1},t),i.currentNode=r,a=i.nextNode()),a}function o1(t,e=!0){Jn(_L(t,e))}function wJ(t,e){const r=We.useRef(e);D.useEffect(()=>{if(r.current){Yt=t;const n=Ot(t.current?t.current[0]:void 0);!oa(vn(n),Yt.current)&&t.current&&o1(t.current)}r.current=!1},[t])}function EJ(t,e,r){qt(()=>{if(e||r)return;let n=t.current;const i=Ot(n?n[0]:void 0);let a=o=>{let s=Pt(o);oa(s,t.current)?Yt=t:bL(s)||(Yt=null)};return i.addEventListener("focusin",a,!1),n==null||n.forEach(o=>o.addEventListener("focusin",a,!1)),()=>{i.removeEventListener("focusin",a,!1),n==null||n.forEach(o=>o.removeEventListener("focusin",a,!1))}},[t,e,r])}function UM(t){let e=kr.getTreeNode(Yt);for(;e&&e.scopeRef!==t;){if(e.nodeToRestore)return!1;e=e.parent}return(e==null?void 0:e.scopeRef)===t}function xJ(t,e,r){const n=D.useRef(typeof document<"u"?vn(Ot(t.current?t.current[0]:void 0)):null);qt(()=>{let i=t.current;const a=Ot(i?i[0]:void 0);if(!e||r)return;let o=()=>{(!Yt||r0(Yt,t))&&oa(vn(a),t.current)&&(Yt=t)};return a.addEventListener("focusin",o,!1),i==null||i.forEach(s=>s.addEventListener("focusin",o,!1)),()=>{a.removeEventListener("focusin",o,!1),i==null||i.forEach(s=>s.removeEventListener("focusin",o,!1))}},[t,r]),qt(()=>{const i=Ot(t.current?t.current[0]:void 0);if(!e)return;let a=o=>{if(o.key!=="Tab"||o.altKey||o.ctrlKey||o.metaKey||!Ph(t)||o.isComposing)return;let s=i.activeElement;if(!Ks(s,t)||!UM(t))return;let l=kr.getTreeNode(t);if(!l)return;let c=l.nodeToRestore,d=$n(i.body,{tabbable:!0});d.currentNode=s;let h=o.shiftKey?d.previousNode():d.nextNode();if((!c||!c.isConnected||c===i.body)&&(c=void 0,l.nodeToRestore=void 0),(!h||!Ks(h,t))&&c){d.currentNode=c;do h=o.shiftKey?d.previousNode():d.nextNode();while(Ks(h,t));o.preventDefault(),o.stopPropagation(),h?Jn(h,!0):bL(c)?Jn(c,!0):s.blur()}};return r||i.addEventListener("keydown",a,!0),()=>{r||i.removeEventListener("keydown",a,!0)}},[t,e,r]),qt(()=>{const i=Ot(t.current?t.current[0]:void 0);if(!e)return;let a=kr.getTreeNode(t);if(a){var o;return a.nodeToRestore=(o=n.current)!==null&&o!==void 0?o:void 0,()=>{let s=kr.getTreeNode(t);if(!s)return;let l=s.nodeToRestore,c=vn(i);if(e&&l&&(c&&Ks(c,t)||c===i.body&&UM(t))){let d=kr.clone();requestAnimationFrame(()=>{if(i.activeElement===i.body){let h=d.getTreeNode(t);for(;h;){if(h.nodeToRestore&&h.nodeToRestore.isConnected){FM(h.nodeToRestore);return}h=h.parent}for(h=d.getTreeNode(t);h;){if(h.scopeRef&&h.scopeRef.current&&kr.getTreeNode(h.scopeRef)){let p=_L(h.scopeRef.current,!0);FM(p);return}h=h.parent}}})}}}},[t,e])}function FM(t){t.dispatchEvent(new CustomEvent(a1,{bubbles:!0,cancelable:!0}))&&Jn(t)}function $n(t,e,r){let n=e!=null&&e.tabbable?RY:Q6,i=(t==null?void 0:t.nodeType)===Node.ELEMENT_NODE?t:null,a=Ot(i),o=rY(a,t||a,NodeFilter.SHOW_ELEMENT,{acceptNode(s){var l;return!(e==null||(l=e.from)===null||l===void 0)&&l.contains(s)?NodeFilter.FILTER_REJECT:n(s)&&oL(s)&&(!r||oa(s,r))&&(!(e!=null&&e.accept)||e.accept(s))?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});return e!=null&&e.from&&(o.currentNode=e.from),o}function NT(t,e={}){return{focusNext(r={}){let n=t.current;if(!n)return null;let{from:i,tabbable:a=e.tabbable,wrap:o=e.wrap,accept:s=e.accept}=r,l=i||vn(Ot(n)),c=$n(n,{tabbable:a,accept:s});n.contains(l)&&(c.currentNode=l);let d=c.nextNode();return!d&&o&&(c.currentNode=n,d=c.nextNode()),d&&Jn(d,!0),d},focusPrevious(r=e){let n=t.current;if(!n)return null;let{from:i,tabbable:a=e.tabbable,wrap:o=e.wrap,accept:s=e.accept}=r,l=i||vn(Ot(n)),c=$n(n,{tabbable:a,accept:s});if(n.contains(l))c.currentNode=l;else{let h=LS(c);return h&&Jn(h,!0),h??null}let d=c.previousNode();if(!d&&o){c.currentNode=n;let h=LS(c);if(!h)return null;d=h}return d&&Jn(d,!0),d??null},focusFirst(r=e){let n=t.current;if(!n)return null;let{tabbable:i=e.tabbable,accept:a=e.accept}=r,s=$n(n,{tabbable:i,accept:a}).nextNode();return s&&Jn(s,!0),s},focusLast(r=e){let n=t.current;if(!n)return null;let{tabbable:i=e.tabbable,accept:a=e.accept}=r,o=$n(n,{tabbable:i,accept:a}),s=LS(o);return s&&Jn(s,!0),s??null}}}function LS(t){let e,r;do r=t.lastChild(),r&&(e=r);while(r);return e}class UT{get size(){return this.fastMap.size}getTreeNode(e){return this.fastMap.get(e)}addTreeNode(e,r,n){let i=this.fastMap.get(r??null);if(!i)return;let a=new s1({scopeRef:e});i.addChild(a),a.parent=i,this.fastMap.set(e,a),n&&(a.nodeToRestore=n)}addNode(e){this.fastMap.set(e.scopeRef,e)}removeTreeNode(e){if(e===null)return;let r=this.fastMap.get(e);if(!r)return;let n=r.parent;for(let a of this.traverse())a!==r&&r.nodeToRestore&&a.nodeToRestore&&r.scopeRef&&r.scopeRef.current&&oa(a.nodeToRestore,r.scopeRef.current)&&(a.nodeToRestore=r.nodeToRestore);let i=r.children;n&&(n.removeChild(r),i.size>0&&i.forEach(a=>n&&n.addChild(a))),this.fastMap.delete(r.scopeRef)}*traverse(e=this.root){if(e.scopeRef!=null&&(yield e),e.children.size>0)for(let r of e.children)yield*this.traverse(r)}clone(){var e;let r=new UT;var n;for(let i of this.traverse())r.addTreeNode(i.scopeRef,(n=(e=i.parent)===null||e===void 0?void 0:e.scopeRef)!==null&&n!==void 0?n:null,i.nodeToRestore);return r}constructor(){this.fastMap=new Map,this.root=new s1({scopeRef:null}),this.fastMap.set(null,this.root)}}class s1{addChild(e){this.children.add(e),e.parent=this}removeChild(e){this.children.delete(e),e.parent=void 0}constructor(e){this.children=new Set,this.contain=!1,this.scopeRef=e.scopeRef}}let kr=new UT;function io(t={}){let{autoFocus:e=!1,isTextInput:r,within:n}=t,i=D.useRef({isFocused:!1,isFocusVisible:e||Vd()}),[a,o]=D.useState(!1),[s,l]=D.useState(()=>i.current.isFocused&&i.current.isFocusVisible),c=D.useCallback(()=>l(i.current.isFocused&&i.current.isFocusVisible),[]),d=D.useCallback(m=>{i.current.isFocused=m,o(m),c()},[c]);mL(m=>{i.current.isFocusVisible=m,c()},[],{isTextInput:r});let{focusProps:h}=wb({isDisabled:n,onFocusChange:d}),{focusWithinProps:p}=wl({isDisabled:!n,onFocusWithinChange:d});return{isFocused:a,isFocusVisible:s,focusProps:n?p:h}}function SL(t){let e=DJ(Ot(t));e!==t&&(e&&CJ(e,t),t&&TJ(t,e))}function CJ(t,e){t.dispatchEvent(new FocusEvent("blur",{relatedTarget:e})),t.dispatchEvent(new FocusEvent("focusout",{bubbles:!0,relatedTarget:e}))}function TJ(t,e){t.dispatchEvent(new FocusEvent("focus",{relatedTarget:e})),t.dispatchEvent(new FocusEvent("focusin",{bubbles:!0,relatedTarget:e}))}function DJ(t){let e=vn(t),r=e==null?void 0:e.getAttribute("aria-activedescendant");return r&&t.getElementById(r)||e}const Oa=[];function wL(t,e){let{onClose:r,shouldCloseOnBlur:n,isOpen:i,isDismissable:a=!1,isKeyboardDismissDisabled:o=!1,shouldCloseOnInteractOutside:s}=t;D.useEffect(()=>{if(i&&!Oa.includes(e))return Oa.push(e),()=>{let g=Oa.indexOf(e);g>=0&&Oa.splice(g,1)}},[i,e]);let l=()=>{Oa[Oa.length-1]===e&&r&&r()},c=g=>{(!s||s(g.target))&&Oa[Oa.length-1]===e&&(g.stopPropagation(),g.preventDefault())},d=g=>{(!s||s(g.target))&&(Oa[Oa.length-1]===e&&(g.stopPropagation(),g.preventDefault()),l())},h=g=>{g.key==="Escape"&&!o&&!g.nativeEvent.isComposing&&(g.stopPropagation(),g.preventDefault(),l())};gJ({ref:e,onInteractOutside:a&&i?d:void 0,onInteractOutsideStart:c});let{focusWithinProps:p}=wl({isDisabled:!n,onBlurWithin:g=>{!g.relatedTarget||SJ(g.relatedTarget)||(!s||s(g.relatedTarget))&&(r==null||r())}}),m=g=>{g.target===g.currentTarget&&g.preventDefault()};return{overlayProps:{onKeyDown:h,...p},underlayProps:{onPointerDown:m}}}function EL(t,e,r){let{type:n}=t,{isOpen:i}=e;D.useEffect(()=>{r&&r.current&&aL.set(r.current,e.close)});let a;n==="menu"?a=!0:n==="listbox"&&(a="listbox");let o=Ii();return{triggerProps:{"aria-haspopup":a,"aria-expanded":i,"aria-controls":i?o:void 0,onPress:e.toggle},overlayProps:{id:o}}}const BS=typeof document<"u"&&window.visualViewport,RJ=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]);let Yv=0,NS;function xL(t={}){let{isDisabled:e}=t;qt(()=>{if(!e)return Yv++,Yv===1&&(Hu()?NS=IJ():NS=MJ()),()=>{Yv--,Yv===0&&NS()}},[e])}function MJ(){return Tn(Yc(document.documentElement,"paddingRight",`${window.innerWidth-document.documentElement.clientWidth}px`),Yc(document.documentElement,"overflow","hidden"))}function IJ(){let t,e,r=c=>{t=bb(c.target,!0),!(t===document.documentElement&&t===document.body)&&t instanceof HTMLElement&&window.getComputedStyle(t).overscrollBehavior==="auto"&&(e=Yc(t,"overscrollBehavior","contain"))},n=c=>{if(!t||t===document.documentElement||t===document.body){c.preventDefault();return}t.scrollHeight===t.clientHeight&&t.scrollWidth===t.clientWidth&&c.preventDefault()},i=()=>{e&&e()},a=c=>{let d=c.target;PJ(d)&&(s(),d.style.transform="translateY(-2000px)",requestAnimationFrame(()=>{d.style.transform="",BS&&(BS.height<window.innerHeight?requestAnimationFrame(()=>{jM(d)}):BS.addEventListener("resize",()=>jM(d),{once:!0}))}))},o=null,s=()=>{if(o)return;let c=()=>{window.scrollTo(0,0)},d=window.pageXOffset,h=window.pageYOffset;o=Tn(oh(window,"scroll",c),Yc(document.documentElement,"paddingRight",`${window.innerWidth-document.documentElement.clientWidth}px`),Yc(document.documentElement,"overflow","hidden"),Yc(document.body,"marginTop",`-${h}px`),()=>{window.scrollTo(d,h)}),window.scrollTo(0,0)},l=Tn(oh(document,"touchstart",r,{passive:!1,capture:!0}),oh(document,"touchmove",n,{passive:!1,capture:!0}),oh(document,"touchend",i,{passive:!1,capture:!0}),oh(document,"focus",a,!0));return()=>{e==null||e(),o==null||o(),l()}}function Yc(t,e,r){let n=t.style[e];return t.style[e]=r,()=>{t.style[e]=n}}function oh(t,e,r,n){return t.addEventListener(e,r,n),()=>{t.removeEventListener(e,r,n)}}function jM(t){let e=document.scrollingElement||document.documentElement,r=t;for(;r&&r!==e;){let n=bb(r);if(n!==document.documentElement&&n!==document.body&&n!==r){let i=n.getBoundingClientRect().top,a=r.getBoundingClientRect().top;a>i+r.clientHeight&&(n.scrollTop+=a-i)}r=n.parentElement}}function PJ(t){return t instanceof HTMLInputElement&&!RJ.has(t.type)||t instanceof HTMLTextAreaElement||t instanceof HTMLElement&&t.isContentEditable}const l1=We.createContext(null);function AJ(t){let{children:e}=t,r=D.useContext(l1),[n,i]=D.useState(0),a=D.useMemo(()=>({parent:r,modalCount:n,addModal(){i(o=>o+1),r&&r.addModal()},removeModal(){i(o=>o-1),r&&r.removeModal()}}),[r,n]);return We.createElement(l1.Provider,{value:a},e)}function kJ(){let t=D.useContext(l1);return{modalProviderProps:{"aria-hidden":t&&t.modalCount>0?!0:void 0}}}function OJ(t){let{modalProviderProps:e}=kJ();return We.createElement("div",{"data-overlay-container":!0,...t,...e})}function $J(t){return We.createElement(AJ,null,We.createElement(OJ,t))}var CL={};CL={dismiss:""};var TL={};TL={dismiss:""};var DL={};DL={dismiss:"Odstranit"};var RL={};RL={dismiss:"Luk"};var ML={};ML={dismiss:"Schlieen"};var IL={};IL={dismiss:""};var PL={};PL={dismiss:"Dismiss"};var AL={};AL={dismiss:"Descartar"};var kL={};kL={dismiss:"Lpeta"};var OL={};OL={dismiss:"Hylk"};var $L={};$L={dismiss:"Rejeter"};var LL={};LL={dismiss:""};var BL={};BL={dismiss:"Odbaci"};var NL={};NL={dismiss:"Elutasts"};var UL={};UL={dismiss:"Ignora"};var FL={};FL={dismiss:""};var jL={};jL={dismiss:""};var VL={};VL={dismiss:"Atmesti"};var zL={};zL={dismiss:"Nerdt"};var KL={};KL={dismiss:"Lukk"};var HL={};HL={dismiss:"Negeren"};var WL={};WL={dismiss:"Zignoruj"};var GL={};GL={dismiss:"Descartar"};var qL={};qL={dismiss:"Dispensar"};var ZL={};ZL={dismiss:"Revocare"};var YL={};YL={dismiss:""};var JL={};JL={dismiss:"Zrui"};var XL={};XL={dismiss:"Opusti"};var QL={};QL={dismiss:"Odbaci"};var e2={};e2={dismiss:"Avvisa"};var t2={};t2={dismiss:"Kapat"};var r2={};r2={dismiss:""};var n2={};n2={dismiss:""};var i2={};i2={dismiss:""};var a2={};a2={"ar-AE":CL,"bg-BG":TL,"cs-CZ":DL,"da-DK":RL,"de-DE":ML,"el-GR":IL,"en-US":PL,"es-ES":AL,"et-EE":kL,"fi-FI":OL,"fr-FR":$L,"he-IL":LL,"hr-HR":BL,"hu-HU":NL,"it-IT":UL,"ja-JP":FL,"ko-KR":jL,"lt-LT":VL,"lv-LV":zL,"nb-NO":KL,"nl-NL":HL,"pl-PL":WL,"pt-BR":GL,"pt-PT":qL,"ro-RO":ZL,"ru-RU":YL,"sk-SK":JL,"sl-SI":XL,"sr-SP":QL,"sv-SE":e2,"tr-TR":t2,"uk-UA":r2,"zh-CN":n2,"zh-TW":i2};const VM={border:0,clip:"rect(0 0 0 0)",clipPath:"inset(50%)",height:"1px",margin:"-1px",overflow:"hidden",padding:0,position:"absolute",width:"1px",whiteSpace:"nowrap"};function LJ(t={}){let{style:e,isFocusable:r}=t,[n,i]=D.useState(!1),{focusWithinProps:a}=wl({isDisabled:!r,onFocusWithinChange:s=>i(s)}),o=D.useMemo(()=>n?e:e?{...VM,...e}:VM,[n]);return{visuallyHiddenProps:{...a,style:o}}}function u1(t){let{children:e,elementType:r="div",isFocusable:n,style:i,...a}=t,{visuallyHiddenProps:o}=LJ(t);return We.createElement(r,Oe(a,o),e)}function BJ(t){return t&&t.__esModule?t.default:t}function zd(t){let{onDismiss:e,...r}=t,n=Ra(BJ(a2),"@react-aria/overlays"),i=Om(r,n.format("dismiss")),a=()=>{e&&e()};return We.createElement(u1,null,We.createElement("button",{...i,tabIndex:-1,onClick:a,style:{width:1,height:1}}))}let sh=new WeakMap,Bi=[];function o2(t,e=document.body){let r=new Set(t),n=new Set,i=l=>{for(let p of l.querySelectorAll("[data-live-announcer], [data-react-aria-top-layer]"))r.add(p);let c=p=>{if(r.has(p)||p.parentElement&&n.has(p.parentElement)&&p.parentElement.getAttribute("role")!=="row")return NodeFilter.FILTER_REJECT;for(let m of r)if(p.contains(m))return NodeFilter.FILTER_SKIP;return NodeFilter.FILTER_ACCEPT},d=document.createTreeWalker(l,NodeFilter.SHOW_ELEMENT,{acceptNode:c}),h=c(l);if(h===NodeFilter.FILTER_ACCEPT&&a(l),h!==NodeFilter.FILTER_REJECT){let p=d.nextNode();for(;p!=null;)a(p),p=d.nextNode()}},a=l=>{var c;let d=(c=sh.get(l))!==null&&c!==void 0?c:0;l.getAttribute("aria-hidden")==="true"&&d===0||(d===0&&l.setAttribute("aria-hidden","true"),n.add(l),sh.set(l,d+1))};Bi.length&&Bi[Bi.length-1].disconnect(),i(e);let o=new MutationObserver(l=>{for(let c of l)if(!(c.type!=="childList"||c.addedNodes.length===0)&&![...r,...n].some(d=>d.contains(c.target))){for(let d of c.removedNodes)d instanceof Element&&(r.delete(d),n.delete(d));for(let d of c.addedNodes)(d instanceof HTMLElement||d instanceof SVGElement)&&(d.dataset.liveAnnouncer==="true"||d.dataset.reactAriaTopLayer==="true")?r.add(d):d instanceof Element&&i(d)}});o.observe(e,{childList:!0,subtree:!0});let s={visibleNodes:r,hiddenNodes:n,observe(){o.observe(e,{childList:!0,subtree:!0})},disconnect(){o.disconnect()}};return Bi.push(s),()=>{o.disconnect();for(let l of n){let c=sh.get(l);c!=null&&(c===1?(l.removeAttribute("aria-hidden"),sh.delete(l)):sh.set(l,c-1))}s===Bi[Bi.length-1]?(Bi.pop(),Bi.length&&Bi[Bi.length-1].observe()):Bi.splice(Bi.indexOf(s),1)}}const NJ=D.createContext({});function UJ(){var t;return(t=D.useContext(NJ))!==null&&t!==void 0?t:{}}const s2=We.createContext(null);function FT(t){let e=Am(),{portalContainer:r=e?null:document.body,isExiting:n}=t,[i,a]=D.useState(!1),o=D.useMemo(()=>({contain:i,setContain:a}),[i,a]),{getContainer:s}=UJ();if(!t.portalContainer&&s&&(r=s()),!r)return null;let l=t.children;return t.disableFocusManagement||(l=We.createElement(yL,{restoreFocus:!0,contain:(t.shouldContainFocus||i)&&!n},l)),l=We.createElement(s2.Provider,{value:o},We.createElement(mJ,null,l)),IH.createPortal(l,r)}function l2(){let t=D.useContext(s2),e=t==null?void 0:t.setContain;qt(()=>{e==null||e(!0)},[e])}const u2=D.createContext({});function Eb(t){const e=D.useRef(null);return e.current===null&&(e.current=t()),e.current}const jT=typeof window<"u",c2=jT?D.useLayoutEffect:D.useEffect,$m=D.createContext(null),$p=D.createContext({transformPagePoint:t=>t,isStatic:!1,reducedMotion:"never"});class FJ extends D.Component{getSnapshotBeforeUpdate(e){const r=this.props.childRef.current;if(r&&e.isPresent&&!this.props.isPresent){const n=r.offsetParent,i=n instanceof HTMLElement&&n.offsetWidth||0,a=this.props.sizeRef.current;a.height=r.offsetHeight||0,a.width=r.offsetWidth||0,a.top=r.offsetTop,a.left=r.offsetLeft,a.right=i-a.width-a.left}return null}componentDidUpdate(){}render(){return this.props.children}}function jJ({children:t,isPresent:e,anchorX:r}){const n=D.useId(),i=D.useRef(null),a=D.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:o}=D.useContext($p);return D.useInsertionEffect(()=>{const{width:s,height:l,top:c,left:d,right:h}=a.current;if(e||!i.current||!s||!l)return;const p=r==="left"?`left: ${d}`:`right: ${h}`;i.current.dataset.motionPopId=n;const m=document.createElement("style");return o&&(m.nonce=o),document.head.appendChild(m),m.sheet&&m.sheet.insertRule(`
          [data-motion-pop-id="${n}"] {
            position: absolute !important;
            width: ${s}px !important;
            height: ${l}px !important;
            ${p}px !important;
            top: ${c}px !important;
          }
        `),()=>{document.head.removeChild(m)}},[e]),O.jsx(FJ,{isPresent:e,childRef:i,sizeRef:a,children:D.cloneElement(t,{ref:i})})}const VJ=({children:t,initial:e,isPresent:r,onExitComplete:n,custom:i,presenceAffectsLayout:a,mode:o,anchorX:s})=>{const l=Eb(zJ),c=D.useId();let d=!0,h=D.useMemo(()=>(d=!1,{id:c,initial:e,isPresent:r,custom:i,onExitComplete:p=>{l.set(p,!0);for(const m of l.values())if(!m)return;n&&n()},register:p=>(l.set(p,!1),()=>l.delete(p))}),[r,l,n]);return a&&d&&(h={...h}),D.useMemo(()=>{l.forEach((p,m)=>l.set(m,!1))},[r]),D.useEffect(()=>{!r&&!l.size&&n&&n()},[r]),o==="popLayout"&&(t=O.jsx(jJ,{isPresent:r,anchorX:s,children:t})),O.jsx($m.Provider,{value:h,children:t})};function zJ(){return new Map}function KJ(t=!0){const e=D.useContext($m);if(e===null)return[!0,null];const{isPresent:r,onExitComplete:n,register:i}=e,a=D.useId();D.useEffect(()=>{if(t)return i(a)},[t]);const o=D.useCallback(()=>t&&n&&n(a),[a,n,t]);return!r&&n?[!1,o]:[!0]}function iye(){return HJ(D.useContext($m))}function HJ(t){return t===null?!0:t.isPresent}const Jv=t=>t.key||"";function zM(t){const e=[];return D.Children.forEach(t,r=>{D.isValidElement(r)&&e.push(r)}),e}const Gu=({children:t,custom:e,initial:r=!0,onExitComplete:n,presenceAffectsLayout:i=!0,mode:a="sync",propagate:o=!1,anchorX:s="left"})=>{const[l,c]=KJ(o),d=D.useMemo(()=>zM(t),[t]),h=o&&!l?[]:d.map(Jv),p=D.useRef(!0),m=D.useRef(d),g=Eb(()=>new Map),[y,R]=D.useState(d),[b,_]=D.useState(d);c2(()=>{p.current=!1,m.current=d;for(let I=0;I<b.length;I++){const C=Jv(b[I]);h.includes(C)?g.delete(C):g.get(C)!==!0&&g.set(C,!1)}},[b,h.length,h.join("-")]);const x=[];if(d!==y){let I=[...d];for(let C=0;C<b.length;C++){const k=b[C],S=Jv(k);h.includes(S)||(I.splice(C,0,k),x.push(k))}return a==="wait"&&x.length&&(I=x),_(zM(I)),R(d),null}const{forceRender:T}=D.useContext(u2);return O.jsx(O.Fragment,{children:b.map(I=>{const C=Jv(I),k=o&&!l?!1:d===b||h.includes(C),S=()=>{if(g.has(C))g.set(C,!0);else return;let V=!0;g.forEach(z=>{z||(V=!1)}),V&&(T==null||T(),_(m.current),o&&(c==null||c()),n&&n())};return O.jsx(VJ,{isPresent:k,initial:!p.current||r?void 0:!1,custom:e,presenceAffectsLayout:i,mode:a,onExitComplete:k?void 0:S,anchorX:s,children:I},C)})})};function WJ(t,e){t.indexOf(e)===-1&&t.push(e)}function GJ(t,e){const r=t.indexOf(e);r>-1&&t.splice(r,1)}function aye([...t],e,r){const n=e<0?t.length+e:e;if(n>=0&&n<t.length){const i=r<0?t.length+r:r,[a]=t.splice(e,1);t.splice(i,0,a)}return t}const Iu=(t,e,r)=>r>e?e:r<t?t:r;let oye=()=>{},VT=()=>{};const ao={},d2=t=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(t),f2=t=>/^0[^.\s]+$/u.test(t);function zT(t){let e;return()=>(e===void 0&&(e=t()),e)}const vf=t=>t,qJ=(t,e)=>r=>e(t(r)),xb=(...t)=>t.reduce(qJ),h2=(t,e,r)=>{const n=e-t;return n===0?1:(r-t)/n};class p2{constructor(){this.subscriptions=[]}add(e){return WJ(this.subscriptions,e),()=>GJ(this.subscriptions,e)}notify(e,r,n){const i=this.subscriptions.length;if(i)if(i===1)this.subscriptions[0](e,r,n);else for(let a=0;a<i;a++){const o=this.subscriptions[a];o&&o(e,r,n)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const Ho=t=>t*1e3,Wo=t=>t/1e3;function m2(t,e){return e?t*(1e3/e):0}const v2=(t,e,r)=>(((1-3*r+3*e)*t+(3*r-6*e))*t+3*e)*t,ZJ=1e-7,YJ=12;function JJ(t,e,r,n,i){let a,o,s=0;do o=e+(r-e)/2,a=v2(o,n,i)-t,a>0?r=o:e=o;while(Math.abs(a)>ZJ&&++s<YJ);return o}function Lm(t,e,r,n){if(t===e&&r===n)return vf;const i=a=>JJ(a,0,1,t,r);return a=>a===0||a===1?a:v2(i(a),e,n)}const g2=t=>e=>e<=.5?t(2*e)/2:(2-t(2*(1-e)))/2,y2=t=>e=>1-t(1-e),b2=Lm(.33,1.53,.69,.99),KT=y2(b2),_2=g2(KT),S2=t=>(t*=2)<1?.5*KT(t):.5*(2-Math.pow(2,-10*(t-1))),HT=t=>1-Math.sin(Math.acos(t)),XJ=y2(HT),w2=g2(HT),QJ=Lm(.42,0,1,1),eX=Lm(0,0,.58,1),E2=Lm(.42,0,.58,1),tX=t=>Array.isArray(t)&&typeof t[0]!="number",x2=t=>Array.isArray(t)&&typeof t[0]=="number",rX={linear:vf,easeIn:QJ,easeInOut:E2,easeOut:eX,circIn:HT,circInOut:w2,circOut:XJ,backIn:KT,backInOut:_2,backOut:b2,anticipate:S2},nX=t=>typeof t=="string",KM=t=>{if(x2(t)){VT(t.length===4);const[e,r,n,i]=t;return Lm(e,r,n,i)}else if(nX(t))return rX[t];return t},Xv=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"],n0={value:null,addProjectionMetrics:null};function iX(t,e){let r=new Set,n=new Set,i=!1,a=!1;const o=new WeakSet;let s={delta:0,timestamp:0,isProcessing:!1},l=0;function c(h){o.has(h)&&(d.schedule(h),t()),l++,h(s)}const d={schedule:(h,p=!1,m=!1)=>{const y=m&&i?r:n;return p&&o.add(h),y.has(h)||y.add(h),h},cancel:h=>{n.delete(h),o.delete(h)},process:h=>{if(s=h,i){a=!0;return}i=!0,[r,n]=[n,r],r.forEach(c),e&&n0.value&&n0.value.frameloop[e].push(l),l=0,r.clear(),i=!1,a&&(a=!1,d.process(h))}};return d}const aX=40;function C2(t,e){let r=!1,n=!0;const i={delta:0,timestamp:0,isProcessing:!1},a=()=>r=!0,o=Xv.reduce((x,T)=>(x[T]=iX(a,e?T:void 0),x),{}),{setup:s,read:l,resolveKeyframes:c,preUpdate:d,update:h,preRender:p,render:m,postRender:g}=o,y=()=>{const x=ao.useManualTiming?i.timestamp:performance.now();r=!1,ao.useManualTiming||(i.delta=n?1e3/60:Math.max(Math.min(x-i.timestamp,aX),1)),i.timestamp=x,i.isProcessing=!0,s.process(i),l.process(i),c.process(i),d.process(i),h.process(i),p.process(i),m.process(i),g.process(i),i.isProcessing=!1,r&&e&&(n=!1,t(y))},R=()=>{r=!0,n=!0,i.isProcessing||t(y)};return{schedule:Xv.reduce((x,T)=>{const I=o[T];return x[T]=(C,k=!1,S=!1)=>(r||R(),I.schedule(C,k,S)),x},{}),cancel:x=>{for(let T=0;T<Xv.length;T++)o[Xv[T]].cancel(x)},state:i,steps:o}}const{schedule:xa,cancel:c1,state:i0,steps:sye}=C2(typeof requestAnimationFrame<"u"?requestAnimationFrame:vf,!0);let jg;function oX(){jg=void 0}const ta={now:()=>(jg===void 0&&ta.set(i0.isProcessing||ao.useManualTiming?i0.timestamp:performance.now()),jg),set:t=>{jg=t,queueMicrotask(oX)}},a0={layout:0,mainThread:0,waapi:0},T2=t=>e=>typeof e=="string"&&e.startsWith(t),WT=T2("--"),sX=T2("var(--"),GT=t=>sX(t)?lX.test(t.split("/*")[0].trim()):!1,lX=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,gf={test:t=>typeof t=="number",parse:parseFloat,transform:t=>t},Lp={...gf,transform:t=>Iu(0,1,t)},Qv={...gf,default:1},ip=t=>Math.round(t*1e5)/1e5,qT=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function uX(t){return t==null}const cX=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,ZT=(t,e)=>r=>!!(typeof r=="string"&&cX.test(r)&&r.startsWith(t)||e&&!uX(r)&&Object.prototype.hasOwnProperty.call(r,e)),D2=(t,e,r)=>n=>{if(typeof n!="string")return n;const[i,a,o,s]=n.match(qT);return{[t]:parseFloat(i),[e]:parseFloat(a),[r]:parseFloat(o),alpha:s!==void 0?parseFloat(s):1}},dX=t=>Iu(0,255,t),US={...gf,transform:t=>Math.round(dX(t))},nu={test:ZT("rgb","red"),parse:D2("red","green","blue"),transform:({red:t,green:e,blue:r,alpha:n=1})=>"rgba("+US.transform(t)+", "+US.transform(e)+", "+US.transform(r)+", "+ip(Lp.transform(n))+")"};function fX(t){let e="",r="",n="",i="";return t.length>5?(e=t.substring(1,3),r=t.substring(3,5),n=t.substring(5,7),i=t.substring(7,9)):(e=t.substring(1,2),r=t.substring(2,3),n=t.substring(3,4),i=t.substring(4,5),e+=e,r+=r,n+=n,i+=i),{red:parseInt(e,16),green:parseInt(r,16),blue:parseInt(n,16),alpha:i?parseInt(i,16)/255:1}}const d1={test:ZT("#"),parse:fX,transform:nu.transform},Bm=t=>({test:e=>typeof e=="string"&&e.endsWith(t)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${t}`}),ws=Bm("deg"),pd=Bm("%"),rt=Bm("px"),hX=Bm("vh"),pX=Bm("vw"),HM={...pd,parse:t=>pd.parse(t)/100,transform:t=>pd.transform(t*100)},Jc={test:ZT("hsl","hue"),parse:D2("hue","saturation","lightness"),transform:({hue:t,saturation:e,lightness:r,alpha:n=1})=>"hsla("+Math.round(t)+", "+pd.transform(ip(e))+", "+pd.transform(ip(r))+", "+ip(Lp.transform(n))+")"},bn={test:t=>nu.test(t)||d1.test(t)||Jc.test(t),parse:t=>nu.test(t)?nu.parse(t):Jc.test(t)?Jc.parse(t):d1.parse(t),transform:t=>typeof t=="string"?t:t.hasOwnProperty("red")?nu.transform(t):Jc.transform(t)},mX=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function vX(t){var e,r;return isNaN(t)&&typeof t=="string"&&(((e=t.match(qT))==null?void 0:e.length)||0)+(((r=t.match(mX))==null?void 0:r.length)||0)>0}const R2="number",M2="color",gX="var",yX="var(",WM="${}",bX=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function Bp(t){const e=t.toString(),r=[],n={color:[],number:[],var:[]},i=[];let a=0;const s=e.replace(bX,l=>(bn.test(l)?(n.color.push(a),i.push(M2),r.push(bn.parse(l))):l.startsWith(yX)?(n.var.push(a),i.push(gX),r.push(l)):(n.number.push(a),i.push(R2),r.push(parseFloat(l))),++a,WM)).split(WM);return{values:r,split:s,indexes:n,types:i}}function I2(t){return Bp(t).values}function P2(t){const{split:e,types:r}=Bp(t),n=e.length;return i=>{let a="";for(let o=0;o<n;o++)if(a+=e[o],i[o]!==void 0){const s=r[o];s===R2?a+=ip(i[o]):s===M2?a+=bn.transform(i[o]):a+=i[o]}return a}}const _X=t=>typeof t=="number"?0:t;function SX(t){const e=I2(t);return P2(t)(e.map(_X))}const yf={test:vX,parse:I2,createTransformer:P2,getAnimatableNone:SX};function FS(t,e,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?t+(e-t)*6*r:r<1/2?e:r<2/3?t+(e-t)*(2/3-r)*6:t}function wX({hue:t,saturation:e,lightness:r,alpha:n}){t/=360,e/=100,r/=100;let i=0,a=0,o=0;if(!e)i=a=o=r;else{const s=r<.5?r*(1+e):r+e-r*e,l=2*r-s;i=FS(l,s,t+1/3),a=FS(l,s,t),o=FS(l,s,t-1/3)}return{red:Math.round(i*255),green:Math.round(a*255),blue:Math.round(o*255),alpha:n}}function o0(t,e){return r=>r>0?e:t}const Nm=(t,e,r)=>t+(e-t)*r,jS=(t,e,r)=>{const n=t*t,i=r*(e*e-n)+n;return i<0?0:Math.sqrt(i)},EX=[d1,nu,Jc],xX=t=>EX.find(e=>e.test(t));function GM(t){const e=xX(t);if(!e)return!1;let r=e.parse(t);return e===Jc&&(r=wX(r)),r}const qM=(t,e)=>{const r=GM(t),n=GM(e);if(!r||!n)return o0(t,e);const i={...r};return a=>(i.red=jS(r.red,n.red,a),i.green=jS(r.green,n.green,a),i.blue=jS(r.blue,n.blue,a),i.alpha=Nm(r.alpha,n.alpha,a),nu.transform(i))},f1=new Set(["none","hidden"]);function CX(t,e){return f1.has(t)?r=>r<=0?t:e:r=>r>=1?e:t}function TX(t,e){return r=>Nm(t,e,r)}function YT(t){return typeof t=="number"?TX:typeof t=="string"?GT(t)?o0:bn.test(t)?qM:MX:Array.isArray(t)?A2:typeof t=="object"?bn.test(t)?qM:DX:o0}function A2(t,e){const r=[...t],n=r.length,i=t.map((a,o)=>YT(a)(a,e[o]));return a=>{for(let o=0;o<n;o++)r[o]=i[o](a);return r}}function DX(t,e){const r={...t,...e},n={};for(const i in r)t[i]!==void 0&&e[i]!==void 0&&(n[i]=YT(t[i])(t[i],e[i]));return i=>{for(const a in n)r[a]=n[a](i);return r}}function RX(t,e){const r=[],n={color:0,var:0,number:0};for(let i=0;i<e.values.length;i++){const a=e.types[i],o=t.indexes[a][n[a]],s=t.values[o]??0;r[i]=s,n[a]++}return r}const MX=(t,e)=>{const r=yf.createTransformer(e),n=Bp(t),i=Bp(e);return n.indexes.var.length===i.indexes.var.length&&n.indexes.color.length===i.indexes.color.length&&n.indexes.number.length>=i.indexes.number.length?f1.has(t)&&!i.values.length||f1.has(e)&&!n.values.length?CX(t,e):xb(A2(RX(n,i),i.values),r):o0(t,e)};function k2(t,e,r){return typeof t=="number"&&typeof e=="number"&&typeof r=="number"?Nm(t,e,r):YT(t)(t,e)}const IX=t=>{const e=({timestamp:r})=>t(r);return{start:()=>xa.update(e,!0),stop:()=>c1(e),now:()=>i0.isProcessing?i0.timestamp:ta.now()}},O2=(t,e,r=10)=>{let n="";const i=Math.max(Math.round(e/r),2);for(let a=0;a<i;a++)n+=t(a/(i-1))+", ";return`linear(${n.substring(0,n.length-2)})`},s0=2e4;function JT(t){let e=0;const r=50;let n=t.next(e);for(;!n.done&&e<s0;)e+=r,n=t.next(e);return e>=s0?1/0:e}function PX(t,e=100,r){const n=r({...t,keyframes:[0,e]}),i=Math.min(JT(n),s0);return{type:"keyframes",ease:a=>n.next(i*a).value/e,duration:Wo(i)}}const AX=5;function $2(t,e,r){const n=Math.max(e-AX,0);return m2(r-t(n),e-n)}const br={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},ZM=.001;function kX({duration:t=br.duration,bounce:e=br.bounce,velocity:r=br.velocity,mass:n=br.mass}){let i,a,o=1-e;o=Iu(br.minDamping,br.maxDamping,o),t=Iu(br.minDuration,br.maxDuration,Wo(t)),o<1?(i=c=>{const d=c*o,h=d*t,p=d-r,m=h1(c,o),g=Math.exp(-h);return ZM-p/m*g},a=c=>{const h=c*o*t,p=h*r+r,m=Math.pow(o,2)*Math.pow(c,2)*t,g=Math.exp(-h),y=h1(Math.pow(c,2),o);return(-i(c)+ZM>0?-1:1)*((p-m)*g)/y}):(i=c=>{const d=Math.exp(-c*t),h=(c-r)*t+1;return-.001+d*h},a=c=>{const d=Math.exp(-c*t),h=(r-c)*(t*t);return d*h});const s=5/t,l=$X(i,a,s);if(t=Ho(t),isNaN(l))return{stiffness:br.stiffness,damping:br.damping,duration:t};{const c=Math.pow(l,2)*n;return{stiffness:c,damping:o*2*Math.sqrt(n*c),duration:t}}}const OX=12;function $X(t,e,r){let n=r;for(let i=1;i<OX;i++)n=n-t(n)/e(n);return n}function h1(t,e){return t*Math.sqrt(1-e*e)}const LX=["duration","bounce"],BX=["stiffness","damping","mass"];function YM(t,e){return e.some(r=>t[r]!==void 0)}function NX(t){let e={velocity:br.velocity,stiffness:br.stiffness,damping:br.damping,mass:br.mass,isResolvedFromDuration:!1,...t};if(!YM(t,BX)&&YM(t,LX))if(t.visualDuration){const r=t.visualDuration,n=2*Math.PI/(r*1.2),i=n*n,a=2*Iu(.05,1,1-(t.bounce||0))*Math.sqrt(i);e={...e,mass:br.mass,stiffness:i,damping:a}}else{const r=kX(t);e={...e,...r,mass:br.mass},e.isResolvedFromDuration=!0}return e}function l0(t=br.visualDuration,e=br.bounce){const r=typeof t!="object"?{visualDuration:t,keyframes:[0,1],bounce:e}:t;let{restSpeed:n,restDelta:i}=r;const a=r.keyframes[0],o=r.keyframes[r.keyframes.length-1],s={done:!1,value:a},{stiffness:l,damping:c,mass:d,duration:h,velocity:p,isResolvedFromDuration:m}=NX({...r,velocity:-Wo(r.velocity||0)}),g=p||0,y=c/(2*Math.sqrt(l*d)),R=o-a,b=Wo(Math.sqrt(l/d)),_=Math.abs(R)<5;n||(n=_?br.restSpeed.granular:br.restSpeed.default),i||(i=_?br.restDelta.granular:br.restDelta.default);let x;if(y<1){const I=h1(b,y);x=C=>{const k=Math.exp(-y*b*C);return o-k*((g+y*b*R)/I*Math.sin(I*C)+R*Math.cos(I*C))}}else if(y===1)x=I=>o-Math.exp(-b*I)*(R+(g+b*R)*I);else{const I=b*Math.sqrt(y*y-1);x=C=>{const k=Math.exp(-y*b*C),S=Math.min(I*C,300);return o-k*((g+y*b*R)*Math.sinh(S)+I*R*Math.cosh(S))/I}}const T={calculatedDuration:m&&h||null,next:I=>{const C=x(I);if(m)s.done=I>=h;else{let k=I===0?g:0;y<1&&(k=I===0?Ho(g):$2(x,I,C));const S=Math.abs(k)<=n,V=Math.abs(o-C)<=i;s.done=S&&V}return s.value=s.done?o:C,s},toString:()=>{const I=Math.min(JT(T),s0),C=O2(k=>T.next(I*k).value,I,30);return I+"ms "+C},toTransition:()=>{}};return T}l0.applyToOptions=t=>{const e=PX(t,100,l0);return t.ease=e.ease,t.duration=Ho(e.duration),t.type="keyframes",t};function p1({keyframes:t,velocity:e=0,power:r=.8,timeConstant:n=325,bounceDamping:i=10,bounceStiffness:a=500,modifyTarget:o,min:s,max:l,restDelta:c=.5,restSpeed:d}){const h=t[0],p={done:!1,value:h},m=S=>s!==void 0&&S<s||l!==void 0&&S>l,g=S=>s===void 0?l:l===void 0||Math.abs(s-S)<Math.abs(l-S)?s:l;let y=r*e;const R=h+y,b=o===void 0?R:o(R);b!==R&&(y=b-h);const _=S=>-y*Math.exp(-S/n),x=S=>b+_(S),T=S=>{const V=_(S),z=x(S);p.done=Math.abs(V)<=c,p.value=p.done?b:z};let I,C;const k=S=>{m(p.value)&&(I=S,C=l0({keyframes:[p.value,g(p.value)],velocity:$2(x,S,p.value),damping:i,stiffness:a,restDelta:c,restSpeed:d}))};return k(0),{calculatedDuration:null,next:S=>{let V=!1;return!C&&I===void 0&&(V=!0,T(S),k(S)),I!==void 0&&S>=I?C.next(S-I):(!V&&T(S),p)}}}function UX(t,e,r){const n=[],i=r||ao.mix||k2,a=t.length-1;for(let o=0;o<a;o++){let s=i(t[o],t[o+1]);if(e){const l=Array.isArray(e)?e[o]||vf:e;s=xb(l,s)}n.push(s)}return n}function FX(t,e,{clamp:r=!0,ease:n,mixer:i}={}){const a=t.length;if(VT(a===e.length),a===1)return()=>e[0];if(a===2&&e[0]===e[1])return()=>e[1];const o=t[0]===t[1];t[0]>t[a-1]&&(t=[...t].reverse(),e=[...e].reverse());const s=UX(e,n,i),l=s.length,c=d=>{if(o&&d<t[0])return e[0];let h=0;if(l>1)for(;h<t.length-2&&!(d<t[h+1]);h++);const p=h2(t[h],t[h+1],d);return s[h](p)};return r?d=>c(Iu(t[0],t[a-1],d)):c}function jX(t,e){const r=t[t.length-1];for(let n=1;n<=e;n++){const i=h2(0,e,n);t.push(Nm(r,1,i))}}function VX(t){const e=[0];return jX(e,t.length-1),e}function zX(t,e){return t.map(r=>r*e)}function KX(t,e){return t.map(()=>e||E2).splice(0,t.length-1)}function ap({duration:t=300,keyframes:e,times:r,ease:n="easeInOut"}){const i=tX(n)?n.map(KM):KM(n),a={done:!1,value:e[0]},o=zX(r&&r.length===e.length?r:VX(e),t),s=FX(o,e,{ease:Array.isArray(i)?i:KX(e,i)});return{calculatedDuration:t,next:l=>(a.value=s(l),a.done=l>=t,a)}}const HX=t=>t!==null;function XT(t,{repeat:e,repeatType:r="loop"},n,i=1){const a=t.filter(HX),s=i<0||e&&r!=="loop"&&e%2===1?0:a.length-1;return!s||n===void 0?a[s]:n}const WX={decay:p1,inertia:p1,tween:ap,keyframes:ap,spring:l0};function L2(t){typeof t.type=="string"&&(t.type=WX[t.type])}class QT{constructor(){this.count=0,this.updateFinished()}get finished(){return this._finished}updateFinished(){this.count++,this._finished=new Promise(e=>{this.resolve=e})}notifyFinished(){this.resolve()}then(e,r){return this.finished.then(e,r)}}const GX=t=>t/100;class e4 extends QT{constructor(e){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{const{motionValue:r}=this.options;if(r&&r.updatedAt!==ta.now()&&this.tick(ta.now()),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:n}=this.options;n&&n()},a0.mainThread++,this.options=e,this.initAnimation(),this.play(),e.autoplay===!1&&this.pause()}initAnimation(){const{options:e}=this;L2(e);const{type:r=ap,repeat:n=0,repeatDelay:i=0,repeatType:a,velocity:o=0}=e;let{keyframes:s}=e;const l=r||ap;l!==ap&&typeof s[0]!="number"&&(this.mixKeyframes=xb(GX,k2(s[0],s[1])),s=[0,100]);const c=l({...e,keyframes:s});a==="mirror"&&(this.mirroredGenerator=l({...e,keyframes:[...s].reverse(),velocity:-o})),c.calculatedDuration===null&&(c.calculatedDuration=JT(c));const{calculatedDuration:d}=c;this.calculatedDuration=d,this.resolvedDuration=d+i,this.totalDuration=this.resolvedDuration*(n+1)-i,this.generator=c}updateTime(e){const r=Math.round(e-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=r}tick(e,r=!1){const{generator:n,totalDuration:i,mixKeyframes:a,mirroredGenerator:o,resolvedDuration:s,calculatedDuration:l}=this;if(this.startTime===null)return n.next(0);const{delay:c=0,keyframes:d,repeat:h,repeatType:p,repeatDelay:m,type:g,onUpdate:y,finalKeyframe:R}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-i/this.speed,this.startTime)),r?this.currentTime=e:this.updateTime(e);const b=this.currentTime-c*(this.playbackSpeed>=0?1:-1),_=this.playbackSpeed>=0?b<0:b>i;this.currentTime=Math.max(b,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=i);let x=this.currentTime,T=n;if(h){const S=Math.min(this.currentTime,i)/s;let V=Math.floor(S),z=S%1;!z&&S>=1&&(z=1),z===1&&V--,V=Math.min(V,h+1),!!(V%2)&&(p==="reverse"?(z=1-z,m&&(z-=m/s)):p==="mirror"&&(T=o)),x=Iu(0,1,z)*s}const I=_?{done:!1,value:d[0]}:T.next(x);a&&(I.value=a(I.value));let{done:C}=I;!_&&l!==null&&(C=this.playbackSpeed>=0?this.currentTime>=i:this.currentTime<=0);const k=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&C);return k&&g!==p1&&(I.value=XT(d,this.options,R,this.speed)),y&&y(I.value),k&&this.finish(),I}then(e,r){return this.finished.then(e,r)}get duration(){return Wo(this.calculatedDuration)}get time(){return Wo(this.currentTime)}set time(e){e=Ho(e),this.currentTime=e,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.playbackSpeed)}get speed(){return this.playbackSpeed}set speed(e){this.updateTime(ta.now());const r=this.playbackSpeed!==e;this.playbackSpeed=e,r&&(this.time=Wo(this.currentTime))}play(){if(this.isStopped)return;const{driver:e=IX,onPlay:r,startTime:n}=this.options;this.driver||(this.driver=e(a=>this.tick(a))),r&&r();const i=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=i):this.holdTime!==null?this.startTime=i-this.holdTime:this.startTime||(this.startTime=n??i),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(ta.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:e}=this.options;e&&e()}cancel(){this.holdTime=null,this.startTime=0,this.tick(0),this.teardown()}teardown(){this.notifyFinished(),this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null,a0.mainThread--}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}attachTimeline(e){return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),e.observe(this)}}function lye(t){return new e4(t)}function qX(t){for(let e=1;e<t.length;e++)t[e]??(t[e]=t[e-1])}const iu=t=>t*180/Math.PI,m1=t=>{const e=iu(Math.atan2(t[1],t[0]));return v1(e)},ZX={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:t=>(Math.abs(t[0])+Math.abs(t[3]))/2,rotate:m1,rotateZ:m1,skewX:t=>iu(Math.atan(t[1])),skewY:t=>iu(Math.atan(t[2])),skew:t=>(Math.abs(t[1])+Math.abs(t[2]))/2},v1=t=>(t=t%360,t<0&&(t+=360),t),JM=m1,XM=t=>Math.sqrt(t[0]*t[0]+t[1]*t[1]),QM=t=>Math.sqrt(t[4]*t[4]+t[5]*t[5]),YX={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:XM,scaleY:QM,scale:t=>(XM(t)+QM(t))/2,rotateX:t=>v1(iu(Math.atan2(t[6],t[5]))),rotateY:t=>v1(iu(Math.atan2(-t[2],t[0]))),rotateZ:JM,rotate:JM,skewX:t=>iu(Math.atan(t[4])),skewY:t=>iu(Math.atan(t[1])),skew:t=>(Math.abs(t[1])+Math.abs(t[4]))/2};function eI(t){return t.includes("scale")?1:0}function g1(t,e){if(!t||t==="none")return eI(e);const r=t.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let n,i;if(r)n=YX,i=r;else{const s=t.match(/^matrix\(([-\d.e\s,]+)\)$/u);n=ZX,i=s}if(!i)return eI(e);const a=n[e],o=i[1].split(",").map(XX);return typeof a=="function"?a(o):o[a]}const JX=(t,e)=>{const{transform:r="none"}=getComputedStyle(t);return g1(r,e)};function XX(t){return parseFloat(t.trim())}const bf=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],_f=new Set(bf),tI=t=>t===gf||t===rt,QX=new Set(["x","y","z"]),eQ=bf.filter(t=>!QX.has(t));function tQ(t){const e=[];return eQ.forEach(r=>{const n=t.getValue(r);n!==void 0&&(e.push([r,n.get()]),n.set(r.startsWith("scale")?1:0))}),e}const Kd={width:({x:t},{paddingLeft:e="0",paddingRight:r="0"})=>t.max-t.min-parseFloat(e)-parseFloat(r),height:({y:t},{paddingTop:e="0",paddingBottom:r="0"})=>t.max-t.min-parseFloat(e)-parseFloat(r),top:(t,{top:e})=>parseFloat(e),left:(t,{left:e})=>parseFloat(e),bottom:({y:t},{top:e})=>parseFloat(e)+(t.max-t.min),right:({x:t},{left:e})=>parseFloat(e)+(t.max-t.min),x:(t,{transform:e})=>g1(e,"x"),y:(t,{transform:e})=>g1(e,"y")};Kd.translateX=Kd.x;Kd.translateY=Kd.y;const vu=new Set;let y1=!1,b1=!1,_1=!1;function B2(){if(b1){const t=Array.from(vu).filter(n=>n.needsMeasurement),e=new Set(t.map(n=>n.element)),r=new Map;e.forEach(n=>{const i=tQ(n);i.length&&(r.set(n,i),n.render())}),t.forEach(n=>n.measureInitialState()),e.forEach(n=>{n.render();const i=r.get(n);i&&i.forEach(([a,o])=>{var s;(s=n.getValue(a))==null||s.set(o)})}),t.forEach(n=>n.measureEndState()),t.forEach(n=>{n.suspendedScrollY!==void 0&&window.scrollTo(0,n.suspendedScrollY)})}b1=!1,y1=!1,vu.forEach(t=>t.complete(_1)),vu.clear()}function N2(){vu.forEach(t=>{t.readKeyframes(),t.needsMeasurement&&(b1=!0)})}function rQ(){_1=!0,N2(),B2(),_1=!1}class t4{constructor(e,r,n,i,a,o=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...e],this.onComplete=r,this.name=n,this.motionValue=i,this.element=a,this.isAsync=o}scheduleResolve(){this.isScheduled=!0,this.isAsync?(vu.add(this),y1||(y1=!0,xa.read(N2),xa.resolveKeyframes(B2))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:r,element:n,motionValue:i}=this;if(e[0]===null){const a=i==null?void 0:i.get(),o=e[e.length-1];if(a!==void 0)e[0]=a;else if(n&&r){const s=n.readValue(r,o);s!=null&&(e[0]=s)}e[0]===void 0&&(e[0]=o),i&&a===void 0&&i.set(e[0])}qX(e)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(e=!1){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,e),vu.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,vu.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const nQ=t=>t.startsWith("--");function iQ(t,e,r){nQ(e)?t.style.setProperty(e,r):t.style[e]=r}const aQ=zT(()=>window.ScrollTimeline!==void 0),oQ={};function sQ(t,e){const r=zT(t);return()=>oQ[e]??r()}const U2=sQ(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),Ah=([t,e,r,n])=>`cubic-bezier(${t}, ${e}, ${r}, ${n})`,rI={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Ah([0,.65,.55,1]),circOut:Ah([.55,0,1,.45]),backIn:Ah([.31,.01,.66,-.59]),backOut:Ah([.33,1.53,.69,.99])};function F2(t,e){if(t)return typeof t=="function"?U2()?O2(t,e):"ease-out":x2(t)?Ah(t):Array.isArray(t)?t.map(r=>F2(r,e)||rI.easeOut):rI[t]}function lQ(t,e,r,{delay:n=0,duration:i=300,repeat:a=0,repeatType:o="loop",ease:s="easeOut",times:l}={},c=void 0){const d={[e]:r};l&&(d.offset=l);const h=F2(s,i);Array.isArray(h)&&(d.easing=h),n0.value&&a0.waapi++;const p={delay:n,duration:i,easing:Array.isArray(h)?"linear":h,fill:"both",iterations:a+1,direction:o==="reverse"?"alternate":"normal"};c&&(p.pseudoElement=c);const m=t.animate(d,p);return n0.value&&m.finished.finally(()=>{a0.waapi--}),m}function j2(t){return typeof t=="function"&&"applyToOptions"in t}function uQ({type:t,...e}){return j2(t)&&U2()?t.applyToOptions(e):(e.duration??(e.duration=300),e.ease??(e.ease="easeOut"),e)}class cQ extends QT{constructor(e){if(super(),this.finishedTime=null,this.isStopped=!1,!e)return;const{element:r,name:n,keyframes:i,pseudoElement:a,allowFlatten:o=!1,finalKeyframe:s,onComplete:l}=e;this.isPseudoElement=!!a,this.allowFlatten=o,this.options=e,VT(typeof e.type!="string");const c=uQ(e);this.animation=lQ(r,n,i,c,a),c.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!a){const d=XT(i,this.options,s,this.speed);this.updateMotionValue?this.updateMotionValue(d):iQ(r,n,d),this.animation.cancel()}l==null||l(),this.notifyFinished()},this.animation.oncancel=()=>this.notifyFinished()}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){var e,r;(r=(e=this.animation).finish)==null||r.call(e)}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:e}=this;e==="idle"||e==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){var e,r;this.isPseudoElement||(r=(e=this.animation).commitStyles)==null||r.call(e)}get duration(){var r,n;const e=((n=(r=this.animation.effect)==null?void 0:r.getComputedTiming)==null?void 0:n.call(r).duration)||0;return Wo(Number(e))}get time(){return Wo(Number(this.animation.currentTime)||0)}set time(e){this.finishedTime=null,this.animation.currentTime=Ho(e)}get speed(){return this.animation.playbackRate}set speed(e){e<0&&(this.finishedTime=null),this.animation.playbackRate=e}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(e){this.animation.startTime=e}attachTimeline({timeline:e,observe:r}){var n;return this.allowFlatten&&((n=this.animation.effect)==null||n.updateTiming({easing:"linear"})),this.animation.onfinish=null,e&&aQ()?(this.animation.timeline=e,vf):r(this)}}const V2={anticipate:S2,backInOut:_2,circInOut:w2};function dQ(t){return t in V2}function fQ(t){typeof t.ease=="string"&&dQ(t.ease)&&(t.ease=V2[t.ease])}const nI=10;class hQ extends cQ{constructor(e){fQ(e),L2(e),super(e),e.startTime&&(this.startTime=e.startTime),this.options=e}updateMotionValue(e){const{motionValue:r,onUpdate:n,onComplete:i,element:a,...o}=this.options;if(!r)return;if(e!==void 0){r.set(e);return}const s=new e4({...o,autoplay:!1}),l=Ho(this.finishedTime??this.time);r.setWithVelocity(s.sample(l-nI).value,s.sample(l).value,nI),s.stop()}}const iI=(t,e)=>e==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&(yf.test(t)||t==="0")&&!t.startsWith("url("));function pQ(t){const e=t[0];if(t.length===1)return!0;for(let r=0;r<t.length;r++)if(t[r]!==e)return!0}function mQ(t,e,r,n){const i=t[0];if(i===null)return!1;if(e==="display"||e==="visibility")return!0;const a=t[t.length-1],o=iI(i,e),s=iI(a,e);return!o||!s?!1:pQ(t)||(r==="spring"||j2(r))&&n}const vQ=new Set(["opacity","clipPath","filter","transform"]),gQ=zT(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function yQ(t){const{motionValue:e,name:r,repeatDelay:n,repeatType:i,damping:a,type:o}=t;if(!e||!e.owner||!(e.owner.current instanceof HTMLElement))return!1;const{onUpdate:s,transformTemplate:l}=e.owner.getProps();return gQ()&&r&&vQ.has(r)&&(r!=="transform"||!l)&&!s&&!n&&i!=="mirror"&&a!==0&&o!=="inertia"}const bQ=40;class _Q extends QT{constructor({autoplay:e=!0,delay:r=0,type:n="keyframes",repeat:i=0,repeatDelay:a=0,repeatType:o="loop",keyframes:s,name:l,motionValue:c,element:d,...h}){var g;super(),this.stop=()=>{var y,R;this._animation?(this._animation.stop(),(y=this.stopTimeline)==null||y.call(this)):(R=this.keyframeResolver)==null||R.cancel()},this.createdAt=ta.now();const p={autoplay:e,delay:r,type:n,repeat:i,repeatDelay:a,repeatType:o,name:l,motionValue:c,element:d,...h},m=(d==null?void 0:d.KeyframeResolver)||t4;this.keyframeResolver=new m(s,(y,R,b)=>this.onKeyframesResolved(y,R,p,!b),l,c,d),(g=this.keyframeResolver)==null||g.scheduleResolve()}onKeyframesResolved(e,r,n,i){this.keyframeResolver=void 0;const{name:a,type:o,velocity:s,delay:l,isHandoff:c,onUpdate:d}=n;this.resolvedAt=ta.now(),mQ(e,a,o,s)||((ao.instantAnimations||!l)&&(d==null||d(XT(e,n,r))),e[0]=e[e.length-1],n.duration=0,n.repeat=0);const p={startTime:i?this.resolvedAt?this.resolvedAt-this.createdAt>bQ?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:r,...n,keyframes:e},m=!c&&yQ(p)?new hQ({...p,element:p.motionValue.owner.current}):new e4(p);m.finished.then(()=>this.notifyFinished()).catch(vf),this.pendingTimeline&&(this.stopTimeline=m.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=m}get finished(){return this._animation?this.animation.finished:this._finished}then(e,r){return this.finished.finally(e).then(()=>{})}get animation(){return this._animation||rQ(),this._animation}get duration(){return this.animation.duration}get time(){return this.animation.time}set time(e){this.animation.time=e}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(e){this.animation.speed=e}get startTime(){return this.animation.startTime}attachTimeline(e){return this._animation?this.stopTimeline=this.animation.attachTimeline(e):this.pendingTimeline=e,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){this.animation.cancel()}}const SQ=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function wQ(t){const e=SQ.exec(t);if(!e)return[,];const[,r,n,i]=e;return[`--${r??n}`,i]}function z2(t,e,r=1){const[n,i]=wQ(t);if(!n)return;const a=window.getComputedStyle(e).getPropertyValue(n);if(a){const o=a.trim();return d2(o)?parseFloat(o):o}return GT(i)?z2(i,e,r+1):i}function K2(t,e){return(t==null?void 0:t[e])??(t==null?void 0:t.default)??t}const H2=new Set(["width","height","top","left","right","bottom",...bf]),EQ={test:t=>t==="auto",parse:t=>t},W2=t=>e=>e.test(t),G2=[gf,rt,pd,ws,pX,hX,EQ],aI=t=>G2.find(W2(t));function xQ(t){return typeof t=="number"?t===0:t!==null?t==="none"||t==="0"||f2(t):!0}const CQ=new Set(["brightness","contrast","saturate","opacity"]);function TQ(t){const[e,r]=t.slice(0,-1).split("(");if(e==="drop-shadow")return t;const[n]=r.match(qT)||[];if(!n)return t;const i=r.replace(n,"");let a=CQ.has(e)?1:0;return n!==r&&(a*=100),e+"("+a+i+")"}const DQ=/\b([a-z-]*)\(.*?\)/gu,S1={...yf,getAnimatableNone:t=>{const e=t.match(DQ);return e?e.map(TQ).join(" "):t}},oI={...gf,transform:Math.round},RQ={rotate:ws,rotateX:ws,rotateY:ws,rotateZ:ws,scale:Qv,scaleX:Qv,scaleY:Qv,scaleZ:Qv,skew:ws,skewX:ws,skewY:ws,distance:rt,translateX:rt,translateY:rt,translateZ:rt,x:rt,y:rt,z:rt,perspective:rt,transformPerspective:rt,opacity:Lp,originX:HM,originY:HM,originZ:rt},r4={borderWidth:rt,borderTopWidth:rt,borderRightWidth:rt,borderBottomWidth:rt,borderLeftWidth:rt,borderRadius:rt,radius:rt,borderTopLeftRadius:rt,borderTopRightRadius:rt,borderBottomRightRadius:rt,borderBottomLeftRadius:rt,width:rt,maxWidth:rt,height:rt,maxHeight:rt,top:rt,right:rt,bottom:rt,left:rt,padding:rt,paddingTop:rt,paddingRight:rt,paddingBottom:rt,paddingLeft:rt,margin:rt,marginTop:rt,marginRight:rt,marginBottom:rt,marginLeft:rt,backgroundPositionX:rt,backgroundPositionY:rt,...RQ,zIndex:oI,fillOpacity:Lp,strokeOpacity:Lp,numOctaves:oI},MQ={...r4,color:bn,backgroundColor:bn,outlineColor:bn,fill:bn,stroke:bn,borderColor:bn,borderTopColor:bn,borderRightColor:bn,borderBottomColor:bn,borderLeftColor:bn,filter:S1,WebkitFilter:S1},q2=t=>MQ[t];function Z2(t,e){let r=q2(t);return r!==S1&&(r=yf),r.getAnimatableNone?r.getAnimatableNone(e):void 0}const IQ=new Set(["auto","none","0"]);function PQ(t,e,r){let n=0,i;for(;n<t.length&&!i;){const a=t[n];typeof a=="string"&&!IQ.has(a)&&Bp(a).values.length&&(i=t[n]),n++}if(i&&r)for(const a of e)t[a]=Z2(r,i)}class AQ extends t4{constructor(e,r,n,i,a){super(e,r,n,i,a,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:r,name:n}=this;if(!r||!r.current)return;super.readKeyframes();for(let l=0;l<e.length;l++){let c=e[l];if(typeof c=="string"&&(c=c.trim(),GT(c))){const d=z2(c,r.current);d!==void 0&&(e[l]=d),l===e.length-1&&(this.finalKeyframe=c)}}if(this.resolveNoneKeyframes(),!H2.has(n)||e.length!==2)return;const[i,a]=e,o=aI(i),s=aI(a);if(o!==s)if(tI(o)&&tI(s))for(let l=0;l<e.length;l++){const c=e[l];typeof c=="string"&&(e[l]=parseFloat(c))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:r}=this,n=[];for(let i=0;i<e.length;i++)(e[i]===null||xQ(e[i]))&&n.push(i);n.length&&PQ(e,n,r)}measureInitialState(){const{element:e,unresolvedKeyframes:r,name:n}=this;if(!e||!e.current)return;n==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=Kd[n](e.measureViewportBox(),window.getComputedStyle(e.current)),r[0]=this.measuredOrigin;const i=r[r.length-1];i!==void 0&&e.getValue(n,i).jump(i,!1)}measureEndState(){var s;const{element:e,name:r,unresolvedKeyframes:n}=this;if(!e||!e.current)return;const i=e.getValue(r);i&&i.jump(this.measuredOrigin,!1);const a=n.length-1,o=n[a];n[a]=Kd[r](e.measureViewportBox(),window.getComputedStyle(e.current)),o!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=o),(s=this.removedTransforms)!=null&&s.length&&this.removedTransforms.forEach(([l,c])=>{e.getValue(l).set(c)}),this.resolveNoneKeyframes()}}function kQ(t,e,r){if(t instanceof EventTarget)return[t];if(typeof t=="string"){let n=document;e&&(n=e.current);const i=(r==null?void 0:r[t])??n.querySelectorAll(t);return i?Array.from(i):[]}return Array.from(t)}const{schedule:OQ,cancel:uye}=C2(queueMicrotask,!1),sI={x:!1,y:!1};function Y2(){return sI.x||sI.y}function J2(t,e){const r=kQ(t),n=new AbortController,i={passive:!0,...e,signal:n.signal};return[r,i,()=>n.abort()]}function lI(t){return!(t.pointerType==="touch"||Y2())}function $Q(t,e,r={}){const[n,i,a]=J2(t,r),o=s=>{if(!lI(s))return;const{target:l}=s,c=e(l,s);if(typeof c!="function"||!l)return;const d=h=>{lI(h)&&(c(h),l.removeEventListener("pointerleave",d))};l.addEventListener("pointerleave",d,i)};return n.forEach(s=>{s.addEventListener("pointerenter",o,i)}),a}const X2=(t,e)=>e?t===e?!0:X2(t,e.parentElement):!1,Q2=t=>t.pointerType==="mouse"?typeof t.button!="number"||t.button<=0:t.isPrimary!==!1,LQ=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function BQ(t){return LQ.has(t.tagName)||t.tabIndex!==-1}const kh=new WeakSet;function uI(t){return e=>{e.key==="Enter"&&t(e)}}function VS(t,e){t.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const NQ=(t,e)=>{const r=t.currentTarget;if(!r)return;const n=uI(()=>{if(kh.has(r))return;VS(r,"down");const i=uI(()=>{VS(r,"up")}),a=()=>VS(r,"cancel");r.addEventListener("keyup",i,e),r.addEventListener("blur",a,e)});r.addEventListener("keydown",n,e),r.addEventListener("blur",()=>r.removeEventListener("keydown",n),e)};function cI(t){return Q2(t)&&!Y2()}function UQ(t,e,r={}){const[n,i,a]=J2(t,r),o=s=>{const l=s.currentTarget;if(!cI(s)||kh.has(l))return;kh.add(l);const c=e(l,s),d=(m,g)=>{window.removeEventListener("pointerup",h),window.removeEventListener("pointercancel",p),!(!cI(m)||!kh.has(l))&&(kh.delete(l),typeof c=="function"&&c(m,{success:g}))},h=m=>{d(m,l===window||l===document||r.useGlobalTarget||X2(l,m.target))},p=m=>{d(m,!1)};window.addEventListener("pointerup",h,i),window.addEventListener("pointercancel",p,i)};return n.forEach(s=>{(r.useGlobalTarget?window:s).addEventListener("pointerdown",o,i),s instanceof HTMLElement&&(s.addEventListener("focus",c=>NQ(c,i)),!BQ(s)&&!s.hasAttribute("tabindex")&&(s.tabIndex=0))}),a}const dI=30,FQ=t=>!isNaN(parseFloat(t)),fI={current:void 0};class jQ{constructor(e,r={}){this.version="12.9.1",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(n,i=!0)=>{var o,s;const a=ta.now();this.updatedAt!==a&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(n),this.current!==this.prev&&((o=this.events.change)==null||o.notify(this.current)),i&&((s=this.events.renderRequest)==null||s.notify(this.current))},this.hasAnimated=!1,this.setCurrent(e),this.owner=r.owner}setCurrent(e){this.current=e,this.updatedAt=ta.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=FQ(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,r){this.events[e]||(this.events[e]=new p2);const n=this.events[e].add(r);return e==="change"?()=>{n(),xa.read(()=>{this.events.change.getSize()||this.stop()})}:n}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,r){this.passiveEffect=e,this.stopPassiveEffect=r}set(e,r=!0){!r||!this.passiveEffect?this.updateAndNotify(e,r):this.passiveEffect(e,this.updateAndNotify)}setWithVelocity(e,r,n){this.set(r),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-n}jump(e,r=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,r&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return fI.current&&fI.current.push(this),this.current}getPrevious(){return this.prev}getVelocity(){const e=ta.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>dI)return 0;const r=Math.min(this.updatedAt-this.prevUpdatedAt,dI);return m2(parseFloat(this.current)-parseFloat(this.prevFrameValue),r)}start(e){return this.stop(),new Promise(r=>{this.hasAnimated=!0,this.animation=e(r),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){var e;(e=this.events.destroy)==null||e.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function u0(t,e){return new jQ(t,e)}const VQ=[...G2,bn,yf],zQ=t=>VQ.find(W2(t)),eB=(t,e)=>e&&typeof t=="number"?e.transform(t):t,n4=D.createContext({strict:!1}),hI={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Hd={};for(const t in hI)Hd[t]={isEnabled:e=>hI[t].some(r=>!!e[r])};function w1(t){for(const e in t)Hd[e]={...Hd[e],...t[e]}}function Ca({children:t,features:e,strict:r=!1}){const[,n]=D.useState(!zS(e)),i=D.useRef(void 0);if(!zS(e)){const{renderer:a,...o}=e;i.current=a,w1(o)}return D.useEffect(()=>{zS(e)&&e().then(({renderer:a,...o})=>{w1(o),i.current=a,n(!0)})},[]),O.jsx(n4.Provider,{value:{renderer:i.current,strict:r},children:t})}function zS(t){return typeof t=="function"}const KQ=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function c0(t){return t.startsWith("while")||t.startsWith("drag")&&t!=="draggable"||t.startsWith("layout")||t.startsWith("onTap")||t.startsWith("onPan")||t.startsWith("onLayout")||KQ.has(t)}let tB=t=>!c0(t);function rB(t){t&&(tB=e=>e.startsWith("on")?!c0(e):t(e))}try{rB(require("@emotion/is-prop-valid").default)}catch{}function HQ(t,e,r){const n={};for(const i in t)i==="values"&&typeof t.values=="object"||(tB(i)||r===!0&&c0(i)||!e&&!c0(i)||t.draggable&&i.startsWith("onDrag"))&&(n[i]=t[i]);return n}function nB({children:t,isValidProp:e,...r}){e&&rB(e),r={...D.useContext($p),...r},r.isStatic=Eb(()=>r.isStatic);const n=D.useMemo(()=>r,[JSON.stringify(r.transition),r.transformPagePoint,r.reducedMotion]);return O.jsx($p.Provider,{value:n,children:t})}function WQ(t){if(typeof Proxy>"u")return t;const e=new Map,r=(...n)=>t(...n);return new Proxy(r,{get:(n,i)=>i==="create"?t:(e.has(i)||e.set(i,t(i)),e.get(i))})}const Cb=D.createContext({});function Tb(t){return t!==null&&typeof t=="object"&&typeof t.start=="function"}function Np(t){return typeof t=="string"||Array.isArray(t)}const i4=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],a4=["initial",...i4];function Db(t){return Tb(t.animate)||a4.some(e=>Np(t[e]))}function iB(t){return!!(Db(t)||t.variants)}function GQ(t,e){if(Db(t)){const{initial:r,animate:n}=t;return{initial:r===!1||Np(r)?r:void 0,animate:Np(n)?n:void 0}}return t.inherit!==!1?e:{}}function qQ(t){const{initial:e,animate:r}=GQ(t,D.useContext(Cb));return D.useMemo(()=>({initial:e,animate:r}),[pI(e),pI(r)])}function pI(t){return Array.isArray(t)?t.join(" "):t}const ZQ=Symbol.for("motionComponentSymbol");function aB(t){return t&&typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"current")}function YQ(t,e,r){return D.useCallback(n=>{n&&t.onMount&&t.onMount(n),e&&(n?e.mount(n):e.unmount()),r&&(typeof r=="function"?r(n):aB(r)&&(r.current=n))},[e])}const o4=t=>t.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),JQ="framerAppearId",oB="data-"+o4(JQ),XQ=D.createContext({});function QQ(t,e,r,n,i){var y,R;const{visualElement:a}=D.useContext(Cb),o=D.useContext(n4),s=D.useContext($m),l=D.useContext($p).reducedMotion,c=D.useRef(null);n=n||o.renderer,!c.current&&n&&(c.current=n(t,{visualState:e,parent:a,props:r,presenceContext:s,blockInitialAnimation:s?s.initial===!1:!1,reducedMotionConfig:l}));const d=c.current,h=D.useContext(XQ);d&&!d.projection&&i&&(d.type==="html"||d.type==="svg")&&eee(c.current,r,i,h);const p=D.useRef(!1);D.useInsertionEffect(()=>{d&&p.current&&d.update(r,s)});const m=r[oB],g=D.useRef(!!m&&!((y=window.MotionHandoffIsComplete)!=null&&y.call(window,m))&&((R=window.MotionHasOptimisedAnimation)==null?void 0:R.call(window,m)));return c2(()=>{d&&(p.current=!0,window.MotionIsMounted=!0,d.updateFeatures(),OQ.render(d.render),g.current&&d.animationState&&d.animationState.animateChanges())}),D.useEffect(()=>{d&&(!g.current&&d.animationState&&d.animationState.animateChanges(),g.current&&(queueMicrotask(()=>{var b;(b=window.MotionHandoffMarkAsComplete)==null||b.call(window,m)}),g.current=!1))}),d}function eee(t,e,r,n){const{layoutId:i,layout:a,drag:o,dragConstraints:s,layoutScroll:l,layoutRoot:c,layoutCrossfade:d}=e;t.projection=new r(t.latestValues,e["data-framer-portal-id"]?void 0:sB(t.parent)),t.projection.setOptions({layoutId:i,layout:a,alwaysMeasureLayout:!!o||s&&aB(s),visualElement:t,animationType:typeof a=="string"?a:"both",initialPromotionConfig:n,crossfade:d,layoutScroll:l,layoutRoot:c})}function sB(t){if(t)return t.options.allowProjection!==!1?t.projection:sB(t.parent)}function tee({preloadedFeatures:t,createVisualElement:e,useRender:r,useVisualState:n,Component:i}){t&&w1(t);function a(s,l){let c;const d={...D.useContext($p),...s,layoutId:ree(s)},{isStatic:h}=d,p=qQ(s),m=n(s,h);if(!h&&jT){nee();const g=iee(d);c=g.MeasureLayout,p.visualElement=QQ(i,m,d,e,g.ProjectionNode)}return O.jsxs(Cb.Provider,{value:p,children:[c&&p.visualElement?O.jsx(c,{visualElement:p.visualElement,...d}):null,r(i,s,YQ(m,p.visualElement,l),m,h,p.visualElement)]})}a.displayName=`motion.${typeof i=="string"?i:`create(${i.displayName??i.name??""})`}`;const o=D.forwardRef(a);return o[ZQ]=i,o}function ree({layoutId:t}){const e=D.useContext(u2).id;return e&&t!==void 0?e+"-"+t:t}function nee(t,e){D.useContext(n4).strict}function iee(t){const{drag:e,layout:r}=Hd;if(!e&&!r)return{};const n={...e,...r};return{MeasureLayout:e!=null&&e.isEnabled(t)||r!=null&&r.isEnabled(t)?n.MeasureLayout:void 0,ProjectionNode:n.ProjectionNode}}const E1={};function cye(t){for(const e in t)E1[e]=t[e],WT(e)&&(E1[e].isCSSVariable=!0)}function lB(t,{layout:e,layoutId:r}){return _f.has(t)||t.startsWith("origin")||(e||r!==void 0)&&(!!E1[t]||t==="opacity")}const Ln=t=>!!(t&&t.getVelocity),aee={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},oee=bf.length;function see(t,e,r){let n="",i=!0;for(let a=0;a<oee;a++){const o=bf[a],s=t[o];if(s===void 0)continue;let l=!0;if(typeof s=="number"?l=s===(o.startsWith("scale")?1:0):l=parseFloat(s)===0,!l||r){const c=eB(s,r4[o]);if(!l){i=!1;const d=aee[o]||o;n+=`${d}(${c}) `}r&&(e[o]=c)}}return n=n.trim(),r?n=r(e,i?"":n):i&&(n="none"),n}function s4(t,e,r){const{style:n,vars:i,transformOrigin:a}=t;let o=!1,s=!1;for(const l in e){const c=e[l];if(_f.has(l)){o=!0;continue}else if(WT(l)){i[l]=c;continue}else{const d=eB(c,r4[l]);l.startsWith("origin")?(s=!0,a[l]=d):n[l]=d}}if(e.transform||(o||r?n.transform=see(e,t.transform,r):n.transform&&(n.transform="none")),s){const{originX:l="50%",originY:c="50%",originZ:d=0}=a;n.transformOrigin=`${l} ${c} ${d}`}}const l4=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function uB(t,e,r){for(const n in e)!Ln(e[n])&&!lB(n,r)&&(t[n]=e[n])}function lee({transformTemplate:t},e){return D.useMemo(()=>{const r=l4();return s4(r,e,t),Object.assign({},r.vars,r.style)},[e])}function uee(t,e){const r=t.style||{},n={};return uB(n,r,t),Object.assign(n,lee(t,e)),n}function cee(t,e){const r={},n=uee(t,e);return t.drag&&t.dragListener!==!1&&(r.draggable=!1,n.userSelect=n.WebkitUserSelect=n.WebkitTouchCallout="none",n.touchAction=t.drag===!0?"none":`pan-${t.drag==="x"?"y":"x"}`),t.tabIndex===void 0&&(t.onTap||t.onTapStart||t.whileTap)&&(r.tabIndex=0),r.style=n,r}const dee=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function u4(t){return typeof t!="string"||t.includes("-")?!1:!!(dee.indexOf(t)>-1||/[A-Z]/u.test(t))}const fee={offset:"stroke-dashoffset",array:"stroke-dasharray"},hee={offset:"strokeDashoffset",array:"strokeDasharray"};function pee(t,e,r=1,n=0,i=!0){t.pathLength=1;const a=i?fee:hee;t[a.offset]=rt.transform(-n);const o=rt.transform(e),s=rt.transform(r);t[a.array]=`${o} ${s}`}function cB(t,{attrX:e,attrY:r,attrScale:n,pathLength:i,pathSpacing:a=1,pathOffset:o=0,...s},l,c){if(s4(t,s,c),l){t.style.viewBox&&(t.attrs.viewBox=t.style.viewBox);return}t.attrs=t.style,t.style={};const{attrs:d,style:h}=t;d.transform&&(h.transform=d.transform,delete d.transform),(h.transform||d.transformOrigin)&&(h.transformOrigin=d.transformOrigin??"50% 50%",delete d.transformOrigin),h.transform&&(h.transformBox="fill-box",delete d.transformBox),e!==void 0&&(d.x=e),r!==void 0&&(d.y=r),n!==void 0&&(d.scale=n),i!==void 0&&pee(d,i,a,o,!1)}const dB=()=>({...l4(),attrs:{}}),fB=t=>typeof t=="string"&&t.toLowerCase()==="svg";function mee(t,e,r,n){const i=D.useMemo(()=>{const a=dB();return cB(a,e,fB(n),t.transformTemplate),{...a.attrs,style:{...a.style}}},[e]);if(t.style){const a={};uB(a,t.style,t),i.style={...a,...i.style}}return i}function vee(t=!1){return(r,n,i,{latestValues:a},o)=>{const l=(u4(r)?mee:cee)(n,a,o,r),c=HQ(n,typeof r=="string",t),d=r!==D.Fragment?{...c,...l,ref:i}:{},{children:h}=n,p=D.useMemo(()=>Ln(h)?h.get():h,[h]);return D.createElement(r,{...d,children:p})}}function mI(t){const e=[{},{}];return t==null||t.values.forEach((r,n)=>{e[0][n]=r.get(),e[1][n]=r.getVelocity()}),e}function c4(t,e,r,n){if(typeof e=="function"){const[i,a]=mI(n);e=e(r!==void 0?r:t.custom,i,a)}if(typeof e=="string"&&(e=t.variants&&t.variants[e]),typeof e=="function"){const[i,a]=mI(n);e=e(r!==void 0?r:t.custom,i,a)}return e}function gee(t){return Ln(t)?t.get():t}function yee({scrapeMotionValuesFromProps:t,createRenderState:e},r,n,i){return{latestValues:bee(r,n,i,t),renderState:e()}}const hB=t=>(e,r)=>{const n=D.useContext(Cb),i=D.useContext($m),a=()=>yee(t,e,n,i);return r?a():Eb(a)};function bee(t,e,r,n){const i={},a=n(t,{});for(const p in a)i[p]=gee(a[p]);let{initial:o,animate:s}=t;const l=Db(t),c=iB(t);e&&c&&!l&&t.inherit!==!1&&(o===void 0&&(o=e.initial),s===void 0&&(s=e.animate));let d=r?r.initial===!1:!1;d=d||o===!1;const h=d?s:o;if(h&&typeof h!="boolean"&&!Tb(h)){const p=Array.isArray(h)?h:[h];for(let m=0;m<p.length;m++){const g=c4(t,p[m]);if(g){const{transitionEnd:y,transition:R,...b}=g;for(const _ in b){let x=b[_];if(Array.isArray(x)){const T=d?x.length-1:0;x=x[T]}x!==null&&(i[_]=x)}for(const _ in y)i[_]=y[_]}}}return i}function d4(t,e,r){var a;const{style:n}=t,i={};for(const o in n)(Ln(n[o])||e.style&&Ln(e.style[o])||lB(o,t)||((a=r==null?void 0:r.getValue(o))==null?void 0:a.liveStyle)!==void 0)&&(i[o]=n[o]);return i}const _ee={useVisualState:hB({scrapeMotionValuesFromProps:d4,createRenderState:l4})};function pB(t,e,r){const n=d4(t,e,r);for(const i in t)if(Ln(t[i])||Ln(e[i])){const a=bf.indexOf(i)!==-1?"attr"+i.charAt(0).toUpperCase()+i.substring(1):i;n[a]=t[i]}return n}const See={useVisualState:hB({scrapeMotionValuesFromProps:pB,createRenderState:dB})};function wee(t,e){return function(n,{forwardMotionProps:i}={forwardMotionProps:!1}){const o={...u4(n)?See:_ee,preloadedFeatures:t,useRender:vee(i),createVisualElement:e,Component:n};return tee(o)}}const Eee=wee(),Ai=WQ(Eee);function Up(t,e,r){const n=t.getProps();return c4(n,e,r!==void 0?r:n.custom,t)}const x1=t=>Array.isArray(t);function xee(t,e,r){t.hasValue(e)?t.getValue(e).set(r):t.addValue(e,u0(r))}function Cee(t){return x1(t)?t[t.length-1]||0:t}function Tee(t,e){const r=Up(t,e);let{transitionEnd:n={},transition:i={},...a}=r||{};a={...a,...n};for(const o in a){const s=Cee(a[o]);xee(t,o,s)}}function Dee(t){return!!(Ln(t)&&t.add)}function Ree(t,e){const r=t.getValue("willChange");if(Dee(r))return r.add(e);if(!r&&ao.WillChange){const n=new ao.WillChange("auto");t.addValue("willChange",n),n.add(e)}}function Mee(t){return t.props[oB]}const Iee=t=>t!==null;function Pee(t,{repeat:e,repeatType:r="loop"},n){const i=t.filter(Iee),a=e&&r!=="loop"&&e%2===1?0:i.length-1;return i[a]}const Aee={type:"spring",stiffness:500,damping:25,restSpeed:10},kee=t=>({type:"spring",stiffness:550,damping:t===0?2*Math.sqrt(550):30,restSpeed:10}),Oee={type:"keyframes",duration:.8},$ee={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},Lee=(t,{keyframes:e})=>e.length>2?Oee:_f.has(t)?t.startsWith("scale")?kee(e[1]):Aee:$ee;function Bee({when:t,delay:e,delayChildren:r,staggerChildren:n,staggerDirection:i,repeat:a,repeatType:o,repeatDelay:s,from:l,elapsed:c,...d}){return!!Object.keys(d).length}const Nee=(t,e,r,n={},i,a)=>o=>{const s=K2(n,t)||{},l=s.delay||n.delay||0;let{elapsed:c=0}=n;c=c-Ho(l);const d={keyframes:Array.isArray(r)?r:[null,r],ease:"easeOut",velocity:e.getVelocity(),...s,delay:-c,onUpdate:p=>{e.set(p),s.onUpdate&&s.onUpdate(p)},onComplete:()=>{o(),s.onComplete&&s.onComplete()},name:t,motionValue:e,element:a?void 0:i};Bee(s)||Object.assign(d,Lee(t,d)),d.duration&&(d.duration=Ho(d.duration)),d.repeatDelay&&(d.repeatDelay=Ho(d.repeatDelay)),d.from!==void 0&&(d.keyframes[0]=d.from);let h=!1;if((d.type===!1||d.duration===0&&!d.repeatDelay)&&(d.duration=0,d.delay===0&&(h=!0)),(ao.instantAnimations||ao.skipAnimations)&&(h=!0,d.duration=0,d.delay=0),d.allowFlatten=!s.type&&!s.ease,h&&!a&&e.get()!==void 0){const p=Pee(d.keyframes,s);if(p!==void 0){xa.update(()=>{d.onUpdate(p),d.onComplete()});return}}return new _Q(d)};function Uee({protectedKeys:t,needsAnimating:e},r){const n=t.hasOwnProperty(r)&&e[r]!==!0;return e[r]=!1,n}function mB(t,e,{delay:r=0,transitionOverride:n,type:i}={}){let{transition:a=t.getDefaultTransition(),transitionEnd:o,...s}=e;n&&(a=n);const l=[],c=i&&t.animationState&&t.animationState.getState()[i];for(const d in s){const h=t.getValue(d,t.latestValues[d]??null),p=s[d];if(p===void 0||c&&Uee(c,d))continue;const m={delay:r,...K2(a||{},d)},g=h.get();if(g!==void 0&&!h.isAnimating&&!Array.isArray(p)&&p===g&&!m.velocity)continue;let y=!1;if(window.MotionHandoffAnimation){const b=Mee(t);if(b){const _=window.MotionHandoffAnimation(b,d,xa);_!==null&&(m.startTime=_,y=!0)}}Ree(t,d),h.start(Nee(d,h,p,t.shouldReduceMotion&&H2.has(d)?{type:!1}:m,t,y));const R=h.animation;R&&l.push(R)}return o&&Promise.all(l).then(()=>{xa.update(()=>{o&&Tee(t,o)})}),l}function C1(t,e,r={}){var l;const n=Up(t,e,r.type==="exit"?(l=t.presenceContext)==null?void 0:l.custom:void 0);let{transition:i=t.getDefaultTransition()||{}}=n||{};r.transitionOverride&&(i=r.transitionOverride);const a=n?()=>Promise.all(mB(t,n,r)):()=>Promise.resolve(),o=t.variantChildren&&t.variantChildren.size?(c=0)=>{const{delayChildren:d=0,staggerChildren:h,staggerDirection:p}=i;return Fee(t,e,d+c,h,p,r)}:()=>Promise.resolve(),{when:s}=i;if(s){const[c,d]=s==="beforeChildren"?[a,o]:[o,a];return c().then(()=>d())}else return Promise.all([a(),o(r.delay)])}function Fee(t,e,r=0,n=0,i=1,a){const o=[],s=(t.variantChildren.size-1)*n,l=i===1?(c=0)=>c*n:(c=0)=>s-c*n;return Array.from(t.variantChildren).sort(jee).forEach((c,d)=>{c.notify("AnimationStart",e),o.push(C1(c,e,{...a,delay:r+l(d)}).then(()=>c.notify("AnimationComplete",e)))}),Promise.all(o)}function jee(t,e){return t.sortNodePosition(e)}function Vee(t,e,r={}){t.notify("AnimationStart",e);let n;if(Array.isArray(e)){const i=e.map(a=>C1(t,a,r));n=Promise.all(i)}else if(typeof e=="string")n=C1(t,e,r);else{const i=typeof e=="function"?Up(t,e,r.custom):e;n=Promise.all(mB(t,i,r))}return n.then(()=>{t.notify("AnimationComplete",e)})}function vB(t,e){if(!Array.isArray(e))return!1;const r=e.length;if(r!==t.length)return!1;for(let n=0;n<r;n++)if(e[n]!==t[n])return!1;return!0}const zee=a4.length;function gB(t){if(!t)return;if(!t.isControllingVariants){const r=t.parent?gB(t.parent)||{}:{};return t.props.initial!==void 0&&(r.initial=t.props.initial),r}const e={};for(let r=0;r<zee;r++){const n=a4[r],i=t.props[n];(Np(i)||i===!1)&&(e[n]=i)}return e}const Kee=[...i4].reverse(),Hee=i4.length;function Wee(t){return e=>Promise.all(e.map(({animation:r,options:n})=>Vee(t,r,n)))}function Gee(t){let e=Wee(t),r=vI(),n=!0;const i=l=>(c,d)=>{var p;const h=Up(t,d,l==="exit"?(p=t.presenceContext)==null?void 0:p.custom:void 0);if(h){const{transition:m,transitionEnd:g,...y}=h;c={...c,...y,...g}}return c};function a(l){e=l(t)}function o(l){const{props:c}=t,d=gB(t.parent)||{},h=[],p=new Set;let m={},g=1/0;for(let R=0;R<Hee;R++){const b=Kee[R],_=r[b],x=c[b]!==void 0?c[b]:d[b],T=Np(x),I=b===l?_.isActive:null;I===!1&&(g=R);let C=x===d[b]&&x!==c[b]&&T;if(C&&n&&t.manuallyAnimateOnMount&&(C=!1),_.protectedKeys={...m},!_.isActive&&I===null||!x&&!_.prevProp||Tb(x)||typeof x=="boolean")continue;const k=qee(_.prevProp,x);let S=k||b===l&&_.isActive&&!C&&T||R>g&&T,V=!1;const z=Array.isArray(x)?x:[x];let j=z.reduce(i(b),{});I===!1&&(j={});const{prevResolvedValues:J={}}=_,$={...J,...j},le=te=>{S=!0,p.has(te)&&(V=!0,p.delete(te)),_.needsAnimating[te]=!0;const H=t.getValue(te);H&&(H.liveStyle=!1)};for(const te in $){const H=j[te],fe=J[te];if(m.hasOwnProperty(te))continue;let ne=!1;x1(H)&&x1(fe)?ne=!vB(H,fe):ne=H!==fe,ne?H!=null?le(te):p.add(te):H!==void 0&&p.has(te)?le(te):_.protectedKeys[te]=!0}_.prevProp=x,_.prevResolvedValues=j,_.isActive&&(m={...m,...j}),n&&t.blockInitialAnimation&&(S=!1),S&&(!(C&&k)||V)&&h.push(...z.map(te=>({animation:te,options:{type:b}})))}if(p.size){const R={};if(typeof c.initial!="boolean"){const b=Up(t,Array.isArray(c.initial)?c.initial[0]:c.initial);b&&b.transition&&(R.transition=b.transition)}p.forEach(b=>{const _=t.getBaseTarget(b),x=t.getValue(b);x&&(x.liveStyle=!0),R[b]=_??null}),h.push({animation:R})}let y=!!h.length;return n&&(c.initial===!1||c.initial===c.animate)&&!t.manuallyAnimateOnMount&&(y=!1),n=!1,y?e(h):Promise.resolve()}function s(l,c){var h;if(r[l].isActive===c)return Promise.resolve();(h=t.variantChildren)==null||h.forEach(p=>{var m;return(m=p.animationState)==null?void 0:m.setActive(l,c)}),r[l].isActive=c;const d=o(l);for(const p in r)r[p].protectedKeys={};return d}return{animateChanges:o,setActive:s,setAnimateFunction:a,getState:()=>r,reset:()=>{r=vI(),n=!0}}}function qee(t,e){return typeof e=="string"?e!==t:Array.isArray(e)?!vB(e,t):!1}function kl(t=!1){return{isActive:t,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function vI(){return{animate:kl(!0),whileInView:kl(),whileHover:kl(),whileTap:kl(),whileDrag:kl(),whileFocus:kl(),exit:kl()}}let Sf=class{constructor(e){this.isMounted=!1,this.node=e}update(){}};class Zee extends Sf{constructor(e){super(e),e.animationState||(e.animationState=Gee(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();Tb(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:r}=this.node.prevProps||{};e!==r&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),(e=this.unmountControls)==null||e.call(this)}}let Yee=0;class Jee extends Sf{constructor(){super(...arguments),this.id=Yee++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:r}=this.node.presenceContext,{isPresent:n}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===n)return;const i=this.node.animationState.setActive("exit",!e);r&&!e&&i.then(()=>{r(this.id)})}mount(){const{register:e,onExitComplete:r}=this.node.presenceContext||{};r&&r(this.id),e&&(this.unmount=e(this.id))}unmount(){}}const Xee={animation:{Feature:Zee},exit:{Feature:Jee}};function gI(t,e,r,n={passive:!0}){return t.addEventListener(e,r,n),()=>t.removeEventListener(e,r)}function f4(t){return{point:{x:t.pageX,y:t.pageY}}}const fye=t=>e=>Q2(e)&&t(e,f4(e));function Qee({top:t,left:e,right:r,bottom:n}){return{x:{min:e,max:r},y:{min:t,max:n}}}function hye({x:t,y:e}){return{top:e.min,right:t.max,bottom:e.max,left:t.min}}function ete(t,e){if(!e)return t;const r=e({x:t.left,y:t.top}),n=e({x:t.right,y:t.bottom});return{top:r.y,left:r.x,bottom:n.y,right:n.x}}const yI=()=>({translate:0,scale:1,origin:0,originPoint:0}),pye=()=>({x:yI(),y:yI()}),bI=()=>({min:0,max:0}),yB=()=>({x:bI(),y:bI()});function KS(t){return t===void 0||t===1}function tte({scale:t,scaleX:e,scaleY:r}){return!KS(t)||!KS(e)||!KS(r)}function rte(t){return tte(t)||nte(t)||t.z||t.rotate||t.rotateX||t.rotateY||t.skewX||t.skewY}function nte(t){return _I(t.x)||_I(t.y)}function _I(t){return t&&t!=="0%"}function SI(t,e,r){const n=t-r,i=e*n;return r+i}function wI(t,e,r,n,i){return i!==void 0&&(t=SI(t,i,n)),SI(t,r,n)+e}function T1(t,e=0,r=1,n,i){t.min=wI(t.min,e,r,n,i),t.max=wI(t.max,e,r,n,i)}function ite(t,{x:e,y:r}){T1(t.x,e.translate,e.scale,e.originPoint),T1(t.y,r.translate,r.scale,r.originPoint)}const EI=.999999999999,xI=1.0000000000001;function mye(t,e,r,n=!1){const i=r.length;if(!i)return;e.x=e.y=1;let a,o;for(let s=0;s<i;s++){a=r[s],o=a.projectionDelta;const{visualElement:l}=a.options;l&&l.props.style&&l.props.style.display==="contents"||(n&&a.options.layoutScroll&&a.scroll&&a!==a.root&&DI(t,{x:-a.scroll.offset.x,y:-a.scroll.offset.y}),o&&(e.x*=o.x.scale,e.y*=o.y.scale,ite(t,o)),n&&rte(a.latestValues)&&DI(t,a.latestValues))}e.x<xI&&e.x>EI&&(e.x=1),e.y<xI&&e.y>EI&&(e.y=1)}function CI(t,e){t.min=t.min+e,t.max=t.max+e}function TI(t,e,r,n,i=.5){const a=Nm(t.min,t.max,i);T1(t,e,r,a,n)}function DI(t,e){TI(t.x,e.x,e.scaleX,e.scale,e.originX),TI(t.y,e.y,e.scaleY,e.scale,e.originY)}function bB(t,e){return Qee(ete(t.getBoundingClientRect(),e))}function vye(t,e,r){const n=bB(t,r),{scroll:i}=e;return i&&(CI(n.x,i.offset.x),CI(n.y,i.offset.y)),n}function RI(t,e,r){const{props:n}=t;t.animationState&&n.whileHover&&t.animationState.setActive("whileHover",r==="Start");const i="onHover"+r,a=n[i];a&&xa.postRender(()=>a(e,f4(e)))}class ate extends Sf{mount(){const{current:e}=this.node;e&&(this.unmount=$Q(e,(r,n)=>(RI(this.node,n,"Start"),i=>RI(this.node,i,"End"))))}unmount(){}}class ote extends Sf{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=xb(gI(this.node.current,"focus",()=>this.onFocus()),gI(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function MI(t,e,r){const{props:n}=t;if(t.current instanceof HTMLButtonElement&&t.current.disabled)return;t.animationState&&n.whileTap&&t.animationState.setActive("whileTap",r==="Start");const i="onTap"+(r==="End"?"":r),a=n[i];a&&xa.postRender(()=>a(e,f4(e)))}class ste extends Sf{mount(){const{current:e}=this.node;e&&(this.unmount=UQ(e,(r,n)=>(MI(this.node,n,"Start"),(i,{success:a})=>MI(this.node,i,a?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const D1=new WeakMap,HS=new WeakMap,lte=t=>{const e=D1.get(t.target);e&&e(t)},ute=t=>{t.forEach(lte)};function cte({root:t,...e}){const r=t||document;HS.has(r)||HS.set(r,{});const n=HS.get(r),i=JSON.stringify(e);return n[i]||(n[i]=new IntersectionObserver(ute,{root:t,...e})),n[i]}function dte(t,e,r){const n=cte(e);return D1.set(t,r),n.observe(t),()=>{D1.delete(t),n.unobserve(t)}}const fte={some:0,all:1};class hte extends Sf{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:r,margin:n,amount:i="some",once:a}=e,o={root:r?r.current:void 0,rootMargin:n,threshold:typeof i=="number"?i:fte[i]},s=l=>{const{isIntersecting:c}=l;if(this.isInView===c||(this.isInView=c,a&&!c&&this.hasEnteredView))return;c&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",c);const{onViewportEnter:d,onViewportLeave:h}=this.node.getProps(),p=c?d:h;p&&p(l)};return dte(this.node.current,o,s)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:r}=this.node;["amount","margin","root"].some(pte(e,r))&&this.startObserver()}unmount(){}}function pte({viewport:t={}},{viewport:e={}}={}){return r=>t[r]!==e[r]}const mte={inView:{Feature:hte},tap:{Feature:ste},focus:{Feature:ote},hover:{Feature:ate}},R1={current:null},_B={current:!1};function vte(){if(_B.current=!0,!!jT)if(window.matchMedia){const t=window.matchMedia("(prefers-reduced-motion)"),e=()=>R1.current=t.matches;t.addListener(e),e()}else R1.current=!1}const gte=new WeakMap;function yte(t,e,r){for(const n in e){const i=e[n],a=r[n];if(Ln(i))t.addValue(n,i);else if(Ln(a))t.addValue(n,u0(i,{owner:t}));else if(a!==i)if(t.hasValue(n)){const o=t.getValue(n);o.liveStyle===!0?o.jump(i):o.hasAnimated||o.set(i)}else{const o=t.getStaticValue(n);t.addValue(n,u0(o!==void 0?o:i,{owner:t}))}}for(const n in r)e[n]===void 0&&t.removeValue(n);return e}const II=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class bte{scrapeMotionValuesFromProps(e,r,n){return{}}constructor({parent:e,props:r,presenceContext:n,reducedMotionConfig:i,blockInitialAnimation:a,visualState:o},s={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=t4,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const p=ta.now();this.renderScheduledAt<p&&(this.renderScheduledAt=p,xa.render(this.render,!1,!0))};const{latestValues:l,renderState:c}=o;this.latestValues=l,this.baseTarget={...l},this.initialValues=r.initial?{...l}:{},this.renderState=c,this.parent=e,this.props=r,this.presenceContext=n,this.depth=e?e.depth+1:0,this.reducedMotionConfig=i,this.options=s,this.blockInitialAnimation=!!a,this.isControllingVariants=Db(r),this.isVariantNode=iB(r),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:d,...h}=this.scrapeMotionValuesFromProps(r,{},this);for(const p in h){const m=h[p];l[p]!==void 0&&Ln(m)&&m.set(l[p],!1)}}mount(e){this.current=e,gte.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((r,n)=>this.bindToMotionValue(n,r)),_B.current||vte(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:R1.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),c1(this.notifyUpdate),c1(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const e in this.events)this.events[e].clear();for(const e in this.features){const r=this.features[e];r&&(r.unmount(),r.isMounted=!1)}this.current=null}bindToMotionValue(e,r){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const n=_f.has(e);n&&this.onBindTransform&&this.onBindTransform();const i=r.on("change",s=>{this.latestValues[e]=s,this.props.onUpdate&&xa.preRender(this.notifyUpdate),n&&this.projection&&(this.projection.isTransformDirty=!0)}),a=r.on("renderRequest",this.scheduleRender);let o;window.MotionCheckAppearSync&&(o=window.MotionCheckAppearSync(this,e,r)),this.valueSubscriptions.set(e,()=>{i(),a(),o&&o(),r.owner&&r.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in Hd){const r=Hd[e];if(!r)continue;const{isEnabled:n,Feature:i}=r;if(!this.features[e]&&i&&n(this.props)&&(this.features[e]=new i(this)),this.features[e]){const a=this.features[e];a.isMounted?a.update():(a.mount(),a.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):yB()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,r){this.latestValues[e]=r}update(e,r){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=r;for(let n=0;n<II.length;n++){const i=II[n];this.propEventSubscriptions[i]&&(this.propEventSubscriptions[i](),delete this.propEventSubscriptions[i]);const a="on"+i,o=e[a];o&&(this.propEventSubscriptions[i]=this.on(i,o))}this.prevMotionValues=yte(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const r=this.getClosestVariantNode();if(r)return r.variantChildren&&r.variantChildren.add(e),()=>r.variantChildren.delete(e)}addValue(e,r){const n=this.values.get(e);r!==n&&(n&&this.removeValue(e),this.bindToMotionValue(e,r),this.values.set(e,r),this.latestValues[e]=r.get())}removeValue(e){this.values.delete(e);const r=this.valueSubscriptions.get(e);r&&(r(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,r){if(this.props.values&&this.props.values[e])return this.props.values[e];let n=this.values.get(e);return n===void 0&&r!==void 0&&(n=u0(r===null?void 0:r,{owner:this}),this.addValue(e,n)),n}readValue(e,r){let n=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:this.getBaseTargetFromProps(this.props,e)??this.readValueFromInstance(this.current,e,this.options);return n!=null&&(typeof n=="string"&&(d2(n)||f2(n))?n=parseFloat(n):!zQ(n)&&yf.test(r)&&(n=Z2(e,r)),this.setBaseTarget(e,Ln(n)?n.get():n)),Ln(n)?n.get():n}setBaseTarget(e,r){this.baseTarget[e]=r}getBaseTarget(e){var a;const{initial:r}=this.props;let n;if(typeof r=="string"||typeof r=="object"){const o=c4(this.props,r,(a=this.presenceContext)==null?void 0:a.custom);o&&(n=o[e])}if(r&&n!==void 0)return n;const i=this.getBaseTargetFromProps(this.props,e);return i!==void 0&&!Ln(i)?i:this.initialValues[e]!==void 0&&n===void 0?void 0:this.baseTarget[e]}on(e,r){return this.events[e]||(this.events[e]=new p2),this.events[e].add(r)}notify(e,...r){this.events[e]&&this.events[e].notify(...r)}}class SB extends bte{constructor(){super(...arguments),this.KeyframeResolver=AQ}sortInstanceNodePosition(e,r){return e.compareDocumentPosition(r)&2?1:-1}getBaseTargetFromProps(e,r){return e.style?e.style[r]:void 0}removeValueFromRenderState(e,{vars:r,style:n}){delete r[e],delete n[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;Ln(e)&&(this.childSubscription=e.on("change",r=>{this.current&&(this.current.textContent=`${r}`)}))}}function wB(t,{style:e,vars:r},n,i){Object.assign(t.style,e,i&&i.getProjectionStyles(n));for(const a in r)t.style.setProperty(a,r[a])}function _te(t){return window.getComputedStyle(t)}class Ste extends SB{constructor(){super(...arguments),this.type="html",this.renderInstance=wB}readValueFromInstance(e,r){if(_f.has(r))return JX(e,r);{const n=_te(e),i=(WT(r)?n.getPropertyValue(r):n[r])||0;return typeof i=="string"?i.trim():i}}measureInstanceViewportBox(e,{transformPagePoint:r}){return bB(e,r)}build(e,r,n){s4(e,r,n.transformTemplate)}scrapeMotionValuesFromProps(e,r,n){return d4(e,r,n)}}const EB=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function wte(t,e,r,n){wB(t,e,void 0,n);for(const i in e.attrs)t.setAttribute(EB.has(i)?i:o4(i),e.attrs[i])}class Ete extends SB{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=yB}getBaseTargetFromProps(e,r){return e[r]}readValueFromInstance(e,r){if(_f.has(r)){const n=q2(r);return n&&n.default||0}return r=EB.has(r)?r:o4(r),e.getAttribute(r)}scrapeMotionValuesFromProps(e,r,n){return pB(e,r,n)}build(e,r,n){cB(e,r,this.isSVGTag,n.transformTemplate)}renderInstance(e,r,n,i){wte(e,r,n,i)}mount(e){this.isSVGTag=fB(e.tagName),super.mount(e)}}const xte=(t,e)=>u4(t)?new Ete(e):new Ste(e,{allowProjection:t!==D.Fragment}),Cte={renderer:xte,...Xee,...mte};var Tte=({children:t,navigate:e,disableAnimation:r,useHref:n,disableRipple:i=!1,skipFramerMotionAnimations:a=r,reducedMotion:o="never",validationBehavior:s,locale:l="en-US",labelPlacement:c,defaultDates:d,createCalendar:h,spinnerVariant:p,...m})=>{let g=t;e&&(g=O.jsx(pY,{navigate:e,useHref:n,children:g}));const y=D.useMemo(()=>(r&&a&&(ao.skipAnimations=!0),{createCalendar:h,defaultDates:d,disableAnimation:r,disableRipple:i,validationBehavior:s,labelPlacement:c,spinnerVariant:p}),[h,d==null?void 0:d.maxDate,d==null?void 0:d.minDate,r,i,s,c,p]);return O.jsx(IZ,{value:y,children:O.jsx(zZ,{locale:l,children:O.jsx(nB,{reducedMotion:o,children:O.jsx($J,{...m,children:g})})})})};function h4(t){const e=ln(),r=e==null?void 0:e.labelPlacement;return D.useMemo(()=>{var n,i;const a=(i=(n=t.labelPlacement)!=null?n:r)!=null?i:"inside";return a==="inside"&&!t.label?"outside":a},[t.labelPlacement,r,t.label])}function Qt(t){return D.forwardRef(t)}var la=(t,e,r=!0)=>{if(!e)return[t,{}];const n=e.reduce((i,a)=>a in t?{...i,[a]:t[a]}:i,{});return r?[Object.keys(t).filter(a=>!e.includes(a)).reduce((a,o)=>({...a,[o]:t[o]}),{}),n]:[t,n]},Dte={default:"bg-default text-default-foreground",primary:"bg-primary text-primary-foreground",secondary:"bg-secondary text-secondary-foreground",success:"bg-success text-success-foreground",warning:"bg-warning text-warning-foreground",danger:"bg-danger text-danger-foreground",foreground:"bg-foreground text-background"},Rte={default:"shadow-lg shadow-default/50 bg-default text-default-foreground",primary:"shadow-lg shadow-primary/40 bg-primary text-primary-foreground",secondary:"shadow-lg shadow-secondary/40 bg-secondary text-secondary-foreground",success:"shadow-lg shadow-success/40 bg-success text-success-foreground",warning:"shadow-lg shadow-warning/40 bg-warning text-warning-foreground",danger:"shadow-lg shadow-danger/40 bg-danger text-danger-foreground"},Mte={default:"bg-transparent border-default text-foreground",primary:"bg-transparent border-primary text-primary",secondary:"bg-transparent border-secondary text-secondary",success:"bg-transparent border-success text-success",warning:"bg-transparent border-warning text-warning",danger:"bg-transparent border-danger text-danger"},Ite={default:"bg-default/40 text-default-700",primary:"bg-primary/20 text-primary-600",secondary:"bg-secondary/20 text-secondary-600",success:"bg-success/20 text-success-700 dark:text-success",warning:"bg-warning/20 text-warning-700 dark:text-warning",danger:"bg-danger/20 text-danger-600 dark:text-danger-500"},Pte={default:"border-default bg-default-100 text-default-foreground",primary:"border-default bg-default-100 text-primary",secondary:"border-default bg-default-100 text-secondary",success:"border-default bg-default-100 text-success",warning:"border-default bg-default-100 text-warning",danger:"border-default bg-default-100 text-danger"},Ate={default:"bg-transparent text-default-foreground",primary:"bg-transparent text-primary",secondary:"bg-transparent text-secondary",success:"bg-transparent text-success",warning:"bg-transparent text-warning",danger:"bg-transparent text-danger"},kte={default:"border-default text-default-foreground",primary:"border-primary text-primary",secondary:"border-secondary text-secondary",success:"border-success text-success",warning:"border-warning text-warning",danger:"border-danger text-danger"},Ae={solid:Dte,shadow:Rte,bordered:Mte,flat:Ite,faded:Pte,light:Ate,ghost:kte},eg=["small","medium","large"],M1={theme:{spacing:["divider"],radius:eg},classGroups:{shadow:[{shadow:eg}],opacity:[{opacity:["disabled"]}],"font-size":[{text:["tiny",...eg]}],"border-w":[{border:eg}],"bg-image":["bg-stripe-gradient-default","bg-stripe-gradient-primary","bg-stripe-gradient-secondary","bg-stripe-gradient-success","bg-stripe-gradient-warning","bg-stripe-gradient-danger"]}},PI=t=>typeof t=="boolean"?`${t}`:t===0?"0":t,Kn=t=>!t||typeof t!="object"||Object.keys(t).length===0,Ote=(t,e)=>JSON.stringify(t)===JSON.stringify(e);function xB(t,e){t.forEach(function(r){Array.isArray(r)?xB(r,e):e.push(r)})}function CB(t){let e=[];return xB(t,e),e}var TB=(...t)=>CB(t).filter(Boolean),DB=(t,e)=>{let r={},n=Object.keys(t),i=Object.keys(e);for(let a of n)if(i.includes(a)){let o=t[a],s=e[a];Array.isArray(o)||Array.isArray(s)?r[a]=TB(s,o):typeof o=="object"&&typeof s=="object"?r[a]=DB(o,s):r[a]=s+" "+o}else r[a]=t[a];for(let a of i)n.includes(a)||(r[a]=e[a]);return r},AI=t=>!t||typeof t!="string"?t:t.replace(/\s+/g," ").trim();const p4="-",$te=t=>{const e=Bte(t),{conflictingClassGroups:r,conflictingClassGroupModifiers:n}=t;return{getClassGroupId:o=>{const s=o.split(p4);return s[0]===""&&s.length!==1&&s.shift(),RB(s,e)||Lte(o)},getConflictingClassGroupIds:(o,s)=>{const l=r[o]||[];return s&&n[o]?[...l,...n[o]]:l}}},RB=(t,e)=>{var o;if(t.length===0)return e.classGroupId;const r=t[0],n=e.nextPart.get(r),i=n?RB(t.slice(1),n):void 0;if(i)return i;if(e.validators.length===0)return;const a=t.join(p4);return(o=e.validators.find(({validator:s})=>s(a)))==null?void 0:o.classGroupId},kI=/^\[(.+)\]$/,Lte=t=>{if(kI.test(t)){const e=kI.exec(t)[1],r=e==null?void 0:e.substring(0,e.indexOf(":"));if(r)return"arbitrary.."+r}},Bte=t=>{const{theme:e,classGroups:r}=t,n={nextPart:new Map,validators:[]};for(const i in r)I1(r[i],n,i,e);return n},I1=(t,e,r,n)=>{t.forEach(i=>{if(typeof i=="string"){const a=i===""?e:OI(e,i);a.classGroupId=r;return}if(typeof i=="function"){if(Nte(i)){I1(i(n),e,r,n);return}e.validators.push({validator:i,classGroupId:r});return}Object.entries(i).forEach(([a,o])=>{I1(o,OI(e,a),r,n)})})},OI=(t,e)=>{let r=t;return e.split(p4).forEach(n=>{r.nextPart.has(n)||r.nextPart.set(n,{nextPart:new Map,validators:[]}),r=r.nextPart.get(n)}),r},Nte=t=>t.isThemeGetter,Ute=t=>{if(t<1)return{get:()=>{},set:()=>{}};let e=0,r=new Map,n=new Map;const i=(a,o)=>{r.set(a,o),e++,e>t&&(e=0,n=r,r=new Map)};return{get(a){let o=r.get(a);if(o!==void 0)return o;if((o=n.get(a))!==void 0)return i(a,o),o},set(a,o){r.has(a)?r.set(a,o):i(a,o)}}},P1="!",A1=":",Fte=A1.length,jte=t=>{const{prefix:e,experimentalParseClassName:r}=t;let n=i=>{const a=[];let o=0,s=0,l=0,c;for(let g=0;g<i.length;g++){let y=i[g];if(o===0&&s===0){if(y===A1){a.push(i.slice(l,g)),l=g+Fte;continue}if(y==="/"){c=g;continue}}y==="["?o++:y==="]"?o--:y==="("?s++:y===")"&&s--}const d=a.length===0?i:i.substring(l),h=Vte(d),p=h!==d,m=c&&c>l?c-l:void 0;return{modifiers:a,hasImportantModifier:p,baseClassName:h,maybePostfixModifierPosition:m}};if(e){const i=e+A1,a=n;n=o=>o.startsWith(i)?a(o.substring(i.length)):{isExternal:!0,modifiers:[],hasImportantModifier:!1,baseClassName:o,maybePostfixModifierPosition:void 0}}if(r){const i=n;n=a=>r({className:a,parseClassName:i})}return n},Vte=t=>t.endsWith(P1)?t.substring(0,t.length-1):t.startsWith(P1)?t.substring(1):t,zte=t=>{const e=Object.fromEntries(t.orderSensitiveModifiers.map(n=>[n,!0]));return n=>{if(n.length<=1)return n;const i=[];let a=[];return n.forEach(o=>{o[0]==="["||e[o]?(i.push(...a.sort(),o),a=[]):a.push(o)}),i.push(...a.sort()),i}},Kte=t=>({cache:Ute(t.cacheSize),parseClassName:jte(t),sortModifiers:zte(t),...$te(t)}),Hte=/\s+/,Wte=(t,e)=>{const{parseClassName:r,getClassGroupId:n,getConflictingClassGroupIds:i,sortModifiers:a}=e,o=[],s=t.trim().split(Hte);let l="";for(let c=s.length-1;c>=0;c-=1){const d=s[c],{isExternal:h,modifiers:p,hasImportantModifier:m,baseClassName:g,maybePostfixModifierPosition:y}=r(d);if(h){l=d+(l.length>0?" "+l:l);continue}let R=!!y,b=n(R?g.substring(0,y):g);if(!b){if(!R){l=d+(l.length>0?" "+l:l);continue}if(b=n(g),!b){l=d+(l.length>0?" "+l:l);continue}R=!1}const _=a(p).join(":"),x=m?_+P1:_,T=x+b;if(o.includes(T))continue;o.push(T);const I=i(b,R);for(let C=0;C<I.length;++C){const k=I[C];o.push(x+k)}l=d+(l.length>0?" "+l:l)}return l};function Gte(){let t=0,e,r,n="";for(;t<arguments.length;)(e=arguments[t++])&&(r=MB(e))&&(n&&(n+=" "),n+=r);return n}const MB=t=>{if(typeof t=="string")return t;let e,r="";for(let n=0;n<t.length;n++)t[n]&&(e=MB(t[n]))&&(r&&(r+=" "),r+=e);return r};function k1(t,...e){let r,n,i,a=o;function o(l){const c=e.reduce((d,h)=>h(d),t());return r=Kte(c),n=r.cache.get,i=r.cache.set,a=s,s(l)}function s(l){const c=n(l);if(c)return c;const d=Wte(l,r);return i(l,d),d}return function(){return a(Gte.apply(null,arguments))}}const Zr=t=>{const e=r=>r[t]||[];return e.isThemeGetter=!0,e},IB=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,PB=/^\((?:(\w[\w-]*):)?(.+)\)$/i,qte=/^\d+\/\d+$/,Zte=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,Yte=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,Jte=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,Xte=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,Qte=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,vc=t=>qte.test(t),wt=t=>!!t&&!Number.isNaN(Number(t)),Ol=t=>!!t&&Number.isInteger(Number(t)),$I=t=>t.endsWith("%")&&wt(t.slice(0,-1)),ms=t=>Zte.test(t),ere=()=>!0,tre=t=>Yte.test(t)&&!Jte.test(t),m4=()=>!1,rre=t=>Xte.test(t),nre=t=>Qte.test(t),ire=t=>!Ke(t)&&!He(t),are=t=>wf(t,OB,m4),Ke=t=>IB.test(t),$l=t=>wf(t,$B,tre),WS=t=>wf(t,vre,wt),ore=t=>wf(t,AB,m4),sre=t=>wf(t,kB,nre),lre=t=>wf(t,m4,rre),He=t=>PB.test(t),tg=t=>Ef(t,$B),ure=t=>Ef(t,gre),cre=t=>Ef(t,AB),dre=t=>Ef(t,OB),fre=t=>Ef(t,kB),hre=t=>Ef(t,yre,!0),wf=(t,e,r)=>{const n=IB.exec(t);return n?n[1]?e(n[1]):r(n[2]):!1},Ef=(t,e,r=!1)=>{const n=PB.exec(t);return n?n[1]?e(n[1]):r:!1},AB=t=>t==="position",pre=new Set(["image","url"]),kB=t=>pre.has(t),mre=new Set(["length","size","percentage"]),OB=t=>mre.has(t),$B=t=>t==="length",vre=t=>t==="number",gre=t=>t==="family-name",yre=t=>t==="shadow",O1=()=>{const t=Zr("color"),e=Zr("font"),r=Zr("text"),n=Zr("font-weight"),i=Zr("tracking"),a=Zr("leading"),o=Zr("breakpoint"),s=Zr("container"),l=Zr("spacing"),c=Zr("radius"),d=Zr("shadow"),h=Zr("inset-shadow"),p=Zr("drop-shadow"),m=Zr("blur"),g=Zr("perspective"),y=Zr("aspect"),R=Zr("ease"),b=Zr("animate"),_=()=>["auto","avoid","all","avoid-page","page","left","right","column"],x=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],T=()=>["auto","hidden","clip","visible","scroll"],I=()=>["auto","contain","none"],C=()=>[He,Ke,l],k=()=>[vc,"full","auto",...C()],S=()=>[Ol,"none","subgrid",He,Ke],V=()=>["auto",{span:["full",Ol,He,Ke]},He,Ke],z=()=>[Ol,"auto",He,Ke],j=()=>["auto","min","max","fr",He,Ke],J=()=>["start","end","center","between","around","evenly","stretch","baseline"],$=()=>["start","end","center","stretch"],le=()=>["auto",...C()],ie=()=>[vc,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...C()],Z=()=>[t,He,Ke],te=()=>[$I,$l],H=()=>["","none","full",c,He,Ke],fe=()=>["",wt,tg,$l],ne=()=>["solid","dashed","dotted","double"],he=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],oe=()=>["","none",m,He,Ke],me=()=>["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",He,Ke],ee=()=>["none",wt,He,Ke],Y=()=>["none",wt,He,Ke],q=()=>[wt,He,Ke],X=()=>[vc,"full",...C()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[ms],breakpoint:[ms],color:[ere],container:[ms],"drop-shadow":[ms],ease:["in","out","in-out"],font:[ire],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[ms],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[ms],shadow:[ms],spacing:["px",wt],text:[ms],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",vc,Ke,He,y]}],container:["container"],columns:[{columns:[wt,Ke,He,s]}],"break-after":[{"break-after":_()}],"break-before":[{"break-before":_()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...x(),Ke,He]}],overflow:[{overflow:T()}],"overflow-x":[{"overflow-x":T()}],"overflow-y":[{"overflow-y":T()}],overscroll:[{overscroll:I()}],"overscroll-x":[{"overscroll-x":I()}],"overscroll-y":[{"overscroll-y":I()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:k()}],"inset-x":[{"inset-x":k()}],"inset-y":[{"inset-y":k()}],start:[{start:k()}],end:[{end:k()}],top:[{top:k()}],right:[{right:k()}],bottom:[{bottom:k()}],left:[{left:k()}],visibility:["visible","invisible","collapse"],z:[{z:[Ol,"auto",He,Ke]}],basis:[{basis:[vc,"full","auto",s,...C()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[wt,vc,"auto","initial","none",Ke]}],grow:[{grow:["",wt,He,Ke]}],shrink:[{shrink:["",wt,He,Ke]}],order:[{order:[Ol,"first","last","none",He,Ke]}],"grid-cols":[{"grid-cols":S()}],"col-start-end":[{col:V()}],"col-start":[{"col-start":z()}],"col-end":[{"col-end":z()}],"grid-rows":[{"grid-rows":S()}],"row-start-end":[{row:V()}],"row-start":[{"row-start":z()}],"row-end":[{"row-end":z()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":j()}],"auto-rows":[{"auto-rows":j()}],gap:[{gap:C()}],"gap-x":[{"gap-x":C()}],"gap-y":[{"gap-y":C()}],"justify-content":[{justify:[...J(),"normal"]}],"justify-items":[{"justify-items":[...$(),"normal"]}],"justify-self":[{"justify-self":["auto",...$()]}],"align-content":[{content:["normal",...J()]}],"align-items":[{items:[...$(),"baseline"]}],"align-self":[{self:["auto",...$(),"baseline"]}],"place-content":[{"place-content":J()}],"place-items":[{"place-items":[...$(),"baseline"]}],"place-self":[{"place-self":["auto",...$()]}],p:[{p:C()}],px:[{px:C()}],py:[{py:C()}],ps:[{ps:C()}],pe:[{pe:C()}],pt:[{pt:C()}],pr:[{pr:C()}],pb:[{pb:C()}],pl:[{pl:C()}],m:[{m:le()}],mx:[{mx:le()}],my:[{my:le()}],ms:[{ms:le()}],me:[{me:le()}],mt:[{mt:le()}],mr:[{mr:le()}],mb:[{mb:le()}],ml:[{ml:le()}],"space-x":[{"space-x":C()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":C()}],"space-y-reverse":["space-y-reverse"],size:[{size:ie()}],w:[{w:[s,"screen",...ie()]}],"min-w":[{"min-w":[s,"screen","none",...ie()]}],"max-w":[{"max-w":[s,"screen","none","prose",{screen:[o]},...ie()]}],h:[{h:["screen",...ie()]}],"min-h":[{"min-h":["screen","none",...ie()]}],"max-h":[{"max-h":["screen",...ie()]}],"font-size":[{text:["base",r,tg,$l]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[n,He,WS]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",$I,Ke]}],"font-family":[{font:[ure,Ke,e]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[i,He,Ke]}],"line-clamp":[{"line-clamp":[wt,"none",He,WS]}],leading:[{leading:[a,...C()]}],"list-image":[{"list-image":["none",He,Ke]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",He,Ke]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:Z()}],"text-color":[{text:Z()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...ne(),"wavy"]}],"text-decoration-thickness":[{decoration:[wt,"from-font","auto",He,$l]}],"text-decoration-color":[{decoration:Z()}],"underline-offset":[{"underline-offset":[wt,"auto",He,Ke]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:C()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",He,Ke]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",He,Ke]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...x(),cre,ore]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","space","round"]}]}],"bg-size":[{bg:["auto","cover","contain",dre,are]}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},Ol,He,Ke],radial:["",He,Ke],conic:[Ol,He,Ke]},fre,sre]}],"bg-color":[{bg:Z()}],"gradient-from-pos":[{from:te()}],"gradient-via-pos":[{via:te()}],"gradient-to-pos":[{to:te()}],"gradient-from":[{from:Z()}],"gradient-via":[{via:Z()}],"gradient-to":[{to:Z()}],rounded:[{rounded:H()}],"rounded-s":[{"rounded-s":H()}],"rounded-e":[{"rounded-e":H()}],"rounded-t":[{"rounded-t":H()}],"rounded-r":[{"rounded-r":H()}],"rounded-b":[{"rounded-b":H()}],"rounded-l":[{"rounded-l":H()}],"rounded-ss":[{"rounded-ss":H()}],"rounded-se":[{"rounded-se":H()}],"rounded-ee":[{"rounded-ee":H()}],"rounded-es":[{"rounded-es":H()}],"rounded-tl":[{"rounded-tl":H()}],"rounded-tr":[{"rounded-tr":H()}],"rounded-br":[{"rounded-br":H()}],"rounded-bl":[{"rounded-bl":H()}],"border-w":[{border:fe()}],"border-w-x":[{"border-x":fe()}],"border-w-y":[{"border-y":fe()}],"border-w-s":[{"border-s":fe()}],"border-w-e":[{"border-e":fe()}],"border-w-t":[{"border-t":fe()}],"border-w-r":[{"border-r":fe()}],"border-w-b":[{"border-b":fe()}],"border-w-l":[{"border-l":fe()}],"divide-x":[{"divide-x":fe()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":fe()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...ne(),"hidden","none"]}],"divide-style":[{divide:[...ne(),"hidden","none"]}],"border-color":[{border:Z()}],"border-color-x":[{"border-x":Z()}],"border-color-y":[{"border-y":Z()}],"border-color-s":[{"border-s":Z()}],"border-color-e":[{"border-e":Z()}],"border-color-t":[{"border-t":Z()}],"border-color-r":[{"border-r":Z()}],"border-color-b":[{"border-b":Z()}],"border-color-l":[{"border-l":Z()}],"divide-color":[{divide:Z()}],"outline-style":[{outline:[...ne(),"none","hidden"]}],"outline-offset":[{"outline-offset":[wt,He,Ke]}],"outline-w":[{outline:["",wt,tg,$l]}],"outline-color":[{outline:[t]}],shadow:[{shadow:["","none",d,hre,lre]}],"shadow-color":[{shadow:Z()}],"inset-shadow":[{"inset-shadow":["none",He,Ke,h]}],"inset-shadow-color":[{"inset-shadow":Z()}],"ring-w":[{ring:fe()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:Z()}],"ring-offset-w":[{"ring-offset":[wt,$l]}],"ring-offset-color":[{"ring-offset":Z()}],"inset-ring-w":[{"inset-ring":fe()}],"inset-ring-color":[{"inset-ring":Z()}],opacity:[{opacity:[wt,He,Ke]}],"mix-blend":[{"mix-blend":[...he(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":he()}],filter:[{filter:["","none",He,Ke]}],blur:[{blur:oe()}],brightness:[{brightness:[wt,He,Ke]}],contrast:[{contrast:[wt,He,Ke]}],"drop-shadow":[{"drop-shadow":["","none",p,He,Ke]}],grayscale:[{grayscale:["",wt,He,Ke]}],"hue-rotate":[{"hue-rotate":[wt,He,Ke]}],invert:[{invert:["",wt,He,Ke]}],saturate:[{saturate:[wt,He,Ke]}],sepia:[{sepia:["",wt,He,Ke]}],"backdrop-filter":[{"backdrop-filter":["","none",He,Ke]}],"backdrop-blur":[{"backdrop-blur":oe()}],"backdrop-brightness":[{"backdrop-brightness":[wt,He,Ke]}],"backdrop-contrast":[{"backdrop-contrast":[wt,He,Ke]}],"backdrop-grayscale":[{"backdrop-grayscale":["",wt,He,Ke]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[wt,He,Ke]}],"backdrop-invert":[{"backdrop-invert":["",wt,He,Ke]}],"backdrop-opacity":[{"backdrop-opacity":[wt,He,Ke]}],"backdrop-saturate":[{"backdrop-saturate":[wt,He,Ke]}],"backdrop-sepia":[{"backdrop-sepia":["",wt,He,Ke]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":C()}],"border-spacing-x":[{"border-spacing-x":C()}],"border-spacing-y":[{"border-spacing-y":C()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",He,Ke]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[wt,"initial",He,Ke]}],ease:[{ease:["linear","initial",R,He,Ke]}],delay:[{delay:[wt,He,Ke]}],animate:[{animate:["none",b,He,Ke]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[g,He,Ke]}],"perspective-origin":[{"perspective-origin":me()}],rotate:[{rotate:ee()}],"rotate-x":[{"rotate-x":ee()}],"rotate-y":[{"rotate-y":ee()}],"rotate-z":[{"rotate-z":ee()}],scale:[{scale:Y()}],"scale-x":[{"scale-x":Y()}],"scale-y":[{"scale-y":Y()}],"scale-z":[{"scale-z":Y()}],"scale-3d":["scale-3d"],skew:[{skew:q()}],"skew-x":[{"skew-x":q()}],"skew-y":[{"skew-y":q()}],transform:[{transform:[He,Ke,"","none","gpu","cpu"]}],"transform-origin":[{origin:me()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:X()}],"translate-x":[{"translate-x":X()}],"translate-y":[{"translate-y":X()}],"translate-z":[{"translate-z":X()}],"translate-none":["translate-none"],accent:[{accent:Z()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:Z()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",He,Ke]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":C()}],"scroll-mx":[{"scroll-mx":C()}],"scroll-my":[{"scroll-my":C()}],"scroll-ms":[{"scroll-ms":C()}],"scroll-me":[{"scroll-me":C()}],"scroll-mt":[{"scroll-mt":C()}],"scroll-mr":[{"scroll-mr":C()}],"scroll-mb":[{"scroll-mb":C()}],"scroll-ml":[{"scroll-ml":C()}],"scroll-p":[{"scroll-p":C()}],"scroll-px":[{"scroll-px":C()}],"scroll-py":[{"scroll-py":C()}],"scroll-ps":[{"scroll-ps":C()}],"scroll-pe":[{"scroll-pe":C()}],"scroll-pt":[{"scroll-pt":C()}],"scroll-pr":[{"scroll-pr":C()}],"scroll-pb":[{"scroll-pb":C()}],"scroll-pl":[{"scroll-pl":C()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",He,Ke]}],fill:[{fill:["none",...Z()]}],"stroke-w":[{stroke:[wt,tg,$l,WS]}],stroke:[{stroke:["none",...Z()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["before","after","placeholder","file","marker","selection","first-line","first-letter","backdrop","*","**"]}},bre=(t,{cacheSize:e,prefix:r,experimentalParseClassName:n,extend:i={},override:a={}})=>(Oh(t,"cacheSize",e),Oh(t,"prefix",r),Oh(t,"experimentalParseClassName",n),rg(t.theme,a.theme),rg(t.classGroups,a.classGroups),rg(t.conflictingClassGroups,a.conflictingClassGroups),rg(t.conflictingClassGroupModifiers,a.conflictingClassGroupModifiers),Oh(t,"orderSensitiveModifiers",a.orderSensitiveModifiers),ng(t.theme,i.theme),ng(t.classGroups,i.classGroups),ng(t.conflictingClassGroups,i.conflictingClassGroups),ng(t.conflictingClassGroupModifiers,i.conflictingClassGroupModifiers),LB(t,i,"orderSensitiveModifiers"),t),Oh=(t,e,r)=>{r!==void 0&&(t[e]=r)},rg=(t,e)=>{if(e)for(const r in e)Oh(t,r,e[r])},ng=(t,e)=>{if(e)for(const r in e)LB(t,e,r)},LB=(t,e,r)=>{const n=e[r];n!==void 0&&(t[r]=t[r]?t[r].concat(n):n)},BB=(t,...e)=>typeof t=="function"?k1(O1,t,...e):k1(()=>bre(O1(),t),...e),_re=k1(O1);var Sre={twMerge:!0,twMergeConfig:{},responsiveVariants:!1},NB=t=>t||void 0,Fp=(...t)=>NB(CB(t).filter(Boolean).join(" ")),GS=null,To={},$1=!1,lh=(...t)=>e=>e.twMerge?((!GS||$1)&&($1=!1,GS=Kn(To)?_re:BB({...To,extend:{theme:To.theme,classGroups:To.classGroups,conflictingClassGroupModifiers:To.conflictingClassGroupModifiers,conflictingClassGroups:To.conflictingClassGroups,...To.extend}})),NB(GS(Fp(t)))):Fp(t),LI=(t,e)=>{for(let r in e)t.hasOwnProperty(r)?t[r]=Fp(t[r],e[r]):t[r]=e[r];return t},wre=(t,e)=>{let{extend:r=null,slots:n={},variants:i={},compoundVariants:a=[],compoundSlots:o=[],defaultVariants:s={}}=t,l={...Sre,...e},c=r!=null&&r.base?Fp(r.base,t==null?void 0:t.base):t==null?void 0:t.base,d=r!=null&&r.variants&&!Kn(r.variants)?DB(i,r.variants):i,h=r!=null&&r.defaultVariants&&!Kn(r.defaultVariants)?{...r.defaultVariants,...s}:s;!Kn(l.twMergeConfig)&&!Ote(l.twMergeConfig,To)&&($1=!0,To=l.twMergeConfig);let p=Kn(r==null?void 0:r.slots),m=Kn(n)?{}:{base:Fp(t==null?void 0:t.base,p&&(r==null?void 0:r.base)),...n},g=p?m:LI({...r==null?void 0:r.slots},Kn(m)?{base:t==null?void 0:t.base}:m),y=Kn(r==null?void 0:r.compoundVariants)?a:TB(r==null?void 0:r.compoundVariants,a),R=_=>{if(Kn(d)&&Kn(n)&&p)return lh(c,_==null?void 0:_.class,_==null?void 0:_.className)(l);if(y&&!Array.isArray(y))throw new TypeError(`The "compoundVariants" prop must be an array. Received: ${typeof y}`);if(o&&!Array.isArray(o))throw new TypeError(`The "compoundSlots" prop must be an array. Received: ${typeof o}`);let x=(J,$,le=[],ie)=>{let Z=le;if(typeof $=="string")Z=Z.concat(AI($).split(" ").map(te=>`${J}:${te}`));else if(Array.isArray($))Z=Z.concat($.reduce((te,H)=>te.concat(`${J}:${H}`),[]));else if(typeof $=="object"&&typeof ie=="string"){for(let te in $)if($.hasOwnProperty(te)&&te===ie){let H=$[te];if(H&&typeof H=="string"){let fe=AI(H);Z[ie]?Z[ie]=Z[ie].concat(fe.split(" ").map(ne=>`${J}:${ne}`)):Z[ie]=fe.split(" ").map(ne=>`${J}:${ne}`)}else Array.isArray(H)&&H.length>0&&(Z[ie]=H.reduce((fe,ne)=>fe.concat(`${J}:${ne}`),[]))}}return Z},T=(J,$=d,le=null,ie=null)=>{var Z;let te=$[J];if(!te||Kn(te))return null;let H=(Z=ie==null?void 0:ie[J])!=null?Z:_==null?void 0:_[J];if(H===null)return null;let fe=PI(H),ne=Array.isArray(l.responsiveVariants)&&l.responsiveVariants.length>0||l.responsiveVariants===!0,he=h==null?void 0:h[J],oe=[];if(typeof fe=="object"&&ne)for(let[Y,q]of Object.entries(fe)){let X=te[q];if(Y==="initial"){he=q;continue}Array.isArray(l.responsiveVariants)&&!l.responsiveVariants.includes(Y)||(oe=x(Y,X,oe,le))}let me=fe!=null&&typeof fe!="object"?fe:PI(he),ee=te[me||"false"];return typeof oe=="object"&&typeof le=="string"&&oe[le]?LI(oe,ee):oe.length>0?(oe.push(ee),le==="base"?oe.join(" "):oe):ee},I=()=>d?Object.keys(d).map(J=>T(J,d)):null,C=(J,$)=>{if(!d||typeof d!="object")return null;let le=new Array;for(let ie in d){let Z=T(ie,d,J,$),te=J==="base"&&typeof Z=="string"?Z:Z&&Z[J];te&&(le[le.length]=te)}return le},k={};for(let J in _)_[J]!==void 0&&(k[J]=_[J]);let S=(J,$)=>{var le;let ie=typeof(_==null?void 0:_[J])=="object"?{[J]:(le=_[J])==null?void 0:le.initial}:{};return{...h,...k,...ie,...$}},V=(J=[],$)=>{let le=[];for(let{class:ie,className:Z,...te}of J){let H=!0;for(let[fe,ne]of Object.entries(te)){let he=S(fe,$)[fe];if(Array.isArray(ne)){if(!ne.includes(he)){H=!1;break}}else{let oe=me=>me==null||me===!1;if(oe(ne)&&oe(he))continue;if(he!==ne){H=!1;break}}}H&&(ie&&le.push(ie),Z&&le.push(Z))}return le},z=J=>{let $=V(y,J);if(!Array.isArray($))return $;let le={};for(let ie of $)if(typeof ie=="string"&&(le.base=lh(le.base,ie)(l)),typeof ie=="object")for(let[Z,te]of Object.entries(ie))le[Z]=lh(le[Z],te)(l);return le},j=J=>{if(o.length<1)return null;let $={};for(let{slots:le=[],class:ie,className:Z,...te}of o){if(!Kn(te)){let H=!0;for(let fe of Object.keys(te)){let ne=S(fe,J)[fe];if(ne===void 0||(Array.isArray(te[fe])?!te[fe].includes(ne):te[fe]!==ne)){H=!1;break}}if(!H)continue}for(let H of le)$[H]=$[H]||[],$[H].push([ie,Z])}return $};if(!Kn(n)||!p){let J={};if(typeof g=="object"&&!Kn(g))for(let $ of Object.keys(g))J[$]=le=>{var ie,Z;return lh(g[$],C($,le),((ie=z(le))!=null?ie:[])[$],((Z=j(le))!=null?Z:[])[$],le==null?void 0:le.class,le==null?void 0:le.className)(l)};return J}return lh(c,I(),V(y),_==null?void 0:_.class,_==null?void 0:_.className)(l)},b=()=>{if(!(!d||typeof d!="object"))return Object.keys(d)};return R.variantKeys=b(),R.extend=r,R.base=c,R.slots=g,R.variants=d,R.defaultVariants=h,R.compoundSlots=o,R.compoundVariants=y,R},rr=(t,e)=>{var r,n,i;return wre(t,{...e,twMerge:(r=e==null?void 0:e.twMerge)!=null?r:!0,twMergeConfig:{...e==null?void 0:e.twMergeConfig,theme:{...(n=e==null?void 0:e.twMergeConfig)==null?void 0:n.theme,...M1.theme},classGroups:{...(i=e==null?void 0:e.twMergeConfig)==null?void 0:i.classGroups,...M1.classGroups}}})},BI=rr({slots:{base:"relative inline-flex flex-col gap-2 items-center justify-center",wrapper:"relative flex",label:"text-foreground dark:text-foreground-dark font-regular",circle1:"absolute w-full h-full rounded-full",circle2:"absolute w-full h-full rounded-full",dots:"relative rounded-full mx-auto",spinnerBars:["absolute","animate-fade-out","rounded-full","w-[25%]","h-[8%]","left-[calc(37.5%)]","top-[calc(46%)]","spinner-bar-animation"]},variants:{size:{sm:{wrapper:"w-5 h-5",circle1:"border-2",circle2:"border-2",dots:"size-1",label:"text-small"},md:{wrapper:"w-8 h-8",circle1:"border-3",circle2:"border-3",dots:"size-1.5",label:"text-medium"},lg:{wrapper:"w-10 h-10",circle1:"border-3",circle2:"border-3",dots:"size-2",label:"text-large"}},color:{current:{circle1:"border-b-current",circle2:"border-b-current",dots:"bg-current",spinnerBars:"bg-current"},white:{circle1:"border-b-white",circle2:"border-b-white",dots:"bg-white",spinnerBars:"bg-white"},default:{circle1:"border-b-default",circle2:"border-b-default",dots:"bg-default",spinnerBars:"bg-default"},primary:{circle1:"border-b-primary",circle2:"border-b-primary",dots:"bg-primary",spinnerBars:"bg-primary"},secondary:{circle1:"border-b-secondary",circle2:"border-b-secondary",dots:"bg-secondary",spinnerBars:"bg-secondary"},success:{circle1:"border-b-success",circle2:"border-b-success",dots:"bg-success",spinnerBars:"bg-success"},warning:{circle1:"border-b-warning",circle2:"border-b-warning",dots:"bg-warning",spinnerBars:"bg-warning"},danger:{circle1:"border-b-danger",circle2:"border-b-danger",dots:"bg-danger",spinnerBars:"bg-danger"}},labelColor:{foreground:{label:"text-foreground"},primary:{label:"text-primary"},secondary:{label:"text-secondary"},success:{label:"text-success"},warning:{label:"text-warning"},danger:{label:"text-danger"}},variant:{default:{circle1:["animate-spinner-ease-spin","border-solid","border-t-transparent","border-l-transparent","border-r-transparent"],circle2:["opacity-75","animate-spinner-linear-spin","border-dotted","border-t-transparent","border-l-transparent","border-r-transparent"]},gradient:{circle1:["border-0","bg-gradient-to-b","from-transparent","via-transparent","to-primary","animate-spinner-linear-spin","[animation-duration:1s]","[-webkit-mask:radial-gradient(closest-side,rgba(0,0,0,0.0)calc(100%-3px),rgba(0,0,0,1)calc(100%-3px))]"],circle2:["hidden"]},wave:{wrapper:"translate-y-3/4",dots:["animate-sway","spinner-dot-animation"]},dots:{wrapper:"translate-y-2/4",dots:["animate-blink","spinner-dot-blink-animation"]},spinner:{},simple:{wrapper:"text-foreground h-5 w-5 animate-spin",circle1:"opacity-25",circle2:"opacity-75"}}},defaultVariants:{size:"md",color:"primary",labelColor:"foreground",variant:"default"},compoundVariants:[{variant:"gradient",color:"current",class:{circle1:"to-current"}},{variant:"gradient",color:"white",class:{circle1:"to-white"}},{variant:"gradient",color:"default",class:{circle1:"to-default"}},{variant:"gradient",color:"primary",class:{circle1:"to-primary"}},{variant:"gradient",color:"secondary",class:{circle1:"to-secondary"}},{variant:"gradient",color:"success",class:{circle1:"to-success"}},{variant:"gradient",color:"warning",class:{circle1:"to-warning"}},{variant:"gradient",color:"danger",class:{circle1:"to-danger"}},{variant:"wave",size:"sm",class:{wrapper:"w-5 h-5"}},{variant:"wave",size:"md",class:{wrapper:"w-8 h-8"}},{variant:"wave",size:"lg",class:{wrapper:"w-12 h-12"}},{variant:"dots",size:"sm",class:{wrapper:"w-5 h-5"}},{variant:"dots",size:"md",class:{wrapper:"w-8 h-8"}},{variant:"dots",size:"lg",class:{wrapper:"w-12 h-12"}},{variant:"simple",size:"sm",class:{wrapper:"w-5 h-5"}},{variant:"simple",size:"md",class:{wrapper:"w-8 h-8"}},{variant:"simple",size:"lg",class:{wrapper:"w-12 h-12"}},{variant:"simple",color:"current",class:{wrapper:"text-current"}},{variant:"simple",color:"white",class:{wrapper:"text-white"}},{variant:"simple",color:"default",class:{wrapper:"text-default"}},{variant:"simple",color:"primary",class:{wrapper:"text-primary"}},{variant:"simple",color:"secondary",class:{wrapper:"text-secondary"}},{variant:"simple",color:"success",class:{wrapper:"text-success"}},{variant:"simple",color:"warning",class:{wrapper:"text-warning"}},{variant:"simple",color:"danger",class:{wrapper:"text-danger"}}]}),es=["outline-hidden","data-[focus-visible=true]:z-10","data-[focus-visible=true]:outline-2","data-[focus-visible=true]:outline-focus","data-[focus-visible=true]:outline-offset-2"],Ere=["outline-hidden","group-data-[focus-visible=true]:z-10","group-data-[focus-visible=true]:ring-2","group-data-[focus-visible=true]:ring-focus","group-data-[focus-visible=true]:ring-offset-2","group-data-[focus-visible=true]:ring-offset-background"],xre=["outline-hidden","ring-2","ring-focus","ring-offset-2","ring-offset-background"],gc={default:["[&+.border-medium.border-default]:ms-[calc(var(--heroui-border-width-medium)*-1)]"],primary:["[&+.border-medium.border-primary]:ms-[calc(var(--heroui-border-width-medium)*-1)]"],secondary:["[&+.border-medium.border-secondary]:ms-[calc(var(--heroui-border-width-medium)*-1)]"],success:["[&+.border-medium.border-success]:ms-[calc(var(--heroui-border-width-medium)*-1)]"],warning:["[&+.border-medium.border-warning]:ms-[calc(var(--heroui-border-width-medium)*-1)]"],danger:["[&+.border-medium.border-danger]:ms-[calc(var(--heroui-border-width-medium)*-1)]"]},Cre=rr({slots:{base:"relative z-[100]"},variants:{disableAnimation:{false:{base:""},true:{base:["data-[placement=bottom-right]:bottom-0 data-[placement=bottom-right]:right-0 w-full px-2 sm:w-auto sm:px-0 data-[placement=bottom-right]:fixed data-[placement=bottom-right]:flex data-[placement=bottom-right]:flex-col","data-[placement=bottom-left]:bottom-0 data-[placement=bottom-left]:left-0 w-full px-2 sm:w-auto sm:px-0 data-[placement=bottom-left]:fixed data-[placement=bottom-left]:flex data-[placement=bottom-left]:flex-col","data-[placement=bottom-center]:bottom-0 data-[placement=bottom-center]:fixed w-full px-2 sm:w-auto sm:px-0 data-[placement=bottom-center]:flex data-[placement=bottom-center]:flex-col data-[placement=bottom-center]:left-1/2 data-[placement=bottom-center]:-translate-x-1/2","data-[placement=top-right]:top-0 data-[placement=top-right]:right-0 w-full px-2 sm:w-auto sm:px-0 data-[placement=top-right]:fixed data-[placement=top-right]:flex data-[placement=top-right]:flex-col","data-[placement=top-left]:top-0 data-[placement=top-left]:left-0 w-full px-2 sm:w-auto sm:px-0 data-[placement=top-left]:fixed data-[placement=top-left]:flex data-[placement=top-left]:flex-col","data-[placement=top-center]:top-0 data-[placement=top-center]:fixed w-full px-2 sm:w-auto sm:px-0 data-[placement=top-center]:flex data-[placement=top-center]:flex-col data-[placement=top-center]:left-1/2 data-[placement=top-center]:-translate-x-1/2"]}}},defaultVariants:{disableAnimation:!1}}),NI=rr({slots:{base:["flex gap-x-4 items-center","group","cursor-pointer","relative","z-50","box-border","outline-none","p-3 sm:mx-1","my-1","w-full sm:w-[356px]","min-h-4","before:content-['']","before:absolute","before:left-0","before:right-0","before:h-[var(--top-extension,16px)]","before:top-[calc(-1*var(--top-extension,16px))]","before:z-[-1]","before:pointer-events-auto","before:bg-transparent","after:content-['']","after:absolute","after:left-0","after:right-0","after:h-[var(--bottom-extension,16px)]","after:bottom-[calc(-1*var(--bottom-extension,16px))]","after:z-[-1]","after:pointer-events-auto","after:bg-transparent","transform-gpu","will-change-transform","backface-visibility-hidden"],wrapper:["flex flex-col gap-y-0"],title:["text-sm","me-4","font-medium","text-foreground"],description:["text-sm","me-4","text-default-500"],icon:["w-6 h-6 flex-none fill-current"],loadingIcon:["w-6 h-6 flex-none fill-current"],content:["flex flex-grow flex-row gap-x-4 items-center relative"],progressTrack:["absolute inset-0 pointer-events-none bg-transparent overflow-hidden"],progressIndicator:["h-full bg-default-400 opacity-20"],motionDiv:["fixed","px-4 sm:px-0","data-[placement=bottom-right]:bottom-0 data-[placement=bottom-right]:right-0 data-[placement=bottom-right]:mx-auto w-full sm:data-[placement=bottom-right]:w-max mb-1 sm:data-[placement=bottom-right]:mr-2","data-[placement=bottom-left]:bottom-0 data-[placement=bottom-left]:left-0 data-[placement=bottom-left]:mx-auto w-full sm:data-[placement=bottom-left]:w-max mb-1 sm:data-[placement=bottom-left]:ml-2","data-[placement=bottom-center]:bottom-0 data-[placement=bottom-center]:left-0 data-[placement=bottom-center]:right-0 w-full sm:data-[placement=bottom-center]:w-max sm:data-[placement=bottom-center]:mx-auto","data-[placement=top-right]:top-0 data-[placement=top-right]:right-0 data-[placement=top-right]:mx-auto w-full sm:data-[placement=top-right]:w-max sm:data-[placement=top-right]:mr-2","data-[placement=top-left]:top-0 data-[placement=top-left]:left-0 data-[placement=top-left]:mx-auto w-full sm:data-[placement=top-left]:w-max sm:data-[placement=top-left]:ml-2","data-[placement=top-center]:top-0 data-[placement=top-center]:left-0 data-[placement=top-center]:right-0 w-full sm:data-[placement=top-center]:w-max sm:data-[placement=top-center]:mx-auto"],closeButton:["opacity-0 group-hover:opacity-100","transform-gpu","transition-all duration-200 ease-out","will-change-opacity will-change-transform","p-0 group-hover:pointer-events-auto w-6 h-6 min-w-4 absolute -right-2 -top-2 items-center justify-center bg-transparent text-default-400 hover:text-default-600 border border-3 border-transparent","data-[hidden=true]:hidden"],closeIcon:["rounded-full w-full h-full p-0.5 border border-default-400 bg-default-100"]},variants:{size:{sm:{icon:"w-5 h-5",loadingIcon:"w-5 h-5"},md:{},lg:{}},variant:{flat:"bg-content1 border border-default-100",solid:Ae.solid.default,bordered:"bg-background border border-default-200"},color:{default:"",foreground:{progressIndicator:"h-full opacity-20 bg-foreground-400"},primary:{progressIndicator:"h-full opacity-20 bg-primary-400"},secondary:{progressIndicator:"h-full opacity-20 bg-secondary-400"},success:{progressIndicator:"h-full opacity-20 bg-success-400"},warning:{progressIndicator:"h-full opacity-20 bg-warning-400"},danger:{progressIndicator:"h-full opacity-20 bg-danger-400"}},radius:{none:{base:"rounded-none",progressTrack:"rounded-none"},sm:{base:"rounded-small",progressTrack:"rounded-small"},md:{base:"rounded-medium",progressTrack:"rounded-medium"},lg:{base:"rounded-large",progressTrack:"rounded-large"},full:{base:"rounded-full",closeButton:"-top-px -right-px",progressTrack:"rounded-full"}},disableAnimation:{true:{closeButton:"transition-none",base:"data-[animation=exiting]:opacity-0 transition-none"},false:{closeButton:"transition-all ease-out duration-200",base:["data-[toast-exiting=true]:transform-gpu","data-[toast-exiting=true]:will-change-transform","data-[toast-exiting=true]:transition-all","data-[toast-exiting=true]:ease-out","data-[toast-exiting=true]:data-[placement=bottom-right]:translate-x-full","data-[toast-exiting=true]:data-[placement=bottom-left]:-translate-x-full","data-[toast-exiting=true]:data-[placement=bottom-center]:translate-y-full","data-[toast-exiting=true]:data-[placement=top-right]:translate-x-full","data-[toast-exiting=true]:data-[placement=top-left]:-translate-x-full","data-[toast-exiting=true]:data-[placement=top-center]:-translate-y-full","data-[toast-exiting=true]:opacity-0","data-[toast-exiting=true]:duration-300","data-[toast-exiting=true]:ease-out"]}},shadow:{none:{base:"shadow-none"},sm:{base:"shadow-small"},md:{base:"shadow-medium"},lg:{base:"shadow-large"}}},defaultVariants:{size:"md",variant:"flat",radius:"md",shadow:"sm"},compoundVariants:[{variant:"flat",color:"foreground",class:{base:"bg-foreground text-background",closeButton:"text-foreground-400 hover:text-foreground-600",closeIcon:"border border-foreground-400 bg-foreground-100",title:"text-background-600",description:"text-background-500"}},{variant:"flat",color:"primary",class:{base:"bg-primary-50 text-primary-600 border-primary-100",closeButton:"text-primary-400 hover:text-primary-600",closeIcon:"border border-primary-400 bg-primary-100",title:"text-primary-600",description:"text-primary-500"}},{variant:"flat",color:"secondary",class:{base:"bg-secondary-50 text-secondary-600 border-secondary-100",closeButton:"text-secondary-400 hover:text-secondary-600",closeIcon:"border border-secondary-400 bg-secondary-100",title:"text-secondary-600",description:"text-secondary-500"}},{variant:"flat",color:"success",class:{base:"bg-success-50 text-success-600 border-success-100",closeButton:"text-success-400 hover:text-success-600",closeIcon:"border border-success-400 bg-success-100",title:"text-success-600",description:"text-success-500"}},{variant:"flat",color:"warning",class:{base:"bg-warning-50 text-warning-600 border-warning-100",closeButton:"text-warning-400 hover:text-warning-600",closeIcon:"border border-warning-400 bg-warning-100",title:"text-warning-600",description:"text-warning-500"}},{variant:"flat",color:"danger",class:{base:"bg-danger-50 text-danger-600 border-danger-100",closeButton:"text-danger-400 hover:text-danger-600",closeIcon:"border border-danger-400 bg-danger-100",title:"text-danger-600",description:"text-danger-500"}},{variant:"bordered",color:"foreground",class:{base:"bg-foreground border-foreground-400 text-background",closeButton:"text-foreground-400 hover:text-foreground-600",closeIcon:"border border-foreground-400 bg-foreground-100",title:"text-background-600",description:"text-background-500"}},{variant:"bordered",color:"primary",class:{base:"border-primary-400 text-primary-600",closeButton:"text-primary-400 hover:text-primary-600",closeIcon:"border border-primary-400 bg-primary-100",title:"text-primary-600",description:"text-primary-500"}},{variant:"bordered",color:"secondary",class:{base:"border-secondary-400 text-secondary-600",closeButton:"text-secondary-400 hover:text-secondary-600",closeIcon:"border border-secondary-400 bg-secondary-100",title:"text-secondary-600",description:"text-secondary-500"}},{variant:"bordered",color:"success",class:{base:"border-success-400 text-success-600",closeButton:"text-success-400 hover:text-success-600",closeIcon:"border border-success-400 bg-success-100",title:"text-success-600",description:"text-success-500"}},{variant:"bordered",color:"warning",class:{base:"border-warning-400 text-warning-600",closeButton:"text-warning-400 hover:text-warning-600",closeIcon:"border border-warning-400 bg-warning-100",title:"text-warning-600",description:"text-warning-500"}},{variant:"bordered",color:"danger",class:{base:"border-danger-400 text-danger-600",closeButton:"text-danger-400 hover:text-danger-600",closeIcon:"border border-danger-400 bg-danger-100",title:"text-danger-600",description:"text-danger-500"}},{variant:"solid",color:"foreground",class:{base:Ae.solid.foreground,closeButton:"text-foreground-400 hover:text-foreground-600",closeIcon:"border border-foreground-400 bg-foreground-100",title:"text-background",description:"text-background"}},{variant:"solid",color:"primary",class:{base:Ae.solid.primary,closeButton:"text-primary-400 hover:text-primary-600",closeIcon:"border border-primary-400 bg-primary-100",title:"text-primary-foreground",description:"text-primary-foreground"}},{variant:"solid",color:"secondary",class:{base:Ae.solid.secondary,closeButton:"text-secondary-400 hover:text-secondary-600",closeIcon:"border border-secondary-400 bg-secondary-100",title:"text-secondary-foreground",description:"text-secondary-foreground"}},{variant:"solid",color:"success",class:{base:Ae.solid.success,closeButton:"text-success-400 hover:text-success-600",closeIcon:"border border-success-400 bg-success-100",title:"text-success-foreground",description:"text-success-foreground"}},{variant:"solid",color:"warning",class:{base:Ae.solid.warning,closeButton:"text-warning-400 hover:text-warning-600",closeIcon:"border border-warning-400 bg-warning-100",title:"text-warning-foreground",description:"text-warning-foreground"}},{variant:"solid",color:"danger",class:{base:Ae.solid.danger,closeButton:"text-danger-400 hover:text-danger-600",closeIcon:"border border-danger-400 bg-danger-100",title:"text-danger-foreground",description:"text-danger-foreground"}}]}),UI=rr({slots:{base:["z-0","relative","bg-transparent","before:content-['']","before:hidden","before:z-[-1]","before:absolute","before:rotate-45","before:w-2.5","before:h-2.5","before:rounded-sm","data-[arrow=true]:before:block","data-[placement=top]:before:-bottom-[calc(theme(spacing.5)/4_-_1.5px)]","data-[placement=top]:before:left-1/2","data-[placement=top]:before:-translate-x-1/2","data-[placement=top-start]:before:-bottom-[calc(theme(spacing.5)/4_-_1.5px)]","data-[placement=top-start]:before:left-3","data-[placement=top-end]:before:-bottom-[calc(theme(spacing.5)/4_-_1.5px)]","data-[placement=top-end]:before:right-3","data-[placement=bottom]:before:-top-[calc(theme(spacing.5)/4_-_1.5px)]","data-[placement=bottom]:before:left-1/2","data-[placement=bottom]:before:-translate-x-1/2","data-[placement=bottom-start]:before:-top-[calc(theme(spacing.5)/4_-_1.5px)]","data-[placement=bottom-start]:before:left-3","data-[placement=bottom-end]:before:-top-[calc(theme(spacing.5)/4_-_1.5px)]","data-[placement=bottom-end]:before:right-3","data-[placement=left]:before:-right-[calc(theme(spacing.5)/4_-_2px)]","data-[placement=left]:before:top-1/2","data-[placement=left]:before:-translate-y-1/2","data-[placement=left-start]:before:-right-[calc(theme(spacing.5)/4_-_3px)]","data-[placement=left-start]:before:top-1/4","data-[placement=left-end]:before:-right-[calc(theme(spacing.5)/4_-_3px)]","data-[placement=left-end]:before:bottom-1/4","data-[placement=right]:before:-left-[calc(theme(spacing.5)/4_-_2px)]","data-[placement=right]:before:top-1/2","data-[placement=right]:before:-translate-y-1/2","data-[placement=right-start]:before:-left-[calc(theme(spacing.5)/4_-_3px)]","data-[placement=right-start]:before:top-1/4","data-[placement=right-end]:before:-left-[calc(theme(spacing.5)/4_-_3px)]","data-[placement=right-end]:before:bottom-1/4",...es],content:["z-10","px-2.5","py-1","w-full","inline-flex","flex-col","items-center","justify-center","box-border","subpixel-antialiased","outline-hidden","box-border"],trigger:["z-10"],backdrop:["hidden"],arrow:[]},variants:{size:{sm:{content:"text-tiny"},md:{content:"text-small"},lg:{content:"text-medium"}},color:{default:{base:"before:bg-content1 before:shadow-small",content:"bg-content1"},foreground:{base:"before:bg-foreground",content:Ae.solid.foreground},primary:{base:"before:bg-primary",content:Ae.solid.primary},secondary:{base:"before:bg-secondary",content:Ae.solid.secondary},success:{base:"before:bg-success",content:Ae.solid.success},warning:{base:"before:bg-warning",content:Ae.solid.warning},danger:{base:"before:bg-danger",content:Ae.solid.danger}},radius:{none:{content:"rounded-none"},sm:{content:"rounded-small"},md:{content:"rounded-medium"},lg:{content:"rounded-large"},full:{content:"rounded-full"}},shadow:{none:{content:"shadow-none"},sm:{content:"shadow-small"},md:{content:"shadow-medium"},lg:{content:"shadow-large"}},backdrop:{transparent:{},opaque:{backdrop:"bg-overlay/50 backdrop-opacity-disabled"},blur:{backdrop:"backdrop-blur-sm backdrop-saturate-150 bg-overlay/30"}},triggerScaleOnOpen:{true:{trigger:["aria-expanded:scale-[0.97]","aria-expanded:opacity-70","subpixel-antialiased"]},false:{}},disableAnimation:{true:{base:"animate-none"}},isTriggerDisabled:{true:{trigger:"opacity-disabled pointer-events-none"},false:{}}},defaultVariants:{color:"default",radius:"lg",size:"md",shadow:"md",backdrop:"transparent",triggerScaleOnOpen:!0},compoundVariants:[{backdrop:["opaque","blur"],class:{backdrop:"block w-full h-full fixed inset-0 -z-30"}}]}),FI=rr({slots:{base:"flex flex-col gap-2 w-full",label:"",labelWrapper:"flex justify-between",value:"",track:"z-0 relative bg-default-300/50 overflow-hidden rtl:rotate-180",indicator:"h-full"},variants:{color:{default:{indicator:"bg-default-400"},primary:{indicator:"bg-primary"},secondary:{indicator:"bg-secondary"},success:{indicator:"bg-success"},warning:{indicator:"bg-warning"},danger:{indicator:"bg-danger"}},size:{sm:{label:"text-small",value:"text-small",track:"h-1"},md:{label:"text-medium",value:"text-medium",track:"h-3"},lg:{label:"text-large",value:"text-large",track:"h-5"}},radius:{none:{track:"rounded-none",indicator:"rounded-none"},sm:{track:"rounded-small",indicator:"rounded-small"},md:{track:"rounded-medium",indicator:"rounded-medium"},lg:{track:"rounded-large",indicator:"rounded-large"},full:{track:"rounded-full",indicator:"rounded-full"}},isStriped:{true:{indicator:"bg-stripe-gradient-default bg-stripe-size"}},isIndeterminate:{true:{indicator:["absolute","w-full","origin-left","animate-indeterminate-bar"]}},isDisabled:{true:{base:"opacity-disabled cursor-not-allowed"}},disableAnimation:{true:{},false:{indicator:"transition-transform !duration-500"}}},defaultVariants:{color:"primary",size:"md",radius:"full",isStriped:!1,isIndeterminate:!1,isDisabled:!1},compoundVariants:[{disableAnimation:!0,isIndeterminate:!1,class:{indicator:"!transition-none motion-reduce:transition-none"}},{color:"primary",isStriped:!0,class:{indicator:"bg-stripe-gradient-primary bg-stripe-size"}},{color:"secondary",isStriped:!0,class:{indicator:"bg-stripe-gradient-secondary bg-stripe-size"}},{color:"success",isStriped:!0,class:{indicator:"bg-stripe-gradient-success bg-stripe-size"}},{color:"warning",isStriped:!0,class:{indicator:"bg-stripe-gradient-warning bg-stripe-size"}},{color:"danger",isStriped:!0,class:{indicator:"bg-stripe-gradient-danger bg-stripe-size"}}]},{twMerge:!0});rr({slots:{base:"flex flex-col justify-center gap-1 max-w-fit items-center",label:"",svgWrapper:"relative block",svg:"z-0 relative overflow-hidden",track:"h-full stroke-default-300/50",indicator:"h-full stroke-current",value:"absolute font-normal inset-0 flex items-center justify-center"},variants:{color:{default:{svg:"text-default-400"},primary:{svg:"text-primary"},secondary:{svg:"text-secondary"},success:{svg:"text-success"},warning:{svg:"text-warning"},danger:{svg:"text-danger"}},size:{sm:{svg:"w-8 h-8",label:"text-small",value:"text-[0.5rem]"},md:{svg:"w-10 h-10",label:"text-small",value:"text-[0.55rem]"},lg:{svg:"w-12 h-12",label:"text-medium",value:"text-[0.6rem]"}},isIndeterminate:{true:{svg:"animate-spinner-ease-spin"}},isDisabled:{true:{base:"opacity-disabled cursor-not-allowed"}},disableAnimation:{true:{},false:{indicator:"transition-all !duration-500"}}},defaultVariants:{color:"primary",size:"md",isDisabled:!1},compoundVariants:[{disableAnimation:!0,isIndeterminate:!1,class:{svg:"!transition-none motion-reduce:transition-none"}}]});var jI=rr({slots:{base:"group flex flex-col data-[hidden=true]:hidden",label:["absolute","z-10","pointer-events-none","origin-top-left","shrink-0","rtl:origin-top-right","subpixel-antialiased","block","text-small","text-foreground-500"],mainWrapper:"h-full",inputWrapper:"relative w-full inline-flex tap-highlight-transparent flex-row items-center shadow-xs px-3 gap-3",innerWrapper:"inline-flex w-full items-center h-full box-border",input:["w-full font-normal bg-transparent !outline-hidden placeholder:text-foreground-500 focus-visible:outline-hidden","data-[has-start-content=true]:ps-1.5","data-[has-end-content=true]:pe-1.5","data-[type=color]:rounded-none","file:cursor-pointer file:bg-transparent file:border-0","autofill:bg-transparent bg-clip-text"],clearButton:["p-2","-m-2","z-10","absolute","end-3","start-auto","pointer-events-none","appearance-none","outline-hidden","select-none","opacity-0","hover:!opacity-100","cursor-pointer","active:!opacity-70","rounded-full",...es],helperWrapper:"hidden group-data-[has-helper=true]:flex p-1 relative flex-col gap-1.5",description:"text-tiny text-foreground-400",errorMessage:"text-tiny text-danger"},variants:{variant:{flat:{inputWrapper:["bg-default-100","data-[hover=true]:bg-default-200","group-data-[focus=true]:bg-default-100"]},faded:{inputWrapper:["bg-default-100","border-medium","border-default-200","data-[hover=true]:border-default-400 focus-within:border-default-400"],value:"group-data-[has-value=true]:text-default-foreground"},bordered:{inputWrapper:["border-medium","border-default-200","data-[hover=true]:border-default-400","group-data-[focus=true]:border-default-foreground"]},underlined:{inputWrapper:["!px-1","!pb-0","!gap-0","relative","box-border","border-b-medium","shadow-[0_1px_0px_0_rgba(0,0,0,0.05)]","border-default-200","!rounded-none","hover:border-default-300","after:content-['']","after:w-0","after:origin-center","after:bg-default-foreground","after:absolute","after:left-1/2","after:-translate-x-1/2","after:-bottom-[2px]","after:h-[2px]","group-data-[focus=true]:after:w-full"],innerWrapper:"pb-1",label:"group-data-[filled-within=true]:text-foreground"}},color:{default:{},primary:{},secondary:{},success:{},warning:{},danger:{}},size:{sm:{label:"text-tiny",inputWrapper:"h-8 min-h-8 px-2 rounded-small",input:"text-small",clearButton:"text-medium"},md:{inputWrapper:"h-10 min-h-10 rounded-medium",input:"text-small",clearButton:"text-large"},lg:{label:"text-medium",inputWrapper:"h-12 min-h-12 rounded-large",input:"text-medium",clearButton:"text-large"}},radius:{none:{inputWrapper:"rounded-none"},sm:{inputWrapper:"rounded-small"},md:{inputWrapper:"rounded-medium"},lg:{inputWrapper:"rounded-large"},full:{inputWrapper:"rounded-full"}},labelPlacement:{outside:{mainWrapper:"flex flex-col"},"outside-left":{base:"flex-row items-center flex-nowrap data-[has-helper=true]:items-start",inputWrapper:"flex-1",mainWrapper:"flex flex-col",label:"relative text-foreground pe-2 ps-2 pointer-events-auto"},inside:{label:"cursor-text",inputWrapper:"flex-col items-start justify-center gap-0",innerWrapper:"group-data-[has-label=true]:items-end"}},fullWidth:{true:{base:"w-full"},false:{}},isClearable:{true:{input:"peer pe-6 input-search-cancel-button-none",clearButton:["peer-data-[filled=true]:pointer-events-auto","peer-data-[filled=true]:opacity-70 peer-data-[filled=true]:block","peer-data-[filled=true]:scale-100"]}},isDisabled:{true:{base:"opacity-disabled pointer-events-none",inputWrapper:"pointer-events-none",label:"pointer-events-none"}},isInvalid:{true:{label:"!text-danger",input:"!placeholder:text-danger !text-danger"}},isRequired:{true:{label:"after:content-['*'] after:text-danger after:ms-0.5"}},isMultiline:{true:{label:"relative",inputWrapper:"!h-auto",innerWrapper:"items-start group-data-[has-label=true]:items-start",input:"resize-none data-[hide-scroll=true]:scrollbar-hide",clearButton:"absolute top-2 right-2 rtl:right-auto rtl:left-2 z-10"}},disableAnimation:{true:{input:"transition-none",inputWrapper:"transition-none",label:"transition-none"},false:{inputWrapper:"transition-background motion-reduce:transition-none !duration-150",label:["will-change-auto","!duration-200","!ease-out","motion-reduce:transition-none","transition-[transform,color,left,opacity,translate,scale]"],clearButton:["scale-90","ease-out","duration-150","transition-[opacity,transform]","motion-reduce:transition-none","motion-reduce:scale-100"]}}},defaultVariants:{variant:"flat",color:"default",size:"md",fullWidth:!0,isDisabled:!1,isMultiline:!1},compoundVariants:[{variant:"flat",color:"default",class:{input:"group-data-[has-value=true]:text-default-foreground"}},{variant:"flat",color:"primary",class:{inputWrapper:["bg-primary-100","data-[hover=true]:bg-primary-50","text-primary","group-data-[focus=true]:bg-primary-50","placeholder:text-primary"],input:"placeholder:text-primary",label:"text-primary"}},{variant:"flat",color:"secondary",class:{inputWrapper:["bg-secondary-100","text-secondary","data-[hover=true]:bg-secondary-50","group-data-[focus=true]:bg-secondary-50","placeholder:text-secondary"],input:"placeholder:text-secondary",label:"text-secondary"}},{variant:"flat",color:"success",class:{inputWrapper:["bg-success-100","text-success-600","dark:text-success","placeholder:text-success-600","dark:placeholder:text-success","data-[hover=true]:bg-success-50","group-data-[focus=true]:bg-success-50"],input:"placeholder:text-success-600 dark:placeholder:text-success",label:"text-success-600 dark:text-success"}},{variant:"flat",color:"warning",class:{inputWrapper:["bg-warning-100","text-warning-600","dark:text-warning","placeholder:text-warning-600","dark:placeholder:text-warning","data-[hover=true]:bg-warning-50","group-data-[focus=true]:bg-warning-50"],input:"placeholder:text-warning-600 dark:placeholder:text-warning",label:"text-warning-600 dark:text-warning"}},{variant:"flat",color:"danger",class:{inputWrapper:["bg-danger-100","text-danger","dark:text-danger-500","placeholder:text-danger","dark:placeholder:text-danger-500","data-[hover=true]:bg-danger-50","group-data-[focus=true]:bg-danger-50"],input:"placeholder:text-danger dark:placeholder:text-danger-500",label:"text-danger dark:text-danger-500"}},{variant:"faded",color:"primary",class:{label:"text-primary",inputWrapper:"data-[hover=true]:border-primary focus-within:border-primary"}},{variant:"faded",color:"secondary",class:{label:"text-secondary",inputWrapper:"data-[hover=true]:border-secondary focus-within:border-secondary"}},{variant:"faded",color:"success",class:{label:"text-success",inputWrapper:"data-[hover=true]:border-success focus-within:border-success"}},{variant:"faded",color:"warning",class:{label:"text-warning",inputWrapper:"data-[hover=true]:border-warning focus-within:border-warning"}},{variant:"faded",color:"danger",class:{label:"text-danger",inputWrapper:"data-[hover=true]:border-danger focus-within:border-danger"}},{variant:"underlined",color:"default",class:{input:"group-data-[has-value=true]:text-foreground"}},{variant:"underlined",color:"primary",class:{inputWrapper:"after:bg-primary",label:"text-primary"}},{variant:"underlined",color:"secondary",class:{inputWrapper:"after:bg-secondary",label:"text-secondary"}},{variant:"underlined",color:"success",class:{inputWrapper:"after:bg-success",label:"text-success"}},{variant:"underlined",color:"warning",class:{inputWrapper:"after:bg-warning",label:"text-warning"}},{variant:"underlined",color:"danger",class:{inputWrapper:"after:bg-danger",label:"text-danger"}},{variant:"bordered",color:"primary",class:{inputWrapper:"group-data-[focus=true]:border-primary",label:"text-primary"}},{variant:"bordered",color:"secondary",class:{inputWrapper:"group-data-[focus=true]:border-secondary",label:"text-secondary"}},{variant:"bordered",color:"success",class:{inputWrapper:"group-data-[focus=true]:border-success",label:"text-success"}},{variant:"bordered",color:"warning",class:{inputWrapper:"group-data-[focus=true]:border-warning",label:"text-warning"}},{variant:"bordered",color:"danger",class:{inputWrapper:"group-data-[focus=true]:border-danger",label:"text-danger"}},{labelPlacement:"inside",color:"default",class:{label:"group-data-[filled-within=true]:text-default-600"}},{labelPlacement:"outside",color:"default",class:{label:"group-data-[filled-within=true]:text-foreground"}},{radius:"full",size:["sm"],class:{inputWrapper:"px-3"}},{radius:"full",size:"md",class:{inputWrapper:"px-4"}},{radius:"full",size:"lg",class:{inputWrapper:"px-5"}},{disableAnimation:!1,variant:["faded","bordered"],class:{inputWrapper:"transition-colors motion-reduce:transition-none"}},{disableAnimation:!1,variant:"underlined",class:{inputWrapper:"after:transition-width motion-reduce:after:transition-none"}},{variant:["flat","faded"],class:{inputWrapper:[...Ere]}},{isInvalid:!0,variant:"flat",class:{inputWrapper:["!bg-danger-50","data-[hover=true]:!bg-danger-100","group-data-[focus=true]:!bg-danger-50"]}},{isInvalid:!0,variant:"bordered",class:{inputWrapper:"!border-danger group-data-[focus=true]:!border-danger"}},{isInvalid:!0,variant:"underlined",class:{inputWrapper:"after:!bg-danger"}},{labelPlacement:"inside",size:"sm",class:{inputWrapper:"h-12 py-1.5 px-3"}},{labelPlacement:"inside",size:"md",class:{inputWrapper:"h-14 py-2"}},{labelPlacement:"inside",size:"lg",class:{inputWrapper:"h-16 py-2.5 gap-0"}},{labelPlacement:"inside",size:"sm",variant:["bordered","faded"],class:{inputWrapper:"py-1"}},{labelPlacement:["inside","outside"],class:{label:["group-data-[filled-within=true]:pointer-events-auto"]}},{labelPlacement:"outside",isMultiline:!1,class:{base:"relative justify-end",label:["pb-0","z-20","top-1/2","-translate-y-1/2","group-data-[filled-within=true]:start-0"]}},{labelPlacement:["inside"],class:{label:["group-data-[filled-within=true]:scale-85"]}},{labelPlacement:["inside"],variant:"flat",class:{innerWrapper:"pb-0.5"}},{variant:"underlined",size:"sm",class:{innerWrapper:"pb-1"}},{variant:"underlined",size:["md","lg"],class:{innerWrapper:"pb-1.5"}},{labelPlacement:"inside",size:["sm","md"],class:{label:"text-small"}},{labelPlacement:"inside",isMultiline:!1,size:"sm",class:{label:["group-data-[filled-within=true]:-translate-y-[calc(50%_+_var(--heroui-font-size-tiny)/2_-_8px)]"]}},{labelPlacement:"inside",isMultiline:!1,size:"md",class:{label:["group-data-[filled-within=true]:-translate-y-[calc(50%_+_var(--heroui-font-size-small)/2_-_6px)]"]}},{labelPlacement:"inside",isMultiline:!1,size:"lg",class:{label:["text-medium","group-data-[filled-within=true]:-translate-y-[calc(50%_+_var(--heroui-font-size-small)/2_-_8px)]"]}},{labelPlacement:"inside",variant:["faded","bordered"],isMultiline:!1,size:"sm",class:{label:["group-data-[filled-within=true]:-translate-y-[calc(50%_+_var(--heroui-font-size-tiny)/2_-_8px_-_var(--heroui-border-width-medium))]"]}},{labelPlacement:"inside",variant:["faded","bordered"],isMultiline:!1,size:"md",class:{label:["group-data-[filled-within=true]:-translate-y-[calc(50%_+_var(--heroui-font-size-small)/2_-_6px_-_var(--heroui-border-width-medium))]"]}},{labelPlacement:"inside",variant:["faded","bordered"],isMultiline:!1,size:"lg",class:{label:["text-medium","group-data-[filled-within=true]:-translate-y-[calc(50%_+_var(--heroui-font-size-small)/2_-_8px_-_var(--heroui-border-width-medium))]"]}},{labelPlacement:"inside",variant:"underlined",isMultiline:!1,size:"sm",class:{label:["group-data-[filled-within=true]:-translate-y-[calc(50%_+_var(--heroui-font-size-tiny)/2_-_5px)]"]}},{labelPlacement:"inside",variant:"underlined",isMultiline:!1,size:"md",class:{label:["group-data-[filled-within=true]:-translate-y-[calc(50%_+_var(--heroui-font-size-small)/2_-_3.5px)]"]}},{labelPlacement:"inside",variant:"underlined",size:"lg",isMultiline:!1,class:{label:["text-medium","group-data-[filled-within=true]:-translate-y-[calc(50%_+_var(--heroui-font-size-small)/2_-_4px)]"]}},{labelPlacement:"outside",size:"sm",isMultiline:!1,class:{label:["start-2","text-tiny","group-data-[filled-within=true]:-translate-y-[calc(100%_+_var(--heroui-font-size-tiny)/2_+_16px)]"],base:"data-[has-label=true]:mt-[calc(var(--heroui-font-size-small)_+_8px)]"}},{labelPlacement:"outside",size:"md",isMultiline:!1,class:{label:["start-3","end-auto","text-small","group-data-[filled-within=true]:-translate-y-[calc(100%_+_var(--heroui-font-size-small)/2_+_20px)]"],base:"data-[has-label=true]:mt-[calc(var(--heroui-font-size-small)_+_10px)]"}},{labelPlacement:"outside",size:"lg",isMultiline:!1,class:{label:["start-3","end-auto","text-medium","group-data-[filled-within=true]:-translate-y-[calc(100%_+_var(--heroui-font-size-small)/2_+_24px)]"],base:"data-[has-label=true]:mt-[calc(var(--heroui-font-size-small)_+_12px)]"}},{labelPlacement:"outside-left",size:"sm",class:{label:"group-data-[has-helper=true]:pt-2"}},{labelPlacement:"outside-left",size:"md",class:{label:"group-data-[has-helper=true]:pt-3"}},{labelPlacement:"outside-left",size:"lg",class:{label:"group-data-[has-helper=true]:pt-4"}},{labelPlacement:["outside","outside-left"],isMultiline:!0,class:{inputWrapper:"py-2"}},{labelPlacement:"outside",isMultiline:!0,class:{label:"pb-1.5"}},{labelPlacement:"inside",isMultiline:!0,class:{label:"pb-0.5",input:"pt-0"}},{isMultiline:!0,disableAnimation:!1,class:{input:"transition-height !duration-100 motion-reduce:transition-none"}},{labelPlacement:["inside","outside"],class:{label:["pe-2","max-w-full","text-ellipsis","overflow-hidden"]}},{isMultiline:!0,radius:"full",class:{inputWrapper:"data-[has-multiple-rows=true]:rounded-large"}},{isClearable:!0,isMultiline:!0,class:{clearButton:["group-data-[has-value=true]:opacity-70 group-data-[has-value=true]:block","group-data-[has-value=true]:scale-100","group-data-[has-value=true]:pointer-events-auto"]}}]}),Tre=rr({slots:{base:"w-full relative flex flex-col gap-1 p-1 overflow-clip",list:"w-full flex flex-col gap-0.5 outline-hidden",emptyContent:["h-10","px-2","py-1.5","w-full","h-full","text-foreground-400","text-start"]}}),VI=rr({slots:{base:["flex","group","gap-2","items-center","justify-between","relative","px-2","py-1.5","w-full","h-full","box-border","rounded-small","subpixel-antialiased","outline-hidden","cursor-pointer","tap-highlight-transparent",...es,"data-[focus-visible=true]:dark:ring-offset-background-content1"],wrapper:"w-full flex flex-col items-start justify-center",title:"flex-1 text-small font-normal",description:["w-full","text-tiny","text-foreground-500","group-hover:text-current"],selectedIcon:["text-inherit","w-3","h-3","shrink-0"],shortcut:["px-1","py-0.5","rounded-sm","font-sans","text-foreground-500","text-tiny","border-small","border-default-300","group-hover:border-current"]},variants:{variant:{solid:{base:""},bordered:{base:"border-medium border-transparent bg-transparent"},light:{base:"bg-transparent"},faded:{base:["border-small border-transparent hover:border-default data-[hover=true]:bg-default-100","data-[selectable=true]:focus:border-default data-[selectable=true]:focus:bg-default-100"]},flat:{base:""},shadow:{base:"data-[hover=true]:shadow-lg"}},color:{default:{},primary:{},secondary:{},success:{},warning:{},danger:{}},showDivider:{true:{base:["mb-1.5","after:content-['']","after:absolute","after:-bottom-1","after:left-0","after:right-0","after:h-divider","after:bg-divider"]},false:{}},isDisabled:{true:{base:"opacity-disabled pointer-events-none"}},disableAnimation:{true:{},false:{base:"data-[hover=true]:transition-colors"}},hasTitleTextChild:{true:{title:"truncate"}},hasDescriptionTextChild:{true:{description:"truncate"}}},defaultVariants:{variant:"solid",color:"default",showDivider:!1},compoundVariants:[{variant:"solid",color:"default",class:{base:["data-[hover=true]:bg-default","data-[hover=true]:text-default-foreground","data-[selectable=true]:focus:bg-default","data-[selectable=true]:focus:text-default-foreground"]}},{variant:"solid",color:"primary",class:{base:["data-[hover=true]:bg-primary data-[hover=true]:text-primary-foreground","data-[selectable=true]:focus:bg-primary data-[selectable=true]:focus:text-primary-foreground"]}},{variant:"solid",color:"secondary",class:{base:["data-[hover=true]:bg-secondary data-[hover=true]:text-secondary-foreground","data-[selectable=true]:focus:bg-secondary data-[selectable=true]:focus:text-secondary-foreground"]}},{variant:"solid",color:"success",class:{base:["data-[hover=true]:bg-success data-[hover=true]:text-success-foreground","data-[selectable=true]:focus:bg-success data-[selectable=true]:focus:text-success-foreground"]}},{variant:"solid",color:"warning",class:{base:["data-[hover=true]:bg-warning data-[hover=true]:text-warning-foreground","data-[selectable=true]:focus:bg-warning data-[selectable=true]:focus:text-warning-foreground"]}},{variant:"solid",color:"danger",class:{base:["data-[hover=true]:bg-danger data-[hover=true]:text-danger-foreground","data-[selectable=true]:focus:bg-danger data-[selectable=true]:focus:text-danger-foreground"]}},{variant:"shadow",color:"default",class:{base:["data-[hover=true]:shadow-default/50 data-[hover=true]:bg-default data-[hover=true]:text-default-foreground","data-[selectable=true]:focus:shadow-default/50 data-[selectable=true]:focus:bg-default data-[selectable=true]:focus:text-default-foreground"]}},{variant:"shadow",color:"primary",class:{base:["data-[hover=true]:shadow-primary/30 data-[hover=true]:bg-primary data-[hover=true]:text-primary-foreground","data-[selectable=true]:focus:shadow-primary/30 data-[selectable=true]:focus:bg-primary data-[selectable=true]:focus:text-primary-foreground"]}},{variant:"shadow",color:"secondary",class:{base:["data-[hover=true]:shadow-secondary/30 data-[hover=true]:bg-secondary data-[hover=true]:text-secondary-foreground","data-[selectable=true]:focus:shadow-secondary/30 data-[selectable=true]:focus:bg-secondary data-[selectable=true]:focus:text-secondary-foreground"]}},{variant:"shadow",color:"success",class:{base:["data-[hover=true]:shadow-success/30 data-[hover=true]:bg-success data-[hover=true]:text-success-foreground","data-[selectable=true]:focus:shadow-success/30 data-[selectable=true]:focus:bg-success data-[selectable=true]:focus:text-success-foreground"]}},{variant:"shadow",color:"warning",class:{base:["data-[hover=true]:shadow-warning/30 data-[hover=true]:bg-warning data-[hover=true]:text-warning-foreground","data-[selectable=true]:focus:shadow-warning/30 data-[selectable=true]:focus:bg-warning data-[selectable=true]:focus:text-warning-foreground"]}},{variant:"shadow",color:"danger",class:{base:["data-[hover=true]:shadow-danger/30 data-[hover=true]:bg-danger data-[hover=true]:text-danger-foreground","data-[selectable=true]:focus:shadow-danger/30 data-[selectable=true]:focus:bg-danger data-[selectable=true]:focus:text-danger-foreground"]}},{variant:"bordered",color:"default",class:{base:["data-[hover=true]:border-default","data-[selectable=true]:focus:border-default"]}},{variant:"bordered",color:"primary",class:{base:["data-[hover=true]:border-primary data-[hover=true]:text-primary","data-[selectable=true]:focus:border-primary data-[selectable=true]:focus:text-primary"]}},{variant:"bordered",color:"secondary",class:{base:["data-[hover=true]:border-secondary data-[hover=true]:text-secondary","data-[selectable=true]:focus:border-secondary data-[selectable=true]:focus:text-secondary"]}},{variant:"bordered",color:"success",class:{base:["data-[hover=true]:border-success data-[hover=true]:text-success","data-[selectable=true]:focus:border-success data-[selectable=true]:focus:text-success"]}},{variant:"bordered",color:"warning",class:{base:["data-[hover=true]:border-warning data-[hover=true]:text-warning","data-[selectable=true]:focus:border-warning data-[selectable=true]:focus:text-warning"]}},{variant:"bordered",color:"danger",class:{base:["data-[hover=true]:border-danger data-[hover=true]:text-danger","data-[selectable=true]:focus:border-danger data-[selectable=true]:focus:text-danger"]}},{variant:"flat",color:"default",class:{base:["data-[hover=true]:bg-default/40","data-[hover=true]:text-default-foreground","data-[selectable=true]:focus:bg-default/40","data-[selectable=true]:focus:text-default-foreground"]}},{variant:"flat",color:"primary",class:{base:["data-[hover=true]:bg-primary/20 data-[hover=true]:text-primary","data-[selectable=true]:focus:bg-primary/20 data-[selectable=true]:focus:text-primary"]}},{variant:"flat",color:"secondary",class:{base:["data-[hover=true]:bg-secondary/20 data-[hover=true]:text-secondary","data-[selectable=true]:focus:bg-secondary/20 data-[selectable=true]:focus:text-secondary"]}},{variant:"flat",color:"success",class:{base:["data-[hover=true]:bg-success/20 data-[hover=true]:text-success","data-[selectable=true]:focus:bg-success/20 data-[selectable=true]:focus:text-success"]}},{variant:"flat",color:"warning",class:{base:["data-[hover=true]:bg-warning/20 data-[hover=true]:text-warning","data-[selectable=true]:focus:bg-warning/20 data-[selectable=true]:focus:text-warning"]}},{variant:"flat",color:"danger",class:{base:["data-[hover=true]:bg-danger/20 data-[hover=true]:text-danger","data-[selectable=true]:focus:bg-danger/20 data-[selectable=true]:focus:text-danger"]}},{variant:"faded",color:"default",class:{base:["data-[hover=true]:text-default-foreground","data-[selectable=true]:focus:text-default-foreground"]}},{variant:"faded",color:"primary",class:{base:["data-[hover=true]:text-primary","data-[selectable=true]:focus:text-primary"]}},{variant:"faded",color:"secondary",class:{base:["data-[hover=true]:text-secondary","data-[selectable=true]:focus:text-secondary"]}},{variant:"faded",color:"success",class:{base:["data-[hover=true]:text-success","data-[selectable=true]:focus:text-success"]}},{variant:"faded",color:"warning",class:{base:["data-[hover=true]:text-warning","data-[selectable=true]:focus:text-warning"]}},{variant:"faded",color:"danger",class:{base:["data-[hover=true]:text-danger","data-[selectable=true]:focus:text-danger"]}},{variant:"light",color:"default",class:{base:["data-[hover=true]:text-default-500","data-[selectable=true]:focus:text-default-500"]}},{variant:"light",color:"primary",class:{base:["data-[hover=true]:text-primary","data-[selectable=true]:focus:text-primary"]}},{variant:"light",color:"secondary",class:{base:["data-[hover=true]:text-secondary","data-[selectable=true]:focus:text-secondary"]}},{variant:"light",color:"success",class:{base:["data-[hover=true]:text-success","data-[selectable=true]:focus:text-success"]}},{variant:"light",color:"warning",class:{base:["data-[hover=true]:text-warning","data-[selectable=true]:focus:text-warning"]}},{variant:"light",color:"danger",class:{base:["data-[hover=true]:text-danger","data-[selectable=true]:focus:text-danger"]}}]}),Dre=rr({slots:{base:"relative mb-2",heading:"pl-1 text-tiny text-foreground-500",group:"data-[has-title=true]:pt-1",divider:"mt-2"}}),zI=rr({slots:{wrapper:["flex","w-screen","h-[100dvh]","fixed","inset-0","z-50","overflow-x-auto","justify-center","h-[--visual-viewport-height]"],base:["flex","flex-col","relative","bg-white","z-50","w-full","box-border","bg-content1","outline-hidden","mx-1","my-1","sm:mx-6","sm:my-16"],backdrop:"z-50",header:"flex py-4 px-6 flex-initial text-large font-semibold",body:"flex flex-1 flex-col gap-3 px-6 py-2",footer:"flex flex-row gap-2 px-6 py-4 justify-end",closeButton:["absolute","appearance-none","outline-hidden","select-none","top-1","end-1","p-2","text-foreground-500","rounded-full","hover:bg-default-100","active:bg-default-200","tap-highlight-transparent",...es]},variants:{size:{xs:{base:"max-w-xs"},sm:{base:"max-w-sm"},md:{base:"max-w-md"},lg:{base:"max-w-lg"},xl:{base:"max-w-xl"},"2xl":{base:"max-w-2xl"},"3xl":{base:"max-w-3xl"},"4xl":{base:"max-w-4xl"},"5xl":{base:"max-w-5xl"},full:{base:"my-0 mx-0 sm:mx-0 sm:my-0 max-w-full h-[100dvh] min-h-[100dvh] !rounded-none"}},radius:{none:{base:"rounded-none"},sm:{base:"rounded-small"},md:{base:"rounded-medium"},lg:{base:"rounded-large"}},placement:{auto:{wrapper:"items-end sm:items-center"},center:{wrapper:"items-center sm:items-center"},top:{wrapper:"items-start sm:items-start"},"top-center":{wrapper:"items-start sm:items-center"},bottom:{wrapper:"items-end sm:items-end"},"bottom-center":{wrapper:"items-end sm:items-center"}},shadow:{none:{base:"shadow-none"},sm:{base:"shadow-small"},md:{base:"shadow-medium"},lg:{base:"shadow-large"}},backdrop:{transparent:{backdrop:"hidden"},opaque:{backdrop:"bg-overlay/50 backdrop-opacity-disabled"},blur:{backdrop:"backdrop-blur-md backdrop-saturate-150 bg-overlay/30"}},scrollBehavior:{normal:{base:"overflow-y-hidden"},inside:{base:"max-h-[calc(100%_-_8rem)]",body:"overflow-y-auto"},outside:{wrapper:"items-start sm:items-start overflow-y-auto",base:"my-16"}},disableAnimation:{false:{wrapper:["[--scale-enter:100%]","[--scale-exit:100%]","[--slide-enter:0px]","[--slide-exit:80px]","sm:[--scale-enter:100%]","sm:[--scale-exit:103%]","sm:[--slide-enter:0px]","sm:[--slide-exit:0px]"]}}},defaultVariants:{size:"md",radius:"lg",shadow:"sm",placement:"auto",backdrop:"opaque",scrollBehavior:"normal"},compoundVariants:[{backdrop:["opaque","blur"],class:{backdrop:"w-screen h-screen fixed inset-0"}}]}),Rre=rr({base:"shrink-0 bg-divider border-none",variants:{orientation:{horizontal:"w-full h-divider",vertical:"h-full w-divider"}},defaultVariants:{orientation:"horizontal"}}),Mre=rr({base:["w-full","p-1","min-w-[200px]"]});rr({slots:{base:["flex","group","gap-2","items-center","justify-between","relative","px-2","py-1.5","w-full","h-full","box-border","rounded-small","outline-hidden","cursor-pointer","tap-highlight-transparent","data-[pressed=true]:opacity-70",...es,"data-[focus-visible=true]:dark:ring-offset-background-content1"],wrapper:"w-full flex flex-col items-start justify-center",title:"flex-1 text-small font-normal truncate",description:["w-full","text-tiny","text-foreground-500","group-hover:text-current"],selectedIcon:["text-inherit","w-3","h-3","shrink-0"],shortcut:["px-1","py-0.5","rounded-sm","font-sans","text-foreground-500","text-tiny","border-small","border-default-300","group-hover:border-current"]},variants:{variant:{solid:{base:""},bordered:{base:"border-medium border-transparent bg-transparent"},light:{base:"bg-transparent"},faded:{base:"border-small border-transparent hover:border-default data-[hover=true]:bg-default-100"},flat:{base:""},shadow:{base:"data-[hover=true]:shadow-lg"}},color:{default:{},primary:{},secondary:{},success:{},warning:{},danger:{}},isDisabled:{true:{base:"opacity-disabled pointer-events-none"}},disableAnimation:{true:{},false:{}}},defaultVariants:{variant:"solid",color:"default"},compoundVariants:[{variant:"solid",color:"default",class:{base:"data-[hover=true]:bg-default data-[hover=true]:text-default-foreground"}},{variant:"solid",color:"primary",class:{base:"data-[hover=true]:bg-primary data-[hover=true]:text-primary-foreground"}},{variant:"solid",color:"secondary",class:{base:"data-[hover=true]:bg-secondary data-[hover=true]:text-secondary-foreground"}},{variant:"solid",color:"success",class:{base:"data-[hover=true]:bg-success data-[hover=true]:text-success-foreground"}},{variant:"solid",color:"warning",class:{base:"data-[hover=true]:bg-warning data-[hover=true]:text-warning-foreground"}},{variant:"solid",color:"danger",class:{base:"data-[hover=true]:bg-danger data-[hover=true]:text-danger-foreground"}},{variant:"shadow",color:"default",class:{base:"data-[hover=true]:shadow-default/50 data-[hover=true]:bg-default data-[hover=true]:text-default-foreground"}},{variant:"shadow",color:"primary",class:{base:"data-[hover=true]:shadow-primary/30 data-[hover=true]:bg-primary data-[hover=true]:text-primary-foreground"}},{variant:"shadow",color:"secondary",class:{base:"data-[hover=true]:shadow-secondary/30 data-[hover=true]:bg-secondary data-[hover=true]:text-secondary-foreground"}},{variant:"shadow",color:"success",class:{base:"data-[hover=true]:shadow-success/30 data-[hover=true]:bg-success data-[hover=true]:text-success-foreground"}},{variant:"shadow",color:"warning",class:{base:"data-[hover=true]:shadow-warning/30 data-[hover=true]:bg-warning data-[hover=true]:text-warning-foreground"}},{variant:"shadow",color:"danger",class:{base:"data-[hover=true]:shadow-danger/30 data-[hover=true]:bg-danger data-[hover=true]:text-danger-foreground"}},{variant:"bordered",color:"default",class:{base:"data-[hover=true]:border-default"}},{variant:"bordered",color:"primary",class:{base:"data-[hover=true]:border-primary data-[hover=true]:text-primary"}},{variant:"bordered",color:"secondary",class:{base:"data-[hover=true]:border-secondary data-[hover=true]:text-secondary"}},{variant:"bordered",color:"success",class:{base:"data-[hover=true]:border-success data-[hover=true]:text-success"}},{variant:"bordered",color:"warning",class:{base:"data-[hover=true]:border-warning data-[hover=true]:text-warning"}},{variant:"bordered",color:"danger",class:{base:"data-[hover=true]:border-danger data-[hover=true]:text-danger"}},{variant:"flat",color:"default",class:{base:"data-[hover=true]:bg-default/40 data-[hover=true]:text-default-foreground"}},{variant:"flat",color:"primary",class:{base:"data-[hover=true]:bg-primary/20 data-[hover=true]:text-primary"}},{variant:"flat",color:"secondary",class:{base:"data-[hover=true]:bg-secondary/20 data-[hover=true]:text-secondary"}},{variant:"flat",color:"success",class:{base:"data-[hover=true]:bg-success/20 data-[hover=true]:text-success "}},{variant:"flat",color:"warning",class:{base:"data-[hover=true]:bg-warning/20 data-[hover=true]:text-warning"}},{variant:"flat",color:"danger",class:{base:"data-[hover=true]:bg-danger/20 data-[hover=true]:text-danger"}},{variant:"faded",color:"default",class:{base:"data-[hover=true]:text-default-foreground"}},{variant:"faded",color:"primary",class:{base:"data-[hover=true]:text-primary"}},{variant:"faded",color:"secondary",class:{base:"data-[hover=true]:text-secondary"}},{variant:"faded",color:"success",class:{base:"data-[hover=true]:text-success"}},{variant:"faded",color:"warning",class:{base:"data-[hover=true]:text-warning"}},{variant:"faded",color:"danger",class:{base:"data-[hover=true]:text-danger"}},{variant:"light",color:"default",class:{base:"data-[hover=true]:text-default-500"}},{variant:"light",color:"primary",class:{base:"data-[hover=true]:text-primary"}},{variant:"light",color:"secondary",class:{base:"data-[hover=true]:text-secondary"}},{variant:"light",color:"success",class:{base:"data-[hover=true]:text-success"}},{variant:"light",color:"warning",class:{base:"data-[hover=true]:text-warning"}},{variant:"light",color:"danger",class:{base:"data-[hover=true]:text-danger"}}]});rr({slots:{base:"relative mb-2",heading:"pl-1 text-tiny text-foreground-500",group:"data-[has-title=true]:pt-1",divider:"mt-2"}});rr({base:"w-full flex flex-col gap-0.5 p-1"});var Ire=rr({base:"flex flex-col gap-2 items-start"}),UB=rr({base:["z-0","group","relative","inline-flex","items-center","justify-center","box-border","appearance-none","outline-hidden","select-none","whitespace-nowrap","min-w-max","font-normal","subpixel-antialiased","overflow-hidden","tap-highlight-transparent","transform-gpu data-[pressed=true]:scale-[0.97]","cursor-pointer",...es],variants:{variant:{solid:"",bordered:"border-medium bg-transparent",light:"bg-transparent",flat:"",faded:"border-medium",shadow:"",ghost:"border-medium bg-transparent"},size:{sm:"px-3 min-w-16 h-8 text-tiny gap-2 rounded-small",md:"px-4 min-w-20 h-10 text-small gap-2 rounded-medium",lg:"px-6 min-w-24 h-12 text-medium gap-3 rounded-large"},color:{default:"",primary:"",secondary:"",success:"",warning:"",danger:""},radius:{none:"rounded-none",sm:"rounded-small",md:"rounded-medium",lg:"rounded-large",full:"rounded-full"},fullWidth:{true:"w-full"},isDisabled:{true:"opacity-disabled pointer-events-none"},isInGroup:{true:"[&:not(:first-child):not(:last-child)]:rounded-none"},isIconOnly:{true:"px-0 !gap-0",false:"[&>svg]:max-w-[theme(spacing.8)]"},disableAnimation:{true:"!transition-none data-[pressed=true]:scale-100",false:"transition-transform-colors-opacity motion-reduce:transition-none"}},defaultVariants:{size:"md",variant:"solid",color:"default",fullWidth:!1,isDisabled:!1,isInGroup:!1},compoundVariants:[{variant:"solid",color:"default",class:Ae.solid.default},{variant:"solid",color:"primary",class:Ae.solid.primary},{variant:"solid",color:"secondary",class:Ae.solid.secondary},{variant:"solid",color:"success",class:Ae.solid.success},{variant:"solid",color:"warning",class:Ae.solid.warning},{variant:"solid",color:"danger",class:Ae.solid.danger},{variant:"shadow",color:"default",class:Ae.shadow.default},{variant:"shadow",color:"primary",class:Ae.shadow.primary},{variant:"shadow",color:"secondary",class:Ae.shadow.secondary},{variant:"shadow",color:"success",class:Ae.shadow.success},{variant:"shadow",color:"warning",class:Ae.shadow.warning},{variant:"shadow",color:"danger",class:Ae.shadow.danger},{variant:"bordered",color:"default",class:Ae.bordered.default},{variant:"bordered",color:"primary",class:Ae.bordered.primary},{variant:"bordered",color:"secondary",class:Ae.bordered.secondary},{variant:"bordered",color:"success",class:Ae.bordered.success},{variant:"bordered",color:"warning",class:Ae.bordered.warning},{variant:"bordered",color:"danger",class:Ae.bordered.danger},{variant:"flat",color:"default",class:Ae.flat.default},{variant:"flat",color:"primary",class:Ae.flat.primary},{variant:"flat",color:"secondary",class:Ae.flat.secondary},{variant:"flat",color:"success",class:Ae.flat.success},{variant:"flat",color:"warning",class:Ae.flat.warning},{variant:"flat",color:"danger",class:Ae.flat.danger},{variant:"faded",color:"default",class:Ae.faded.default},{variant:"faded",color:"primary",class:Ae.faded.primary},{variant:"faded",color:"secondary",class:Ae.faded.secondary},{variant:"faded",color:"success",class:Ae.faded.success},{variant:"faded",color:"warning",class:Ae.faded.warning},{variant:"faded",color:"danger",class:Ae.faded.danger},{variant:"light",color:"default",class:[Ae.light.default,"data-[hover=true]:bg-default/40"]},{variant:"light",color:"primary",class:[Ae.light.primary,"data-[hover=true]:bg-primary/20"]},{variant:"light",color:"secondary",class:[Ae.light.secondary,"data-[hover=true]:bg-secondary/20"]},{variant:"light",color:"success",class:[Ae.light.success,"data-[hover=true]:bg-success/20"]},{variant:"light",color:"warning",class:[Ae.light.warning,"data-[hover=true]:bg-warning/20"]},{variant:"light",color:"danger",class:[Ae.light.danger,"data-[hover=true]:bg-danger/20"]},{variant:"ghost",color:"default",class:[Ae.ghost.default,"data-[hover=true]:!bg-default"]},{variant:"ghost",color:"primary",class:[Ae.ghost.primary,"data-[hover=true]:!bg-primary data-[hover=true]:!text-primary-foreground"]},{variant:"ghost",color:"secondary",class:[Ae.ghost.secondary,"data-[hover=true]:!bg-secondary data-[hover=true]:!text-secondary-foreground"]},{variant:"ghost",color:"success",class:[Ae.ghost.success,"data-[hover=true]:!bg-success data-[hover=true]:!text-success-foreground"]},{variant:"ghost",color:"warning",class:[Ae.ghost.warning,"data-[hover=true]:!bg-warning data-[hover=true]:!text-warning-foreground"]},{variant:"ghost",color:"danger",class:[Ae.ghost.danger,"data-[hover=true]:!bg-danger data-[hover=true]:!text-danger-foreground"]},{isInGroup:!0,class:"rounded-none first:rounded-s-medium last:rounded-e-medium"},{isInGroup:!0,size:"sm",class:"rounded-none first:rounded-s-small last:rounded-e-small"},{isInGroup:!0,size:"md",class:"rounded-none first:rounded-s-medium last:rounded-e-medium"},{isInGroup:!0,size:"lg",class:"rounded-none first:rounded-s-large last:rounded-e-large"},{isInGroup:!0,isRounded:!0,class:"rounded-none first:rounded-s-full last:rounded-e-full"},{isInGroup:!0,radius:"none",class:"rounded-none first:rounded-s-none last:rounded-e-none"},{isInGroup:!0,radius:"sm",class:"rounded-none first:rounded-s-small last:rounded-e-small"},{isInGroup:!0,radius:"md",class:"rounded-none first:rounded-s-medium last:rounded-e-medium"},{isInGroup:!0,radius:"lg",class:"rounded-none first:rounded-s-large last:rounded-e-large"},{isInGroup:!0,radius:"full",class:"rounded-none first:rounded-s-full last:rounded-e-full"},{isInGroup:!0,variant:["ghost","bordered"],color:"default",className:gc.default},{isInGroup:!0,variant:["ghost","bordered"],color:"primary",className:gc.primary},{isInGroup:!0,variant:["ghost","bordered"],color:"secondary",className:gc.secondary},{isInGroup:!0,variant:["ghost","bordered"],color:"success",className:gc.success},{isInGroup:!0,variant:["ghost","bordered"],color:"warning",className:gc.warning},{isInGroup:!0,variant:["ghost","bordered"],color:"danger",className:gc.danger},{isIconOnly:!0,size:"sm",class:"min-w-8 w-8 h-8"},{isIconOnly:!0,size:"md",class:"min-w-10 w-10 h-10"},{isIconOnly:!0,size:"lg",class:"min-w-12 w-12 h-12"},{variant:["solid","faded","flat","bordered","shadow"],class:"data-[hover=true]:opacity-hover"}]});rr({base:"inline-flex items-center justify-center h-auto",variants:{fullWidth:{true:"w-full"}},defaultVariants:{fullWidth:!1}});var KI=rr({slots:{base:["relative w-fit max-w-full shadow-small inline-block overflow-y-hidden","rounded-large overflow-x-auto bg-default-50 dark:bg-background","w-[calc(var(--visible-months)_*_var(--calendar-width))]"],prevButton:["order-1"],nextButton:["order-3"],headerWrapper:["px-4 py-2 flex items-center justify-between gap-2 bg-content1 overflow-hidden rtl:flex-row-reverse","[&_.chevron-icon]:flex-none","after:content-['']","after:bg-content1 origin-top","after:w-full after:h-0","after:absolute after:top-0 after:left-0"],header:"flex w-full items-center justify-center gap-2 z-10 order-2",title:"text-default-500 text-small font-medium",content:"w-[calc(var(--visible-months)_*_var(--calendar-width))]",gridWrapper:"flex max-w-full overflow-hidden pb-2 h-auto relative",grid:"w-full border-collapse z-0",gridHeader:"bg-content1 shadow-[0px_20px_20px_0px_rgb(0_0_0/0.05)]",gridHeaderRow:"px-4 pb-2 flex justify-center text-default-400",gridHeaderCell:"flex w-8 justify-center items-center font-medium text-small",gridBody:"",gridBodyRow:"flex justify-center items-center first:mt-2",cell:"py-0.5 px-0",cellButton:["w-8 h-8 flex items-center text-foreground justify-center rounded-full","box-border appearance-none select-none whitespace-nowrap font-normal","subpixel-antialiased overflow-hidden tap-highlight-transparent","data-[disabled=true]:text-default-300","data-[disabled=true]:cursor-default","data-[readonly=true]:cursor-default","data-[disabled=true]:transition-none","data-[unavailable=true]:text-default-300","data-[unavailable=true]:cursor-default","data-[unavailable=true]:line-through",...es],pickerWrapper:"absolute inset-x-0 top-0 flex w-full h-[var(--picker-height)] justify-center opacity-0 pointer-events-none",pickerMonthList:"items-start",pickerYearList:"items-center",pickerHighlight:"h-8 bg-default-200 absolute w-[calc(100%_-_16px)] rounded-medium z-0 top-1/2 -translate-y-1/2 pointer-events-none",pickerItem:["w-full flex text-foreground items-center h-8 leading-[32px] min-h-[32px] snap-center text-large z-20","data-[pressed=true]:opacity-50",...es],helperWrapper:"px-4 pb-2 max-w-[270px] flex justify-start flex-wrap items-center",errorMessage:"text-small text-danger break-words max-w-full"},variants:{color:{foreground:{},primary:{},secondary:{},success:{},warning:{},danger:{}},isRange:{true:{cellButton:["relative","overflow-visible","before:content-[''] before:absolute before:inset-0 before:z-[-1] before:rounded-none","data-[outside-month=true]:before:hidden","data-[selected=true]:data-[range-selection=true]:data-[outside-month=true]:bg-transparent","data-[selected=true]:data-[range-selection=true]:data-[outside-month=true]:text-default-300","data-[range-start=true]:before:rounded-s-full","data-[selection-start=true]:before:rounded-s-full","data-[range-end=true]:before:rounded-e-full","data-[selection-end=true]:before:rounded-e-full","data-[selected=true]:data-[selection-start=true]:data-[range-selection=true]:rounded-full","data-[selected=true]:data-[selection-end=true]:data-[range-selection=true]:rounded-full"]},false:{}},hideDisabledDates:{true:{cellButton:"data-[disabled=true]:data-[outside-month=true]:opacity-0"},false:{}},isHeaderWrapperExpanded:{true:{headerWrapper:["[&_.chevron-icon]:rotate-180","after:h-full","after:z-0"],pickerWrapper:"opacity-100 pointer-events-auto z-10",gridWrapper:"h-[var(--picker-height)] overflow-y-hidden",grid:"opacity-0 pointer-events-none",nextButton:"opacity-0 pointer-events-none",prevButton:"opacity-0 pointer-events-none"},false:{}},showMonthAndYearPickers:{true:{base:"[--picker-height:224px]",header:"h-8 bg-default-100 rounded-full"},false:{}},showShadow:{true:{cellButton:"data-[selected=true]:shadow-md"},false:{cellButton:"shadow-none data-[selected=true]:shadow-none"}},disableAnimation:{true:{cellButton:"transition-none"},false:{headerWrapper:["[&_.chevron-icon]:transition-transform","after:transition-height"],grid:"transition-opacity",cellButton:["origin-center transition-[transform,background-color,color] !duration-150"],pickerWrapper:"transition-opacity !duration-250",pickerItem:"transition-opacity"}},isRTL:{true:{nextButton:"order-1",prevButton:"order-3"},false:{}}},defaultVariants:{color:"primary",showShadow:!1,hideDisabledDates:!1,showMonthAndYearPickers:!1,isRTL:!1},compoundVariants:[{isRange:!1,color:"foreground",class:{cellButton:["data-[hover=true]:bg-default-200","data-[selected=true]:bg-foreground","data-[selected=true]:text-background","data-[hover=true]:bg-foreground-200","data-[hover=true]:text-foreground-600","data-[selected=true]:data-[hover=true]:bg-foreground","data-[selected=true]:data-[hover=true]:text-background"]}},{isRange:!1,color:"primary",class:{cellButton:["data-[selected=true]:bg-primary","data-[selected=true]:text-primary-foreground","data-[hover=true]:bg-primary-50","data-[hover=true]:text-primary-400","data-[selected=true]:data-[hover=true]:bg-primary","data-[selected=true]:data-[hover=true]:text-primary-foreground"]}},{isRange:!1,color:"secondary",class:{cellButton:["data-[selected=true]:bg-secondary","data-[selected=true]:text-secondary-foreground","data-[hover=true]:bg-secondary-50","data-[hover=true]:text-secondary-400","data-[selected=true]:data-[hover=true]:bg-secondary","data-[selected=true]:data-[hover=true]:text-secondary-foreground"]}},{isRange:!1,color:"success",class:{cellButton:["data-[selected=true]:bg-success","data-[selected=true]:text-success-foreground","data-[hover=true]:bg-success-100","data-[hover=true]:text-success-600","dark:data-[hover=true]:bg-success-50","dark:data-[hover=true]:text-success-500","data-[selected=true]:data-[hover=true]:bg-success","dark:data-[selected=true]:data-[hover=true]:bg-success","dark:data-[selected=true]:data-[hover=true]:text-success-foreground","data-[selected=true]:data-[hover=true]:text-success-foreground"]}},{isRange:!1,color:"warning",class:{cellButton:["data-[selected=true]:bg-warning","data-[selected=true]:text-warning-foreground","data-[hover=true]:bg-warning-100","data-[hover=true]:text-warning-600","dark:data-[hover=true]:bg-warning-50","dark:data-[hover=true]:text-warning-500","data-[selected=true]:data-[hover=true]:bg-warning","dark:data-[selected=true]:data-[hover=true]:bg-warning","dark:data-[selected=true]:data-[hover=true]:text-warning-foreground","data-[selected=true]:data-[hover=true]:text-warning-foreground"]}},{isRange:!1,color:"danger",class:{cellButton:["data-[selected=true]:bg-danger","data-[selected=true]:text-danger-foreground","data-[hover=true]:bg-danger-100","data-[hover=true]:text-danger-500","dark:data-[hover=true]:bg-danger-50","dark:data-[hover=true]:text-danger-500","data-[selected=true]:data-[hover=true]:bg-danger","dark:data-[selected=true]:data-[hover=true]:bg-danger","dark:data-[selected=true]:data-[hover=true]:text-danger-foreground","data-[selected=true]:data-[hover=true]:text-danger-foreground"]}},{isRange:!0,color:"foreground",class:{cellButton:["data-[selected=true]:data-[range-selection=true]:before:bg-foreground/10","data-[selected=true]:data-[range-selection=true]:text-foreground","data-[selected=true]:data-[selection-start=true]:data-[range-selection=true]:bg-foreground","data-[selected=true]:data-[selection-start=true]:data-[range-selection=true]:text-background","data-[selected=true]:data-[selection-end=true]:data-[range-selection=true]:bg-foreground","data-[selected=true]:data-[selection-end=true]:data-[range-selection=true]:text-background"]}},{isRange:!0,color:"primary",class:{cellButton:["data-[selected=true]:data-[range-selection=true]:before:bg-primary-50","data-[selected=true]:data-[range-selection=true]:text-primary","data-[selected=true]:data-[selection-start=true]:data-[range-selection=true]:bg-primary","data-[selected=true]:data-[selection-start=true]:data-[range-selection=true]:text-primary-foreground","data-[selected=true]:data-[selection-end=true]:data-[range-selection=true]:bg-primary","data-[selected=true]:data-[selection-end=true]:data-[range-selection=true]:text-primary-foreground"]}},{isRange:!0,color:"secondary",class:{cellButton:["data-[selected=true]:data-[range-selection=true]:before:bg-secondary-50","data-[selected=true]:data-[range-selection=true]:text-secondary","data-[selected=true]:data-[selection-start=true]:data-[range-selection=true]:bg-secondary","data-[selected=true]:data-[selection-start=true]:data-[range-selection=true]:text-secondary-foreground","data-[selected=true]:data-[selection-end=true]:data-[range-selection=true]:bg-secondary","data-[selected=true]:data-[selection-end=true]:data-[range-selection=true]:text-secondary-foreground"]}},{isRange:!0,color:"success",class:{cellButton:["data-[selected=true]:data-[range-selection=true]:before:bg-success-100","data-[selected=true]:data-[range-selection=true]:text-success-600","dark:data-[selected=true]:data-[range-selection=true]:before:bg-success-50","dark:data-[selected=true]:data-[range-selection=true]:text-success-500","data-[selected=true]:data-[selection-start=true]:data-[range-selection=true]:bg-success","data-[selected=true]:data-[selection-start=true]:data-[range-selection=true]:text-success-foreground","dark:data-[selected=true]:data-[selection-start=true]:data-[range-selection=true]:text-success-foreground","data-[selected=true]:data-[selection-end=true]:data-[range-selection=true]:bg-success","data-[selected=true]:data-[selection-end=true]:data-[range-selection=true]:text-success-foreground","dark:data-[selected=true]:data-[selection-end=true]:data-[range-selection=true]:text-success-foreground"]}},{isRange:!0,color:"warning",class:{cellButton:["data-[selected=true]:data-[range-selection=true]:before:bg-warning-100","dark:data-[selected=true]:data-[range-selection=true]:before:bg-warning-50","data-[selected=true]:data-[range-selection=true]:text-warning-500","data-[selected=true]:data-[selection-start=true]:data-[range-selection=true]:bg-warning","data-[selected=true]:data-[selection-start=true]:data-[range-selection=true]:text-warning-foreground","data-[selected=true]:data-[selection-end=true]:data-[range-selection=true]:bg-warning","data-[selected=true]:data-[selection-end=true]:data-[range-selection=true]:text-warning-foreground"]}},{isRange:!0,color:"danger",class:{cellButton:["data-[selected=true]:data-[range-selection=true]:before:bg-danger-50","data-[selected=true]:data-[range-selection=true]:text-danger-500","data-[selected=true]:data-[selection-start=true]:data-[range-selection=true]:bg-danger","data-[selected=true]:data-[selection-start=true]:data-[range-selection=true]:text-danger-foreground","data-[selected=true]:data-[selection-end=true]:data-[range-selection=true]:bg-danger","data-[selected=true]:data-[selection-end=true]:data-[range-selection=true]:text-danger-foreground"]}},{showShadow:!0,color:"foreground",class:{cellButton:"data-[selected=true]:shadow-foreground/40"}},{showShadow:!0,color:"primary",class:{cellButton:"data-[selected=true]:shadow-primary/40"}},{showShadow:!0,color:"secondary",class:{cellButton:"data-[selected=true]:shadow-secondary/40"}},{showShadow:!0,color:"success",class:{cellButton:"data-[selected=true]:shadow-success/40"}},{showShadow:!0,color:"warning",class:{cellButton:"data-[selected=true]:shadow-warning/40"}},{showShadow:!0,color:"danger",class:{cellButton:"data-[selected=true]:shadow-danger/40"}},{showShadow:!0,isRange:!0,class:{cellButton:["data-[selected=true]:shadow-none","data-[selected=true]:data-[selection-start=true]:shadow-md","data-[selected=true]:data-[selection-end=true]:shadow-md"]}}],compoundSlots:[{slots:["prevButton","nextButton"],class:["text-medium","text-default-400"]},{slots:["pickerMonthList","pickerYearList"],class:["flex flex-col px-4 overflow-y-scroll scrollbar-hide snap-y snap-mandatory","[--scroll-shadow-size:100px]","[mask-image:linear-gradient(#000,#000,transparent_0,#000_var(--scroll-shadow-size),#000_calc(100%_-_var(--scroll-shadow-size)),transparent)]"]}]}),HI=rr({slots:{base:["flex","flex-col","relative","overflow-hidden","h-auto","outline-hidden","text-foreground","box-border","bg-content1",...es],header:["flex","p-3","z-10","w-full","justify-start","items-center","shrink-0","overflow-inherit","color-inherit","subpixel-antialiased"],body:["relative","flex","flex-1","w-full","p-3","flex-auto","flex-col","place-content-inherit","align-items-inherit","h-auto","break-words","text-left","overflow-y-auto","subpixel-antialiased"],footer:["p-3","h-auto","flex","w-full","items-center","overflow-hidden","color-inherit","subpixel-antialiased"]},variants:{shadow:{none:{base:"shadow-none"},sm:{base:"shadow-small"},md:{base:"shadow-medium"},lg:{base:"shadow-large"}},radius:{none:{base:"rounded-none",header:"rounded-none",footer:"rounded-none"},sm:{base:"rounded-small",header:"rounded-t-small",footer:"rounded-b-small"},md:{base:"rounded-medium",header:"rounded-t-medium",footer:"rounded-b-medium"},lg:{base:"rounded-large",header:"rounded-t-large",footer:"rounded-b-large"}},fullWidth:{true:{base:"w-full"}},isHoverable:{true:{base:"data-[hover=true]:bg-content2 dark:data-[hover=true]:bg-content2"}},isPressable:{true:{base:"cursor-pointer"}},isBlurred:{true:{base:["bg-background/80","dark:bg-background/20","backdrop-blur-md","backdrop-saturate-150"]}},isFooterBlurred:{true:{footer:["bg-background/10","backdrop-blur","backdrop-saturate-150"]}},isDisabled:{true:{base:"opacity-disabled cursor-not-allowed"}},disableAnimation:{true:"",false:{base:"transition-transform-background motion-reduce:transition-none"}}},compoundVariants:[{isPressable:!0,class:"data-[pressed=true]:scale-[0.97] tap-highlight-transparent"}],defaultVariants:{radius:"lg",shadow:"md",fullWidth:!1,isHoverable:!1,isPressable:!1,isDisabled:!1,isFooterBlurred:!1}}),WI=rr({slots:{base:["relative","max-w-fit","min-w-min","inline-flex","items-center","justify-between","box-border","whitespace-nowrap"],content:"flex-1 text-inherit font-normal",dot:["w-2","h-2","ml-1","rounded-full"],avatar:"shrink-0",closeButton:["z-10","appearance-none","outline-hidden","select-none","transition-opacity","opacity-70","hover:opacity-100","cursor-pointer","active:opacity-disabled","tap-highlight-transparent"]},variants:{variant:{solid:{},bordered:{base:"border-medium bg-transparent"},light:{base:"bg-transparent"},flat:{},faded:{base:"border-medium"},shadow:{},dot:{base:"border-medium border-default text-foreground bg-transparent"}},color:{default:{dot:"bg-default-400"},primary:{dot:"bg-primary"},secondary:{dot:"bg-secondary"},success:{dot:"bg-success"},warning:{dot:"bg-warning"},danger:{dot:"bg-danger"}},size:{sm:{base:"px-1 h-6 text-tiny",content:"px-1",closeButton:"text-medium",avatar:"w-4 h-4"},md:{base:"px-1 h-7 text-small",content:"px-2",closeButton:"text-large",avatar:"w-5 h-5"},lg:{base:"px-2 h-8 text-medium",content:"px-2",closeButton:"text-xl",avatar:"w-6 h-6"}},radius:{none:{base:"rounded-none"},sm:{base:"rounded-small"},md:{base:"rounded-medium"},lg:{base:"rounded-large"},full:{base:"rounded-full"}},isOneChar:{true:{},false:{}},isCloseable:{true:{},false:{}},hasStartContent:{true:{}},hasEndContent:{true:{}},isDisabled:{true:{base:"opacity-disabled pointer-events-none"}},isCloseButtonFocusVisible:{true:{closeButton:[...xre,"ring-1","rounded-full"]}}},defaultVariants:{variant:"solid",color:"default",size:"md",radius:"full",isDisabled:!1},compoundVariants:[{variant:"solid",color:"default",class:{base:Ae.solid.default}},{variant:"solid",color:"primary",class:{base:Ae.solid.primary}},{variant:"solid",color:"secondary",class:{base:Ae.solid.secondary}},{variant:"solid",color:"success",class:{base:Ae.solid.success}},{variant:"solid",color:"warning",class:{base:Ae.solid.warning}},{variant:"solid",color:"danger",class:{base:Ae.solid.danger}},{variant:"shadow",color:"default",class:{base:Ae.shadow.default}},{variant:"shadow",color:"primary",class:{base:Ae.shadow.primary}},{variant:"shadow",color:"secondary",class:{base:Ae.shadow.secondary}},{variant:"shadow",color:"success",class:{base:Ae.shadow.success}},{variant:"shadow",color:"warning",class:{base:Ae.shadow.warning}},{variant:"shadow",color:"danger",class:{base:Ae.shadow.danger}},{variant:"bordered",color:"default",class:{base:Ae.bordered.default}},{variant:"bordered",color:"primary",class:{base:Ae.bordered.primary}},{variant:"bordered",color:"secondary",class:{base:Ae.bordered.secondary}},{variant:"bordered",color:"success",class:{base:Ae.bordered.success}},{variant:"bordered",color:"warning",class:{base:Ae.bordered.warning}},{variant:"bordered",color:"danger",class:{base:Ae.bordered.danger}},{variant:"flat",color:"default",class:{base:Ae.flat.default}},{variant:"flat",color:"primary",class:{base:Ae.flat.primary}},{variant:"flat",color:"secondary",class:{base:Ae.flat.secondary}},{variant:"flat",color:"success",class:{base:Ae.flat.success}},{variant:"flat",color:"warning",class:{base:Ae.flat.warning}},{variant:"flat",color:"danger",class:{base:Ae.flat.danger}},{variant:"faded",color:"default",class:{base:Ae.faded.default}},{variant:"faded",color:"primary",class:{base:Ae.faded.primary}},{variant:"faded",color:"secondary",class:{base:Ae.faded.secondary}},{variant:"faded",color:"success",class:{base:Ae.faded.success}},{variant:"faded",color:"warning",class:{base:Ae.faded.warning}},{variant:"faded",color:"danger",class:{base:Ae.faded.danger}},{variant:"light",color:"default",class:{base:Ae.light.default}},{variant:"light",color:"primary",class:{base:Ae.light.primary}},{variant:"light",color:"secondary",class:{base:Ae.light.secondary}},{variant:"light",color:"success",class:{base:Ae.light.success}},{variant:"light",color:"warning",class:{base:Ae.light.warning}},{variant:"light",color:"danger",class:{base:Ae.light.danger}},{isOneChar:!0,hasStartContent:!1,hasEndContent:!1,size:"sm",class:{base:"w-5 h-5 min-w-5 min-h-5"}},{isOneChar:!0,hasStartContent:!1,hasEndContent:!1,size:"md",class:{base:"w-6 h-6 min-w-6 min-h-6"}},{isOneChar:!0,hasStartContent:!1,hasEndContent:!1,size:"lg",class:{base:"w-7 h-7 min-w-7 min-h-7"}},{isOneChar:!0,isCloseable:!1,hasStartContent:!1,hasEndContent:!1,class:{base:"px-0 justify-center",content:"px-0 flex-none"}},{isOneChar:!0,isCloseable:!0,hasStartContent:!1,hasEndContent:!1,class:{base:"w-auto"}},{isOneChar:!0,variant:"dot",class:{base:"w-auto h-7 px-1 items-center",content:"px-2"}},{hasStartContent:!0,size:"sm",class:{content:"pl-0.5"}},{hasStartContent:!0,size:["md","lg"],class:{content:"pl-1"}},{hasEndContent:!0,size:"sm",class:{content:"pr-0.5"}},{hasEndContent:!0,size:["md","lg"],class:{content:"pr-1"}}]}),d0=rr({slots:{base:"group flex flex-col",label:["block subpixel-antialiased text-small text-default-600","group-data-[required=true]:after:content-['*'] group-data-[required=true]:after:text-danger group-data-[required=true]:after:ml-0.5","group-data-[invalid=true]:text-danger"],inputWrapper:["relative px-3 gap-3 w-full inline-flex flex-row items-center","cursor-text tap-highlight-transparent shadow-xs"],input:"flex h-full gap-x-0.5 w-full font-normal",innerWrapper:["flex items-center text-default-400 w-full gap-x-2 h-6","group-data-[invalid=true]:text-danger"],segment:["group first:-ml-0.5 [&:not(:first-child)]:-ml-1 px-0.5 my-auto box-content tabular-nums text-start","inline-block outline-hidden focus:shadow-xs rounded-md","text-foreground-500 data-[editable=true]:text-foreground","data-[editable=true]:data-[placeholder=true]:text-foreground-500","data-[invalid=true]:text-danger-300 data-[invalid=true]:data-[editable=true]:text-danger","data-[invalid=true]:focus:bg-danger-400/50 dark:data-[invalid=true]:focus:bg-danger-400/20","data-[invalid=true]:data-[editable=true]:focus:text-danger"],helperWrapper:"hidden group-data-[has-helper=true]:flex p-1 relative flex-col gap-1.5",description:"text-tiny text-foreground-400",errorMessage:"text-tiny text-danger"},variants:{variant:{flat:{inputWrapper:["bg-default-100","hover:bg-default-200","focus-within:hover:bg-default-100","group-data-[invalid=true]:bg-danger-50","group-data-[invalid=true]:hover:bg-danger-100","group-data-[invalid=true]:focus-within:hover:bg-danger-50"]},faded:{inputWrapper:["bg-default-100","border-medium","border-default-200","hover:border-default-400","group-data-[invalid=true]:bg-danger-50","group-data-[invalid=true]:hover:bg-danger-100","group-data-[invalid=true]:focus-within:hover:bg-danger-50"]},bordered:{inputWrapper:["border-medium","border-default-200","hover:border-default-400","focus-within:border-default-foreground","focus-within:hover:border-default-foreground","group-data-[invalid=true]:border-danger","group-data-[invalid=true]:hover:border-danger","group-data-[invalid=true]:focus-within:hover:border-danger"]},underlined:{inputWrapper:["px-1","pb-1","gap-0","relative","box-border","border-b-medium","shadow-[0_1px_0px_0_rgba(0,0,0,0.05)]","border-default-200","!rounded-none","hover:border-default-300","after:content-['']","after:w-0","after:origin-center","after:bg-default-foreground","after:absolute","after:left-1/2","after:-translate-x-1/2","after:-bottom-[2px]","after:h-[2px]","focus-within:after:w-full","group-data-[invalid=true]:after:bg-danger"]}},color:{default:{segment:"focus:bg-default-400/50 data-[editable=true]:focus:text-default-foreground"},primary:{segment:"focus:bg-primary-400/50 data-[editable=true]:focus:text-primary"},secondary:{segment:"focus:bg-secondary-400/50 data-[editable=true]:focus:text-secondary"},success:{segment:"focus:bg-success-400/50 dark:focus:bg-success-400/20 data-[editable=true]:focus:text-success"},warning:{segment:"focus:bg-warning-400/50 dark:focus:bg-warning-400/20 data-[editable=true]:focus:text-warning"},danger:{segment:"focus:bg-danger-400/50 dark:focus:bg-danger-400/20 data-[editable=true]:focus:text-danger"}},size:{sm:{label:"text-tiny",input:"text-small",inputWrapper:"h-8 min-h-8 px-2 rounded-small"},md:{input:"text-small",inputWrapper:"h-10 min-h-10 rounded-medium",clearButton:"text-large"},lg:{label:"text-medium",input:"text-medium",inputWrapper:"h-12 min-h-12 rounded-large"}},radius:{none:{inputWrapper:"rounded-none"},sm:{inputWrapper:"rounded-small"},md:{inputWrapper:"rounded-medium"},lg:{inputWrapper:"rounded-large"},full:{inputWrapper:"rounded-full"}},labelPlacement:{outside:{base:"flex flex-col data-[has-helper=true]:pb-[calc(var(--heroui-font-size-tiny)_+8px)] gap-y-1.5",label:"w-full text-foreground",helperWrapper:"absolute top-[calc(100%_+_2px)] start-0"},"outside-left":{base:"flex-row items-center data-[has-helper=true]:pb-[calc(var(--heroui-font-size-tiny)_+_8px)] gap-x-2 flex-nowrap",label:"relative text-foreground",inputWrapper:"relative flex-1",helperWrapper:"absolute top-[calc(100%_+_2px)] start-0"},inside:{label:"w-full text-tiny cursor-text",inputWrapper:"flex-col items-start justify-center gap-0"}},fullWidth:{true:{base:"w-full",inputWrapper:"w-full"}},isDisabled:{true:{base:"opacity-disabled pointer-events-none",inputWrapper:"pointer-events-none",label:"pointer-events-none"}},disableAnimation:{true:{label:"transition-none",input:"transition-none",inputWrapper:"transition-none"},false:{label:["!ease-out","!duration-200","will-change-auto","motion-reduce:transition-none","transition-[color,opacity]"],inputWrapper:"transition-background motion-reduce:transition-none !duration-150",segment:"transition-colors motion-reduce:transition-none"}}},defaultVariants:{variant:"flat",color:"default",size:"md",fullWidth:!0,isDisabled:!1},compoundVariants:[{variant:"flat",color:"primary",class:{innerWrapper:"text-primary",inputWrapper:["bg-primary-100","hover:bg-primary-50","focus-within:bg-primary-50"],segment:"text-primary-300 data-[editable=true]:data-[placeholder=true]:text-primary-300 data-[editable=true]:text-primary",label:"text-primary"}},{variant:"flat",color:"secondary",class:{innerWrapper:"text-secondary",inputWrapper:["bg-secondary-100","hover:bg-secondary-50","focus-within:bg-secondary-50"],segment:"text-secondary-300 data-[editable=true]:data-[placeholder=true]:text-secondary-300 data-[editable=true]:text-secondary",label:"text-secondary"}},{variant:"flat",color:"success",class:{innerWrapper:"text-success-600 dark:text-success",inputWrapper:["bg-success-100","hover:bg-success-50","focus-within:bg-success-50"],segment:"text-success-400 data-[editable=true]:data-[placeholder=true]:text-success-400 data-[editable=true]:text-success-600 data-[editable=true]:focus:text-success-600",label:"text-success-600 dark:text-success"}},{variant:"flat",color:"warning",class:{innerWrapper:"text-warning-600 dark:text-warning",inputWrapper:["bg-warning-100","hover:bg-warning-50","focus-within:bg-warning-50"],segment:"text-warning-400 data-[editable=true]:data-[placeholder=true]:text-warning-400 data-[editable=true]:text-warning-600 data-[editable=true]:focus:text-warning-600",label:"text-warning-600 dark:text-warning"}},{variant:"flat",color:"danger",class:{innerWrapper:"text-danger",inputWrapper:["bg-danger-100","hover:bg-danger-50","focus-within:bg-danger-50"],segment:"text-danger-300 data-[editable=true]:data-[placeholder=true]:text-danger-300 data-[editable=true]:text-danger",label:"text-danger"}},{variant:"faded",color:"primary",class:{innerWrapper:"text-primary",inputWrapper:["hover:border-primary","focus-within:border-primary","focus-within:hover:border-primary"],label:"text-primary"}},{variant:"faded",color:"secondary",class:{innerWrapper:"text-secondary",inputWrapper:["hover:border-secondary","focus-within:border-secondary","focus-within:hover:border-secondary"],label:"text-secondary"}},{variant:"faded",color:"success",class:{innerWrapper:"text-success",inputWrapper:["hover:border-success","focus-within:border-success","focus-within:hover:border-success"],label:"text-success"}},{variant:"faded",color:"warning",class:{innerWrapper:"text-warning",inputWrapper:["hover:border-warning","focus-within:border-warning","focus-within:hover:border-warning"],label:"text-warning"}},{variant:"faded",color:"danger",class:{innerWrapper:"text-danger",inputWrapper:["hover:border-danger","focus-within:border-danger","focus-within:hover:border-danger"],label:"text-danger"}},{variant:"bordered",color:"primary",class:{innerWrapper:"text-primary",inputWrapper:["focus-within:border-primary","focus-within:hover:border-primary"],label:"text-primary"}},{variant:"bordered",color:"secondary",class:{innerWrapper:"text-secondary",inputWrapper:["focus-within:border-secondary","focus-within:hover:border-secondary"],label:"text-secondary"}},{variant:"bordered",color:"success",class:{innerWrapper:"text-success",inputWrapper:["focus-within:border-success","focus-within:hover:border-success"],label:"text-success"}},{variant:"bordered",color:"warning",class:{innerWrapper:"text-warning",inputWrapper:["focus-within:border-warning","focus-within:hover:border-warning"],label:"text-warning"}},{variant:"bordered",color:"danger",class:{innerWrapper:"text-danger",inputWrapper:["focus-within:border-danger","focus-within:hover:border-danger"],label:"text-danger"}},{variant:"underlined",color:"primary",class:{innerWrapper:"text-primary",inputWrapper:"after:bg-primary",label:"text-primary"}},{variant:"underlined",color:"secondary",class:{innerWrapper:"text-secondary",inputWrapper:"after:bg-secondary",label:"text-secondary"}},{variant:"underlined",color:"success",class:{innerWrapper:"text-success",inputWrapper:"after:bg-success",label:"text-success"}},{variant:"underlined",color:"warning",class:{innerWrapper:"text-warning",inputWrapper:"after:bg-warning",label:"text-warning"}},{variant:"underlined",color:"danger",class:{innerWrapper:"text-danger",inputWrapper:"after:bg-danger",label:"text-danger"}},{labelPlacement:"inside",size:"sm",class:{inputWrapper:"h-12 py-1.5 px-3"}},{labelPlacement:"inside",size:"md",class:{inputWrapper:"h-14 py-2"}},{labelPlacement:"inside",size:"lg",class:{label:"text-medium",inputWrapper:"h-16 py-2.5 gap-0"}},{disableAnimation:!1,variant:["faded","bordered"],class:{inputWrapper:"transition-colors motion-reduce:transition-none"}},{disableAnimation:!1,variant:"underlined",class:{inputWrapper:"after:transition-width motion-reduce:after:transition-none"}}]}),Pre=rr({slots:{base:"group w-full",selectorButton:"-mx-2 text-inherit",selectorIcon:"text-lg text-inherit pointer-events-none shrink-0",popoverContent:"p-0 w-full",calendar:"w-[calc(var(--visible-months)_*_var(--calendar-width))] shadow-none",calendarContent:"w-[calc(var(--visible-months)_*_var(--calendar-width))]",timeInputLabel:"font-medium",timeInput:"px-5 pb-4 flex-wrap gap-x-6"}}),Are=rr({extend:Pre,slots:{calendar:"group",bottomContent:"flex flex-col gap-y-2",timeInputWrapper:"flex flex-col group-data-[has-multiple-months=true]:flex-row",separator:"-mx-1 text-inherit"}});function FB(t){var e,r,n="";if(typeof t=="string"||typeof t=="number")n+=t;else if(typeof t=="object")if(Array.isArray(t))for(e=0;e<t.length;e++)t[e]&&(r=FB(t[e]))&&(n&&(n+=" "),n+=r);else for(e in t)t[e]&&(n&&(n+=" "),n+=e);return n}function kre(){for(var t,e,r=0,n="";r<arguments.length;)(t=arguments[r++])&&(e=FB(t))&&(n&&(n+=" "),n+=e);return n}var Ore=BB({extend:M1});function GI(...t){return Ore(kre(t))}var $re=(t,e)=>{if(!t&&!e)return{};const r=new Set([...Object.keys(t||{}),...Object.keys(e||{})]);return Array.from(r).reduce((n,i)=>({...n,[i]:qe(t==null?void 0:t[i],e==null?void 0:e[i])}),{})};const Lre="modulepreload",Bre=function(t){return"/roadtrip/"+t},qI={},El=function(e,r,n){let i=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),s=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));i=Promise.allSettled(r.map(l=>{if(l=Bre(l),l in qI)return;qI[l]=!0;const c=l.endsWith(".css"),d=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${d}`))return;const h=document.createElement("link");if(h.rel=c?"stylesheet":Lre,c||(h.as="script"),h.crossOrigin="",h.href=l,s&&h.setAttribute("nonce",s),document.head.appendChild(h),c)return new Promise((p,m)=>{h.addEventListener("load",p),h.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${l}`)))})}))}function a(o){const s=new Event("vite:preloadError",{cancelable:!0});if(s.payload=o,window.dispatchEvent(s),!s.defaultPrevented)throw o}return i.then(o=>{for(const s of o||[])s.status==="rejected"&&a(s.reason);return e().catch(a)})};function L1(t){return fY()?t.altKey:t.ctrlKey}function Vg(t,e){var r,n;let i=`[data-key="${CSS.escape(String(e))}"]`,a=(r=t.current)===null||r===void 0?void 0:r.dataset.collection;return a&&(i=`[data-collection="${CSS.escape(a)}"]${i}`),(n=t.current)===null||n===void 0?void 0:n.querySelector(i)}const jB=new WeakMap;function Nre(t){let e=Ii();return jB.set(t,e),e}function Ure(t){return jB.get(t)}const Fre=1e3;function jre(t){let{keyboardDelegate:e,selectionManager:r,onTypeSelect:n}=t,i=D.useRef({search:"",timeout:void 0}).current,a=o=>{let s=Vre(o.key);if(!(!s||o.ctrlKey||o.metaKey||!o.currentTarget.contains(o.target))){if(s===" "&&i.search.trim().length>0&&(o.preventDefault(),"continuePropagation"in o||o.stopPropagation()),i.search+=s,e.getKeyForSearch!=null){let l=e.getKeyForSearch(i.search,r.focusedKey);l==null&&(l=e.getKeyForSearch(i.search)),l!=null&&(r.setFocusedKey(l),n&&n(l))}clearTimeout(i.timeout),i.timeout=setTimeout(()=>{i.search=""},Fre)}};return{typeSelectProps:{onKeyDownCapture:e.getKeyForSearch?a:void 0}}}function Vre(t){return t.length===1||!/^[A-Z]/i.test(t)?t:""}function zre(t){let{selectionManager:e,keyboardDelegate:r,ref:n,autoFocus:i=!1,shouldFocusWrap:a=!1,disallowEmptySelection:o=!1,disallowSelectAll:s=!1,selectOnFocus:l=e.selectionBehavior==="replace",disallowTypeAhead:c=!1,shouldUseVirtualFocus:d,allowsTabNavigation:h=!1,isVirtualized:p,scrollRef:m=n,linkBehavior:g="action"}=t,{direction:y}=sn(),R=gb(),b=ie=>{var Z;if(ie.altKey&&ie.key==="Tab"&&ie.preventDefault(),!(!((Z=n.current)===null||Z===void 0)&&Z.contains(ie.target)))return;const te=(N,ce)=>{if(N!=null){if(e.isLink(N)&&g==="selection"&&l&&!L1(ie)){G0.flushSync(()=>{e.setFocusedKey(N,ce)});let ue=Vg(n,N),pe=e.getItemProps(N);ue&&R.open(ue,ie,pe.href,pe.routerOptions);return}if(e.setFocusedKey(N,ce),e.isLink(N)&&g==="override")return;ie.shiftKey&&e.selectionMode==="multiple"?e.extendSelection(N):l&&!L1(ie)&&e.replaceSelection(N)}};switch(ie.key){case"ArrowDown":if(r.getKeyBelow){var H,fe,ne;let N=e.focusedKey!=null?(H=r.getKeyBelow)===null||H===void 0?void 0:H.call(r,e.focusedKey):(fe=r.getFirstKey)===null||fe===void 0?void 0:fe.call(r);N==null&&a&&(N=(ne=r.getFirstKey)===null||ne===void 0?void 0:ne.call(r,e.focusedKey)),N!=null&&(ie.preventDefault(),te(N))}break;case"ArrowUp":if(r.getKeyAbove){var he,oe,me;let N=e.focusedKey!=null?(he=r.getKeyAbove)===null||he===void 0?void 0:he.call(r,e.focusedKey):(oe=r.getLastKey)===null||oe===void 0?void 0:oe.call(r);N==null&&a&&(N=(me=r.getLastKey)===null||me===void 0?void 0:me.call(r,e.focusedKey)),N!=null&&(ie.preventDefault(),te(N))}break;case"ArrowLeft":if(r.getKeyLeftOf){var ee,Y,q;let N=e.focusedKey!=null?(ee=r.getKeyLeftOf)===null||ee===void 0?void 0:ee.call(r,e.focusedKey):null;N==null&&a&&(N=y==="rtl"?(Y=r.getFirstKey)===null||Y===void 0?void 0:Y.call(r,e.focusedKey):(q=r.getLastKey)===null||q===void 0?void 0:q.call(r,e.focusedKey)),N!=null&&(ie.preventDefault(),te(N,y==="rtl"?"first":"last"))}break;case"ArrowRight":if(r.getKeyRightOf){var X,F,se;let N=e.focusedKey!=null?(X=r.getKeyRightOf)===null||X===void 0?void 0:X.call(r,e.focusedKey):null;N==null&&a&&(N=y==="rtl"?(F=r.getLastKey)===null||F===void 0?void 0:F.call(r,e.focusedKey):(se=r.getFirstKey)===null||se===void 0?void 0:se.call(r,e.focusedKey)),N!=null&&(ie.preventDefault(),te(N,y==="rtl"?"last":"first"))}break;case"Home":if(r.getFirstKey){if(e.focusedKey===null&&ie.shiftKey)return;ie.preventDefault();let N=r.getFirstKey(e.focusedKey,kc(ie));e.setFocusedKey(N),N!=null&&(kc(ie)&&ie.shiftKey&&e.selectionMode==="multiple"?e.extendSelection(N):l&&e.replaceSelection(N))}break;case"End":if(r.getLastKey){if(e.focusedKey===null&&ie.shiftKey)return;ie.preventDefault();let N=r.getLastKey(e.focusedKey,kc(ie));e.setFocusedKey(N),N!=null&&(kc(ie)&&ie.shiftKey&&e.selectionMode==="multiple"?e.extendSelection(N):l&&e.replaceSelection(N))}break;case"PageDown":if(r.getKeyPageBelow&&e.focusedKey!=null){let N=r.getKeyPageBelow(e.focusedKey);N!=null&&(ie.preventDefault(),te(N))}break;case"PageUp":if(r.getKeyPageAbove&&e.focusedKey!=null){let N=r.getKeyPageAbove(e.focusedKey);N!=null&&(ie.preventDefault(),te(N))}break;case"a":kc(ie)&&e.selectionMode==="multiple"&&s!==!0&&(ie.preventDefault(),e.selectAll());break;case"Escape":!o&&e.selectedKeys.size!==0&&(ie.stopPropagation(),ie.preventDefault(),e.clearSelection());break;case"Tab":if(!h){if(ie.shiftKey)n.current.focus();else{let N=$n(n.current,{tabbable:!0}),ce,ue;do ue=N.lastChild(),ue&&(ce=ue);while(ue);ce&&!ce.contains(document.activeElement)&&wn(ce)}break}}},_=D.useRef({top:0,left:0});qa(m,"scroll",p?void 0:()=>{var ie,Z,te,H;_.current={top:(te=(ie=m.current)===null||ie===void 0?void 0:ie.scrollTop)!==null&&te!==void 0?te:0,left:(H=(Z=m.current)===null||Z===void 0?void 0:Z.scrollLeft)!==null&&H!==void 0?H:0}});let x=ie=>{if(e.isFocused){ie.currentTarget.contains(ie.target)||e.setFocused(!1);return}if(ie.currentTarget.contains(ie.target)){if(e.setFocused(!0),e.focusedKey==null){var Z,te;let ne=oe=>{oe!=null&&(e.setFocusedKey(oe),l&&!e.isSelected(oe)&&e.replaceSelection(oe))},he=ie.relatedTarget;var H,fe;he&&ie.currentTarget.compareDocumentPosition(he)&Node.DOCUMENT_POSITION_FOLLOWING?ne((H=e.lastSelectedKey)!==null&&H!==void 0?H:(Z=r.getLastKey)===null||Z===void 0?void 0:Z.call(r)):ne((fe=e.firstSelectedKey)!==null&&fe!==void 0?fe:(te=r.getFirstKey)===null||te===void 0?void 0:te.call(r))}else!p&&m.current&&(m.current.scrollTop=_.current.top,m.current.scrollLeft=_.current.left);if(e.focusedKey!=null&&m.current){let ne=Vg(n,e.focusedKey);ne instanceof HTMLElement&&(!ne.contains(document.activeElement)&&!d&&wn(ne),il()==="keyboard"&&Zy(ne,{containingElement:n.current}))}}},T=ie=>{ie.currentTarget.contains(ie.relatedTarget)||e.setFocused(!1)},I=D.useRef(!1);qa(n,CY,d?ie=>{let{detail:Z}=ie;ie.stopPropagation(),e.setFocused(!0),(Z==null?void 0:Z.focusStrategy)==="first"&&(I.current=!0)}:void 0);let C=rn(()=>{var ie,Z;let te=(Z=(ie=r.getFirstKey)===null||ie===void 0?void 0:ie.call(r))!==null&&Z!==void 0?Z:null;te==null?(SL(n.current),e.collection.size>0&&(I.current=!1)):(e.setFocusedKey(te),I.current=!1)});mM(()=>{I.current&&C()},[e.collection,C]);let k=rn(()=>{e.collection.size>0&&(I.current=!1)});mM(()=>{k()},[e.focusedKey,k]),qa(n,xY,d?ie=>{var Z;ie.stopPropagation(),e.setFocused(!1),!((Z=ie.detail)===null||Z===void 0)&&Z.clearFocusKey&&e.setFocusedKey(null)}:void 0);const S=D.useRef(i),V=D.useRef(!1);D.useEffect(()=>{if(S.current){var ie,Z;let fe=null;var te;i==="first"&&(fe=(te=(ie=r.getFirstKey)===null||ie===void 0?void 0:ie.call(r))!==null&&te!==void 0?te:null);var H;i==="last"&&(fe=(H=(Z=r.getLastKey)===null||Z===void 0?void 0:Z.call(r))!==null&&H!==void 0?H:null);let ne=e.selectedKeys;if(ne.size){for(let he of ne)if(e.canSelectItem(he)){fe=he;break}}e.setFocused(!0),e.setFocusedKey(fe),fe==null&&!d&&n.current&&Mu(n.current),e.collection.size>0&&(S.current=!1,V.current=!0)}});let z=D.useRef(e.focusedKey);D.useEffect(()=>{if(e.isFocused&&e.focusedKey!=null&&(e.focusedKey!==z.current||V.current)&&m.current&&n.current){let ie=il(),Z=Vg(n,e.focusedKey);if(!(Z instanceof HTMLElement))return;(ie==="keyboard"||V.current)&&(Y6(m.current,Z),ie!=="virtual"&&Zy(Z,{containingElement:n.current}))}!d&&e.isFocused&&e.focusedKey==null&&z.current!=null&&n.current&&Mu(n.current),z.current=e.focusedKey,V.current=!1}),qa(n,"react-aria-focus-scope-restore",ie=>{ie.preventDefault(),e.setFocused(!0)});let j={onKeyDown:b,onFocus:x,onBlur:T,onMouseDown(ie){m.current===ie.target&&ie.preventDefault()}},{typeSelectProps:J}=jre({keyboardDelegate:r,selectionManager:e});c||(j=Oe(J,j));let $;d||($=e.focusedKey==null?0:-1);let le=Nre(e.collection);return{collectionProps:Oe(j,{tabIndex:$,"data-collection":le})}}function Kre(t){let{id:e,selectionManager:r,key:n,ref:i,shouldSelectOnPressUp:a,shouldUseVirtualFocus:o,focus:s,isDisabled:l,onAction:c,allowsDifferentPressOrigin:d,linkBehavior:h="action"}=t,p=gb();e=Ii(e);let m=H=>{if(H.pointerType==="keyboard"&&L1(H))r.toggleSelection(n);else{if(r.selectionMode==="none")return;if(r.isLink(n)){if(h==="selection"&&i.current){let fe=r.getItemProps(n);p.open(i.current,H,fe.href,fe.routerOptions),r.setSelectedKeys(r.selectedKeys);return}else if(h==="override"||h==="none")return}r.selectionMode==="single"?r.isSelected(n)&&!r.disallowEmptySelection?r.toggleSelection(n):r.replaceSelection(n):H&&H.shiftKey?r.extendSelection(n):r.selectionBehavior==="toggle"||H&&(kc(H)||H.pointerType==="touch"||H.pointerType==="virtual")?r.toggleSelection(n):r.replaceSelection(n)}};D.useEffect(()=>{n===r.focusedKey&&r.isFocused&&(o?SL(i.current):s?s():document.activeElement!==i.current&&i.current&&Mu(i.current))},[i,n,r.focusedKey,r.childFocusStrategy,r.isFocused,o]),l=l||r.isDisabled(n);let g={};!o&&!l?g={tabIndex:n===r.focusedKey?0:-1,onFocus(H){H.target===i.current&&r.setFocusedKey(n)}}:l&&(g.onMouseDown=H=>{H.preventDefault()});let y=r.isLink(n)&&h==="override",R=r.isLink(n)&&h!=="selection"&&h!=="none",b=!l&&r.canSelectItem(n)&&!y,_=(c||R)&&!l,x=_&&(r.selectionBehavior==="replace"?!b:!b||r.isEmpty),T=_&&b&&r.selectionBehavior==="replace",I=x||T,C=D.useRef(null),k=I&&b,S=D.useRef(!1),V=D.useRef(!1),z=H=>{if(c&&c(),R&&i.current){let fe=r.getItemProps(n);p.open(i.current,H,fe.href,fe.routerOptions)}},j={};a?(j.onPressStart=H=>{C.current=H.pointerType,S.current=k,H.pointerType==="keyboard"&&(!I||YI())&&m(H)},d?(j.onPressUp=x?void 0:H=>{H.pointerType==="mouse"&&b&&m(H)},j.onPress=x?z:H=>{H.pointerType!=="keyboard"&&H.pointerType!=="mouse"&&b&&m(H)}):j.onPress=H=>{if(x||T&&H.pointerType!=="mouse"){if(H.pointerType==="keyboard"&&!ZI())return;z(H)}else H.pointerType!=="keyboard"&&b&&m(H)}):(j.onPressStart=H=>{C.current=H.pointerType,S.current=k,V.current=x,b&&(H.pointerType==="mouse"&&!x||H.pointerType==="keyboard"&&(!_||YI()))&&m(H)},j.onPress=H=>{(H.pointerType==="touch"||H.pointerType==="pen"||H.pointerType==="virtual"||H.pointerType==="keyboard"&&I&&ZI()||H.pointerType==="mouse"&&V.current)&&(I?z(H):b&&m(H))}),g["data-collection"]=Ure(r.collection),g["data-key"]=n,j.preventFocusOnPress=o,o&&(j=Oe(j,{onPressStart(H){H.pointerType!=="touch"&&(r.setFocused(!0),r.setFocusedKey(n))},onPress(H){H.pointerType==="touch"&&(r.setFocused(!0),r.setFocusedKey(n))}}));let{pressProps:J,isPressed:$}=is(j),le=T?H=>{C.current==="mouse"&&(H.stopPropagation(),H.preventDefault(),z(H))}:void 0,{longPressProps:ie}=gL({isDisabled:!k,onLongPress(H){H.pointerType==="touch"&&(m(H),r.setSelectionBehavior("toggle"))}}),Z=H=>{C.current==="touch"&&S.current&&H.preventDefault()},te=r.isLink(n)?H=>{dl.isOpening||H.preventDefault()}:void 0;return{itemProps:Oe(g,b||x||o?J:{},k?ie:{},{onDoubleClick:le,onDragStartCapture:Z,onClick:te,id:e},o?{onMouseDown:H=>H.preventDefault()}:void 0),isPressed:$,isSelected:r.isSelected(n),isFocused:r.isFocused&&r.focusedKey===n,isDisabled:l,allowsSelection:b,hasAction:I}}function ZI(){let t=window.event;return(t==null?void 0:t.key)==="Enter"}function YI(){let t=window.event;return(t==null?void 0:t.key)===" "||(t==null?void 0:t.code)==="Space"}class JI{getItemRect(e){let r=this.ref.current;if(!r)return null;let n=e!=null?Vg(this.ref,e):null;if(!n)return null;let i=r.getBoundingClientRect(),a=n.getBoundingClientRect();return{x:a.left-i.left+r.scrollLeft,y:a.top-i.top+r.scrollTop,width:a.width,height:a.height}}getContentSize(){let e=this.ref.current;var r,n;return{width:(r=e==null?void 0:e.scrollWidth)!==null&&r!==void 0?r:0,height:(n=e==null?void 0:e.scrollHeight)!==null&&n!==void 0?n:0}}getVisibleRect(){let e=this.ref.current;var r,n,i,a;return{x:(r=e==null?void 0:e.scrollLeft)!==null&&r!==void 0?r:0,y:(n=e==null?void 0:e.scrollTop)!==null&&n!==void 0?n:0,width:(i=e==null?void 0:e.offsetWidth)!==null&&i!==void 0?i:0,height:(a=e==null?void 0:e.offsetHeight)!==null&&a!==void 0?a:0}}constructor(e){this.ref=e}}class Hre{isDisabled(e){var r;return this.disabledBehavior==="all"&&(((r=e.props)===null||r===void 0?void 0:r.isDisabled)||this.disabledKeys.has(e.key))}findNextNonDisabled(e,r){let n=e;for(;n!=null;){let i=this.collection.getItem(n);if((i==null?void 0:i.type)==="item"&&!this.isDisabled(i))return n;n=r(n)}return null}getNextKey(e){let r=e;return r=this.collection.getKeyAfter(r),this.findNextNonDisabled(r,n=>this.collection.getKeyAfter(n))}getPreviousKey(e){let r=e;return r=this.collection.getKeyBefore(r),this.findNextNonDisabled(r,n=>this.collection.getKeyBefore(n))}findKey(e,r,n){let i=e,a=this.layoutDelegate.getItemRect(i);if(!a||i==null)return null;let o=a;do{if(i=r(i),i==null)break;a=this.layoutDelegate.getItemRect(i)}while(a&&n(o,a)&&i!=null);return i}isSameRow(e,r){return e.y===r.y||e.x!==r.x}isSameColumn(e,r){return e.x===r.x||e.y!==r.y}getKeyBelow(e){return this.layout==="grid"&&this.orientation==="vertical"?this.findKey(e,r=>this.getNextKey(r),this.isSameRow):this.getNextKey(e)}getKeyAbove(e){return this.layout==="grid"&&this.orientation==="vertical"?this.findKey(e,r=>this.getPreviousKey(r),this.isSameRow):this.getPreviousKey(e)}getNextColumn(e,r){return r?this.getPreviousKey(e):this.getNextKey(e)}getKeyRightOf(e){let r=this.direction==="ltr"?"getKeyRightOf":"getKeyLeftOf";return this.layoutDelegate[r]?(e=this.layoutDelegate[r](e),this.findNextNonDisabled(e,n=>this.layoutDelegate[r](n))):this.layout==="grid"?this.orientation==="vertical"?this.getNextColumn(e,this.direction==="rtl"):this.findKey(e,n=>this.getNextColumn(n,this.direction==="rtl"),this.isSameColumn):this.orientation==="horizontal"?this.getNextColumn(e,this.direction==="rtl"):null}getKeyLeftOf(e){let r=this.direction==="ltr"?"getKeyLeftOf":"getKeyRightOf";return this.layoutDelegate[r]?(e=this.layoutDelegate[r](e),this.findNextNonDisabled(e,n=>this.layoutDelegate[r](n))):this.layout==="grid"?this.orientation==="vertical"?this.getNextColumn(e,this.direction==="ltr"):this.findKey(e,n=>this.getNextColumn(n,this.direction==="ltr"),this.isSameColumn):this.orientation==="horizontal"?this.getNextColumn(e,this.direction==="ltr"):null}getFirstKey(){let e=this.collection.getFirstKey();return this.findNextNonDisabled(e,r=>this.collection.getKeyAfter(r))}getLastKey(){let e=this.collection.getLastKey();return this.findNextNonDisabled(e,r=>this.collection.getKeyBefore(r))}getKeyPageAbove(e){let r=this.ref.current,n=this.layoutDelegate.getItemRect(e);if(!n)return null;if(r&&!Op(r))return this.getFirstKey();let i=e;if(this.orientation==="horizontal"){let a=Math.max(0,n.x+n.width-this.layoutDelegate.getVisibleRect().width);for(;n&&n.x>a&&i!=null;)i=this.getKeyAbove(i),n=i==null?null:this.layoutDelegate.getItemRect(i)}else{let a=Math.max(0,n.y+n.height-this.layoutDelegate.getVisibleRect().height);for(;n&&n.y>a&&i!=null;)i=this.getKeyAbove(i),n=i==null?null:this.layoutDelegate.getItemRect(i)}return i??this.getFirstKey()}getKeyPageBelow(e){let r=this.ref.current,n=this.layoutDelegate.getItemRect(e);if(!n)return null;if(r&&!Op(r))return this.getLastKey();let i=e;if(this.orientation==="horizontal"){let a=Math.min(this.layoutDelegate.getContentSize().width,n.y-n.width+this.layoutDelegate.getVisibleRect().width);for(;n&&n.x<a&&i!=null;)i=this.getKeyBelow(i),n=i==null?null:this.layoutDelegate.getItemRect(i)}else{let a=Math.min(this.layoutDelegate.getContentSize().height,n.y-n.height+this.layoutDelegate.getVisibleRect().height);for(;n&&n.y<a&&i!=null;)i=this.getKeyBelow(i),n=i==null?null:this.layoutDelegate.getItemRect(i)}return i??this.getLastKey()}getKeyForSearch(e,r){if(!this.collator)return null;let n=this.collection,i=r||this.getFirstKey();for(;i!=null;){let a=n.getItem(i);if(!a)return null;let o=a.textValue.slice(0,e.length);if(a.textValue&&this.collator.compare(o,e)===0)return i;i=this.getNextKey(i)}return null}constructor(...e){if(e.length===1){let r=e[0];this.collection=r.collection,this.ref=r.ref,this.collator=r.collator,this.disabledKeys=r.disabledKeys||new Set,this.disabledBehavior=r.disabledBehavior||"all",this.orientation=r.orientation||"vertical",this.direction=r.direction,this.layout=r.layout||"stack",this.layoutDelegate=r.layoutDelegate||new JI(r.ref)}else this.collection=e[0],this.disabledKeys=e[1],this.ref=e[2],this.collator=e[3],this.layout="stack",this.orientation="vertical",this.disabledBehavior="all",this.layoutDelegate=new JI(this.ref);this.layout==="stack"&&this.orientation==="vertical"&&(this.getKeyLeftOf=void 0,this.getKeyRightOf=void 0)}}function Wre(t){let{selectionManager:e,collection:r,disabledKeys:n,ref:i,keyboardDelegate:a,layoutDelegate:o}=t,s=nL({usage:"search",sensitivity:"base"}),l=e.disabledBehavior,c=D.useMemo(()=>a||new Hre({collection:r,disabledKeys:n,disabledBehavior:l,ref:i,collator:s,layoutDelegate:o}),[a,o,r,n,i,s,l]),{collectionProps:d}=zre({...t,ref:i,selectionManager:e,keyboardDelegate:c});return{listProps:d}}var Gre=t=>O.jsxs("svg",{"aria-hidden":"true",fill:"none",focusable:"false",height:"1em",role:"presentation",viewBox:"0 0 24 24",width:"1em",...t,children:[O.jsx("path",{d:"M7.75 2.5a.75.75 0 0 0-1.5 0v1.58c-1.44.115-2.384.397-3.078 1.092c-.695.694-.977 1.639-1.093 3.078h19.842c-.116-1.44-.398-2.384-1.093-3.078c-.694-.695-1.639-.977-3.078-1.093V2.5a.75.75 0 0 0-1.5 0v1.513C15.585 4 14.839 4 14 4h-4c-.839 0-1.585 0-2.25.013z",fill:"currentColor"}),O.jsx("path",{clipRule:"evenodd",d:"M2 12c0-.839 0-1.585.013-2.25h19.974C22 10.415 22 11.161 22 12v2c0 3.771 0 5.657-1.172 6.828C19.657 22 17.771 22 14 22h-4c-3.771 0-5.657 0-6.828-1.172C2 19.657 2 17.771 2 14zm15 2a1 1 0 1 0 0-2a1 1 0 0 0 0 2m0 4a1 1 0 1 0 0-2a1 1 0 0 0 0 2m-4-5a1 1 0 1 1-2 0a1 1 0 0 1 2 0m0 4a1 1 0 1 1-2 0a1 1 0 0 1 2 0m-6-3a1 1 0 1 0 0-2a1 1 0 0 0 0 2m0 4a1 1 0 1 0 0-2a1 1 0 0 0 0 2",fill:"currentColor",fillRule:"evenodd"})]}),qre=t=>O.jsx("svg",{className:"fill-current",fill:"none",height:"24",viewBox:"0 0 24 24",width:"24",xmlns:"http://www.w3.org/2000/svg",...t,children:O.jsx("path",{clipRule:"evenodd",d:"M3 10.417C3 7.219 3 5.62 3.378 5.082C3.755 4.545 5.258 4.03 8.265 3.001L8.838 2.805C10.405 2.268 11.188 2 12 2C12.812 2 13.595 2.268 15.162 2.805L15.735 3.001C18.742 4.03 20.245 4.545 20.622 5.082C21 5.62 21 7.22 21 10.417V11.991C21 17.629 16.761 20.366 14.101 21.527C13.38 21.842 13.02 22 12 22C10.98 22 10.62 21.842 9.899 21.527C7.239 20.365 3 17.63 3 11.991V10.417ZM12 7.25C12.1989 7.25 12.3897 7.32902 12.5303 7.46967C12.671 7.61032 12.75 7.80109 12.75 8V12C12.75 12.1989 12.671 12.3897 12.5303 12.5303C12.3897 12.671 12.1989 12.75 12 12.75C11.8011 12.75 11.6103 12.671 11.4697 12.5303C11.329 12.3897 11.25 12.1989 11.25 12V8C11.25 7.80109 11.329 7.61032 11.4697 7.46967C11.6103 7.32902 11.8011 7.25 12 7.25ZM12 16C12.2652 16 12.5196 15.8946 12.7071 15.7071C12.8946 15.5196 13 15.2652 13 15C13 14.7348 12.8946 14.4804 12.7071 14.2929C12.5196 14.1054 12.2652 14 12 14C11.7348 14 11.4804 14.1054 11.2929 14.2929C11.1054 14.4804 11 14.7348 11 15C11 15.2652 11.1054 15.5196 11.2929 15.7071C11.4804 15.8946 11.7348 16 12 16Z",fill:"currentColor",fillRule:"evenodd"})}),Zre=t=>O.jsx("svg",{fill:"none",height:"24",viewBox:"0 0 24 24",width:"24",xmlns:"http://www.w3.org/2000/svg",...t,children:O.jsx("path",{d:`
          M12 2C6.49 2 2 6.49 2 12C2 17.51 6.49 22 12 22C17.51 22 22 17.51 22 12C22 6.49 17.51 2 12 2Z
          M16.78 9.7L11.11 15.37C10.97 15.51 10.78 15.59 10.58 15.59C10.38 15.59 10.19 15.51 10.05 15.37L7.22 12.54
          C6.93 12.25 6.93 11.77 7.22 11.48C7.51 11.19 7.99 11.19 8.28 11.48L10.58 13.78L15.72 8.64
          C16.01 8.35 16.49 8.35 16.78 8.64C17.07 8.93 17.07 9.4 16.78 9.7Z
        `})}),qS=t=>O.jsx("svg",{fill:"none",height:"24",viewBox:"0 0 24 24",width:"24",xmlns:"http://www.w3.org/2000/svg",...t,children:O.jsx("path",{d:"M12 22C17.51 22 22 17.51 22 12C22 6.49 17.51 2 12 2C6.49 2 2 6.49 2 12C2 17.51 6.49 22 12 22ZM12.75 16C12.75 16.41 12.41 16.75 12 16.75C11.59 16.75 11.25 16.41 11.25 16L11.25 11C11.25 10.59 11.59 10.25 12 10.25C12.41 10.25 12.75 10.59 12.75 11L12.75 16ZM11.08 7.62C11.13 7.49 11.2 7.39 11.29 7.29C11.39 7.2 11.5 7.13 11.62 7.08C11.74 7.03 11.87 7 12 7C12.13 7 12.26 7.03 12.38 7.08C12.5 7.13 12.61 7.2 12.71 7.29C12.8 7.39 12.87 7.49 12.92 7.62C12.97 7.74 13 7.87 13 8C13 8.13 12.97 8.26 12.92 8.38C12.87 8.5 12.8 8.61 12.71 8.71C12.61 8.8 12.5 8.87 12.38 8.92C12.14 9.02 11.86 9.02 11.62 8.92C11.5 8.87 11.39 8.8 11.29 8.71C11.2 8.61 11.13 8.5 11.08 8.38C11.03 8.26 11 8.13 11 8C11 7.87 11.03 7.74 11.08 7.62Z"})}),v4=t=>O.jsx("svg",{"aria-hidden":"true",focusable:"false",height:"1em",role:"presentation",viewBox:"0 0 24 24",width:"1em",...t,children:O.jsx("path",{d:"M12 2a10 10 0 1010 10A10.016 10.016 0 0012 2zm3.36 12.3a.754.754 0 010 1.06.748.748 0 01-1.06 0l-2.3-2.3-2.3 2.3a.748.748 0 01-1.06 0 .754.754 0 010-1.06l2.3-2.3-2.3-2.3A.75.75 0 019.7 8.64l2.3 2.3 2.3-2.3a.75.75 0 011.06 1.06l-2.3 2.3z",fill:"currentColor"})}),VB=t=>{const{isSelected:e,isIndeterminate:r,disableAnimation:n,...i}=t;return O.jsx("svg",{"aria-hidden":"true",className:"fill-current",fill:"none",focusable:"false",height:"1em",role:"presentation",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,viewBox:"0 0 24 24",width:"1em",...i,children:O.jsx("path",{d:"M18 6L6 18M6 6l12 12"})})},Yre=t=>O.jsx("svg",{className:"fill-current",fill:"none",height:"20",viewBox:"0 0 20 20",width:"20",xmlns:"http://www.w3.org/2000/svg",...t,children:O.jsx("path",{d:"M17.51 3.85L11.57 0.42C10.6 -0.14 9.4 -0.14 8.42 0.42L2.49 3.85C1.52 4.41 0.919998 5.45 0.919998 6.58V13.42C0.919998 14.54 1.52 15.58 2.49 16.15L8.43 19.58C9.4 20.14 10.6 20.14 11.58 19.58L17.52 16.15C18.49 15.59 19.09 14.55 19.09 13.42V6.58C19.08 5.45 18.48 4.42 17.51 3.85ZM9.25 5.75C9.25 5.34 9.59 5 10 5C10.41 5 10.75 5.34 10.75 5.75V11C10.75 11.41 10.41 11.75 10 11.75C9.59 11.75 9.25 11.41 9.25 11V5.75ZM10.92 14.63C10.87 14.75 10.8 14.86 10.71 14.96C10.52 15.15 10.27 15.25 10 15.25C9.87 15.25 9.74 15.22 9.62 15.17C9.49 15.12 9.39 15.05 9.29 14.96C9.2 14.86 9.13 14.75 9.07 14.63C9.02 14.51 9 14.38 9 14.25C9 13.99 9.1 13.73 9.29 13.54C9.39 13.45 9.49 13.38 9.62 13.33C9.99 13.17 10.43 13.26 10.71 13.54C10.8 13.64 10.87 13.74 10.92 13.87C10.97 13.99 11 14.12 11 14.25C11 14.38 10.97 14.51 10.92 14.63Z"})});function Jre(){const[t,e]=D.useState({width:null,height:null}),r=D.useRef(null);return[D.useCallback(i=>{if(r.current&&(r.current.disconnect(),r.current=null),(i==null?void 0:i.nodeType)===Node.ELEMENT_NODE){const a=new ResizeObserver(([o])=>{if(o&&o.borderBoxSize){const{inlineSize:s,blockSize:l}=o.borderBoxSize[0];e({width:s,height:l})}});a.observe(i),r.current=a}},[]),t]}var zB=D.forwardRef((t,e)=>{const{children:r,...n}=t;let[i,a]=Jre();return O.jsx(Ca,{features:Cte,children:O.jsx(Ai.div,{ref:e,animate:{width:a.width&&(a==null?void 0:a.width)>0?a.width:"auto",height:a.height&&a.height>0?a.height:"auto"},children:O.jsx("div",{ref:i,...n,children:r})})})});zB.displayName="HeroUI - ResizablePanel";var op={ease:[.36,.66,.4,1]},jp={scaleSpringOpacity:{initial:{opacity:0,transform:"scale(0.8)"},enter:{opacity:1,transform:"scale(1)",transition:{type:"spring",bounce:0,duration:.3}},exit:{opacity:0,transform:"scale(0.96)",transition:{type:"easeOut",bounce:0,duration:.15}}},fade:{enter:{opacity:1,transition:{duration:.4,ease:op.ease}},exit:{opacity:0,transition:{duration:.3,ease:op.ease}}}};class Xre{*[Symbol.iterator](){yield*this.iterable}get size(){return this.keyMap.size}getKeys(){return this.keyMap.keys()}getKeyBefore(e){let r=this.keyMap.get(e);var n;return r&&(n=r.prevKey)!==null&&n!==void 0?n:null}getKeyAfter(e){let r=this.keyMap.get(e);var n;return r&&(n=r.nextKey)!==null&&n!==void 0?n:null}getFirstKey(){return this.firstKey}getLastKey(){return this.lastKey}getItem(e){var r;return(r=this.keyMap.get(e))!==null&&r!==void 0?r:null}at(e){const r=[...this.getKeys()];return this.getItem(r[e])}constructor(e,{expandedKeys:r}={}){this.keyMap=new Map,this.firstKey=null,this.lastKey=null,this.iterable=e,r=r||new Set;let n=s=>{if(this.keyMap.set(s.key,s),s.childNodes&&(s.type==="section"||r.has(s.key)))for(let l of s.childNodes)n(l)};for(let s of e)n(s);let i=null,a=0;for(let[s,l]of this.keyMap)i?(i.nextKey=s,l.prevKey=i.key):(this.firstKey=s,l.prevKey=void 0),l.type==="item"&&(l.index=a++),i=l,i.nextKey=void 0;var o;this.lastKey=(o=i==null?void 0:i.key)!==null&&o!==void 0?o:null}}class va extends Set{constructor(e,r,n){super(e),e instanceof va?(this.anchorKey=r??e.anchorKey,this.currentKey=n??e.currentKey):(this.anchorKey=r??null,this.currentKey=n??null)}}function Qre(t,e,r){let[n,i]=D.useState(t||e),a=D.useRef(t!==void 0),o=t!==void 0;D.useEffect(()=>{a.current,a.current=o},[o]);let s=o?t:n,l=D.useCallback((c,...d)=>{let h=(p,...m)=>{r&&(Object.is(s,p)||r(p,...m)),o||(s=p)};typeof c=="function"?i((m,...g)=>{let y=c(o?s:m,...g);return h(y,...d),o?m:y}):(o||i(c),h(c,...d))},[o,s,r]);return[s,l]}function ene(t,e){if(t.size!==e.size)return!1;for(let r of t)if(!e.has(r))return!1;return!0}function tne(t){let{selectionMode:e="none",disallowEmptySelection:r=!1,allowDuplicateSelectionEvents:n,selectionBehavior:i="toggle",disabledBehavior:a="all"}=t,o=D.useRef(!1),[,s]=D.useState(!1),l=D.useRef(null),c=D.useRef(null),[,d]=D.useState(null),h=D.useMemo(()=>XI(t.selectedKeys),[t.selectedKeys]),p=D.useMemo(()=>XI(t.defaultSelectedKeys,new va),[t.defaultSelectedKeys]),[m,g]=Qre(h,p,t.onSelectionChange),y=D.useMemo(()=>t.disabledKeys?new Set(t.disabledKeys):new Set,[t.disabledKeys]),[R,b]=D.useState(i);i==="replace"&&R==="toggle"&&typeof m=="object"&&m.size===0&&b("replace");let _=D.useRef(i);return D.useEffect(()=>{i!==_.current&&(b(i),_.current=i)},[i]),{selectionMode:e,disallowEmptySelection:r,selectionBehavior:R,setSelectionBehavior:b,get isFocused(){return o.current},setFocused(x){o.current=x,s(x)},get focusedKey(){return l.current},get childFocusStrategy(){return c.current},setFocusedKey(x,T="first"){l.current=x,c.current=T,d(x)},selectedKeys:m,setSelectedKeys(x){(n||!ene(x,m))&&g(x)},disabledKeys:y,disabledBehavior:a}}function XI(t,e){return t?t==="all"?"all":new va(t):e}function rne(t,e){return typeof e.getChildren=="function"?e.getChildren(t.key):t.childNodes}function nne(t){return ine(t)}function ine(t,e){for(let r of t)return r}function ZS(t,e,r){if(e.parentKey===r.parentKey)return e.index-r.index;let n=[...QI(t,e),e],i=[...QI(t,r),r],a=n.slice(0,i.length).findIndex((o,s)=>o!==i[s]);return a!==-1?(e=n[a],r=i[a],e.index-r.index):n.findIndex(o=>o===r)>=0?1:(i.findIndex(o=>o===e)>=0,-1)}function QI(t,e){let r=[],n=e;for(;(n==null?void 0:n.parentKey)!=null;)n=t.getItem(n.parentKey),n&&r.unshift(n);return r}class g4{get selectionMode(){return this.state.selectionMode}get disallowEmptySelection(){return this.state.disallowEmptySelection}get selectionBehavior(){return this.state.selectionBehavior}setSelectionBehavior(e){this.state.setSelectionBehavior(e)}get isFocused(){return this.state.isFocused}setFocused(e){this.state.setFocused(e)}get focusedKey(){return this.state.focusedKey}get childFocusStrategy(){return this.state.childFocusStrategy}setFocusedKey(e,r){(e==null||this.collection.getItem(e))&&this.state.setFocusedKey(e,r)}get selectedKeys(){return this.state.selectedKeys==="all"?new Set(this.getSelectAllKeys()):this.state.selectedKeys}get rawSelection(){return this.state.selectedKeys}isSelected(e){if(this.state.selectionMode==="none")return!1;let r=this.getKey(e);return r==null?!1:this.state.selectedKeys==="all"?this.canSelectItem(r):this.state.selectedKeys.has(r)}get isEmpty(){return this.state.selectedKeys!=="all"&&this.state.selectedKeys.size===0}get isSelectAll(){if(this.isEmpty)return!1;if(this.state.selectedKeys==="all")return!0;if(this._isSelectAll!=null)return this._isSelectAll;let e=this.getSelectAllKeys(),r=this.state.selectedKeys;return this._isSelectAll=e.every(n=>r.has(n)),this._isSelectAll}get firstSelectedKey(){let e=null;for(let n of this.state.selectedKeys){let i=this.collection.getItem(n);(!e||i&&ZS(this.collection,i,e)<0)&&(e=i)}var r;return(r=e==null?void 0:e.key)!==null&&r!==void 0?r:null}get lastSelectedKey(){let e=null;for(let n of this.state.selectedKeys){let i=this.collection.getItem(n);(!e||i&&ZS(this.collection,i,e)>0)&&(e=i)}var r;return(r=e==null?void 0:e.key)!==null&&r!==void 0?r:null}get disabledKeys(){return this.state.disabledKeys}get disabledBehavior(){return this.state.disabledBehavior}extendSelection(e){if(this.selectionMode==="none")return;if(this.selectionMode==="single"){this.replaceSelection(e);return}let r=this.getKey(e);if(r==null)return;let n;if(this.state.selectedKeys==="all")n=new va([r],r,r);else{let o=this.state.selectedKeys;var i;let s=(i=o.anchorKey)!==null&&i!==void 0?i:r;n=new va(o,s,r);var a;for(let l of this.getKeyRange(s,(a=o.currentKey)!==null&&a!==void 0?a:r))n.delete(l);for(let l of this.getKeyRange(r,s))this.canSelectItem(l)&&n.add(l)}this.state.setSelectedKeys(n)}getKeyRange(e,r){let n=this.collection.getItem(e),i=this.collection.getItem(r);return n&&i?ZS(this.collection,n,i)<=0?this.getKeyRangeInternal(e,r):this.getKeyRangeInternal(r,e):[]}getKeyRangeInternal(e,r){var n;if(!((n=this.layoutDelegate)===null||n===void 0)&&n.getKeyRange)return this.layoutDelegate.getKeyRange(e,r);let i=[],a=e;for(;a!=null;){let o=this.collection.getItem(a);if(o&&(o.type==="item"||o.type==="cell"&&this.allowsCellSelection)&&i.push(a),a===r)return i;a=this.collection.getKeyAfter(a)}return[]}getKey(e){let r=this.collection.getItem(e);if(!r||r.type==="cell"&&this.allowsCellSelection)return e;for(;r&&r.type!=="item"&&r.parentKey!=null;)r=this.collection.getItem(r.parentKey);return!r||r.type!=="item"?null:r.key}toggleSelection(e){if(this.selectionMode==="none")return;if(this.selectionMode==="single"&&!this.isSelected(e)){this.replaceSelection(e);return}let r=this.getKey(e);if(r==null)return;let n=new va(this.state.selectedKeys==="all"?this.getSelectAllKeys():this.state.selectedKeys);n.has(r)?n.delete(r):this.canSelectItem(r)&&(n.add(r),n.anchorKey=r,n.currentKey=r),!(this.disallowEmptySelection&&n.size===0)&&this.state.setSelectedKeys(n)}replaceSelection(e){if(this.selectionMode==="none")return;let r=this.getKey(e);if(r==null)return;let n=this.canSelectItem(r)?new va([r],r,r):new va;this.state.setSelectedKeys(n)}setSelectedKeys(e){if(this.selectionMode==="none")return;let r=new va;for(let n of e){let i=this.getKey(n);if(i!=null&&(r.add(i),this.selectionMode==="single"))break}this.state.setSelectedKeys(r)}getSelectAllKeys(){let e=[],r=n=>{for(;n!=null;){if(this.canSelectItem(n)){var i;let o=this.collection.getItem(n);(o==null?void 0:o.type)==="item"&&e.push(n);var a;o!=null&&o.hasChildNodes&&(this.allowsCellSelection||o.type!=="item")&&r((a=(i=nne(rne(o,this.collection)))===null||i===void 0?void 0:i.key)!==null&&a!==void 0?a:null)}n=this.collection.getKeyAfter(n)}};return r(this.collection.getFirstKey()),e}selectAll(){!this.isSelectAll&&this.selectionMode==="multiple"&&this.state.setSelectedKeys("all")}clearSelection(){!this.disallowEmptySelection&&(this.state.selectedKeys==="all"||this.state.selectedKeys.size>0)&&this.state.setSelectedKeys(new va)}toggleSelectAll(){this.isSelectAll?this.clearSelection():this.selectAll()}select(e,r){this.selectionMode!=="none"&&(this.selectionMode==="single"?this.isSelected(e)&&!this.disallowEmptySelection?this.toggleSelection(e):this.replaceSelection(e):this.selectionBehavior==="toggle"||r&&(r.pointerType==="touch"||r.pointerType==="virtual")?this.toggleSelection(e):this.replaceSelection(e))}isSelectionEqual(e){if(e===this.state.selectedKeys)return!0;let r=this.selectedKeys;if(e.size!==r.size)return!1;for(let n of e)if(!r.has(n))return!1;for(let n of r)if(!e.has(n))return!1;return!0}canSelectItem(e){var r;if(this.state.selectionMode==="none"||this.state.disabledKeys.has(e))return!1;let n=this.collection.getItem(e);return!(!n||!(n==null||(r=n.props)===null||r===void 0)&&r.isDisabled||n.type==="cell"&&!this.allowsCellSelection)}isDisabled(e){var r,n;return this.state.disabledBehavior==="all"&&(this.state.disabledKeys.has(e)||!!(!((n=this.collection.getItem(e))===null||n===void 0||(r=n.props)===null||r===void 0)&&r.isDisabled))}isLink(e){var r,n;return!!(!((n=this.collection.getItem(e))===null||n===void 0||(r=n.props)===null||r===void 0)&&r.href)}getItemProps(e){var r;return(r=this.collection.getItem(e))===null||r===void 0?void 0:r.props}withCollection(e){return new g4(e,this.state,{allowsCellSelection:this.allowsCellSelection,layoutDelegate:this.layoutDelegate||void 0})}constructor(e,r,n){this.collection=e,this.state=r;var i;this.allowsCellSelection=(i=n==null?void 0:n.allowsCellSelection)!==null&&i!==void 0?i:!1,this._isSelectAll=null,this.layoutDelegate=(n==null?void 0:n.layoutDelegate)||null}}function KB(t){return null}KB.getCollectionNode=function*(e,r){let{childItems:n,title:i,children:a}=e,o=e.title||e.children,s=e.textValue||(typeof o=="string"?o:"")||e["aria-label"]||"";!s&&!(r!=null&&r.suppressTextValueWarning)&&console.warn("<Item> with non-plain text contents is unsupported by type to select for accessibility. Please add a `textValue` prop."),yield{type:"item",props:e,rendered:o,textValue:s,"aria-label":e["aria-label"],hasChildNodes:ane(e),*childNodes(){if(n)for(let l of n)yield{type:"item",value:l};else if(i){let l=[];We.Children.forEach(a,c=>{l.push({type:"item",element:c})}),yield*l}}}};function ane(t){return t.hasChildItems!=null?t.hasChildItems:!!(t.childItems||t.title&&We.Children.count(t.children)>0)}let one=KB;class sne{build(e,r){return this.context=r,eP(()=>this.iterateCollection(e))}*iterateCollection(e){let{children:r,items:n}=e;if(We.isValidElement(r)&&r.type===We.Fragment)yield*this.iterateCollection({children:r.props.children,items:n});else if(typeof r=="function"){if(!n)throw new Error("props.children was a function but props.items is missing");let i=0;for(let a of n)yield*this.getFullNode({value:a,index:i},{renderer:r}),i++}else{let i=[];We.Children.forEach(r,o=>{o&&i.push(o)});let a=0;for(let o of i){let s=this.getFullNode({element:o,index:a},{});for(let l of s)a++,yield l}}}getKey(e,r,n,i){if(e.key!=null)return e.key;if(r.type==="cell"&&r.key!=null)return`${i}${r.key}`;let a=r.value;if(a!=null){var o;let s=(o=a.key)!==null&&o!==void 0?o:a.id;if(s==null)throw new Error("No key found for item");return s}return i?`${i}.${r.index}`:`$.${r.index}`}getChildState(e,r){return{renderer:r.renderer||e.renderer}}*getFullNode(e,r,n,i){if(We.isValidElement(e.element)&&e.element.type===We.Fragment){let R=[];We.Children.forEach(e.element.props.children,_=>{R.push(_)});var a;let b=(a=e.index)!==null&&a!==void 0?a:0;for(const _ of R)yield*this.getFullNode({element:_,index:b++},r,n,i);return}let o=e.element;if(!o&&e.value&&r&&r.renderer){let R=this.cache.get(e.value);if(R&&(!R.shouldInvalidate||!R.shouldInvalidate(this.context))){R.index=e.index,R.parentKey=i?i.key:null,yield R;return}o=r.renderer(e.value)}if(We.isValidElement(o)){let R=o.type;if(typeof R!="function"&&typeof R.getCollectionNode!="function"){let T=o.type;throw new Error(`Unknown element <${T}> in collection.`)}let b=R.getCollectionNode(o.props,this.context);var s;let _=(s=e.index)!==null&&s!==void 0?s:0,x=b.next();for(;!x.done&&x.value;){let T=x.value;e.index=_;var l;let I=(l=T.key)!==null&&l!==void 0?l:null;I==null&&(I=T.element?null:this.getKey(o,e,r,n));let k=[...this.getFullNode({...T,key:I,index:_,wrapper:lne(e.wrapper,T.wrapper)},this.getChildState(r,T),n?`${n}${o.key}`:o.key,i)];for(let S of k){var c,d;S.value=(d=(c=T.value)!==null&&c!==void 0?c:e.value)!==null&&d!==void 0?d:null,S.value&&this.cache.set(S.value,S);var h;if(e.type&&S.type!==e.type)throw new Error(`Unsupported type <${YS(S.type)}> in <${YS((h=i==null?void 0:i.type)!==null&&h!==void 0?h:"unknown parent type")}>. Only <${YS(e.type)}> is supported.`);_++,yield S}x=b.next(k)}return}if(e.key==null||e.type==null)return;let p=this;var m,g;let y={type:e.type,props:e.props,key:e.key,parentKey:i?i.key:null,value:(m=e.value)!==null&&m!==void 0?m:null,level:i?i.level+1:0,index:e.index,rendered:e.rendered,textValue:(g=e.textValue)!==null&&g!==void 0?g:"","aria-label":e["aria-label"],wrapper:e.wrapper,shouldInvalidate:e.shouldInvalidate,hasChildNodes:e.hasChildNodes||!1,childNodes:eP(function*(){if(!e.hasChildNodes||!e.childNodes)return;let R=0;for(let b of e.childNodes()){b.key!=null&&(b.key=`${y.key}${b.key}`);let _=p.getFullNode({...b,index:R},p.getChildState(r,b),y.key,y);for(let x of _)R++,yield x}})};yield y}constructor(){this.cache=new WeakMap}}function eP(t){let e=[],r=null;return{*[Symbol.iterator](){for(let n of e)yield n;r||(r=t());for(let n of r)e.push(n),yield n}}}function lne(t,e){if(t&&e)return r=>t(e(r));if(t)return t;if(e)return e}function YS(t){return t[0].toUpperCase()+t.slice(1)}function une(t,e,r){let n=D.useMemo(()=>new sne,[]),{children:i,items:a,collection:o}=t;return D.useMemo(()=>{if(o)return o;let l=n.build({children:i,items:a},r);return e(l)},[n,i,a,o,r,e])}function cne(t,e){return typeof e.getChildren=="function"?e.getChildren(t.key):t.childNodes}const tP=new WeakMap;function dne(t){let e=tP.get(t);if(e!=null)return e;let r=0,n=i=>{for(let a of i)a.type==="section"?n(cne(a,t)):r++};return n(t),tP.set(t,r),r}function fne(t){let{onExpandedChange:e}=t,[r,n]=Pi(t.expandedKeys?new Set(t.expandedKeys):void 0,t.defaultExpandedKeys?new Set(t.defaultExpandedKeys):new Set,e),i=tne(t),a=D.useMemo(()=>t.disabledKeys?new Set(t.disabledKeys):new Set,[t.disabledKeys]),o=une(t,D.useCallback(l=>new Xre(l,{expandedKeys:r}),[r]),null);return D.useEffect(()=>{i.focusedKey!=null&&!o.getItem(i.focusedKey)&&i.setFocusedKey(null)},[o,i.focusedKey]),{collection:o,expandedKeys:r,disabledKeys:a,toggleKey:l=>{n(hne(r,l))},setExpandedKeys:n,selectionManager:new g4(o,i)}}function hne(t,e){let r=new Set(t);return r.has(e)?r.delete(e):r.add(e),r}function pne(t){let e=Mi(t,{enabled:typeof t.elementType=="string"}),r;return t.orientation==="vertical"&&(r="vertical"),t.elementType!=="hr"?{separatorProps:{...e,role:"separator","aria-orientation":r}}:{separatorProps:e}}function mne(t){const{as:e,className:r,orientation:n,...i}=t;let a=e||"hr";a==="hr"&&n==="vertical"&&(a="div");const{separatorProps:o}=pne({elementType:typeof a=="string"?a:"hr",orientation:n}),s=D.useMemo(()=>Rre({orientation:n,className:r}),[n,r]),l=D.useCallback((c={})=>({className:s,role:"separator","data-orientation":n,...o,...i,...c}),[s,n,o,i]);return{Component:a,getDividerProps:l}}var HB=Qt((t,e)=>{const{Component:r,getDividerProps:n}=mne({...t});return O.jsx(r,{ref:e,...n()})});HB.displayName="HeroUI.Divider";var WB=HB,GB=t=>{const e={top:{originY:1},bottom:{originY:0},left:{originX:1},right:{originX:0},"top-start":{originX:0,originY:1},"top-end":{originX:1,originY:1},"bottom-start":{originX:0,originY:0},"bottom-end":{originX:1,originY:0},"right-start":{originX:0,originY:0},"right-end":{originX:0,originY:1},"left-start":{originX:1,originY:0},"left-end":{originX:1,originY:1}};return(e==null?void 0:e[t])||{}},vne=t=>({top:"top",bottom:"bottom",left:"left",right:"right","top-start":"top start","top-end":"top end","bottom-start":"bottom start","bottom-end":"bottom end","left-start":"left top","left-end":"left bottom","right-start":"right top","right-end":"right bottom"})[t],gne=(t,e)=>{if(e.includes("-")){const[r]=e.split("-");if(r.includes(t))return!1}return!0},rP=(t,e)=>{if(e.includes("-")){const[,r]=e.split("-");return`${t}-${r}`}return t},uh=new WeakMap,Hn=[];function yne(t,e=document.body){let r=new Set(t),n=new Set,i=l=>{for(let p of l.querySelectorAll("[data-live-announcer], [data-react-aria-top-layer]"))r.add(p);let c=p=>{if(r.has(p)||p.parentElement&&n.has(p.parentElement)&&p.parentElement.getAttribute("role")!=="row")return NodeFilter.FILTER_REJECT;for(let m of r)if(p.contains(m))return NodeFilter.FILTER_SKIP;return NodeFilter.FILTER_ACCEPT},d=document.createTreeWalker(l,NodeFilter.SHOW_ELEMENT,{acceptNode:c}),h=c(l);if(h===NodeFilter.FILTER_ACCEPT&&a(l),h!==NodeFilter.FILTER_REJECT){let p=d.nextNode();for(;p!=null;)a(p),p=d.nextNode()}},a=l=>{var c;let d=(c=uh.get(l))!=null?c:0;l.getAttribute("aria-hidden")==="true"&&d===0||(d===0&&l.setAttribute("aria-hidden","true"),n.add(l),uh.set(l,d+1))};Hn.length&&Hn[Hn.length-1].disconnect(),i(e);let o=new MutationObserver(l=>{for(let c of l)if(!(c.type!=="childList"||c.addedNodes.length===0)&&![...r,...n].some(d=>d.contains(c.target))){for(let d of c.removedNodes)d instanceof Element&&(r.delete(d),n.delete(d));for(let d of c.addedNodes)(d instanceof HTMLElement||d instanceof SVGElement)&&(d.dataset.liveAnnouncer==="true"||d.dataset.reactAriaTopLayer==="true")?r.add(d):d instanceof Element&&i(d)}});o.observe(e,{childList:!0,subtree:!0});let s={visibleNodes:r,hiddenNodes:n,observe(){o.observe(e,{childList:!0,subtree:!0})},disconnect(){o.disconnect()}};return Hn.push(s),()=>{o.disconnect();for(let l of n){let c=uh.get(l);c!=null&&(c===1?(l.removeAttribute("aria-hidden"),uh.delete(l)):uh.set(l,c-1))}s===Hn[Hn.length-1]?(Hn.pop(),Hn.length&&Hn[Hn.length-1].observe()):Hn.splice(Hn.indexOf(s),1)}}function bne(t){let e=Hn[Hn.length-1];if(e&&!e.visibleNodes.has(t))return e.visibleNodes.add(t),()=>{e.visibleNodes.delete(t)}}var y4=(t,e,r)=>{const n=e==null?void 0:e.current;if(!n||!n.contains(t)){const i=document.querySelectorAll("body > span[data-focus-scope-start]");let a=[];if(i.forEach(o=>{a.push(o.nextElementSibling)}),a.length===1)return r.close(),!1}return!n||!n.contains(t)},b4=globalThis!=null&&globalThis.document?D.useLayoutEffect:D.useEffect,[gye,_ne]=Sl({name:"ButtonGroupContext",strict:!1});function Um(t,e){let{elementType:r="button",isDisabled:n,onPress:i,onPressStart:a,onPressEnd:o,onPressChange:s,preventFocusOnPress:l,allowFocusWhenDisabled:c,onClick:d,href:h,target:p,rel:m,type:g="button",allowTextSelectionOnPress:y,role:R}=t,b;r==="button"?b={type:g,disabled:n}:b={role:"button",href:r==="a"&&!n?h:void 0,target:r==="a"?p:void 0,type:r==="input"?g:void 0,disabled:r==="input"?n:void 0,"aria-disabled":!n||r==="input"?void 0:n,rel:r==="a"?m:void 0};let _=Hu()||km();d&&typeof d=="function"&&R!=="link"&&!(t.hasOwnProperty("aria-expanded")&&t.hasOwnProperty("aria-controls"))&&MT("onClick is deprecated, please use onPress instead. See: https://github.com/heroui-inc/heroui/issues/4292","useButton");const x=S=>{_&&(d==null||d(S)),i==null||i(S)};let{pressProps:T,isPressed:I}=is({onPressStart:a,onPressEnd:o,onPressChange:s,onPress:x,isDisabled:n,preventFocusOnPress:l,allowTextSelectionOnPress:y,ref:e}),{focusableProps:C}=BT(t,e);c&&(C.tabIndex=n?-1:C.tabIndex);let k=Oe(C,T,ho(t,{labelable:!0}));return{isPressed:I,buttonProps:Oe(b,k,{"aria-haspopup":t["aria-haspopup"],"aria-expanded":t["aria-expanded"],"aria-controls":t["aria-controls"],"aria-pressed":t["aria-pressed"],"aria-current":t["aria-current"],onClick:S=>{g==="button"&&_||d==null||d(S)}})}}var Sne=()=>El(()=>import("./index-BeaB_b6p.js"),[]).then(t=>t.default),qB=t=>{const{ripples:e=[],motionProps:r,color:n="currentColor",style:i,onClear:a}=t;return O.jsx(O.Fragment,{children:e.map(o=>{const s=RT(.01*o.size,.2,o.size>100?.75:.5);return O.jsx(Ca,{features:Sne,children:O.jsx(Gu,{mode:"popLayout",children:O.jsx(Ai.span,{animate:{transform:"scale(2)",opacity:0},className:"heroui-ripple",exit:{opacity:0},initial:{transform:"scale(0)",opacity:.35},style:{position:"absolute",backgroundColor:n,borderRadius:"100%",transformOrigin:"center",pointerEvents:"none",overflow:"hidden",inset:0,zIndex:0,top:o.y,left:o.x,width:`${o.size}px`,height:`${o.size}px`,...i},transition:{duration:s},onAnimationComplete:()=>{a(o.key)},...r})})},o.key)})})};qB.displayName="HeroUI.Ripple";var ZB=qB;function YB(t={}){const[e,r]=D.useState([]),n=D.useCallback(a=>{const o=a.target,s=Math.max(o.clientWidth,o.clientHeight);r(l=>[...l,{key:$6(l.length.toString()),size:s,x:a.x-s/2,y:a.y-s/2}])},[]),i=D.useCallback(a=>{r(o=>o.filter(s=>s.key!==a))},[]);return{ripples:e,onClear:i,onPress:n,...t}}function wne(t){var e,r,n,i,a,o,s,l,c;const d=_ne(),h=ln(),p=!!d,{ref:m,as:g,children:y,startContent:R,endContent:b,autoFocus:_,className:x,spinner:T,isLoading:I=!1,disableRipple:C=!1,fullWidth:k=(e=d==null?void 0:d.fullWidth)!=null?e:!1,radius:S=d==null?void 0:d.radius,size:V=(r=d==null?void 0:d.size)!=null?r:"md",color:z=(n=d==null?void 0:d.color)!=null?n:"default",variant:j=(i=d==null?void 0:d.variant)!=null?i:"solid",disableAnimation:J=(o=(a=d==null?void 0:d.disableAnimation)!=null?a:h==null?void 0:h.disableAnimation)!=null?o:!1,isDisabled:$=(s=d==null?void 0:d.isDisabled)!=null?s:!1,isIconOnly:le=(l=d==null?void 0:d.isIconOnly)!=null?l:!1,spinnerPlacement:ie="start",onPress:Z,onClick:te,...H}=t,fe=g||"button",ne=typeof fe=="string",he=fr(m),oe=(c=C||(h==null?void 0:h.disableRipple))!=null?c:J,{isFocusVisible:me,isFocused:ee,focusProps:Y}=io({autoFocus:_}),q=$||I,X=D.useMemo(()=>UB({size:V,color:z,variant:j,radius:S,fullWidth:k,isDisabled:q,isInGroup:p,disableAnimation:J,isIconOnly:le,className:x}),[V,z,j,S,k,q,p,le,J,x]),{onPress:F,onClear:se,ripples:N}=YB(),ce=D.useCallback(ze=>{oe||q||J||he.current&&F(ze)},[oe,q,J,he,F]),{buttonProps:ue,isPressed:pe}=Um({elementType:g,isDisabled:q,onPress:Tn(Z,ce),onClick:te,...H},he),{isHovered:be,hoverProps:we}=aa({isDisabled:q}),Ce=D.useCallback((ze={})=>({"data-disabled":Te(q),"data-focus":Te(ee),"data-pressed":Te(pe),"data-focus-visible":Te(me),"data-hover":Te(be),"data-loading":Te(I),...Oe(ue,Y,we,Mi(H,{enabled:ne}),Mi(ze)),className:X}),[I,q,ee,pe,ne,me,be,ue,Y,we,H,X]),$e=ze=>D.isValidElement(ze)?D.cloneElement(ze,{"aria-hidden":!0,focusable:!1,tabIndex:-1}):null,Ne=$e(R),Ie=$e(b),Ge=D.useMemo(()=>({sm:"sm",md:"sm",lg:"md"})[V],[V]),nt=D.useCallback(()=>({ripples:N,onClear:se}),[N,se]);return{Component:fe,children:y,domRef:he,spinner:T,styles:X,startContent:Ne,endContent:Ie,isLoading:I,spinnerPlacement:ie,spinnerSize:Ge,disableRipple:oe,getButtonProps:Ce,getRippleProps:nt,isIconOnly:le}}function Ene(t){var e,r;const[n,i]=la(t,BI.variantKeys),a=ln(),o=(r=(e=t==null?void 0:t.variant)!=null?e:a==null?void 0:a.spinnerVariant)!=null?r:"default",{children:s,className:l,classNames:c,label:d,...h}=n,p=D.useMemo(()=>BI({...i}),[Ri(i)]),m=qe(c==null?void 0:c.base,l),g=d||s,y=D.useMemo(()=>g&&typeof g=="string"?g:h["aria-label"]?"":"Loading",[s,g,h["aria-label"]]),R=D.useCallback(()=>({"aria-label":y,className:p.base({class:m}),...h}),[y,p,m,h]);return{label:g,slots:p,classNames:c,variant:o,getSpinnerProps:R}}var JB=Qt((t,e)=>{const{slots:r,classNames:n,label:i,variant:a,getSpinnerProps:o}=Ene({...t});return a==="wave"||a==="dots"?O.jsxs("div",{ref:e,...o(),children:[O.jsx("div",{className:r.wrapper({class:n==null?void 0:n.wrapper}),children:[...new Array(3)].map((s,l)=>O.jsx("i",{className:r.dots({class:n==null?void 0:n.dots}),style:{"--dot-index":l}},`dot-${l}`))}),i&&O.jsx("span",{className:r.label({class:n==null?void 0:n.label}),children:i})]}):a==="simple"?O.jsxs("div",{ref:e,...o(),children:[O.jsxs("svg",{className:r.wrapper({class:n==null?void 0:n.wrapper}),fill:"none",viewBox:"0 0 24 24",children:[O.jsx("circle",{className:r.circle1({class:n==null?void 0:n.circle1}),cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),O.jsx("path",{className:r.circle2({class:n==null?void 0:n.circle2}),d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",fill:"currentColor"})]}),i&&O.jsx("span",{className:r.label({class:n==null?void 0:n.label}),children:i})]}):a==="spinner"?O.jsxs("div",{ref:e,...o(),children:[O.jsx("div",{className:r.wrapper({class:n==null?void 0:n.wrapper}),children:[...new Array(12)].map((s,l)=>O.jsx("i",{className:r.spinnerBars({class:n==null?void 0:n.spinnerBars}),style:{"--bar-index":l}},`star-${l}`))}),i&&O.jsx("span",{className:r.label({class:n==null?void 0:n.label}),children:i})]}):O.jsxs("div",{ref:e,...o(),children:[O.jsxs("div",{className:r.wrapper({class:n==null?void 0:n.wrapper}),children:[O.jsx("i",{className:r.circle1({class:n==null?void 0:n.circle1})}),O.jsx("i",{className:r.circle2({class:n==null?void 0:n.circle2})})]}),i&&O.jsx("span",{className:r.label({class:n==null?void 0:n.label}),children:i})]})});JB.displayName="HeroUI.Spinner";var _4=JB,XB=Qt((t,e)=>{const{Component:r,domRef:n,children:i,spinnerSize:a,spinner:o=O.jsx(_4,{color:"current",size:a}),spinnerPlacement:s,startContent:l,endContent:c,isLoading:d,disableRipple:h,getButtonProps:p,getRippleProps:m,isIconOnly:g}=wne({...t,ref:e});return O.jsxs(r,{ref:n,...p(),children:[l,d&&s==="start"&&o,d&&g?null:i,d&&s==="end"&&o,c,!h&&O.jsx(ZB,{...m()})]})});XB.displayName="HeroUI.Button";var An=XB,[xne,QB]=Sl({name:"CardContext",strict:!0,errorMessage:"useCardContext: `context` is undefined. Seems you forgot to wrap component within <Card />"}),e7=Qt((t,e)=>{var r;const{as:n,className:i,children:a,...o}=t,s=n||"div",l=fr(e),{slots:c,classNames:d}=QB(),h=qe(d==null?void 0:d.body,i);return O.jsx(s,{ref:l,className:(r=c.body)==null?void 0:r.call(c,{class:h}),...o,children:a})});e7.displayName="HeroUI.CardBody";var t7=e7,r7=Qt((t,e)=>{var r;const{as:n,className:i,children:a,...o}=t,s=n||"div",l=fr(e),{slots:c,classNames:d}=QB(),h=qe(d==null?void 0:d.header,i);return O.jsx(s,{ref:l,className:(r=c.header)==null?void 0:r.call(c,{class:h}),...o,children:a})});r7.displayName="HeroUI.CardHeader";var n7=r7;function Cne(t){var e,r,n,i;const a=ln(),[o,s]=la(t,HI.variantKeys),{ref:l,as:c,children:d,onClick:h,onPress:p,autoFocus:m,className:g,classNames:y,allowTextSelectionOnPress:R=!0,...b}=o,_=fr(l),x=c||(t.isPressable?"button":"div"),T=typeof x=="string",I=(r=(e=t.disableAnimation)!=null?e:a==null?void 0:a.disableAnimation)!=null?r:!1,C=(i=(n=t.disableRipple)!=null?n:a==null?void 0:a.disableRipple)!=null?i:!1,k=qe(y==null?void 0:y.base,g),{onClear:S,onPress:V,ripples:z}=YB(),j=D.useCallback(me=>{C||I||_.current&&V(me)},[C,I,_,V]),{buttonProps:J,isPressed:$}=Um({onPress:Tn(p,j),elementType:c,isDisabled:!t.isPressable,onClick:h,allowTextSelectionOnPress:R,...b},_),{hoverProps:le,isHovered:ie}=aa({isDisabled:!t.isHoverable,...b}),{isFocusVisible:Z,isFocused:te,focusProps:H}=io({autoFocus:m}),fe=D.useMemo(()=>HI({...s,disableAnimation:I}),[Ri(s),I]),ne=D.useMemo(()=>({slots:fe,classNames:y,disableAnimation:I,isDisabled:t.isDisabled,isFooterBlurred:t.isFooterBlurred,fullWidth:t.fullWidth}),[fe,y,t.isDisabled,t.isFooterBlurred,I,t.fullWidth]),he=D.useCallback((me={})=>({ref:_,className:fe.base({class:k}),tabIndex:t.isPressable?0:-1,"data-hover":Te(ie),"data-pressed":Te($),"data-focus":Te(te),"data-focus-visible":Te(Z),"data-disabled":Te(t.isDisabled),...Oe(t.isPressable?{...J,...H,role:"button"}:{},t.isHoverable?le:{},Mi(b,{enabled:T}),Mi(me))}),[_,fe,k,T,t.isPressable,t.isHoverable,t.isDisabled,ie,$,Z,J,H,le,b]),oe=D.useCallback(()=>({ripples:z,onClear:S}),[z,S]);return{context:ne,domRef:_,Component:x,classNames:y,children:d,isHovered:ie,isPressed:$,disableAnimation:I,isPressable:t.isPressable,isHoverable:t.isHoverable,disableRipple:C,handlePress:j,isFocusVisible:Z,getCardProps:he,getRippleProps:oe}}var i7=Qt((t,e)=>{const{children:r,context:n,Component:i,isPressable:a,disableAnimation:o,disableRipple:s,getCardProps:l,getRippleProps:c}=Cne({...t,ref:e});return O.jsxs(i,{...l(),children:[O.jsx(xne,{value:n,children:r}),a&&!o&&!s&&O.jsx(ZB,{...c()})]})});i7.displayName="HeroUI.Card";var a7=i7;function Tne(t){const[e,r]=la(t,WI.variantKeys),{ref:n,as:i,children:a,avatar:o,startContent:s,endContent:l,onClose:c,classNames:d,className:h,...p}=e,m=i||"div",g=fr(n),y=qe(d==null?void 0:d.base,h),R=!!c,b=t.variant==="dot",{focusProps:_,isFocusVisible:x}=io(),T=D.useMemo(()=>typeof a=="string"&&(a==null?void 0:a.length)===1,[a]),I=D.useMemo(()=>!!o||!!s,[o,s]),C=D.useMemo(()=>!!l||R,[l,R]),k=D.useMemo(()=>WI({...r,hasStartContent:I,hasEndContent:C,isOneChar:T,isCloseable:R,isCloseButtonFocusVisible:x}),[Ri(r),x,I,C,T,R]),{pressProps:S}=is({isDisabled:!!(t!=null&&t.isDisabled),onPress:c}),V=()=>({ref:g,className:k.base({class:y}),...p}),z=()=>({role:"button",tabIndex:0,className:k.closeButton({class:d==null?void 0:d.closeButton}),"aria-label":"close chip",...Oe(S,_)}),j=$=>D.isValidElement($)?D.cloneElement($,{className:k.avatar({class:d==null?void 0:d.avatar})}):null,J=$=>D.isValidElement($)?D.cloneElement($,{className:qe("max-h-[80%]",$.props.className)}):null;return{Component:m,children:a,slots:k,classNames:d,isDot:b,isCloseable:R,startContent:j(o)||J(s),endContent:J(l),getCloseButtonProps:z,getChipProps:V}}var o7=Qt((t,e)=>{const{Component:r,children:n,slots:i,classNames:a,isDot:o,isCloseable:s,startContent:l,endContent:c,getCloseButtonProps:d,getChipProps:h}=Tne({...t,ref:e}),p=D.useMemo(()=>o&&!l?O.jsx("span",{className:i.dot({class:a==null?void 0:a.dot})}):l,[i,l,o]),m=D.useMemo(()=>s?O.jsx("span",{...d(),children:c||O.jsx(v4,{})}):c,[c,s,d]);return O.jsxs(r,{...h(),children:[p,O.jsx("span",{className:i.content({class:a==null?void 0:a.content}),children:n}),m]})});o7.displayName="HeroUI.Chip";var Dne=o7;const Rb={badInput:!1,customError:!1,patternMismatch:!1,rangeOverflow:!1,rangeUnderflow:!1,stepMismatch:!1,tooLong:!1,tooShort:!1,typeMismatch:!1,valueMissing:!1,valid:!0},s7={...Rb,customError:!0,valid:!1},Xl={isInvalid:!1,validationDetails:Rb,validationErrors:[]},l7=D.createContext({}),f0="__formValidationState"+Date.now();function S4(t){if(t[f0]){let{realtimeValidation:e,displayValidation:r,updateValidation:n,resetValidation:i,commitValidation:a}=t[f0];return{realtimeValidation:e,displayValidation:r,updateValidation:n,resetValidation:i,commitValidation:a}}return Rne(t)}function Rne(t){let{isInvalid:e,validationState:r,name:n,value:i,builtinValidation:a,validate:o,validationBehavior:s="aria"}=t;r&&(e||(e=r==="invalid"));let l=e!==void 0?{isInvalid:e,validationErrors:[],validationDetails:s7}:null,c=D.useMemo(()=>{if(!o||i==null)return null;let z=Mne(o,i);return nP(z)},[o,i]);a!=null&&a.validationDetails.valid&&(a=void 0);let d=D.useContext(l7),h=D.useMemo(()=>n?Array.isArray(n)?n.flatMap(z=>B1(d[z])):B1(d[n]):[],[d,n]),[p,m]=D.useState(d),[g,y]=D.useState(!1);d!==p&&(m(d),y(!1));let R=D.useMemo(()=>nP(g?[]:h),[g,h]),b=D.useRef(Xl),[_,x]=D.useState(Xl),T=D.useRef(Xl),I=()=>{if(!C)return;k(!1);let z=c||a||b.current;JS(z,T.current)||(T.current=z,x(z))},[C,k]=D.useState(!1);return D.useEffect(I),{realtimeValidation:l||R||c||a||Xl,displayValidation:s==="native"?l||R||_:l||R||c||a||_,updateValidation(z){s==="aria"&&!JS(_,z)?x(z):b.current=z},resetValidation(){let z=Xl;JS(z,T.current)||(T.current=z,x(z)),s==="native"&&k(!1),y(!0)},commitValidation(){s==="native"&&k(!0),y(!0)}}}function B1(t){return t?Array.isArray(t)?t:[t]:[]}function Mne(t,e){if(typeof t=="function"){let r=t(e);if(r&&typeof r!="boolean")return B1(r)}return[]}function nP(t){return t.length?{isInvalid:!0,validationErrors:t,validationDetails:s7}:null}function JS(t,e){return t===e?!0:!!t&&!!e&&t.isInvalid===e.isInvalid&&t.validationErrors.length===e.validationErrors.length&&t.validationErrors.every((r,n)=>r===e.validationErrors[n])&&Object.entries(t.validationDetails).every(([r,n])=>e.validationDetails[r]===n)}function h0(...t){let e=new Set,r=!1,n={...Rb};for(let o of t){var i,a;for(let s of o.validationErrors)e.add(s);r||(r=o.isInvalid);for(let s in n)(i=n)[a=s]||(i[a]=o.validationDetails[s])}return n.valid=!r,{isInvalid:r,validationErrors:[...e],validationDetails:n}}function u7(t,e,r){let{validationBehavior:n,focus:i}=t;qt(()=>{if(n==="native"&&(r!=null&&r.current)&&!r.current.disabled){let l=e.realtimeValidation.isInvalid?e.realtimeValidation.validationErrors.join(" ")||"Invalid value.":"";r.current.setCustomValidity(l),r.current.hasAttribute("title")||(r.current.title=""),e.realtimeValidation.isInvalid||e.updateValidation(Pne(r.current))}});let a=rn(()=>{e.resetValidation()}),o=rn(l=>{var c;e.displayValidation.isInvalid||e.commitValidation();let d=r==null||(c=r.current)===null||c===void 0?void 0:c.form;if(!l.defaultPrevented&&r&&d&&Ane(d)===r.current){var h;i?i():(h=r.current)===null||h===void 0||h.focus(),cJ("keyboard")}l.preventDefault()}),s=rn(()=>{e.commitValidation()});D.useEffect(()=>{let l=r==null?void 0:r.current;if(!l)return;let c=l.form;return l.addEventListener("invalid",o),l.addEventListener("change",s),c==null||c.addEventListener("reset",a),()=>{l.removeEventListener("invalid",o),l.removeEventListener("change",s),c==null||c.removeEventListener("reset",a)}},[r,o,s,a,n])}function Ine(t){let e=t.validity;return{badInput:e.badInput,customError:e.customError,patternMismatch:e.patternMismatch,rangeOverflow:e.rangeOverflow,rangeUnderflow:e.rangeUnderflow,stepMismatch:e.stepMismatch,tooLong:e.tooLong,tooShort:e.tooShort,typeMismatch:e.typeMismatch,valueMissing:e.valueMissing,valid:e.valid}}function Pne(t){return{isInvalid:!t.validity.valid,validationDetails:Ine(t),validationErrors:t.validationMessage?[t.validationMessage]:[]}}function Ane(t){for(let e=0;e<t.elements.length;e++){let r=t.elements[e];if(!r.validity.valid)return r}return null}function c7(t){let{id:e,label:r,"aria-labelledby":n,"aria-label":i,labelElementType:a="label"}=t;e=Ii(e);let o=Ii(),s={};r?(n=n?`${o} ${n}`:o,s={id:o,htmlFor:a==="label"?e:void 0}):!n&&!i&&console.warn("If you do not provide a visible label, you must specify an aria-label or aria-labelledby attribute for accessibility");let l=Om({id:e,"aria-label":i,"aria-labelledby":n});return{labelProps:s,fieldProps:l}}function w4(t){let{description:e,errorMessage:r,isInvalid:n,validationState:i}=t,{labelProps:a,fieldProps:o}=c7(t),s=nl([!!e,!!r,n,i]),l=nl([!!e,!!r,n,i]);return o=Oe(o,{"aria-describedby":[s,l,t["aria-describedby"]].filter(Boolean).join(" ")||void 0}),{labelProps:a,fieldProps:o,descriptionProps:{id:s},errorMessageProps:{id:l}}}var iP=Symbol("default");function Mb(t,e){let r=D.useContext(t);if(e===null)return null;if(r&&typeof r=="object"&&"slots"in r&&r.slots){let n=new Intl.ListFormat().format(Object.keys(r.slots).map(a=>`"${a}"`));if(!e&&!r.slots[iP])throw new Error(`A slot prop is required. Valid slot names are ${n}.`);let i=e||iP;if(!r.slots[i])throw new Error(`Invalid slot "${e}". Valid slot names are ${n}.`);return r.slots[i]}return r}function kne(t,e,r){let n=Mb(r,t.slot)||{},{ref:i,...a}=n,o=yY(D.useMemo(()=>AT(e,i),[e,i])),s=Oe(a,t);return"style"in a&&a.style&&"style"in t&&t.style&&(typeof a.style=="function"||typeof t.style=="function"?s.style=l=>{let c=typeof a.style=="function"?a.style(l):a.style,d={...l.defaultStyle,...c},h=typeof t.style=="function"?t.style({...l,defaultStyle:d}):t.style;return{...d,...h}}:s.style={...a.style,...t.style}),[s,o]}var Vp=D.createContext(null);D.forwardRef(function(e,r){[e,r]=kne(e,r,Vp);let{validationErrors:n,validationBehavior:i="native",children:a,className:o,...s}=e;const l=D.useMemo(()=>Ire({className:o}),[o]);return O.jsx("form",{noValidate:i!=="native",...s,ref:r,className:l,children:O.jsx(Vp.Provider,{value:{...e,validationBehavior:i},children:O.jsx(l7.Provider,{value:n??{},children:a})})})});function aP(t,e=[]){const r=D.useRef(t);return b4(()=>{r.current=t}),D.useCallback((...n)=>{var i;return(i=r.current)==null?void 0:i.call(r,...n)},e)}const oP=t=>typeof t=="object"&&t!=null&&t.nodeType===1,sP=(t,e)=>(!e||t!=="hidden")&&t!=="visible"&&t!=="clip",ig=(t,e)=>{if(t.clientHeight<t.scrollHeight||t.clientWidth<t.scrollWidth){const r=getComputedStyle(t,null);return sP(r.overflowY,e)||sP(r.overflowX,e)||(n=>{const i=(a=>{if(!a.ownerDocument||!a.ownerDocument.defaultView)return null;try{return a.ownerDocument.defaultView.frameElement}catch{return null}})(n);return!!i&&(i.clientHeight<n.scrollHeight||i.clientWidth<n.scrollWidth)})(t)}return!1},ag=(t,e,r,n,i,a,o,s)=>a<t&&o>e||a>t&&o<e?0:a<=t&&s<=r||o>=e&&s>=r?a-t-n:o>e&&s<r||a<t&&s>r?o-e+i:0,One=t=>{const e=t.parentElement;return e??(t.getRootNode().host||null)},lP=(t,e)=>{var r,n,i,a;if(typeof document>"u")return[];const{scrollMode:o,block:s,inline:l,boundary:c,skipOverflowHiddenElements:d}=e,h=typeof c=="function"?c:Z=>Z!==c;if(!oP(t))throw new TypeError("Invalid target");const p=document.scrollingElement||document.documentElement,m=[];let g=t;for(;oP(g)&&h(g);){if(g=One(g),g===p){m.push(g);break}g!=null&&g===document.body&&ig(g)&&!ig(document.documentElement)||g!=null&&ig(g,d)&&m.push(g)}const y=(n=(r=window.visualViewport)==null?void 0:r.width)!=null?n:innerWidth,R=(a=(i=window.visualViewport)==null?void 0:i.height)!=null?a:innerHeight,{scrollX:b,scrollY:_}=window,{height:x,width:T,top:I,right:C,bottom:k,left:S}=t.getBoundingClientRect(),{top:V,right:z,bottom:j,left:J}=(Z=>{const te=window.getComputedStyle(Z);return{top:parseFloat(te.scrollMarginTop)||0,right:parseFloat(te.scrollMarginRight)||0,bottom:parseFloat(te.scrollMarginBottom)||0,left:parseFloat(te.scrollMarginLeft)||0}})(t);let $=s==="start"||s==="nearest"?I-V:s==="end"?k+j:I+x/2-V+j,le=l==="center"?S+T/2-J+z:l==="end"?C+z:S-J;const ie=[];for(let Z=0;Z<m.length;Z++){const te=m[Z],{height:H,width:fe,top:ne,right:he,bottom:oe,left:me}=te.getBoundingClientRect();if(o==="if-needed"&&I>=0&&S>=0&&k<=R&&C<=y&&(te===p&&!ig(te)||I>=ne&&k<=oe&&S>=me&&C<=he))return ie;const ee=getComputedStyle(te),Y=parseInt(ee.borderLeftWidth,10),q=parseInt(ee.borderTopWidth,10),X=parseInt(ee.borderRightWidth,10),F=parseInt(ee.borderBottomWidth,10);let se=0,N=0;const ce="offsetWidth"in te?te.offsetWidth-te.clientWidth-Y-X:0,ue="offsetHeight"in te?te.offsetHeight-te.clientHeight-q-F:0,pe="offsetWidth"in te?te.offsetWidth===0?0:fe/te.offsetWidth:0,be="offsetHeight"in te?te.offsetHeight===0?0:H/te.offsetHeight:0;if(p===te)se=s==="start"?$:s==="end"?$-R:s==="nearest"?ag(_,_+R,R,q,F,_+$,_+$+x,x):$-R/2,N=l==="start"?le:l==="center"?le-y/2:l==="end"?le-y:ag(b,b+y,y,Y,X,b+le,b+le+T,T),se=Math.max(0,se+_),N=Math.max(0,N+b);else{se=s==="start"?$-ne-q:s==="end"?$-oe+F+ue:s==="nearest"?ag(ne,oe,H,q,F+ue,$,$+x,x):$-(ne+H/2)+ue/2,N=l==="start"?le-me-Y:l==="center"?le-(me+fe/2)+ce/2:l==="end"?le-he+X+ce:ag(me,he,fe,Y,X+ce,le,le+T,T);const{scrollLeft:we,scrollTop:Ce}=te;se=be===0?0:Math.max(0,Math.min(Ce+se/be,te.scrollHeight-H/be+ue)),N=pe===0?0:Math.max(0,Math.min(we+N/pe,te.scrollWidth-fe/pe+ce)),$+=Ce-se,le+=we-N}ie.push({el:te,top:se,left:N})}return ie},$ne=t=>t===!1?{block:"end",inline:"nearest"}:(e=>e===Object(e)&&Object.keys(e).length!==0)(t)?t:{block:"start",inline:"nearest"};function Lne(t,e){if(!t.isConnected||!(n=>{let i=n;for(;i&&i.parentNode;){if(i.parentNode===document)return!0;i=i.parentNode instanceof ShadowRoot?i.parentNode.host:i.parentNode}return!1})(t))return;if((n=>typeof n=="object"&&typeof n.behavior=="function")(e))return e.behavior(lP(t,e));const r=typeof e=="boolean"||e==null?void 0:e.behavior;for(const{el:n,top:i,left:a}of lP(t,$ne(e)))n.scroll({top:i,left:a,behavior:r})}function Ib(t){let[e,r]=Pi(t.isOpen,t.defaultOpen||!1,t.onOpenChange);const n=D.useCallback(()=>{r(!0)},[r]),i=D.useCallback(()=>{r(!1)},[r]),a=D.useCallback(()=>{r(!e)},[r,e]);return{isOpen:e,setOpen:r,open:n,close:i,toggle:a}}function Bne(t={}){const{rerender:e=!1,delay:r=0}=t,n=D.useRef(!1),[i,a]=D.useState(!1);return D.useEffect(()=>{n.current=!0;let o=null;return e&&(r>0?o=setTimeout(()=>{a(!0)},r):a(!0)),()=>{n.current=!1,e&&a(!1),o&&clearTimeout(o)}},[e]),[D.useCallback(()=>n.current,[]),i]}function Nne(t){let{value:e=0,minValue:r=0,maxValue:n=100,valueLabel:i,isIndeterminate:a,formatOptions:o={style:"percent"}}=t,s=ho(t,{labelable:!0}),{labelProps:l,fieldProps:c}=c7({...t,labelElementType:"span"});e=Yy(e,r,n);let d=(e-r)/(n-r),h=BY(o);if(!a&&!i){let p=o.style==="percent"?d:e;i=h.format(p)}return{progressBarProps:Oe(s,{...c,"aria-valuenow":a?void 0:e,"aria-valuemin":r,"aria-valuemax":n,"aria-valuetext":a?void 0:i,role:"progressbar"}),labelProps:l}}function Une(t){var e,r;const n=ln(),[i,a]=la(t,FI.variantKeys),{ref:o,as:s,id:l,className:c,classNames:d,label:h,valueLabel:p,value:m=0,minValue:g=0,maxValue:y=100,showValueLabel:R=!1,formatOptions:b={style:"percent"},..._}=i,x=s||"div",T=fr(o),I=qe(d==null?void 0:d.base,c),[,C]=Bne({rerender:!0,delay:100}),k=t.isIndeterminate,S=(r=(e=t.disableAnimation)!=null?e:n==null?void 0:n.disableAnimation)!=null?r:!1,{progressBarProps:V,labelProps:z}=Nne({id:l,label:h,value:m,minValue:g,maxValue:y,valueLabel:p,formatOptions:b,isIndeterminate:k,"aria-labelledby":t["aria-labelledby"],"aria-label":t["aria-label"]}),j=D.useMemo(()=>FI({...a,disableAnimation:S}),[Ri(a),S]),J=S?!0:C,$=D.useMemo(()=>k||!J?void 0:wZ((m-g)/(y-g)*100),[J,k,m,g,y]),le=D.useCallback((Z={})=>({ref:T,"data-indeterminate":Te(k),"data-disabled":Te(t.isDisabled),className:j.base({class:I}),...Oe(V,_,Z)}),[T,j,k,t.isDisabled,I,V,_]),ie=D.useCallback((Z={})=>({className:j.label({class:d==null?void 0:d.label}),...Oe(z,Z)}),[j,d,z]);return{Component:x,domRef:T,slots:j,classNames:d,label:h,percentage:$,showValueLabel:R,getProgressBarProps:le,getLabelProps:ie}}var d7=Qt((t,e)=>{const{Component:r,slots:n,classNames:i,label:a,percentage:o,showValueLabel:s,getProgressBarProps:l,getLabelProps:c}=Une({...t,ref:e}),d=l(),h=a||s;return O.jsxs(r,{...d,children:[h?O.jsxs("div",{className:n.labelWrapper({class:i==null?void 0:i.labelWrapper}),children:[a&&O.jsx("span",{...c(),children:a}),s&&O.jsx("span",{className:n.value({class:i==null?void 0:i.value}),children:d["aria-valuetext"]})]}):null,O.jsx("div",{className:n.track({class:i==null?void 0:i.track}),children:O.jsx("div",{className:n.indicator({class:i==null?void 0:i.indicator}),style:{transform:`translateX(-${100-(o||0)}%)`}})})]})});d7.displayName="HeroUI.Progress";var Fne=d7;function jne(t,e){let{inputElementType:r="input",isDisabled:n=!1,isRequired:i=!1,isReadOnly:a=!1,type:o="text",validationBehavior:s="aria"}=t,[l,c]=Pi(t.value,t.defaultValue||"",t.onChange),{focusableProps:d}=BT(t,e),h=S4({...t,value:l}),{isInvalid:p,validationErrors:m,validationDetails:g}=h.displayValidation,{labelProps:y,fieldProps:R,descriptionProps:b,errorMessageProps:_}=w4({...t,isInvalid:p,errorMessage:t.errorMessage||m}),x=ho(t,{labelable:!0});const T={type:o,pattern:t.pattern};return X6(e,l,c),u7(t,h,e),D.useEffect(()=>{if(e.current instanceof _i(e.current).HTMLTextAreaElement){let I=e.current;Object.defineProperty(I,"defaultValue",{get:()=>I.value,set:()=>{},configurable:!0})}},[e]),{labelProps:y,inputProps:Oe(x,r==="input"?T:void 0,{disabled:n,readOnly:a,required:i&&s==="native","aria-required":i&&s==="aria"||void 0,"aria-invalid":p||void 0,"aria-errormessage":t["aria-errormessage"],"aria-activedescendant":t["aria-activedescendant"],"aria-autocomplete":t["aria-autocomplete"],"aria-haspopup":t["aria-haspopup"],"aria-controls":t["aria-controls"],value:l,onChange:I=>c(I.target.value),autoComplete:t.autoComplete,autoCapitalize:t.autoCapitalize,maxLength:t.maxLength,minLength:t.minLength,name:t.name,placeholder:t.placeholder,inputMode:t.inputMode,autoCorrect:t.autoCorrect,spellCheck:t.spellCheck,[parseInt(We.version,10)>=17?"enterKeyHint":"enterkeyhint"]:t.enterKeyHint,onCopy:t.onCopy,onCut:t.onCut,onPaste:t.onPaste,onCompositionEnd:t.onCompositionEnd,onCompositionStart:t.onCompositionStart,onCompositionUpdate:t.onCompositionUpdate,onSelect:t.onSelect,onBeforeInput:t.onBeforeInput,onInput:t.onInput,...d,...R}),descriptionProps:b,errorMessageProps:_,isInvalid:p,validationErrors:m,validationDetails:g}}function f7(t){var e,r,n,i,a,o,s;const l=ln(),{validationBehavior:c}=Mb(Vp)||{},[d,h]=la(t,jI.variantKeys),{ref:p,as:m,type:g,label:y,baseRef:R,wrapperRef:b,description:_,className:x,classNames:T,autoFocus:I,startContent:C,endContent:k,onClear:S,onChange:V,validationState:z,validationBehavior:j=(e=c??(l==null?void 0:l.validationBehavior))!=null?e:"native",innerWrapperRef:J,onValueChange:$=()=>{},...le}=d,ie=D.useCallback(at=>{$(at??"")},[$]),[Z,te]=D.useState(!1),H=m||"div",fe=(n=(r=t.disableAnimation)!=null?r:l==null?void 0:l.disableAnimation)!=null?n:!1,ne=fr(p),he=fr(R),oe=fr(b),me=fr(J),[ee,Y]=Pi(d.value,(i=d.defaultValue)!=null?i:"",ie),q=g==="file",X=((s=(o=(a=ne==null?void 0:ne.current)==null?void 0:a.files)==null?void 0:o.length)!=null?s:0)>0,F=["date","time","month","week","range"].includes(g),se=!qE(ee)||F||X,N=se||Z,ce=g==="hidden",ue=t.isMultiline,pe=qe(T==null?void 0:T.base,x,se?"is-filled":""),be=D.useCallback(()=>{var at;q?ne.current.value="":Y(""),S==null||S(),(at=ne.current)==null||at.focus()},[Y,S,q]);b4(()=>{ne.current&&Y(ne.current.value)},[ne.current]);const{labelProps:we,inputProps:Ce,isInvalid:$e,validationErrors:Ne,validationDetails:Ie,descriptionProps:Ge,errorMessageProps:nt}=jne({...t,validationBehavior:j,autoCapitalize:t.autoCapitalize,value:ee,"aria-label":_Z(t["aria-label"],t.label,t.placeholder),inputElementType:ue?"textarea":"input",onChange:Y},ne);q&&(delete Ce.value,delete Ce.onChange);const{isFocusVisible:ze,isFocused:Pe,focusProps:vt}=io({autoFocus:I,isTextInput:!0}),{isHovered:Tt,hoverProps:ir}=aa({isDisabled:!!(t!=null&&t.isDisabled)}),{isHovered:B,hoverProps:M}=aa({isDisabled:!!(t!=null&&t.isDisabled)}),{focusProps:P,isFocusVisible:G}=io(),{focusWithinProps:re}=wl({onFocusWithinChange:te}),{pressProps:Q}=is({isDisabled:!!(t!=null&&t.isDisabled)||!!(t!=null&&t.isReadOnly),onPress:be}),ae=z==="invalid"||$e,ve=h4({labelPlacement:t.labelPlacement,label:y}),xe=typeof d.errorMessage=="function"?d.errorMessage({isInvalid:ae,validationErrors:Ne,validationDetails:Ie}):d.errorMessage||(Ne==null?void 0:Ne.join(" ")),Me=!!S||t.isClearable,Ee=!!y||!!_||!!xe,ke=!!d.placeholder,pt=!!y,gt=!!_||!!xe,hr=ve==="outside"||ve==="outside-left",Dn=ve==="inside",yn=ne.current?(!ne.current.value||ne.current.value===""||!ee||ee==="")&&ke:!1,Lf=ve==="outside-left",ni=!!C,Bf=hr?ve==="outside-left"||ke||ve==="outside"&&ni:!1,it=ve==="outside"&&!ke&&!ni,Xe=D.useMemo(()=>jI({...h,isInvalid:ae,labelPlacement:ve,isClearable:Me,disableAnimation:fe}),[Ri(h),ae,ve,Me,ni,fe]),Br=D.useCallback((at={})=>({ref:he,className:Xe.base({class:pe}),"data-slot":"base","data-filled":Te(se||ke||ni||yn||q),"data-filled-within":Te(N||ke||ni||yn||q),"data-focus-within":Te(Z),"data-focus-visible":Te(ze),"data-readonly":Te(t.isReadOnly),"data-focus":Te(Pe),"data-hover":Te(Tt||B),"data-required":Te(t.isRequired),"data-invalid":Te(ae),"data-disabled":Te(t.isDisabled),"data-has-elements":Te(Ee),"data-has-helper":Te(gt),"data-has-label":Te(pt),"data-has-value":Te(!yn),"data-hidden":Te(ce),...re,...at}),[Xe,pe,se,Pe,Tt,B,ae,gt,pt,Ee,yn,ni,Z,ze,N,ke,re,ce,t.isReadOnly,t.isRequired,t.isDisabled]),ca=D.useCallback((at={})=>({"data-slot":"label",className:Xe.label({class:T==null?void 0:T.label}),...Oe(we,M,at)}),[Xe,B,we,T==null?void 0:T.label]),ki=D.useCallback(at=>{at.key==="Escape"&&ee&&(Me||S)&&!t.isReadOnly&&(Y(""),S==null||S())},[ee,Y,S,Me,t.isReadOnly]),jn=D.useCallback((at={})=>({"data-slot":"input","data-filled":Te(se),"data-filled-within":Te(N),"data-has-start-content":Te(ni),"data-has-end-content":Te(!!k),"data-type":g,className:Xe.input({class:qe(T==null?void 0:T.input,se?"is-filled":"",ue?"pe-0":"",g==="password"?"[&::-ms-reveal]:hidden":"")}),...Oe(vt,Ce,Mi(le,{enabled:!0,labelable:!0,omitEventNames:new Set(Object.keys(Ce))}),at),"aria-readonly":Te(t.isReadOnly),onChange:Tn(Ce.onChange,V),onKeyDown:Tn(Ce.onKeyDown,at.onKeyDown,ki),ref:ne}),[Xe,ee,vt,Ce,le,se,N,ni,k,T==null?void 0:T.input,t.isReadOnly,t.isRequired,V,ki]),ii=D.useCallback((at={})=>({ref:oe,"data-slot":"input-wrapper","data-hover":Te(Tt||B),"data-focus-visible":Te(ze),"data-focus":Te(Pe),className:Xe.inputWrapper({class:qe(T==null?void 0:T.inputWrapper,se?"is-filled":"")}),...Oe(at,ir),onClick:us=>{ne.current&&us.currentTarget===us.target&&ne.current.focus()},style:{cursor:"text",...at.style}}),[Xe,Tt,B,ze,Pe,ee,T==null?void 0:T.inputWrapper]),un=D.useCallback((at={})=>({...at,ref:me,"data-slot":"inner-wrapper",onClick:us=>{ne.current&&us.currentTarget===us.target&&ne.current.focus()},className:Xe.innerWrapper({class:qe(T==null?void 0:T.innerWrapper,at==null?void 0:at.className)})}),[Xe,T==null?void 0:T.innerWrapper]),Ve=D.useCallback((at={})=>({...at,"data-slot":"main-wrapper",className:Xe.mainWrapper({class:qe(T==null?void 0:T.mainWrapper,at==null?void 0:at.className)})}),[Xe,T==null?void 0:T.mainWrapper]),ai=D.useCallback((at={})=>({...at,"data-slot":"helper-wrapper",className:Xe.helperWrapper({class:qe(T==null?void 0:T.helperWrapper,at==null?void 0:at.className)})}),[Xe,T==null?void 0:T.helperWrapper]),tc=D.useCallback((at={})=>({...at,...Ge,"data-slot":"description",className:Xe.description({class:qe(T==null?void 0:T.description,at==null?void 0:at.className)})}),[Xe,T==null?void 0:T.description]),Tl=D.useCallback((at={})=>({...at,...nt,"data-slot":"error-message",className:Xe.errorMessage({class:qe(T==null?void 0:T.errorMessage,at==null?void 0:at.className)})}),[Xe,nt,T==null?void 0:T.errorMessage]),lv=D.useCallback((at={})=>({...at,type:"button",tabIndex:-1,disabled:t.isDisabled,"aria-label":"clear input","data-slot":"clear-button","data-focus-visible":Te(G),className:Xe.clearButton({class:qe(T==null?void 0:T.clearButton,at==null?void 0:at.className)}),...Oe(Q,P)}),[Xe,G,Q,P,T==null?void 0:T.clearButton]);return{Component:H,classNames:T,domRef:ne,label:y,description:_,startContent:C,endContent:k,labelPlacement:ve,isClearable:Me,hasHelper:gt,hasStartContent:ni,isLabelOutside:Bf,isOutsideLeft:Lf,isLabelOutsideAsPlaceholder:it,shouldLabelBeOutside:hr,shouldLabelBeInside:Dn,hasPlaceholder:ke,isInvalid:ae,errorMessage:xe,getBaseProps:Br,getLabelProps:ca,getInputProps:jn,getMainWrapperProps:Ve,getInputWrapperProps:ii,getInnerWrapperProps:un,getHelperWrapperProps:ai,getDescriptionProps:tc,getErrorMessageProps:Tl,getClearButtonProps:lv}}var h7=Qt((t,e)=>{const{Component:r,label:n,description:i,isClearable:a,startContent:o,endContent:s,labelPlacement:l,hasHelper:c,isOutsideLeft:d,shouldLabelBeOutside:h,errorMessage:p,isInvalid:m,getBaseProps:g,getLabelProps:y,getInputProps:R,getInnerWrapperProps:b,getInputWrapperProps:_,getMainWrapperProps:x,getHelperWrapperProps:T,getDescriptionProps:I,getErrorMessageProps:C,getClearButtonProps:k}=f7({...t,ref:e}),S=n?O.jsx("label",{...y(),children:n}):null,V=D.useMemo(()=>a?O.jsx("button",{...k(),children:s||O.jsx(v4,{})}):s,[a,k]),z=D.useMemo(()=>{const $=m&&p;return!c||!($||i)?null:O.jsx("div",{...T(),children:$?O.jsx("div",{...C(),children:p}):O.jsx("div",{...I(),children:i})})},[c,m,p,i,T,C,I]),j=D.useMemo(()=>O.jsxs("div",{...b(),children:[o,O.jsx("input",{...R()}),V]}),[o,V,R,b]),J=D.useMemo(()=>h?O.jsxs("div",{...x(),children:[O.jsxs("div",{..._(),children:[d?null:S,j]}),z]}):O.jsxs(O.Fragment,{children:[O.jsxs("div",{..._(),children:[S,j]}),z]}),[l,z,h,S,j,p,i,x,_,C,I]);return O.jsxs(r,{...g(),children:[d?S:null,J]})});h7.displayName="HeroUI.Input";var gu=h7;function N1(){return N1=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},N1.apply(null,arguments)}function p7(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var Vne=D.useLayoutEffect,zne=function(e){var r=We.useRef(e);return Vne(function(){r.current=e}),r},uP=function(e,r){if(typeof e=="function"){e(r);return}e.current=r},Kne=function(e,r){var n=We.useRef();return We.useCallback(function(i){e.current=i,n.current&&uP(n.current,null),n.current=r,r&&uP(r,i)},[r])},cP={"min-height":"0","max-height":"none",height:"0",visibility:"hidden",overflow:"hidden",position:"absolute","z-index":"-1000",top:"0",right:"0",display:"block"},Hne=function(e){Object.keys(cP).forEach(function(r){e.style.setProperty(r,cP[r],"important")})},dP=Hne,Mn=null,fP=function(e,r){var n=e.scrollHeight;return r.sizingStyle.boxSizing==="border-box"?n+r.borderSize:n-r.paddingSize};function Wne(t,e,r,n){r===void 0&&(r=1),n===void 0&&(n=1/0),Mn||(Mn=document.createElement("textarea"),Mn.setAttribute("tabindex","-1"),Mn.setAttribute("aria-hidden","true"),dP(Mn)),Mn.parentNode===null&&document.body.appendChild(Mn);var i=t.paddingSize,a=t.borderSize,o=t.sizingStyle,s=o.boxSizing;Object.keys(o).forEach(function(p){var m=p;Mn.style[m]=o[m]}),dP(Mn),Mn.value=e;var l=fP(Mn,t);Mn.value=e,l=fP(Mn,t),Mn.value="x";var c=Mn.scrollHeight-i,d=c*r;s==="border-box"&&(d=d+i+a),l=Math.max(d,l);var h=c*n;return s==="border-box"&&(h=h+i+a),l=Math.min(h,l),[l,c]}var hP=function(){},Gne=function(e,r){return e.reduce(function(n,i){return n[i]=r[i],n},{})},qne=["borderBottomWidth","borderLeftWidth","borderRightWidth","borderTopWidth","boxSizing","fontFamily","fontSize","fontStyle","fontWeight","letterSpacing","lineHeight","paddingBottom","paddingLeft","paddingRight","paddingTop","tabSize","textIndent","textRendering","textTransform","width","wordBreak","wordSpacing","scrollbarGutter"],Zne=!!document.documentElement.currentStyle,Yne=function(e){var r=window.getComputedStyle(e);if(r===null)return null;var n=Gne(qne,r),i=n.boxSizing;if(i==="")return null;Zne&&i==="border-box"&&(n.width=parseFloat(n.width)+parseFloat(n.borderRightWidth)+parseFloat(n.borderLeftWidth)+parseFloat(n.paddingRight)+parseFloat(n.paddingLeft)+"px");var a=parseFloat(n.paddingBottom)+parseFloat(n.paddingTop),o=parseFloat(n.borderBottomWidth)+parseFloat(n.borderTopWidth);return{sizingStyle:n,paddingSize:a,borderSize:o}},Jne=Yne;function E4(t,e,r){var n=zne(r);D.useLayoutEffect(function(){var i=function(o){return n.current(o)};if(t)return t.addEventListener(e,i),function(){return t.removeEventListener(e,i)}},[])}var Xne=function(e,r){E4(document.body,"reset",function(n){e.current.form===n.target&&r(n)})},Qne=function(e){E4(window,"resize",e)},eie=function(e){E4(document.fonts,"loadingdone",e)},tie=["cacheMeasurements","maxRows","minRows","onChange","onHeightChange"],rie=function(e,r){var n=e.cacheMeasurements,i=e.maxRows,a=e.minRows,o=e.onChange,s=o===void 0?hP:o,l=e.onHeightChange,c=l===void 0?hP:l,d=p7(e,tie),h=d.value!==void 0,p=D.useRef(null),m=Kne(p,r),g=D.useRef(0),y=D.useRef(),R=function(){var x=p.current,T=n&&y.current?y.current:Jne(x);if(T){y.current=T;var I=Wne(T,x.value||x.placeholder||"x",a,i),C=I[0],k=I[1];g.current!==C&&(g.current=C,x.style.setProperty("height",C+"px","important"),c(C,{rowHeight:k}))}},b=function(x){h||R(),s(x)};return D.useLayoutEffect(R),Xne(p,function(){if(!h){var _=p.current.value;requestAnimationFrame(function(){var x=p.current;x&&_!==x.value&&R()})}}),Qne(R),eie(R),D.createElement("textarea",N1({},d,{onChange:b,ref:m}))},nie=D.forwardRef(rie),m7=Qt(({style:t,minRows:e=3,maxRows:r=8,cacheMeasurements:n=!1,disableAutosize:i=!1,onHeightChange:a,...o},s)=>{const{Component:l,label:c,description:d,startContent:h,endContent:p,hasHelper:m,shouldLabelBeOutside:g,shouldLabelBeInside:y,isInvalid:R,errorMessage:b,getBaseProps:_,getLabelProps:x,getInputProps:T,getInnerWrapperProps:I,getInputWrapperProps:C,getHelperWrapperProps:k,getDescriptionProps:S,getErrorMessageProps:V,isClearable:z,getClearButtonProps:j}=f7({...o,ref:s,isMultiline:!0}),[J,$]=D.useState(e>1),[le,ie]=D.useState(!1),Z=c?O.jsx("label",{...x(),children:c}):null,te=T(),H=(ee,Y)=>{if(e===1&&$(ee>=Y.rowHeight*2),r>e){const q=ee>=r*Y.rowHeight;ie(q)}a==null||a(ee,Y)},fe=i?O.jsx("textarea",{...te,style:Oe(te.style,t??{})}):O.jsx(nie,{...te,cacheMeasurements:n,"data-hide-scroll":Te(!le),maxRows:r,minRows:e,style:Oe(te.style,t??{}),onHeightChange:H}),ne=D.useMemo(()=>z?O.jsx("button",{...j(),children:O.jsx(v4,{})}):null,[z,j]),he=D.useMemo(()=>h||p?O.jsxs("div",{...I(),children:[h,fe,p]}):O.jsx("div",{...I(),children:fe}),[h,te,p,I]),oe=R&&b,me=oe||d;return O.jsxs(l,{..._(),children:[g?Z:null,O.jsxs("div",{...C(),"data-has-multiple-rows":Te(J),children:[y?Z:null,he,ne]}),m&&me?O.jsx("div",{...k(),children:oe?O.jsx("div",{...V(),children:b}):O.jsx("div",{...S(),children:d})}):null]})});m7.displayName="HeroUI.Textarea";var iie=m7;function aie(t,e){const{groupRef:r,triggerRef:n,popoverRef:i,showArrow:a,offset:o=7,crossOffset:s=0,scrollRef:l,shouldFlip:c,boundaryElement:d,isDismissable:h=!0,shouldCloseOnBlur:p=!0,shouldCloseOnScroll:m=!0,placement:g="top",containerPadding:y,shouldCloseOnInteractOutside:R,isNonModal:b,isKeyboardDismissDisabled:_,updatePositionDeps:x=[],...T}=t,I=b??!0,C=T.trigger==="SubmenuTrigger",{overlayProps:k,underlayProps:S}=wL({isOpen:e.isOpen,onClose:e.close,shouldCloseOnBlur:p,isDismissable:h||C,isKeyboardDismissDisabled:_,shouldCloseOnInteractOutside:R||($=>y4($,n,e))},i),{overlayProps:V,arrowProps:z,placement:j,updatePosition:J}=GY({...T,shouldFlip:c,crossOffset:s,targetRef:n,overlayRef:i,isOpen:e.isOpen,scrollRef:l,boundaryElement:d,containerPadding:y,placement:vne(g),offset:a?o+3:o,onClose:I&&!C&&m?e.close:()=>{}});return b4(()=>{x.length&&J()},x),D.useEffect(()=>{var $,le;if(e.isOpen&&i.current)return I?bne(($=r==null?void 0:r.current)!=null?$:i.current):yne([(le=r==null?void 0:r.current)!=null?le:i.current])},[I,e.isOpen,i,r]),{popoverProps:Oe(k,V),arrowProps:z,underlayProps:S,placement:j}}var oie="top";function v7(t){var e,r,n;const i=ln(),[a,o]=la(t,UI.variantKeys),{as:s,ref:l,children:c,state:d,triggerRef:h,scrollRef:p,defaultOpen:m,onOpenChange:g,isOpen:y,isNonModal:R=!0,shouldFlip:b=!0,containerPadding:_=12,shouldBlockScroll:x=!1,isDismissable:T=!0,shouldCloseOnBlur:I,portalContainer:C,updatePositionDeps:k,dialogProps:S,placement:V=oie,triggerType:z="dialog",showArrow:j=!1,offset:J=7,crossOffset:$=0,boundaryElement:le,isKeyboardDismissDisabled:ie,shouldCloseOnInteractOutside:Z,shouldCloseOnScroll:te,motionProps:H,className:fe,classNames:ne,onClose:he,...oe}=a,me=s||"div",ee=fr(l),Y=D.useRef(null),q=D.useRef(!1),X=h||Y,F=(r=(e=t.disableAnimation)!=null?e:i==null?void 0:i.disableAnimation)!=null?r:!1,se=Ib({isOpen:y,defaultOpen:m,onOpenChange:B=>{g==null||g(B),B||he==null||he()}}),N=d||se,{popoverProps:ce,underlayProps:ue,placement:pe}=aie({triggerRef:X,isNonModal:R,popoverRef:ee,placement:V,offset:J,scrollRef:p,isDismissable:T,shouldCloseOnBlur:I,boundaryElement:le,crossOffset:$,shouldFlip:b,containerPadding:_,updatePositionDeps:k,isKeyboardDismissDisabled:ie,shouldCloseOnScroll:te,shouldCloseOnInteractOutside:Z},N),be=D.useMemo(()=>pe?gne(pe,V)?pe:V:null,[pe,V]),{triggerProps:we}=EL({type:z},N,X),{isFocusVisible:Ce,isFocused:$e,focusProps:Ne}=io(),Ie=D.useMemo(()=>UI({...o}),[Ri(o)]),Ge=qe(ne==null?void 0:ne.base,fe);xL({isDisabled:!(x&&N.isOpen)});const nt=(B={})=>({ref:ee,...Oe(ce,oe,B),style:Oe(ce.style,oe.style,B.style)}),ze=(B={})=>({"data-slot":"base","data-open":Te(N.isOpen),"data-focus":Te($e),"data-arrow":Te(j),"data-focus-visible":Te(Ce),"data-placement":pe?rP(pe,V):void 0,...Oe(Ne,S,B),className:Ie.base({class:qe(Ge)}),style:{outline:"none"}}),Pe=D.useCallback((B={})=>({"data-slot":"content","data-open":Te(N.isOpen),"data-arrow":Te(j),"data-placement":pe?rP(pe,V):void 0,className:Ie.content({class:qe(ne==null?void 0:ne.content,B.className)})}),[Ie,N.isOpen,j,be,V,ne,pe]),vt=D.useCallback(B=>{var M;let P;return B.pointerType==="touch"&&((t==null?void 0:t.backdrop)==="blur"||(t==null?void 0:t.backdrop)==="opaque")?P=setTimeout(()=>{q.current=!0},100):q.current=!0,(M=we.onPress)==null||M.call(we,B),()=>{clearTimeout(P)}},[we==null?void 0:we.onPress]),Tt=D.useCallback((B={},M=null)=>{const{isDisabled:P,...G}=B;return{"data-slot":"trigger",...Oe({"aria-haspopup":"dialog"},we,G),onPress:vt,isDisabled:P,className:Ie.trigger({class:qe(ne==null?void 0:ne.trigger,B.className),isTriggerDisabled:P}),ref:AT(M,X)}},[N,we,vt,X]),ir=D.useCallback((B={})=>({"data-slot":"backdrop",className:Ie.backdrop({class:ne==null?void 0:ne.backdrop}),onClick:M=>{if(!q.current){M.preventDefault();return}N.close(),q.current=!1},...ue,...B}),[Ie,N.isOpen,ne,ue]);return D.useEffect(()=>{if(N.isOpen&&(ee!=null&&ee.current))return o2([ee==null?void 0:ee.current])},[N.isOpen,ee]),{state:N,Component:me,children:c,classNames:ne,showArrow:j,triggerRef:X,placement:be,isNonModal:R,popoverRef:ee,portalContainer:C,isOpen:N.isOpen,onClose:N.close,disableAnimation:F,shouldBlockScroll:x,backdrop:(n=t.backdrop)!=null?n:"transparent",motionProps:H,getBackdropProps:ir,getPopoverProps:nt,getTriggerProps:Tt,getDialogProps:ze,getContentProps:Pe}}function x4(t,e){let{role:r="dialog"}=t,n=nl();n=t["aria-label"]?void 0:n;let i=D.useRef(!1);return D.useEffect(()=>{if(e.current&&!e.current.contains(document.activeElement)){Mu(e.current);let a=setTimeout(()=>{document.activeElement===e.current&&(i.current=!0,e.current&&(e.current.blur(),Mu(e.current)),i.current=!1)},500);return()=>{clearTimeout(a)}}},[e]),l2(),{dialogProps:{...ho(t,{labelable:!0}),role:r,tabIndex:-1,"aria-labelledby":t["aria-labelledby"]||n,onBlur:a=>{i.current&&a.stopPropagation()}},titleProps:{id:n}}}var g7=()=>El(()=>import("./index-BeaB_b6p.js"),[]).then(t=>t.default),y7=Qt(({children:t,motionProps:e,placement:r,disableAnimation:n,style:i={},transformOrigin:a={},...o},s)=>{let l=i;return a.originX!==void 0||a.originY!==void 0?l={...l,transformOrigin:a}:r&&(l={...l,...GB(r==="center"?"top":r)}),n?O.jsx("div",{...o,ref:s,children:t}):O.jsx(Ca,{features:g7,children:O.jsx(Ai.div,{ref:s,animate:"enter",exit:"exit",initial:"initial",style:l,variants:jp.scaleSpringOpacity,...Oe(o,e),children:t})})});y7.displayName="HeroUI.FreeSoloPopoverWrapper";var b7=Qt(({children:t,transformOrigin:e,disableDialogFocus:r=!1,...n},i)=>{const{Component:a,state:o,placement:s,backdrop:l,portalContainer:c,disableAnimation:d,motionProps:h,isNonModal:p,getPopoverProps:m,getBackdropProps:g,getDialogProps:y,getContentProps:R}=v7({...n,ref:i}),b=D.useRef(null),{dialogProps:_,titleProps:x}=x4({},b),T=y({...!r&&{ref:b},..._}),I=D.useMemo(()=>l==="transparent"?null:d?O.jsx("div",{...g()}):O.jsx(Ca,{features:g7,children:O.jsx(Ai.div,{animate:"enter",exit:"exit",initial:"exit",variants:jp.fade,...g()})}),[l,d,g]);return O.jsxs(FT,{portalContainer:c,children:[!p&&I,O.jsx(a,{...m(),children:O.jsxs(y7,{disableAnimation:d,motionProps:h,placement:s,tabIndex:-1,transformOrigin:e,...T,children:[!p&&O.jsx(zd,{onDismiss:o.close}),O.jsx("div",{...R(),children:typeof t=="function"?t(x):t}),O.jsx(zd,{onDismiss:o.close})]})})]})});b7.displayName="HeroUI.FreeSoloPopover";var sie=b7,[lie,_7]=Sl({name:"PopoverContext",errorMessage:"usePopoverContext: `context` is undefined. Seems you forgot to wrap all popover components within `<Popover />`"}),pP=()=>El(()=>import("./index-BeaB_b6p.js"),[]).then(t=>t.default),S7=t=>{const{as:e,children:r,className:n,...i}=t,{Component:a,placement:o,backdrop:s,motionProps:l,disableAnimation:c,getPopoverProps:d,getDialogProps:h,getBackdropProps:p,getContentProps:m,isNonModal:g,onClose:y}=_7(),R=D.useRef(null),{dialogProps:b,titleProps:_}=x4({},R),x=h({ref:R,...b,...i}),T=e||a||"div",I=O.jsxs(O.Fragment,{children:[!g&&O.jsx(zd,{onDismiss:y}),O.jsx(T,{...x,children:O.jsx("div",{...m({className:n}),children:typeof r=="function"?r(_):r})}),O.jsx(zd,{onDismiss:y})]}),C=D.useMemo(()=>s==="transparent"?null:c?O.jsx("div",{...p()}):O.jsx(Ca,{features:pP,children:O.jsx(Ai.div,{animate:"enter",exit:"exit",initial:"exit",variants:jp.fade,...p()})}),[s,c,p]),k=o?GB(o==="center"?"top":o):void 0,S=O.jsx(O.Fragment,{children:c?I:O.jsx(Ca,{features:pP,children:O.jsx(Ai.div,{animate:"enter",exit:"exit",initial:"initial",style:k,variants:jp.scaleSpringOpacity,...l,children:I})})});return O.jsxs("div",{...d(),children:[C,S]})};S7.displayName="HeroUI.PopoverContent";var uie=S7,w7=t=>{var e;const{triggerRef:r,getTriggerProps:n}=_7(),{children:i,...a}=t,o=D.useMemo(()=>typeof i=="string"?O.jsx("p",{children:i}):D.Children.only(i),[i]),s=(e=o.props.ref)!=null?e:o.ref,{onPress:l,isDisabled:c,...d}=D.useMemo(()=>n(Oe(a,o.props),s),[n,o.props,a,s]),[,h]=TZ(i,An),{buttonProps:p}=Um({onPress:l,isDisabled:c},r),m=D.useMemo(()=>(h==null?void 0:h[0])!==void 0,[h]);return m||delete d.preventFocusOnPress,D.cloneElement(o,Oe(d,m?{onPress:l,isDisabled:c}:p))};w7.displayName="HeroUI.PopoverTrigger";var cie=w7,E7=Qt((t,e)=>{const{children:r,...n}=t,i=v7({...n,ref:e}),[a,o]=D.Children.toArray(r),s=O.jsx(FT,{portalContainer:i.portalContainer,children:o});return O.jsxs(lie,{value:i,children:[a,i.disableAnimation&&i.isOpen?s:O.jsx(Gu,{children:i.isOpen?s:null})]})});E7.displayName="HeroUI.Popover";var die=E7,[fie,x7]=Sl({name:"DropdownContext",errorMessage:"useDropdownContext: `context` is undefined. Seems you forgot to wrap all popover components within `<Dropdown />`"});function hie(t){const{isSelected:e,disableAnimation:r,...n}=t;return O.jsx("svg",{"aria-hidden":"true","data-selected":e,role:"presentation",viewBox:"0 0 17 18",...n,children:O.jsx("polyline",{fill:"none",points:"1 9 7 14 15 4",stroke:"currentColor",strokeDasharray:22,strokeDashoffset:e?44:66,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,style:r?{}:{transition:"stroke-dashoffset 200ms ease"}})})}var C7={};C7={longPressMessage:"     Alt +    "};var T7={};T7={longPressMessage:"    Alt+  ,    "};var D7={};D7={longPressMessage:"Dlouhm stiskem nebo stisknutm klves Alt + ipka dol otevete nabdku"};var R7={};R7={longPressMessage:"Langt tryk eller tryk p Alt + pil ned for at bne menuen"};var M7={};M7={longPressMessage:"Drcken Sie lange oder drcken Sie Alt + Nach-unten, um das Men zu ffnen"};var I7={};I7={longPressMessage:"    Alt +       "};var P7={};P7={longPressMessage:"Long press or press Alt + ArrowDown to open menu"};var A7={};A7={longPressMessage:"Mantenga pulsado o pulse Alt + flecha abajo para abrir el men"};var k7={};k7={longPressMessage:"Men avamiseks vajutage pikalt vi vajutage klahve Alt + allanool"};var O7={};O7={longPressMessage:"Avaa valikko painamalla pohjassa tai nppinyhdistelmll Alt + Alanuoli"};var $7={};$7={longPressMessage:"Appuyez de manire prolonge ou appuyez sur Alt+Flche vers le bas pour ouvrir le menu."};var L7={};L7={longPressMessage:"     Alt + ArrowDown    "};var B7={};B7={longPressMessage:"Dugo pritisnite ili pritisnite Alt + strelicu prema dolje za otvaranje izbornika"};var N7={};N7={longPressMessage:"Nyomja meg hosszan, vagy nyomja meg az Alt + lefele nyl gombot a men megnyitshoz"};var U7={};U7={longPressMessage:"Premere a lungo o premere Alt + Freccia gi per aprire il menu"};var F7={};F7={longPressMessage:" Alt+"};var j7={};j7={longPressMessage:"  Alt +     "};var V7={};V7={longPressMessage:"Nordami atidaryti meniu, nuspaud palaikykite arba paspauskite Alt + ArrowDown."};var z7={};z7={longPressMessage:"Lai atvrtu izvlni, turiet nospiestu vai nospiediet taustiu kombinciju Alt + lejupvrst bultia"};var K7={};K7={longPressMessage:"Langt trykk eller trykk Alt + PilNed for  pne menyen"};var H7={};H7={longPressMessage:"Druk lang op Alt + pijl-omlaag of druk op Alt om het menu te openen"};var W7={};W7={longPressMessage:"Nacinij i przytrzymaj lub nacinij klawisze Alt + Strzaka w d, aby otworzy menu"};var G7={};G7={longPressMessage:"Pressione e segure ou pressione Alt + Seta para baixo para abrir o menu"};var q7={};q7={longPressMessage:"Prima continuamente ou prima Alt + Seta Para Baixo para abrir o menu"};var Z7={};Z7={longPressMessage:"Apsai lung sau apsai pe Alt + sgeat n jos pentru a deschide meniul"};var Y7={};Y7={longPressMessage:"     Alt +  ,   "};var J7={};J7={longPressMessage:"Ponuku otvorte dlhm stlaenm alebo stlaenm klvesu Alt + klvesu so pkou nadol"};var X7={};X7={longPressMessage:"Za odprtje menija pritisnite in drite gumb ali pritisnite Alt+puica navzdol"};var Q7={};Q7={longPressMessage:"Dugo pritisnite ili pritisnite Alt + strelicu prema dole da otvorite meni"};var eN={};eN={longPressMessage:"Hll nedtryckt eller tryck p Alt + pil nedt fr att ppna menyn"};var tN={};tN={longPressMessage:"Meny amak iin uzun basn veya Alt + Aa Ok tuuna basn"};var rN={};rN={longPressMessage:"      Alt   ,   "};var nN={};nN={longPressMessage:" Alt + "};var iN={};iN={longPressMessage:" Alt+"};var aN={};aN={"ar-AE":C7,"bg-BG":T7,"cs-CZ":D7,"da-DK":R7,"de-DE":M7,"el-GR":I7,"en-US":P7,"es-ES":A7,"et-EE":k7,"fi-FI":O7,"fr-FR":$7,"he-IL":L7,"hr-HR":B7,"hu-HU":N7,"it-IT":U7,"ja-JP":F7,"ko-KR":j7,"lt-LT":V7,"lv-LV":z7,"nb-NO":K7,"nl-NL":H7,"pl-PL":W7,"pt-BR":G7,"pt-PT":q7,"ro-RO":Z7,"ru-RU":Y7,"sk-SK":J7,"sl-SI":X7,"sr-SP":Q7,"sv-SE":eN,"tr-TR":tN,"uk-UA":rN,"zh-CN":nN,"zh-TW":iN};function pie(t){return t&&t.__esModule?t.default:t}function mie(t,e,r){let{type:n="menu",isDisabled:i,trigger:a="press"}=t,o=Ii(),{triggerProps:s,overlayProps:l}=EL({type:n},e,r),c=m=>{if(!i&&!(a==="longPress"&&!m.altKey)&&r&&r.current)switch(m.key){case"Enter":case" ":if(a==="longPress")return;case"ArrowDown":"continuePropagation"in m||m.stopPropagation(),m.preventDefault(),e.toggle("first");break;case"ArrowUp":"continuePropagation"in m||m.stopPropagation(),m.preventDefault(),e.toggle("last");break;default:"continuePropagation"in m&&m.continuePropagation()}},d=Ra(pie(aN),"@react-aria/menu"),{longPressProps:h}=gL({isDisabled:i||a!=="longPress",accessibilityDescription:d.format("longPressMessage"),onLongPressStart(){e.close()},onLongPress(){e.open("first")}}),p={preventFocusOnPress:!0,onPressStart(m){m.pointerType!=="touch"&&m.pointerType!=="keyboard"&&!i&&(wn(m.target),e.open(m.pointerType==="virtual"?"first":null))},onPress(m){m.pointerType==="touch"&&!i&&e.toggle()}};return delete s.onPress,{menuTriggerProps:{...s,...a==="press"?p:h,id:o,onKeyDown:c},menuProps:{...l,"aria-labelledby":o,autoFocus:e.focusStrategy||!0,onClose:e.close}}}const oN=new WeakMap;function vie(t,e,r){let{shouldFocusWrap:n=!0,onKeyDown:i,onKeyUp:a,...o}=t;!t["aria-label"]&&!t["aria-labelledby"]&&console.warn("An aria-label or aria-labelledby prop is required for accessibility.");let s=ho(t,{labelable:!0}),{listProps:l}=Wre({...o,ref:r,selectionManager:e.selectionManager,collection:e.collection,disabledKeys:e.disabledKeys,shouldFocusWrap:n,linkBehavior:"override"});return oN.set(e,{onClose:t.onClose,onAction:t.onAction,shouldUseVirtualFocus:t.shouldUseVirtualFocus}),{menuProps:Oe(s,{onKeyDown:i,onKeyUp:a},{role:"menu",...l,onKeyDown:c=>{var d;(c.key!=="Escape"||t.shouldUseVirtualFocus)&&((d=l.onKeyDown)===null||d===void 0||d.call(l,c))}})}}function gie(t,e,r){let{id:n,key:i,closeOnSelect:a,isVirtualized:o,"aria-haspopup":s,onPressStart:l,onPressUp:c,onPress:d,onPressChange:h,onPressEnd:p,onHoverStart:m,onHoverChange:g,onHoverEnd:y,onKeyDown:R,onKeyUp:b,onFocus:_,onFocusChange:x,onBlur:T,selectionManager:I=e.selectionManager}=t,C=!!s,k=C&&t["aria-expanded"]==="true";var S;let V=(S=t.isDisabled)!==null&&S!==void 0?S:I.isDisabled(i);var z;let j=(z=t.isSelected)!==null&&z!==void 0?z:I.isSelected(i),J=oN.get(e),$=e.collection.getItem(i),le=t.onClose||J.onClose,ie=gb(),Z=we=>{var Ce;if(!C){if(!($==null||(Ce=$.props)===null||Ce===void 0)&&Ce.onAction?$.props.onAction():t.onAction&&t.onAction(i),J.onAction){let $e=J.onAction;$e(i)}we.target instanceof HTMLAnchorElement&&$&&ie.open(we.target,we,$.props.href,$.props.routerOptions)}},te="menuitem";C||(I.selectionMode==="single"?te="menuitemradio":I.selectionMode==="multiple"&&(te="menuitemcheckbox"));let H=nl(),fe=nl(),ne=nl(),he={id:n,"aria-disabled":V||void 0,role:te,"aria-label":t["aria-label"],"aria-labelledby":H,"aria-describedby":[fe,ne].filter(Boolean).join(" ")||void 0,"aria-controls":t["aria-controls"],"aria-haspopup":s,"aria-expanded":t["aria-expanded"]};I.selectionMode!=="none"&&!C&&(he["aria-checked"]=j),o&&(he["aria-posinset"]=$==null?void 0:$.index,he["aria-setsize"]=dne(e.collection));let oe=we=>{we.pointerType==="keyboard"&&Z(we),l==null||l(we)},me=()=>{!C&&le&&(a??(I.selectionMode!=="multiple"||I.isLink(i)))&&le()},ee=we=>{we.pointerType==="mouse"&&(Z(we),me()),c==null||c(we)},Y=we=>{we.pointerType!=="keyboard"&&we.pointerType!=="mouse"&&(Z(we),me()),d==null||d(we)},{itemProps:q,isFocused:X}=Kre({id:n,selectionManager:I,key:i,ref:r,shouldSelectOnPressUp:!0,allowsDifferentPressOrigin:!0,linkBehavior:"none",shouldUseVirtualFocus:J.shouldUseVirtualFocus}),{pressProps:F,isPressed:se}=is({onPressStart:oe,onPress:Y,onPressUp:ee,onPressChange:h,onPressEnd:p,isDisabled:V}),{hoverProps:N}=aa({isDisabled:V,onHoverStart(we){!Vd()&&!(k&&s)&&(I.setFocused(!0),I.setFocusedKey(i)),m==null||m(we)},onHoverChange:g,onHoverEnd:y}),{keyboardProps:ce}=vL({onKeyDown:we=>{if(we.repeat){we.continuePropagation();return}switch(we.key){case" ":!V&&I.selectionMode==="none"&&!C&&a!==!1&&le&&le();break;case"Enter":!V&&a!==!1&&!C&&le&&le();break;default:C||we.continuePropagation(),R==null||R(we);break}},onKeyUp:b}),{focusProps:ue}=wb({onBlur:T,onFocus:_,onFocusChange:x}),pe=ho($==null?void 0:$.props);delete pe.id;let be=gY($==null?void 0:$.props);return{menuItemProps:{...he,...Oe(pe,be,C?{onFocus:q.onFocus,"data-collection":q["data-collection"],"data-key":q["data-key"]}:q,F,N,ce,ue,J.shouldUseVirtualFocus||C?{onMouseDown:we=>we.preventDefault()}:void 0),tabIndex:q.tabIndex!=null&&k&&!J.shouldUseVirtualFocus?-1:q.tabIndex},labelProps:{id:H},descriptionProps:{id:fe},keyboardShortcutProps:{id:ne},isFocused:X,isFocusVisible:X&&I.isFocused&&Vd()&&!k,isSelected:j,isPressed:se,isDisabled:V}}function yie(t){let{heading:e,"aria-label":r}=t,n=Ii();return{itemProps:{role:"presentation"},headingProps:e?{id:n,role:"presentation"}:{},groupProps:{role:"group","aria-label":r,"aria-labelledby":e?n:void 0}}}var bie=700;function sN(){return Am()||typeof window>"u"?!1:window.screen.width<=bie}function _ie(t){var e,r;const n=ln(),[i,a]=la(t,VI.variantKeys),{as:o,item:s,state:l,shortcut:c,description:d,startContent:h,endContent:p,isVirtualized:m,selectedIcon:g,className:y,classNames:R,onAction:b,autoFocus:_,onPress:x,onPressStart:T,onPressUp:I,onPressEnd:C,onPressChange:k,onHoverStart:S,onHoverChange:V,onHoverEnd:z,hideSelectedIcon:j=!1,isReadOnly:J=!1,closeOnSelect:$,onClose:le,onClick:ie,...Z}=i,te=(r=(e=t.disableAnimation)!=null?e:n==null?void 0:n.disableAnimation)!=null?r:!1,H=D.useRef(null),fe=o||(Z!=null&&Z.href?"a":"li"),ne=typeof fe=="string",{rendered:he,key:oe}=s,me=l.disabledKeys.has(oe)||t.isDisabled,ee=l.selectionManager.selectionMode!=="none",Y=sN(),{isFocusVisible:q,focusProps:X}=io({autoFocus:_});ie&&typeof ie=="function"&&MT("onClick is deprecated, please use onPress instead. See: https://github.com/heroui-inc/heroui/issues/4292","MenuItem");const F=D.useCallback(B=>{ie==null||ie(B),x==null||x(B)},[ie,x]),{isPressed:se,isFocused:N,isSelected:ce,isDisabled:ue,menuItemProps:pe,labelProps:be,descriptionProps:we,keyboardShortcutProps:Ce}=gie({key:oe,onClose:le,isDisabled:me,onPress:F,onPressStart:T,onPressUp:I,onPressEnd:C,onPressChange:k,"aria-label":i["aria-label"],closeOnSelect:$,isVirtualized:m,onAction:b},l,H);let{hoverProps:$e,isHovered:Ne}=aa({isDisabled:ue,onHoverStart(B){Vd()||(l.selectionManager.setFocused(!0),l.selectionManager.setFocusedKey(oe)),S==null||S(B)},onHoverChange:V,onHoverEnd:z}),Ie=pe;const Ge=D.useMemo(()=>VI({...a,isDisabled:ue,disableAnimation:te,hasTitleTextChild:typeof he=="string",hasDescriptionTextChild:typeof d=="string"}),[Ri(a),ue,te,he,d]),nt=qe(R==null?void 0:R.base,y);J&&(Ie=SZ(Ie));const ze=(B={})=>({ref:H,...Oe(J?{}:X,Mi(Z,{enabled:ne}),Ie,$e,B),"data-focus":Te(N),"data-selectable":Te(ee),"data-hover":Te(Y?Ne||se:Ne),"data-disabled":Te(ue),"data-selected":Te(ce),"data-pressed":Te(se),"data-focus-visible":Te(q),className:Ge.base({class:qe(nt,B.className)})}),Pe=(B={})=>({...Oe(be,B),className:Ge.title({class:R==null?void 0:R.title})}),vt=(B={})=>({...Oe(we,B),className:Ge.description({class:R==null?void 0:R.description})}),Tt=(B={})=>({...Oe(Ce,B),className:Ge.shortcut({class:R==null?void 0:R.shortcut})}),ir=D.useCallback((B={})=>({"aria-hidden":Te(!0),"data-disabled":Te(ue),className:Ge.selectedIcon({class:R==null?void 0:R.selectedIcon}),...B}),[ue,Ge,R]);return{Component:fe,domRef:H,slots:Ge,classNames:R,isSelectable:ee,isSelected:ce,isDisabled:ue,rendered:he,shortcut:c,description:d,startContent:h,endContent:p,selectedIcon:g,disableAnimation:te,getItemProps:ze,getLabelProps:Pe,hideSelectedIcon:j,getDescriptionProps:vt,getKeyboardShortcutProps:Tt,getSelectedIconProps:ir}}var lN=t=>{const{Component:e,slots:r,classNames:n,rendered:i,shortcut:a,description:o,isSelectable:s,isSelected:l,isDisabled:c,selectedIcon:d,startContent:h,endContent:p,disableAnimation:m,hideSelectedIcon:g,getItemProps:y,getLabelProps:R,getDescriptionProps:b,getKeyboardShortcutProps:_,getSelectedIconProps:x}=_ie(t),T=D.useMemo(()=>{const I=O.jsx(hie,{disableAnimation:m,isSelected:l});return typeof d=="function"?d({icon:I,isSelected:l,isDisabled:c}):d||I},[d,l,c,m]);return O.jsxs(e,{...y(),children:[h,o?O.jsxs("div",{className:r.wrapper({class:n==null?void 0:n.wrapper}),children:[O.jsx("span",{...R(),children:i}),O.jsx("span",{...b(),children:o})]}):O.jsx("span",{...R(),children:i}),a&&O.jsx("kbd",{..._(),children:a}),s&&!g&&O.jsx("span",{...x(),children:T}),p]})};lN.displayName="HeroUI.MenuItem";var uN=lN,cN=Qt(({item:t,state:e,as:r,variant:n,color:i,disableAnimation:a,onAction:o,closeOnSelect:s,className:l,classNames:c,showDivider:d=!1,hideSelectedIcon:h,dividerProps:p={},itemClasses:m,title:g,...y},R)=>{const b=r||"li",_=D.useMemo(()=>Dre(),[]),x=qe(c==null?void 0:c.base,l),T=qe(c==null?void 0:c.divider,p==null?void 0:p.className),{itemProps:I,headingProps:C,groupProps:k}=yie({heading:t.rendered,"aria-label":t["aria-label"]});return O.jsxs(b,{"data-slot":"base",...Oe(I,y),className:_.base({class:x}),children:[t.rendered&&O.jsx("span",{...C,className:_.heading({class:c==null?void 0:c.heading}),"data-slot":"heading",children:t.rendered}),O.jsxs("ul",{...k,className:_.group({class:c==null?void 0:c.group}),"data-has-title":!!t.rendered,"data-slot":"group",children:[[...t.childNodes].map(S=>{const{key:V,props:z}=S;let j=O.jsx(uN,{classNames:m,closeOnSelect:s,color:i,disableAnimation:a,hideSelectedIcon:h,item:S,state:e,variant:n,onAction:o,...z},V);return S.wrapper&&(j=S.wrapper(j)),j}),d&&O.jsx(WB,{as:"li",className:_.divider({class:T}),...p})]})]})});cN.displayName="HeroUI.MenuSection";var Sie=cN;function wie(t){var e;const r=ln(),{as:n,ref:i,variant:a,color:o,children:s,disableAnimation:l=(e=r==null?void 0:r.disableAnimation)!=null?e:!1,onAction:c,closeOnSelect:d,itemClasses:h,className:p,state:m,topContent:g,bottomContent:y,hideEmptyContent:R=!1,hideSelectedIcon:b=!1,emptyContent:_="No items.",menuProps:x,onClose:T,classNames:I,...C}=t,k=n||"ul",S=fr(i),V=typeof k=="string",z=fne({...C,...x,children:s}),j=m||z,{menuProps:J}=vie({...C,...x,onAction:c},j,S),$=D.useMemo(()=>Tre({className:p}),[p]),le=qe(I==null?void 0:I.base,p);return{Component:k,state:j,variant:a,color:o,disableAnimation:l,onClose:T,topContent:g,bottomContent:y,closeOnSelect:d,className:p,itemClasses:h,getBaseProps:(H={})=>({ref:S,"data-slot":"base",className:$.base({class:le}),...Mi(C,{enabled:V}),...H}),getListProps:(H={})=>({"data-slot":"list",className:$.list({class:I==null?void 0:I.list}),...J,...H}),hideEmptyContent:R,hideSelectedIcon:b,getEmptyContentProps:(H={})=>({children:_,className:$.emptyContent({class:I==null?void 0:I.emptyContent}),...H})}}var Eie=Qt(function(e,r){const{Component:n,state:i,closeOnSelect:a,color:o,disableAnimation:s,hideSelectedIcon:l,hideEmptyContent:c,variant:d,onClose:h,topContent:p,bottomContent:m,itemClasses:g,getBaseProps:y,getListProps:R,getEmptyContentProps:b}=wie({...e,ref:r}),_=O.jsxs(n,{...R(),children:[!i.collection.size&&!c&&O.jsx("li",{children:O.jsx("div",{...b()})}),[...i.collection].map(x=>{const T={closeOnSelect:a,color:o,disableAnimation:s,item:x,state:i,variant:d,onClose:h,hideSelectedIcon:l,...x.props},I=$re(g,T==null?void 0:T.classNames);if(x.type==="section")return O.jsx(Sie,{...T,itemClasses:I},x.key);let C=O.jsx(uN,{...T,classNames:I},x.key);return x.wrapper&&(C=x.wrapper(C)),C})]});return O.jsxs("div",{...y(),children:[p,_,m]})}),xie=Eie,Cie=one,XS=Cie,Tie=Qt(function(e,r){const{getMenuProps:n}=x7();return O.jsx(uie,{children:O.jsx(yL,{contain:!0,restoreFocus:!0,children:O.jsx(xie,{...n(e,r)})})})}),Die=Tie,dN=t=>{const{getMenuTriggerProps:e}=x7(),{children:r,...n}=t;return O.jsx(cie,{...e(n),children:r})};dN.displayName="HeroUI.DropdownTrigger";var Rie=dN;function Mie(t){let e=Ib(t),[r,n]=D.useState(null),[i,a]=D.useState([]),o=()=>{a([]),e.close()};return{focusStrategy:r,...e,open(c=null){n(c),e.open()},toggle(c=null){n(c),e.toggle()},close(){o()},expandedKeysStack:i,openSubmenu:(c,d)=>{a(h=>d>h.length?h:[...h.slice(0,d),c])},closeSubmenu:(c,d)=>{a(h=>h[d]===c?h.slice(0,d):h)}}}var Iie=(t,e)=>{if(t){const r=Array.isArray(t.children)?t.children:[...(t==null?void 0:t.items)||[]];if(r&&r.length)return r.find(i=>{if(i&&i.key===e)return i})||{}}return null},Pie=(t,e,r)=>{const n=r||Iie(t,e);return n&&n.props&&"closeOnSelect"in n.props?n.props.closeOnSelect:t==null?void 0:t.closeOnSelect};function Aie(t){var e;const r=ln(),{as:n,triggerRef:i,isOpen:a,defaultOpen:o,onOpenChange:s,isDisabled:l,type:c="menu",trigger:d="press",placement:h="bottom",closeOnSelect:p=!0,shouldBlockScroll:m=!0,classNames:g,disableAnimation:y=(e=r==null?void 0:r.disableAnimation)!=null?e:!1,onClose:R,className:b,..._}=t,x=n||"div",T=D.useRef(null),I=i||T,C=D.useRef(null),k=D.useRef(null),S=Mie({trigger:d,isOpen:a,defaultOpen:o,onOpenChange:Z=>{s==null||s(Z),Z||R==null||R()}}),{menuTriggerProps:V,menuProps:z}=mie({type:c,trigger:d,isDisabled:l},S,I),j=D.useMemo(()=>Mre({className:b}),[b]),J=Z=>{Z!==void 0&&!Z||p&&S.close()},$=(Z={})=>{const te=Oe(_,Z);return{state:S,placement:h,ref:k,disableAnimation:y,shouldBlockScroll:m,scrollRef:C,triggerRef:I,...te,classNames:{...g,...Z.classNames,content:qe(j,g==null?void 0:g.content,Z.className)},shouldCloseOnInteractOutside:te!=null&&te.shouldCloseOnInteractOutside?te.shouldCloseOnInteractOutside:H=>y4(H,T,S)}},le=(Z={})=>{const{onPress:te,onPressStart:H,...fe}=V;return Oe(fe,{isDisabled:l},Z)},ie=(Z,te=null)=>({ref:CZ(te,C),menuProps:z,closeOnSelect:p,...Oe(Z,{onAction:(H,fe)=>{const ne=Pie(Z,H,fe);J(ne)},onClose:S.close})});return{Component:x,menuRef:C,menuProps:z,closeOnSelect:p,onClose:S.close,autoFocus:S.focusStrategy||!0,disableAnimation:y,getPopoverProps:$,getMenuProps:ie,getMenuTriggerProps:le}}var fN=t=>{const{children:e,...r}=t,n=Aie(r),[i,a]=We.Children.toArray(e);return O.jsx(fie,{value:n,children:O.jsxs(die,{...n.getPopoverProps(),children:[i,a]})})};fN.displayName="HeroUI.Dropdown";var kie=fN,[Oie,Pb]=Sl({name:"ModalContext",errorMessage:"useModalContext: `context` is undefined. Seems you forgot to wrap all popover components within `<Modal />`"}),hN=Qt((t,e)=>{const{as:r,children:n,className:i,...a}=t,{slots:o,classNames:s,bodyId:l,setBodyMounted:c}=Pb(),d=fr(e),h=r||"div";return D.useEffect(()=>(c(!0),()=>c(!1)),[c]),O.jsx(h,{ref:d,className:o.body({class:qe(s==null?void 0:s.body,i)}),id:l,...a,children:n})});hN.displayName="HeroUI.ModalBody";var pN=hN,$ie={enter:{scale:"var(--scale-enter)",y:"var(--slide-enter)",opacity:1,willChange:"auto",transition:{scale:{duration:.4,ease:op.ease},opacity:{duration:.4,ease:op.ease},y:{type:"spring",bounce:0,duration:.6}}},exit:{scale:"var(--scale-exit)",y:"var(--slide-exit)",opacity:0,willChange:"transform",transition:{duration:.3,ease:op.ease}}},mP=()=>El(()=>import("./index-BeaB_b6p.js"),[]).then(t=>t.default),mN=t=>{const{as:e,children:r,role:n="dialog",...i}=t,{Component:a,domRef:o,slots:s,classNames:l,motionProps:c,backdrop:d,closeButton:h,hideCloseButton:p,disableAnimation:m,getDialogProps:g,getBackdropProps:y,getCloseButtonProps:R,onClose:b}=Pb(),_=e||a||"div",x=SY(),{dialogProps:T}=x4({role:n},o),I=D.isValidElement(h)?D.cloneElement(h,R()):O.jsx("button",{...R(),children:O.jsx(VB,{})}),C=D.useCallback(J=>{J.key==="Tab"&&J.nativeEvent.isComposing&&(J.stopPropagation(),J.preventDefault())},[]),k=g(Oe(T,i)),S=O.jsxs(_,{...k,onKeyDown:Tn(k.onKeyDown,C),children:[O.jsx(zd,{onDismiss:b}),!p&&I,typeof r=="function"?r(b):r,O.jsx(zd,{onDismiss:b})]}),V=D.useMemo(()=>d==="transparent"?null:m?O.jsx("div",{...y()}):O.jsx(Ca,{features:mP,children:O.jsx(Ai.div,{animate:"enter",exit:"exit",initial:"exit",variants:jp.fade,...y()})}),[d,m,y]),z={"--visual-viewport-height":x.height+"px"},j=m?O.jsx("div",{className:s.wrapper({class:l==null?void 0:l.wrapper}),"data-slot":"wrapper",style:z,children:S}):O.jsx(Ca,{features:mP,children:O.jsx(Ai.div,{animate:"enter",className:s.wrapper({class:l==null?void 0:l.wrapper}),"data-slot":"wrapper",exit:"exit",initial:"exit",variants:$ie,...c,style:z,children:S})});return O.jsxs("div",{tabIndex:-1,children:[V,j]})};mN.displayName="HeroUI.ModalContent";var vN=mN,gN=Qt((t,e)=>{const{as:r,children:n,className:i,...a}=t,{slots:o,classNames:s}=Pb(),l=fr(e),c=r||"footer";return O.jsx(c,{ref:l,className:o.footer({class:qe(s==null?void 0:s.footer,i)}),...a,children:n})});gN.displayName="HeroUI.ModalFooter";var yN=gN,bN=Qt((t,e)=>{const{as:r,children:n,className:i,...a}=t,{slots:o,classNames:s,headerId:l,setHeaderMounted:c}=Pb(),d=fr(e),h=r||"header";return D.useEffect(()=>(c(!0),()=>c(!1)),[c]),O.jsx(h,{ref:d,className:o.header({class:qe(s==null?void 0:s.header,i)}),id:l,...a,children:n})});bN.displayName="HeroUI.ModalHeader";var _N=bN;function Lie(t={shouldBlockScroll:!0},e,r){let{overlayProps:n,underlayProps:i}=wL({...t,isOpen:e.isOpen,onClose:e.close},r);return xL({isDisabled:!e.isOpen||!t.shouldBlockScroll}),l2(),D.useEffect(()=>{if(e.isOpen&&r.current)return o2([r.current])},[e.isOpen,r]),{modalProps:Oe(n),underlayProps:i}}function Bie(t){var e,r,n;const i=ln(),[a,o]=la(t,zI.variantKeys),{ref:s,as:l,className:c,classNames:d,isOpen:h,defaultOpen:p,onOpenChange:m,motionProps:g,closeButton:y,isDismissable:R=!0,hideCloseButton:b=!1,shouldBlockScroll:_=!0,portalContainer:x,isKeyboardDismissDisabled:T=!1,onClose:I,...C}=a,k=l||"section",S=fr(s),V=D.useRef(null),[z,j]=D.useState(!1),[J,$]=D.useState(!1),le=(r=(e=t.disableAnimation)!=null?e:i==null?void 0:i.disableAnimation)!=null?r:!1,ie=D.useId(),Z=D.useId(),te=D.useId(),H=Ib({isOpen:h,defaultOpen:p,onOpenChange:se=>{m==null||m(se),se||I==null||I()}}),{modalProps:fe,underlayProps:ne}=Lie({isDismissable:R,shouldBlockScroll:_,isKeyboardDismissDisabled:T},H,S),{buttonProps:he}=Um({onPress:H.close},V),{isFocusVisible:oe,focusProps:me}=io(),ee=qe(d==null?void 0:d.base,c),Y=D.useMemo(()=>zI({...o,disableAnimation:le}),[Ri(o),le]),q=(se={},N=null)=>{var ce;return{ref:AT(N,S),...Oe(fe,C,se),className:Y.base({class:qe(ee,se.className)}),id:ie,"data-open":Te(H.isOpen),"data-dismissable":Te(R),"aria-modal":Te(!0),"data-placement":(ce=t==null?void 0:t.placement)!=null?ce:"right","aria-labelledby":z?Z:void 0,"aria-describedby":J?te:void 0}},X=D.useCallback((se={})=>({className:Y.backdrop({class:d==null?void 0:d.backdrop}),onClick:()=>H.close(),...ne,...se}),[Y,d,ne]),F=()=>({role:"button",tabIndex:0,"aria-label":"Close","data-focus-visible":Te(oe),className:Y.closeButton({class:d==null?void 0:d.closeButton}),...Oe(he,me)});return{Component:k,slots:Y,domRef:S,headerId:Z,bodyId:te,motionProps:g,classNames:d,isDismissable:R,closeButton:y,hideCloseButton:b,portalContainer:x,shouldBlockScroll:_,backdrop:(n=t.backdrop)!=null?n:"opaque",isOpen:H.isOpen,onClose:H.close,disableAnimation:le,setBodyMounted:$,setHeaderMounted:j,getDialogProps:q,getBackdropProps:X,getCloseButtonProps:F}}var SN=Qt((t,e)=>{const{children:r,...n}=t,i=Bie({...n,ref:e}),a=O.jsx(FT,{portalContainer:i.portalContainer,children:r});return O.jsx(Oie,{value:i,children:i.disableAnimation&&i.isOpen?a:O.jsx(Gu,{children:i.isOpen?a:null})})});SN.displayName="HeroUI.Modal";var wN=SN;function EN(t={}){const{id:e,defaultOpen:r,isOpen:n,onClose:i,onOpen:a,onChange:o=()=>{}}=t,s=aP(a),l=aP(i),[c,d]=Pi(n,r||!1,o),h=D.useId(),p=e||h,m=n!==void 0,g=D.useCallback(()=>{m||d(!1),l==null||l()},[m,l]),y=D.useCallback(()=>{m||d(!0),s==null||s()},[m,s]),R=D.useCallback(()=>{(c?g:y)()},[c,y,g]);return{isOpen:!!c,onOpen:y,onClose:g,onOpenChange:R,isControlled:m,getButtonProps:(b={})=>({...b,"aria-expanded":c,"aria-controls":p,onClick:Tn(b.onClick,R)}),getDisclosureProps:(b={})=>({...b,hidden:!c,id:p})}}const xN=7e3;let ji=null;function U1(t,e="assertive",r=xN){ji?ji.announce(t,e,r):(ji=new Uie,(typeof IS_REACT_ACT_ENVIRONMENT=="boolean"?IS_REACT_ACT_ENVIRONMENT:typeof jest<"u")?ji.announce(t,e,r):setTimeout(()=>{ji!=null&&ji.isAttached()&&(ji==null||ji.announce(t,e,r))},100))}function Nie(t){ji&&ji.clear(t)}class Uie{isAttached(){var e;return(e=this.node)===null||e===void 0?void 0:e.isConnected}createLog(e){let r=document.createElement("div");return r.setAttribute("role","log"),r.setAttribute("aria-live",e),r.setAttribute("aria-relevant","additions"),r}destroy(){this.node&&(document.body.removeChild(this.node),this.node=null)}announce(e,r="assertive",n=xN){var i,a;if(!this.node)return;let o=document.createElement("div");typeof e=="object"?(o.setAttribute("role","img"),o.setAttribute("aria-labelledby",e["aria-labelledby"])):o.textContent=e,r==="assertive"?(i=this.assertiveLog)===null||i===void 0||i.appendChild(o):(a=this.politeLog)===null||a===void 0||a.appendChild(o),e!==""&&setTimeout(()=>{o.remove()},n)}clear(e){this.node&&((!e||e==="assertive")&&this.assertiveLog&&(this.assertiveLog.innerHTML=""),(!e||e==="polite")&&this.politeLog&&(this.politeLog.innerHTML=""))}constructor(){this.node=null,this.assertiveLog=null,this.politeLog=null,typeof document<"u"&&(this.node=document.createElement("div"),this.node.dataset.liveAnnouncer="true",Object.assign(this.node.style,{border:0,clip:"rect(0 0 0 0)",clipPath:"inset(50%)",height:"1px",margin:"-1px",overflow:"hidden",padding:0,position:"absolute",width:"1px",whiteSpace:"nowrap"}),this.assertiveLog=this.createLog("assertive"),this.node.appendChild(this.assertiveLog),this.politeLog=this.createLog("polite"),this.node.appendChild(this.politeLog),document.body.prepend(this.node))}}function Fie(t){var e,r,n,i,a,o,s;const[l,c]=la(t,KI.variantKeys),d=ln(),{locale:h,direction:p}=sn(),m=p==="rtl",g=TT(new ba(h).resolvedOptions().calendar),y=EZ(g.identifier),{ref:R,as:b,children:_,className:x,topContent:T,bottomContent:I,showHelper:C=!0,firstDayOfWeek:k,calendarWidth:S=256,visibleMonths:V=1,weekdayStyle:z="narrow",navButtonProps:j={},isHeaderExpanded:J,isHeaderDefaultExpanded:$,onHeaderExpandedChange:le=()=>{},createCalendar:ie=(e=d==null?void 0:d.createCalendar)!=null?e:null,minValue:Z=(n=(r=d==null?void 0:d.defaultDates)==null?void 0:r.minDate)!=null?n:new Bt(g,1900+y,1,1),maxValue:te=(a=(i=d==null?void 0:d.defaultDates)==null?void 0:i.maxDate)!=null?a:new Bt(g,2099+y,12,31),prevButtonProps:H,nextButtonProps:fe,errorMessage:ne,classNames:he,...oe}=l,me=b||"div",ee=RT(V,1,3),Y=t.showMonthAndYearPickers&&ee===1,q=fr(R),X=D.useCallback(Ge=>{le(Ge||!1)},[le]),[F,se]=Pi(J,$??!1,X),N=D.useMemo(()=>({months:ee}),[ee]),ce=ee>1,ue=typeof me=="string",pe=D.useMemo(()=>KI({...c,showMonthAndYearPickers:Y,isRange:!!t.isRange,isHeaderWrapperExpanded:F,className:x,isRTL:m}),[Ri(c),Y,F,x]),be=(s=(o=t.disableAnimation)!=null?o:d==null?void 0:d.disableAnimation)!=null?s:!1,we={size:"sm",variant:"light",radius:"full",isIconOnly:!0,disableAnimation:be,...j},Ce={"data-slot":"base","data-has-multiple-months":Te(ce),style:{"--visible-months":typeof ee=="number"?`${ee}`:ee,"--calendar-width":typeof S=="number"?`${S}px`:S}};return{Component:me,children:_,domRef:q,slots:pe,locale:h,minValue:Z,maxValue:te,baseProps:Ce,showHelper:C,firstDayOfWeek:k,weekdayStyle:z,visibleMonths:ee,visibleDuration:N,shouldFilterDOMProps:ue,isHeaderExpanded:F,showMonthAndYearPickers:Y,disableAnimation:be,createCalendar:ie,getPrevButtonProps:(Ge={})=>({"data-slot":"prev-button",tabIndex:F?-1:0,className:pe.prevButton({class:he==null?void 0:he.prevButton}),...Oe(we,H,Ge)}),getNextButtonProps:(Ge={})=>({"data-slot":"next-button",tabIndex:F?-1:0,className:pe.nextButton({class:he==null?void 0:he.nextButton}),...Oe(we,fe,Ge)}),getErrorMessageProps:(Ge={})=>({"data-slot":"error-message",className:pe.errorMessage({class:he==null?void 0:he.errorMessage}),...Ge}),setIsHeaderExpanded:se,topContent:T,bottomContent:I,errorMessage:ne,classNames:he,otherProps:oe}}var CN={};CN={dateRange:t=>`${t.startDate}  ${t.endDate}`,dateSelected:t=>`${t.date} `,finishRangeSelectionPrompt:"     ",maximumDate:"  ",minimumDate:"  ",next:"",previous:"",selectedDateDescription:t=>` : ${t.date}`,selectedRangeDescription:t=>`  : ${t.dateRange}`,startRangeSelectionPrompt:"     ",todayDate:t=>` ${t.date}`,todayDateSelected:t=>` ${t.date} `};var TN={};TN={dateRange:t=>`${t.startDate}  ${t.endDate}`,dateSelected:t=>`  ${t.date}`,finishRangeSelectionPrompt:",       ",maximumDate:"  ",minimumDate:"  ",next:"",previous:"",selectedDateDescription:t=>` : ${t.date}`,selectedRangeDescription:t=>` : ${t.dateRange}`,startRangeSelectionPrompt:",        ",todayDate:t=>`, ${t.date}`,todayDateSelected:t=>`, ${t.date}  `};var DN={};DN={dateRange:t=>`${t.startDate} a ${t.endDate}`,dateSelected:t=>`Vybrno ${t.date}`,finishRangeSelectionPrompt:"Kliknutm dokonte vbr rozsahu dat",maximumDate:"Posledn dostupn datum",minimumDate:"Prvn dostupn datum",next:"Dal",previous:"Pedchoz",selectedDateDescription:t=>`Vybran datum: ${t.date}`,selectedRangeDescription:t=>`Vybran obdob: ${t.dateRange}`,startRangeSelectionPrompt:"Kliknutm zahjte vbr rozsahu dat",todayDate:t=>`Dnes, ${t.date}`,todayDateSelected:t=>`Dnes, vybrno ${t.date}`};var RN={};RN={dateRange:t=>`${t.startDate} til ${t.endDate}`,dateSelected:t=>`${t.date} valgt`,finishRangeSelectionPrompt:"Klik for at fuldfre valg af datoomrde",maximumDate:"Sidste ledige dato",minimumDate:"Frste ledige dato",next:"Nste",previous:"Forrige",selectedDateDescription:t=>`Valgt dato: ${t.date}`,selectedRangeDescription:t=>`Valgt interval: ${t.dateRange}`,startRangeSelectionPrompt:"Klik for at starte valg af datoomrde",todayDate:t=>`I dag, ${t.date}`,todayDateSelected:t=>`I dag, ${t.date} valgt`};var MN={};MN={dateRange:t=>`${t.startDate} bis ${t.endDate}`,dateSelected:t=>`${t.date} ausgewhlt`,finishRangeSelectionPrompt:"Klicken, um die Auswahl des Datumsbereichs zu beenden",maximumDate:"Letztes verfgbares Datum",minimumDate:"Erstes verfgbares Datum",next:"Weiter",previous:"Zurck",selectedDateDescription:t=>`Ausgewhltes Datum: ${t.date}`,selectedRangeDescription:t=>`Ausgewhlter Bereich: ${t.dateRange}`,startRangeSelectionPrompt:"Klicken, um die Auswahl des Datumsbereichs zu beginnen",todayDate:t=>`Heute, ${t.date}`,todayDateSelected:t=>`Heute, ${t.date} ausgewhlt`};var IN={};IN={dateRange:t=>`${t.startDate}  ${t.endDate}`,dateSelected:t=>` ${t.date}`,finishRangeSelectionPrompt:"        ",maximumDate:"  ",minimumDate:"  ",next:"",previous:"",selectedDateDescription:t=>` : ${t.date}`,selectedRangeDescription:t=>` : ${t.dateRange}`,startRangeSelectionPrompt:"        ",todayDate:t=>`, ${t.date}`,todayDateSelected:t=>`,  ${t.date}`};var PN={};PN={previous:"Previous",next:"Next",selectedDateDescription:t=>`Selected Date: ${t.date}`,selectedRangeDescription:t=>`Selected Range: ${t.dateRange}`,todayDate:t=>`Today, ${t.date}`,todayDateSelected:t=>`Today, ${t.date} selected`,dateSelected:t=>`${t.date} selected`,startRangeSelectionPrompt:"Click to start selecting date range",finishRangeSelectionPrompt:"Click to finish selecting date range",minimumDate:"First available date",maximumDate:"Last available date",dateRange:t=>`${t.startDate} to ${t.endDate}`};var AN={};AN={dateRange:t=>`${t.startDate} a ${t.endDate}`,dateSelected:t=>`${t.date} seleccionado`,finishRangeSelectionPrompt:"Haga clic para terminar de seleccionar rango de fechas",maximumDate:"ltima fecha disponible",minimumDate:"Primera fecha disponible",next:"Siguiente",previous:"Anterior",selectedDateDescription:t=>`Fecha seleccionada: ${t.date}`,selectedRangeDescription:t=>`Intervalo seleccionado: ${t.dateRange}`,startRangeSelectionPrompt:"Haga clic para comenzar a seleccionar un rango de fechas",todayDate:t=>`Hoy, ${t.date}`,todayDateSelected:t=>`Hoy, ${t.date} seleccionado`};var kN={};kN={dateRange:t=>`${t.startDate} kuni ${t.endDate}`,dateSelected:t=>`${t.date} valitud`,finishRangeSelectionPrompt:"Klpsake kuupevavahemiku valimise lpetamiseks",maximumDate:"Viimane saadaolev kuupev",minimumDate:"Esimene saadaolev kuupev",next:"Jrgmine",previous:"Eelmine",selectedDateDescription:t=>`Valitud kuupev: ${t.date}`,selectedRangeDescription:t=>`Valitud vahemik: ${t.dateRange}`,startRangeSelectionPrompt:"Klpsake kuupevavahemiku valimiseks",todayDate:t=>`Tna, ${t.date}`,todayDateSelected:t=>`Tna, ${t.date} valitud`};var ON={};ON={dateRange:t=>`${t.startDate}  ${t.endDate}`,dateSelected:t=>`${t.date} valittu`,finishRangeSelectionPrompt:"Lopeta pivmralueen valinta napsauttamalla tt.",maximumDate:"Viimeinen varattavissa oleva pivmr",minimumDate:"Ensimminen varattavissa oleva pivmr",next:"Seuraava",previous:"Edellinen",selectedDateDescription:t=>`Valittu pivmr: ${t.date}`,selectedRangeDescription:t=>`Valittu aikavli: ${t.dateRange}`,startRangeSelectionPrompt:"Aloita pivmralueen valinta napsauttamalla tt.",todayDate:t=>`Tnn, ${t.date}`,todayDateSelected:t=>`Tnn, ${t.date} valittu`};var $N={};$N={dateRange:t=>`${t.startDate}  ${t.endDate}`,dateSelected:t=>`${t.date} slectionn`,finishRangeSelectionPrompt:"Cliquer pour finir de slectionner la plage de dates",maximumDate:"Dernire date disponible",minimumDate:"Premire date disponible",next:"Suivant",previous:"Prcdent",selectedDateDescription:t=>`Date slectionne: ${t.date}`,selectedRangeDescription:t=>`Plage slectionne: ${t.dateRange}`,startRangeSelectionPrompt:"Cliquer pour commencer  slectionner la plage de dates",todayDate:t=>`Aujourd'hui, ${t.date}`,todayDateSelected:t=>`Aujourdhui, ${t.date} slectionn`};var LN={};LN={dateRange:t=>`${t.startDate}  ${t.endDate}`,dateSelected:t=>`${t.date} `,finishRangeSelectionPrompt:"      ",maximumDate:"  ",minimumDate:"  ",next:"",previous:"",selectedDateDescription:t=>` : ${t.date}`,selectedRangeDescription:t=>` : ${t.dateRange}`,startRangeSelectionPrompt:"     ",todayDate:t=>`, ${t.date}`,todayDateSelected:t=>`, ${t.date} `};var BN={};BN={dateRange:t=>`${t.startDate} do ${t.endDate}`,dateSelected:t=>`${t.date} odabran`,finishRangeSelectionPrompt:"Kliknite da dovrite raspon odabranih datuma",maximumDate:"Posljednji raspoloivi datum",minimumDate:"Prvi raspoloivi datum",next:"Sljedei",previous:"Prethodni",selectedDateDescription:t=>`Odabrani datum: ${t.date}`,selectedRangeDescription:t=>`Odabrani raspon: ${t.dateRange}`,startRangeSelectionPrompt:"Kliknite da zaponete raspon odabranih datuma",todayDate:t=>`Danas, ${t.date}`,todayDateSelected:t=>`Danas, odabran ${t.date}`};var NN={};NN={dateRange:t=>`${t.startDate}${t.endDate}`,dateSelected:t=>`${t.date} kivlasztva`,finishRangeSelectionPrompt:"Kattintson a dtumtartomny kijellsnek befejezshez",maximumDate:"Utols elrhet dtum",minimumDate:"Az els elrhet dtum",next:"Kvetkez",previous:"Elz",selectedDateDescription:t=>`Kijellt dtum: ${t.date}`,selectedRangeDescription:t=>`Kijellt tartomny: ${t.dateRange}`,startRangeSelectionPrompt:"Kattintson a dtumtartomny kijellsnek indtshoz",todayDate:t=>`Ma, ${t.date}`,todayDateSelected:t=>`Ma, ${t.date} kijellve`};var UN={};UN={dateRange:t=>`Da ${t.startDate} a ${t.endDate}`,dateSelected:t=>`${t.date} selezionata`,finishRangeSelectionPrompt:"Fai clic per completare la selezione dellintervallo di date",maximumDate:"Ultima data disponibile",minimumDate:"Prima data disponibile",next:"Successivo",previous:"Precedente",selectedDateDescription:t=>`Data selezionata: ${t.date}`,selectedRangeDescription:t=>`Intervallo selezionato: ${t.dateRange}`,startRangeSelectionPrompt:"Fai clic per selezionare lintervallo di date",todayDate:t=>`Oggi, ${t.date}`,todayDateSelected:t=>`Oggi, ${t.date} selezionata`};var FN={};FN={dateRange:t=>`${t.startDate}  ${t.endDate}`,dateSelected:t=>`${t.date} `,finishRangeSelectionPrompt:"",maximumDate:"",minimumDate:"",next:"",previous:"",selectedDateDescription:t=>` : ${t.date}`,selectedRangeDescription:t=>` : ${t.dateRange}`,startRangeSelectionPrompt:"",todayDate:t=>`${t.date}`,todayDateSelected:t=>`${t.date} `};var jN={};jN={dateRange:t=>`${t.startDate} ~ ${t.endDate}`,dateSelected:t=>`${t.date} `,finishRangeSelectionPrompt:"    .",maximumDate:"   ",minimumDate:"   ",next:"",previous:"",selectedDateDescription:t=>` : ${t.date}`,selectedRangeDescription:t=>` : ${t.dateRange}`,startRangeSelectionPrompt:"    .",todayDate:t=>`, ${t.date}`,todayDateSelected:t=>`, ${t.date} `};var VN={};VN={dateRange:t=>`Nuo ${t.startDate} iki ${t.endDate}`,dateSelected:t=>`Pasirinkta ${t.date}`,finishRangeSelectionPrompt:"Spustelkite, kad baigtumte pasirinkti dat interval",maximumDate:"Paskutin galima data",minimumDate:"Pirmoji galima data",next:"Paskesnis",previous:"Ankstesnis",selectedDateDescription:t=>`Pasirinkta data: ${t.date}`,selectedRangeDescription:t=>`Pasirinktas intervalas: ${t.dateRange}`,startRangeSelectionPrompt:"Spustelkite, kad pradtumte pasirinkti dat interval",todayDate:t=>`iandien, ${t.date}`,todayDateSelected:t=>`iandien, pasirinkta ${t.date}`};var zN={};zN={dateRange:t=>`No ${t.startDate} ldz ${t.endDate}`,dateSelected:t=>`Atlasts: ${t.date}`,finishRangeSelectionPrompt:"Noklikiniet, lai pabeigtu datumu diapazona atlasi",maximumDate:"Pdjais pieejamais datums",minimumDate:"Pirmais pieejamais datums",next:"Tlk",previous:"Atpaka",selectedDateDescription:t=>`Atlastais datums: ${t.date}`,selectedRangeDescription:t=>`Atlastais diapazons: ${t.dateRange}`,startRangeSelectionPrompt:"Noklikiniet, lai sktu datumu diapazona atlasi",todayDate:t=>`odien, ${t.date}`,todayDateSelected:t=>`Atlasta odiena, ${t.date}`};var KN={};KN={dateRange:t=>`${t.startDate} til ${t.endDate}`,dateSelected:t=>`${t.date} valgt`,finishRangeSelectionPrompt:"Klikk for  fullfre valg av datoomrde",maximumDate:"Siste tilgjengelige dato",minimumDate:"Frste tilgjengelige dato",next:"Neste",previous:"Forrige",selectedDateDescription:t=>`Valgt dato: ${t.date}`,selectedRangeDescription:t=>`Valgt omrde: ${t.dateRange}`,startRangeSelectionPrompt:"Klikk for  starte valg av datoomrde",todayDate:t=>`I dag, ${t.date}`,todayDateSelected:t=>`I dag, ${t.date} valgt`};var HN={};HN={dateRange:t=>`${t.startDate} tot ${t.endDate}`,dateSelected:t=>`${t.date} geselecteerd`,finishRangeSelectionPrompt:"Klik om de selectie van het datumbereik te voltooien",maximumDate:"Laatste beschikbare datum",minimumDate:"Eerste beschikbare datum",next:"Volgende",previous:"Vorige",selectedDateDescription:t=>`Geselecteerde datum: ${t.date}`,selectedRangeDescription:t=>`Geselecteerd bereik: ${t.dateRange}`,startRangeSelectionPrompt:"Klik om het datumbereik te selecteren",todayDate:t=>`Vandaag, ${t.date}`,todayDateSelected:t=>`Vandaag, ${t.date} geselecteerd`};var WN={};WN={dateRange:t=>`${t.startDate} do ${t.endDate}`,dateSelected:t=>`Wybrano ${t.date}`,finishRangeSelectionPrompt:"Kliknij, aby zakoczy wybr zakresu dat",maximumDate:"Ostatnia dostpna data",minimumDate:"Pierwsza dostpna data",next:"Dalej",previous:"Wstecz",selectedDateDescription:t=>`Wybrana data: ${t.date}`,selectedRangeDescription:t=>`Wybrany zakres: ${t.dateRange}`,startRangeSelectionPrompt:"Kliknij, aby rozpocz wybr zakresu dat",todayDate:t=>`Dzisiaj, ${t.date}`,todayDateSelected:t=>`Dzisiaj wybrano ${t.date}`};var GN={};GN={dateRange:t=>`${t.startDate} a ${t.endDate}`,dateSelected:t=>`${t.date} selecionado`,finishRangeSelectionPrompt:"Clique para concluir a seleo do intervalo de datas",maximumDate:"ltima data disponvel",minimumDate:"Primeira data disponvel",next:"Prximo",previous:"Anterior",selectedDateDescription:t=>`Data selecionada: ${t.date}`,selectedRangeDescription:t=>`Intervalo selecionado: ${t.dateRange}`,startRangeSelectionPrompt:"Clique para iniciar a seleo do intervalo de datas",todayDate:t=>`Hoje, ${t.date}`,todayDateSelected:t=>`Hoje, ${t.date} selecionado`};var qN={};qN={dateRange:t=>`${t.startDate} a ${t.endDate}`,dateSelected:t=>`${t.date} selecionado`,finishRangeSelectionPrompt:"Clique para terminar de selecionar o intervalo de datas",maximumDate:"ltima data disponvel",minimumDate:"Primeira data disponvel",next:"Prximo",previous:"Anterior",selectedDateDescription:t=>`Data selecionada: ${t.date}`,selectedRangeDescription:t=>`Intervalo selecionado: ${t.dateRange}`,startRangeSelectionPrompt:"Clique para comear a selecionar o intervalo de datas",todayDate:t=>`Hoje, ${t.date}`,todayDateSelected:t=>`Hoje, ${t.date} selecionado`};var ZN={};ZN={dateRange:t=>`De la ${t.startDate} pn la ${t.endDate}`,dateSelected:t=>`${t.date} selectat`,finishRangeSelectionPrompt:"Apsai pentru a finaliza selecia razei pentru dat",maximumDate:"Ultima dat disponibil",minimumDate:"Prima dat disponibil",next:"Urmtorul",previous:"nainte",selectedDateDescription:t=>`Dat selectat: ${t.date}`,selectedRangeDescription:t=>`Interval selectat: ${t.dateRange}`,startRangeSelectionPrompt:"Apsai pentru a ncepe selecia razei pentru dat",todayDate:t=>`Astzi, ${t.date}`,todayDateSelected:t=>`Azi, ${t.date} selectat`};var YN={};YN={dateRange:t=>` ${t.startDate}  ${t.endDate}`,dateSelected:t=>` ${t.date}`,finishRangeSelectionPrompt:",     ",maximumDate:"  ",minimumDate:"  ",next:"",previous:"",selectedDateDescription:t=>` : ${t.date}`,selectedRangeDescription:t=>` : ${t.dateRange}`,startRangeSelectionPrompt:",     ",todayDate:t=>`, ${t.date}`,todayDateSelected:t=>`,  ${t.date}`};var JN={};JN={dateRange:t=>`Od ${t.startDate} do ${t.endDate}`,dateSelected:t=>`Vybrat dtum ${t.date}`,finishRangeSelectionPrompt:"Kliknutm dokonte vber rozsahu dtumov",maximumDate:"Posledn dostupn dtum",minimumDate:"Prv dostupn dtum",next:"Nasledujce",previous:"Predchdzajce",selectedDateDescription:t=>`Vybrat dtum: ${t.date}`,selectedRangeDescription:t=>`Vybrat rozsah: ${t.dateRange}`,startRangeSelectionPrompt:"Kliknutm spustte vber rozsahu dtumov",todayDate:t=>`Dnes ${t.date}`,todayDateSelected:t=>`Vybrat dnen dtum ${t.date}`};var XN={};XN={dateRange:t=>`${t.startDate} do ${t.endDate}`,dateSelected:t=>`${t.date} izbrano`,finishRangeSelectionPrompt:"Kliknite za dokonanje izbire datumskega obsega",maximumDate:"Zadnji razpololjivi datum",minimumDate:"Prvi razpololjivi datum",next:"Naprej",previous:"Nazaj",selectedDateDescription:t=>`Izbrani datum: ${t.date}`,selectedRangeDescription:t=>`Izbrano obmoje: ${t.dateRange}`,startRangeSelectionPrompt:"Kliknite za zaetek izbire datumskega obsega",todayDate:t=>`Danes, ${t.date}`,todayDateSelected:t=>`Danes, ${t.date} izbrano`};var QN={};QN={dateRange:t=>`${t.startDate} do ${t.endDate}`,dateSelected:t=>`${t.date} izabran`,finishRangeSelectionPrompt:"Kliknite da dovrite opseg izabranih datuma",maximumDate:"Zadnji raspoloivi datum",minimumDate:"Prvi raspoloivi datum",next:"Sledei",previous:"Prethodni",selectedDateDescription:t=>`Izabrani datum: ${t.date}`,selectedRangeDescription:t=>`Izabrani period: ${t.dateRange}`,startRangeSelectionPrompt:"Kliknite da zaponete opseg izabranih datuma",todayDate:t=>`Danas, ${t.date}`,todayDateSelected:t=>`Danas, izabran ${t.date}`};var e8={};e8={dateRange:t=>`${t.startDate} till ${t.endDate}`,dateSelected:t=>`${t.date} har valts`,finishRangeSelectionPrompt:"Klicka fr att avsluta val av datumintervall",maximumDate:"Sista tillgngliga datum",minimumDate:"Frsta tillgngliga datum",next:"Nsta",previous:"Fregende",selectedDateDescription:t=>`Valt datum: ${t.date}`,selectedRangeDescription:t=>`Valt intervall: ${t.dateRange}`,startRangeSelectionPrompt:"Klicka fr att vlja datumintervall",todayDate:t=>`Idag, ${t.date}`,todayDateSelected:t=>`Idag, ${t.date} har valts`};var t8={};t8={dateRange:t=>`${t.startDate} - ${t.endDate}`,dateSelected:t=>`${t.date} seildi`,finishRangeSelectionPrompt:"Tarih aral seimini tamamlamak iin tklayn",maximumDate:"Son msait tarih",minimumDate:"lk msait tarih",next:"Sonraki",previous:"nceki",selectedDateDescription:t=>`Seilen Tarih: ${t.date}`,selectedRangeDescription:t=>`Seilen Aralk: ${t.dateRange}`,startRangeSelectionPrompt:"Tarih aral seimini balatmak iin tklayn",todayDate:t=>`Bugn, ${t.date}`,todayDateSelected:t=>`Bugn, ${t.date} seildi`};var r8={};r8={dateRange:t=>`${t.startDate}  ${t.endDate}`,dateSelected:t=>` ${t.date}`,finishRangeSelectionPrompt:",     ",maximumDate:"  ",minimumDate:"  ",next:"",previous:"",selectedDateDescription:t=>` : ${t.date}`,selectedRangeDescription:t=>` : ${t.dateRange}`,startRangeSelectionPrompt:",     ",todayDate:t=>`, ${t.date}`,todayDateSelected:t=>`,  ${t.date}`};var n8={};n8={dateRange:t=>`${t.startDate}  ${t.endDate}`,dateSelected:t=>` ${t.date}`,finishRangeSelectionPrompt:"",maximumDate:"",minimumDate:"",next:"",previous:"",selectedDateDescription:t=>`${t.date}`,selectedRangeDescription:t=>`${t.dateRange}`,startRangeSelectionPrompt:"",todayDate:t=>` ${t.date}`,todayDateSelected:t=>` ${t.date}`};var i8={};i8={dateRange:t=>`${t.startDate}  ${t.endDate}`,dateSelected:t=>` ${t.date}`,finishRangeSelectionPrompt:"",maximumDate:"",minimumDate:"",next:"",previous:"",selectedDateDescription:t=>`${t.date}`,selectedRangeDescription:t=>`${t.dateRange}`,startRangeSelectionPrompt:"",todayDate:t=>`${t.date}`,todayDateSelected:t=>`${t.date}`};var Fm={};Fm={"ar-AE":CN,"bg-BG":TN,"cs-CZ":DN,"da-DK":RN,"de-DE":MN,"el-GR":IN,"en-US":PN,"es-ES":AN,"et-EE":kN,"fi-FI":ON,"fr-FR":$N,"he-IL":LN,"hr-HR":BN,"hu-HU":NN,"it-IT":UN,"ja-JP":FN,"ko-KR":jN,"lt-LT":VN,"lv-LV":zN,"nb-NO":KN,"nl-NL":HN,"pl-PL":WN,"pt-BR":GN,"pt-PT":qN,"ro-RO":ZN,"ru-RU":YN,"sk-SK":JN,"sl-SI":XN,"sr-SP":QN,"sv-SE":e8,"tr-TR":t8,"uk-UA":r8,"zh-CN":n8,"zh-TW":i8};function a8(t){return t&&t.__esModule?t.default:t}const C4=new WeakMap;function zp(t){return(t==null?void 0:t.calendar.identifier)==="gregory"&&t.era==="BC"?"short":void 0}function jie(t){let e=Ra(a8(Fm),"@react-aria/calendar"),r,n;var i;"highlightedRange"in t?{start:r,end:n}=t.highlightedRange||{}:r=n=(i=t.value)!==null&&i!==void 0?i:void 0;let a=Si({weekday:"long",month:"long",year:"numeric",day:"numeric",era:zp(r)||zp(n),timeZone:t.timeZone}),o="anchorDate"in t?t.anchorDate:null;return D.useMemo(()=>{if(!o&&r&&n)if($r(r,n)){let s=a.format(r.toDate(t.timeZone));return e.format("selectedDateDescription",{date:s})}else{let s=j1(a,e,r,n,t.timeZone);return e.format("selectedRangeDescription",{dateRange:s})}return""},[r,n,o,t.timeZone,e,a])}function F1(t,e,r,n){let i=Ra(a8(Fm),"@react-aria/calendar"),a=zp(t)||zp(e),o=Si({month:"long",year:"numeric",era:a,calendar:t.calendar.identifier,timeZone:r}),s=Si({month:"long",year:"numeric",day:"numeric",era:a,calendar:t.calendar.identifier,timeZone:r});return D.useMemo(()=>{if($r(t,Tu(t))){if($r(e,Vy(t)))return o.format(t.toDate(r));if($r(e,Vy(e)))return n?j1(o,i,t,e,r):o.formatRange(t.toDate(r),e.toDate(r))}return n?j1(s,i,t,e,r):s.formatRange(t.toDate(r),e.toDate(r))},[t,e,o,s,i,r,n])}function j1(t,e,r,n,i){let a=t.formatRangeToParts(r.toDate(i),n.toDate(i)),o=-1;for(let c=0;c<a.length;c++){let d=a[c];if(d.source==="shared"&&d.type==="literal")o=c;else if(d.source==="endRange")break}let s="",l="";for(let c=0;c<a.length;c++)c<o?s+=a[c].value:c>o&&(l+=a[c].value);return e.format("dateRange",{startDate:s,endDate:l})}function Vie(t){return t&&t.__esModule?t.default:t}function zie(t,e){let r=Ra(Vie(Fm),"@react-aria/calendar"),n=ho(t),i=F1(e.visibleRange.start,e.visibleRange.end,e.timeZone,!1),a=F1(e.visibleRange.start,e.visibleRange.end,e.timeZone,!0);pM(()=>{e.isFocused||U1(a)},[a]);let o=jie(e);pM(()=>{o&&U1(o,"polite",4e3)},[o]);let s=nl([!!t.errorMessage,t.isInvalid,t.validationState]);C4.set(e,{ariaLabel:t["aria-label"],ariaLabelledBy:t["aria-labelledby"],errorMessageId:s,selectedDateDescription:o});let[l,c]=D.useState(!1),d=t.isDisabled||e.isNextVisibleRangeInvalid();d&&l&&(c(!1),e.setFocused(!0));let[h,p]=D.useState(!1),m=t.isDisabled||e.isPreviousVisibleRangeInvalid();m&&h&&(p(!1),e.setFocused(!0));let g=Om({id:t.id,"aria-label":[t["aria-label"],a].filter(Boolean).join(", "),"aria-labelledby":t["aria-labelledby"]});return{calendarProps:Oe(n,g,{role:"application","aria-describedby":t["aria-describedby"]||void 0}),nextButtonProps:{onPress:()=>e.focusNextPage(),"aria-label":r.format("next"),isDisabled:d,onFocusChange:c},prevButtonProps:{onPress:()=>e.focusPreviousPage(),"aria-label":r.format("previous"),isDisabled:m,onFocusChange:p},errorMessageProps:{id:s},title:i}}function Kie(t,e,r){let n=zie(t,e),i=D.useRef(!1),a=D.useRef(typeof window<"u"?window:null);return qa(a,"pointerdown",s=>{i.current=s.width===0&&s.height===0}),qa(a,"pointerup",s=>{if(i.current){i.current=!1;return}if(e.setDragging(!1),!e.anchorDate)return;let l=s.target;r.current&&r.current.contains(document.activeElement)&&(!r.current.contains(l)||!l.closest('button, [role="button"]'))&&e.selectFocusedDate()}),n.calendarProps.onBlur=s=>{r.current&&(!s.relatedTarget||!r.current.contains(s.relatedTarget))&&e.anchorDate&&e.selectFocusedDate()},qa(r,"touchmove",s=>{e.isDragging&&s.preventDefault()},{passive:!1,capture:!0}),n}function Hie(t,e){let{startDate:r=e.visibleRange.start,endDate:n=e.visibleRange.end,firstDayOfWeek:i}=t,{direction:a}=sn(),o=g=>{switch(g.key){case"Enter":case" ":g.preventDefault(),e.selectFocusedDate();break;case"PageUp":g.preventDefault(),g.stopPropagation(),e.focusPreviousSection(g.shiftKey);break;case"PageDown":g.preventDefault(),g.stopPropagation(),e.focusNextSection(g.shiftKey);break;case"End":g.preventDefault(),g.stopPropagation(),e.focusSectionEnd();break;case"Home":g.preventDefault(),g.stopPropagation(),e.focusSectionStart();break;case"ArrowLeft":g.preventDefault(),g.stopPropagation(),a==="rtl"?e.focusNextDay():e.focusPreviousDay();break;case"ArrowUp":g.preventDefault(),g.stopPropagation(),e.focusPreviousRow();break;case"ArrowRight":g.preventDefault(),g.stopPropagation(),a==="rtl"?e.focusPreviousDay():e.focusNextDay();break;case"ArrowDown":g.preventDefault(),g.stopPropagation(),e.focusNextRow();break;case"Escape":"setAnchorDate"in e&&(g.preventDefault(),e.setAnchorDate(null));break}},s=F1(r,n,e.timeZone,!0),{ariaLabel:l,ariaLabelledBy:c}=C4.get(e),d=Om({"aria-label":[l,s].filter(Boolean).join(", "),"aria-labelledby":c}),h=Si({weekday:t.weekdayStyle||"narrow",timeZone:e.timeZone}),{locale:p}=sn(),m=D.useMemo(()=>{let g=Pp(fb(e.timeZone),p,i);return[...new Array(7).keys()].map(y=>{let b=g.add({days:y}).toDate(e.timeZone);return h.format(b)})},[p,e.timeZone,h,i]);return{gridProps:Oe(d,{role:"grid","aria-readonly":e.isReadOnly||void 0,"aria-disabled":e.isDisabled||void 0,"aria-multiselectable":"highlightedRange"in e||void 0,onKeyDown:o,onFocus:()=>e.setFocused(!0),onBlur:()=>e.setFocused(!1)}),headerProps:{"aria-hidden":!0},weekDays:m}}function Wie(t){return t&&t.__esModule?t.default:t}function Gie(t,e,r){let{date:n,isDisabled:i}=t,{errorMessageId:a,selectedDateDescription:o}=C4.get(e),s=Ra(Wie(Fm),"@react-aria/calendar"),l=Si({weekday:"long",day:"numeric",month:"long",year:"numeric",era:zp(n),timeZone:e.timeZone}),c=e.isSelected(n),d=e.isCellFocused(n);i=i||e.isCellDisabled(n);let h=e.isCellUnavailable(n),p=!i&&!h,m=e.isValueInvalid&&!!("highlightedRange"in e?!e.anchorDate&&e.highlightedRange&&n.compare(e.highlightedRange.start)>=0&&n.compare(e.highlightedRange.end)<=0:e.value&&$r(e.value,n));m&&(c=!0),n=J6(n,jE);let g=D.useMemo(()=>n.toDate(e.timeZone),[n,e.timeZone]),y=o6(n,e.timeZone),R=D.useMemo(()=>{let j="";return"highlightedRange"in e&&e.value&&!e.anchorDate&&($r(n,e.value.start)||$r(n,e.value.end))&&(j=o+", "),j+=l.format(g),y?j=s.format(c?"todayDateSelected":"todayDate",{date:j}):c&&(j=s.format("dateSelected",{date:j})),e.minValue&&$r(n,e.minValue)?j+=", "+s.format("minimumDate"):e.maxValue&&$r(n,e.maxValue)&&(j+=", "+s.format("maximumDate")),j},[l,g,s,c,y,n,e,o]),b="";"anchorDate"in e&&d&&!e.isReadOnly&&p&&(e.anchorDate?b=s.format("finishRangeSelectionPrompt"):b=s.format("startRangeSelectionPrompt"));let _=_b(b),x=D.useRef(!1),T=D.useRef(!1),I=D.useRef(void 0),{pressProps:C,isPressed:k}=is({shouldCancelOnPointerExit:"anchorDate"in e&&!!e.anchorDate,preventFocusOnPress:!0,isDisabled:!p||e.isReadOnly,onPressStart(j){if(e.isReadOnly){e.setFocusedDate(n);return}if("highlightedRange"in e&&!e.anchorDate&&(j.pointerType==="mouse"||j.pointerType==="touch")){if(e.highlightedRange&&!m){if($r(n,e.highlightedRange.start)){e.setAnchorDate(e.highlightedRange.end),e.setFocusedDate(n),e.setDragging(!0),T.current=!0;return}else if($r(n,e.highlightedRange.end)){e.setAnchorDate(e.highlightedRange.start),e.setFocusedDate(n),e.setDragging(!0),T.current=!0;return}}let J=()=>{e.setDragging(!0),I.current=void 0,e.selectDate(n),e.setFocusedDate(n),x.current=!0};j.pointerType==="touch"?I.current=setTimeout(J,200):J()}},onPressEnd(){T.current=!1,x.current=!1,clearTimeout(I.current),I.current=void 0},onPress(){!("anchorDate"in e)&&!e.isReadOnly&&(e.selectDate(n),e.setFocusedDate(n))},onPressUp(j){if(!e.isReadOnly&&("anchorDate"in e&&I.current&&(e.selectDate(n),e.setFocusedDate(n)),"anchorDate"in e))if(T.current)e.setAnchorDate(n);else if(e.anchorDate&&!x.current)e.selectDate(n),e.setFocusedDate(n);else if(j.pointerType==="keyboard"&&!e.anchorDate){e.selectDate(n);let J=n.add({days:1});e.isInvalid(J)&&(J=n.subtract({days:1})),e.isInvalid(J)||e.setFocusedDate(J)}else j.pointerType==="virtual"&&(e.selectDate(n),e.setFocusedDate(n))}}),S;i||(S=$r(n,e.focusedDate)?0:-1),D.useEffect(()=>{d&&r.current&&(wn(r.current),il()!=="pointer"&&document.activeElement===r.current&&Zy(r.current,{containingElement:bb(r.current)}))},[d,r]);let V=Si({day:"numeric",timeZone:e.timeZone,calendar:n.calendar.identifier}),z=D.useMemo(()=>V.formatToParts(g).find(j=>j.type==="day").value,[V,g]);return{cellProps:{role:"gridcell","aria-disabled":!p||void 0,"aria-selected":c||void 0,"aria-invalid":m||void 0},buttonProps:Oe(C,{onFocus(){i||e.setFocusedDate(n)},tabIndex:S,role:"button","aria-disabled":!p||void 0,"aria-label":R,"aria-invalid":m||void 0,"aria-describedby":[m?a:void 0,_["aria-describedby"]].filter(Boolean).join(" ")||void 0,onPointerEnter(j){"highlightDate"in e&&(j.pointerType!=="touch"||e.isDragging)&&p&&e.highlightDate(n)},onPointerDown(j){"releasePointerCapture"in j.target&&j.target.releasePointerCapture(j.pointerId)},onContextMenu(j){j.preventDefault()}}),isPressed:k,isFocused:d,isSelected:c,isDisabled:i,isUnavailable:h,isOutsideVisibleRange:n.compare(e.visibleRange.start)<0||n.compare(e.visibleRange.end)>0,isInvalid:m,formattedDate:z}}function md(t,e,r){return e!=null&&t.compare(e)<0||r!=null&&t.compare(r)>0}function V1(t,e,r,n,i){let a={};for(let s in e)a[s]=Math.floor(e[s]/2),a[s]>0&&e[s]%2===0&&a[s]--;let o=au(t,e,r).subtract(a);return Kp(t,o,e,r,n,i)}function au(t,e,r,n,i){let a=t;return e.years?a=zy(t):e.months?a=Tu(t):e.weeks&&(a=Pp(t,r)),Kp(t,a,e,r,n,i)}function z1(t,e,r,n,i){let a={...e};a.days?a.days--:a.weeks?a.weeks--:a.months?a.months--:a.years&&a.years--;let o=au(t,e,r).subtract(a);return Kp(t,o,e,r,n,i)}function Kp(t,e,r,n,i,a){if(i&&t.compare(i)>=0){let o=gT(e,au(Qn(i),r,n));o&&(e=o)}if(a&&t.compare(a)<=0){let o=vT(e,z1(Qn(a),r,n));o&&(e=o)}return e}function Es(t,e,r){if(e){let n=gT(t,Qn(e));n&&(t=n)}if(r){let n=vT(t,Qn(r));n&&(t=n)}return t}function o8(t,e,r){if(!r)return t;for(;t.compare(e)>=0&&r(t);)t=t.subtract({days:1});return t.compare(e)>=0?t:null}function qie(t){let e=D.useMemo(()=>new ba(t.locale),[t.locale]),r=D.useMemo(()=>e.resolvedOptions(),[e]),{locale:n,createCalendar:i,visibleDuration:a={months:1},minValue:o,maxValue:s,selectionAlignment:l,isDateUnavailable:c,pageBehavior:d="visible",firstDayOfWeek:h}=t,p=D.useMemo(()=>i(r.calendar),[i,r.calendar]);var m;let[g,y]=Pi(t.value,(m=t.defaultValue)!==null&&m!==void 0?m:null,t.onChange),R=D.useMemo(()=>g?lr(Qn(g),p):null,[g,p]),b=D.useMemo(()=>g&&"timeZone"in g?g.timeZone:r.timeZone,[g,r.timeZone]),_=D.useMemo(()=>t.focusedValue?Es(lr(Qn(t.focusedValue),p),o,s):void 0,[t.focusedValue,p,o,s]),x=D.useMemo(()=>Es(t.defaultFocusedValue?lr(Qn(t.defaultFocusedValue),p):R||lr(fb(b),p),o,s),[t.defaultFocusedValue,R,b,p,o,s]),[T,I]=Pi(_,x,t.onFocusChange),[C,k]=D.useState(()=>{switch(l){case"start":return au(T,a,n,o,s);case"end":return z1(T,a,n,o,s);case"center":default:return V1(T,a,n,o,s)}}),[S,V]=D.useState(t.autoFocus||!1),z=D.useMemo(()=>{let he={...a};return he.days?he.days--:he.days=-1,C.add(he)},[C,a]),[j,J]=D.useState(p.identifier);if(p.identifier!==j){let he=lr(T,p);k(V1(he,a,n,o,s)),I(he),J(p.identifier)}md(T,o,s)?I(Es(T,o,s)):T.compare(C)<0?k(z1(T,a,n,o,s)):T.compare(z)>0&&k(au(T,a,n,o,s));function $(he){he=Es(he,o,s),I(he)}function le(he){if(!t.isDisabled&&!t.isReadOnly){let oe=he;if(oe===null){y(null);return}if(oe=Es(oe,o,s),oe=o8(oe,C,c),!oe)return;oe=lr(oe,(g==null?void 0:g.calendar)||new Nn),g&&"hour"in g?y(g.set(oe)):y(oe)}}let ie=D.useMemo(()=>R?c&&c(R)?!0:md(R,o,s):!1,[R,c,o,s]),Z=t.isInvalid||t.validationState==="invalid"||ie,te=Z?"invalid":null,H=D.useMemo(()=>d==="visible"?a:QS(a),[d,a]);var fe,ne;return{isDisabled:(fe=t.isDisabled)!==null&&fe!==void 0?fe:!1,isReadOnly:(ne=t.isReadOnly)!==null&&ne!==void 0?ne:!1,value:R,setValue:le,visibleRange:{start:C,end:z},minValue:o,maxValue:s,focusedDate:T,timeZone:b,validationState:te,isValueInvalid:Z,setFocusedDate(he){$(he),V(!0)},focusNextDay(){$(T.add({days:1}))},focusPreviousDay(){$(T.subtract({days:1}))},focusNextRow(){a.days?this.focusNextPage():(a.weeks||a.months||a.years)&&$(T.add({weeks:1}))},focusPreviousRow(){a.days?this.focusPreviousPage():(a.weeks||a.months||a.years)&&$(T.subtract({weeks:1}))},focusNextPage(){let he=C.add(H);I(Es(T.add(H),o,s)),k(au(Kp(T,he,H,n,o,s),H,n))},focusPreviousPage(){let he=C.subtract(H);I(Es(T.subtract(H),o,s)),k(au(Kp(T,he,H,n,o,s),H,n))},focusSectionStart(){a.days?$(C):a.weeks?$(Pp(T,n)):(a.months||a.years)&&$(Tu(T))},focusSectionEnd(){a.days?$(z):a.weeks?$(Dq(T,n)):(a.months||a.years)&&$(Vy(T))},focusNextSection(he){if(!he&&!a.days){$(T.add(QS(a)));return}a.days?this.focusNextPage():a.weeks?$(T.add({months:1})):(a.months||a.years)&&$(T.add({years:1}))},focusPreviousSection(he){if(!he&&!a.days){$(T.subtract(QS(a)));return}a.days?this.focusPreviousPage():a.weeks?$(T.subtract({months:1})):(a.months||a.years)&&$(T.subtract({years:1}))},selectFocusedDate(){c&&c(T)||le(T)},selectDate(he){le(he)},isFocused:S,setFocused:V,isInvalid(he){return md(he,o,s)},isSelected(he){return R!=null&&$r(he,R)&&!this.isCellDisabled(he)&&!this.isCellUnavailable(he)},isCellFocused(he){return S&&T&&$r(he,T)},isCellDisabled(he){return t.isDisabled||he.compare(C)<0||he.compare(z)>0||this.isInvalid(he)},isCellUnavailable(he){return t.isDateUnavailable?t.isDateUnavailable(he):!1},isPreviousVisibleRangeInvalid(){let he=C.subtract({days:1});return $r(he,C)||this.isInvalid(he)},isNextVisibleRangeInvalid(){let he=z.add({days:1});return $r(he,z)||this.isInvalid(he)},getDatesInWeek(he,oe=C){let me=oe.add({weeks:he}),ee=[];me=Pp(me,n,h);let Y=db(me,n,h);for(let q=0;q<Y;q++)ee.push(null);for(;ee.length<7;){ee.push(me);let q=me.add({days:1});if($r(me,q))break;me=q}for(;ee.length<7;)ee.push(null);return ee}}}function QS(t){let e={...t};for(let r in t)e[r]=1;return e}function Zie(t){let{value:e,defaultValue:r,onChange:n,createCalendar:i,locale:a,visibleDuration:o={months:1},minValue:s,maxValue:l,...c}=t,[d,h]=Pi(e,r||null,n),[p,m]=D.useState(null),g="center";if(d&&d.start&&d.end){let H=V1(Qn(d.start),o,a,s,l).add(o).subtract({days:1});d.end.compare(H)>0&&(g="start")}let y=D.useRef(null),[R,b]=D.useState(null),_=D.useMemo(()=>gT(s,R==null?void 0:R.start),[s,R]),x=D.useMemo(()=>vT(l,R==null?void 0:R.end),[l,R]),T=qie({...c,value:d&&d.start,createCalendar:i,locale:a,visibleDuration:o,minValue:_,maxValue:x,selectionAlignment:g}),I=te=>{if(te&&t.isDateUnavailable&&!t.allowsNonContiguousRanges){const H=gP(te,T,-1),fe=gP(te,T,1);y.current={start:H,end:fe},b(y.current)}else y.current=null,b(null)},[C,k]=D.useState(T.visibleRange);(!jE(T.visibleRange.start,C.start)||!jE(T.visibleRange.end,C.end))&&(I(p),k(T.visibleRange));let S=te=>{te?(m(te),I(te)):(m(null),I(null))},V=p?ew(p,T.focusedDate):d&&ew(d.start,d.end),z=te=>{if(t.isReadOnly)return;const H=Es(te,_,x),fe=o8(H,T.visibleRange.start,t.isDateUnavailable);if(fe)if(!p)S(fe);else{let ne=ew(p,fe);ne&&h({start:vP(ne.start,d==null?void 0:d.start),end:vP(ne.end,d==null?void 0:d.end)}),S(null)}},[j,J]=D.useState(!1),{isDateUnavailable:$}=t,le=D.useMemo(()=>!d||p?!1:$&&($(d.start)||$(d.end))?!0:md(d.start,s,l)||md(d.end,s,l),[$,d,p,s,l]),ie=t.isInvalid||t.validationState==="invalid"||le;return{...T,value:d,setValue:h,anchorDate:p,setAnchorDate:S,highlightedRange:V,validationState:ie?"invalid":null,isValueInvalid:ie,selectFocusedDate(){z(T.focusedDate)},selectDate:z,highlightDate(te){p&&T.setFocusedDate(te)},isSelected(te){return!!(V&&te.compare(V.start)>=0&&te.compare(V.end)<=0&&!T.isCellDisabled(te)&&!T.isCellUnavailable(te))},isInvalid(te){var H,fe;return T.isInvalid(te)||md(te,(H=y.current)===null||H===void 0?void 0:H.start,(fe=y.current)===null||fe===void 0?void 0:fe.end)},isDragging:j,setDragging:J}}function ew(t,e){return!t||!e?null:(e.compare(t)<0&&([t,e]=[e,t]),{start:Qn(t),end:Qn(e)})}function vP(t,e){return t=lr(t,(e==null?void 0:e.calendar)||new Nn),e&&"hour"in e?e.set(t):t}function gP(t,e,r){let n=t.add({days:r});for(;(r<0?n.compare(e.visibleRange.start)>=0:n.compare(e.visibleRange.end)<=0)&&!e.isCellUnavailable(n);)n=n.add({days:r});if(e.isCellUnavailable(n))return n.add({days:-r})}var Yie=t=>O.jsx("svg",{"aria-hidden":"true",fill:"none",focusable:"false",height:"1em",role:"presentation",viewBox:"0 0 16 16",width:"1em",...t,children:O.jsx("path",{d:"M10 3.33334L6 8.00001L10 12.6667",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5"})}),Jie=t=>O.jsx("svg",{"aria-hidden":"true",fill:"none",focusable:"false",height:"1em",role:"presentation",viewBox:"0 0 16 16",width:"1em",...t,children:O.jsx("path",{d:"M6 3.33334L10 8.00001L6 12.6667",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5"})}),Xie=t=>O.jsx("svg",{"aria-hidden":"true",fill:"none",focusable:"false",height:"1em",role:"presentation",viewBox:"0 0 24 24",width:"1em",...t,children:O.jsx("path",{d:"M19 9L12 15L5 9",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5"})}),[Qie,Ab]=Sl({name:"CalendarContext",strict:!0,errorMessage:"useContext: `context` is undefined. Seems you forgot to wrap component within the CalendarProvider"}),eae={type:"spring",bounce:0,duration:.3},s8={enter:t=>({x:`${t*100}%`}),center:{x:"0%"},exit:t=>({x:`${t*-100}%`})};function tae(t){const{direction:e,date:r,currentMonth:n,buttonPickerProps:i}=t,{state:a,slots:o,headerRef:s,showMonthAndYearPickers:l,isHeaderExpanded:c,setIsHeaderExpanded:d,disableAnimation:h,classNames:p}=Ab(),g=Si({month:"long",era:n.calendar.identifier==="gregory"&&n.era==="BC"?"short":void 0,calendar:n.calendar.identifier,timeZone:a.timeZone,year:"numeric"}).format(r.toDate(a.timeZone)),y=O.jsx(O.Fragment,{children:h?O.jsx("span",{"aria-hidden":!0,className:o==null?void 0:o.title({class:p==null?void 0:p.title}),"data-slot":"title",children:g},n.month):O.jsx(Ai.span,{animate:"center","aria-hidden":!0,className:o==null?void 0:o.title({class:p==null?void 0:p.title}),custom:e,"data-slot":"title",exit:"exit",initial:"enter",variants:c?{}:s8,children:g},n.month)}),R={ref:s,className:o==null?void 0:o.header({class:p==null?void 0:p.header}),"data-slot":"header"},b=D.useCallback(_=>{_.key==="Escape"&&(_.preventDefault(),_.stopPropagation(),d==null||d(!1))},[d]);return l?O.jsx(An,{...R,"aria-label":"switch to year and month view",disableAnimation:h,endContent:O.jsx(Xie,{className:"chevron-icon"}),onKeyDown:b,...i,children:y}):O.jsx("header",{...R,children:y})}function rae(t){const{state:e,slots:r,isPickerVisible:n,currentMonth:i,classNames:a,firstDayOfWeek:o,...s}=t,l=D.useRef(null),{cellProps:c,buttonProps:d,isPressed:h,isSelected:p,isDisabled:m,isFocused:g,isInvalid:y,formattedDate:R}=Gie({...s,isDisabled:!FR(s.date,i)||n},e,l),b=e.isCellUnavailable(s.date),_=!m&&!y&&e.isCellUnavailable(s.date.add({days:1})),x=!m&&!y&&e.isCellUnavailable(s.date.subtract({days:1})),T="highlightedRange"in e&&e.highlightedRange,I=p&&T?$r(s.date,T.start):!1,C=p&&T?$r(s.date,T.end):!1,{locale:k}=sn(),S=db(s.date,k,o),V=p&&(x||S===0||s.date.day===1),z=p&&(_||S===6||s.date.day===i.calendar.getDaysInMonth(i)),{focusProps:j,isFocusVisible:J}=io(),{hoverProps:$,isHovered:le}=aa({isDisabled:m||b||e.isReadOnly});return O.jsx("td",{className:r==null?void 0:r.cell({class:a==null?void 0:a.cell}),"data-slot":"cell",...c,children:O.jsx("span",{...Oe(d,$,j),ref:l,className:r==null?void 0:r.cellButton({class:a==null?void 0:a.cellButton}),"data-disabled":Te(m&&!y),"data-focus-visible":Te(g&&J),"data-hover":Te(le),"data-invalid":Te(y),"data-outside-month":Te(!FR(s.date,i)),"data-pressed":Te(h&&!e.isReadOnly),"data-range-end":Te(z),"data-range-selection":Te(p&&"highlightedRange"in e),"data-range-start":Te(V),"data-readonly":Te(e.isReadOnly),"data-selected":Te(p),"data-selection-end":Te(C),"data-selection-start":Te(I),"data-today":Te(o6(s.date,e.timeZone)),"data-unavailable":Te(b),children:O.jsx("span",{children:R})})})}function nae(t){const{startDate:e,direction:r,currentMonth:n,firstDayOfWeek:i}=t,{locale:a}=sn(),o=Iq(e,a,i),{state:s,slots:l,weekdayStyle:c,isHeaderExpanded:d,disableAnimation:h,classNames:p}=Ab(),{gridProps:m,headerProps:g,weekDays:y}=Hie({...t,weekdayStyle:c,endDate:Vy(e),firstDayOfWeek:i},s),R=[...new Array(o).keys()].map(b=>O.jsx("tr",{className:l==null?void 0:l.gridBodyRow({class:p==null?void 0:p.gridBodyRow}),"data-slot":"grid-body-row",inert:A6(!!d),children:s.getDatesInWeek(b,e).map((_,x)=>_?O.jsx(rae,{classNames:p,currentMonth:e,date:_,firstDayOfWeek:i,isPickerVisible:d,slots:l,state:s},x):O.jsx("td",{},x))},b));return O.jsxs("table",{...m,"aria-hidden":Te(d),className:l==null?void 0:l.grid({class:p==null?void 0:p.grid}),"data-slot":"grid",tabIndex:-1,children:[O.jsx("thead",{...g,className:l==null?void 0:l.gridHeader({class:p==null?void 0:p.gridHeader}),"data-slot":"grid-header",children:O.jsx("tr",{className:l==null?void 0:l.gridHeaderRow({class:p==null?void 0:p.gridHeaderRow}),"data-slot":"grid-header-row",children:y.map((b,_)=>O.jsx("th",{className:l==null?void 0:l.gridHeaderCell({class:p==null?void 0:p.gridHeaderCell}),"data-slot":"grid-header-cell",children:O.jsx("span",{children:b})},_))})}),h?O.jsx("tbody",{className:l==null?void 0:l.gridBody({class:p==null?void 0:p.gridBody}),"data-slot":"grid-body",tabIndex:d?-1:0,children:R},n):O.jsx(Ai.tbody,{animate:"center",className:l==null?void 0:l.gridBody({class:p==null?void 0:p.gridBody}),custom:r,"data-slot":"grid-body",exit:"exit",initial:"enter",variants:s8,children:R},n)]})}function iae(t,e){const r=[];if(!t||!e)return r;let n=zy(t);for(;n.compare(e)<=0;)r.push(n),n=zy(n.add({years:1}));return r}function aae(t,e){return t.add({months:e})}function oae(t){const r=[zy(t)];for(;r.length<12;){const n=r[r.length-1];r.push(aae(n,1))}return r}var yP=200;function sae(t){var e;const{date:r,currentMonth:n}=t,{slots:i,state:a,headerRef:o,isHeaderExpanded:s,setIsHeaderExpanded:l,classNames:c}=Ab(),d=D.useRef(null),h=D.useRef(null),p=D.useRef(null),m=D.useRef(),g=D.useRef(),y=Si({month:"long",era:n.calendar.identifier==="gregory"&&n.era==="BC"?"short":void 0,calendar:n.calendar.identifier,timeZone:a.timeZone}),R=Si({year:"numeric",timeZone:a.timeZone}),b=(e=iae(a.minValue,a.maxValue))==null?void 0:e.map(V=>({value:V.year,label:R.format(V.toDate(a.timeZone))})),_=oae(r).map(V=>({value:V.month,label:y.format(V.toDate(a.timeZone))}));function x(V){return V.current||(V.current=new Map),V.current}function T(V,z,j){const J=x(j==="months"?m:g);V?J.set(z,V):J.delete(z)}const I=D.useCallback((V,z,j)=>{if(!(V.target instanceof HTMLElement))return;const J=x(j==="months"?m:g),le=Array.from(J.values()).find(te=>{const H=te.getBoundingClientRect(),fe=z==null?void 0:z.getBoundingClientRect();return fe?vZ(H,fe):!1}),ie=Number(le==null?void 0:le.getAttribute("data-value"));if(!ie)return;let Z=a.focusedDate.set(j==="months"?{month:ie}:{year:ie});a.setFocusedDate(Z)},[a,s]);D.useEffect(()=>{s&&(C(r.month,"months",!1),C(r.year,"years",!1))},[s]),D.useEffect(()=>{const V=p.current,z=h.current,j=d.current;if(!j)return;const J=oM(le=>I(le,j,"months"),yP),$=oM(le=>I(le,j,"years"),yP);return V==null||V.addEventListener("scroll",J),z==null||z.addEventListener("scroll",$),()=>{J&&(V==null||V.removeEventListener("scroll",J)),$&&(z==null||z.removeEventListener("scroll",$))}},[I]);function C(V,z,j=!0){const J=z==="months"?m:g,$=z==="months"?p:h,ie=x(J).get(V);ie&&Lne(ie,{scrollMode:"always",behavior:j?"smooth":"auto",boundary:$.current})}const k=D.useCallback((V,z)=>{const j=V.target,J=Number(j.getAttribute("data-value"));J&&C(J,z)},[a]),S=D.useCallback((V,z,j)=>{var J;const $=x(j==="months"?m:g);if(!$.get(z))return;let ie=z;switch(V.key){case"ArrowDown":ie=z+1;break;case"ArrowUp":ie=z-1;break;case"Home":ie=0;break;case"End":ie=_.length-1;break;case"PageUp":ie=z-3;break;case"PageDown":ie=z+3;break;case"Escape":case"Enter":case" ":l==null||l(!1),(J=o==null?void 0:o.current)==null||J.focus();return}const Z=$.get(ie);Z==null||Z.focus()},[a]);return{state:a,slots:i,classNames:c,years:b,months:_,highlightRef:d,monthsListRef:p,yearsListRef:h,getItemRef:T,isHeaderExpanded:s,onPickerItemPressed:k,onPickerItemKeyDown:S}}var K1=D.forwardRef(({children:t,autoFocus:e,isDisabled:r,onKeyDown:n,...i},a)=>{const o=fr(a),{buttonProps:s,isPressed:l}=Um({elementType:"button",isDisabled:r,onKeyDown:n,...i},o),{isFocusVisible:c,isFocused:d,focusProps:h}=io({autoFocus:e}),{isHovered:p,hoverProps:m}=aa({isDisabled:r});return O.jsx("button",{ref:o,"data-disabled":Te(r),"data-focus":Te(d),"data-focus-visible":Te(c),"data-hover":Te(p),"data-pressed":Te(l),"data-slot":"picker-item",...Oe(h,m,s,Mi(i,{enabled:!0})),children:t})});K1.displayName="CalendarPickerItem";var bP=3;function lae(t){const{state:e,slots:r,months:n,years:i,highlightRef:a,monthsListRef:o,yearsListRef:s,classNames:l,getItemRef:c,isHeaderExpanded:d,onPickerItemPressed:h,onPickerItemKeyDown:p}=sae(t),m=D.useCallback(y=>O.jsx("div",{"aria-hidden":"true",className:r==null?void 0:r.pickerItem({class:l==null?void 0:l.pickerItem}),"data-slot":"picker-item-empty",tabIndex:-1,...y,children:""}),[r,l==null?void 0:l.pickerItem]),g=D.useCallback(({children:y})=>O.jsxs(O.Fragment,{children:[Array.from({length:bP},(R,b)=>O.jsx(m,{},b)),y,Array.from({length:bP},(R,b)=>O.jsx(m,{},b))]}),[m]);return O.jsxs("div",{className:r==null?void 0:r.pickerWrapper({class:l==null?void 0:l.pickerWrapper}),"data-slot":"picker-wrapper",inert:A6(!d),children:[O.jsx("div",{ref:a,className:r==null?void 0:r.pickerHighlight({class:l==null?void 0:l.pickerHighlight}),"data-slot":"picker-highlight"}),O.jsx("div",{ref:o,className:r==null?void 0:r.pickerMonthList({class:l==null?void 0:l.pickerMonthList}),"data-slot":"picker-month-list",children:O.jsx(g,{children:n.map(y=>{var R;return O.jsx(K1,{ref:b=>c(b,y.value,"months"),className:r==null?void 0:r.pickerItem({class:l==null?void 0:l.pickerItem}),"data-value":y.value,tabIndex:!d||((R=e.focusedDate)==null?void 0:R.month)!==y.value?-1:0,onKeyDown:b=>p(b,y.value,"months"),onPress:b=>h(b,"months"),children:y.label},`picker-month-${y.value}`)})})}),O.jsx("div",{ref:s,className:r==null?void 0:r.pickerYearList({class:l==null?void 0:l.pickerYearList}),"data-slot":"picker-year-list",children:O.jsx(g,{children:i.map(y=>{var R;return O.jsx(K1,{ref:b=>c(b,y.value,"years"),className:r==null?void 0:r.pickerItem({class:l==null?void 0:l.pickerItem}),"data-value":y.value,tabIndex:!d||((R=e.focusedDate)==null?void 0:R.year)!==y.value?-1:0,onKeyDown:b=>p(b,y.value,"years"),onPress:b=>h(b,"years"),children:y.label},`picker-year-${y.value}`)})})})]})}var uae=()=>El(()=>import("./index-BeaB_b6p.js"),[]).then(t=>t.default),l8=D.forwardRef((t,e)=>O.jsx("div",{ref:e,...t}));l8.displayName="HeroUI - PopLayoutWrapper";function cae(t){const{Component:e="div",showHelper:r,topContent:n,bottomContent:i,calendarProps:a,nextButtonProps:o,prevButtonProps:s,buttonPickerProps:l,errorMessageProps:c,calendarRef:d,errorMessage:h,firstDayOfWeek:p,...m}=t,{state:g,slots:y,visibleMonths:R,showMonthAndYearPickers:b,disableAnimation:_,classNames:x}=Ab(),[T,I]=D.useState(0),{direction:C}=sn(),k=g.visibleRange.start,S=[],V=[],z=C==="rtl";for(let J=0;J<R;J++){let $=k.add({months:J});S.push(O.jsxs(D.Fragment,{children:[J===0&&O.jsx(An,{...z?o:s,onPress:Tn(z?o.onPress:s.onPress,()=>I(-1)),children:O.jsx(Yie,{})}),O.jsx(tae,{buttonPickerProps:l,currentMonth:k,date:$,direction:T}),J===R-1&&O.jsx(An,{...z?s:o,onPress:Tn(z?s.onPress:o.onPress,()=>I(1)),children:O.jsx(Jie,{})})]},`calendar-header-${J}`));const le=D.createElement(nae,{...t,key:`calendar-month-${J}`,currentMonth:k.month,direction:T,firstDayOfWeek:p,startDate:$});V.push(b?O.jsxs(D.Fragment,{children:[le,O.jsx(lae,{currentMonth:k,date:$})]},`calendar-month-with-pickers-${J}`):le)}const j=O.jsxs(O.Fragment,{children:[O.jsx("div",{className:y==null?void 0:y.headerWrapper({class:x==null?void 0:x.headerWrapper}),"data-slot":"header-wrapper",children:S},"header-wrapper"),O.jsx("div",{className:y==null?void 0:y.gridWrapper({class:x==null?void 0:x.gridWrapper}),"data-slot":"grid-wrapper",children:V},"grid-wrapper")]});return O.jsxs(e,{...Oe(a,m),ref:d,children:[n,O.jsx(u1,{children:O.jsx("h2",{children:a["aria-label"]})}),_?O.jsx("div",{className:y==null?void 0:y.content({class:x==null?void 0:x.content}),"data-slot":"content",children:j}):O.jsx(zB,{className:y==null?void 0:y.content({class:x==null?void 0:x.content}),"data-slot":"content",children:O.jsx(Gu,{custom:T,initial:!1,mode:"popLayout",children:O.jsx(l8,{children:O.jsx(nB,{transition:eae,children:O.jsx(Ca,{features:uae,children:j})})})})}),O.jsx(u1,{children:O.jsx("button",{"aria-label":o["aria-label"],disabled:o.isDisabled,tabIndex:-1,onClick:()=>g.focusNextPage()})}),g.isValueInvalid&&r&&O.jsx("div",{className:y==null?void 0:y.helperWrapper({class:x==null?void 0:x.helperWrapper}),"data-slot":"helper-wrapper",children:O.jsx("span",{...c,className:y==null?void 0:y.errorMessage({class:x==null?void 0:x.errorMessage}),"data-slot":"error-message",children:h||"Selected date unavailable."})}),i]})}function dae({buttonPickerProps:t,className:e,...r}){const{Component:n,slots:i,children:a,domRef:o,locale:s,showHelper:l,firstDayOfWeek:c,minValue:d,maxValue:h,weekdayStyle:p,visibleDuration:m,shouldFilterDOMProps:g,isHeaderExpanded:y,visibleMonths:R,disableAnimation:b,createCalendar:_,showMonthAndYearPickers:x,baseProps:T,getPrevButtonProps:I,getNextButtonProps:C,getErrorMessageProps:k,setIsHeaderExpanded:S,topContent:V,bottomContent:z,errorMessage:j,classNames:J,otherProps:$}=Fie({...r,isRange:!0}),le=D.useRef(null),ie=Zie({...r,locale:s,minValue:d,maxValue:h,visibleDuration:m,createCalendar:!_||typeof _!="function"?TT:_}),{title:Z,calendarProps:te,prevButtonProps:H,nextButtonProps:fe,errorMessageProps:ne}=Kie(r,ie,o),he=qe(J==null?void 0:J.base,e),oe={...t,onPress:Tn(t==null?void 0:t.onPress,()=>S(!y))},me=(Y={})=>({...T,Component:n,showHelper:l,firstDayOfWeek:c,topContent:V,bottomContent:z,buttonPickerProps:oe,calendarRef:o,calendarProps:te,prevButtonProps:I(H),nextButtonProps:C(fe),errorMessageProps:k(ne),className:i.base({class:he}),errorMessage:j,...Mi($,{enabled:g}),...Y}),ee=D.useMemo(()=>({state:ie,slots:i,headerRef:le,weekdayStyle:p,isHeaderExpanded:y,setIsHeaderExpanded:S,visibleMonths:R,showMonthAndYearPickers:x,classNames:J,disableAnimation:b}),[ie,i,J,p,y,S,R,b,x]);return{Component:n,children:a,domRef:o,context:ee,state:ie,slots:i,title:Z,classNames:J,getBaseCalendarProps:me}}var fae=Qt(function(e,r){const{context:n,getBaseCalendarProps:i}=dae({...e,ref:r});return O.jsx(Qie,{value:n,children:O.jsx(cae,{...i()})})}),hae=fae,u8={};u8={calendar:"",day:"",dayPeriod:"/",endDate:" ",era:"",hour:"",minute:"",month:"",second:"",selectedDateDescription:t=>` : ${t.date}`,selectedRangeDescription:t=>`  : ${t.startDate}  ${t.endDate}`,selectedTimeDescription:t=>` : ${t.time}`,startDate:" ",timeZoneName:"",weekday:"",year:""};var c8={};c8={calendar:"",day:"",dayPeriod:"../..",endDate:" ",era:"",hour:"",minute:"",month:"",second:"",selectedDateDescription:t=>` : ${t.date}`,selectedRangeDescription:t=>` : ${t.startDate}  ${t.endDate}`,selectedTimeDescription:t=>` : ${t.time}`,startDate:" ",timeZoneName:" ",weekday:"  ",year:""};var d8={};d8={calendar:"Kalend",day:"den",dayPeriod:"st dne",endDate:"Konen datum",era:"letopoet",hour:"hodina",minute:"minuta",month:"msc",second:"sekunda",selectedDateDescription:t=>`Vybran datum: ${t.date}`,selectedRangeDescription:t=>`Vybran obdob: ${t.startDate} a ${t.endDate}`,selectedTimeDescription:t=>`Vybran as: ${t.time}`,startDate:"Poten datum",timeZoneName:"asov psmo",weekday:"den v tdnu",year:"rok"};var f8={};f8={calendar:"Kalender",day:"dag",dayPeriod:"AM/PM",endDate:"Slutdato",era:"ra",hour:"time",minute:"minut",month:"mned",second:"sekund",selectedDateDescription:t=>`Valgt dato: ${t.date}`,selectedRangeDescription:t=>`Valgt interval: ${t.startDate} til ${t.endDate}`,selectedTimeDescription:t=>`Valgt tidspunkt: ${t.time}`,startDate:"Startdato",timeZoneName:"tidszone",weekday:"ugedag",year:"r"};var h8={};h8={calendar:"Kalender",day:"Tag",dayPeriod:"Tageshlfte",endDate:"Enddatum",era:"Epoche",hour:"Stunde",minute:"Minute",month:"Monat",second:"Sekunde",selectedDateDescription:t=>`Ausgewhltes Datum: ${t.date}`,selectedRangeDescription:t=>`Ausgewhlter Bereich: ${t.startDate} bis ${t.endDate}`,selectedTimeDescription:t=>`Ausgewhlte Zeit: ${t.time}`,startDate:"Anfangsdatum",timeZoneName:"Zeitzone",weekday:"Wochentag",year:"Jahr"};var p8={};p8={calendar:"",day:"",dayPeriod:"../..",endDate:" ",era:"",hour:"",minute:"",month:"",second:"",selectedDateDescription:t=>` : ${t.date}`,selectedRangeDescription:t=>` : ${t.startDate}  ${t.endDate}`,selectedTimeDescription:t=>` : ${t.time}`,startDate:" ",timeZoneName:" ",weekday:"",year:""};var m8={};m8={era:"era",year:"year",month:"month",day:"day",hour:"hour",minute:"minute",second:"second",dayPeriod:"AM/PM",calendar:"Calendar",startDate:"Start Date",endDate:"End Date",weekday:"day of the week",timeZoneName:"time zone",selectedDateDescription:t=>`Selected Date: ${t.date}`,selectedRangeDescription:t=>`Selected Range: ${t.startDate} to ${t.endDate}`,selectedTimeDescription:t=>`Selected Time: ${t.time}`};var v8={};v8={calendar:"Calendario",day:"da",dayPeriod:"a.m./p.m.",endDate:"Fecha final",era:"era",hour:"hora",minute:"minuto",month:"mes",second:"segundo",selectedDateDescription:t=>`Fecha seleccionada: ${t.date}`,selectedRangeDescription:t=>`Rango seleccionado: ${t.startDate} a ${t.endDate}`,selectedTimeDescription:t=>`Hora seleccionada: ${t.time}`,startDate:"Fecha de inicio",timeZoneName:"zona horaria",weekday:"da de la semana",year:"ao"};var g8={};g8={calendar:"Kalender",day:"pev",dayPeriod:"enne/prast lunat",endDate:"Lppkuupev",era:"ajastu",hour:"tund",minute:"minut",month:"kuu",second:"sekund",selectedDateDescription:t=>`Valitud kuupev: ${t.date}`,selectedRangeDescription:t=>`Valitud vahemik: ${t.startDate} kuni ${t.endDate}`,selectedTimeDescription:t=>`Valitud aeg: ${t.time}`,startDate:"Alguskuupev",timeZoneName:"ajavnd",weekday:"ndalapev",year:"aasta"};var y8={};y8={calendar:"Kalenteri",day:"piv",dayPeriod:"vuorokaudenaika",endDate:"Pttymispiv",era:"aikakausi",hour:"tunti",minute:"minuutti",month:"kuukausi",second:"sekunti",selectedDateDescription:t=>`Valittu pivmr: ${t.date}`,selectedRangeDescription:t=>`Valittu aikavli: ${t.startDate}  ${t.endDate}`,selectedTimeDescription:t=>`Valittu aika: ${t.time}`,startDate:"Alkamispiv",timeZoneName:"aikavyhyke",weekday:"viikonpiv",year:"vuosi"};var b8={};b8={calendar:"Calendrier",day:"jour",dayPeriod:"cadran",endDate:"Date de fin",era:"re",hour:"heure",minute:"minute",month:"mois",second:"seconde",selectedDateDescription:t=>`Date slectionne: ${t.date}`,selectedRangeDescription:t=>`Plage slectionne: ${t.startDate} au ${t.endDate}`,selectedTimeDescription:t=>`Heure choisie: ${t.time}`,startDate:"Date de dbut",timeZoneName:"fuseau horaire",weekday:"jour de la semaine",year:"anne"};var _8={};_8={calendar:" ",day:"",dayPeriod:"/",endDate:" ",era:"",hour:"",minute:"",month:"",second:"",selectedDateDescription:t=>` : ${t.date}`,selectedRangeDescription:t=>` : ${t.startDate}  ${t.endDate}`,selectedTimeDescription:t=>` : ${t.time}`,startDate:" ",timeZoneName:" ",weekday:" ",year:""};var S8={};S8={calendar:"Kalendar",day:"dan",dayPeriod:"AM/PM",endDate:"Datum zavretka",era:"era",hour:"sat",minute:"minuta",month:"mjesec",second:"sekunda",selectedDateDescription:t=>`Odabrani datum: ${t.date}`,selectedRangeDescription:t=>`Odabrani raspon: ${t.startDate} do ${t.endDate}`,selectedTimeDescription:t=>`Odabrano vrijeme: ${t.time}`,startDate:"Datum poetka",timeZoneName:"vremenska zona",weekday:"dan u tjednu",year:"godina"};var w8={};w8={calendar:"Naptr",day:"nap",dayPeriod:"napszak",endDate:"Befejez dtum",era:"ra",hour:"ra",minute:"perc",month:"hnap",second:"msodperc",selectedDateDescription:t=>`Kijellt dtum: ${t.date}`,selectedRangeDescription:t=>`Kijellt tartomny: ${t.startDate}${t.endDate}`,selectedTimeDescription:t=>`Kijellt id: ${t.time}`,startDate:"Kezd dtum",timeZoneName:"idzna",weekday:"ht napja",year:"v"};var E8={};E8={calendar:"Calendario",day:"giorno",dayPeriod:"AM/PM",endDate:"Data finale",era:"era",hour:"ora",minute:"minuto",month:"mese",second:"secondo",selectedDateDescription:t=>`Data selezionata: ${t.date}`,selectedRangeDescription:t=>`Intervallo selezionato: da ${t.startDate} a ${t.endDate}`,selectedTimeDescription:t=>`Ora selezionata: ${t.time}`,startDate:"Data iniziale",timeZoneName:"fuso orario",weekday:"giorno della settimana",year:"anno"};var x8={};x8={calendar:"",day:"",dayPeriod:"/",endDate:"",era:"",hour:"",minute:"",month:"",second:"",selectedDateDescription:t=>` : ${t.date}`,selectedRangeDescription:t=>` : ${t.startDate}  ${t.endDate}`,selectedTimeDescription:t=>` : ${t.time}`,startDate:"",timeZoneName:"",weekday:"",year:""};var C8={};C8={calendar:"",day:"",dayPeriod:"/",endDate:"",era:"",hour:"",minute:"",month:"",second:"",selectedDateDescription:t=>` : ${t.date}`,selectedRangeDescription:t=>` : ${t.startDate} ~ ${t.endDate}`,selectedTimeDescription:t=>` : ${t.time}`,startDate:"",timeZoneName:"",weekday:"",year:""};var T8={};T8={calendar:"Kalendorius",day:"diena",dayPeriod:"iki piet / po piet",endDate:"Pabaigos data",era:"era",hour:"valanda",minute:"minut",month:"mnuo",second:"sekund",selectedDateDescription:t=>`Pasirinkta data: ${t.date}`,selectedRangeDescription:t=>`Pasirinktas intervalas: nuo ${t.startDate} iki ${t.endDate}`,selectedTimeDescription:t=>`Pasirinktas laikas: ${t.time}`,startDate:"Pradios data",timeZoneName:"laiko juosta",weekday:"savaits diena",year:"metai"};var D8={};D8={calendar:"Kalendrs",day:"diena",dayPeriod:"priekpusdien/pcpusdien",endDate:"Beigu datums",era:"ra",hour:"stundas",minute:"mintes",month:"mnesis",second:"sekundes",selectedDateDescription:t=>`Atlastais datums: ${t.date}`,selectedRangeDescription:t=>`Atlastais diapazons: no ${t.startDate} ldz ${t.endDate}`,selectedTimeDescription:t=>`Atlastais laiks: ${t.time}`,startDate:"Skuma datums",timeZoneName:"laika josla",weekday:"nedas diena",year:"gads"};var R8={};R8={calendar:"Kalender",day:"dag",dayPeriod:"a.m./p.m.",endDate:"Sluttdato",era:"tidsalder",hour:"time",minute:"minutt",month:"mned",second:"sekund",selectedDateDescription:t=>`Valgt dato: ${t.date}`,selectedRangeDescription:t=>`Valgt omrde: ${t.startDate} til ${t.endDate}`,selectedTimeDescription:t=>`Valgt tid: ${t.time}`,startDate:"Startdato",timeZoneName:"tidssone",weekday:"ukedag",year:"r"};var M8={};M8={calendar:"Kalender",day:"dag",dayPeriod:"a.m./p.m.",endDate:"Einddatum",era:"tijdperk",hour:"uur",minute:"minuut",month:"maand",second:"seconde",selectedDateDescription:t=>`Geselecteerde datum: ${t.date}`,selectedRangeDescription:t=>`Geselecteerd bereik: ${t.startDate} tot ${t.endDate}`,selectedTimeDescription:t=>`Geselecteerde tijd: ${t.time}`,startDate:"Startdatum",timeZoneName:"tijdzone",weekday:"dag van de week",year:"jaar"};var I8={};I8={calendar:"Kalendarz",day:"dzie",dayPeriod:"rano / po poudniu / wieczorem",endDate:"Data kocowa",era:"era",hour:"godzina",minute:"minuta",month:"miesic",second:"sekunda",selectedDateDescription:t=>`Wybrana data: ${t.date}`,selectedRangeDescription:t=>`Wybrany zakres: ${t.startDate} do ${t.endDate}`,selectedTimeDescription:t=>`Wybrany czas: ${t.time}`,startDate:"Data pocztkowa",timeZoneName:"strefa czasowa",weekday:"dzie tygodnia",year:"rok"};var P8={};P8={calendar:"Calendrio",day:"dia",dayPeriod:"AM/PM",endDate:"Data final",era:"era",hour:"hora",minute:"minuto",month:"ms",second:"segundo",selectedDateDescription:t=>`Data selecionada: ${t.date}`,selectedRangeDescription:t=>`Intervalo selecionado: ${t.startDate} a ${t.endDate}`,selectedTimeDescription:t=>`Hora selecionada: ${t.time}`,startDate:"Data inicial",timeZoneName:"fuso horrio",weekday:"dia da semana",year:"ano"};var A8={};A8={calendar:"Calendrio",day:"dia",dayPeriod:"am/pm",endDate:"Data de Trmino",era:"era",hour:"hora",minute:"minuto",month:"ms",second:"segundo",selectedDateDescription:t=>`Data selecionada: ${t.date}`,selectedRangeDescription:t=>`Intervalo selecionado: ${t.startDate} a ${t.endDate}`,selectedTimeDescription:t=>`Hora selecionada: ${t.time}`,startDate:"Data de Incio",timeZoneName:"fuso horrio",weekday:"dia da semana",year:"ano"};var k8={};k8={calendar:"Calendar",day:"zi",dayPeriod:"a.m/p.m.",endDate:"Dat final",era:"er",hour:"or",minute:"minut",month:"lun",second:"secund",selectedDateDescription:t=>`Dat selectat: ${t.date}`,selectedRangeDescription:t=>`Interval selectat: de la ${t.startDate} pn la ${t.endDate}`,selectedTimeDescription:t=>`Ora selectat: ${t.time}`,startDate:"Dat nceput",timeZoneName:"fus orar",weekday:"ziua din sptmn",year:"an"};var O8={};O8={calendar:"",day:"",dayPeriod:"AM/PM",endDate:" ",era:"",hour:"",minute:"",month:"",second:"",selectedDateDescription:t=>` : ${t.date}`,selectedRangeDescription:t=>` :  ${t.startDate}  ${t.endDate}`,selectedTimeDescription:t=>` : ${t.time}`,startDate:" ",timeZoneName:" ",weekday:" ",year:""};var $8={};$8={calendar:"Kalendr",day:"de",dayPeriod:"AM/PM",endDate:"Dtum ukonenia",era:"letopoet",hour:"hodina",minute:"minta",month:"mesiac",second:"sekunda",selectedDateDescription:t=>`Vybrat dtum: ${t.date}`,selectedRangeDescription:t=>`Vybrat rozsah: od ${t.startDate} do ${t.endDate}`,selectedTimeDescription:t=>`Vybrat as: ${t.time}`,startDate:"Dtum zaatia",timeZoneName:"asov psmo",weekday:"de tda",year:"rok"};var L8={};L8={calendar:"Koledar",day:"dan",dayPeriod:"dop/pop",endDate:"Datum konca",era:"doba",hour:"ura",minute:"minuta",month:"mesec",second:"sekunda",selectedDateDescription:t=>`Izbrani datum: ${t.date}`,selectedRangeDescription:t=>`Izbrano obmoje: ${t.startDate} do ${t.endDate}`,selectedTimeDescription:t=>`Izbrani as: ${t.time}`,startDate:"Datum zaetka",timeZoneName:"asovni pas",weekday:"dan v tednu",year:"leto"};var B8={};B8={calendar:"Kalendar",day:"",dayPeriod:" / ",endDate:"Datum zavretka",era:"",hour:"",minute:"",month:"",second:"",selectedDateDescription:t=>`Izabrani datum: ${t.date}`,selectedRangeDescription:t=>`Izabrani opseg: od ${t.startDate} do ${t.endDate}`,selectedTimeDescription:t=>`Izabrano vreme: ${t.time}`,startDate:"Datum poetka",timeZoneName:" ",weekday:"  ",year:""};var N8={};N8={calendar:"Kalender",day:"dag",dayPeriod:"fm/em",endDate:"Slutdatum",era:"era",hour:"timme",minute:"minut",month:"mnad",second:"sekund",selectedDateDescription:t=>`Valt datum: ${t.date}`,selectedRangeDescription:t=>`Valt intervall: ${t.startDate} till ${t.endDate}`,selectedTimeDescription:t=>`Vald tid: ${t.time}`,startDate:"Startdatum",timeZoneName:"tidszon",weekday:"veckodag",year:"r"};var U8={};U8={calendar:"Takvim",day:"gn",dayPeriod:"/S",endDate:"Biti Tarihi",era:"a",hour:"saat",minute:"dakika",month:"ay",second:"saniye",selectedDateDescription:t=>`Seilen Tarih: ${t.date}`,selectedRangeDescription:t=>`Seilen Aralk: ${t.startDate} - ${t.endDate}`,selectedTimeDescription:t=>`Seilen Zaman: ${t.time}`,startDate:"Balang Tarihi",timeZoneName:"saat dilimi",weekday:"haftann gn",year:"yl"};var F8={};F8={calendar:"",day:"",dayPeriod:"/",endDate:" ",era:"",hour:"",minute:"",month:"",second:"",selectedDateDescription:t=>` : ${t.date}`,selectedRangeDescription:t=>` : ${t.startDate}  ${t.endDate}`,selectedTimeDescription:t=>` : ${t.time}`,startDate:" ",timeZoneName:" ",weekday:" ",year:""};var j8={};j8={calendar:"",day:"",dayPeriod:"/",endDate:"",era:"",hour:"",minute:"",month:"",second:"",selectedDateDescription:t=>`${t.date}`,selectedRangeDescription:t=>`${t.startDate}  ${t.endDate}`,selectedTimeDescription:t=>`${t.time}`,startDate:"",timeZoneName:"",weekday:"",year:""};var V8={};V8={calendar:"",day:"",dayPeriod:"/",endDate:"",era:"",hour:"",minute:"",month:"",second:"",selectedDateDescription:t=>`${t.date}`,selectedRangeDescription:t=>`${t.startDate}  ${t.endDate}`,selectedTimeDescription:t=>`${t.time}`,startDate:"",timeZoneName:"",weekday:"",year:""};var kb={};kb={"ar-AE":u8,"bg-BG":c8,"cs-CZ":d8,"da-DK":f8,"de-DE":h8,"el-GR":p8,"en-US":m8,"es-ES":v8,"et-EE":g8,"fi-FI":y8,"fr-FR":b8,"he-IL":_8,"hr-HR":S8,"hu-HU":w8,"it-IT":E8,"ja-JP":x8,"ko-KR":C8,"lt-LT":T8,"lv-LV":D8,"nb-NO":R8,"nl-NL":M8,"pl-PL":I8,"pt-BR":P8,"pt-PT":A8,"ro-RO":k8,"ru-RU":O8,"sk-SK":$8,"sl-SI":L8,"sr-SP":B8,"sv-SE":N8,"tr-TR":U8,"uk-UA":F8,"zh-CN":j8,"zh-TW":V8};function z8(t,e,r){let{direction:n}=sn(),i=D.useMemo(()=>NT(e),[e]),a=l=>{if(l.currentTarget.contains(l.target)&&(l.altKey&&(l.key==="ArrowDown"||l.key==="ArrowUp")&&"setOpen"in t&&(l.preventDefault(),l.stopPropagation(),t.setOpen(!0)),!r))switch(l.key){case"ArrowLeft":if(l.preventDefault(),l.stopPropagation(),n==="rtl"){if(e.current){let c=l.target,d=_P(e.current,c.getBoundingClientRect().left,-1);d&&d.focus()}}else i.focusPrevious();break;case"ArrowRight":if(l.preventDefault(),l.stopPropagation(),n==="rtl"){if(e.current){let c=l.target,d=_P(e.current,c.getBoundingClientRect().left,1);d&&d.focus()}}else i.focusNext();break}},o=()=>{var l;if(!e.current)return;let c=(l=window.event)===null||l===void 0?void 0:l.target,d=$n(e.current,{tabbable:!0});if(c&&(d.currentNode=c,c=d.previousNode()),!c){let h;do h=d.lastChild(),h&&(c=h);while(h)}for(;c!=null&&c.hasAttribute("data-placeholder");){let h=d.previousNode();if(h&&h.hasAttribute("data-placeholder"))c=h;else break}c&&c.focus()},{pressProps:s}=is({preventFocusOnPress:!0,allowTextSelectionOnPress:!0,onPressStart(l){l.pointerType==="mouse"&&o()},onPress(l){l.pointerType!=="mouse"&&o()}});return Oe(s,{onKeyDown:a})}function _P(t,e,r){let n=$n(t,{tabbable:!0}),i=n.nextNode(),a=null,o=1/0;for(;i;){let l=i.getBoundingClientRect().left-e,c=Math.abs(l);Math.sign(l)===r&&c<o&&(a=i,o=c),i=n.nextNode()}return a}function pae(t){return t&&t.__esModule?t.default:t}const K8=new WeakMap,zg="__role_"+Date.now(),H8="__focusManager_"+Date.now();function W8(t,e,r){var n;let{isInvalid:i,validationErrors:a,validationDetails:o}=e.displayValidation,{labelProps:s,fieldProps:l,descriptionProps:c,errorMessageProps:d}=w4({...t,labelElementType:"span",isInvalid:i,errorMessage:t.errorMessage||a}),h=D.useRef(null),{focusWithinProps:p}=wl({...t,onFocusWithin(z){var j;h.current=e.value,(j=t.onFocus)===null||j===void 0||j.call(t,z)},onBlurWithin:z=>{var j;e.confirmPlaceholder(),e.value!==h.current&&e.commitValidation(),(j=t.onBlur)===null||j===void 0||j.call(t,z)},onFocusWithinChange:t.onFocusChange}),m=Ra(pae(kb),"@react-aria/datepicker"),g=e.maxGranularity==="hour"?"selectedTimeDescription":"selectedDateDescription",y=e.maxGranularity==="hour"?"time":"date",R=e.value?m.format(g,{[y]:e.formatValue({month:"long"})}):"",b=_b(R),_=t[zg]==="presentation"?l["aria-describedby"]:[b["aria-describedby"],l["aria-describedby"]].filter(Boolean).join(" ")||void 0,x=t[H8],T=D.useMemo(()=>x||NT(r),[x,r]),I=z8(e,r,t[zg]==="presentation");K8.set(e,{ariaLabel:t["aria-label"],ariaLabelledBy:[s.id,t["aria-labelledby"]].filter(Boolean).join(" ")||void 0,ariaDescribedBy:_,focusManager:T});let C=D.useRef(t.autoFocus),k;t[zg]==="presentation"?k={role:"presentation"}:k=Oe(l,{role:"group","aria-disabled":t.isDisabled||void 0,"aria-describedby":_}),D.useEffect(()=>{C.current&&T.focusFirst(),C.current=!1},[T]),X6(t.inputRef,e.value,e.setValue),u7({...t,focus(){T.focusFirst()}},e,t.inputRef);let S={type:"hidden",name:t.name,value:((n=e.value)===null||n===void 0?void 0:n.toString())||"",disabled:t.isDisabled};t.validationBehavior==="native"&&(S.type="text",S.hidden=!0,S.required=t.isRequired,S.onChange=()=>{});let V=ho(t);return{labelProps:{...s,onClick:()=>{T.focusFirst()}},fieldProps:Oe(V,k,I,p,{onKeyDown(z){t.onKeyDown&&t.onKeyDown(z)},onKeyUp(z){t.onKeyUp&&t.onKeyUp(z)},style:{unicodeBidi:"isolate"}}),inputProps:S,descriptionProps:c,errorMessageProps:d,isInvalid:i,validationErrors:a,validationDetails:o}}function mae(t,e,r){var n;let i=W8(t,e,r);return i.inputProps.value=((n=e.timeValue)===null||n===void 0?void 0:n.toString())||"",i}function vae(t){return t&&t.__esModule?t.default:t}function gae(){let{locale:t}=sn(),e=j6(vae(kb),"@react-aria/datepicker");return D.useMemo(()=>{try{return new Intl.DisplayNames(t,{type:"dateTimeField"})}catch{return new yae(t,e)}},[t,e])}class yae{of(e){return this.dictionary.getStringForLocale(e,this.locale)}constructor(e,r){this.locale=e,this.dictionary=r}}var G8={};G8={Empty:""};var q8={};q8={Empty:""};var Z8={};Z8={Empty:"Przdn"};var Y8={};Y8={Empty:"Tom"};var J8={};J8={Empty:"Leer"};var X8={};X8={Empty:""};var Q8={};Q8={Empty:"Empty"};var eU={};eU={Empty:"Vaco"};var tU={};tU={Empty:"Thjenda"};var rU={};rU={Empty:"Tyhj"};var nU={};nU={Empty:"Vide"};var iU={};iU={Empty:""};var aU={};aU={Empty:"Prazno"};var oU={};oU={Empty:"res"};var sU={};sU={Empty:"Vuoto"};var lU={};lU={Empty:""};var uU={};uU={Empty:" "};var cU={};cU={Empty:"Tuias"};var dU={};dU={Empty:"Tuks"};var fU={};fU={Empty:"Tom"};var hU={};hU={Empty:"Leeg"};var pU={};pU={Empty:"Pusty"};var mU={};mU={Empty:"Vazio"};var vU={};vU={Empty:"Vazio"};var gU={};gU={Empty:"Gol"};var yU={};yU={Empty:" "};var bU={};bU={Empty:"Przdne"};var _U={};_U={Empty:"Prazen"};var SU={};SU={Empty:"Prazno"};var wU={};wU={Empty:"Tomt"};var EU={};EU={Empty:"Bo"};var xU={};xU={Empty:""};var CU={};CU={Empty:""};var TU={};TU={Empty:""};var DU={};DU={"ar-AE":G8,"bg-BG":q8,"cs-CZ":Z8,"da-DK":Y8,"de-DE":J8,"el-GR":X8,"en-US":Q8,"es-ES":eU,"et-EE":tU,"fi-FI":rU,"fr-FR":nU,"he-IL":iU,"hr-HR":aU,"hu-HU":oU,"it-IT":sU,"ja-JP":lU,"ko-KR":uU,"lt-LT":cU,"lv-LV":dU,"nb-NO":fU,"nl-NL":hU,"pl-PL":pU,"pt-BR":mU,"pt-PT":vU,"ro-RO":gU,"ru-RU":yU,"sk-SK":bU,"sl-SI":_U,"sr-SP":SU,"sv-SE":wU,"tr-TR":EU,"uk-UA":xU,"zh-CN":CU,"zh-TW":TU};const bae=typeof document<"u"?We.useLayoutEffect:()=>{};function SP(t){const e=D.useRef(null);return bae(()=>{e.current=t},[t]),D.useCallback((...r)=>{const n=e.current;return n==null?void 0:n(...r)},[])}const RU={prefix:String(Math.round(Math.random()*1e10)),current:0},MU=We.createContext(RU),_ae=We.createContext(!1);let tw=new WeakMap;function Sae(t=!1){let e=D.useContext(MU),r=D.useRef(null);if(r.current===null&&!t){var n,i;let a=(i=We.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED)===null||i===void 0||(n=i.ReactCurrentOwner)===null||n===void 0?void 0:n.current;if(a){let o=tw.get(a);o==null?tw.set(a,{id:e.current,state:a.memoizedState}):a.memoizedState!==o.state&&(e.current=o.id,tw.delete(a))}r.current=++e.current}return r.current}function wae(t){let e=D.useContext(MU),r=Sae(!!t),n=`react-aria${e.prefix}`;return t||`${n}-${r}`}function Eae(t){let e=We.useId(),[r]=D.useState(IU()),n=r?"react-aria":`react-aria${RU.prefix}`;return t||`${n}-${e}`}We.useId;function xae(){return!1}function Cae(){return!0}function Tae(t){return()=>{}}function IU(){return typeof We.useSyncExternalStore=="function"?We.useSyncExternalStore(Tae,xae,Cae):D.useContext(_ae)}function Dae(){let t=D.useRef(new Map),e=D.useCallback((i,a,o,s)=>{let l=s!=null&&s.once?(...c)=>{t.current.delete(o),o(...c)}:o;t.current.set(o,{type:a,eventTarget:i,fn:l,options:s}),i.addEventListener(a,l,s)},[]),r=D.useCallback((i,a,o,s)=>{var l;let c=((l=t.current.get(o))===null||l===void 0?void 0:l.fn)||o;i.removeEventListener(a,c,s),t.current.delete(o)},[]),n=D.useCallback(()=>{t.current.forEach((i,a)=>{r(i.eventTarget,i.type,a,i.options)})},[r]);return D.useEffect(()=>n,[n]),{addGlobalListener:e,removeGlobalListener:r,removeAllGlobalListeners:n}}const Rae=new Set(["Arab","Syrc","Samr","Mand","Thaa","Mend","Nkoo","Adlm","Rohg","Hebr"]),Mae=new Set(["ae","ar","arc","bcc","bqi","ckb","dv","fa","glk","he","ku","mzn","nqo","pnb","ps","sd","ug","ur","yi"]);function Iae(t){if(Intl.Locale){let r=new Intl.Locale(t).maximize(),n=typeof r.getTextInfo=="function"?r.getTextInfo():r.textInfo;if(n)return n.direction==="rtl";if(r.script)return Rae.has(r.script)}let e=t.split("-")[0];return Mae.has(e)}const Pae=Symbol.for("react-aria.i18n.locale");function PU(){let t=typeof window<"u"&&window[Pae]||typeof navigator<"u"&&(navigator.language||navigator.userLanguage)||"en-US";try{Intl.DateTimeFormat.supportedLocalesOf([t])}catch{t="en-US"}return{locale:t,direction:Iae(t)?"rtl":"ltr"}}let H1=PU(),$h=new Set;function wP(){H1=PU();for(let t of $h)t(H1)}function Aae(){let t=IU(),[e,r]=D.useState(H1);return D.useEffect(()=>($h.size===0&&window.addEventListener("languagechange",wP),$h.add(r),()=>{$h.delete(r),$h.size===0&&window.removeEventListener("languagechange",wP)}),[]),t?{locale:"en-US",direction:"ltr"}:e}const kae=We.createContext(null);function Oae(){let t=Aae();return D.useContext(kae)||t}const EP=new WeakMap;function $ae(t){let e=EP.get(t);return e||(e=new fo(t),EP.set(t,e)),e}function Lae(t,e){return e&&fo.getGlobalDictionaryForPackage(e)||$ae(t)}function Bae(t,e){let{locale:r}=Oae(),n=Lae(t,e);return D.useMemo(()=>new PT(r,n),[r,n])}function Nae(t){return t&&t.__esModule?t.default:t}function Uae(t){const e=D.useRef(void 0);let{value:r,textValue:n,minValue:i,maxValue:a,isDisabled:o,isReadOnly:s,isRequired:l,onIncrement:c,onIncrementPage:d,onDecrement:h,onDecrementPage:p,onDecrementToMin:m,onIncrementToMax:g}=t;const y=Bae(Nae(DU),"@react-aria/spinbutton"),R=()=>clearTimeout(e.current);D.useEffect(()=>()=>R(),[]);let b=j=>{if(!(j.ctrlKey||j.metaKey||j.shiftKey||j.altKey||s))switch(j.key){case"PageUp":if(d){j.preventDefault(),d==null||d();break}case"ArrowUp":case"Up":c&&(j.preventDefault(),c==null||c());break;case"PageDown":if(p){j.preventDefault(),p==null||p();break}case"ArrowDown":case"Down":h&&(j.preventDefault(),h==null||h());break;case"Home":m&&(j.preventDefault(),m==null||m());break;case"End":g&&(j.preventDefault(),g==null||g());break}},_=D.useRef(!1),x=()=>{_.current=!0},T=()=>{_.current=!1},I=n===""?y.format("Empty"):(n||`${r}`).replace("-","");D.useEffect(()=>{_.current&&(Nie("assertive"),U1(I,"assertive"))},[I]);const C=SP(j=>{R(),c==null||c(),e.current=window.setTimeout(()=>{(a===void 0||isNaN(a)||r===void 0||isNaN(r)||r<a)&&C(60)},j)}),k=SP(j=>{R(),h==null||h(),e.current=window.setTimeout(()=>{(i===void 0||isNaN(i)||r===void 0||isNaN(r)||r>i)&&k(60)},j)});let S=j=>{j.preventDefault()},{addGlobalListener:V,removeAllGlobalListeners:z}=Dae();return{spinButtonProps:{role:"spinbutton","aria-valuenow":r!==void 0&&!isNaN(r)?r:void 0,"aria-valuetext":I,"aria-valuemin":i,"aria-valuemax":a,"aria-disabled":o||void 0,"aria-readonly":s||void 0,"aria-required":l||void 0,onKeyDown:b,onFocus:x,onBlur:T},incrementButtonProps:{onPressStart:()=>{C(400),V(window,"contextmenu",S)},onPressEnd:()=>{R(),z()},onFocus:x,onBlur:T},decrementButtonProps:{onPressStart:()=>{k(400),V(window,"contextmenu",S)},onPressEnd:()=>{R(),z()},onFocus:x,onBlur:T}}}function Fae(t,e,r){let n=D.useRef(""),{locale:i,direction:a}=sn(),o=gae(),{ariaLabel:s,ariaLabelledBy:l,ariaDescribedBy:c,focusManager:d}=K8.get(e),h=t.isPlaceholder?"":t.text,p=D.useMemo(()=>e.dateFormatter.resolvedOptions(),[e.dateFormatter]),m=Si({month:"long",timeZone:p.timeZone}),g=Si({hour:"numeric",hour12:p.hour12,timeZone:p.timeZone});if(t.type==="month"&&!t.isPlaceholder){let ne=m.format(e.dateValue);h=ne!==h?`${h}  ${ne}`:ne}else t.type==="hour"&&!t.isPlaceholder&&(h=g.format(e.dateValue));let{spinButtonProps:y}=Uae({value:t.value,textValue:h,minValue:t.minValue,maxValue:t.maxValue,isDisabled:e.isDisabled,isReadOnly:e.isReadOnly||!t.isEditable,isRequired:e.isRequired,onIncrement:()=>{n.current="",e.increment(t.type)},onDecrement:()=>{n.current="",e.decrement(t.type)},onIncrementPage:()=>{n.current="",e.incrementPage(t.type)},onDecrementPage:()=>{n.current="",e.decrementPage(t.type)},onIncrementToMax:()=>{n.current="",t.maxValue!==void 0&&e.setSegment(t.type,t.maxValue)},onDecrementToMin:()=>{n.current="",t.minValue!==void 0&&e.setSegment(t.type,t.minValue)}}),R=D.useMemo(()=>new rL(i,{maximumFractionDigits:0}),[i]),b=()=>{if(t.text===t.placeholder&&d.focusPrevious(),R.isValidPartialNumber(t.text)&&!e.isReadOnly&&!t.isPlaceholder){let ne=t.text.slice(0,-1),he=R.parse(ne);ne=he===0?"":ne,ne.length===0||he===0?e.clearSegment(t.type):e.setSegment(t.type,he),n.current=ne}else t.type==="dayPeriod"&&e.clearSegment(t.type)},_=ne=>{if(ne.key==="a"&&(cl()?ne.metaKey:ne.ctrlKey)&&ne.preventDefault(),!(ne.ctrlKey||ne.metaKey||ne.shiftKey||ne.altKey))switch(ne.key){case"Backspace":case"Delete":ne.preventDefault(),ne.stopPropagation(),b();break}},{startsWith:x}=NY({sensitivity:"base"}),T=Si({hour:"numeric",hour12:!0}),I=D.useMemo(()=>{let ne=new Date;return ne.setHours(0),T.formatToParts(ne).find(he=>he.type==="dayPeriod").value},[T]),C=D.useMemo(()=>{let ne=new Date;return ne.setHours(12),T.formatToParts(ne).find(he=>he.type==="dayPeriod").value},[T]),k=Si({year:"numeric",era:"narrow",timeZone:"UTC"}),S=D.useMemo(()=>{if(t.type!=="era")return[];let ne=lr(new Bt(1,1,1),e.calendar),he=e.calendar.getEras().map(me=>{let ee=ne.set({year:1,month:1,day:1,era:me}).toDate("UTC"),q=k.formatToParts(ee).find(X=>X.type==="era").value;return{era:me,formatted:q}}),oe=jae(he.map(me=>me.formatted));if(oe)for(let me of he)me.formatted=me.formatted.slice(oe);return he},[k,e.calendar,t.type]),V=ne=>{if(e.isDisabled||e.isReadOnly)return;let he=n.current+ne;switch(t.type){case"dayPeriod":if(x(I,ne))e.setSegment("dayPeriod",0);else if(x(C,ne))e.setSegment("dayPeriod",12);else break;d.focusNext();break;case"era":{let oe=S.find(me=>x(me.formatted,ne));oe&&(e.setSegment("era",oe.era),d.focusNext());break}case"day":case"hour":case"minute":case"second":case"month":case"year":{if(!R.isValidPartialNumber(he))return;let oe=R.parse(he),me=oe,ee=t.minValue===0;if(t.type==="hour"&&e.dateFormatter.resolvedOptions().hour12){switch(e.dateFormatter.resolvedOptions().hourCycle){case"h11":oe>11&&(me=R.parse(ne));break;case"h12":ee=!1,oe>12&&(me=R.parse(ne));break}t.value!==void 0&&t.value>=12&&oe>1&&(oe+=12)}else t.maxValue!==void 0&&oe>t.maxValue&&(me=R.parse(ne));if(isNaN(oe))return;let Y=me!==0||ee;Y&&e.setSegment(t.type,me),t.maxValue!==void 0&&(+(oe+"0")>t.maxValue||he.length>=String(t.maxValue).length)?(n.current="",Y&&d.focusNext()):n.current=he;break}}},z=()=>{n.current="",r.current&&Zy(r.current,{containingElement:bb(r.current)});let ne=window.getSelection();ne==null||ne.collapse(r.current)},j=D.useRef(typeof document<"u"?document:null);qa(j,"selectionchange",()=>{var ne;let he=window.getSelection();he!=null&&he.anchorNode&&(!((ne=r.current)===null||ne===void 0)&&ne.contains(he==null?void 0:he.anchorNode))&&he.collapse(r.current)});let J=D.useRef("");qa(r,"beforeinput",ne=>{if(r.current)switch(ne.preventDefault(),ne.inputType){case"deleteContentBackward":case"deleteContentForward":R.isValidPartialNumber(t.text)&&!e.isReadOnly&&b();break;case"insertCompositionText":J.current=r.current.textContent,r.current.textContent=r.current.textContent;break;default:ne.data!=null&&V(ne.data);break}}),qa(r,"input",ne=>{let{inputType:he,data:oe}=ne;switch(he){case"insertCompositionText":r.current&&(r.current.textContent=J.current),oe!=null&&(x(I,oe)||x(C,oe))&&V(oe);break}}),qt(()=>{let ne=r.current;return()=>{document.activeElement===ne&&(d.focusPrevious()||d.focusNext())}},[r,d]);let $=Hu()||t.type==="timeZoneName"?{role:"textbox","aria-valuemax":null,"aria-valuemin":null,"aria-valuetext":null,"aria-valuenow":null}:{},le=D.useMemo(()=>e.segments.find(ne=>ne.isEditable),[e.segments]);t!==le&&!e.isInvalid&&(c=void 0);let ie=Ii(),Z=!e.isDisabled&&!e.isReadOnly&&t.isEditable,te=t.type==="literal"?"":o.of(t.type),H=Om({"aria-label":`${te}${s?`, ${s}`:""}${l?", ":""}`,"aria-labelledby":l});if(t.type==="literal")return{segmentProps:{"aria-hidden":!0}};let fe={caretColor:"transparent"};if(a==="rtl"){fe.unicodeBidi="embed";let ne=p[t.type];(ne==="numeric"||ne==="2-digit")&&(fe.direction="ltr")}return{segmentProps:Oe(y,H,{id:ie,...$,"aria-invalid":e.isInvalid?"true":void 0,"aria-describedby":c,"aria-readonly":e.isReadOnly||!t.isEditable?"true":void 0,"data-placeholder":t.isPlaceholder||void 0,contentEditable:Z,suppressContentEditableWarning:Z,spellCheck:Z?"false":void 0,autoCorrect:Z?"off":void 0,[parseInt(We.version,10)>=17?"enterKeyHint":"enterkeyhint"]:Z?"next":void 0,inputMode:e.isDisabled||t.type==="dayPeriod"||t.type==="era"||!Z?void 0:"numeric",tabIndex:e.isDisabled?void 0:0,onKeyDown:_,onFocus:z,style:fe,onPointerDown(ne){ne.stopPropagation()},onMouseDown(ne){ne.stopPropagation()}})}}function jae(t){t.sort();let e=t[0],r=t[t.length-1];for(let n=0;n<e.length;n++)if(e[n]!==r[n])return n;return 0}function Vae(t){return t&&t.__esModule?t.default:t}function zae(t,e,r){var n,i,a;let o=Ra(Vae(kb),"@react-aria/datepicker"),{isInvalid:s,validationErrors:l,validationDetails:c}=e.displayValidation,{labelProps:d,fieldProps:h,descriptionProps:p,errorMessageProps:m}=w4({...t,labelElementType:"span",isInvalid:s,errorMessage:t.errorMessage||l}),g=h["aria-labelledby"]||h.id,{locale:y}=sn(),R=e.formatValue(y,{month:"long"}),b=R?o.format("selectedRangeDescription",{startDate:R.start,endDate:R.end}):"",_=_b(b),x={"aria-label":o.format("startDate"),"aria-labelledby":g},T={"aria-label":o.format("endDate"),"aria-labelledby":g},I=Ii(),C=Ii(),k=z8(e,r),S=[_["aria-describedby"],h["aria-describedby"]].filter(Boolean).join(" ")||void 0,V=D.useMemo(()=>NT(r,{accept:H=>H.id!==I}),[r,I]),z={[H8]:V,[zg]:"presentation","aria-describedby":S,placeholderValue:t.placeholderValue,hideTimeZone:t.hideTimeZone,hourCycle:t.hourCycle,granularity:t.granularity,shouldForceLeadingZeros:t.shouldForceLeadingZeros,isDisabled:t.isDisabled,isReadOnly:t.isReadOnly,isRequired:t.isRequired,validationBehavior:t.validationBehavior},j=ho(t),J=D.useRef(!1),{focusWithinProps:$}=wl({...t,isDisabled:e.isOpen,onBlurWithin:H=>{let fe=document.getElementById(C);if(!(fe!=null&&fe.contains(H.relatedTarget))){var ne,he;J.current=!1,(ne=t.onBlur)===null||ne===void 0||ne.call(t,H),(he=t.onFocusChange)===null||he===void 0||he.call(t,!1)}},onFocusWithin:H=>{if(!J.current){var fe,ne;J.current=!0,(fe=t.onFocus)===null||fe===void 0||fe.call(t,H),(ne=t.onFocusChange)===null||ne===void 0||ne.call(t,!0)}}}),le=D.useRef(Xl),ie=D.useRef(Xl);var Z,te;return{groupProps:Oe(j,k,h,_,$,{role:"group","aria-disabled":t.isDisabled||null,"aria-describedby":S,onKeyDown(H){e.isOpen||t.onKeyDown&&t.onKeyDown(H)},onKeyUp(H){e.isOpen||t.onKeyUp&&t.onKeyUp(H)}}),labelProps:{...d,onClick:()=>{V.focusFirst()}},buttonProps:{..._,id:I,"aria-haspopup":"dialog","aria-label":o.format("calendar"),"aria-labelledby":`${I} ${g}`,"aria-describedby":S,"aria-expanded":e.isOpen,isDisabled:t.isDisabled||t.isReadOnly,onPress:()=>e.setOpen(!0)},dialogProps:{id:C,"aria-labelledby":`${I} ${g}`},startFieldProps:{...x,...z,value:(Z=(n=e.value)===null||n===void 0?void 0:n.start)!==null&&Z!==void 0?Z:null,onChange:H=>e.setDateTime("start",H),autoFocus:t.autoFocus,name:t.startName,[f0]:{realtimeValidation:e.realtimeValidation,displayValidation:e.displayValidation,updateValidation(H){le.current=H,e.updateValidation(h0(H,ie.current))},resetValidation:e.resetValidation,commitValidation:e.commitValidation}},endFieldProps:{...T,...z,value:(te=(i=e.value)===null||i===void 0?void 0:i.end)!==null&&te!==void 0?te:null,onChange:H=>e.setDateTime("end",H),name:t.endName,[f0]:{realtimeValidation:e.realtimeValidation,displayValidation:e.displayValidation,updateValidation(H){ie.current=H,e.updateValidation(h0(le.current,H))},resetValidation:e.resetValidation,commitValidation:e.commitValidation}},descriptionProps:p,errorMessageProps:m,calendarProps:{autoFocus:!0,value:!((a=e.dateRange)===null||a===void 0)&&a.start&&e.dateRange.end?e.dateRange:null,onChange:e.setDateRange,minValue:t.minValue,maxValue:t.maxValue,isDisabled:t.isDisabled,isReadOnly:t.isReadOnly,isDateUnavailable:t.isDateUnavailable,allowsNonContiguousRanges:t.allowsNonContiguousRanges,defaultFocusedValue:e.dateRange?void 0:t.placeholderValue,isInvalid:e.isInvalid,errorMessage:typeof t.errorMessage=="function"?t.errorMessage(e.displayValidation):t.errorMessage||e.displayValidation.validationErrors.join(" ")},isInvalid:s,validationErrors:l,validationDetails:c}}var AU=({state:t,segment:e,slots:r,classNames:n,...i})=>{const a=D.useRef(null);let{segmentProps:o}=Fae(e,t,a);return O.jsx("div",{...Oe(o,i),ref:a,className:r.segment({class:n==null?void 0:n.segment}),"data-editable":Te(e.isEditable),"data-invalid":Te(t.isInvalid),"data-placeholder":Te(e.isPlaceholder),"data-slot":"segment","data-type":e.type,style:{...o.style},children:e.text})},kU=D.forwardRef((t,e)=>{const{as:r,state:n,slots:i,inputProps:a,classNames:o,...s}=t,l=r||"div";return O.jsxs(l,{...s,ref:e,children:[n.segments.map((c,d)=>O.jsx(AU,{classNames:o,segment:c,slots:i,state:n},d)),O.jsx("input",{...a})]})});kU.displayName="HeroUI.DateInputField";var T4=Qt((t,e)=>{const{as:r,label:n,children:i,description:a,startContent:o,endContent:s,errorMessage:l,shouldLabelBeOutside:c,isInvalid:d,groupProps:h,labelProps:p,wrapperProps:m,helperWrapperProps:g,errorMessageProps:y,descriptionProps:R,validationErrors:b,validationDetails:_,...x}=t,T=r||"div",I=n?O.jsx("span",{...p,children:n}):null,C=typeof l=="function"?l({isInvalid:d,validationErrors:b,validationDetails:_}):l||(b==null?void 0:b.join(" ")),k=!!a||!!C,S=D.useMemo(()=>k?O.jsx("div",{...g,children:d&&C?O.jsx("div",{...y,children:C}):a?O.jsx("div",{...R,children:a}):null}):null,[k,C,a,g,y,R]);return O.jsxs(T,{...x,ref:e,"data-has-helper":Te(k),children:[c?I:null,O.jsxs("div",{...h,children:[c?null:I,O.jsxs("div",{...m,children:[o,i,s]}),c?S:null]}),c?null:S]})});T4.displayName="HeroUI.DateInputGroup";var OU={};OU={rangeOverflow:t=>`    ${t.maxValue}   .`,rangeReversed:"       .",rangeUnderflow:t=>`    ${t.minValue}   .`,unavailableDate:"   ."};var $U={};$U={rangeOverflow:t=>`    ${t.maxValue}  -.`,rangeReversed:"      .",rangeUnderflow:t=>`    ${t.minValue}  -.`,unavailableDate:"    ."};var LU={};LU={rangeOverflow:t=>`Hodnota mus bt ${t.maxValue} nebo dvj.`,rangeReversed:"Datum zahjen mus pedchzet datu ukonen.",rangeUnderflow:t=>`Hodnota mus bt ${t.minValue} nebo pozdj.`,unavailableDate:"Vybran datum nen k dispozici."};var BU={};BU={rangeOverflow:t=>`Vrdien skal vre ${t.maxValue} eller tidligere.`,rangeReversed:"Startdatoen skal vre fr slutdatoen.",rangeUnderflow:t=>`Vrdien skal vre ${t.minValue} eller nyere.`,unavailableDate:"Den valgte dato er ikke tilgngelig."};var NU={};NU={rangeOverflow:t=>`Der Wert muss ${t.maxValue} oder frher sein.`,rangeReversed:"Das Anfangsdatum muss vor dem Enddatum liegen.",rangeUnderflow:t=>`Der Wert muss ${t.minValue} oder spter sein.`,unavailableDate:"Das ausgewhlte Datum ist nicht verfgbar."};var UU={};UU={rangeOverflow:t=>`     ${t.maxValue}  .`,rangeReversed:"          .",rangeUnderflow:t=>`     ${t.minValue}  .`,unavailableDate:"     ."};var FU={};FU={rangeUnderflow:t=>`Value must be ${t.minValue} or later.`,rangeOverflow:t=>`Value must be ${t.maxValue} or earlier.`,rangeReversed:"Start date must be before end date.",unavailableDate:"Selected date unavailable."};var jU={};jU={rangeOverflow:t=>`El valor debe ser ${t.maxValue} o anterior.`,rangeReversed:"La fecha de inicio debe ser anterior a la fecha de finalizacin.",rangeUnderflow:t=>`El valor debe ser ${t.minValue} o posterior.`,unavailableDate:"Fecha seleccionada no disponible."};var VU={};VU={rangeOverflow:t=>`Vrtus peab olema ${t.maxValue} vi varasem.`,rangeReversed:"Alguskuupev peab olema enne lppkuupeva.",rangeUnderflow:t=>`Vrtus peab olema ${t.minValue} vi hilisem.`,unavailableDate:"Valitud kuupev pole saadaval."};var zU={};zU={rangeOverflow:t=>`Arvon on oltava ${t.maxValue} tai sit aikaisempi.`,rangeReversed:"Aloituspivn on oltava ennen lopetuspiv.",rangeUnderflow:t=>`Arvon on oltava ${t.minValue} tai sit myhisempi.`,unavailableDate:"Valittu pivmr ei ole kytettviss."};var KU={};KU={rangeOverflow:t=>`La valeur doit tre ${t.maxValue} ou antrieure.`,rangeReversed:"La date de dbut doit tre antrieure  la date de fin.",rangeUnderflow:t=>`La valeur doit tre ${t.minValue} ou ultrieure.`,unavailableDate:"La date slectionne nest pas disponible."};var HU={};HU={rangeOverflow:t=>`   ${t.maxValue}   .`,rangeReversed:"      .",rangeUnderflow:t=>`   ${t.minValue}   .`,unavailableDate:"   ."};var WU={};WU={rangeOverflow:t=>`Vrijednost mora biti ${t.maxValue} ili ranije.`,rangeReversed:"Datum poetka mora biti prije datuma zavretka.",rangeUnderflow:t=>`Vrijednost mora biti ${t.minValue} ili kasnije.`,unavailableDate:"Odabrani datum nije dostupan."};var GU={};GU={rangeOverflow:t=>`Az rtknek ${t.maxValue} vagy korbbinak kell lennie.`,rangeReversed:"A kezd dtumnak a befejez dtumnl korbbinak kell lennie.",rangeUnderflow:t=>`Az rtknek ${t.minValue} vagy ksbbinek kell lennie.`,unavailableDate:"A kivlasztott dtum nem rhet el."};var qU={};qU={rangeOverflow:t=>`Il valore deve essere ${t.maxValue} o precedente.`,rangeReversed:"La data di inizio deve essere antecedente alla data di fine.",rangeUnderflow:t=>`Il valore deve essere ${t.minValue} o successivo.`,unavailableDate:"Data selezionata non disponibile."};var ZU={};ZU={rangeOverflow:t=>` ${t.maxValue} `,rangeReversed:"",rangeUnderflow:t=>` ${t.minValue} `,unavailableDate:""};var YU={};YU={rangeOverflow:t=>` ${t.maxValue}  .`,rangeReversed:"   .",rangeUnderflow:t=>` ${t.minValue}  .`,unavailableDate:"    ."};var JU={};JU={rangeOverflow:t=>`Reikm turi bti ${t.maxValue} arba ankstesn.`,rangeReversed:"Pradios data turi bti ankstesn nei pabaigos data.",rangeUnderflow:t=>`Reikm turi bti ${t.minValue} arba naujesn.`,unavailableDate:"Pasirinkta data nepasiekiama."};var XU={};XU={rangeOverflow:t=>`Vrtbai ir jbt ${t.maxValue} vai agrkai.`,rangeReversed:"Skuma datumam ir jbt pirms beigu datuma.",rangeUnderflow:t=>`Vrtbai ir jbt ${t.minValue} vai vlkai.`,unavailableDate:"Atlastais datums nav pieejams."};var QU={};QU={rangeOverflow:t=>`Verdien m vre ${t.maxValue} eller tidligere.`,rangeReversed:"Startdatoen m vre fr sluttdatoen.",rangeUnderflow:t=>`Verdien m vre ${t.minValue} eller senere.`,unavailableDate:"Valgt dato utilgjengelig."};var eF={};eF={rangeOverflow:t=>`Waarde moet ${t.maxValue} of eerder zijn.`,rangeReversed:"De startdatum moet voor de einddatum liggen.",rangeUnderflow:t=>`Waarde moet ${t.minValue} of later zijn.`,unavailableDate:"Geselecteerde datum niet beschikbaar."};var tF={};tF={rangeOverflow:t=>`Warto musi mie warto ${t.maxValue} lub wczeniejsz.`,rangeReversed:"Data rozpoczcia musi by wczeniejsza ni data zakoczenia.",rangeUnderflow:t=>`Warto musi mie warto ${t.minValue} lub pniejsz.`,unavailableDate:"Wybrana data jest niedostpna."};var rF={};rF={rangeOverflow:t=>`O valor deve ser ${t.maxValue} ou anterior.`,rangeReversed:"A data inicial deve ser anterior  data final.",rangeUnderflow:t=>`O valor deve ser ${t.minValue} ou posterior.`,unavailableDate:"Data selecionada indisponvel."};var nF={};nF={rangeOverflow:t=>`O valor tem de ser ${t.maxValue} ou anterior.`,rangeReversed:"A data de incio deve ser anterior  data de fim.",rangeUnderflow:t=>`O valor tem de ser ${t.minValue} ou posterior.`,unavailableDate:"Data selecionada indisponvel."};var iF={};iF={rangeOverflow:t=>`Valoarea trebuie s fie ${t.maxValue} sau anterioar.`,rangeReversed:"Data de nceput trebuie s fie anterioar datei de sfrit.",rangeUnderflow:t=>`Valoarea trebuie s fie ${t.minValue} sau ulterioar.`,unavailableDate:"Data selectat nu este disponibil."};var aF={};aF={rangeOverflow:t=>`     ${t.maxValue}.`,rangeReversed:"     .",rangeUnderflow:t=>`     ${t.minValue}.`,unavailableDate:"  ."};var oF={};oF={rangeOverflow:t=>`Hodnota mus by ${t.maxValue} alebo skoria.`,rangeReversed:"Dtum zaiatku mus by skor ako dtum konca.",rangeUnderflow:t=>`Hodnota mus by ${t.minValue} alebo neskoria.`,unavailableDate:"Vybrat dtum je nedostupn."};var sF={};sF={rangeOverflow:t=>`Vrednost mora biti ${t.maxValue} ali stareja.`,rangeReversed:"Zaetni datum mora biti pred konnim datumom.",rangeUnderflow:t=>`Vrednost mora biti ${t.minValue} ali noveja.`,unavailableDate:"Izbrani datum ni na voljo."};var lF={};lF={rangeOverflow:t=>`Vrednost mora da bude ${t.maxValue} ili starija.`,rangeReversed:"Datum poetka mora biti pre datuma zavretka.",rangeUnderflow:t=>`Vrednost mora da bude ${t.minValue} ili novija.`,unavailableDate:"Izabrani datum nije dostupan."};var uF={};uF={rangeOverflow:t=>`Vrdet mste vara ${t.maxValue} eller tidigare.`,rangeReversed:"Startdatumet mste vara fre slutdatumet.",rangeUnderflow:t=>`Vrdet mste vara ${t.minValue} eller senare.`,unavailableDate:"Det valda datumet r inte tillgngligt."};var cF={};cF={rangeOverflow:t=>`Deer, ${t.maxValue} veya ncesi olmaldr.`,rangeReversed:"Balang tarihi biti tarihinden nce olmaldr.",rangeUnderflow:t=>`Deer, ${t.minValue} veya sonras olmaldr.`,unavailableDate:"Seilen tarih kullanlamyor."};var dF={};dF={rangeOverflow:t=>`     ${t.maxValue}.`,rangeReversed:"     .",rangeUnderflow:t=>`     ${t.minValue}.`,unavailableDate:"  ."};var fF={};fF={rangeOverflow:t=>` ${t.maxValue} `,rangeReversed:"",rangeUnderflow:t=>` ${t.minValue} `,unavailableDate:""};var hF={};hF={rangeOverflow:t=>` ${t.maxValue} `,rangeReversed:"",rangeUnderflow:t=>` ${t.minValue} `,unavailableDate:""};var pF={};pF={"ar-AE":OU,"bg-BG":$U,"cs-CZ":LU,"da-DK":BU,"de-DE":NU,"el-GR":UU,"en-US":FU,"es-ES":jU,"et-EE":VU,"fi-FI":zU,"fr-FR":KU,"he-IL":HU,"hr-HR":WU,"hu-HU":GU,"it-IT":qU,"ja-JP":ZU,"ko-KR":YU,"lt-LT":JU,"lv-LV":XU,"nb-NO":QU,"nl-NL":eF,"pl-PL":tF,"pt-BR":rF,"pt-PT":nF,"ro-RO":iF,"ru-RU":aF,"sk-SK":oF,"sl-SI":sF,"sr-SP":lF,"sv-SE":uF,"tr-TR":cF,"uk-UA":dF,"zh-CN":fF,"zh-TW":hF};function Kae(t){return t&&t.__esModule?t.default:t}const mF=new fo(Kae(pF));function vF(){return typeof navigator<"u"&&(navigator.language||navigator.userLanguage)||"en-US"}function W1(t,e,r,n,i){let a=t!=null&&r!=null&&t.compare(r)>0,o=t!=null&&e!=null&&t.compare(e)<0,s=t!=null&&(n==null?void 0:n(t))||!1,l=a||o||s,c=[];if(l){let d=vF(),h=fo.getGlobalDictionaryForPackage("@react-stately/datepicker")||mF,p=new PT(d,h),m=new ba(d,yu({},i)),g=m.resolvedOptions().timeZone;o&&e!=null&&c.push(p.format("rangeUnderflow",{minValue:m.format(e.toDate(g))})),a&&r!=null&&c.push(p.format("rangeOverflow",{maxValue:m.format(r.toDate(g))})),s&&c.push(p.format("unavailableDate"))}return{isInvalid:l,validationErrors:c,validationDetails:{badInput:s,customError:!1,patternMismatch:!1,rangeOverflow:a,rangeUnderflow:o,stepMismatch:!1,tooLong:!1,tooShort:!1,typeMismatch:!1,valueMissing:!1,valid:!l}}}function Hae(t,e,r,n,i){var a;let o=W1((a=t==null?void 0:t.start)!==null&&a!==void 0?a:null,e,r,n,i);var s;let l=W1((s=t==null?void 0:t.end)!==null&&s!==void 0?s:null,e,r,n,i),c=h0(o,l);if((t==null?void 0:t.end)!=null&&t.start!=null&&t.end.compare(t.start)<0){let d=fo.getGlobalDictionaryForPackage("@react-stately/datepicker")||mF;c=h0(c,{isInvalid:!0,validationErrors:[d.getStringForLocale("rangeReversed",vF())],validationDetails:{...Rb,rangeUnderflow:!0,rangeOverflow:!0,valid:!1}})}return c}const Wae={year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"2-digit",second:"2-digit"},Gae={year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"};function yu(t,e){t={...e.shouldForceLeadingZeros?Gae:Wae,...t};let n=e.granularity||"minute",i=Object.keys(t);var a;let o=i.indexOf((a=e.maxGranularity)!==null&&a!==void 0?a:"year");o<0&&(o=0);let s=i.indexOf(n);if(s<0&&(s=2),o>s)throw new Error("maxGranularity must be greater than granularity");let l=i.slice(o,s+1).reduce((d,h)=>(d[h]=t[h],d),{});return e.hourCycle!=null&&(l.hour12=e.hourCycle===12),l.timeZone=e.timeZone||"UTC",(n==="hour"||n==="minute"||n==="second")&&e.timeZone&&!e.hideTimeZone&&(l.timeZoneName="short"),e.showEra&&o===0&&(l.era="short"),l}function og(t){return t&&"hour"in t?t:new Pm}function gF(t,e){if(t===null)return null;if(t)return lr(t,e)}function ch(t,e,r,n){if(t)return gF(t,r);let i=lr(s6(n??hb()).set({hour:0,minute:0,second:0,millisecond:0}),r);return e==="year"||e==="month"||e==="day"?Qn(i):n?i:no(i)}function yF(t,e){let r=t&&"timeZone"in t?t.timeZone:void 0,n=t&&"minute"in t?"minute":"day";if(t&&e&&!(e in t))throw new Error("Invalid granularity "+e+" for value "+t.toString());let[i,a]=D.useState([n,r]);t&&(i[0]!==n||i[1]!==r)&&a([n,r]),e||(e=t?n:i[0]);let o=t?r:i[1];return[e,o]}const qae=new fo({ach:{year:"mwaka",month:"dwe",day:"nino"},af:{year:"jjjj",month:"mm",day:"dd"},am:{year:"",month:"",day:""},an:{year:"aaaa",month:"mm",day:"dd"},ar:{year:"",month:"",day:""},ast:{year:"aaaa",month:"mm",day:"dd"},az:{year:"iiii",month:"aa",day:"gg"},be:{year:"",month:"",day:""},bg:{year:"",month:"",day:""},bn:{year:"yyyy",month:"",day:"dd"},br:{year:"bbbb",month:"mm",day:"dd"},bs:{year:"gggg",month:"mm",day:"dd"},ca:{year:"aaaa",month:"mm",day:"dd"},cak:{year:"jjjj",month:"ii",day:"q'q'"},ckb:{year:"",month:"",day:""},cs:{year:"rrrr",month:"mm",day:"dd"},cy:{year:"bbbb",month:"mm",day:"dd"},da:{year:"",month:"mm",day:"dd"},de:{year:"jjjj",month:"mm",day:"tt"},dsb:{year:"llll",month:"mm",day:""},el:{year:"",month:"",day:""},en:{year:"yyyy",month:"mm",day:"dd"},eo:{year:"jjjj",month:"mm",day:"tt"},es:{year:"aaaa",month:"mm",day:"dd"},et:{year:"aaaa",month:"kk",day:"pp"},eu:{year:"uuuu",month:"hh",day:"ee"},fa:{year:"",month:"",day:""},ff:{year:"hhhh",month:"ll",day:""},fi:{year:"vvvv",month:"kk",day:"pp"},fr:{year:"aaaa",month:"mm",day:"jj"},fy:{year:"jjjj",month:"mm",day:"dd"},ga:{year:"bbbb",month:"mm",day:"ll"},gd:{year:"bbbb",month:"mm",day:"ll"},gl:{year:"aaaa",month:"mm",day:"dd"},he:{year:"",month:"",day:""},hr:{year:"gggg",month:"mm",day:"dd"},hsb:{year:"llll",month:"mm",day:"dd"},hu:{year:"",month:"hh",day:"nn"},ia:{year:"aaaa",month:"mm",day:"dd"},id:{year:"tttt",month:"bb",day:"hh"},it:{year:"aaaa",month:"mm",day:"gg"},ja:{year:"",month:"",day:""},ka:{year:"",month:"",day:""},kk:{year:"",month:"",day:""},kn:{year:"",month:"",day:""},ko:{year:"",month:"",day:""},lb:{year:"jjjj",month:"mm",day:"dd"},lo:{year:"",month:"",day:""},lt:{year:"mmmm",month:"mm",day:"dd"},lv:{year:"gggg",month:"mm",day:"dd"},meh:{year:"aaaa",month:"mm",day:"dd"},ml:{year:"",month:"",day:""},ms:{year:"tttt",month:"mm",day:"hh"},nl:{year:"jjjj",month:"mm",day:"dd"},nn:{year:"",month:"mm",day:"dd"},no:{year:"",month:"mm",day:"dd"},oc:{year:"aaaa",month:"mm",day:"jj"},pl:{year:"rrrr",month:"mm",day:"dd"},pt:{year:"aaaa",month:"mm",day:"dd"},rm:{year:"oooo",month:"mm",day:"dd"},ro:{year:"aaaa",month:"ll",day:"zz"},ru:{year:"",month:"",day:""},sc:{year:"aaaa",month:"mm",day:"dd"},scn:{year:"aaaa",month:"mm",day:"jj"},sk:{year:"rrrr",month:"mm",day:"dd"},sl:{year:"llll",month:"mm",day:"dd"},sr:{year:"",month:"",day:""},sv:{year:"",month:"mm",day:"dd"},szl:{year:"rrrr",month:"mm",day:"dd"},tg:{year:"",month:"",day:""},th:{year:"",month:"",day:""},tr:{year:"yyyy",month:"aa",day:"gg"},uk:{year:"",month:"",day:""},"zh-CN":{year:"",month:"",day:""},"zh-TW":{year:"",month:"",day:""}},"en");function Zae(t,e,r){return t==="era"||t==="dayPeriod"?e:t==="year"||t==="month"||t==="day"?qae.getStringForLocale(t,r):""}const Kg={year:!0,month:!0,day:!0,hour:!0,minute:!0,second:!0,dayPeriod:!0,era:!0},xP={year:5,month:2,day:7,hour:2,minute:15,second:15},Yae={dayperiod:"dayPeriod"};function bF(t){let{locale:e,createCalendar:r,hideTimeZone:n,isDisabled:i=!1,isReadOnly:a=!1,isRequired:o=!1,minValue:s,maxValue:l,isDateUnavailable:c}=t,d=t.value||t.defaultValue||t.placeholderValue||null,[h,p]=yF(d,t.granularity),m=p||"UTC";if(d&&!(h in d))throw new Error("Invalid granularity "+h+" for value "+d.toString());let g=D.useMemo(()=>new ba(e),[e]),y=D.useMemo(()=>r(g.resolvedOptions().calendar),[r,g]);var R;let[b,_]=Pi(t.value,(R=t.defaultValue)!==null&&R!==void 0?R:null,t.onChange),x=D.useMemo(()=>{var F;return(F=gF(b,y))!==null&&F!==void 0?F:null},[b,y]),[T,I]=D.useState(()=>ch(t.placeholderValue,h,y,p)),C=x||T,k=y.identifier==="gregory"&&C.era==="BC",S=D.useMemo(()=>{var F;return{granularity:h,maxGranularity:(F=t.maxGranularity)!==null&&F!==void 0?F:"year",timeZone:p,hideTimeZone:n,hourCycle:t.hourCycle,showEra:k,shouldForceLeadingZeros:t.shouldForceLeadingZeros}},[t.maxGranularity,h,t.hourCycle,t.shouldForceLeadingZeros,p,n,k]),V=D.useMemo(()=>yu({},S),[S]),z=D.useMemo(()=>new ba(e,V),[e,V]),j=D.useMemo(()=>z.resolvedOptions(),[z]),J=D.useMemo(()=>z.formatToParts(new Date).filter(F=>Kg[F.type]).reduce((F,se)=>(F[se.type]=!0,F),{}),[z]),[$,le]=D.useState(()=>t.value||t.defaultValue?{...J}:{}),ie=D.useRef(null),Z=D.useRef(y.identifier);D.useEffect(()=>{y.identifier!==Z.current&&(Z.current=y.identifier,I(F=>Object.keys($).length>0?lr(F,y):ch(t.placeholderValue,h,y,p)))},[y,h,$,p,t.placeholderValue]),b&&Object.keys($).length<Object.keys(J).length&&($={...J},le($)),b==null&&Object.keys($).length===Object.keys(J).length&&($={},le($),I(ch(t.placeholderValue,h,y,p)));let te=x&&Object.keys($).length>=Object.keys(J).length?x:T,H=F=>{if(t.isDisabled||t.isReadOnly)return;let se=Object.keys($),N=Object.keys(J);F==null?(_(null),I(ch(t.placeholderValue,h,y,p)),le({})):se.length>=N.length||se.length===N.length-1&&J.dayPeriod&&!$.dayPeriod&&ie.current!=="dayPeriod"?(F=lr(F,(d==null?void 0:d.calendar)||new Nn),_(F)):I(F),ie.current=null},fe=D.useMemo(()=>te.toDate(m),[te,m]),ne=D.useMemo(()=>Jae(fe,$,z,j,te,y,e,h),[fe,$,z,j,te,y,e,h]);J.era&&$.year&&!$.era?($.era=!0,le({...$})):!J.era&&$.era&&(delete $.era,le({...$}));let he=F=>{$[F]=!0,F==="year"&&J.era&&($.era=!0),le({...$})},oe=(F,se)=>{if($[F])H(Xae(te,F,se,j));else{he(F);let N=Object.keys($),ce=Object.keys(J);(N.length>=ce.length||N.length===ce.length-1&&J.dayPeriod&&!$.dayPeriod)&&H(te)}},me=D.useMemo(()=>W1(b,s,l,c,S),[b,s,l,c,S]),ee=S4({...t,value:b,builtinValidation:me}),Y=ee.displayValidation.isInvalid,q=t.validationState||(Y?"invalid":null);var X;return{...ee,value:x,dateValue:fe,calendar:y,setValue:H,segments:ne,dateFormatter:z,validationState:q,isInvalid:Y,granularity:h,maxGranularity:(X=t.maxGranularity)!==null&&X!==void 0?X:"year",isDisabled:i,isReadOnly:a,isRequired:o,increment(F){oe(F,1)},decrement(F){oe(F,-1)},incrementPage(F){oe(F,xP[F]||1)},decrementPage(F){oe(F,-(xP[F]||1))},setSegment(F,se){he(F),H(Qae(te,F,se,j))},confirmPlaceholder(){if(t.isDisabled||t.isReadOnly)return;let F=Object.keys($),se=Object.keys(J);F.length===se.length-1&&J.dayPeriod&&!$.dayPeriod&&($={...J},le($),H(te.copy()))},clearSegment(F){delete $[F],ie.current=F,le({...$});let se=ch(t.placeholderValue,h,y,p),N=te;if(F==="dayPeriod"&&"hour"in te&&"hour"in se){let ce=te.hour>=12,ue=se.hour>=12;ce&&!ue?N=te.set({hour:te.hour-12}):!ce&&ue&&(N=te.set({hour:te.hour+12}))}else F==="hour"&&"hour"in te&&te.hour>=12&&$.dayPeriod?N=te.set({hour:se.hour+12}):F in te&&(N=te.set({[F]:se[F]}));_(null),H(N)},formatValue(F){if(!x)return"";let se=yu(F,S);return new ba(e,se).format(fe)},getDateFormatter(F,se){let N={...S,...se},ce=yu({},N);return new ba(F,ce)}}}function Jae(t,e,r,n,i,a,o,s){let l=["hour","minute","second"],c=r.formatToParts(t),d=[];for(let h of c){let p=Kg[h.type];h.type==="era"&&a.getEras().length===1&&(p=!1);let m=Kg[h.type]&&!e[h.type],g=Kg[h.type]?Zae(h.type,h.value,o):null,y={type:Yae[h.type]||h.type,text:m?g:h.value,...sg(i,h.type,n),isPlaceholder:m,placeholder:g,isEditable:p};h.type==="hour"?(d.push({type:"literal",text:"",...sg(i,"literal",n),isPlaceholder:!1,placeholder:"",isEditable:!1}),d.push(y),h.type===s&&d.push({type:"literal",text:"",...sg(i,"literal",n),isPlaceholder:!1,placeholder:"",isEditable:!1})):l.includes(h.type)&&h.type===s?(d.push(y),d.push({type:"literal",text:"",...sg(i,"literal",n),isPlaceholder:!1,placeholder:"",isEditable:!1})):d.push(y)}return d}function sg(t,e,r){switch(e){case"era":{let n=t.calendar.getEras();return{value:n.indexOf(t.era),minValue:0,maxValue:n.length-1}}case"year":return{value:t.year,minValue:1,maxValue:t.calendar.getYearsInEra(t)};case"month":return{value:t.month,minValue:Cq(t),maxValue:t.calendar.getMonthsInYear(t)};case"day":return{value:t.day,minValue:Tq(t),maxValue:t.calendar.getDaysInMonth(t)}}if("hour"in t)switch(e){case"dayPeriod":return{value:t.hour>=12?12:0,minValue:0,maxValue:12};case"hour":if(r.hour12){let n=t.hour>=12;return{value:t.hour,minValue:n?12:0,maxValue:n?23:11}}return{value:t.hour,minValue:0,maxValue:23};case"minute":return{value:t.minute,minValue:0,maxValue:59};case"second":return{value:t.second,minValue:0,maxValue:59}}return{}}function Xae(t,e,r,n){switch(e){case"era":case"year":case"month":case"day":return t.cycle(e,r,{round:e==="year"})}if("hour"in t)switch(e){case"dayPeriod":{let i=t.hour,a=i>=12;return t.set({hour:a?i-12:i+12})}case"hour":case"minute":case"second":return t.cycle(e,r,{round:e!=="hour",hourCycle:n.hour12?12:24})}throw new Error("Unknown segment: "+e)}function Qae(t,e,r,n){switch(e){case"day":case"month":case"year":case"era":return t.set({[e]:r})}if("hour"in t&&typeof r=="number")switch(e){case"dayPeriod":{let i=t.hour,a=i>=12;return r>=12===a?t:t.set({hour:a?i-12:i+12})}case"hour":if(n.hour12){let a=t.hour>=12;!a&&r===12&&(r=0),a&&r<12&&(r+=12)}case"minute":case"second":return t.set({[e]:r})}throw new Error("Unknown segment: "+e)}function eoe(t){var e,r;let n=Ib(t),[i,a]=Pi(t.value,t.defaultValue||null,t.onChange),[o,s]=D.useState(()=>i||{start:null,end:null});i==null&&o.start&&o.end&&(o={start:null,end:null},s(o));let l=i||o,c=Z=>{s(Z||{start:null,end:null}),Ll(Z)?a(Z):a(null)},d=(l==null?void 0:l.start)||(l==null?void 0:l.end)||t.placeholderValue||null,[h,p]=yF(d,t.granularity),m=h==="hour"||h==="minute"||h==="second";var g;let y=(g=t.shouldCloseOnSelect)!==null&&g!==void 0?g:!0,[R,b]=D.useState(null),[_,x]=D.useState(null);l&&Ll(l)&&(R=l,"hour"in l.start&&(_=l));let T=(Z,te)=>{c({start:"timeZone"in te.start?te.start.set(Qn(Z.start)):no(Z.start,te.start),end:"timeZone"in te.end?te.end.set(Qn(Z.end)):no(Z.end,te.end)}),b(null),x(null),$.commitValidation()},I=Z=>{let te=typeof y=="function"?y():y;m?Ll(Z)&&(_!=null&&_.start)&&(_!=null&&_.end)?T(Z,{start:(_==null?void 0:_.start)||og(t.placeholderValue),end:(_==null?void 0:_.end)||og(t.placeholderValue)}):b(Z):Ll(Z)?(c(Z),$.commitValidation()):b(Z),te&&n.setOpen(!1)},C=Z=>{Ll(R)&&Ll(Z)?T(R,Z):x(Z)},k=(l==null||(e=l.start)===null||e===void 0?void 0:e.calendar.identifier)==="gregory"&&l.start.era==="BC"||(l==null||(r=l.end)===null||r===void 0?void 0:r.calendar.identifier)==="gregory"&&l.end.era==="BC",S=D.useMemo(()=>({granularity:h,timeZone:p,hideTimeZone:t.hideTimeZone,hourCycle:t.hourCycle,shouldForceLeadingZeros:t.shouldForceLeadingZeros,showEra:k}),[h,t.hourCycle,t.shouldForceLeadingZeros,p,t.hideTimeZone,k]),{minValue:V,maxValue:z,isDateUnavailable:j}=t,J=D.useMemo(()=>Hae(l,V,z,j,S),[l,V,z,j,S]),$=S4({...t,value:i,name:D.useMemo(()=>[t.startName,t.endName].filter(Z=>Z!=null),[t.startName,t.endName]),builtinValidation:J}),le=$.displayValidation.isInvalid,ie=t.validationState||(le?"invalid":null);return{...$,value:l,setValue:c,dateRange:R,timeRange:_,granularity:h,hasTime:m,setDate(Z,te){var H,fe;I(Z==="start"?{start:te,end:(H=R==null?void 0:R.end)!==null&&H!==void 0?H:null}:{start:(fe=R==null?void 0:R.start)!==null&&fe!==void 0?fe:null,end:te})},setTime(Z,te){var H,fe;C(Z==="start"?{start:te,end:(H=_==null?void 0:_.end)!==null&&H!==void 0?H:null}:{start:(fe=_==null?void 0:_.start)!==null&&fe!==void 0?fe:null,end:te})},setDateTime(Z,te){var H,fe;c(Z==="start"?{start:te,end:(H=l==null?void 0:l.end)!==null&&H!==void 0?H:null}:{start:(fe=l==null?void 0:l.start)!==null&&fe!==void 0?fe:null,end:te})},setDateRange:I,setTimeRange:C,...n,setOpen(Z){!Z&&!(l!=null&&l.start&&(l!=null&&l.end))&&Ll(R)&&m&&T(R,{start:(_==null?void 0:_.start)||og(t.placeholderValue),end:(_==null?void 0:_.end)||og(t.placeholderValue)}),n.setOpen(Z)},validationState:ie,isInvalid:le,formatValue(Z,te){if(!l||!l.start||!l.end)return null;let H="timeZone"in l.start?l.start.timeZone:void 0,fe=t.granularity||(l.start&&"minute"in l.start?"minute":"day"),ne="timeZone"in l.end?l.end.timeZone:void 0,he=t.granularity||(l.end&&"minute"in l.end?"minute":"day"),oe=yu(te,{granularity:fe,timeZone:H,hideTimeZone:t.hideTimeZone,hourCycle:t.hourCycle,showEra:l.start.calendar.identifier==="gregory"&&l.start.era==="BC"||l.end.calendar.identifier==="gregory"&&l.end.era==="BC"}),me=l.start.toDate(H||"UTC"),ee=l.end.toDate(ne||"UTC"),Y=new ba(Z,oe),q;if(H===ne&&fe===he&&l.start.compare(l.end)!==0){try{let X=Y.formatRangeToParts(me,ee),F=-1;for(let ce=0;ce<X.length;ce++){let ue=X[ce];if(ue.source==="shared"&&ue.type==="literal")F=ce;else if(ue.source==="endRange")break}let se="",N="";for(let ce=0;ce<X.length;ce++)ce<F?se+=X[ce].value:ce>F&&(N+=X[ce].value);return{start:se,end:N}}catch{}q=Y}else{let X=yu(te,{granularity:he,timeZone:ne,hideTimeZone:t.hideTimeZone,hourCycle:t.hourCycle});q=new ba(Z,X)}return{start:Y.format(me),end:q.format(ee)}},getDateFormatter(Z,te){let H={...S,...te},fe=yu({},H);return new ba(Z,fe)}}}function Ll(t){return(t==null?void 0:t.start)!=null&&t.end!=null}function toe(t){let{placeholderValue:e=new Pm,minValue:r,maxValue:n,granularity:i,validate:a}=t;var o;let[s,l]=Pi(t.value,(o=t.defaultValue)!==null&&o!==void 0?o:null,t.onChange),c=s||e,d=c&&"day"in c?c:void 0,h=t.defaultValue&&"timeZone"in t.defaultValue?t.defaultValue.timeZone:void 0,p=D.useMemo(()=>{let x=c&&"timeZone"in c?c.timeZone:void 0;return(x||h)&&e?h6(dh(e),x||h):dh(e)},[e,c,h]),m=D.useMemo(()=>dh(r,d),[r,d]),g=D.useMemo(()=>dh(n,d),[n,d]),y=D.useMemo(()=>s&&"day"in s?HR(s):s,[s]),R=D.useMemo(()=>s==null?null:dh(s),[s]);return{...bF({...t,value:R,defaultValue:void 0,minValue:m,maxValue:g,onChange:x=>{l(d||h?x:x&&HR(x))},granularity:i||"minute",maxGranularity:"hour",placeholderValue:p??void 0,createCalendar:()=>new Nn,validate:D.useCallback(()=>a==null?void 0:a(s),[a,s])}),timeValue:y}}function dh(t,e=fb(hb())){return t?"day"in t?t:no(e,t):null}function roe(t){var e,r;const n=ln(),{validationBehavior:i}=Mb(Vp)||{},[a,o]=la(t,d0.variantKeys),{ref:s,as:l,label:c,inputRef:d,description:h,startContent:p,endContent:m,className:g,classNames:y,groupProps:R={},labelProps:b,fieldProps:_,errorMessageProps:x,descriptionProps:T,validationBehavior:I=(e=i??(n==null?void 0:n.validationBehavior))!=null?e:"native",shouldForceLeadingZeros:C=!0,minValue:k,maxValue:S,isInvalid:V,errorMessage:z}=a,j=fr(s),J=fr(d),{locale:$}=sn(),le=(r=t.disableAnimation)!=null?r:n==null?void 0:n.disableAnimation,ie=toe({...t,label:c,locale:$,minValue:k,maxValue:S,validationBehavior:I,isInvalid:V,shouldForceLeadingZeros:C}),{labelProps:Z,fieldProps:te,inputProps:H,validationErrors:fe,validationDetails:ne,descriptionProps:he,errorMessageProps:oe,isInvalid:me}=mae({...t,label:c,validationBehavior:I,inputRef:J},ie,j),ee=qe(y==null?void 0:y.base,g),Y=h4({labelPlacement:t.labelPlacement,label:c}),q=Y==="outside"||Y==="outside-left",X=D.useMemo(()=>d0({...o,disableAnimation:le,labelPlacement:Y}),[Ri(o),Y,le]),F=$e=>({...Oe(Z,b,$e),"data-slot":"label",className:X.label({class:qe(y==null?void 0:y.label,void 0)})}),se=$e=>({...$e,...H,ref:J}),N=($e={})=>({ref:j,"data-slot":"input",...Oe(te,_,$e),className:X.input({class:qe(y==null?void 0:y.input,$e==null?void 0:$e.className)})}),ce=($e={})=>({...$e,...R,"data-slot":"input-wrapper",className:X.inputWrapper({class:y==null?void 0:y.inputWrapper}),onClick:te.onClick}),ue=$e=>({...$e,"data-slot":"inner-wrapper",className:X.innerWrapper({class:y==null?void 0:y.innerWrapper})}),pe=$e=>({...$e,"data-slot":"helper-wrapper",className:X.helperWrapper({class:qe(y==null?void 0:y.helperWrapper,void 0)})}),be=($e={})=>({...Oe(oe,x,$e),"data-slot":"error-message",className:X.errorMessage({class:qe(y==null?void 0:y.errorMessage,$e==null?void 0:$e.className)})}),we=($e={})=>({...Oe(he,T,$e),"data-slot":"description",className:X.description({class:qe(y==null?void 0:y.description,$e==null?void 0:$e.className)})});return{state:ie,domRef:j,slots:X,classNames:y,labelPlacement:Y,getBaseGroupProps:()=>({as:l,label:c,description:h,endContent:m,errorMessage:z,isInvalid:me,startContent:p,validationDetails:ne,validationErrors:fe,shouldLabelBeOutside:q,"data-slot":"base","data-required":Te(t.isRequired),"data-disabled":Te(t.isDisabled),"data-readonly":Te(t.isReadOnly),"data-invalid":Te(me),"data-has-start-content":Te(!!p),"data-has-end-content":Te(!!m),descriptionProps:we(),errorMessageProps:be(),groupProps:ce(),helperWrapperProps:pe(),labelProps:F(),wrapperProps:ue(),className:X.base({class:ee})}),getFieldProps:N,getInputProps:se}}var noe=Qt(function(e,r){const{state:n,slots:i,classNames:a,getBaseGroupProps:o,getInputProps:s,getFieldProps:l}=roe({...e,ref:r});return O.jsx(T4,{...o(),children:O.jsx(kU,{classNames:a,inputProps:s(),slots:i,state:n,...l()})})}),CP=noe,ioe={"ar-AE":{endTime:" ",startTime:" ",time:""},"bg-BG":{endTime:" ",startTime:" ",time:""},"cs-CZ":{endTime:"Konen as",startTime:"Poten as",time:"as"},"da-DK":{endTime:"Sluttidspunkt",startTime:"Starttidspunkt",time:"Klokkeslt"},"de-DE":{endTime:"Endzeit",startTime:"Startzeit",time:"Uhrzeit"},"el-GR":{endTime:" ",startTime:" ",time:""},"en-US":{time:"Time",startTime:"Start time",endTime:"End time"},"es-ES":{endTime:"Hora de finalizacin",startTime:"Hora de inicio",time:"Hora"},"et-EE":{endTime:"Lpuaeg",startTime:"Algusaeg",time:"Aeg"},"fi-FI":{endTime:"Pttymisaika",startTime:"Alkamisaika",time:"Aika"},"fr-FR":{endTime:"Heure de fin",startTime:"Heure de dbut",time:"Heure"},"he-IL":{endTime:" ",startTime:" ",time:""},"hr-HR":{endTime:"Vrijeme zavretka",startTime:"Vrijeme poetka",time:"Vrijeme"},"hu-HU":{endTime:"Befejezs ideje",startTime:"Kezds ideje",time:"Id"},"it-IT":{endTime:"Ora di fine",startTime:"Ora di inizio",time:"Ora"},"ja-JP":{endTime:"",startTime:"",time:""},"ko-KR":{endTime:" ",startTime:" ",time:""},"it-LT":{endTime:"Pabaigos laikas",startTime:"Pradios laikas",time:"Laikas"},"lv-LV":{endTime:"Beigu laiks",startTime:"Skuma laiks",time:"Laiks"},"nb-NO":{endTime:"Sluttid",startTime:"Starttid",time:"Tid"},"nl-NL":{endTime:"Eindtijd",startTime:"Starttijd",time:"Tijd"},"pl-PL":{endTime:"Godzina kocowa",startTime:"Godzina pocztkowa",time:"Godzina"},"pt-BR":{endTime:"Hora final",startTime:"Hora inicial",time:"Hora"},"pt-PT":{endTime:"Terminar tempo",startTime:"Iniciar tempo",time:"Tempo"},"ro-RO":{endTime:"Ora de sfrit",startTime:"Ora de nceput",time:"Ora"},"ru-RU":{endTime:" ",startTime:" ",time:""},"sk-SK":{endTime:"as ukonenia",startTime:"as zaiatku",time:"as"},"sl-SI":{endTime:"Konni as",startTime:"Zaetni as",time:"as"},"sr-SP":{endTime:"Zavrno vreme",startTime:"Poetno vreme",time:"Vreme"},"sv-SE":{endTime:"Sluttid",startTime:"Starttid",time:"Tid"},"tr-TR":{endTime:"Biti saati",startTime:"Balang saati",time:"Saat"},"uk-UA":{endTime:" ",startTime:" ",time:""},"zh-CN":{endTime:"",startTime:"",time:""},"zh-TW":{endTime:"",startTime:"",time:""}};function aoe(t){var e,r,n,i;const a=ln(),[o,s]=la(t,d0.variantKeys),{as:l,ref:c,label:d,endContent:h,selectorIcon:p,inputRef:m,isInvalid:g,errorMessage:y,description:R,startContent:b,validationState:_,validationBehavior:x,visibleMonths:T=1,firstDayOfWeek:I,pageBehavior:C="visible",calendarWidth:k=256,isDateUnavailable:S,shouldForceLeadingZeros:V,showMonthAndYearPickers:z=!1,selectorButtonProps:j={},popoverProps:J={},timeInputProps:$={},calendarProps:le={},CalendarTopContent:ie,CalendarBottomContent:Z,createCalendar:te}=o,{isHeaderExpanded:H,isHeaderDefaultExpanded:fe,onHeaderExpandedChange:ne,...he}=le,oe=D.useCallback(ze=>{ne==null||ne(ze||!1)},[ne]),[me,ee]=Pi(H,fe??!1,oe),Y=fr(c),q=(r=(e=t.disableAnimation)!=null?e:a==null?void 0:a.disableAnimation)!=null?r:!1;let X=Ra(ioe);const F=t.color==="default"||!t.color,se=T>1,N=t==null?void 0:t.placeholderValue,ce=N&&"hour"in N?N:null,ue=t.minValue&&"hour"in t.minValue?t.minValue:null,pe=t.maxValue&&"hour"in t.maxValue?t.maxValue:null,be={popoverProps:Oe({offset:13,placement:"bottom",triggerScaleOnOpen:!1,disableAnimation:q},J),selectorButtonProps:Oe({isIconOnly:!0,radius:"full",size:"sm",variant:"light",disableAnimation:q},j),calendarProps:Oe({showHelper:!1,visibleMonths:T,pageBehavior:C,isDateUnavailable:S,showMonthAndYearPickers:z,isHeaderExpanded:me,onHeaderExpandedChange:ee,color:F?"primary":t.color,disableAnimation:q,firstDayOfWeek:I},he)},we={as:l,label:d,ref:Y,inputRef:m,description:R,validationState:_,shouldForceLeadingZeros:V,isInvalid:g,errorMessage:y,validationBehavior:x,"data-invalid":Te(t==null?void 0:t.isInvalid)},Ce={...$,size:"sm",labelPlacement:"outside-left",label:($==null?void 0:$.label)||X.format("time"),placeholderValue:ce,hourCycle:o.hourCycle,hideTimeZone:o.hideTimeZone,validationBehavior:x},$e={...be.popoverProps,children:(i=(n=be.popoverProps)==null?void 0:n.children)!=null?i:[],triggerRef:Y},Ne={...be.calendarProps,calendarWidth:k,"data-slot":"calendar"},Ie={...be.selectorButtonProps,"data-slot":"selector-button"};return{domRef:Y,startContent:b,endContent:h,selectorIcon:p,createCalendar:te,stringFormatter:X,hasMultipleMonths:se,slotsProps:be,timeMinValue:ue,timeMaxValue:pe,visibleMonths:T,isCalendarHeaderExpanded:me,disableAnimation:q,CalendarTopContent:ie,CalendarBottomContent:Z,variantProps:s,dateInputProps:we,timeInputProps:Ce,popoverProps:$e,calendarProps:Ne,userTimeInputProps:$,selectorButtonProps:Ie,selectorIconProps:{"data-slot":"selector-icon"},onClose:()=>{H===void 0&&ee(!1)}}}var ooe=D.forwardRef(function(e,r){const{as:n,slots:i,createCalendar:a,classNames:o,...s}=e,l=n||"div",c=fr(r),{locale:d}=sn();let h=bF({...s,locale:d,createCalendar:!a||typeof a!="function"?TT:a});const p=D.useRef(null),{fieldProps:m,inputProps:g,isInvalid:y}=W8({...s,inputRef:p},h,c),R=e.isInvalid||y;return h.isInvalid=R,O.jsxs(l,{...Oe(m,Mi(s)),ref:c,children:[h.segments.map((b,_)=>O.jsx(AU,{classNames:o,segment:b,slots:i,state:h},_)),O.jsx("input",{...g,ref:p})]})}),TP=ooe;function soe({as:t,label:e,isInvalid:r,description:n,startContent:i,endContent:a,selectorIcon:o,errorMessage:s,className:l,classNames:c,...d}){var h,p,m;const g=ln(),{validationBehavior:y}=Mb(Vp)||{},R=(m=(p=(h=d.validationBehavior)!=null?h:y)!=null?p:g==null?void 0:g.validationBehavior)!=null?m:"native",{domRef:b,slotsProps:_,createCalendar:x,stringFormatter:T,timeMinValue:I,timeMaxValue:C,isCalendarHeaderExpanded:k,disableAnimation:S,CalendarTopContent:V,CalendarBottomContent:z,timeInputProps:j,popoverProps:J,calendarProps:$,variantProps:le,userTimeInputProps:ie,hasMultipleMonths:Z,selectorButtonProps:te,selectorIconProps:H}=aoe({...d,validationBehavior:R});let fe=eoe({...d,validationBehavior:R,shouldCloseOnSelect:()=>!fe.hasTime});const ne=D.useRef(null);let{groupProps:he,labelProps:oe,startFieldProps:me,endFieldProps:ee,buttonProps:Y,dialogProps:q,calendarProps:X,validationDetails:F,validationErrors:se,descriptionProps:N,errorMessageProps:ce,isInvalid:ue}=zae({...d,validationBehavior:R},fe,b);const pe=r||ue,be=D.useMemo(()=>Are({...le,className:l}),[Ri(le),l]),we=fe.granularity==="hour"||fe.granularity==="minute"||fe.granularity==="second"?fe.granularity:null,Ce=!!we,$e=h4({labelPlacement:d.labelPlacement,label:e}),Ne=$e==="outside"||$e==="outside-left",Ie=()=>{var Ee,ke,pt;return Ce?{...j,label:T.format("startTime"),value:((Ee=fe.timeRange)==null?void 0:Ee.start)||null,onChange:gt=>fe.setTime("start",gt),granularity:we,minValue:I,maxValue:C,classNames:{base:be.timeInput({class:qe(c==null?void 0:c.timeInput,(ke=ie==null?void 0:ie.classNames)==null?void 0:ke.base)}),label:be.timeInputLabel({class:qe(c==null?void 0:c.timeInputLabel,(pt=ie==null?void 0:ie.classNames)==null?void 0:pt.label)})}}:{}},Ge=()=>{var Ee,ke,pt;return Ce?{...j,label:T.format("endTime"),value:((Ee=fe.timeRange)==null?void 0:Ee.end)||null,onChange:gt=>fe.setTime("end",gt),granularity:we,minValue:I,maxValue:C,classNames:{base:be.timeInput({class:qe(c==null?void 0:c.timeInput,(ke=ie==null?void 0:ie.classNames)==null?void 0:ke.base)}),label:be.timeInputLabel({class:qe(c==null?void 0:c.timeInputLabel,(pt=ie==null?void 0:ie.classNames)==null?void 0:pt.label)})}}:{}},nt=(Ee={})=>{var ke,pt;return{state:fe,dialogProps:q,...Ee,...J,triggerRef:ne,classNames:{content:be.popoverContent({class:qe(c==null?void 0:c.popoverContent,(pt=(ke=_.popoverProps)==null?void 0:ke.classNames)==null?void 0:pt.content,Ee.className)}),shouldCloseOnInteractOutside:J!=null&&J.shouldCloseOnInteractOutside?J.shouldCloseOnInteractOutside:gt=>y4(gt,ne,fe)}}},ze=()=>{var Ee,ke;return{...X,...$,classNames:{...$.classNames,base:be.calendar({class:GI((Ee=$==null?void 0:$.classNames)==null?void 0:Ee.base,c==null?void 0:c.calendar)}),content:be.calendarContent({class:GI((ke=$==null?void 0:$.classNames)==null?void 0:ke.content,c==null?void 0:c.calendarContent)})}}},Pe=()=>({...Y,...te,onPress:fe.toggle,className:be.selectorButton({class:c==null?void 0:c.selectorButton})}),vt=()=>({"data-slot":"separator",className:be.separator({class:c==null?void 0:c.separator})}),Tt=()=>({...H,className:be.selectorIcon({class:c==null?void 0:c.selectorIcon})}),ir=qe(c==null?void 0:c.base,l),B=D.useMemo(()=>d0({...le,labelPlacement:$e}),[Ri(le)]),M=(Ee={})=>({...me,isInvalid:pe,"data-slot":"start-input",slots:B,createCalendar:x,...Oe(le,me,{fullWidth:!0,disableAnimation:S}),"data-open":Te(fe.isOpen),classNames:c,style:{...Ee.style,maxWidth:"fit-content"},className:B.input({class:qe(c==null?void 0:c.input,Ee==null?void 0:Ee.className)})}),P=(Ee={})=>({...ee,isInvalid:pe,"data-slot":"end-input",slots:B,createCalendar:x,...Oe(le,ee,{fullWidth:!0,disableAnimation:S}),"data-open":Te(fe.isOpen),classNames:c,className:B.input({class:qe(c==null?void 0:c.input,Ee==null?void 0:Ee.className)})}),G=Ee=>({...Ee,...oe,"data-slot":"label",className:B.label({class:qe(c==null?void 0:c.label,void 0)})}),re=(Ee={})=>({ref:b,...Ee,...he,"data-slot":"input-wrapper",className:B.inputWrapper({class:c==null?void 0:c.inputWrapper}),onClick:oe.onClick}),Q=Ee=>({...Ee,ref:ne,"data-slot":"inner-wrapper",className:B.innerWrapper({class:c==null?void 0:c.innerWrapper})}),ae=Ee=>({...Ee,"data-slot":"helper-wrapper",className:B.helperWrapper({class:qe(c==null?void 0:c.helperWrapper,void 0)})}),ve=(Ee={})=>({...Ee,...ce,"data-slot":"error-message",className:B.errorMessage({class:qe(c==null?void 0:c.errorMessage,Ee==null?void 0:Ee.className)})}),xe=(Ee={})=>({...Ee,...N,"data-slot":"description",className:B.description({class:qe(c==null?void 0:c.description,Ee==null?void 0:Ee.className)})});return{state:fe,label:e,slots:be,classNames:c,startContent:i,endContent:a,selectorIcon:o,showTimeField:Ce,isCalendarHeaderExpanded:k,disableAnimation:S,CalendarTopContent:V,CalendarBottomContent:z,getStartDateInputProps:M,getEndDateInputProps:P,getStartTimeInputProps:Ie,getEndTimeInputProps:Ge,getPopoverProps:nt,getSelectorButtonProps:Pe,getCalendarProps:ze,getSeparatorProps:vt,getSelectorIconProps:Tt,getDateInputGroupProps:()=>({as:t,label:e,description:n,endContent:a,errorMessage:s,isInvalid:pe,validationDetails:F,validationErrors:se,shouldLabelBeOutside:Ne,"data-slot":"base","data-required":Te(d.isRequired),"data-disabled":Te(d.isDisabled),"data-readonly":Te(d.isReadOnly),"data-invalid":Te(pe),"data-has-start-content":Te(!!i),"data-has-multiple-months":Te(Z),"data-has-end-content":Te(!!a),descriptionProps:xe(),errorMessageProps:ve(),groupProps:re(),helperWrapperProps:ae(),labelProps:G(),wrapperProps:Q(),className:B.base({class:ir})})}}var loe=Qt(function(e,r){const{selectorButtonPlacement:n="end",...i}=e,{state:a,slots:o,startContent:s,endContent:l,selectorIcon:c,showTimeField:d,classNames:h,disableAnimation:p,isCalendarHeaderExpanded:m,getDateInputGroupProps:g,getStartDateInputProps:y,getEndDateInputProps:R,getPopoverProps:b,getSeparatorProps:_,getStartTimeInputProps:x,getEndTimeInputProps:T,getSelectorButtonProps:I,getSelectorIconProps:C,getCalendarProps:k,CalendarTopContent:S,CalendarBottomContent:V}=soe({...i,ref:r}),z=D.isValidElement(c)?D.cloneElement(c,C()):O.jsx(Gre,{...C()}),j=D.useMemo(()=>m?null:d?O.jsxs("div",{className:o==null?void 0:o.bottomContent({class:h==null?void 0:h.bottomContent}),children:[O.jsxs("div",{className:o==null?void 0:o.timeInputWrapper({class:h==null?void 0:h.timeInputWrapper}),children:[O.jsx(CP,{...x()}),O.jsx(CP,{...T()})]}),V]}):V,[a,d,V,m]),J=D.useMemo(()=>m?null:S,[d,S,m]),$=a.isOpen?O.jsx(sie,{...b(),offset:20,children:O.jsx(hae,{...k(),bottomContent:j,topContent:J})}):null,le={...g(),endContent:n==="end"?O.jsx(An,{...I(),children:l||z}):l,startContent:n==="start"?O.jsx(An,{...I(),children:s||z}):s};return O.jsxs(O.Fragment,{children:[O.jsxs(T4,{...le,children:[O.jsx(TP,{...y()}),O.jsx("span",{..._(),"aria-hidden":"true",role:"separator",children:"-"}),O.jsx(TP,{...R()})]}),p?$:O.jsx(Gu,{children:$})]})}),uoe=loe,_F={};_F={close:"",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)} `,other:()=>`${e.number(t.count)} `})}.`};var SF={};SF={close:"",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)} `,other:()=>`${e.number(t.count)} `})}.`};var wF={};wF={close:"Zavt",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)} oznmen`,other:()=>`${e.number(t.count)} oznmen`})}.`};var EF={};EF={close:"Luk",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)} besked`,other:()=>`${e.number(t.count)} beskeder`})}.`};var xF={};xF={close:"Schlieen",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)} Benachrichtigung`,other:()=>`${e.number(t.count)} Benachrichtigungen`})}.`};var CF={};CF={close:"",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)} `,other:()=>`${e.number(t.count)} `})}.`};var TF={};TF={close:"Close",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)} notification`,other:()=>`${e.number(t.count)} notifications`})}.`};var DF={};DF={close:"Cerrar",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)} notificacin`,other:()=>`${e.number(t.count)} notificaciones`})}.`};var RF={};RF={close:"Sule",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)} teatis`,other:()=>`${e.number(t.count)} teatist`})}.`};var MF={};MF={close:"Sulje",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)} ilmoitus`,other:()=>`${e.number(t.count)} ilmoitusta`})}.`};var IF={};IF={close:"Fermer",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)} notification`,other:()=>`${e.number(t.count)} notifications`})}.`};var PF={};PF={close:"",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)} `,other:()=>`${e.number(t.count)} `})}.`};var AF={};AF={close:"Zatvori",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)} obavijest`,other:()=>`${e.number(t.count)} obavijesti`})}.`};var kF={};kF={close:"Bezrs",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)} rtests`,other:()=>`${e.number(t.count)} rtests`})}.`};var OF={};OF={close:"Chiudi",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)} notifica`,other:()=>`${e.number(t.count)} notifiche`})}.`};var $F={};$F={close:"",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)} `,other:()=>`${e.number(t.count)} `})}`};var LF={};LF={close:"",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)} `,other:()=>`${e.number(t.count)} `})}.`};var BF={};BF={close:"Udaryti",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)} praneimas`,other:()=>`${e.number(t.count)} praneimai`})}.`};var NF={};NF={close:"Aizvrt",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)} paziojums`,other:()=>`${e.number(t.count)} paziojumi`})}.`};var UF={};UF={close:"Lukk",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)} varsling`,other:()=>`${e.number(t.count)} varsler`})}.`};var FF={};FF={close:"Sluiten",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)} melding`,other:()=>`${e.number(t.count)} meldingen`})}.`};var jF={};jF={close:"Zamknij",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)} powiadomienie`,few:()=>`${e.number(t.count)} powiadomienia`,many:()=>`${e.number(t.count)} powiadomie`,other:()=>`${e.number(t.count)} powiadomienia`})}.`};var VF={};VF={close:"Fechar",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)} notificao`,other:()=>`${e.number(t.count)} notificaes`})}.`};var zF={};zF={close:"Fechar",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)} notificao`,other:()=>`${e.number(t.count)} notificaes`})}.`};var KF={};KF={close:"nchidei",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)} notificare`,other:()=>`${e.number(t.count)} notificri`})}.`};var HF={};HF={close:"",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)} `,other:()=>`${e.number(t.count)} `})}.`};var WF={};WF={close:"Zatvori",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)} oznmenie`,few:()=>`${e.number(t.count)} oznmenia`,other:()=>`${e.number(t.count)} oznmen`})}.`};var GF={};GF={close:"Zapri",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)} obvestilo`,two:()=>`${e.number(t.count)} obvestili`,few:()=>`${e.number(t.count)} obvestila`,other:()=>`${e.number(t.count)} obvestil`})}.`};var qF={};qF={close:"Zatvori",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)} obavetenje`,other:()=>`${e.number(t.count)} obavetenja`})}.`};var ZF={};ZF={close:"Stng",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)} meddelande`,other:()=>`${e.number(t.count)} meddelanden`})}.`};var YF={};YF={close:"Kapat",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)} bildirim`,other:()=>`${e.number(t.count)} bildirim`})}.`};var JF={};JF={close:"",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)} `,other:()=>`${e.number(t.count)} `})}.`};var XF={};XF={close:"",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)} `,other:()=>`${e.number(t.count)} `})}`};var QF={};QF={close:"",notifications:(t,e)=>`${e.plural(t.count,{one:()=>`${e.number(t.count)} `,other:()=>`${e.number(t.count)} `})}`};var D4={};D4={"ar-AE":_F,"bg-BG":SF,"cs-CZ":wF,"da-DK":EF,"de-DE":xF,"el-GR":CF,"en-US":TF,"es-ES":DF,"et-EE":RF,"fi-FI":MF,"fr-FR":IF,"he-IL":PF,"hr-HR":AF,"hu-HU":kF,"it-IT":OF,"ja-JP":$F,"ko-KR":LF,"lt-LT":BF,"lv-LV":NF,"nb-NO":UF,"nl-NL":FF,"pl-PL":jF,"pt-BR":VF,"pt-PT":zF,"ro-RO":KF,"ru-RU":HF,"sk-SK":WF,"sl-SI":GF,"sr-SP":qF,"sv-SE":ZF,"tr-TR":YF,"uk-UA":JF,"zh-CN":XF,"zh-TW":QF};function coe(t){return t&&t.__esModule?t.default:t}function doe(t,e,r){let{key:n,timer:i,timeout:a}=t.toast;D.useEffect(()=>{if(!(i==null||a==null))return i.reset(a),()=>{i.pause()}},[i,a]);let o=Ii(),s=nl(),l=Ra(coe(D4),"@react-aria/toast"),[c,d]=D.useState(!1);return D.useEffect(()=>{d(!0)},[]),{toastProps:{role:"alertdialog","aria-modal":"false","aria-label":t["aria-label"],"aria-labelledby":t["aria-labelledby"]||o,"aria-describedby":t["aria-describedby"]||s,"aria-details":t["aria-details"],tabIndex:0},contentProps:{role:"alert","aria-atomic":"true","aria-hidden":c?void 0:"true"},titleProps:{id:o},descriptionProps:{id:s},closeButtonProps:{"aria-label":l.format("close"),onPress:()=>e.close(n)}}}const foe=typeof document<"u"?We.useLayoutEffect:()=>{};var e9={exports:{}},t9={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Wd=D;function hoe(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var poe=typeof Object.is=="function"?Object.is:hoe,moe=Wd.useState,voe=Wd.useEffect,goe=Wd.useLayoutEffect,yoe=Wd.useDebugValue;function boe(t,e){var r=e(),n=moe({inst:{value:r,getSnapshot:e}}),i=n[0].inst,a=n[1];return goe(function(){i.value=r,i.getSnapshot=e,rw(i)&&a({inst:i})},[t,r,e]),voe(function(){return rw(i)&&a({inst:i}),t(function(){rw(i)&&a({inst:i})})},[t]),yoe(r),r}function rw(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!poe(t,r)}catch{return!0}}function _oe(t,e){return e()}var Soe=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?_oe:boe;t9.useSyncExternalStore=Wd.useSyncExternalStore!==void 0?Wd.useSyncExternalStore:Soe;e9.exports=t9;var r9=e9.exports;const n9=1,nw=Symbol.for("react-aria-landmark-manager");function woe(t){return document.addEventListener("react-aria-landmark-manager-change",t),()=>document.removeEventListener("react-aria-landmark-manager-change",t)}function DP(){if(typeof document>"u")return null;let t=document[nw];return t&&t.version>=n9?t:(document[nw]=new xoe,document.dispatchEvent(new CustomEvent("react-aria-landmark-manager-change")),document[nw])}function Eoe(){return r9.useSyncExternalStore(woe,DP,DP)}class xoe{setupIfNeeded(){this.isListening||(document.addEventListener("keydown",this.f6Handler,{capture:!0}),document.addEventListener("focusin",this.focusinHandler,{capture:!0}),document.addEventListener("focusout",this.focusoutHandler,{capture:!0}),this.isListening=!0)}teardownIfNeeded(){!this.isListening||this.landmarks.length>0||this.refCount>0||(document.removeEventListener("keydown",this.f6Handler,{capture:!0}),document.removeEventListener("focusin",this.focusinHandler,{capture:!0}),document.removeEventListener("focusout",this.focusoutHandler,{capture:!0}),this.isListening=!1)}focusLandmark(e,r){var n,i;(i=this.landmarks.find(a=>a.ref.current===e))===null||i===void 0||(n=i.focus)===null||n===void 0||n.call(i,r)}getLandmarksByRole(e){return new Set(this.landmarks.filter(r=>r.role===e))}getLandmarkByRole(e){return this.landmarks.find(r=>r.role===e)}addLandmark(e){if(this.setupIfNeeded(),this.landmarks.find(i=>i.ref===e.ref)||!e.ref.current)return;if(this.landmarks.filter(i=>i.role==="main").length>1,this.landmarks.length===0){this.landmarks=[e],this.checkLabels(e.role);return}let r=0,n=this.landmarks.length-1;for(;r<=n;){let i=Math.floor((r+n)/2),a=e.ref.current.compareDocumentPosition(this.landmarks[i].ref.current);!!(a&Node.DOCUMENT_POSITION_PRECEDING||a&Node.DOCUMENT_POSITION_CONTAINS)?r=i+1:n=i-1}this.landmarks.splice(r,0,e),this.checkLabels(e.role)}updateLandmark(e){let r=this.landmarks.findIndex(n=>n.ref===e.ref);r>=0&&(this.landmarks[r]={...this.landmarks[r],...e},this.checkLabels(this.landmarks[r].role))}removeLandmark(e){this.landmarks=this.landmarks.filter(r=>r.ref!==e),this.teardownIfNeeded()}checkLabels(e){let r=this.getLandmarksByRole(e);r.size>1&&[...r].filter(n=>!n.label)}closestLandmark(e){let r=new Map(this.landmarks.map(i=>[i.ref.current,i])),n=e;for(;n&&!r.has(n)&&n!==document.body&&n.parentElement;)n=n.parentElement;return r.get(n)}getNextLandmark(e,{backward:r}){var n;let i=this.closestLandmark(e),a=r?this.landmarks.length-1:0;i&&(a=this.landmarks.indexOf(i)+(r?-1:1));let o=()=>{if(a<0){if(!e.dispatchEvent(new CustomEvent("react-aria-landmark-navigation",{detail:{direction:"backward"},bubbles:!0,cancelable:!0})))return!0;a=this.landmarks.length-1}else if(a>=this.landmarks.length){if(!e.dispatchEvent(new CustomEvent("react-aria-landmark-navigation",{detail:{direction:"forward"},bubbles:!0,cancelable:!0})))return!0;a=0}return a<0||a>=this.landmarks.length};if(o())return;let s=a;for(;!((n=this.landmarks[a].ref.current)===null||n===void 0)&&n.closest("[aria-hidden=true]");){if(a+=r?-1:1,o())return;if(a===s)break}return this.landmarks[a]}f6Handler(e){e.key==="F6"&&(e.altKey?this.focusMain():this.navigate(e.target,e.shiftKey))&&(e.preventDefault(),e.stopPropagation())}focusMain(){let e=this.getLandmarkByRole("main");return e&&e.ref.current&&document.contains(e.ref.current)?(this.focusLandmark(e.ref.current,"forward"),!0):!1}navigate(e,r){let n=this.getNextLandmark(e,{backward:r});if(!n)return!1;if(n.lastFocused){let i=n.lastFocused;if(document.body.contains(i))return i.focus(),!0}return n.ref.current&&document.contains(n.ref.current)?(this.focusLandmark(n.ref.current,r?"backward":"forward"),!0):!1}focusinHandler(e){let r=this.closestLandmark(e.target);r&&r.ref.current!==e.target&&this.updateLandmark({ref:r.ref,lastFocused:e.target});let n=e.relatedTarget;if(n){let i=this.closestLandmark(n);i&&i.ref.current===n&&i.blur()}}focusoutHandler(e){let r=e.target,n=e.relatedTarget;if(!n||n===document){let i=this.closestLandmark(r);i&&i.ref.current===r&&i.blur()}}createLandmarkController(){let e=this;return e.refCount++,e.setupIfNeeded(),{navigate(r,n){let i=(n==null?void 0:n.from)||document.activeElement;return e.navigate(i,r==="backward")},focusNext(r){let n=(r==null?void 0:r.from)||document.activeElement;return e.navigate(n,!1)},focusPrevious(r){let n=(r==null?void 0:r.from)||document.activeElement;return e.navigate(n,!0)},focusMain(){return e.focusMain()},dispose(){e&&(e.refCount--,e.teardownIfNeeded(),e=null)}}}registerLandmark(e){return this.landmarks.find(r=>r.ref===e.ref)?this.updateLandmark(e):this.addLandmark(e),()=>this.removeLandmark(e.ref)}constructor(){this.landmarks=[],this.isListening=!1,this.refCount=0,this.version=n9,this.f6Handler=this.f6Handler.bind(this),this.focusinHandler=this.focusinHandler.bind(this),this.focusoutHandler=this.focusoutHandler.bind(this)}}function Coe(t,e){const{role:r,"aria-label":n,"aria-labelledby":i,focus:a}=t;let o=Eoe(),s=n||i,[l,c]=D.useState(!1),d=D.useCallback(()=>{c(!0)},[c]),h=D.useCallback(()=>{c(!1)},[c]);return foe(()=>{if(o)return o.registerLandmark({ref:e,label:s,role:r,focus:a||d,blur:h})},[o,s,e,r,a,d,h]),D.useEffect(()=>{var p;l&&((p=e.current)===null||p===void 0||p.focus())},[l,e]),{landmarkProps:{role:r,tabIndex:l?-1:void 0,"aria-label":n,"aria-labelledby":i}}}function Toe(t){return t&&t.__esModule?t.default:t}function Doe(t,e,r){let n=Ra(Toe(D4),"@react-aria/toast"),{landmarkProps:i}=Coe({role:"region","aria-label":t["aria-label"]||n.format("notifications",{count:e.visibleToasts.length})},r),a=D.useRef(!1),o=D.useRef(!1),s=rn(()=>{a.current||o.current?e.pauseAll():e.resumeAll()}),{hoverProps:l}=aa({onHoverStart:()=>{a.current=!0,s()},onHoverEnd:()=>{a.current=!1,s()}}),c=D.useRef([]),d=D.useRef(e.visibleToasts),h=D.useRef(null);qt(()=>{if(h.current===-1||e.visibleToasts.length===0||!r.current){c.current=[],d.current=e.visibleToasts;return}if(c.current=[...r.current.querySelectorAll('[role="alertdialog"]')],d.current.length===e.visibleToasts.length&&e.visibleToasts.every((b,_)=>b.key===d.current[_].key)){d.current=e.visibleToasts;return}let g=d.current.map((b,_)=>({...b,i:_,isRemoved:!e.visibleToasts.some(x=>b.key===x.key)})),y=g.findIndex(b=>b.i===h.current&&b.isRemoved);if(y>-1){var R;if(il()==="pointer"&&(!((R=p.current)===null||R===void 0)&&R.isConnected))wn(p.current);else{let b=0,_,x;for(;b<=y;)g[b].isRemoved||(x=Math.max(0,b-1)),b++;for(;b<g.length;){if(!g[b].isRemoved){_=b-1;break}b++}x===void 0&&_===void 0&&(x=0),x>=0&&x<c.current.length?wn(c.current[x]):_>=0&&_<c.current.length&&wn(c.current[_])}}d.current=e.visibleToasts},[e.visibleToasts,r,s]);let p=D.useRef(null),{focusWithinProps:m}=wl({onFocusWithin:g=>{o.current=!0,p.current=g.relatedTarget,s()},onBlurWithin:()=>{o.current=!1,p.current=null,s()}});return D.useEffect(()=>{var g;e.visibleToasts.length===0&&(!((g=p.current)===null||g===void 0)&&g.isConnected)&&(il()==="pointer"?wn(p.current):p.current.focus(),p.current=null)},[r,e.visibleToasts.length]),D.useEffect(()=>()=>{var g;!((g=p.current)===null||g===void 0)&&g.isConnected&&(il()==="pointer"?wn(p.current):p.current.focus(),p.current=null)},[r]),{regionProps:Oe(i,l,m,{tabIndex:-1,"data-react-aria-top-layer":!0,onFocus:g=>{let y=g.target.closest('[role="alertdialog"]');h.current=c.current.findIndex(R=>R===y)},onBlur:()=>{h.current=-1}})}}var RP=100,MP=20;function Roe(t){var e,r;const[n,i]=la(t,NI.variantKeys),{ref:a,as:o,title:s,description:l,className:c,classNames:d,toast:h,endContent:p,closeIcon:m,hideIcon:g=!1,placement:y="bottom-right",isRegionExpanded:R,hideCloseButton:b=!1,state:_,total:x=1,index:T=0,heights:I,promise:C,setHeights:k,toastOffset:S=0,motionProps:V,timeout:z=6e3,shouldShowTimeoutProgress:j=!1,icon:J,onClose:$,severity:le,maxVisibleToasts:ie,...Z}=n,{isHovered:te,hoverProps:H}=aa({isDisabled:!1}),fe=ln(),ne=(r=(e=t==null?void 0:t.disableAnimation)!=null?e:fe==null?void 0:fe.disableAnimation)!=null?r:!1,he=sN();let oe=y;he&&(y.includes("top")?oe="top-center":oe="bottom-center");const me=D.useRef(null),ee=D.useRef(null),Y=D.useRef(0),q=D.useRef(null),X=D.useRef(0),F=D.useRef(0);D.useEffect(()=>{q.current&&(q.current.style.width="0%")},[]);const[se,N]=D.useState(!!C);D.useEffect(()=>{C&&C.finally(()=>{N(!1)})},[C]),D.useEffect(()=>{const it=Xe=>{if(!z||se)return;if(ee.current===null&&(ee.current=Xe),te||R||T!=x-1){X.current+=Xe-ee.current,ee.current=null,me.current=requestAnimationFrame(it);return}const Br=Xe-ee.current+X.current;F.current=Br,F.current>=z&&_.close(h.key),Y.current=Math.min(Br/z*100,100),q.current&&(q.current.style.width=`${j?Y.current:0}%`),Y.current<100&&(me.current=requestAnimationFrame(it))};return me.current=requestAnimationFrame(it),()=>{me.current!==null&&cancelAnimationFrame(me.current)}},[z,j,_,te,T,x,R,se]);const ce=o||"div",ue=J,pe=fr(a),be=qe(c,d==null?void 0:d.base),{toastProps:we,contentProps:Ce,titleProps:$e,descriptionProps:Ne}=doe(n,_),[Ie,Ge]=D.useState(!1);D.useEffect(()=>{Ge(!0)},[]);const[nt,ze]=D.useState(0),[Pe,vt]=D.useState(!1);D.useLayoutEffect(()=>{if(!pe.current||!Ie||Pe)return;const it=pe.current,Xe=it.style.height;it.style.height="auto";const Br=getComputedStyle(it),ca=parseFloat(Br.marginTop),ki=parseFloat(Br.marginBottom),jn=it.getBoundingClientRect().height+ca+ki;it.style.height=Xe,ze(un=>un!==jn?jn:un);const ii=[...I];ii.length>T?ii[T]=jn:ii.push(jn),k(ii)},[Ie,x,k,T,Pe]);let Tt=4;for(let it=T+1;it<x;it++)Tt+=I[it];const ir=I[I.length-1],B=D.useMemo(()=>NI({...i,disableAnimation:ne}),[Ri(i)]),M=oe.includes("top")?1:-1,P={hidden:{opacity:0,y:-50*M},visible:{opacity:1,y:0},exit:{opacity:0,y:-50*M}},[G,re]=D.useState(!1),[Q,ae]=D.useState(0),ve=(it,Xe)=>{const Br=oe.includes("right"),ca=oe.includes("left"),ki=oe==="top-center",jn=oe==="bottom-center";if(Br&&it>=RP||ca&&it<=-100||ki&&Xe<=-20||jn&&Xe>=MP)return!0},xe=it=>{const Xe={top:0,bottom:0,right:0,left:0};return it==="bottom-center"?(Xe.bottom=1,Xe):it==="top-center"?(Xe.top=1,Xe):it.includes("right")?(Xe.right=1,Xe):it.includes("left")?(Xe.left=1,Xe):(Xe.left=1,Xe.right=1,Xe)};let Me;G&&oe==="bottom-center"||oe==="top-center"?Me=Math.max(0,1-Q/(MP+5)):G&&(Me=Math.max(0,1-Q/(RP+20)));const Ee=D.useCallback((it={})=>{const Xe=T+1<x?I[T+1]:0,Br=T-1>=0?I[T-1]:0,ca=Xe?Math.ceil(Xe/2)+8:16,ki=Br?Math.ceil(Br/2)+8:16,jn={"--top-extension":`${ca}px`,"--bottom-extension":`${ki}px`};return{ref:pe,className:B.base({class:qe(be,d==null?void 0:d.base)}),"data-has-title":Te(!qE(s)),"data-has-description":Te(!qE(l)),"data-placement":oe,"data-drag-value":Q,"data-toast":!0,"aria-label":"toast","data-toast-exiting":Te(Pe),onTransitionEnd:()=>{if(Pe){const ii=I;ii.splice(T,1),k([...ii]),_.close(h.key)}},style:{opacity:Me,...jn},...Oe(it,Z,we,H)}},[B,d,we,H,h,h.key,Me,Pe,_,h.key]),ke=D.useCallback((it={})=>({className:B.wrapper({class:d==null?void 0:d.wrapper}),...it}),[]),pt=D.useCallback((it={})=>({"aria-label":"descriptionIcon",className:B.icon({class:d==null?void 0:d.icon}),...it}),[]),gt=D.useCallback((it={})=>({className:B.loadingIcon({class:d==null?void 0:d.loadingIcon}),...it}),[]),hr=D.useCallback((it={})=>({className:B.content({class:d==null?void 0:d.content}),...Oe(it,Z,Ce)}),[Ce]),Dn=D.useCallback((it={})=>({className:B.title({class:d==null?void 0:d.title}),...Oe(it,Z,$e)}),[$e]),yn=D.useCallback((it={})=>({className:B.description({class:d==null?void 0:d.description}),...Oe(it,Z,Ne)}),[Ne]),Lf=D.useCallback((it={})=>({className:B.closeButton({class:d==null?void 0:d.closeButton}),"aria-label":"closeButton","data-hidden":Te(b),...Oe(it,{onPress:Tn(()=>{vt(!0),setTimeout(()=>document.body.focus(),0)},$)})}),[vt,$,_,h]),ni=D.useCallback((it={})=>({className:B.closeIcon({class:d==null?void 0:d.closeIcon}),"aria-label":"closeIcon",...it}),[]),Bf=D.useCallback((it={})=>{const Xe=R?ie-1:Math.min(2,ie-1),Br=x-T-1<=Xe,ca=oe==="bottom-center"||oe==="top-center"?"y":"x",ki={left:0,right:0,top:0,bottom:0},jn=xe(oe),ii=oe.includes("top")?{top:R||G?Tt+S:(x-1-T)*8+S,bottom:"auto"}:oe.includes("bottom")?{bottom:R||G?Tt+S:(x-1-T)*8+S,top:"auto"}:{};return{animate:{opacity:Br?1:0,pointerEvents:Br?"all":"none",scaleX:R||G?1:1-(x-1-T)*.1,height:R||G?nt:ir,y:0,...ii},drag:ca,dragConstraints:ki,exit:{opacity:0},initial:{opacity:0,scale:1,y:-40*M},transition:{duration:.3,ease:"easeOut"},variants:P,dragElastic:jn,onDragEnd:(un,Ve)=>{const{x:ai,y:tc}=Ve.offset;if(re(!1),ve(ai,tc)){const Tl=I;Tl.splice(T,1),k([...Tl]),_.close(h.key);return}ae(0)},onDrag:(un,Ve)=>{let ai=0;oe==="top-center"?ai=-Ve.offset.y:oe==="bottom-center"?ai=Ve.offset.y:oe.includes("right")?ai=Ve.offset.x:oe.includes("left")&&(ai=-Ve.offset.x),ai>=0&&ae(ai)},onDragStart:()=>{re(!0)},"data-drag":Te(G),"data-placement":oe,"data-drag-value":Q,className:B.motionDiv({class:d==null?void 0:d.motionDiv}),...it,...V}},[x,T,oe,R,Pe,Tt,M,nt,ir,P,d,G,Te,re,ve,B,S,ie]);return{Component:ce,title:s,description:l,icon:J,loadingIcon:ue,domRef:pe,severity:le,closeIcon:m,classNames:d,color:i.color,hideIcon:g,placement:oe,state:_,toast:h,disableAnimation:ne,isProgressBarVisible:!!z,total:x,index:T,getWrapperProps:ke,getToastProps:Ee,getTitleProps:Dn,getContentProps:hr,getDescriptionProps:yn,getCloseButtonProps:Lf,getIconProps:pt,getMotionDivProps:Bf,getCloseIconProps:ni,getLoadingIconProps:gt,progressBarRef:q,endContent:p,slots:B,isRegionExpanded:R,liftHeight:Tt,frontHeight:ir,initialHeight:nt,isLoading:se}}var Moe=()=>El(()=>import("./src-UW24ZMRV-9Gp3yQpm.js"),[]).then(t=>t.default),i9=t=>{const{ripples:e=[],motionProps:r,color:n="currentColor",style:i,onClear:a}=t;return O.jsx(O.Fragment,{children:e.map(o=>{const s=RT(.01*o.size,.2,o.size>100?.75:.5);return O.jsx(Ca,{features:Moe,children:O.jsx(Gu,{mode:"popLayout",children:O.jsx(Ai.span,{animate:{transform:"scale(2)",opacity:0},className:"heroui-ripple",exit:{opacity:0},initial:{transform:"scale(0)",opacity:.35},style:{position:"absolute",backgroundColor:n,borderRadius:"100%",transformOrigin:"center",pointerEvents:"none",overflow:"hidden",inset:0,zIndex:0,top:o.y,left:o.x,width:`${o.size}px`,height:`${o.size}px`,...i},transition:{duration:s},onAnimationComplete:()=>{a(o.key)},...r})})},o.key)})})};i9.displayName="HeroUI.Ripple";var Ioe=i9;function Poe(t={}){const[e,r]=D.useState([]),n=D.useCallback(a=>{const o=a.target,s=Math.max(o.clientWidth,o.clientHeight);r(l=>[...l,{key:$6(l.length.toString()),size:s,x:a.x-s/2,y:a.y-s/2}])},[]),i=D.useCallback(a=>{r(o=>o.filter(s=>s.key!==a))},[]);return{ripples:e,onClear:i,onPress:n,...t}}function Aoe(t={}){let{autoFocus:e=!1,isTextInput:r,within:n}=t,i=D.useRef({isFocused:!1,isFocusVisible:e||Vd()}),[a,o]=D.useState(!1),[s,l]=D.useState(()=>i.current.isFocused&&i.current.isFocusVisible),c=D.useCallback(()=>l(i.current.isFocused&&i.current.isFocusVisible),[]),d=D.useCallback(m=>{i.current.isFocused=m,o(m),c()},[c]);mL(m=>{i.current.isFocusVisible=m,c()},[],{isTextInput:r});let{focusProps:h}=wb({isDisabled:n,onFocusChange:d}),{focusWithinProps:p}=wl({isDisabled:!n,onFocusWithinChange:d});return{isFocused:a,isFocusVisible:s,focusProps:n?p:h}}function koe(t,e){let{elementType:r="button",isDisabled:n,onPress:i,onPressStart:a,onPressEnd:o,onPressChange:s,preventFocusOnPress:l,allowFocusWhenDisabled:c,onClick:d,href:h,target:p,rel:m,type:g="button",allowTextSelectionOnPress:y,role:R}=t,b;r==="button"?b={type:g,disabled:n}:b={role:"button",href:r==="a"&&!n?h:void 0,target:r==="a"?p:void 0,type:r==="input"?g:void 0,disabled:r==="input"?n:void 0,"aria-disabled":!n||r==="input"?void 0:n,rel:r==="a"?m:void 0};let _=Hu()||km();d&&typeof d=="function"&&R!=="link"&&!(t.hasOwnProperty("aria-expanded")&&t.hasOwnProperty("aria-controls"))&&MT("onClick is deprecated, please use onPress instead. See: https://github.com/heroui-inc/heroui/issues/4292","useButton");const x=S=>{_&&(d==null||d(S)),i==null||i(S)};let{pressProps:T,isPressed:I}=is({onPressStart:a,onPressEnd:o,onPressChange:s,onPress:x,isDisabled:n,preventFocusOnPress:l,allowTextSelectionOnPress:y,ref:e}),{focusableProps:C}=BT(t,e);c&&(C.tabIndex=n?-1:C.tabIndex);let k=Oe(C,T,ho(t,{labelable:!0}));return{isPressed:I,buttonProps:Oe(b,k,{"aria-haspopup":t["aria-haspopup"],"aria-expanded":t["aria-expanded"],"aria-controls":t["aria-controls"],"aria-pressed":t["aria-pressed"],"aria-current":t["aria-current"],onClick:S=>{g==="button"&&_||d==null||d(S)}})}}var[yye,Ooe]=Sl({name:"ButtonGroupContext",strict:!1});function $oe(t){var e,r,n,i,a,o,s,l,c;const d=Ooe(),h=ln(),p=!!d,{ref:m,as:g,children:y,startContent:R,endContent:b,autoFocus:_,className:x,spinner:T,isLoading:I=!1,disableRipple:C=!1,fullWidth:k=(e=d==null?void 0:d.fullWidth)!=null?e:!1,radius:S=d==null?void 0:d.radius,size:V=(r=d==null?void 0:d.size)!=null?r:"md",color:z=(n=d==null?void 0:d.color)!=null?n:"default",variant:j=(i=d==null?void 0:d.variant)!=null?i:"solid",disableAnimation:J=(o=(a=d==null?void 0:d.disableAnimation)!=null?a:h==null?void 0:h.disableAnimation)!=null?o:!1,isDisabled:$=(s=d==null?void 0:d.isDisabled)!=null?s:!1,isIconOnly:le=(l=d==null?void 0:d.isIconOnly)!=null?l:!1,spinnerPlacement:ie="start",onPress:Z,onClick:te,...H}=t,fe=g||"button",ne=typeof fe=="string",he=fr(m),oe=(c=C||(h==null?void 0:h.disableRipple))!=null?c:J,{isFocusVisible:me,isFocused:ee,focusProps:Y}=Aoe({autoFocus:_}),q=$||I,X=D.useMemo(()=>UB({size:V,color:z,variant:j,radius:S,fullWidth:k,isDisabled:q,isInGroup:p,disableAnimation:J,isIconOnly:le,className:x}),[V,z,j,S,k,q,p,le,J,x]),{onPress:F,onClear:se,ripples:N}=Poe(),ce=D.useCallback(ze=>{oe||q||J||he.current&&F(ze)},[oe,q,J,he,F]),{buttonProps:ue,isPressed:pe}=koe({elementType:g,isDisabled:q,onPress:Tn(Z,ce),onClick:te,...H},he),{isHovered:be,hoverProps:we}=aa({isDisabled:q}),Ce=D.useCallback((ze={})=>({"data-disabled":Te(q),"data-focus":Te(ee),"data-pressed":Te(pe),"data-focus-visible":Te(me),"data-hover":Te(be),"data-loading":Te(I),...Oe(ue,Y,we,Mi(H,{enabled:ne}),Mi(ze)),className:X}),[I,q,ee,pe,ne,me,be,ue,Y,we,H,X]),$e=ze=>D.isValidElement(ze)?D.cloneElement(ze,{"aria-hidden":!0,focusable:!1,tabIndex:-1}):null,Ne=$e(R),Ie=$e(b),Ge=D.useMemo(()=>({sm:"sm",md:"sm",lg:"md"})[V],[V]),nt=D.useCallback(()=>({ripples:N,onClear:se}),[N,se]);return{Component:fe,children:y,domRef:he,spinner:T,styles:X,startContent:Ne,endContent:Ie,isLoading:I,spinnerPlacement:ie,spinnerSize:Ge,disableRipple:oe,getButtonProps:Ce,getRippleProps:nt,isIconOnly:le}}var a9=Qt((t,e)=>{const{Component:r,domRef:n,children:i,spinnerSize:a,spinner:o=O.jsx(_4,{color:"current",size:a}),spinnerPlacement:s,startContent:l,endContent:c,isLoading:d,disableRipple:h,getButtonProps:p,getRippleProps:m,isIconOnly:g}=$oe({...t,ref:e});return O.jsxs(r,{ref:n,...p(),children:[l,d&&s==="start"&&o,d&&g?null:i,d&&s==="end"&&o,c,!h&&O.jsx(Ioe,{...m()})]})});a9.displayName="HeroUI.Button";var Loe=a9,iw={default:qS,primary:qS,secondary:qS,success:Zre,warning:qre,danger:Yre},o9=Qt((t,e)=>{const{severity:r,Component:n,icon:i,loadingIcon:a,domRef:o,endContent:s,color:l,hideIcon:c,closeIcon:d,disableAnimation:h,progressBarRef:p,classNames:m,slots:g,getWrapperProps:y,isProgressBarVisible:R,getToastProps:b,getContentProps:_,getTitleProps:x,getDescriptionProps:T,getCloseButtonProps:I,getIconProps:C,getMotionDivProps:k,getCloseIconProps:S,getLoadingIconProps:V,isLoading:z}=Roe({...t,ref:e}),j=i&&D.isValidElement(i)?D.cloneElement(i,C()):null,J=r?iw[r]:iw[l]||iw.default,$=a&&D.isValidElement(a)?D.cloneElement(a,V()):null,le=z?$||O.jsx(_4,{"aria-label":"loadingIcon",classNames:{wrapper:V().className},color:"current"}):null,ie=d&&D.isValidElement(d)?D.cloneElement(d,{}):null,Z=O.jsxs(n,{ref:o,...b(),children:[O.jsxs("div",{..._(),children:[c&&!z?null:le||j||O.jsx(J,{...C()}),O.jsxs("div",{...y(),children:[O.jsx("div",{...x(),children:t.toast.content.title}),O.jsx("div",{...T(),children:t.toast.content.description})]})]}),R&&O.jsx("div",{className:g.progressTrack({class:m==null?void 0:m.progressTrack}),children:O.jsx("div",{ref:p,className:g.progressIndicator({class:m==null?void 0:m.progressIndicator})})}),O.jsx(Loe,{isIconOnly:!0,...I(),children:ie||O.jsx(VB,{...S()})}),s]});return O.jsx(O.Fragment,{children:h?Z:O.jsx(Ai.div,{...k(),children:O.jsx(Ai.div,{animate:{opacity:1},exit:{opacity:0},initial:{opacity:0},transition:{duration:.25,ease:"easeOut",delay:.1},children:Z},"inner-div")})})});o9.displayName="HeroUI.Toast";var Boe=o9;function Noe({toastQueue:t,placement:e,disableAnimation:r,maxVisibleToasts:n,toastOffset:i,toastProps:a={},className:o,classNames:s,...l}){var c,d;const h=D.useRef(null),{regionProps:p}=Doe(l,t,h),{hoverProps:m,isHovered:g}=aa({isDisabled:!1}),[y,R]=D.useState(!1),b=D.useMemo(()=>Cre({disableAnimation:r}),[r]),_=qe(s==null?void 0:s.base,o);D.useEffect(()=>{function k(S){h.current&&!h.current.contains(S.target)&&R(!1)}return document.addEventListener("touchstart",k),()=>{document.removeEventListener("touchstart",k)}},[]);const[x,T]=D.useState([]),I=(d=(c=t.visibleToasts)==null?void 0:c.length)!=null?d:0,C=D.useCallback(()=>{R(!0)},[]);return O.jsx("div",{...Oe(p,m),ref:h,className:b.base({class:_}),"data-placement":e,onTouchStart:C,children:[...t.visibleToasts].reverse().map((k,S)=>r&&I-S>n?null:r||I-S<=4||g&&I-S<=n+1?O.jsx(Boe,{state:t,toast:k,...Oe(a,k.content),disableAnimation:r,heights:x,index:S,isRegionExpanded:g||y,maxVisibleToasts:n,placement:e,setHeights:T,toastOffset:i,total:I},k.key):null)})}function Uoe(t){let e=D.useCallback(i=>t.subscribe(i),[t]),r=D.useCallback(()=>t.visibleToasts,[t]);return{visibleToasts:r9.useSyncExternalStore(e,r,r),add:(i,a)=>t.add(i,a),close:i=>t.close(i),pauseAll:()=>t.pauseAll(),resumeAll:()=>t.resumeAll()}}class Foe{runWithWrapUpdate(e){this.wrapUpdate?this.wrapUpdate(e):e()}subscribe(e){return this.subscriptions.add(e),()=>this.subscriptions.delete(e)}add(e,r={}){let n="_"+Math.random().toString(36).slice(2),i={...r,content:e,key:n,timer:r.timeout?new joe(()=>this.close(n),r.timeout):void 0};return this.queue.unshift(i),this.updateVisibleToasts(),n}close(e){let r=this.queue.findIndex(a=>a.key===e);if(r>=0){var n,i;(n=(i=this.queue[r]).onClose)===null||n===void 0||n.call(i),this.queue.splice(r,1)}this.updateVisibleToasts()}updateVisibleToasts(){this.visibleToasts=this.queue.slice(0,this.maxVisibleToasts);for(let e of this.subscriptions)this.runWithWrapUpdate(e)}pauseAll(){for(let e of this.visibleToasts)e.timer&&e.timer.pause()}resumeAll(){for(let e of this.visibleToasts)e.timer&&e.timer.resume()}constructor(e){this.queue=[],this.subscriptions=new Set,this.visibleToasts=[];var r;this.maxVisibleToasts=(r=e==null?void 0:e.maxVisibleToasts)!==null&&r!==void 0?r:1/0,this.wrapUpdate=e==null?void 0:e.wrapUpdate}}class joe{reset(e){this.remaining=e,this.resume()}pause(){this.timerId!=null&&(clearTimeout(this.timerId),this.timerId=null,this.remaining-=Date.now()-this.startTime)}resume(){this.remaining<=0||(this.startTime=Date.now(),this.timerId=setTimeout(()=>{this.timerId=null,this.remaining=0,this.callback()},this.remaining))}constructor(e,r){this.startTime=null,this.remaining=r,this.callback=e}}var Voe=()=>El(()=>import("./index-Dzt4ld4E.js"),[]).then(t=>t.domMax),sp=null,zoe=()=>(sp||(sp=new Foe({maxVisibleToasts:1/0})),sp),Koe=({placement:t="bottom-right",disableAnimation:e=!1,maxVisibleToasts:r=3,toastOffset:n=0,toastProps:i={},regionProps:a})=>{var o;const s=Uoe(zoe()),l=ln(),c=(o=e??(l==null?void 0:l.disableAnimation))!=null?o:!1;return O.jsx(Ca,{features:Voe,children:O.jsx(Gu,{children:s.visibleToasts.length>0?O.jsx(Noe,{disableAnimation:c,maxVisibleToasts:r,placement:t,toastOffset:n,toastProps:i,toastQueue:s,...a}):null})})},Sa=({...t})=>{sp&&sp.add(t)};const Hoe=t=>O.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor",...t,children:O.jsx("path",{d:"M8 2a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3ZM8 6.5a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3ZM9.5 12.5a1.5 1.5 0 1 0-3 0 1.5 1.5 0 0 0 3 0Z"})}),s9=t=>O.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor",...t,children:O.jsx("path",{d:"M8 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6ZM12.735 14c.618 0 1.093-.561.872-1.139a6.002 6.002 0 0 0-11.215 0c-.22.578.254 1.139.872 1.139h9.47Z"})}),l9=t=>O.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor",...t,children:O.jsx("path",{d:"M8.543 2.232a.75.75 0 0 0-1.085 0l-5.25 5.5A.75.75 0 0 0 2.75 9H4v4a1 1 0 0 0 1 1h1a1 1 0 0 0 1-1v-1a1 1 0 1 1 2 0v1a1 1 0 0 0 1 1h1a1 1 0 0 0 1-1V9h1.25a.75.75 0 0 0 .543-1.268l-5.25-5.5Z"})}),Woe=t=>O.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor",...t,children:O.jsx("path",{fillRule:"evenodd",d:"M4 2a1.5 1.5 0 0 0-1.5 1.5v9A1.5 1.5 0 0 0 4 14h8a1.5 1.5 0 0 0 1.5-1.5V6.621a1.5 1.5 0 0 0-.44-1.06L9.94 2.439A1.5 1.5 0 0 0 8.878 2H4Zm4 9.5a.75.75 0 0 1-.75-.75V8.06l-.72.72a.75.75 0 0 1-1.06-1.06l2-2a.75.75 0 0 1 1.06 0l2 2a.75.75 0 1 1-1.06 1.06l-.72-.72v2.69a.75.75 0 0 1-.75.75Z",clipRule:"evenodd"})}),Goe=t=>O.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor",...t,children:O.jsx("path",{fillRule:"evenodd",d:"M4 2a1.5 1.5 0 0 0-1.5 1.5v9A1.5 1.5 0 0 0 4 14h8a1.5 1.5 0 0 0 1.5-1.5V6.621a1.5 1.5 0 0 0-.44-1.06L9.94 2.439A1.5 1.5 0 0 0 8.878 2H4Zm4 3.5a.75.75 0 0 1 .75.75v2.69l.72-.72a.75.75 0 1 1 1.06 1.06l-2 2a.75.75 0 0 1-1.06 0l-2-2a.75.75 0 0 1 1.06-1.06l.72.72V6.25A.75.75 0 0 1 8 5.5Z",clipRule:"evenodd"})}),qoe=t=>O.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor",...t,children:O.jsx("path",{fillRule:"evenodd",d:"M3.757 4.5c.18.217.376.42.586.608.153-.61.354-1.175.596-1.678A5.53 5.53 0 0 0 3.757 4.5ZM8 1a6.994 6.994 0 0 0-7 7 7 7 0 1 0 7-7Zm0 1.5c-.476 0-1.091.386-1.633 1.427-.293.564-.531 1.267-.683 2.063A5.48 5.48 0 0 0 8 6.5a5.48 5.48 0 0 0 2.316-.51c-.152-.796-.39-1.499-.683-2.063C9.09 2.886 8.476 2.5 8 2.5Zm3.657 2.608a8.823 8.823 0 0 0-.596-1.678c.444.298.842.659 1.182 1.07-.18.217-.376.42-.586.608Zm-1.166 2.436A6.983 6.983 0 0 1 8 8a6.983 6.983 0 0 1-2.49-.456 10.703 10.703 0 0 0 .202 2.6c.72.231 1.49.356 2.288.356.798 0 1.568-.125 2.29-.356a10.705 10.705 0 0 0 .2-2.6Zm1.433 1.85a12.652 12.652 0 0 0 .018-2.609c.405-.276.78-.594 1.117-.947a5.48 5.48 0 0 1 .44 2.262 7.536 7.536 0 0 1-1.575 1.293Zm-2.172 2.435a9.046 9.046 0 0 1-3.504 0c.039.084.078.166.12.244C6.907 13.114 7.523 13.5 8 13.5s1.091-.386 1.633-1.427c.04-.078.08-.16.12-.244Zm1.31.74a8.5 8.5 0 0 0 .492-1.298c.457-.197.893-.43 1.307-.696a5.526 5.526 0 0 1-1.8 1.995Zm-6.123 0a8.507 8.507 0 0 1-.493-1.298 8.985 8.985 0 0 1-1.307-.696 5.526 5.526 0 0 0 1.8 1.995ZM2.5 8.1c.463.5.993.935 1.575 1.293a12.652 12.652 0 0 1-.018-2.608 7.037 7.037 0 0 1-1.117-.947 5.48 5.48 0 0 0-.44 2.262Z",clipRule:"evenodd"})}),Zoe=t=>O.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor",...t,children:O.jsx("path",{fillRule:"evenodd",d:"M4.5 13a3.5 3.5 0 0 1-1.41-6.705A3.5 3.5 0 0 1 9.72 4.124a2.5 2.5 0 0 1 3.197 3.018A3.001 3.001 0 0 1 12 13H4.5Zm.72-5.03a.75.75 0 0 0 1.06 1.06l.97-.97v2.69a.75.75 0 0 0 1.5 0V8.06l.97.97a.75.75 0 1 0 1.06-1.06L8.53 5.72a.75.75 0 0 0-1.06 0L5.22 7.97Z",clipRule:"evenodd"})}),Yoe=t=>O.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor",...t,children:O.jsx("path",{fillRule:"evenodd",d:"M4.5 13a3.5 3.5 0 0 1-1.41-6.705A3.5 3.5 0 0 1 9.72 4.124a2.5 2.5 0 0 1 3.197 3.018A3.001 3.001 0 0 1 12 13H4.5Zm6.28-3.97a.75.75 0 1 0-1.06-1.06l-.97.97V6.25a.75.75 0 0 0-1.5 0v2.69l-.97-.97a.75.75 0 0 0-1.06 1.06l2.25 2.25a.75.75 0 0 0 1.06 0l2.25-2.25Z",clipRule:"evenodd"})});function Joe({isOpen:t,onOpenChange:e,onMatrixLogin:r,exportToClipboard:n,importFromClipboard:i,exportToMatrix:a,importFromMatrix:o}){const[s,l]=D.useState(()=>localStorage.getItem("matrixRoomId")||"#id:matrix.org");D.useEffect(()=>{localStorage.setItem("matrixRoomId",s)},[s]);const[c,d]=D.useState(""),[h,p]=D.useState(""),[m,g]=D.useState(!1),[y,R]=D.useState(!1),[b,_]=D.useState(!1),x=async()=>{!n||b||(_(!0),await n(),_(!1))},T=async()=>{!i||b||(_(!0),await i(),_(!1))},I=async()=>{if(b||!r)return;_(!0),g(!0),await r(c,h)&&R(!0),g(!1),_(!1)},C=async()=>{!a||!s||b||(_(!0),await a(s),_(!1))},k=async()=>{!o||!s||(_(!0),await o(s),_(!1))};return O.jsx(wN,{placement:"center",isOpen:t,onOpenChange:e,children:O.jsx(vN,{children:S=>O.jsxs(O.Fragment,{children:[O.jsx(_N,{children:"Notes Import/Export"}),O.jsxs(pN,{children:[O.jsxs("div",{className:"mb-4",children:[O.jsx("div",{className:"text-medium font-semibold mb-2",children:"Clipboard Operations"}),O.jsxs("div",{className:"flex gap-2",children:[O.jsx(An,{color:"default",variant:"bordered",onPress:x,isDisabled:b,startContent:O.jsx(Woe,{className:"size-4 text-zinc-800 pointer-events-none"}),children:"Export to Clipboard"}),O.jsx(An,{color:"default",variant:"bordered",onPress:T,isDisabled:b,startContent:O.jsx(Goe,{className:"size-4 text-zinc-800 pointer-events-none"}),children:"Import from Clipboard"})]})]}),O.jsx("div",{className:"text-medium font-semibold",children:"Matrix Operations"}),!y&&O.jsxs("div",{className:"flex flex-col gap-3",children:[O.jsx(gu,{label:"User ID",value:c,onValueChange:d},"mail"),O.jsx(gu,{label:"Password",type:"password",value:h,onValueChange:p},"password"),O.jsx(An,{className:"mb-4",color:"default",variant:"flat",isDisabled:m||b,onPress:I,startContent:O.jsx(qoe,{className:"size-4 text-zinc-800 pointer-events-none"}),children:"Login to Matrix"})]}),O.jsx(gu,{value:s,onValueChange:V=>l(V),label:"Matrix Room ID (#)"},"room"),O.jsxs("div",{className:"flex gap-2",children:[O.jsx(An,{color:"default",variant:"bordered",onPress:C,isDisabled:!y||!s||b,startContent:O.jsx(Zoe,{className:"size-4 text-zinc-800 pointer-events-none"}),children:"Export to Matrix"}),O.jsx(An,{color:"default",variant:"bordered",onPress:k,isDisabled:!y||!s||b,startContent:O.jsx(Yoe,{className:"size-4 text-zinc-800 pointer-events-none"}),children:"Import from Matrix"})]}),O.jsx(Fne,{value:0,isIndeterminate:m||b,"aria-label":"Operation Progress",size:"sm"})]}),O.jsx(yN,{children:O.jsx(An,{color:"success",onPress:()=>S(),children:"Close"})})]})})})}const ei=()=>new Map,G1=t=>{const e=ei();return t.forEach((r,n)=>{e.set(n,r)}),e},as=(t,e,r)=>{let n=t.get(e);return n===void 0&&t.set(e,n=r()),n},Xoe=(t,e)=>{const r=[];for(const[n,i]of t)r.push(e(i,n));return r},Qoe=(t,e)=>{for(const[r,n]of t)if(e(n,r))return!0;return!1},Pu=()=>new Set,aw=t=>t[t.length-1],ese=(t,e)=>{for(let r=0;r<e.length;r++)t.push(e[r])},fl=Array.from,tse=Array.isArray;class rse{constructor(){this._observers=ei()}on(e,r){return as(this._observers,e,Pu).add(r),r}once(e,r){const n=(...i)=>{this.off(e,n),r(...i)};this.on(e,n)}off(e,r){const n=this._observers.get(e);n!==void 0&&(n.delete(r),n.size===0&&this._observers.delete(e))}emit(e,r){return fl((this._observers.get(e)||ei()).values()).forEach(n=>n(...r))}destroy(){this._observers=ei()}}class nse{constructor(){this._observers=ei()}on(e,r){as(this._observers,e,Pu).add(r)}once(e,r){const n=(...i)=>{this.off(e,n),r(...i)};this.on(e,n)}off(e,r){const n=this._observers.get(e);n!==void 0&&(n.delete(r),n.size===0&&this._observers.delete(e))}emit(e,r){return fl((this._observers.get(e)||ei()).values()).forEach(n=>n(...r))}destroy(){this._observers=ei()}}const hl=Math.floor,Hg=Math.abs,u9=(t,e)=>t<e?t:e,qu=(t,e)=>t>e?t:e,c9=t=>t!==0?t<0:1/t<0,IP=1,PP=2,ow=4,sw=8,Hp=32,Go=64,Ti=128,Ob=31,q1=63,bu=127,ise=2147483647,d9=Number.MAX_SAFE_INTEGER,ase=Number.isInteger||(t=>typeof t=="number"&&isFinite(t)&&hl(t)===t),ose=t=>t.toLowerCase(),sse=/^\s*/g,lse=t=>t.replace(sse,""),use=/([A-Z])/g,AP=(t,e)=>lse(t.replace(use,r=>`${e}${ose(r)}`)),cse=t=>{const e=unescape(encodeURIComponent(t)),r=e.length,n=new Uint8Array(r);for(let i=0;i<r;i++)n[i]=e.codePointAt(i);return n},Wp=typeof TextEncoder<"u"?new TextEncoder:null,dse=t=>Wp.encode(t),fse=Wp?dse:cse;let lp=typeof TextDecoder>"u"?null:new TextDecoder("utf-8",{fatal:!0,ignoreBOM:!0});lp&&lp.decode(new Uint8Array).length===1&&(lp=null);class jm{constructor(){this.cpos=0,this.cbuf=new Uint8Array(100),this.bufs=[]}}const $b=()=>new jm,hse=t=>{let e=t.cpos;for(let r=0;r<t.bufs.length;r++)e+=t.bufs[r].length;return e},Ya=t=>{const e=new Uint8Array(hse(t));let r=0;for(let n=0;n<t.bufs.length;n++){const i=t.bufs[n];e.set(i,r),r+=i.length}return e.set(new Uint8Array(t.cbuf.buffer,0,t.cpos),r),e},pse=(t,e)=>{const r=t.cbuf.length;r-t.cpos<e&&(t.bufs.push(new Uint8Array(t.cbuf.buffer,0,t.cpos)),t.cbuf=new Uint8Array(qu(r,e)*2),t.cpos=0)},Jr=(t,e)=>{const r=t.cbuf.length;t.cpos===r&&(t.bufs.push(t.cbuf),t.cbuf=new Uint8Array(r*2),t.cpos=0),t.cbuf[t.cpos++]=e},Z1=Jr,Rt=(t,e)=>{for(;e>bu;)Jr(t,Ti|bu&e),e=hl(e/128);Jr(t,bu&e)},R4=(t,e)=>{const r=c9(e);for(r&&(e=-e),Jr(t,(e>q1?Ti:0)|(r?Go:0)|q1&e),e=hl(e/64);e>0;)Jr(t,(e>bu?Ti:0)|bu&e),e=hl(e/128)},Y1=new Uint8Array(3e4),mse=Y1.length/3,vse=(t,e)=>{if(e.length<mse){const r=Wp.encodeInto(e,Y1).written||0;Rt(t,r);for(let n=0;n<r;n++)Jr(t,Y1[n])}else hi(t,fse(e))},gse=(t,e)=>{const r=unescape(encodeURIComponent(e)),n=r.length;Rt(t,n);for(let i=0;i<n;i++)Jr(t,r.codePointAt(i))},vd=Wp&&Wp.encodeInto?vse:gse,Lb=(t,e)=>{const r=t.cbuf.length,n=t.cpos,i=u9(r-n,e.length),a=e.length-i;t.cbuf.set(e.subarray(0,i),n),t.cpos+=i,a>0&&(t.bufs.push(t.cbuf),t.cbuf=new Uint8Array(qu(r*2,a)),t.cbuf.set(e.subarray(i)),t.cpos=a)},hi=(t,e)=>{Rt(t,e.byteLength),Lb(t,e)},M4=(t,e)=>{pse(t,e);const r=new DataView(t.cbuf.buffer,t.cpos,e);return t.cpos+=e,r},yse=(t,e)=>M4(t,4).setFloat32(0,e,!1),bse=(t,e)=>M4(t,8).setFloat64(0,e,!1),_se=(t,e)=>M4(t,8).setBigInt64(0,e,!1),kP=new DataView(new ArrayBuffer(4)),Sse=t=>(kP.setFloat32(0,t),kP.getFloat32(0)===t),Gp=(t,e)=>{switch(typeof e){case"string":Jr(t,119),vd(t,e);break;case"number":ase(e)&&Hg(e)<=ise?(Jr(t,125),R4(t,e)):Sse(e)?(Jr(t,124),yse(t,e)):(Jr(t,123),bse(t,e));break;case"bigint":Jr(t,122),_se(t,e);break;case"object":if(e===null)Jr(t,126);else if(tse(e)){Jr(t,117),Rt(t,e.length);for(let r=0;r<e.length;r++)Gp(t,e[r])}else if(e instanceof Uint8Array)Jr(t,116),hi(t,e);else{Jr(t,118);const r=Object.keys(e);Rt(t,r.length);for(let n=0;n<r.length;n++){const i=r[n];vd(t,i),Gp(t,e[i])}}break;case"boolean":Jr(t,e?120:121);break;default:Jr(t,127)}};class OP extends jm{constructor(e){super(),this.w=e,this.s=null,this.count=0}write(e){this.s===e?this.count++:(this.count>0&&Rt(this,this.count-1),this.count=1,this.w(this,e),this.s=e)}}const $P=t=>{t.count>0&&(R4(t.encoder,t.count===1?t.s:-t.s),t.count>1&&Rt(t.encoder,t.count-2))};class Wg{constructor(){this.encoder=new jm,this.s=0,this.count=0}write(e){this.s===e?this.count++:($P(this),this.count=1,this.s=e)}toUint8Array(){return $P(this),Ya(this.encoder)}}const LP=t=>{if(t.count>0){const e=t.diff*2+(t.count===1?0:1);R4(t.encoder,e),t.count>1&&Rt(t.encoder,t.count-2)}};class lw{constructor(){this.encoder=new jm,this.s=0,this.count=0,this.diff=0}write(e){this.diff===e-this.s?(this.s=e,this.count++):(LP(this),this.count=1,this.diff=e-this.s,this.s=e)}toUint8Array(){return LP(this),Ya(this.encoder)}}class wse{constructor(){this.sarr=[],this.s="",this.lensE=new Wg}write(e){this.s+=e,this.s.length>19&&(this.sarr.push(this.s),this.s=""),this.lensE.write(e.length)}toUint8Array(){const e=new jm;return this.sarr.push(this.s),this.s="",vd(e,this.sarr.join("")),Lb(e,this.lensE.toUint8Array()),Ya(e)}}const ts=t=>new Error(t),eo=()=>{throw ts("Method unimplemented")},oo=()=>{throw ts("Unexpected case")},f9=ts("Unexpected end of array"),h9=ts("Integer out of Range");class Bb{constructor(e){this.arr=e,this.pos=0}}const xf=t=>new Bb(t),Ese=t=>t.pos!==t.arr.length,xse=(t,e)=>{const r=new Uint8Array(t.arr.buffer,t.pos+t.arr.byteOffset,e);return t.pos+=e,r},pi=t=>xse(t,bt(t)),Gd=t=>t.arr[t.pos++],bt=t=>{let e=0,r=1;const n=t.arr.length;for(;t.pos<n;){const i=t.arr[t.pos++];if(e=e+(i&bu)*r,r*=128,i<Ti)return e;if(e>d9)throw h9}throw f9},I4=t=>{let e=t.arr[t.pos++],r=e&q1,n=64;const i=(e&Go)>0?-1:1;if(!(e&Ti))return i*r;const a=t.arr.length;for(;t.pos<a;){if(e=t.arr[t.pos++],r=r+(e&bu)*n,n*=128,e<Ti)return i*r;if(r>d9)throw h9}throw f9},Cse=t=>{let e=bt(t);if(e===0)return"";{let r=String.fromCodePoint(Gd(t));if(--e<100)for(;e--;)r+=String.fromCodePoint(Gd(t));else for(;e>0;){const n=e<1e4?e:1e4,i=t.arr.subarray(t.pos,t.pos+n);t.pos+=n,r+=String.fromCodePoint.apply(null,i),e-=n}return decodeURIComponent(escape(r))}},Tse=t=>lp.decode(pi(t)),gd=lp?Tse:Cse,P4=(t,e)=>{const r=new DataView(t.arr.buffer,t.arr.byteOffset+t.pos,e);return t.pos+=e,r},Dse=t=>P4(t,4).getFloat32(0,!1),Rse=t=>P4(t,8).getFloat64(0,!1),Mse=t=>P4(t,8).getBigInt64(0,!1),Ise=[t=>{},t=>null,I4,Dse,Rse,Mse,t=>!1,t=>!0,gd,t=>{const e=bt(t),r={};for(let n=0;n<e;n++){const i=gd(t);r[i]=qp(t)}return r},t=>{const e=bt(t),r=[];for(let n=0;n<e;n++)r.push(qp(t));return r},pi],qp=t=>Ise[127-Gd(t)](t);class BP extends Bb{constructor(e,r){super(e),this.reader=r,this.s=null,this.count=0}read(){return this.count===0&&(this.s=this.reader(this),Ese(this)?this.count=bt(this)+1:this.count=-1),this.count--,this.s}}class Gg extends Bb{constructor(e){super(e),this.s=0,this.count=0}read(){if(this.count===0){this.s=I4(this);const e=c9(this.s);this.count=1,e&&(this.s=-this.s,this.count=bt(this)+2)}return this.count--,this.s}}class uw extends Bb{constructor(e){super(e),this.s=0,this.count=0,this.diff=0}read(){if(this.count===0){const e=I4(this),r=e&1;this.diff=hl(e/2),this.count=1,r&&(this.count=bt(this)+2)}return this.s+=this.diff,this.count--,this.s}}class Pse{constructor(e){this.decoder=new Gg(e),this.str=gd(this.decoder),this.spos=0}read(){const e=this.spos+this.decoder.read(),r=this.str.slice(this.spos,e);return this.spos=e,r}}const Ase=crypto.getRandomValues.bind(crypto),p9=()=>Ase(new Uint32Array(1))[0],kse="10000000-1000-4000-8000"+-1e11,Ose=()=>kse.replace(/[018]/g,t=>(t^p9()&15>>t/4).toString(16)),qd=t=>new Promise(t);Promise.all.bind(Promise);const NP=t=>t===void 0?null:t;class $se{constructor(){this.map=new Map}setItem(e,r){this.map.set(e,r)}getItem(e){return this.map.get(e)}}let m9=new $se,Lse=!0;try{typeof localStorage<"u"&&localStorage&&(m9=localStorage,Lse=!1)}catch{}const Bse=m9,Nse=Object.assign,v9=Object.keys,Use=(t,e)=>{for(const r in t)e(t[r],r)},UP=t=>v9(t).length,FP=t=>v9(t).length,Fse=t=>{for(const e in t)return!1;return!0},jse=(t,e)=>{for(const r in t)if(!e(t[r],r))return!1;return!0},g9=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),Vse=(t,e)=>t===e||FP(t)===FP(e)&&jse(t,(r,n)=>(r!==void 0||g9(e,n))&&e[n]===r),zse=Object.freeze,y9=t=>{for(const e in t){const r=t[e];(typeof r=="object"||typeof r=="function")&&y9(t[e])}return zse(t)},jP=Symbol("Equality"),A4=(t,e,r=0)=>{try{for(;r<t.length;r++)t[r](...e)}finally{r<t.length&&A4(t,e,r+1)}},Kse=t=>t,qg=(t,e)=>{if(t===e)return!0;if(t==null||e==null||t.constructor!==e.constructor)return!1;if(t[jP]!=null)return t[jP](e);switch(t.constructor){case ArrayBuffer:t=new Uint8Array(t),e=new Uint8Array(e);case Uint8Array:{if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;break}case Set:{if(t.size!==e.size)return!1;for(const r of t)if(!e.has(r))return!1;break}case Map:{if(t.size!==e.size)return!1;for(const r of t.keys())if(!e.has(r)||!qg(t.get(r),e.get(r)))return!1;break}case Object:if(UP(t)!==UP(e))return!1;for(const r in t)if(!g9(t,r)||!qg(t[r],e[r]))return!1;break;case Array:if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(!qg(t[r],e[r]))return!1;break;default:return!1}return!0},Hse=(t,e)=>e.includes(t);var b9={};const Zp=typeof yi<"u"&&yi.release&&/node|io\.js/.test(yi.release.name)&&Object.prototype.toString.call(typeof yi<"u"?yi:0)==="[object process]";let $a;const Wse=()=>{if($a===void 0)if(Zp){$a=ei();const t=yi.argv;let e=null;for(let r=0;r<t.length;r++){const n=t[r];n[0]==="-"?(e!==null&&$a.set(e,""),e=n):e!==null&&($a.set(e,n),e=null)}e!==null&&$a.set(e,"")}else typeof location=="object"?($a=ei(),(location.search||"?").slice(1).split("&").forEach(t=>{if(t.length!==0){const[e,r]=t.split("=");$a.set(`--${AP(e,"-")}`,r),$a.set(`-${AP(e,"-")}`,r)}})):$a=ei();return $a},J1=t=>Wse().has(t),p0=t=>NP(Zp?b9[t.toUpperCase().replaceAll("-","_")]:Bse.getItem(t)),_9=t=>J1("--"+t)||p0(t)!==null;_9("production");const Gse=Zp&&Hse(b9.FORCE_COLOR,["true","1","2"]),qse=Gse||!J1("--no-colors")&&!_9("no-color")&&(!Zp||yi.stdout.isTTY)&&(!Zp||J1("--color")||p0("COLORTERM")!==null||(p0("TERM")||"").includes("color")),Zse=t=>new Uint8Array(t),Yse=t=>{const e=Zse(t.byteLength);return e.set(t),e};class Jse{constructor(e,r){this.left=e,this.right=r}}const wo=(t,e)=>new Jse(t,e);typeof DOMParser<"u"&&new DOMParser;const Xse=t=>Xoe(t,(e,r)=>`${r}:${e};`).join(""),os=Symbol,S9=os(),w9=os(),Qse=os(),ele=os(),tle=os(),E9=os(),rle=os(),k4=os(),nle=os(),ile=t=>{var i;t.length===1&&((i=t[0])==null?void 0:i.constructor)===Function&&(t=t[0]());const e=[],r=[];let n=0;for(;n<t.length;n++){const a=t[n];if(a===void 0)break;if(a.constructor===String||a.constructor===Number)e.push(a);else if(a.constructor===Object)break}for(n>0&&r.push(e.join(""));n<t.length;n++){const a=t[n];a instanceof Symbol||r.push(a)}return r},ale={[S9]:wo("font-weight","bold"),[w9]:wo("font-weight","normal"),[Qse]:wo("color","blue"),[tle]:wo("color","green"),[ele]:wo("color","grey"),[E9]:wo("color","red"),[rle]:wo("color","purple"),[k4]:wo("color","orange"),[nle]:wo("color","black")},ole=t=>{var o;t.length===1&&((o=t[0])==null?void 0:o.constructor)===Function&&(t=t[0]());const e=[],r=[],n=ei();let i=[],a=0;for(;a<t.length;a++){const s=t[a],l=ale[s];if(l!==void 0)n.set(l.left,l.right);else{if(s===void 0)break;if(s.constructor===String||s.constructor===Number){const c=Xse(n);a>0||c.length>0?(e.push("%c"+s),r.push(c)):e.push(s)}else break}}for(a>0&&(i=r,i.unshift(e.join("")));a<t.length;a++){const s=t[a];s instanceof Symbol||i.push(s)}return i},x9=qse?ole:ile,sle=(...t)=>{console.log(...x9(t)),C9.forEach(e=>e.print(t))},lle=(...t)=>{console.warn(...x9(t)),t.unshift(k4),C9.forEach(e=>e.print(t))},C9=Pu(),T9=t=>({[Symbol.iterator](){return this},next:t}),ule=(t,e)=>T9(()=>{let r;do r=t.next();while(!r.done&&!e(r.value));return r}),cw=(t,e)=>T9(()=>{const{done:r,value:n}=t.next();return{done:r,value:r?void 0:e(n)}});class O4{constructor(e,r){this.clock=e,this.len=r}}class Vm{constructor(){this.clients=new Map}}const D9=(t,e,r)=>e.clients.forEach((n,i)=>{const a=t.doc.store.clients.get(i);if(a!=null){const o=a[a.length-1],s=o.id.clock+o.length;for(let l=0,c=n[l];l<n.length&&c.clock<s;c=n[++l])N9(t,a,c.clock,c.len,r)}}),cle=(t,e)=>{let r=0,n=t.length-1;for(;r<=n;){const i=hl((r+n)/2),a=t[i],o=a.clock;if(o<=e){if(e<o+a.len)return i;r=i+1}else n=i-1}return null},R9=(t,e)=>{const r=t.clients.get(e.client);return r!==void 0&&cle(r,e.clock)!==null},$4=t=>{t.clients.forEach(e=>{e.sort((i,a)=>i.clock-a.clock);let r,n;for(r=1,n=1;r<e.length;r++){const i=e[n-1],a=e[r];i.clock+i.len>=a.clock?i.len=qu(i.len,a.clock+a.len-i.clock):(n<r&&(e[n]=a),n++)}e.length=n})},dle=t=>{const e=new Vm;for(let r=0;r<t.length;r++)t[r].clients.forEach((n,i)=>{if(!e.clients.has(i)){const a=n.slice();for(let o=r+1;o<t.length;o++)ese(a,t[o].clients.get(i)||[]);e.clients.set(i,a)}});return $4(e),e},m0=(t,e,r,n)=>{as(t.clients,e,()=>[]).push(new O4(r,n))},fle=()=>new Vm,hle=t=>{const e=fle();return t.clients.forEach((r,n)=>{const i=[];for(let a=0;a<r.length;a++){const o=r[a];if(o.deleted){const s=o.id.clock;let l=o.length;if(a+1<r.length)for(let c=r[a+1];a+1<r.length&&c.deleted;c=r[++a+1])l+=c.length;i.push(new O4(s,l))}}i.length>0&&e.clients.set(n,i)}),e},Cf=(t,e)=>{Rt(t.restEncoder,e.clients.size),fl(e.clients.entries()).sort((r,n)=>n[0]-r[0]).forEach(([r,n])=>{t.resetDsCurVal(),Rt(t.restEncoder,r);const i=n.length;Rt(t.restEncoder,i);for(let a=0;a<i;a++){const o=n[a];t.writeDsClock(o.clock),t.writeDsLen(o.len)}})},L4=t=>{const e=new Vm,r=bt(t.restDecoder);for(let n=0;n<r;n++){t.resetDsCurVal();const i=bt(t.restDecoder),a=bt(t.restDecoder);if(a>0){const o=as(e.clients,i,()=>[]);for(let s=0;s<a;s++)o.push(new O4(t.readDsClock(),t.readDsLen()))}}return e},VP=(t,e,r)=>{const n=new Vm,i=bt(t.restDecoder);for(let a=0;a<i;a++){t.resetDsCurVal();const o=bt(t.restDecoder),s=bt(t.restDecoder),l=r.clients.get(o)||[],c=an(r,o);for(let d=0;d<s;d++){const h=t.readDsClock(),p=h+t.readDsLen();if(h<c){c<p&&m0(n,o,c,p-c);let m=so(l,h),g=l[m];for(!g.deleted&&g.id.clock<h&&(l.splice(m+1,0,w0(e,g,h-g.id.clock)),m++);m<l.length&&(g=l[m++],g.id.clock<p);)g.deleted||(p<g.id.clock+g.length&&l.splice(m,0,w0(e,g,p-g.id.clock)),g.delete(e))}else m0(n,o,h,p-h)}}if(n.clients.size>0){const a=new Au;return Rt(a.restEncoder,0),Cf(a,n),a.toUint8Array()}return null},M9=p9;class Tf extends rse{constructor({guid:e=Ose(),collectionid:r=null,gc:n=!0,gcFilter:i=()=>!0,meta:a=null,autoLoad:o=!1,shouldLoad:s=!0}={}){super(),this.gc=n,this.gcFilter=i,this.clientID=M9(),this.guid=e,this.collectionid=r,this.share=new Map,this.store=new L9,this._transaction=null,this._transactionCleanups=[],this.subdocs=new Set,this._item=null,this.shouldLoad=s,this.autoLoad=o,this.meta=a,this.isLoaded=!1,this.isSynced=!1,this.isDestroyed=!1,this.whenLoaded=qd(c=>{this.on("load",()=>{this.isLoaded=!0,c(this)})});const l=()=>qd(c=>{const d=h=>{(h===void 0||h===!0)&&(this.off("sync",d),c())};this.on("sync",d)});this.on("sync",c=>{c===!1&&this.isSynced&&(this.whenSynced=l()),this.isSynced=c===void 0||c===!0,this.isSynced&&!this.isLoaded&&this.emit("load",[this])}),this.whenSynced=l()}load(){const e=this._item;e!==null&&!this.shouldLoad&&Wt(e.parent.doc,r=>{r.subdocsLoaded.add(this)},null,!0),this.shouldLoad=!0}getSubdocs(){return this.subdocs}getSubdocGuids(){return new Set(fl(this.subdocs).map(e=>e.guid))}transact(e,r=null){return Wt(this,e,r)}get(e,r=gn){const n=as(this.share,e,()=>{const a=new r;return a._integrate(this,null),a}),i=n.constructor;if(r!==gn&&i!==r)if(i===gn){const a=new r;a._map=n._map,n._map.forEach(o=>{for(;o!==null;o=o.left)o.parent=a}),a._start=n._start;for(let o=a._start;o!==null;o=o.right)o.parent=a;return a._length=n._length,this.share.set(e,a),a._integrate(this,null),a}else throw new Error(`Type with the name ${e} has already been defined with a different constructor`);return n}getArray(e=""){return this.get(e,bd)}getText(e=""){return this.get(e,Jd)}getMap(e=""){return this.get(e,Yd)}getXmlElement(e=""){return this.get(e,Xd)}getXmlFragment(e=""){return this.get(e,ku)}toJSON(){const e={};return this.share.forEach((r,n)=>{e[n]=r.toJSON()}),e}destroy(){this.isDestroyed=!0,fl(this.subdocs).forEach(r=>r.destroy());const e=this._item;if(e!==null){this._item=null;const r=e.content;r.doc=new Tf({guid:this.guid,...r.opts,shouldLoad:!1}),r.doc._item=e,Wt(e.parent.doc,n=>{const i=r.doc;e.deleted||n.subdocsAdded.add(i),n.subdocsRemoved.add(this)},null,!0)}this.emit("destroyed",[!0]),this.emit("destroy",[this]),super.destroy()}}class I9{constructor(e){this.restDecoder=e}resetDsCurVal(){}readDsClock(){return bt(this.restDecoder)}readDsLen(){return bt(this.restDecoder)}}class P9 extends I9{readLeftID(){return Et(bt(this.restDecoder),bt(this.restDecoder))}readRightID(){return Et(bt(this.restDecoder),bt(this.restDecoder))}readClient(){return bt(this.restDecoder)}readInfo(){return Gd(this.restDecoder)}readString(){return gd(this.restDecoder)}readParentInfo(){return bt(this.restDecoder)===1}readTypeRef(){return bt(this.restDecoder)}readLen(){return bt(this.restDecoder)}readAny(){return qp(this.restDecoder)}readBuf(){return Yse(pi(this.restDecoder))}readJSON(){return JSON.parse(gd(this.restDecoder))}readKey(){return gd(this.restDecoder)}}class ple{constructor(e){this.dsCurrVal=0,this.restDecoder=e}resetDsCurVal(){this.dsCurrVal=0}readDsClock(){return this.dsCurrVal+=bt(this.restDecoder),this.dsCurrVal}readDsLen(){const e=bt(this.restDecoder)+1;return this.dsCurrVal+=e,e}}class Zd extends ple{constructor(e){super(e),this.keys=[],bt(e),this.keyClockDecoder=new uw(pi(e)),this.clientDecoder=new Gg(pi(e)),this.leftClockDecoder=new uw(pi(e)),this.rightClockDecoder=new uw(pi(e)),this.infoDecoder=new BP(pi(e),Gd),this.stringDecoder=new Pse(pi(e)),this.parentInfoDecoder=new BP(pi(e),Gd),this.typeRefDecoder=new Gg(pi(e)),this.lenDecoder=new Gg(pi(e))}readLeftID(){return new yd(this.clientDecoder.read(),this.leftClockDecoder.read())}readRightID(){return new yd(this.clientDecoder.read(),this.rightClockDecoder.read())}readClient(){return this.clientDecoder.read()}readInfo(){return this.infoDecoder.read()}readString(){return this.stringDecoder.read()}readParentInfo(){return this.parentInfoDecoder.read()===1}readTypeRef(){return this.typeRefDecoder.read()}readLen(){return this.lenDecoder.read()}readAny(){return qp(this.restDecoder)}readBuf(){return pi(this.restDecoder)}readJSON(){return qp(this.restDecoder)}readKey(){const e=this.keyClockDecoder.read();if(e<this.keys.length)return this.keys[e];{const r=this.stringDecoder.read();return this.keys.push(r),r}}}class mle{constructor(){this.restEncoder=$b()}toUint8Array(){return Ya(this.restEncoder)}resetDsCurVal(){}writeDsClock(e){Rt(this.restEncoder,e)}writeDsLen(e){Rt(this.restEncoder,e)}}class zm extends mle{writeLeftID(e){Rt(this.restEncoder,e.client),Rt(this.restEncoder,e.clock)}writeRightID(e){Rt(this.restEncoder,e.client),Rt(this.restEncoder,e.clock)}writeClient(e){Rt(this.restEncoder,e)}writeInfo(e){Z1(this.restEncoder,e)}writeString(e){vd(this.restEncoder,e)}writeParentInfo(e){Rt(this.restEncoder,e?1:0)}writeTypeRef(e){Rt(this.restEncoder,e)}writeLen(e){Rt(this.restEncoder,e)}writeAny(e){Gp(this.restEncoder,e)}writeBuf(e){hi(this.restEncoder,e)}writeJSON(e){vd(this.restEncoder,JSON.stringify(e))}writeKey(e){vd(this.restEncoder,e)}}class vle{constructor(){this.restEncoder=$b(),this.dsCurrVal=0}toUint8Array(){return Ya(this.restEncoder)}resetDsCurVal(){this.dsCurrVal=0}writeDsClock(e){const r=e-this.dsCurrVal;this.dsCurrVal=e,Rt(this.restEncoder,r)}writeDsLen(e){e===0&&oo(),Rt(this.restEncoder,e-1),this.dsCurrVal+=e}}class Au extends vle{constructor(){super(),this.keyMap=new Map,this.keyClock=0,this.keyClockEncoder=new lw,this.clientEncoder=new Wg,this.leftClockEncoder=new lw,this.rightClockEncoder=new lw,this.infoEncoder=new OP(Z1),this.stringEncoder=new wse,this.parentInfoEncoder=new OP(Z1),this.typeRefEncoder=new Wg,this.lenEncoder=new Wg}toUint8Array(){const e=$b();return Rt(e,0),hi(e,this.keyClockEncoder.toUint8Array()),hi(e,this.clientEncoder.toUint8Array()),hi(e,this.leftClockEncoder.toUint8Array()),hi(e,this.rightClockEncoder.toUint8Array()),hi(e,Ya(this.infoEncoder)),hi(e,this.stringEncoder.toUint8Array()),hi(e,Ya(this.parentInfoEncoder)),hi(e,this.typeRefEncoder.toUint8Array()),hi(e,this.lenEncoder.toUint8Array()),Lb(e,Ya(this.restEncoder)),Ya(e)}writeLeftID(e){this.clientEncoder.write(e.client),this.leftClockEncoder.write(e.clock)}writeRightID(e){this.clientEncoder.write(e.client),this.rightClockEncoder.write(e.clock)}writeClient(e){this.clientEncoder.write(e)}writeInfo(e){this.infoEncoder.write(e)}writeString(e){this.stringEncoder.write(e)}writeParentInfo(e){this.parentInfoEncoder.write(e?1:0)}writeTypeRef(e){this.typeRefEncoder.write(e)}writeLen(e){this.lenEncoder.write(e)}writeAny(e){Gp(this.restEncoder,e)}writeBuf(e){hi(this.restEncoder,e)}writeJSON(e){Gp(this.restEncoder,e)}writeKey(e){const r=this.keyMap.get(e);r===void 0?(this.keyClockEncoder.write(this.keyClock++),this.stringEncoder.write(e)):this.keyClockEncoder.write(r)}}const gle=(t,e,r,n)=>{n=qu(n,e[0].id.clock);const i=so(e,n);Rt(t.restEncoder,e.length-i),t.writeClient(r),Rt(t.restEncoder,n);const a=e[i];a.write(t,n-a.id.clock);for(let o=i+1;o<e.length;o++)e[o].write(t,0)},B4=(t,e,r)=>{const n=new Map;r.forEach((i,a)=>{an(e,a)>i&&n.set(a,i)}),N4(e).forEach((i,a)=>{r.has(a)||n.set(a,0)}),Rt(t.restEncoder,n.size),fl(n.entries()).sort((i,a)=>a[0]-i[0]).forEach(([i,a])=>{gle(t,e.clients.get(i),i,a)})},yle=(t,e)=>{const r=ei(),n=bt(t.restDecoder);for(let i=0;i<n;i++){const a=bt(t.restDecoder),o=new Array(a),s=t.readClient();let l=bt(t.restDecoder);r.set(s,{i:0,refs:o});for(let c=0;c<a;c++){const d=t.readInfo();switch(Ob&d){case 0:{const h=t.readLen();o[c]=new Xi(Et(s,l),h),l+=h;break}case 10:{const h=bt(t.restDecoder);o[c]=new Qi(Et(s,l),h),l+=h;break}default:{const h=(d&(Go|Ti))===0,p=new Kr(Et(s,l),null,(d&Ti)===Ti?t.readLeftID():null,null,(d&Go)===Go?t.readRightID():null,h?t.readParentInfo()?e.get(t.readString()):t.readLeftID():null,h&&(d&Hp)===Hp?t.readString():null,ij(t,d));o[c]=p,l+=p.length}}}}return r},ble=(t,e,r)=>{const n=[];let i=fl(r.keys()).sort((m,g)=>m-g);if(i.length===0)return null;const a=()=>{if(i.length===0)return null;let m=r.get(i[i.length-1]);for(;m.refs.length===m.i;)if(i.pop(),i.length>0)m=r.get(i[i.length-1]);else return null;return m};let o=a();if(o===null)return null;const s=new L9,l=new Map,c=(m,g)=>{const y=l.get(m);(y==null||y>g)&&l.set(m,g)};let d=o.refs[o.i++];const h=new Map,p=()=>{for(const m of n){const g=m.id.client,y=r.get(g);y?(y.i--,s.clients.set(g,y.refs.slice(y.i)),r.delete(g),y.i=0,y.refs=[]):s.clients.set(g,[m]),i=i.filter(R=>R!==g)}n.length=0};for(;;){if(d.constructor!==Qi){const g=as(h,d.id.client,()=>an(e,d.id.client))-d.id.clock;if(g<0)n.push(d),c(d.id.client,d.id.clock-1),p();else{const y=d.getMissing(t,e);if(y!==null){n.push(d);const R=r.get(y)||{refs:[],i:0};if(R.refs.length===R.i)c(y,an(e,y)),p();else{d=R.refs[R.i++];continue}}else(g===0||g<d.length)&&(d.integrate(t,g),h.set(d.id.client,d.id.clock+d.length))}}if(n.length>0)d=n.pop();else if(o!==null&&o.i<o.refs.length)d=o.refs[o.i++];else{if(o=a(),o===null)break;d=o.refs[o.i++]}}if(s.clients.size>0){const m=new Au;return B4(m,s,new Map),Rt(m.restEncoder,0),{missing:l,update:m.toUint8Array()}}return null},_le=(t,e)=>B4(t,e.doc.store,e.beforeState),Sle=(t,e,r,n=new Zd(t))=>Wt(e,i=>{i.local=!1;let a=!1;const o=i.doc,s=o.store,l=yle(n,o),c=ble(i,s,l),d=s.pendingStructs;if(d){for(const[p,m]of d.missing)if(m<an(s,p)){a=!0;break}if(c){for(const[p,m]of c.missing){const g=d.missing.get(p);(g==null||g>m)&&d.missing.set(p,m)}d.update=v0([d.update,c.update])}}else s.pendingStructs=c;const h=VP(n,i,s);if(s.pendingDs){const p=new Zd(xf(s.pendingDs));bt(p.restDecoder);const m=VP(p,i,s);h&&m?s.pendingDs=v0([h,m]):s.pendingDs=h||m}else s.pendingDs=h;if(a){const p=s.pendingStructs.update;s.pendingStructs=null,A9(i.doc,p)}},r,!1),A9=(t,e,r,n=Zd)=>{const i=xf(e);Sle(i,t,r,new n(i))},wle=(t,e,r)=>A9(t,e,r,P9),Ele=(t,e,r=new Map)=>{B4(t,e.store,r),Cf(t,hle(e.store))},xle=(t,e=new Uint8Array([0]),r=new Au)=>{const n=O9(e);Ele(r,t,n);const i=[r.toUint8Array()];if(t.store.pendingDs&&i.push(t.store.pendingDs),t.store.pendingStructs&&i.push(Lle(t.store.pendingStructs.update,e)),i.length>1){if(r.constructor===zm)return Ole(i.map((a,o)=>o===0?a:Nle(a)));if(r.constructor===Au)return v0(i)}return i[0]},k9=(t,e)=>xle(t,e,new zm),Cle=t=>{const e=new Map,r=bt(t.restDecoder);for(let n=0;n<r;n++){const i=bt(t.restDecoder),a=bt(t.restDecoder);e.set(i,a)}return e},O9=t=>Cle(new I9(xf(t)));class Tle{constructor(){this.l=[]}}const zP=()=>new Tle,KP=(t,e)=>t.l.push(e),HP=(t,e)=>{const r=t.l,n=r.length;t.l=r.filter(i=>e!==i),n===t.l.length&&console.error("[yjs] Tried to remove event handler that doesn't exist.")},$9=(t,e,r)=>A4(t.l,[e,r]);class yd{constructor(e,r){this.client=e,this.clock=r}}const lg=(t,e)=>t===e||t!==null&&e!==null&&t.client===e.client&&t.clock===e.clock,Et=(t,e)=>new yd(t,e),Dle=t=>{for(const[e,r]of t.doc.share.entries())if(r===t)return e;throw oo()},Oc=(t,e)=>e===void 0?!t.deleted:e.sv.has(t.id.client)&&(e.sv.get(t.id.client)||0)>t.id.clock&&!R9(e.ds,t.id),X1=(t,e)=>{const r=as(t.meta,X1,Pu),n=t.doc.store;r.has(e)||(e.sv.forEach((i,a)=>{i<an(n,a)&&pl(t,Et(a,i))}),D9(t,e.ds,i=>{}),r.add(e))};class L9{constructor(){this.clients=new Map,this.pendingStructs=null,this.pendingDs=null}}const N4=t=>{const e=new Map;return t.clients.forEach((r,n)=>{const i=r[r.length-1];e.set(n,i.id.clock+i.length)}),e},an=(t,e)=>{const r=t.clients.get(e);if(r===void 0)return 0;const n=r[r.length-1];return n.id.clock+n.length},B9=(t,e)=>{let r=t.clients.get(e.id.client);if(r===void 0)r=[],t.clients.set(e.id.client,r);else{const n=r[r.length-1];if(n.id.clock+n.length!==e.id.clock)throw oo()}r.push(e)},so=(t,e)=>{let r=0,n=t.length-1,i=t[n],a=i.id.clock;if(a===e)return n;let o=hl(e/(a+i.length-1)*n);for(;r<=n;){if(i=t[o],a=i.id.clock,a<=e){if(e<a+i.length)return o;r=o+1}else n=o-1;o=hl((r+n)/2)}throw oo()},Rle=(t,e)=>{const r=t.clients.get(e.client);return r[so(r,e.clock)]},dw=Rle,Q1=(t,e,r)=>{const n=so(e,r),i=e[n];return i.id.clock<r&&i instanceof Kr?(e.splice(n+1,0,w0(t,i,r-i.id.clock)),n+1):n},pl=(t,e)=>{const r=t.doc.store.clients.get(e.client);return r[Q1(t,r,e.clock)]},WP=(t,e,r)=>{const n=e.clients.get(r.client),i=so(n,r.clock),a=n[i];return r.clock!==a.id.clock+a.length-1&&a.constructor!==Xi&&n.splice(i+1,0,w0(t,a,r.clock-a.id.clock+1)),a},Mle=(t,e,r)=>{const n=t.clients.get(e.id.client);n[so(n,e.id.clock)]=r},N9=(t,e,r,n,i)=>{if(n===0)return;const a=r+n;let o=Q1(t,e,r),s;do s=e[o++],a<s.id.clock+s.length&&Q1(t,e,a),i(s);while(o<e.length&&e[o].id.clock<a)};class Ile{constructor(e,r,n){this.doc=e,this.deleteSet=new Vm,this.beforeState=N4(e.store),this.afterState=new Map,this.changed=new Map,this.changedParentTypes=new Map,this._mergeStructs=[],this.origin=r,this.meta=new Map,this.local=n,this.subdocsAdded=new Set,this.subdocsRemoved=new Set,this.subdocsLoaded=new Set,this._needFormattingCleanup=!1}}const GP=(t,e)=>e.deleteSet.clients.size===0&&!Qoe(e.afterState,(r,n)=>e.beforeState.get(n)!==r)?!1:($4(e.deleteSet),_le(t,e),Cf(t,e.deleteSet),!0),qP=(t,e,r)=>{const n=e._item;(n===null||n.id.clock<(t.beforeState.get(n.id.client)||0)&&!n.deleted)&&as(t.changed,e,Pu).add(r)},Zg=(t,e)=>{let r=t[e],n=t[e-1],i=e;for(;i>0;r=n,n=t[--i-1]){if(n.deleted===r.deleted&&n.constructor===r.constructor&&n.mergeWith(r)){r instanceof Kr&&r.parentSub!==null&&r.parent._map.get(r.parentSub)===r&&r.parent._map.set(r.parentSub,n);continue}break}const a=e-i;return a&&t.splice(e+1-a,a),a},Ple=(t,e,r)=>{for(const[n,i]of t.clients.entries()){const a=e.clients.get(n);for(let o=i.length-1;o>=0;o--){const s=i[o],l=s.clock+s.len;for(let c=so(a,s.clock),d=a[c];c<a.length&&d.id.clock<l;d=a[++c]){const h=a[c];if(s.clock+s.len<=h.id.clock)break;h instanceof Kr&&h.deleted&&!h.keep&&r(h)&&h.gc(e,!1)}}}},Ale=(t,e)=>{t.clients.forEach((r,n)=>{const i=e.clients.get(n);for(let a=r.length-1;a>=0;a--){const o=r[a],s=u9(i.length-1,1+so(i,o.clock+o.len-1));for(let l=s,c=i[l];l>0&&c.id.clock>=o.clock;c=i[l])l-=1+Zg(i,l)}})},U9=(t,e)=>{if(e<t.length){const r=t[e],n=r.doc,i=n.store,a=r.deleteSet,o=r._mergeStructs;try{$4(a),r.afterState=N4(r.doc.store),n.emit("beforeObserverCalls",[r,n]);const s=[];r.changed.forEach((l,c)=>s.push(()=>{(c._item===null||!c._item.deleted)&&c._callObserver(r,l)})),s.push(()=>{r.changedParentTypes.forEach((l,c)=>{c._dEH.l.length>0&&(c._item===null||!c._item.deleted)&&(l=l.filter(d=>d.target._item===null||!d.target._item.deleted),l.forEach(d=>{d.currentTarget=c,d._path=null}),l.sort((d,h)=>d.path.length-h.path.length),$9(c._dEH,l,r))})}),s.push(()=>n.emit("afterTransaction",[r,n])),A4(s,[]),r._needFormattingCleanup&&Xle(r)}finally{n.gc&&Ple(a,i,n.gcFilter),Ale(a,i),r.afterState.forEach((d,h)=>{const p=r.beforeState.get(h)||0;if(p!==d){const m=i.clients.get(h),g=qu(so(m,p),1);for(let y=m.length-1;y>=g;)y-=1+Zg(m,y)}});for(let d=o.length-1;d>=0;d--){const{client:h,clock:p}=o[d].id,m=i.clients.get(h),g=so(m,p);g+1<m.length&&Zg(m,g+1)>1||g>0&&Zg(m,g)}if(!r.local&&r.afterState.get(n.clientID)!==r.beforeState.get(n.clientID)&&(sle(k4,S9,"[yjs] ",w9,E9,"Changed the client-id because another client seems to be using it."),n.clientID=M9()),n.emit("afterTransactionCleanup",[r,n]),n._observers.has("update")){const d=new zm;GP(d,r)&&n.emit("update",[d.toUint8Array(),r.origin,n,r])}if(n._observers.has("updateV2")){const d=new Au;GP(d,r)&&n.emit("updateV2",[d.toUint8Array(),r.origin,n,r])}const{subdocsAdded:s,subdocsLoaded:l,subdocsRemoved:c}=r;(s.size>0||c.size>0||l.size>0)&&(s.forEach(d=>{d.clientID=n.clientID,d.collectionid==null&&(d.collectionid=n.collectionid),n.subdocs.add(d)}),c.forEach(d=>n.subdocs.delete(d)),n.emit("subdocs",[{loaded:l,added:s,removed:c},n,r]),c.forEach(d=>d.destroy())),t.length<=e+1?(n._transactionCleanups=[],n.emit("afterAllTransactions",[n,t])):U9(t,e+1)}}},Wt=(t,e,r=null,n=!0)=>{const i=t._transactionCleanups;let a=!1,o=null;t._transaction===null&&(a=!0,t._transaction=new Ile(t,r,n),i.push(t._transaction),i.length===1&&t.emit("beforeAllTransactions",[t]),t.emit("beforeTransaction",[t._transaction,t]));try{o=e(t._transaction)}finally{if(a){const s=t._transaction===i[0];t._transaction=null,s&&U9(i,0)}}return o};function*kle(t){const e=bt(t.restDecoder);for(let r=0;r<e;r++){const n=bt(t.restDecoder),i=t.readClient();let a=bt(t.restDecoder);for(let o=0;o<n;o++){const s=t.readInfo();if(s===10){const l=bt(t.restDecoder);yield new Qi(Et(i,a),l),a+=l}else if(Ob&s){const l=(s&(Go|Ti))===0,c=new Kr(Et(i,a),null,(s&Ti)===Ti?t.readLeftID():null,null,(s&Go)===Go?t.readRightID():null,l?t.readParentInfo()?t.readString():t.readLeftID():null,l&&(s&Hp)===Hp?t.readString():null,ij(t,s));yield c,a+=c.length}else{const l=t.readLen();yield new Xi(Et(i,a),l),a+=l}}}}class U4{constructor(e,r){this.gen=kle(e),this.curr=null,this.done=!1,this.filterSkips=r,this.next()}next(){do this.curr=this.gen.next().value||null;while(this.filterSkips&&this.curr!==null&&this.curr.constructor===Qi);return this.curr}}class F4{constructor(e){this.currClient=0,this.startClock=0,this.written=0,this.encoder=e,this.clientStructs=[]}}const Ole=t=>v0(t,P9,zm),$le=(t,e)=>{if(t.constructor===Xi){const{client:r,clock:n}=t.id;return new Xi(Et(r,n+e),t.length-e)}else if(t.constructor===Qi){const{client:r,clock:n}=t.id;return new Qi(Et(r,n+e),t.length-e)}else{const r=t,{client:n,clock:i}=r.id;return new Kr(Et(n,i+e),null,Et(n,i+e-1),null,r.rightOrigin,r.parent,r.parentSub,r.content.splice(e))}},v0=(t,e=Zd,r=Au)=>{if(t.length===1)return t[0];const n=t.map(d=>new e(xf(d)));let i=n.map(d=>new U4(d,!0)),a=null;const o=new r,s=new F4(o);for(;i=i.filter(p=>p.curr!==null),i.sort((p,m)=>{if(p.curr.id.client===m.curr.id.client){const g=p.curr.id.clock-m.curr.id.clock;return g===0?p.curr.constructor===m.curr.constructor?0:p.curr.constructor===Qi?1:-1:g}else return m.curr.id.client-p.curr.id.client}),i.length!==0;){const d=i[0],h=d.curr.id.client;if(a!==null){let p=d.curr,m=!1;for(;p!==null&&p.id.clock+p.length<=a.struct.id.clock+a.struct.length&&p.id.client>=a.struct.id.client;)p=d.next(),m=!0;if(p===null||p.id.client!==h||m&&p.id.clock>a.struct.id.clock+a.struct.length)continue;if(h!==a.struct.id.client)Ns(s,a.struct,a.offset),a={struct:p,offset:0},d.next();else if(a.struct.id.clock+a.struct.length<p.id.clock)if(a.struct.constructor===Qi)a.struct.length=p.id.clock+p.length-a.struct.id.clock;else{Ns(s,a.struct,a.offset);const g=p.id.clock-a.struct.id.clock-a.struct.length;a={struct:new Qi(Et(h,a.struct.id.clock+a.struct.length),g),offset:0}}else{const g=a.struct.id.clock+a.struct.length-p.id.clock;g>0&&(a.struct.constructor===Qi?a.struct.length-=g:p=$le(p,g)),a.struct.mergeWith(p)||(Ns(s,a.struct,a.offset),a={struct:p,offset:0},d.next())}}else a={struct:d.curr,offset:0},d.next();for(let p=d.curr;p!==null&&p.id.client===h&&p.id.clock===a.struct.id.clock+a.struct.length&&p.constructor!==Qi;p=d.next())Ns(s,a.struct,a.offset),a={struct:p,offset:0}}a!==null&&(Ns(s,a.struct,a.offset),a=null),j4(s);const l=n.map(d=>L4(d)),c=dle(l);return Cf(o,c),o.toUint8Array()},Lle=(t,e,r=Zd,n=Au)=>{const i=O9(e),a=new n,o=new F4(a),s=new r(xf(t)),l=new U4(s,!1);for(;l.curr;){const d=l.curr,h=d.id.client,p=i.get(h)||0;if(l.curr.constructor===Qi){l.next();continue}if(d.id.clock+d.length>p)for(Ns(o,d,qu(p-d.id.clock,0)),l.next();l.curr&&l.curr.id.client===h;)Ns(o,l.curr,0),l.next();else for(;l.curr&&l.curr.id.client===h&&l.curr.id.clock+l.curr.length<=p;)l.next()}j4(o);const c=L4(s);return Cf(a,c),a.toUint8Array()},F9=t=>{t.written>0&&(t.clientStructs.push({written:t.written,restEncoder:Ya(t.encoder.restEncoder)}),t.encoder.restEncoder=$b(),t.written=0)},Ns=(t,e,r)=>{t.written>0&&t.currClient!==e.id.client&&F9(t),t.written===0&&(t.currClient=e.id.client,t.encoder.writeClient(e.id.client),Rt(t.encoder.restEncoder,e.id.clock+r)),e.write(t.encoder,r),t.written++},j4=t=>{F9(t);const e=t.encoder.restEncoder;Rt(e,t.clientStructs.length);for(let r=0;r<t.clientStructs.length;r++){const n=t.clientStructs[r];Rt(e,n.written),Lb(e,n.restEncoder)}},Ble=(t,e,r,n)=>{const i=new r(xf(t)),a=new U4(i,!1),o=new n,s=new F4(o);for(let c=a.curr;c!==null;c=a.next())Ns(s,e(c),0);j4(s);const l=L4(i);return Cf(o,l),o.toUint8Array()},Nle=t=>Ble(t,Kse,Zd,zm),ZP="You must not compute changes after the event-handler fired.";class Nb{constructor(e,r){this.target=e,this.currentTarget=e,this.transaction=r,this._changes=null,this._keys=null,this._delta=null,this._path=null}get path(){return this._path||(this._path=Ule(this.currentTarget,this.target))}deletes(e){return R9(this.transaction.deleteSet,e.id)}get keys(){if(this._keys===null){if(this.transaction.doc._transactionCleanups.length===0)throw ts(ZP);const e=new Map,r=this.target;this.transaction.changed.get(r).forEach(i=>{if(i!==null){const a=r._map.get(i);let o,s;if(this.adds(a)){let l=a.left;for(;l!==null&&this.adds(l);)l=l.left;if(this.deletes(a))if(l!==null&&this.deletes(l))o="delete",s=aw(l.content.getContent());else return;else l!==null&&this.deletes(l)?(o="update",s=aw(l.content.getContent())):(o="add",s=void 0)}else if(this.deletes(a))o="delete",s=aw(a.content.getContent());else return;e.set(i,{action:o,oldValue:s})}}),this._keys=e}return this._keys}get delta(){return this.changes.delta}adds(e){return e.id.clock>=(this.transaction.beforeState.get(e.id.client)||0)}get changes(){let e=this._changes;if(e===null){if(this.transaction.doc._transactionCleanups.length===0)throw ts(ZP);const r=this.target,n=Pu(),i=Pu(),a=[];if(e={added:n,deleted:i,delta:a,keys:this.keys},this.transaction.changed.get(r).has(null)){let s=null;const l=()=>{s&&a.push(s)};for(let c=r._start;c!==null;c=c.right)c.deleted?this.deletes(c)&&!this.adds(c)&&((s===null||s.delete===void 0)&&(l(),s={delete:0}),s.delete+=c.length,i.add(c)):this.adds(c)?((s===null||s.insert===void 0)&&(l(),s={insert:[]}),s.insert=s.insert.concat(c.content.getContent()),n.add(c)):((s===null||s.retain===void 0)&&(l(),s={retain:0}),s.retain+=c.length);s!==null&&s.retain===void 0&&l()}this._changes=e}return e}}const Ule=(t,e)=>{const r=[];for(;e._item!==null&&e!==t;){if(e._item.parentSub!==null)r.unshift(e._item.parentSub);else{let n=0,i=e._item.parent._start;for(;i!==e._item&&i!==null;)!i.deleted&&i.countable&&(n+=i.length),i=i.right;r.unshift(n)}e=e._item.parent}return r},Cn=()=>{lle("Invalid access: Add Yjs type to a document before reading data.")},j9=80;let V4=0;class Fle{constructor(e,r){e.marker=!0,this.p=e,this.index=r,this.timestamp=V4++}}const jle=t=>{t.timestamp=V4++},V9=(t,e,r)=>{t.p.marker=!1,t.p=e,e.marker=!0,t.index=r,t.timestamp=V4++},Vle=(t,e,r)=>{if(t.length>=j9){const n=t.reduce((i,a)=>i.timestamp<a.timestamp?i:a);return V9(n,e,r),n}else{const n=new Fle(e,r);return t.push(n),n}},Ub=(t,e)=>{if(t._start===null||e===0||t._searchMarker===null)return null;const r=t._searchMarker.length===0?null:t._searchMarker.reduce((a,o)=>Hg(e-a.index)<Hg(e-o.index)?a:o);let n=t._start,i=0;for(r!==null&&(n=r.p,i=r.index,jle(r));n.right!==null&&i<e;){if(!n.deleted&&n.countable){if(e<i+n.length)break;i+=n.length}n=n.right}for(;n.left!==null&&i>e;)n=n.left,!n.deleted&&n.countable&&(i-=n.length);for(;n.left!==null&&n.left.id.client===n.id.client&&n.left.id.clock+n.left.length===n.id.clock;)n=n.left,!n.deleted&&n.countable&&(i-=n.length);return r!==null&&Hg(r.index-i)<n.parent.length/j9?(V9(r,n,i),r):Vle(t._searchMarker,n,i)},Yp=(t,e,r)=>{for(let n=t.length-1;n>=0;n--){const i=t[n];if(r>0){let a=i.p;for(a.marker=!1;a&&(a.deleted||!a.countable);)a=a.left,a&&!a.deleted&&a.countable&&(i.index-=a.length);if(a===null||a.marker===!0){t.splice(n,1);continue}i.p=a,a.marker=!0}(e<i.index||r>0&&e===i.index)&&(i.index=qu(e,i.index+r))}},Fb=(t,e,r)=>{const n=t,i=e.changedParentTypes;for(;as(i,t,()=>[]).push(r),t._item!==null;)t=t._item.parent;$9(n._eH,r,e)};class gn{constructor(){this._item=null,this._map=new Map,this._start=null,this.doc=null,this._length=0,this._eH=zP(),this._dEH=zP(),this._searchMarker=null}get parent(){return this._item?this._item.parent:null}_integrate(e,r){this.doc=e,this._item=r}_copy(){throw eo()}clone(){throw eo()}_write(e){}get _first(){let e=this._start;for(;e!==null&&e.deleted;)e=e.right;return e}_callObserver(e,r){!e.local&&this._searchMarker&&(this._searchMarker.length=0)}observe(e){KP(this._eH,e)}observeDeep(e){KP(this._dEH,e)}unobserve(e){HP(this._eH,e)}unobserveDeep(e){HP(this._dEH,e)}toJSON(){}}const z9=(t,e,r)=>{t.doc??Cn(),e<0&&(e=t._length+e),r<0&&(r=t._length+r);let n=r-e;const i=[];let a=t._start;for(;a!==null&&n>0;){if(a.countable&&!a.deleted){const o=a.content.getContent();if(o.length<=e)e-=o.length;else{for(let s=e;s<o.length&&n>0;s++)i.push(o[s]),n--;e=0}}a=a.right}return i},K9=t=>{t.doc??Cn();const e=[];let r=t._start;for(;r!==null;){if(r.countable&&!r.deleted){const n=r.content.getContent();for(let i=0;i<n.length;i++)e.push(n[i])}r=r.right}return e},Jp=(t,e)=>{let r=0,n=t._start;for(t.doc??Cn();n!==null;){if(n.countable&&!n.deleted){const i=n.content.getContent();for(let a=0;a<i.length;a++)e(i[a],r++,t)}n=n.right}},H9=(t,e)=>{const r=[];return Jp(t,(n,i)=>{r.push(e(n,i,t))}),r},zle=t=>{let e=t._start,r=null,n=0;return{[Symbol.iterator](){return this},next:()=>{if(r===null){for(;e!==null&&e.deleted;)e=e.right;if(e===null)return{done:!0,value:void 0};r=e.content.getContent(),n=0,e=e.right}const i=r[n++];return r.length<=n&&(r=null),{done:!1,value:i}}}},W9=(t,e)=>{t.doc??Cn();const r=Ub(t,e);let n=t._start;for(r!==null&&(n=r.p,e-=r.index);n!==null;n=n.right)if(!n.deleted&&n.countable){if(e<n.length)return n.content.getContent()[e];e-=n.length}},g0=(t,e,r,n)=>{let i=r;const a=t.doc,o=a.clientID,s=a.store,l=r===null?e._start:r.right;let c=[];const d=()=>{c.length>0&&(i=new Kr(Et(o,an(s,o)),i,i&&i.lastId,l,l&&l.id,e,null,new Ou(c)),i.integrate(t,0),c=[])};n.forEach(h=>{if(h===null)c.push(h);else switch(h.constructor){case Number:case Object:case Boolean:case Array:case String:c.push(h);break;default:switch(d(),h.constructor){case Uint8Array:case ArrayBuffer:i=new Kr(Et(o,an(s,o)),i,i&&i.lastId,l,l&&l.id,e,null,new Km(new Uint8Array(h))),i.integrate(t,0);break;case Tf:i=new Kr(Et(o,an(s,o)),i,i&&i.lastId,l,l&&l.id,e,null,new Hm(h)),i.integrate(t,0);break;default:if(h instanceof gn)i=new Kr(Et(o,an(s,o)),i,i&&i.lastId,l,l&&l.id,e,null,new Yu(h)),i.integrate(t,0);else throw new Error("Unexpected content type in insert operation")}}}),d()},G9=()=>ts("Length exceeded!"),q9=(t,e,r,n)=>{if(r>e._length)throw G9();if(r===0)return e._searchMarker&&Yp(e._searchMarker,r,n.length),g0(t,e,null,n);const i=r,a=Ub(e,r);let o=e._start;for(a!==null&&(o=a.p,r-=a.index,r===0&&(o=o.prev,r+=o&&o.countable&&!o.deleted?o.length:0));o!==null;o=o.right)if(!o.deleted&&o.countable){if(r<=o.length){r<o.length&&pl(t,Et(o.id.client,o.id.clock+r));break}r-=o.length}return e._searchMarker&&Yp(e._searchMarker,i,n.length),g0(t,e,o,n)},Kle=(t,e,r)=>{let i=(e._searchMarker||[]).reduce((a,o)=>o.index>a.index?o:a,{index:0,p:e._start}).p;if(i)for(;i.right;)i=i.right;return g0(t,e,i,r)},Z9=(t,e,r,n)=>{if(n===0)return;const i=r,a=n,o=Ub(e,r);let s=e._start;for(o!==null&&(s=o.p,r-=o.index);s!==null&&r>0;s=s.right)!s.deleted&&s.countable&&(r<s.length&&pl(t,Et(s.id.client,s.id.clock+r)),r-=s.length);for(;n>0&&s!==null;)s.deleted||(n<s.length&&pl(t,Et(s.id.client,s.id.clock+n)),s.delete(t),n-=s.length),s=s.right;if(n>0)throw G9();e._searchMarker&&Yp(e._searchMarker,i,-a+n)},y0=(t,e,r)=>{const n=e._map.get(r);n!==void 0&&n.delete(t)},z4=(t,e,r,n)=>{const i=e._map.get(r)||null,a=t.doc,o=a.clientID;let s;if(n==null)s=new Ou([n]);else switch(n.constructor){case Number:case Object:case Boolean:case Array:case String:s=new Ou([n]);break;case Uint8Array:s=new Km(n);break;case Tf:s=new Hm(n);break;default:if(n instanceof gn)s=new Yu(n);else throw new Error("Unexpected content type")}new Kr(Et(o,an(a.store,o)),i,i&&i.lastId,null,null,e,r,s).integrate(t,0)},K4=(t,e)=>{t.doc??Cn();const r=t._map.get(e);return r!==void 0&&!r.deleted?r.content.getContent()[r.length-1]:void 0},Y9=t=>{const e={};return t.doc??Cn(),t._map.forEach((r,n)=>{r.deleted||(e[n]=r.content.getContent()[r.length-1])}),e},J9=(t,e)=>{t.doc??Cn();const r=t._map.get(e);return r!==void 0&&!r.deleted},Hle=(t,e)=>{const r={};return t._map.forEach((n,i)=>{let a=n;for(;a!==null&&(!e.sv.has(a.id.client)||a.id.clock>=(e.sv.get(a.id.client)||0));)a=a.left;a!==null&&Oc(a,e)&&(r[i]=a.content.getContent()[a.length-1])}),r},ug=t=>(t.doc??Cn(),ule(t._map.entries(),e=>!e[1].deleted));class Wle extends Nb{}class bd extends gn{constructor(){super(),this._prelimContent=[],this._searchMarker=[]}static from(e){const r=new bd;return r.push(e),r}_integrate(e,r){super._integrate(e,r),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new bd}clone(){const e=new bd;return e.insert(0,this.toArray().map(r=>r instanceof gn?r.clone():r)),e}get length(){return this.doc??Cn(),this._length}_callObserver(e,r){super._callObserver(e,r),Fb(this,e,new Wle(this,e))}insert(e,r){this.doc!==null?Wt(this.doc,n=>{q9(n,this,e,r)}):this._prelimContent.splice(e,0,...r)}push(e){this.doc!==null?Wt(this.doc,r=>{Kle(r,this,e)}):this._prelimContent.push(...e)}unshift(e){this.insert(0,e)}delete(e,r=1){this.doc!==null?Wt(this.doc,n=>{Z9(n,this,e,r)}):this._prelimContent.splice(e,r)}get(e){return W9(this,e)}toArray(){return K9(this)}slice(e=0,r=this.length){return z9(this,e,r)}toJSON(){return this.map(e=>e instanceof gn?e.toJSON():e)}map(e){return H9(this,e)}forEach(e){Jp(this,e)}[Symbol.iterator](){return zle(this)}_write(e){e.writeTypeRef(gue)}}const Gle=t=>new bd;class qle extends Nb{constructor(e,r,n){super(e,r),this.keysChanged=n}}class Yd extends gn{constructor(e){super(),this._prelimContent=null,e===void 0?this._prelimContent=new Map:this._prelimContent=new Map(e)}_integrate(e,r){super._integrate(e,r),this._prelimContent.forEach((n,i)=>{this.set(i,n)}),this._prelimContent=null}_copy(){return new Yd}clone(){const e=new Yd;return this.forEach((r,n)=>{e.set(n,r instanceof gn?r.clone():r)}),e}_callObserver(e,r){Fb(this,e,new qle(this,e,r))}toJSON(){this.doc??Cn();const e={};return this._map.forEach((r,n)=>{if(!r.deleted){const i=r.content.getContent()[r.length-1];e[n]=i instanceof gn?i.toJSON():i}}),e}get size(){return[...ug(this)].length}keys(){return cw(ug(this),e=>e[0])}values(){return cw(ug(this),e=>e[1].content.getContent()[e[1].length-1])}entries(){return cw(ug(this),e=>[e[0],e[1].content.getContent()[e[1].length-1]])}forEach(e){this.doc??Cn(),this._map.forEach((r,n)=>{r.deleted||e(r.content.getContent()[r.length-1],n,this)})}[Symbol.iterator](){return this.entries()}delete(e){this.doc!==null?Wt(this.doc,r=>{y0(r,this,e)}):this._prelimContent.delete(e)}set(e,r){return this.doc!==null?Wt(this.doc,n=>{z4(n,this,e,r)}):this._prelimContent.set(e,r),r}get(e){return K4(this,e)}has(e){return J9(this,e)}clear(){this.doc!==null?Wt(this.doc,e=>{this.forEach(function(r,n,i){y0(e,i,n)})}):this._prelimContent.clear()}_write(e){e.writeTypeRef(yue)}}const Zle=t=>new Yd,Hs=(t,e)=>t===e||typeof t=="object"&&typeof e=="object"&&t&&e&&Vse(t,e);class ex{constructor(e,r,n,i){this.left=e,this.right=r,this.index=n,this.currentAttributes=i}forward(){switch(this.right===null&&oo(),this.right.content.constructor){case Wr:this.right.deleted||Df(this.currentAttributes,this.right.content);break;default:this.right.deleted||(this.index+=this.right.length);break}this.left=this.right,this.right=this.right.right}}const YP=(t,e,r)=>{for(;e.right!==null&&r>0;){switch(e.right.content.constructor){case Wr:e.right.deleted||Df(e.currentAttributes,e.right.content);break;default:e.right.deleted||(r<e.right.length&&pl(t,Et(e.right.id.client,e.right.id.clock+r)),e.index+=e.right.length,r-=e.right.length);break}e.left=e.right,e.right=e.right.right}return e},cg=(t,e,r,n)=>{const i=new Map,a=n?Ub(e,r):null;if(a){const o=new ex(a.p.left,a.p,a.index,i);return YP(t,o,r-a.index)}else{const o=new ex(null,e._start,0,i);return YP(t,o,r)}},X9=(t,e,r,n)=>{for(;r.right!==null&&(r.right.deleted===!0||r.right.content.constructor===Wr&&Hs(n.get(r.right.content.key),r.right.content.value));)r.right.deleted||n.delete(r.right.content.key),r.forward();const i=t.doc,a=i.clientID;n.forEach((o,s)=>{const l=r.left,c=r.right,d=new Kr(Et(a,an(i.store,a)),l,l&&l.lastId,c,c&&c.id,e,null,new Wr(s,o));d.integrate(t,0),r.right=d,r.forward()})},Df=(t,e)=>{const{key:r,value:n}=e;n===null?t.delete(r):t.set(r,n)},Q9=(t,e)=>{for(;t.right!==null;){if(!(t.right.deleted||t.right.content.constructor===Wr&&Hs(e[t.right.content.key]??null,t.right.content.value)))break;t.forward()}},ej=(t,e,r,n)=>{const i=t.doc,a=i.clientID,o=new Map;for(const s in n){const l=n[s],c=r.currentAttributes.get(s)??null;if(!Hs(c,l)){o.set(s,c);const{left:d,right:h}=r;r.right=new Kr(Et(a,an(i.store,a)),d,d&&d.lastId,h,h&&h.id,e,null,new Wr(s,l)),r.right.integrate(t,0),r.forward()}}return o},fw=(t,e,r,n,i)=>{r.currentAttributes.forEach((p,m)=>{i[m]===void 0&&(i[m]=null)});const a=t.doc,o=a.clientID;Q9(r,i);const s=ej(t,e,r,i),l=n.constructor===String?new lo(n):n instanceof gn?new Yu(n):new Zu(n);let{left:c,right:d,index:h}=r;e._searchMarker&&Yp(e._searchMarker,r.index,l.getLength()),d=new Kr(Et(o,an(a.store,o)),c,c&&c.lastId,d,d&&d.id,e,null,l),d.integrate(t,0),r.right=d,r.index=h,r.forward(),X9(t,e,r,s)},JP=(t,e,r,n,i)=>{const a=t.doc,o=a.clientID;Q9(r,i);const s=ej(t,e,r,i);e:for(;r.right!==null&&(n>0||s.size>0&&(r.right.deleted||r.right.content.constructor===Wr));){if(!r.right.deleted)switch(r.right.content.constructor){case Wr:{const{key:l,value:c}=r.right.content,d=i[l];if(d!==void 0){if(Hs(d,c))s.delete(l);else{if(n===0)break e;s.set(l,c)}r.right.delete(t)}else r.currentAttributes.set(l,c);break}default:n<r.right.length&&pl(t,Et(r.right.id.client,r.right.id.clock+n)),n-=r.right.length;break}r.forward()}if(n>0){let l="";for(;n>0;n--)l+=`
`;r.right=new Kr(Et(o,an(a.store,o)),r.left,r.left&&r.left.lastId,r.right,r.right&&r.right.id,e,null,new lo(l)),r.right.integrate(t,0),r.forward()}X9(t,e,r,s)},tj=(t,e,r,n,i)=>{let a=e;const o=ei();for(;a&&(!a.countable||a.deleted);){if(!a.deleted&&a.content.constructor===Wr){const c=a.content;o.set(c.key,c)}a=a.right}let s=0,l=!1;for(;e!==a;){if(r===e&&(l=!0),!e.deleted){const c=e.content;switch(c.constructor){case Wr:{const{key:d,value:h}=c,p=n.get(d)??null;(o.get(d)!==c||p===h)&&(e.delete(t),s++,!l&&(i.get(d)??null)===h&&p!==h&&(p===null?i.delete(d):i.set(d,p))),!l&&!e.deleted&&Df(i,c);break}}}e=e.right}return s},Yle=(t,e)=>{for(;e&&e.right&&(e.right.deleted||!e.right.countable);)e=e.right;const r=new Set;for(;e&&(e.deleted||!e.countable);){if(!e.deleted&&e.content.constructor===Wr){const n=e.content.key;r.has(n)?e.delete(t):r.add(n)}e=e.left}},Jle=t=>{let e=0;return Wt(t.doc,r=>{let n=t._start,i=t._start,a=ei();const o=G1(a);for(;i;){if(i.deleted===!1)switch(i.content.constructor){case Wr:Df(o,i.content);break;default:e+=tj(r,n,i,a,o),a=G1(o),n=i;break}i=i.right}}),e},Xle=t=>{const e=new Set,r=t.doc;for(const[n,i]of t.afterState.entries()){const a=t.beforeState.get(n)||0;i!==a&&N9(t,r.store.clients.get(n),a,i,o=>{!o.deleted&&o.content.constructor===Wr&&o.constructor!==Xi&&e.add(o.parent)})}Wt(r,n=>{D9(t,t.deleteSet,i=>{if(i instanceof Xi||!i.parent._hasFormatting||e.has(i.parent))return;const a=i.parent;i.content.constructor===Wr?e.add(a):Yle(n,i)});for(const i of e)Jle(i)})},XP=(t,e,r)=>{const n=r,i=G1(e.currentAttributes),a=e.right;for(;r>0&&e.right!==null;){if(e.right.deleted===!1)switch(e.right.content.constructor){case Yu:case Zu:case lo:r<e.right.length&&pl(t,Et(e.right.id.client,e.right.id.clock+r)),r-=e.right.length,e.right.delete(t);break}e.forward()}a&&tj(t,a,e.right,i,e.currentAttributes);const o=(e.left||e.right).parent;return o._searchMarker&&Yp(o._searchMarker,e.index,-n+r),e};class Qle extends Nb{constructor(e,r,n){super(e,r),this.childListChanged=!1,this.keysChanged=new Set,n.forEach(i=>{i===null?this.childListChanged=!0:this.keysChanged.add(i)})}get changes(){if(this._changes===null){const e={keys:this.keys,delta:this.delta,added:new Set,deleted:new Set};this._changes=e}return this._changes}get delta(){if(this._delta===null){const e=this.target.doc,r=[];Wt(e,n=>{const i=new Map,a=new Map;let o=this.target._start,s=null;const l={};let c="",d=0,h=0;const p=()=>{if(s!==null){let m=null;switch(s){case"delete":h>0&&(m={delete:h}),h=0;break;case"insert":(typeof c=="object"||c.length>0)&&(m={insert:c},i.size>0&&(m.attributes={},i.forEach((g,y)=>{g!==null&&(m.attributes[y]=g)}))),c="";break;case"retain":d>0&&(m={retain:d},Fse(l)||(m.attributes=Nse({},l))),d=0;break}m&&r.push(m),s=null}};for(;o!==null;){switch(o.content.constructor){case Yu:case Zu:this.adds(o)?this.deletes(o)||(p(),s="insert",c=o.content.getContent()[0],p()):this.deletes(o)?(s!=="delete"&&(p(),s="delete"),h+=1):o.deleted||(s!=="retain"&&(p(),s="retain"),d+=1);break;case lo:this.adds(o)?this.deletes(o)||(s!=="insert"&&(p(),s="insert"),c+=o.content.str):this.deletes(o)?(s!=="delete"&&(p(),s="delete"),h+=o.length):o.deleted||(s!=="retain"&&(p(),s="retain"),d+=o.length);break;case Wr:{const{key:m,value:g}=o.content;if(this.adds(o)){if(!this.deletes(o)){const y=i.get(m)??null;Hs(y,g)?g!==null&&o.delete(n):(s==="retain"&&p(),Hs(g,a.get(m)??null)?delete l[m]:l[m]=g)}}else if(this.deletes(o)){a.set(m,g);const y=i.get(m)??null;Hs(y,g)||(s==="retain"&&p(),l[m]=y)}else if(!o.deleted){a.set(m,g);const y=l[m];y!==void 0&&(Hs(y,g)?y!==null&&o.delete(n):(s==="retain"&&p(),g===null?delete l[m]:l[m]=g))}o.deleted||(s==="insert"&&p(),Df(i,o.content));break}}o=o.right}for(p();r.length>0;){const m=r[r.length-1];if(m.retain!==void 0&&m.attributes===void 0)r.pop();else break}}),this._delta=r}return this._delta}}class Jd extends gn{constructor(e){super(),this._pending=e!==void 0?[()=>this.insert(0,e)]:[],this._searchMarker=[],this._hasFormatting=!1}get length(){return this.doc??Cn(),this._length}_integrate(e,r){super._integrate(e,r);try{this._pending.forEach(n=>n())}catch(n){console.error(n)}this._pending=null}_copy(){return new Jd}clone(){const e=new Jd;return e.applyDelta(this.toDelta()),e}_callObserver(e,r){super._callObserver(e,r);const n=new Qle(this,e,r);Fb(this,e,n),!e.local&&this._hasFormatting&&(e._needFormattingCleanup=!0)}toString(){this.doc??Cn();let e="",r=this._start;for(;r!==null;)!r.deleted&&r.countable&&r.content.constructor===lo&&(e+=r.content.str),r=r.right;return e}toJSON(){return this.toString()}applyDelta(e,{sanitize:r=!0}={}){this.doc!==null?Wt(this.doc,n=>{const i=new ex(null,this._start,0,new Map);for(let a=0;a<e.length;a++){const o=e[a];if(o.insert!==void 0){const s=!r&&typeof o.insert=="string"&&a===e.length-1&&i.right===null&&o.insert.slice(-1)===`
`?o.insert.slice(0,-1):o.insert;(typeof s!="string"||s.length>0)&&fw(n,this,i,s,o.attributes||{})}else o.retain!==void 0?JP(n,this,i,o.retain,o.attributes||{}):o.delete!==void 0&&XP(n,i,o.delete)}}):this._pending.push(()=>this.applyDelta(e))}toDelta(e,r,n){this.doc??Cn();const i=[],a=new Map,o=this.doc;let s="",l=this._start;function c(){if(s.length>0){const h={};let p=!1;a.forEach((g,y)=>{p=!0,h[y]=g});const m={insert:s};p&&(m.attributes=h),i.push(m),s=""}}const d=()=>{for(;l!==null;){if(Oc(l,e)||r!==void 0&&Oc(l,r))switch(l.content.constructor){case lo:{const h=a.get("ychange");e!==void 0&&!Oc(l,e)?(h===void 0||h.user!==l.id.client||h.type!=="removed")&&(c(),a.set("ychange",n?n("removed",l.id):{type:"removed"})):r!==void 0&&!Oc(l,r)?(h===void 0||h.user!==l.id.client||h.type!=="added")&&(c(),a.set("ychange",n?n("added",l.id):{type:"added"})):h!==void 0&&(c(),a.delete("ychange")),s+=l.content.str;break}case Yu:case Zu:{c();const h={insert:l.content.getContent()[0]};if(a.size>0){const p={};h.attributes=p,a.forEach((m,g)=>{p[g]=m})}i.push(h);break}case Wr:Oc(l,e)&&(c(),Df(a,l.content));break}l=l.right}c()};return e||r?Wt(o,h=>{e&&X1(h,e),r&&X1(h,r),d()},"cleanup"):d(),i}insert(e,r,n){if(r.length<=0)return;const i=this.doc;i!==null?Wt(i,a=>{const o=cg(a,this,e,!n);n||(n={},o.currentAttributes.forEach((s,l)=>{n[l]=s})),fw(a,this,o,r,n)}):this._pending.push(()=>this.insert(e,r,n))}insertEmbed(e,r,n){const i=this.doc;i!==null?Wt(i,a=>{const o=cg(a,this,e,!n);fw(a,this,o,r,n||{})}):this._pending.push(()=>this.insertEmbed(e,r,n||{}))}delete(e,r){if(r===0)return;const n=this.doc;n!==null?Wt(n,i=>{XP(i,cg(i,this,e,!0),r)}):this._pending.push(()=>this.delete(e,r))}format(e,r,n){if(r===0)return;const i=this.doc;i!==null?Wt(i,a=>{const o=cg(a,this,e,!1);o.right!==null&&JP(a,this,o,r,n)}):this._pending.push(()=>this.format(e,r,n))}removeAttribute(e){this.doc!==null?Wt(this.doc,r=>{y0(r,this,e)}):this._pending.push(()=>this.removeAttribute(e))}setAttribute(e,r){this.doc!==null?Wt(this.doc,n=>{z4(n,this,e,r)}):this._pending.push(()=>this.setAttribute(e,r))}getAttribute(e){return K4(this,e)}getAttributes(){return Y9(this)}_write(e){e.writeTypeRef(bue)}}const eue=t=>new Jd;class hw{constructor(e,r=()=>!0){this._filter=r,this._root=e,this._currentNode=e._start,this._firstCall=!0,e.doc??Cn()}[Symbol.iterator](){return this}next(){let e=this._currentNode,r=e&&e.content&&e.content.type;if(e!==null&&(!this._firstCall||e.deleted||!this._filter(r)))do if(r=e.content.type,!e.deleted&&(r.constructor===Xd||r.constructor===ku)&&r._start!==null)e=r._start;else for(;e!==null;){const n=e.next;if(n!==null){e=n;break}else e.parent===this._root?e=null:e=e.parent._item}while(e!==null&&(e.deleted||!this._filter(e.content.type)));return this._firstCall=!1,e===null?{value:void 0,done:!0}:(this._currentNode=e,{value:e.content.type,done:!1})}}class ku extends gn{constructor(){super(),this._prelimContent=[]}get firstChild(){const e=this._first;return e?e.content.getContent()[0]:null}_integrate(e,r){super._integrate(e,r),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new ku}clone(){const e=new ku;return e.insert(0,this.toArray().map(r=>r instanceof gn?r.clone():r)),e}get length(){return this.doc??Cn(),this._prelimContent===null?this._length:this._prelimContent.length}createTreeWalker(e){return new hw(this,e)}querySelector(e){e=e.toUpperCase();const n=new hw(this,i=>i.nodeName&&i.nodeName.toUpperCase()===e).next();return n.done?null:n.value}querySelectorAll(e){return e=e.toUpperCase(),fl(new hw(this,r=>r.nodeName&&r.nodeName.toUpperCase()===e))}_callObserver(e,r){Fb(this,e,new nue(this,r,e))}toString(){return H9(this,e=>e.toString()).join("")}toJSON(){return this.toString()}toDOM(e=document,r={},n){const i=e.createDocumentFragment();return n!==void 0&&n._createAssociation(i,this),Jp(this,a=>{i.insertBefore(a.toDOM(e,r,n),null)}),i}insert(e,r){this.doc!==null?Wt(this.doc,n=>{q9(n,this,e,r)}):this._prelimContent.splice(e,0,...r)}insertAfter(e,r){if(this.doc!==null)Wt(this.doc,n=>{const i=e&&e instanceof gn?e._item:e;g0(n,this,i,r)});else{const n=this._prelimContent,i=e===null?0:n.findIndex(a=>a===e)+1;if(i===0&&e!==null)throw ts("Reference item not found");n.splice(i,0,...r)}}delete(e,r=1){this.doc!==null?Wt(this.doc,n=>{Z9(n,this,e,r)}):this._prelimContent.splice(e,r)}toArray(){return K9(this)}push(e){this.insert(this.length,e)}unshift(e){this.insert(0,e)}get(e){return W9(this,e)}slice(e=0,r=this.length){return z9(this,e,r)}forEach(e){Jp(this,e)}_write(e){e.writeTypeRef(Sue)}}const tue=t=>new ku;class Xd extends ku{constructor(e="UNDEFINED"){super(),this.nodeName=e,this._prelimAttrs=new Map}get nextSibling(){const e=this._item?this._item.next:null;return e?e.content.type:null}get prevSibling(){const e=this._item?this._item.prev:null;return e?e.content.type:null}_integrate(e,r){super._integrate(e,r),this._prelimAttrs.forEach((n,i)=>{this.setAttribute(i,n)}),this._prelimAttrs=null}_copy(){return new Xd(this.nodeName)}clone(){const e=new Xd(this.nodeName),r=this.getAttributes();return Use(r,(n,i)=>{typeof n=="string"&&e.setAttribute(i,n)}),e.insert(0,this.toArray().map(n=>n instanceof gn?n.clone():n)),e}toString(){const e=this.getAttributes(),r=[],n=[];for(const s in e)n.push(s);n.sort();const i=n.length;for(let s=0;s<i;s++){const l=n[s];r.push(l+'="'+e[l]+'"')}const a=this.nodeName.toLocaleLowerCase(),o=r.length>0?" "+r.join(" "):"";return`<${a}${o}>${super.toString()}</${a}>`}removeAttribute(e){this.doc!==null?Wt(this.doc,r=>{y0(r,this,e)}):this._prelimAttrs.delete(e)}setAttribute(e,r){this.doc!==null?Wt(this.doc,n=>{z4(n,this,e,r)}):this._prelimAttrs.set(e,r)}getAttribute(e){return K4(this,e)}hasAttribute(e){return J9(this,e)}getAttributes(e){return e?Hle(this,e):Y9(this)}toDOM(e=document,r={},n){const i=e.createElement(this.nodeName),a=this.getAttributes();for(const o in a){const s=a[o];typeof s=="string"&&i.setAttribute(o,s)}return Jp(this,o=>{i.appendChild(o.toDOM(e,r,n))}),n!==void 0&&n._createAssociation(i,this),i}_write(e){e.writeTypeRef(_ue),e.writeKey(this.nodeName)}}const rue=t=>new Xd(t.readKey());class nue extends Nb{constructor(e,r,n){super(e,n),this.childListChanged=!1,this.attributesChanged=new Set,r.forEach(i=>{i===null?this.childListChanged=!0:this.attributesChanged.add(i)})}}class b0 extends Yd{constructor(e){super(),this.hookName=e}_copy(){return new b0(this.hookName)}clone(){const e=new b0(this.hookName);return this.forEach((r,n)=>{e.set(n,r)}),e}toDOM(e=document,r={},n){const i=r[this.hookName];let a;return i!==void 0?a=i.createDom(this):a=document.createElement(this.hookName),a.setAttribute("data-yjs-hook",this.hookName),n!==void 0&&n._createAssociation(a,this),a}_write(e){e.writeTypeRef(wue),e.writeKey(this.hookName)}}const iue=t=>new b0(t.readKey());class _0 extends Jd{get nextSibling(){const e=this._item?this._item.next:null;return e?e.content.type:null}get prevSibling(){const e=this._item?this._item.prev:null;return e?e.content.type:null}_copy(){return new _0}clone(){const e=new _0;return e.applyDelta(this.toDelta()),e}toDOM(e=document,r,n){const i=e.createTextNode(this.toString());return n!==void 0&&n._createAssociation(i,this),i}toString(){return this.toDelta().map(e=>{const r=[];for(const i in e.attributes){const a=[];for(const o in e.attributes[i])a.push({key:o,value:e.attributes[i][o]});a.sort((o,s)=>o.key<s.key?-1:1),r.push({nodeName:i,attrs:a})}r.sort((i,a)=>i.nodeName<a.nodeName?-1:1);let n="";for(let i=0;i<r.length;i++){const a=r[i];n+=`<${a.nodeName}`;for(let o=0;o<a.attrs.length;o++){const s=a.attrs[o];n+=` ${s.key}="${s.value}"`}n+=">"}n+=e.insert;for(let i=r.length-1;i>=0;i--)n+=`</${r[i].nodeName}>`;return n}).join("")}toJSON(){return this.toString()}_write(e){e.writeTypeRef(Eue)}}const aue=t=>new _0;class H4{constructor(e,r){this.id=e,this.length=r}get deleted(){throw eo()}mergeWith(e){return!1}write(e,r,n){throw eo()}integrate(e,r){throw eo()}}const oue=0;class Xi extends H4{get deleted(){return!0}delete(){}mergeWith(e){return this.constructor!==e.constructor?!1:(this.length+=e.length,!0)}integrate(e,r){r>0&&(this.id.clock+=r,this.length-=r),B9(e.doc.store,this)}write(e,r){e.writeInfo(oue),e.writeLen(this.length-r)}getMissing(e,r){return null}}class Km{constructor(e){this.content=e}getLength(){return 1}getContent(){return[this.content]}isCountable(){return!0}copy(){return new Km(this.content)}splice(e){throw eo()}mergeWith(e){return!1}integrate(e,r){}delete(e){}gc(e){}write(e,r){e.writeBuf(this.content)}getRef(){return 3}}const sue=t=>new Km(t.readBuf());class Xp{constructor(e){this.len=e}getLength(){return this.len}getContent(){return[]}isCountable(){return!1}copy(){return new Xp(this.len)}splice(e){const r=new Xp(this.len-e);return this.len=e,r}mergeWith(e){return this.len+=e.len,!0}integrate(e,r){m0(e.deleteSet,r.id.client,r.id.clock,this.len),r.markDeleted()}delete(e){}gc(e){}write(e,r){e.writeLen(this.len-r)}getRef(){return 1}}const lue=t=>new Xp(t.readLen()),rj=(t,e)=>new Tf({guid:t,...e,shouldLoad:e.shouldLoad||e.autoLoad||!1});class Hm{constructor(e){e._item&&console.error("This document was already integrated as a sub-document. You should create a second instance instead with the same guid."),this.doc=e;const r={};this.opts=r,e.gc||(r.gc=!1),e.autoLoad&&(r.autoLoad=!0),e.meta!==null&&(r.meta=e.meta)}getLength(){return 1}getContent(){return[this.doc]}isCountable(){return!0}copy(){return new Hm(rj(this.doc.guid,this.opts))}splice(e){throw eo()}mergeWith(e){return!1}integrate(e,r){this.doc._item=r,e.subdocsAdded.add(this.doc),this.doc.shouldLoad&&e.subdocsLoaded.add(this.doc)}delete(e){e.subdocsAdded.has(this.doc)?e.subdocsAdded.delete(this.doc):e.subdocsRemoved.add(this.doc)}gc(e){}write(e,r){e.writeString(this.doc.guid),e.writeAny(this.opts)}getRef(){return 9}}const uue=t=>new Hm(rj(t.readString(),t.readAny()));class Zu{constructor(e){this.embed=e}getLength(){return 1}getContent(){return[this.embed]}isCountable(){return!0}copy(){return new Zu(this.embed)}splice(e){throw eo()}mergeWith(e){return!1}integrate(e,r){}delete(e){}gc(e){}write(e,r){e.writeJSON(this.embed)}getRef(){return 5}}const cue=t=>new Zu(t.readJSON());class Wr{constructor(e,r){this.key=e,this.value=r}getLength(){return 1}getContent(){return[]}isCountable(){return!1}copy(){return new Wr(this.key,this.value)}splice(e){throw eo()}mergeWith(e){return!1}integrate(e,r){const n=r.parent;n._searchMarker=null,n._hasFormatting=!0}delete(e){}gc(e){}write(e,r){e.writeKey(this.key),e.writeJSON(this.value)}getRef(){return 6}}const due=t=>new Wr(t.readKey(),t.readJSON());class S0{constructor(e){this.arr=e}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new S0(this.arr)}splice(e){const r=new S0(this.arr.slice(e));return this.arr=this.arr.slice(0,e),r}mergeWith(e){return this.arr=this.arr.concat(e.arr),!0}integrate(e,r){}delete(e){}gc(e){}write(e,r){const n=this.arr.length;e.writeLen(n-r);for(let i=r;i<n;i++){const a=this.arr[i];e.writeString(a===void 0?"undefined":JSON.stringify(a))}}getRef(){return 2}}const fue=t=>{const e=t.readLen(),r=[];for(let n=0;n<e;n++){const i=t.readString();i==="undefined"?r.push(void 0):r.push(JSON.parse(i))}return new S0(r)},hue=p0("node_env")==="development";class Ou{constructor(e){this.arr=e,hue&&y9(e)}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new Ou(this.arr)}splice(e){const r=new Ou(this.arr.slice(e));return this.arr=this.arr.slice(0,e),r}mergeWith(e){return this.arr=this.arr.concat(e.arr),!0}integrate(e,r){}delete(e){}gc(e){}write(e,r){const n=this.arr.length;e.writeLen(n-r);for(let i=r;i<n;i++){const a=this.arr[i];e.writeAny(a)}}getRef(){return 8}}const pue=t=>{const e=t.readLen(),r=[];for(let n=0;n<e;n++)r.push(t.readAny());return new Ou(r)};class lo{constructor(e){this.str=e}getLength(){return this.str.length}getContent(){return this.str.split("")}isCountable(){return!0}copy(){return new lo(this.str)}splice(e){const r=new lo(this.str.slice(e));this.str=this.str.slice(0,e);const n=this.str.charCodeAt(e-1);return n>=55296&&n<=56319&&(this.str=this.str.slice(0,e-1)+"",r.str=""+r.str.slice(1)),r}mergeWith(e){return this.str+=e.str,!0}integrate(e,r){}delete(e){}gc(e){}write(e,r){e.writeString(r===0?this.str:this.str.slice(r))}getRef(){return 4}}const mue=t=>new lo(t.readString()),vue=[Gle,Zle,eue,rue,tue,iue,aue],gue=0,yue=1,bue=2,_ue=3,Sue=4,wue=5,Eue=6;let Yu=class nj{constructor(e){this.type=e}getLength(){return 1}getContent(){return[this.type]}isCountable(){return!0}copy(){return new nj(this.type._copy())}splice(e){throw eo()}mergeWith(e){return!1}integrate(e,r){this.type._integrate(e.doc,r)}delete(e){let r=this.type._start;for(;r!==null;)r.deleted?r.id.clock<(e.beforeState.get(r.id.client)||0)&&e._mergeStructs.push(r):r.delete(e),r=r.right;this.type._map.forEach(n=>{n.deleted?n.id.clock<(e.beforeState.get(n.id.client)||0)&&e._mergeStructs.push(n):n.delete(e)}),e.changed.delete(this.type)}gc(e){let r=this.type._start;for(;r!==null;)r.gc(e,!0),r=r.right;this.type._start=null,this.type._map.forEach(n=>{for(;n!==null;)n.gc(e,!0),n=n.left}),this.type._map=new Map}write(e,r){this.type._write(e)}getRef(){return 7}};const xue=t=>new Yu(vue[t.readTypeRef()](t)),w0=(t,e,r)=>{const{client:n,clock:i}=e.id,a=new Kr(Et(n,i+r),e,Et(n,i+r-1),e.right,e.rightOrigin,e.parent,e.parentSub,e.content.splice(r));return e.deleted&&a.markDeleted(),e.keep&&(a.keep=!0),e.redone!==null&&(a.redone=Et(e.redone.client,e.redone.clock+r)),e.right=a,a.right!==null&&(a.right.left=a),t._mergeStructs.push(a),a.parentSub!==null&&a.right===null&&a.parent._map.set(a.parentSub,a),e.length=r,a};class Kr extends H4{constructor(e,r,n,i,a,o,s,l){super(e,l.getLength()),this.origin=n,this.left=r,this.right=i,this.rightOrigin=a,this.parent=o,this.parentSub=s,this.redone=null,this.content=l,this.info=this.content.isCountable()?PP:0}set marker(e){(this.info&sw)>0!==e&&(this.info^=sw)}get marker(){return(this.info&sw)>0}get keep(){return(this.info&IP)>0}set keep(e){this.keep!==e&&(this.info^=IP)}get countable(){return(this.info&PP)>0}get deleted(){return(this.info&ow)>0}set deleted(e){this.deleted!==e&&(this.info^=ow)}markDeleted(){this.info|=ow}getMissing(e,r){if(this.origin&&this.origin.client!==this.id.client&&this.origin.clock>=an(r,this.origin.client))return this.origin.client;if(this.rightOrigin&&this.rightOrigin.client!==this.id.client&&this.rightOrigin.clock>=an(r,this.rightOrigin.client))return this.rightOrigin.client;if(this.parent&&this.parent.constructor===yd&&this.id.client!==this.parent.client&&this.parent.clock>=an(r,this.parent.client))return this.parent.client;if(this.origin&&(this.left=WP(e,r,this.origin),this.origin=this.left.lastId),this.rightOrigin&&(this.right=pl(e,this.rightOrigin),this.rightOrigin=this.right.id),this.left&&this.left.constructor===Xi||this.right&&this.right.constructor===Xi)this.parent=null;else if(!this.parent)this.left&&this.left.constructor===Kr?(this.parent=this.left.parent,this.parentSub=this.left.parentSub):this.right&&this.right.constructor===Kr&&(this.parent=this.right.parent,this.parentSub=this.right.parentSub);else if(this.parent.constructor===yd){const n=dw(r,this.parent);n.constructor===Xi?this.parent=null:this.parent=n.content.type}return null}integrate(e,r){if(r>0&&(this.id.clock+=r,this.left=WP(e,e.doc.store,Et(this.id.client,this.id.clock-1)),this.origin=this.left.lastId,this.content=this.content.splice(r),this.length-=r),this.parent){if(!this.left&&(!this.right||this.right.left!==null)||this.left&&this.left.right!==this.right){let n=this.left,i;if(n!==null)i=n.right;else if(this.parentSub!==null)for(i=this.parent._map.get(this.parentSub)||null;i!==null&&i.left!==null;)i=i.left;else i=this.parent._start;const a=new Set,o=new Set;for(;i!==null&&i!==this.right;){if(o.add(i),a.add(i),lg(this.origin,i.origin)){if(i.id.client<this.id.client)n=i,a.clear();else if(lg(this.rightOrigin,i.rightOrigin))break}else if(i.origin!==null&&o.has(dw(e.doc.store,i.origin)))a.has(dw(e.doc.store,i.origin))||(n=i,a.clear());else break;i=i.right}this.left=n}if(this.left!==null){const n=this.left.right;this.right=n,this.left.right=this}else{let n;if(this.parentSub!==null)for(n=this.parent._map.get(this.parentSub)||null;n!==null&&n.left!==null;)n=n.left;else n=this.parent._start,this.parent._start=this;this.right=n}this.right!==null?this.right.left=this:this.parentSub!==null&&(this.parent._map.set(this.parentSub,this),this.left!==null&&this.left.delete(e)),this.parentSub===null&&this.countable&&!this.deleted&&(this.parent._length+=this.length),B9(e.doc.store,this),this.content.integrate(e,this),qP(e,this.parent,this.parentSub),(this.parent._item!==null&&this.parent._item.deleted||this.parentSub!==null&&this.right!==null)&&this.delete(e)}else new Xi(this.id,this.length).integrate(e,0)}get next(){let e=this.right;for(;e!==null&&e.deleted;)e=e.right;return e}get prev(){let e=this.left;for(;e!==null&&e.deleted;)e=e.left;return e}get lastId(){return this.length===1?this.id:Et(this.id.client,this.id.clock+this.length-1)}mergeWith(e){if(this.constructor===e.constructor&&lg(e.origin,this.lastId)&&this.right===e&&lg(this.rightOrigin,e.rightOrigin)&&this.id.client===e.id.client&&this.id.clock+this.length===e.id.clock&&this.deleted===e.deleted&&this.redone===null&&e.redone===null&&this.content.constructor===e.content.constructor&&this.content.mergeWith(e.content)){const r=this.parent._searchMarker;return r&&r.forEach(n=>{n.p===e&&(n.p=this,!this.deleted&&this.countable&&(n.index-=this.length))}),e.keep&&(this.keep=!0),this.right=e.right,this.right!==null&&(this.right.left=this),this.length+=e.length,!0}return!1}delete(e){if(!this.deleted){const r=this.parent;this.countable&&this.parentSub===null&&(r._length-=this.length),this.markDeleted(),m0(e.deleteSet,this.id.client,this.id.clock,this.length),qP(e,r,this.parentSub),this.content.delete(e)}}gc(e,r){if(!this.deleted)throw oo();this.content.gc(e),r?Mle(e,this,new Xi(this.id,this.length)):this.content=new Xp(this.length)}write(e,r){const n=r>0?Et(this.id.client,this.id.clock+r-1):this.origin,i=this.rightOrigin,a=this.parentSub,o=this.content.getRef()&Ob|(n===null?0:Ti)|(i===null?0:Go)|(a===null?0:Hp);if(e.writeInfo(o),n!==null&&e.writeLeftID(n),i!==null&&e.writeRightID(i),n===null&&i===null){const s=this.parent;if(s._item!==void 0){const l=s._item;if(l===null){const c=Dle(s);e.writeParentInfo(!0),e.writeString(c)}else e.writeParentInfo(!1),e.writeLeftID(l.id)}else s.constructor===String?(e.writeParentInfo(!0),e.writeString(s)):s.constructor===yd?(e.writeParentInfo(!1),e.writeLeftID(s)):oo();a!==null&&e.writeString(a)}this.content.write(e,r)}}const ij=(t,e)=>Cue[e&Ob](t),Cue=[()=>{oo()},lue,fue,sue,mue,cue,due,xue,pue,uue,()=>{oo()}],Tue=10;class Qi extends H4{get deleted(){return!0}delete(){}mergeWith(e){return this.constructor!==e.constructor?!1:(this.length+=e.length,!0)}integrate(e,r){oo()}write(e,r){e.writeInfo(Tue),Rt(e.restEncoder,this.length-r)}getMissing(e,r){return null}}const aj=typeof globalThis<"u"?globalThis:typeof window<"u"||typeof window<"u"?window:{},oj="__ $YJS$ __";aj[oj]===!0&&console.error("Yjs was already imported. This breaks constructor checks and will lead to issues! - https://github.com/yjs/yjs/issues/438");aj[oj]=!0;function Due(t){const e=D.useRef(null);return D.useSyncExternalStore(r=>(t.observeDeep(r),()=>t.unobserveDeep(r)),()=>{const r=t.toJSON();return qg(e.current,r)||(e.current=r),e.current},()=>t.toJSON())}const Ju=t=>qd((e,r)=>{t.onerror=n=>r(new Error(n.target.error)),t.onsuccess=n=>e(n.target.result)}),Rue=(t,e)=>qd((r,n)=>{const i=indexedDB.open(t);i.onupgradeneeded=a=>e(a.target.result),i.onerror=a=>n(ts(a.target.error)),i.onsuccess=a=>{const o=a.target.result;o.onversionchange=()=>{o.close()},r(o)}}),Mue=t=>Ju(indexedDB.deleteDatabase(t)),Iue=(t,e)=>e.forEach(r=>t.createObjectStore.apply(t,r)),Lh=(t,e,r="readwrite")=>{const n=t.transaction(e,r);return e.map(i=>Nue(n,i))},sj=(t,e)=>Ju(t.count(e)),Pue=(t,e)=>Ju(t.get(e)),lj=(t,e)=>Ju(t.delete(e)),Aue=(t,e,r)=>Ju(t.put(e,r)),tx=(t,e)=>Ju(t.add(e)),kue=(t,e,r)=>Ju(t.getAll(e,r)),Oue=(t,e,r)=>{let n=null;return Bue(t,e,i=>(n=i,!1),r).then(()=>n)},$ue=(t,e=null)=>Oue(t,e,"prev"),Lue=(t,e)=>qd((r,n)=>{t.onerror=n,t.onsuccess=async i=>{const a=i.target.result;if(a===null||await e(a)===!1)return r();a.continue()}}),Bue=(t,e,r,n="next")=>Lue(t.openKeyCursor(e,n),i=>r(i.key)),Nue=(t,e)=>t.objectStore(e),Uue=(t,e)=>IDBKeyRange.upperBound(t,e),Fue=(t,e)=>IDBKeyRange.lowerBound(t,e),pw="custom",uj="updates",cj=500,dj=(t,e=()=>{},r=()=>{})=>{const[n]=Lh(t.db,[uj]);return kue(n,Fue(t._dbref,!1)).then(i=>{t._destroyed||(e(n),Wt(t.doc,()=>{i.forEach(a=>wle(t.doc,a))},t,!1),r(n))}).then(()=>$ue(n).then(i=>{t._dbref=i+1})).then(()=>sj(n).then(i=>{t._dbsize=i})).then(()=>n)},jue=(t,e=!0)=>dj(t).then(r=>{(e||t._dbsize>=cj)&&tx(r,k9(t.doc)).then(()=>lj(r,Uue(t._dbref,!0))).then(()=>sj(r).then(n=>{t._dbsize=n}))});class Vue extends nse{constructor(e,r){super(),this.doc=r,this.name=e,this._dbref=0,this._dbsize=0,this._destroyed=!1,this.db=null,this.synced=!1,this._db=Rue(e,n=>Iue(n,[["updates",{autoIncrement:!0}],["custom"]])),this.whenSynced=qd(n=>this.on("synced",()=>n(this))),this._db.then(n=>{this.db=n,dj(this,o=>tx(o,k9(r)),()=>{if(this._destroyed)return this;this.synced=!0,this.emit("synced",[this])})}),this._storeTimeout=1e3,this._storeTimeoutId=null,this._storeUpdate=(n,i)=>{if(this.db&&i!==this){const[a]=Lh(this.db,[uj]);tx(a,n),++this._dbsize>=cj&&(this._storeTimeoutId!==null&&clearTimeout(this._storeTimeoutId),this._storeTimeoutId=setTimeout(()=>{jue(this,!1),this._storeTimeoutId=null},this._storeTimeout))}},r.on("update",this._storeUpdate),this.destroy=this.destroy.bind(this),r.on("destroy",this.destroy)}destroy(){return this._storeTimeoutId&&clearTimeout(this._storeTimeoutId),this.doc.off("update",this._storeUpdate),this.doc.off("destroy",this.destroy),this._destroyed=!0,this._db.then(e=>{e.close()})}clearData(){return this.destroy().then(()=>{Mue(this.name)})}get(e){return this._db.then(r=>{const[n]=Lh(r,[pw],"readonly");return Pue(n,e)})}set(e,r){return this._db.then(n=>{const[i]=Lh(n,[pw]);return Aue(i,r,e)})}del(e){return this._db.then(r=>{const[n]=Lh(r,[pw]);return lj(n,e)})}}function zue(t){const e=JSON.stringify(t);return navigator.clipboard.writeText(e).then(()=>(Sa({title:"Export successful",description:"Notes exported to the clipboard.",severity:"success"}),!0),r=>(Sa({title:"Export failed",description:"Notes couldn't be exported to the clipboard. ("+r+")",severity:"danger"}),console.log(r),!1))}function Kue(t,e){return navigator.clipboard.readText().then(r=>{try{const n=JSON.parse(r);return t.current.transact(()=>{t.current.getArray(e).delete(0,t.current.getArray(e).length),t.current.getArray(e).insert(0,n)}),Sa({title:"Import successful",description:"Notes imported from the clipboard.",severity:"success"}),!0}catch(n){return Sa({title:"Import failed",description:"Notes couldn't be imported from the clipboard. ("+n+")",severity:"danger"}),!1}},r=>(Sa({title:"Import failed",description:"Notes couldn't be imported from the clipboard. ("+r+")",severity:"danger"}),console.log(r),!1))}function QP(t,e,r,n,i,a,o){try{var s=t[a](o),l=s.value}catch(c){return void r(c)}s.done?e(l):Promise.resolve(l).then(n,i)}function K(t){return function(){var e=this,r=arguments;return new Promise(function(n,i){var a=t.apply(e,r);function o(l){QP(a,n,i,o,s,"next",l)}function s(l){QP(a,n,i,o,s,"throw",l)}o(void 0)})}}function Qp(t){"@babel/helpers - typeof";return Qp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Qp(t)}function Hue(t,e){if(Qp(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(Qp(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Wue(t){var e=Hue(t,"string");return Qp(e)=="symbol"?e:e+""}function E(t,e,r){return(e=Wue(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}const Gue="l",que="rn",Zue={0:"O",1:"l","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:"",:"",:"","":"","":"",:"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","\u2028":" ","\u2029":" ","":" ","":" ","":" ","":" ","":" ","":" ","":" ","":" ","":" ","":" ","":" ","":" ","":" ","":" ","":" ","":"_","":"_","":"_","":"_","":"-","":"-","":"-","":"-","":"-","":"-","":"-","":"-","":"-","":"-","":"-","":"-","":"-","":"-","":"-","":"-","":"-.","":"","":",","":",","":",","":",","":",","":"","":"","":";","":"","":":","":":","":":","":":","":":","":":","":":","":":","":":","":":","":":","":":","":":","":":","":":",:":","":":","":"::=","":":","":"!",:"!","":"!","":"!!","":"!?",:"?","":"?","":"?",:"?","":"?","":"?!","":"??","":"","":".","":".","":".","":".","":".","":".","":".","":".","":".","":".,","":"..","":"..","":"...","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"","":"",:"<","":">",:">",:">",:"4",:"b",:"b",:"d",:"J",:"L",:"P",:"U",:"V",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"","":"","":"","":"","":"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"","":"","":"","":"","":"","":"","":"",:"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"'","":"'","":"'","":"'","":"'","":"'","":"'","":"'","":"'","`":"'","":"'","":"'","":"'","":"'","":"'","":"'","":"'","":"'","":"'","":"'","":"'","":"'","":"'","":"'",:"'",:"'",:"'",:"'","":"'",:"'","":"'","":"'",:"'",:"'","":"'","":"'","":"''",'"':"''","":"''","":"''","":"''","":"''","":"''","":"''","":"''","":"''","":"''","":"''","":"''",:"''",:"''","":"'''","":"'''","":"''''",:"'B",:"'D",:"'n",:"'P",:"'T",:"'Y","":"(","":"(","":"(","":"(","":"(","":"((","":"()","":"(2)","":"(2O)","":"(3)","":"(4)","":"(5)","":"(6)","":"(7)","":"(8)","":"(9)","":"(a)","":"(A)","":"(b)","":"(B)","":"(c)","":"(C)","":"(d)","":"(D)","":"(e)","":"(E)","":"(f)","":"(F)","":"(g)","":"(G)","":"(h)","":"(H)","":"(i)","":"(j)","":"(J)","":"(k)","":"(K)","":"(l)","":"(l)","":"(l)","":"(L)","":"(l2)","":"(l3)","":"(l4)","":"(l5)","":"(l6)","":"(l7)","":"(l8)","":"(l9)","":"(ll)","":"(lO)","":"(M)","":"(n)","":"(N)","":"(o)","":"(O)","":"(p)","":"(P)","":"(q)","":"(Q)","":"(r)","":"(R)","":"(rn)","":"(s)","":"(S)","":"(S)","":"(t)","":"(T)","":"(u)","":"(U)","":"(v)","":"(V)","":"(w)","":"(W)","":"(x)","":"(X)","":"(y)","":"(Y)","":"(z)","":"(Z)","":"()","":"()","":"()","":"()","":"()","":"()","":"()","":"()","":"()","":"()","":"()","":"()","":"()","":"()","":"()","":"()","":"()","":"()","":"()","":"()","":"()","":"()","":"()","":"()","":"()","":"()","":"()","":"()","":"()","":"()","":"()","":"()","":"()","":"()","":"()","":"()","":"()","":"()","":"()","":"()","":"()","":"()","":"()","":"()","":"()","":"()","":"()","":"()","":"()","":"()","":"()","":"()","":"()","":"()","":"()","":"()","":"()","":"()","":"()","":"()","":"()","":"()","":"()","":"()","":"()","":"()","":"()","":"()","":"()","":"()","":"()","":"()","":"()","":"()","":"()","":")","":")","":")","":")","":")","":"))","":"{","":"{","":"}","":"","":"","":"","":"","":"","":"",:"","":"","":"","":"","":"","":"","":"","":"*","":"*","":"*","":"*","":"/","":"/","":"/","":"/","":"/","":"/","":"/","":"/","":"/",:"/","":"/",:"/",:"/","":"/","":"/","":"//","":"///","":"\\","":"\\","":"\\","":"\\","":"\\","":"\\","":"\\","":"\\","":"\\",:"\\","":"\\","":"\\\\","":"\\\\","":"\\","":"&","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"^","":"^","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"b","":"bi","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"C","":"F","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"+","":"+","":"+","":"+","":"+","":"+","":"+","":"+","":"+","":"+","":"","":"<","":"<","":"<","":"<",:"<",:"<","":"<","":"<",:"<","":"<<","":"<<<","":"=","":"=","":"=","":"=","":"=","":"=","":"=","":"=","":"=","":"=","":"==","":"===","":"=","":">","":">","":">","":">",:">","":">",:">","":"><","":">>","":">>","":">>>","":"~","":"~","":"~","":"~","":"~","":"~","":"~","":"~","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"",:"",:"","":"",:"","":"","":"","":"","":"",:"",:"",:"",:"","":"$","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"2","":"2","":"2","":"2","":"2","":"2","":"2",:"2",:"2","":"2",:"2","":"2","":"","":"","":"","":"","":"","":"",:"2","":"2,","":"2.","":"22","":"22","":"23","":"23","":"24","":"24","":"25","":"26","":"27","":"28","":"29","":"2l","":"2l","":"2O.","":"2O","":"2O","":"","":"","":"2","":"2","":"2","":"3","":"3","":"3","":"3","":"3","":"3","":"3","":"3",:"3",:"3","":"3","":"3",:"3",:"3","":"3","":"3","":"","":"","":"","":"",:"3","":"3,","":"3.","":"3l","":"3O","":"3","":"3","":"3","":"4","":"4","":"4","":"4","":"4","":"4",:"4","":"4","":"","":"","":"","":"4,","":"4.",:"4","":"4","":"4","":"4","":"5","":"5","":"5","":"5","":"5","":"5",:"5","":"5","":"","":"5,","":"5.","":"5","":"5","":"5","":"6","":"6","":"6","":"6","":"6","":"6","":"6",:"6",:"6","":"6","":"","":"","":"","":"6,","":"6.","":"6","":"6","":"6","":"7","":"7","":"7","":"7","":"7","":"7","":"7","":"7","":"7","":"","":"7,","":"7.","":"7","":"7","":"7","":"8","":"8","":"8","":"8","":"8","":"8","":"8","":"8","":"8","":"8",:"8",:"8","":"8","":"","":"","":"8,","":"8.","":"8","":"8","":"8","":"9","":"9","":"9","":"9","":"9","":"9","":"9","":"9","":"9","":"9","":"9","":"9","":"9","":"9","":"9","":"","":"","":"","":"","":"","":"9,","":"9.","":"9","":"9","":"9","":"a",:"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a",:"a",:"a","":"a","":"a","":"a","":"a","":"a",:"a","":"",:"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A",:"A","":"A","":"A","":"A","":"A","":"A",:"A",:"A",:"A","":"A","":"A","":"A","":"a",:"",:"",:"",:"",:"","":"a/c","":"a/s","":"aa","":"AA",:"ae",:"ae",:"AE",:"AE","":"ao","":"AO","":"AR","":"au","":"AU","":"av","":"av","":"AV","":"AV","":"ay","":"AY","":"","":"","":"",:"","":"","":"","":"b","":"b","":"b","":"b","":"b","":"b","":"b","":"b","":"b","":"b","":"b","":"b","":"b",:"b",:"b",:"b",:"b",:"b",:"B",:"B","":"B","":"B","":"B","":"B","":"B","":"B","":"B","":"B","":"B","":"B","":"B","":"B","":"B",:"B","":"B","":"B","":"B","":"B","":"B",:"B",:"B",:"B","":"B","":"B","":"B","":"B",:"b",:"b",:"b",:"b",:"b",:"b",:"b",:"b",:"b",:"b",:"b",:"b",:"b'",:"bl",:"","":"",:"c","":"c","":"c","":"c","":"c","":"c","":"c","":"c","":"c","":"c","":"c","":"c","":"c","":"c","":"c","":"c",:"c","":"c",:"c","":"c","":"c","":"","":"C","":"C","":"C",:"C","":"C",:"C",:"C","":"C","":"C","":"C","":"C","":"C","":"C","":"C","":"C","":"C","":"C","":"C","":"C","":"C",:"C",:"C","":"C","":"C","":"C","":"C","":"C","":"c","":"c","":"C","":"C",:"c",:"c",:"C",:"C",:"C'","":"c/o","":"c/u","":"	","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"","":"","":"","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d",:"d",:"d","":"d","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"D",:"D",:"D",:"D","":"D",:"d",:"d",:"d",:"d",:"D",:"D",:"D","":"d","":"",:"d",:"d'",:"d",:"dz",:"dz",:"Dz",:"DZ",:"d",:"D",:"D",:"d","":"","":"",:"","":"","":"","":"","":"","":"",:"",:"","":"e",:"e",:"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e",:"e",:"e","":"","":"E",:"E",:"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E",:"E","":"E","":"E","":"E","":"E","":"E",:"E","":"E",:"E","":"E","":"E","":"E","":"E",:"",:"","":"e","":"E",:"e","":"",:"",:"","":"","":"","":"",:"","":"o","":"o","":"o",:"","":"",:"","":"",:"","":"","":"","":"","":"",:"",:"","":"","":"","":"","":"f","":"f","":"f","":"f","":"f","":"f","":"f","":"f","":"f","":"f","":"f","":"f","":"f","":"f","":"f",:"f","":"f",:"f","":"F",:"F","":"F","":"F","":"F","":"F","":"F","":"F","":"F","":"F","":"F","":"F","":"F","":"F","":"F",:"F","":"F",:"F","":"F","":"F","":"F","":"F","":"F","":"F",:"f",:"F","":"f","":"FAX",:"ff",:"ffi",:"ffl",:"fi",:"fl",:"f",:"","":"","":"",:"",:"g",:"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g",:"g","":"g",:"g",:"g","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G",:"G",:"G","":"G","":"",:"g",:"",:"",:"",:"g",:"G",:"G'","":"","":"","":"",:"h",:"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h",:"h",:"h",:"h",:"H",:"H",:"H",:"H","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"H",:"H","":"H","":"H","":"H","":"H","":"H","":"H",:"H",:"H",:"H","":"H","":"H","":"",:"h","":"h",:"h","":"H",:"H",:"h",:"h",:"h",:"H","":"H",:"H",:"","":"",:"","":"",:"","":"","":"","":"",:"",:"","":"","":"","":"i","":"i",:"i","":"i",:"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i",:"i","":"i",:"i",:"i",:"i",:"i",:"i","":"i","":"i","":"i","":"i","":"i",:"i","":"i","":"i","":"i",:"i","":"i","":"","":"i",:"",:"",:"i","":"i","":"i","":"ii","":"iii",:"ij","":"iv","":"ix",:"j","":"j","":"j","":"j","":"j","":"j","":"j","":"j","":"j","":"j","":"j","":"j","":"j","":"j","":"j",:"j",:"j",:"J","":"J","":"J","":"J","":"J","":"J","":"J","":"J","":"J","":"J","":"J","":"J","":"J","":"J","":"J","":"J",:"J",:"J",:"J","":"J","":"j","":"J",:"J","":"",:"","":"","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"k",:"K",:"K","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"K",:"K","":"K","":"K","":"K","":"K","":"K","":"K",:"K",:"K",:"K","":"K","":"K",:"k","":"K",:"K","":"K","":"K",:"K",:"K'","":"l","|":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l",I:Gue,:"l","":"l",:"l",:"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l",:"l",:"l","":"l",:"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l",:"l",:"l","":"l","":"l","":"l","":"l","":"l","":"l",:"l",:"l",:"l",:"l",:"l","":"l","":"l",:"l",:"l","":"l","":"l",:"l","":"l","":"l","":"l","":"l","":"L","":"L",:"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L",:"L",:"L","":"L","":"L","":"L","":"L","":"L","":"L",:"l",:"l",:"l",:"L",:"l",:"l",:"l",:"l",:"l",:"l",:"l",:"l",:"l",:"l",:"l","":"l,","":"l.",:"l'","":"l2.","":"l2","":"l2","":"l2","":"l3.","":"l3","":"l3","":"l4.","":"l4","":"l4","":"l5.","":"l5","":"l5","":"l6.","":"l6","":"l6","":"l7.","":"l7","":"l7","":"l8.","":"l8","":"l8","":"l9.","":"l9","":"l9",:"lj",:"lJ",:"Lj",:"LJ","":"ll","":"ll","":"ll",:"ll",:"ll","":"ll","":"ll.","":"lll","":"llS","":"ll","":"ll","":"ll",:"lO","":"lO.","":"lO","":"lO","":"lO",:"ls","":"lt","":"lV","":"lX",:"l",:"lz",:"l",:"l",:"l",:"l",:"l",:"l",:"lo","":"l","":"l","":"l","":"","":"","":"",:"M","":"M",:"M","":"M","":"M","":"M","":"M","":"M","":"M","":"M","":"M","":"M","":"M","":"M","":"M",:"M","":"M","":"M","":"M","":"M","":"M","":"M","":"M",:"M",:"M",:"M",:"M","":"M","":"M","":"M","":"M","":"MB","":"","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n",:"n",:"n",:"N",:"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N",:"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N",:"n",:"n",:"n","":"n","":"n","":"n","":"n","":"n",:"N","":"n",:"nj",:"Nj",:"NJ","":"No","":"",:"","":"",:"","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o",:"o",:"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o",:"o","":"o","":"o","":"o","":"o","":"o",:"o","":"o","":"o","":"o","":"o","":"o","":"o",:"o","":"o",:"o",:"o",:"o","":"o","":"o","":"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o","":"o","":"o","":"o","":"o","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O",:"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O",:"O","":"O","":"O","":"O","":"O","":"O","":"O",:"O",:"O","":"O",:"O",:"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"","":"",:"",:"","":"o",:"",:"o","":"o",:"O","":"O",:"O",:"o","":"o",:"o",:"o","":"o","":"o","":"O","":"O","":"O","":"O","":"O",:"O","":"O",:"O",:"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O",:"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O",:"O",:"O","":"O",:"O",:"O","":"o",:"o","":"O,","":"O.",:"o'",:"O'",:"O'","%":"/","":"/","":"/","":"/","":"/","":"/","":"/",:"oe",:"OE",:"o","":"oo","":"oo","":"oo","":"OO","":"OO",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o","":"oo",:"o","":"O","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"e","":"","":"p",:"p","":"p","":"p","":"p","":"p","":"p","":"p","":"p","":"p","":"p","":"p","":"p","":"p","":"p",:"p",:"p","":"p","":"p","":"p","":"p","":"p","":"p","":"p","":"p","":"p","":"p","":"p",:"p",:"P",:"P","":"P","":"P","":"P","":"P","":"P","":"P","":"P","":"P","":"P","":"P","":"P","":"P",:"P","":"P","":"P","":"P","":"P","":"P","":"P",:"P",:"P",:"P","":"P","":"P",:"p","":"p",:"p",:"P'","":"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"q","":"q","":"q","":"q","":"q","":"q","":"q","":"q","":"q","":"q","":"q","":"q","":"q","":"q",:"q",:"q",:"Q","":"Q","":"Q","":"Q","":"Q","":"Q","":"Q","":"Q","":"Q","":"Q","":"Q","":"Q","":"Q","":"Q",:"q","":"QE","":"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r",:"r","":"r","":"R",:"R",:"R",:"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R",:"R",:"R",:"R","":"R",:"R","":"R","":"R",:"r",:"r","":"r",:"r","":"r",:"r'","":"rn",m:que,"":"rn","":"rn","":"rn","":"rn","":"rn","":"rn","":"rn","":"rn","":"rn","":"rn","":"rn","":"rn","":"rn","":"rn","":"rn","":"rn",:"rn","":"rn","":"Rs","":"","":"",:"","":"","":"",:"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s",:"s",:"s","":"s","":"s","":"s",:"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S",:"S",:"S",:"S",:"S","":"S","":"S","":"S","":"S",:"s","":"s","":"",:"",:"","":"","":"","":"","":"","":"",:"","":"sss",:"st","":"","":"","":"","":"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"T","":"T","":"T",:"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T",:"T","":"T","":"T","":"T","":"T","":"T","":"T",:"T",:"T","":"T","":"T","":"T","":"T","":"T","":"T",:"t","":"T","":"T",:"",:"T",:"T","":"T",:"t",:"T","":"t",:"","":"T3",:"t","":"TEL","":"tf",:"ts",:"t","":"t",:"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:"",:"","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u",:"u",:"u","":"u","":"u","":"u","":"u","":"u",:"u","":"u","":"u","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U",:"U",:"U","":"U",:"U","":"U","":"U","":"U",:"",:"","":"u","":"u","":"U",:"U",:"U",:"U'","":"ue","":"uo",:"",:"",:"","":"",:"",:"","":"","":"v","":"v",:"v","":"v","":"v","":"v","":"v","":"v","":"v","":"v","":"v","":"v","":"v","":"v","":"v","":"v","":"v","":"v",:"v","":"v","":"v","":"v","":"v","":"v",:"v",:"v","":"v","":"v","":"v","":"V","":"V","":"V","":"V","":"V","":"V","":"V","":"V","":"V","":"V","":"V","":"V","":"V","":"V","":"V","":"V","":"V",:"V","":"V",:"V",:"V","":"V","":"V","":"V","":"V","":"V","":"V",:"V","":"VB","":"vi","":"vii","":"viii","":"Vl","":"Vll","":"Vlll","":"V","":"","":"","":"","":"",:"","":"","":"","":"","":"","":"",:"","":"","":"",:"","":"","":"","":"","":"","":"",:"",:"w","":"w","":"w","":"w","":"w","":"w","":"w","":"w","":"w","":"w","":"w","":"w","":"w","":"w","":"w",:"w","":"w",:"w","":"w","":"w","":"w","":"w","":"W","":"W","":"W","":"W","":"W","":"W","":"W","":"W","":"W","":"W","":"W","":"W","":"W","":"W","":"W","":"W",:"W",:"W","":"W",:"w","":"w","":"W","":"w","":"",:"","":"","":"","":"x","":"x","":"x","":"x","":"x",:"x","":"x","":"x","":"x","":"x","":"x","":"x","":"x","":"x","":"x","":"x","":"x","":"x","":"x","":"x",:"x",:"x",:"x","":"","":"X","":"X","":"X","":"X",:"X","":"X","":"X","":"X","":"X","":"X","":"X","":"X","":"X","":"X","":"X","":"X","":"X","":"X","":"X","":"X",:"X","":"X","":"X","":"X","":"X","":"X","":"X",:"X","":"X",:"X","":"X","":"X","":"X","":"X","":"X","":"x",:"X","":"X","":"xi","":"xii","":"Xl","":"Xll",:"y","":"y",:"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y",:"y","":"y","":"y",:"y","":"y","":"y","":"y","":"y","":"y","":"y",:"y",:"y",:"y","":"y",:"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y",:"Y",:"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y",:"Y",:"Y",:"Y",:"Y","":"Y","":"Y","":"Y","":"Y",:"y","":"y",:"y","":"Y","":"Y",:"Y",:"","":"","":"",:"",:"","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"Z","":"Z",:"Z",:"Z",:"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z",:"Z","":"Z","":"Z","":"Z","":"Z","":"Z",:"Z","":"Z","":"Z",:"z",:"z",:"Z",:"z",:"Z","":"z",:"","":"","":"","":"","":"","":"",:"","":"",:"","":"",:"i","":"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"",:"",:"","":"",:"",:"",:"'","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"","":"","":"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"","":"","":"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"","":"","":"","":"","":"",:"",:"","":"","":"",:"","":"","":"",:"",:"","":"","":"","":"","":"",:"","":"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"",:"",:"","":"","":"",:"",:"",:"","":"","":"","":"l","":"","":"","":"","":"",:"",:"",:"",:"",:"",:"","":"","":"","":"",:"",:"","":"",:"",:"'",:"","":"","":"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"","":"",:"",:"",:"",:"","":"","":"","":"","":"","":"",:"",:"",:"",:"","":"","":"","":"",:"o",:"o",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"","":"","":"","":"",:"",:"",:"",:"","":"","":"","":"","":"","":"",:"",:"",:"",:"",:"o",:"o",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"","":"","":"","":"","":"","":"","":"",:"",:"",:"",:"",:"",:"",:"",:"",:" lo",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"","":"","":"","":"","":"","":"","":"",:"",:"",:"",:"",:"",:"","":"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"","":"","":"","":"","":"","":"","":"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"","":"","":"","":"","":"",:"",:"",:"",:"",:"",:"",:"",:"","":"","":"","":"","":"","":"",:"",:"",:"",:"",:"",:"",:"",:"","":"","":"","":"",:"",:"",:"",:"",:"",:"",:"",:"",:"","":"","":"","":"",:"",:"","":"l","":"","":"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"",:"",:"",:"",:"",:"","":"","":"","":"","":"","":"","":"",:"",:"",:"",:"","":"",:"o",:"o",:"o",:"o",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"","":"","":"","":"","":"","":"","":"","":"",:"",:"",:"",:"",:"","":"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:" lo o ",:"",:"",:"",:"",:"",:"",:"",:"","":"","":"","":"","":"","":"","":"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"","":"","":"","":"","":"","":"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"","":"","":"","":"","":"",:"",:"",:"",:"",:"",:"",:"","":"","":"","":"","":"","":"","":"","":"",:"",:"",:"",:"",:"",:"",:"",:"",:"o",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"","":"","":"","":"","":"","":"","":"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"","":"","":"","":"","":"","":"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"","":"","":"","":"","":"","":"","":"","":"",:"",:"",:"",:"",:"",:"","":"",:"",:"",:"",:"","":"","":"","":"","":"","":"","":"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"","":"","":"","":"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"","":"",:"l",:"l",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"","":"",:"",:"",:"",:"","":"",:"",:"",:"",:"",:"",:"",:"",:"",:"","":"","":"","":"","":"","":"",:"",:"",:"",:"",:"",:"",:"l",:"l",:"l",:"l",:"l",:"l",:"o",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"","":"","":"","":"","":"","":"",:"",:"",:"",:"","":"","":"",:"l",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"","":"","":"","":"","":"","":"","":"",:"",:"",:"",:"","":"","":"",:"o",:"o",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"","":"","":"","":"","":"",:"",:"","":"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"","":"","":"","":"",:"","":"","":"",:"",:"","":"",:"",:"",:"",:"",:"","":"","":"","":"","":"","":"","":"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"","":"","":"","":"","":"","":"",:"",:"",:"",:"",:"",:"","":"","":"","":"",:"","":"","":"","":"",:"",:"",:"o",:"o",:"o",:"",:"",:"",:"",:"",:"",:"l",:"l",:"o",:"o",:"o",:"o",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"","":"","":"","":"","":"","":"","":"","":"",:"",:"",:"",:"",:"",:"",:"",:"","":"",:"",:"",:"",:"",:"",:"","":"","":"","":"","":"","":"","":"","":"",:"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"","":"",:"","":"","":"","":"",:"",:"",:"","":"","":"",:"",:"","":"","":"","":"","":"","":"",:"","":"","":"","":"",:"","":"","":"",:"","":"","":"","":"","":"","":"","":"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"","":"","":"",:"",:"",:"",:"",:"",:"","":"","":"",:"",:"","":"","":"","":"","":"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"",:"",:"",:"",:"","":"","":"",:"",:"","":"","":"","":"","":"",:"","":"","":"",:"","":"","":"",:"",:"","":"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"","":"",:"",:"",:"",:"","":"",:"",:"","":"","":"",:"",:"'","":"/","":"",:"","":"","":"",:"",:"'",:"",:"",:"'",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"","":"","":"","":"","":"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"<",:"b",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"","":"",:"",:"",:"",:"b",:"b",:"d",:"P",:"",:"",:"",:"",:"",:"","":"","":"",:"","":"","":"",:"J",:"",:"",:"",:"",:"",:"",:"",:"J",:"",:"",:"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"",:"",:"","":"","":"",:"","":"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"",:"",:"",:"",:"","":"","":"",:"","":"",:"",:"",:"","":"","":"","":"",:"",:"",:"",:"",:"",:"","":"",:"",:"",:"","":"",:"","":"",:"",:"","":"",:"",:"","":"",:"","":"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"","":"","":"","":"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"",:"","":"",:"",:"","":"","":"",:"",:"","":"",:"",:"","":"",:"",:"","":"",:"",:"",:"","":"","":"",:"",:"",:"",:"","":"","":"",:"",:"","":"","":"",:"",:"","":"",:"","":"",:"","":"",:"",:"",:"",:"","":"","":"","":"",:"",:"",:"",:"",:"",:"",:"",:"",:"","":"",:"",:"","":"",:"",:"","":"",:"",:"","":"",:"","":"","":"","":"",:"","":"",:"",:"",:"","":"","":"",:"",:"",:"",:"",:"",:"","":"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"","":"",:"","":"","":"",:"",:"","":"",:"",:"",:"",:"",:"",:"",:"",:"",:"","":"",:"",:"",:"","":"",:"",:"",:"",:"",:"","":"",:"","":"","":"",:"",:"",:"",:"","":"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"","":"",:"",:"",:"",:"","":"",:"",:"",:"","":"","":"","":"",:"",:"",:"",:"","":"",:"","":"",:"",:"","":"",:"","":"",:"",:"",:"",:"",:"",:"","":"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"","":"",:"",:"",:"",:"",:"","":"","":"",:"",:"",:"","":"","":"",:"",:"",:"",:"",:"",:"",:"",:"","":"",:"",:"",:"",:"","":"",:"",:"",:"","":"","":"",:"",:"",:"",:"",:"",:"","":"",:"",:"",:"",:"",:"",:"","":"","":"",:"",:"","":"","":"",:"",:"",:"",:"","":"",:"",:"","":"",:"",:"",:"",:"",:"",:"",:"","":"",:"",:"",:"",:"",:"",:"",:"",:"",:"","":"",:"",:"",:"",:"",:"",:"",:"",:"",:"","":"","":"",:"",:"","":"",:"",:"","":"",:"",:"",:"",:"","":"","":"",:"",:"",:"",:"",:"","":"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"","":"",:"",:"",:"",:"","":"",:"",:"","":"",:"",:"",:"",:"",:"",:"","":"",:"",:"",:"",:"","":"",:"","":"",:"",:"",:"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"",:"","":"",:"",:"",:"","":"","":"","":"","":"",:"","":"","":"",:"","":"",:"","":"",:"","":"",:"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"","":"",:"",:"","":"","":"","":"",:"","":"",:"","":"",:"","":"",:"","":"",:"","":"","":"",:"",:"","":"","":"","":"",:"",:"",:"","":"","":"","":"",:"","":"","":"","":"","":"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"",:"","":"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"",:"",:"",:"",:"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"",:"","":"","":"","":"","":"",:"","":"",:"",:"","":"",:"","":"","":"","":"","":"","":"","":"",:"",:"","":"","":"",:"","":"","":"","":"","":"","":"","":"","":"",:"","":"","":"","":"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"","":"","":"","":"",:"","":"","":"","":"","":"","":"","":"","":"",:"","":"","":"","":"","":"",:"","":"",:"","":"",:"","":"","":"","":"",:"",:"","":"",:"","":"","":"","":"","":"",:"",:"","":"","":"","":"",:"","":"","":"","":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"","":"","":"","":"","":"","":"","":"",:"","":"","":"","":"",:"","":"","":"","":"",:"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:"","":"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"",:"","":"","":"","":"","":"","":"",:"",:"","":"","":"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"","":"","":"",:"",:"","":"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"","":"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"","":"","":"","":"","":"",:"","":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"","":"","":"","":"",:"","":"","":"","":"","":"",:"","":"",:"","":"",:"","":"",:"","":"","":"","":"","":"","":"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"","":"","":"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"","":"","":"","":"",:"","":"","":"",:"","":"","":"","":"","":"",:"",:"",:"","":"","":"",:"","":"","":"","":"","":"",:"","":"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"",:"","":"",:"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"","":"","":"","":"",:"","":"","":"",:"","":"","":"","":"","":"","":"",:"",:"","":"","":"",:"",:"","":"","":"","":"",:"","":"","":"",:"",:"","":"","":"","":"",:"","":"","":"","":"",:"",:"",:"",:"",:"",:"","":"","":"",:"","":"","":"",:"",:"","":"",:"","":"","":"",:"","":"","":"","":"","":"",:"",:"","":"",:"","":"","":"",:"","":"",:"","":"","":"","":"",:"","":"","":"","":"",:"","":"","":"","":"","":"",:"",:"","":"","":"",:"",:"",:"",:"","":"","":"",:"","":"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"","":"","":"","":"",:"","":"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"","":"",:"","":"",:"",:"","":"","":"",:"","":"","":"","":"","":"",:"","":"","":"","":"","":"","":"",:"",:"",:"","":"","":"","":"","":"",:"","":"","":"",:"",:"","":"",:"","":"","":"",:"","":"","":"",:"","":"","":"","":"","":"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"",:"","":"","":"",:"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"",:"","":"","":"",:"",:"","":"","":"","":"","":"",:"","":"","":"",:"",:"",:"","":"","":"","":"",:"","":"","":"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"",:"",:"","":"","":"","":"","":"",:"","":"","":"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"",:"","":"","":"",:"","":"",:"","":"","":"",:"","":"","":"","":"","":"","":"","":"","":"","":"",:"",:"","":"","":"",:"","":"","":"","":"",:"","":"","":"",:"","":"","":"",:"","":"","":"",:"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"",:"","":"","":"",:"",:"","":"",:"","":"","":"","":"",:"","":"","":"","":"","":"",:"",:"",:"",:"","":"","":"",:"",:"","":"",:"","":"","":"","":"","":"","":"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"","":"","":"","":"",:"",:"","":"","":"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"","":"",:"","":"",:"","":"","":"","":"",:"","":"","":"","":"","":"",:"","":"","":"","":"","":"","":"","":"",:"",:"","":"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"","":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"","":"","":"","":"","":"",:"","":"","":"","":"","":"",:"",:"",:"","":"","":"",:"","":"","":"",:"","":"","":"","":"","":"",:"","":"","":"","":"",:"",:"","":"",:"",:"","":"",:"",:"","":"","":"","":"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"","":"",:"","":"",:"","":"","":"","":"","":"","":"",:"","":"",:"","":"","":"",:"",:"","":"","":"","":"","":"",:"","":"","":"","":"","":"",:"","":"","":"","":"","":"","":"","":"",:"",:"","":"","":"","":"",:"",:"","":"","":"",:"",:"","":"","":"",:"","":"",:"","":"","":"","":"","":"","":"",:"",:"",:"","":"","":"","":"","":"","":"",:"","":"","":"",:"","":"","":"","":"","":"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"","":"","":"","":"","":"",:"",:"","":"",:"","":"",:"","":"","":"",:"",:"",:"","":"","":"",:"",:"","":"","":"","":"",:"","":"","":"","":"","":"","":"","":"",:"",:"","":"","":"",:"","":"","":"",:"","":"","":"",:"",:"","":"","":"",:"","":"","":"","":"","":"",:"","":"",:"","":"",:"","":"",:"",:"","":"",:"","":"","":"","":"","":"","":"",:"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"","":"","":"","":"","":"","":"",:"",:"",:"",:"",:"","":"",:"",:"","":"","":"","":"",:"",:"","":"","":"",:"","":"","":"","":"",:"",:"","":"","":"",:"",:"","":"","":"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"","":"","":"","":"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"",:"","":"",:"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"","":"","":"","":"","":"","":"","":"","":"",:"","":"","":"",:"","":"",:"",:"","":"",:"","":"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"","":"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"","":"","":"",:"",:"","":"","":"","":"","":""};var fj=Zue;function Yue(t){return t.replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")}var Jue=RegExp(Object.keys(fj).map(Yue).join("|"),"g");function Xue(t){return fj[t]}function Que(t){return t.replace(Jue,Xue)}var ece=Que;const tce=Uu(ece);var jb={exports:{}},hj={};function sa(t,e){typeof e=="boolean"&&(e={forever:e}),this._originalTimeouts=JSON.parse(JSON.stringify(t)),this._timeouts=t,this._options=e||{},this._maxRetryTime=e&&e.maxRetryTime||1/0,this._fn=null,this._errors=[],this._attempts=1,this._operationTimeout=null,this._operationTimeoutCb=null,this._timeout=null,this._operationStart=null,this._timer=null,this._options.forever&&(this._cachedTimeouts=this._timeouts.slice(0))}var rce=sa;sa.prototype.reset=function(){this._attempts=1,this._timeouts=this._originalTimeouts.slice(0)};sa.prototype.stop=function(){this._timeout&&clearTimeout(this._timeout),this._timer&&clearTimeout(this._timer),this._timeouts=[],this._cachedTimeouts=null};sa.prototype.retry=function(t){if(this._timeout&&clearTimeout(this._timeout),!t)return!1;var e=new Date().getTime();if(t&&e-this._operationStart>=this._maxRetryTime)return this._errors.push(t),this._errors.unshift(new Error("RetryOperation timeout occurred")),!1;this._errors.push(t);var r=this._timeouts.shift();if(r===void 0)if(this._cachedTimeouts)this._errors.splice(0,this._errors.length-1),r=this._cachedTimeouts.slice(-1);else return!1;var n=this;return this._timer=setTimeout(function(){n._attempts++,n._operationTimeoutCb&&(n._timeout=setTimeout(function(){n._operationTimeoutCb(n._attempts)},n._operationTimeout),n._options.unref&&n._timeout.unref()),n._fn(n._attempts)},r),this._options.unref&&this._timer.unref(),!0};sa.prototype.attempt=function(t,e){this._fn=t,e&&(e.timeout&&(this._operationTimeout=e.timeout),e.cb&&(this._operationTimeoutCb=e.cb));var r=this;this._operationTimeoutCb&&(this._timeout=setTimeout(function(){r._operationTimeoutCb()},r._operationTimeout)),this._operationStart=new Date().getTime(),this._fn(this._attempts)};sa.prototype.try=function(t){console.log("Using RetryOperation.try() is deprecated"),this.attempt(t)};sa.prototype.start=function(t){console.log("Using RetryOperation.start() is deprecated"),this.attempt(t)};sa.prototype.start=sa.prototype.try;sa.prototype.errors=function(){return this._errors};sa.prototype.attempts=function(){return this._attempts};sa.prototype.mainError=function(){if(this._errors.length===0)return null;for(var t={},e=null,r=0,n=0;n<this._errors.length;n++){var i=this._errors[n],a=i.message,o=(t[a]||0)+1;t[a]=o,o>=r&&(e=i,r=o)}return e};(function(t){var e=rce;t.operation=function(r){var n=t.timeouts(r);return new e(n,{forever:r&&(r.forever||r.retries===1/0),unref:r&&r.unref,maxRetryTime:r&&r.maxRetryTime})},t.timeouts=function(r){if(r instanceof Array)return[].concat(r);var n={retries:10,factor:2,minTimeout:1*1e3,maxTimeout:1/0,randomize:!1};for(var i in r)n[i]=r[i];if(n.minTimeout>n.maxTimeout)throw new Error("minTimeout is greater than maxTimeout");for(var a=[],o=0;o<n.retries;o++)a.push(this.createTimeout(o,n));return r&&r.forever&&!a.length&&a.push(this.createTimeout(o,n)),a.sort(function(s,l){return s-l}),a},t.createTimeout=function(r,n){var i=n.randomize?Math.random()+1:1,a=Math.round(i*Math.max(n.minTimeout,1)*Math.pow(n.factor,r));return a=Math.min(a,n.maxTimeout),a},t.wrap=function(r,n,i){if(n instanceof Array&&(i=n,n=null),!i){i=[];for(var a in r)typeof r[a]=="function"&&i.push(a)}for(var o=0;o<i.length;o++){var s=i[o],l=r[s];r[s]=(function(d){var h=t.operation(n),p=Array.prototype.slice.call(arguments,1),m=p.pop();p.push(function(g){h.retry(g)||(g&&(arguments[0]=h.mainError()),m.apply(this,arguments))}),h.attempt(function(){d.apply(r,p)})}).bind(r,l),r[s].options=n}}})(hj);var nce=hj;const ice=nce,ace=["Failed to fetch","NetworkError when attempting to fetch resource.","The Internet connection appears to be offline.","Network request failed"];class pj extends Error{constructor(e){super(),e instanceof Error?(this.originalError=e,{message:e}=e):(this.originalError=new Error(e),this.originalError.stack=this.stack),this.name="AbortError",this.message=e}}const oce=(t,e,r)=>{const n=r.retries-(e-1);return t.attemptNumber=e,t.retriesLeft=n,t},sce=t=>ace.includes(t),mj=(t,e)=>new Promise((r,n)=>{e={onFailedAttempt:()=>{},retries:10,...e};const i=ice.operation(e);i.attempt(async a=>{try{r(await t(a))}catch(o){if(!(o instanceof Error)){n(new TypeError(`Non-error was thrown: "${o}". You should only throw errors.`));return}if(o instanceof pj)i.stop(),n(o.originalError);else if(o instanceof TypeError&&!sce(o.message))i.stop(),n(o);else{oce(o,a,e);try{await e.onFailedAttempt(o)}catch(s){n(s);return}i.retry(o)||n(i.mainError())}}})});jb.exports=mj;jb.exports.default=mj;jb.exports.AbortError=pj;var lce=jb.exports;const vj=Uu(lce);let Wm=class{constructor(e,r){if(this.stable=e,this.unstable=r,!this.unstable&&!this.stable)throw new Error("One of stable or unstable values must be supplied")}get name(){return this.stable?this.stable:this.unstable}get altName(){return this.stable?this.unstable:null}get names(){var e=[this.name],r=this.altName;return r&&e.push(r),e}matches(e){return this.name===e||this.altName===e}findIn(e){var r=void 0;return this.name&&(r=e==null?void 0:e[this.name]),!r&&this.altName&&(r=e==null?void 0:e[this.altName]),r}includedIn(e){var r=!1;return this.name&&(r=e.includes(this.name)),!r&&this.altName&&(r=e.includes(this.altName)),r}};class Vb extends Wm{constructor(){super(...arguments),E(this,"preferUnstable",!1)}setPreferUnstable(e){this.preferUnstable=e}get name(){return this.stable&&!this.preferUnstable?this.stable:this.unstable}}let Rr=class extends Wm{constructor(e,r){if(super(e,r),!this.unstable)throw new Error("Unstable value must be supplied")}get name(){return this.unstable}get altName(){return this.stable}};var Qd=function(t){return t.Self="m.self",t.Pin="m.pin",t}({}),Gm=new Rr("m.asset","org.matrix.msc3488.asset"),xl=new Rr("m.ts","org.matrix.msc3488.ts"),qm=new Rr("m.location","org.matrix.msc3488.location"),In=function(t){return t.Read="m.read",t.FullyRead="m.fully_read",t.ReadPrivate="m.read.private",t}({}),Zm="main";function eA(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function tA(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?eA(Object(r),!0).forEach(function(n){E(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):eA(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var mw=new Map;function vw(t){return t instanceof String&&(t=t.toString()),mw.has(t)||mw.set(t,t),mw.get(t)}function rx(t,e){var r=e??new URLSearchParams,n=function(s){a!=null&&(Array.isArray(a)?a.forEach(l=>{r.append(s,String(l))}):r.append(s,String(a)))};for(var[i,a]of Object.entries(t))n(i);return r}function rA(t,e,r){var n=tA(tA({},r),{},{[e]:r[t]});return delete n[t],n}function Le(t,e){for(var r in e)if(e.hasOwnProperty(r)){var n=e[r];n!=null&&(t=t.replace(r,encodeURIComponent(n)))}return t}function E0(t,e,r){var n;if(r){for(n=t.length-1;n>=0;n--)if(e(t[n],n,t))return t.splice(n,1),!0}else for(n=0;n<t.length;n++)if(e(t[n],n,t))return t.splice(n,1),!0;return!1}function gj(t,e){for(var r of e)if(!t.hasOwnProperty(r))throw new Error("Missing required key: "+r)}function Ym(t){return JSON.parse(JSON.stringify(t))}function ef(t,e){if(t===e)return!0;if(typeof t!=typeof e)return!1;if(typeof t=="number"&&isNaN(t)&&isNaN(e))return!0;if(t===null||e===null)return t===e;if(!(t instanceof Object)||t.constructor!==e.constructor||t.prototype!==e.prototype)return!1;if(t instanceof RegExp||t instanceof Date)return t.toString()===e.toString();if(Array.isArray(t)){if(t.length!==e.length)return!1;for(var r=0;r<t.length;r++)if(!ef(t[r],e[r]))return!1}else{for(var n in e)if(e.hasOwnProperty(n)!==t.hasOwnProperty(n))return!1;for(var i in t)if(e.hasOwnProperty(i)!==t.hasOwnProperty(i)||!ef(t[i],e[i]))return!1}return!0}function nx(t){if(typeof t!="object"||t==null||Array.isArray(t))return t;var e=[];for(var[r,n]of Object.entries(t))e.push([r,nx(n)]);return e.sort((i,a)=>Yg(i[0],a[0])),e}function nA(t){return typeof t=="number"&&isFinite(t)}function _u(t){return typeof t=="string"?tce(t.normalize("NFD").replace(cce,"")):""}function ix(t){return typeof t=="string"?t.replace(/[\u202d-\u202e]/g,""):""}function uce(t){return _u(t.toLowerCase()).replace(/[\\'!"#$%&()*+,\-./:;<=>?@[\]^_`{|}~\u2000-\u206f\u2e00-\u2e7f]/g,"").toLowerCase()}var cce=/[\u2000-\u200F\u202A-\u202F\u0300-\u036F\uFEFF\u061C\u2800\u2062-\u2063\s]/g;function yj(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function bj(t){return yj(t).replace(/\\\*/g,".*").replace(/\?/g,".")}function gw(t){return t!=null&&t.endsWith("/")?t.slice(0,-1):t}function $u(t,e){return new Promise(r=>{setTimeout(r,t,e)})}function Sye(t,e,r){return ax.apply(this,arguments)}function ax(){return ax=K(function*(t,e,r){var n=Date.now();try{return yield r()}finally{var i=Date.now();t.debug("[Perf]: ".concat(e," took ").concat(i-n,"ms"))}}),ax.apply(this,arguments)}function dce(t,e,r){var n=Date.now();try{return r()}finally{var i=Date.now();t.debug("[Perf]: ".concat(e," took ").concat(i-n,"ms"))}}function _j(t){return t==null}function ml(){var t,e,r=new Promise((n,i)=>{t=n,e=i});return{resolve:t,reject:e,promise:r}}function Xc(t,e){return ox.apply(this,arguments)}function ox(){return ox=K(function*(t,e){for(var r of t)yield e(yield r)}),ox.apply(this,arguments)}function yc(t){return Promise.resolve(t())}function fce(t){return vj(e=>t(e),{forever:!0,factor:2,minTimeout:3e3,maxTimeout:15e3})}var vl=(()=>{for(var t="",e=32;e<=126;e++)t+=String.fromCharCode(e);return t})();function iA(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:vl;return t.padEnd(e,r[0])}function em(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:vl,r=BigInt(e.length);if(t<=r){var n;return(n=e[Number(t)-1])!==null&&n!==void 0?n:""}var i=t/r,a=Number(t%r)-1;return a<0&&(i-=BigInt(Math.abs(a)),a=Number(r)-1),em(i,e)+e[a]}function x0(t){for(var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:vl,r=BigInt(e.length),n=BigInt(0),i=t.length-1,a=BigInt(0);i>=0;i--,a++){var o=t.charCodeAt(i)-e.charCodeAt(0);n+=BigInt(1+o)*r**a}return n}function hce(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:vl,n=Math.max(t.length,e.length),i=x0(iA(t,n,r),r),a=x0(iA(e,n,r),r),o=(i+a)/BigInt(2);return o===i||o==a?em(o,r)+r[0]:em(o,r)}function fh(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:vl;return em(x0(t,e)+BigInt(1),e)}function aA(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:vl;return em(x0(t,e)-BigInt(1),e)}function Yg(t,e){return t<e?-1:t>e?1:0}function Sj(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;for(var[n,i]of Object.entries(e)){if(t[n]instanceof Object&&i){Sj(t[n],i);continue}if(i!=null||!r){C0(t,n,i);continue}}return t}function oA(t){var e;return(e=xl.findIn(t.getContent()))!==null&&e!==void 0?e:-1}function pce(t,e){return oA(e)-oA(t)}function W4(t){return[In.Read,In.ReadPrivate].includes(t)}function sA(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:(o,s)=>o===s;if(t.size!==e.size)return!1;for(var[n,i]of t){var a=e.get(n);if(a===void 0||!r(i,a))return!1}return!0}function wj(t){return t instanceof Map?ou(t):Array.isArray(t)?t.map(e=>wj(e)):t}function ou(t){var e=new Map;for(var[r,n]of t)e.set(r,wj(n));return Object.fromEntries(e.entries())}function up(t){return t==="__proto__"||t==="prototype"||t==="constructor"}function C0(t,e,r){if(up(e))throw new Error("Trying to modify prototype or constructor");t[e]=r}function ya(t){return!(up(t.room_id)||up(t.sender)||up(t.event_id))}class qo extends Map{constructor(e){super(),this.createDefault=e}getOrCreate(e){return this.has(e)||this.set(e,this.createDefault()),this.get(e)}}var sx="migrationState",tf=function(t){return t[t.NOT_STARTED=0]="NOT_STARTED",t[t.INITIAL_DATA_MIGRATED=1]="INITIAL_DATA_MIGRATED",t[t.OLM_SESSIONS_MIGRATED=2]="OLM_SESSIONS_MIGRATED",t[t.MEGOLM_SESSIONS_MIGRATED=3]="MEGOLM_SESSIONS_MIGRATED",t[t.ROOM_SETTINGS_MIGRATED=4]="ROOM_SETTINGS_MIGRATED",t[t.INITIAL_OWN_KEY_QUERY_DONE=5]="INITIAL_OWN_KEY_QUERY_DONE",t}({}),rf=50;function lA(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function uA(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?lA(Object(r),!0).forEach(function(n){E(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):lA(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function dg(t,e){return encodeURIComponent(t)+"/"+encodeURIComponent(e)}function mce(t){var e=t.split("/"),r=decodeURIComponent(e[0]),n=decodeURIComponent(e[1]);return{senderKey:r,sessionId:n}}class zb{constructor(){E(this,"migrationState",tf.NOT_STARTED),E(this,"account",null),E(this,"crossSigningKeys",null),E(this,"privateKeys",{}),E(this,"sessions",{}),E(this,"inboundGroupSessions",{}),E(this,"inboundGroupSessionsWithheld",{}),E(this,"rooms",{}),E(this,"sessionsNeedingBackup",{})}containsData(){var e=this;return K(function*(){return e.account!==null})()}startup(){var e=this;return K(function*(){return e})()}deleteAllData(){return Promise.resolve()}getMigrationState(){var e=this;return K(function*(){return e.migrationState})()}setMigrationState(e){var r=this;return K(function*(){r.migrationState=e})()}getAccount(e,r){r(this.account)}storeAccount(e,r){this.account=r}getCrossSigningKeys(e,r){r(this.crossSigningKeys)}getSecretStorePrivateKey(e,r,n){var i=this.privateKeys[n];r(i||null)}storeSecretStorePrivateKey(e,r,n){this.privateKeys[r]=n}countEndToEndSessions(e,r){var n=0;for(var i of Object.values(this.sessions))n+=Object.keys(i).length;r(n)}getEndToEndSession(e,r,n,i){var a=this.sessions[e]||{};i(a[r]||null)}getEndToEndSessions(e,r,n){n(this.sessions[e]||{})}storeEndToEndSession(e,r,n,i){var a=this.sessions[e];a===void 0&&(a={},this.sessions[e]=a),C0(a,r,n)}getEndToEndSessionsBatch(){var e=this;return K(function*(){var r=[];for(var n of Object.values(e.sessions))for(var i of Object.values(n))if(r.push(i),r.length>=rf)return r;return r.length===0?null:r})()}deleteEndToEndSessionsBatch(e){var r=this;return K(function*(){for(var{deviceKey:n,sessionId:i}of e){var a=r.sessions[n]||{};delete a[i],Object.keys(a).length===0&&delete r.sessions[n]}})()}getEndToEndInboundGroupSession(e,r,n,i){var a=dg(e,r);i(this.inboundGroupSessions[a]||null,this.inboundGroupSessionsWithheld[a]||null)}storeEndToEndInboundGroupSession(e,r,n,i){var a=dg(e,r);this.inboundGroupSessions[a]=n}countEndToEndInboundGroupSessions(){var e=this;return K(function*(){return Object.keys(e.inboundGroupSessions).length})()}getEndToEndInboundGroupSessionsBatch(){var e=this;return K(function*(){var r=[];for(var[n,i]of Object.entries(e.inboundGroupSessions))if(r.push(uA(uA({},mce(n)),{},{sessionData:i,needsBackup:n in e.sessionsNeedingBackup})),r.length>=rf)return r;return r.length===0?null:r})()}deleteEndToEndInboundGroupSessionsBatch(e){var r=this;return K(function*(){for(var{senderKey:n,sessionId:i}of e){var a=dg(n,i);delete r.inboundGroupSessions[a]}})()}getEndToEndRooms(e,r){r(this.rooms)}markSessionsNeedingBackup(e){for(var r of e){var n=dg(r.senderKey,r.sessionId);this.sessionsNeedingBackup[n]=!0}return Promise.resolve()}doTxn(e,r,n){return Promise.resolve(n(null))}}var vce=/^(?:(?:\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})|(?:\[[\dA-Fa-f:.]{2,45}])|(?:[A-Za-z\d\-.]{1,255}))(?::\d{1,5})?$/;function gce(t){var e=vce.exec(t);return(e==null?void 0:e[0])===t}var yce=/^[\w-]+$/;function bce(t){var e=yce.exec(t);return(e==null?void 0:e[0])===t}function Kb(t,e,r,n,i){var a=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!1,o=arguments.length>6?arguments[6]:void 0,s=arguments.length>7?arguments[7]:void 0;if(typeof e!="string"||!e)return"";if(!e.startsWith("mxc://"))return a?e:"";var[l,c,...d]=e.slice(6).split("/");if(d.length>0||!gce(l)||!bce(c))return"";s&&(o=!0);var h,p=!!r||!!n||!!i,m=p?"thumbnail":"download";s?h="/_matrix/client/v1/media/".concat(m):h="/_matrix/media/v3/".concat(m);var g=new URL("".concat(h,"/").concat(l,"/").concat(c),t);return r&&g.searchParams.set("width",Math.round(r).toString()),n&&g.searchParams.set("height",Math.round(n).toString()),i&&g.searchParams.set("method",i),typeof o=="boolean"&&g.searchParams.set("allow_redirect",JSON.stringify(o)),g.href}var Ej={exports:{}};(function(t){(function(e,r){t.exports?t.exports=r():e.log=r()})(Jk,function(){var e=function(){},r="undefined",n=typeof window!==r&&typeof window.navigator!==r&&/Trident\/|MSIE /.test(window.navigator.userAgent),i=["trace","debug","info","warn","error"],a={},o=null;function s(y,R){var b=y[R];if(typeof b.bind=="function")return b.bind(y);try{return Function.prototype.bind.call(b,y)}catch{return function(){return Function.prototype.apply.apply(b,[y,arguments])}}}function l(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function c(y){return y==="debug"&&(y="log"),typeof console===r?!1:y==="trace"&&n?l:console[y]!==void 0?s(console,y):console.log!==void 0?s(console,"log"):e}function d(){for(var y=this.getLevel(),R=0;R<i.length;R++){var b=i[R];this[b]=R<y?e:this.methodFactory(b,y,this.name)}if(this.log=this.debug,typeof console===r&&y<this.levels.SILENT)return"No console available for logging"}function h(y){return function(){typeof console!==r&&(d.call(this),this[y].apply(this,arguments))}}function p(y,R,b){return c(y)||h.apply(this,arguments)}function m(y,R){var b=this,_,x,T,I="loglevel";typeof y=="string"?I+=":"+y:typeof y=="symbol"&&(I=void 0);function C(j){var J=(i[j]||"silent").toUpperCase();if(!(typeof window===r||!I)){try{window.localStorage[I]=J;return}catch{}try{window.document.cookie=encodeURIComponent(I)+"="+J+";"}catch{}}}function k(){var j;if(!(typeof window===r||!I)){try{j=window.localStorage[I]}catch{}if(typeof j===r)try{var J=window.document.cookie,$=encodeURIComponent(I),le=J.indexOf($+"=");le!==-1&&(j=/^([^;]+)/.exec(J.slice(le+$.length+1))[1])}catch{}return b.levels[j]===void 0&&(j=void 0),j}}function S(){if(!(typeof window===r||!I)){try{window.localStorage.removeItem(I)}catch{}try{window.document.cookie=encodeURIComponent(I)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}function V(j){var J=j;if(typeof J=="string"&&b.levels[J.toUpperCase()]!==void 0&&(J=b.levels[J.toUpperCase()]),typeof J=="number"&&J>=0&&J<=b.levels.SILENT)return J;throw new TypeError("log.setLevel() called with invalid level: "+j)}b.name=y,b.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},b.methodFactory=R||p,b.getLevel=function(){return T??x??_},b.setLevel=function(j,J){return T=V(j),J!==!1&&C(T),d.call(b)},b.setDefaultLevel=function(j){x=V(j),k()||b.setLevel(j,!1)},b.resetLevel=function(){T=null,S(),d.call(b)},b.enableAll=function(j){b.setLevel(b.levels.TRACE,j)},b.disableAll=function(j){b.setLevel(b.levels.SILENT,j)},b.rebuild=function(){if(o!==b&&(_=V(o.getLevel())),d.call(b),o===b)for(var j in a)a[j].rebuild()},_=V(o?o.getLevel():"WARN");var z=k();z!=null&&(T=V(z)),d.call(b)}o=new m,o.getLogger=function(R){if(typeof R!="symbol"&&typeof R!="string"||R==="")throw new TypeError("You must supply a name when creating a logger.");var b=a[R];return b||(b=a[R]=new m(R,o.methodFactory)),b};var g=typeof window!==r?window.log:void 0;return o.noConflict=function(){return typeof window!==r&&window.log===o&&(window.log=g),o},o.getLoggers=function(){return a},o.default=o,o})})(Ej);var _ce=Ej.exports;const lx=Uu(_ce);var Sce="matrix";lx.methodFactory=function(t,e,r){return function(){for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];this.prefix&&i.unshift(this.prefix);var o=t==="error"||t==="warn"||t==="trace"||t==="info"||t==="debug";return o?console[t](...i):console.log(...i)}};function xj(t){var e=Sce+(t===void 0?"":"-".concat(t)),r=lx.getLogger(e);return r.getChild===void 0&&(r.prefix=t,r.getChild=n=>{var i=xj((t??"")+n);return i.methodFactory=r.methodFactory,i.rebuild(),i},r.setLevel(lx.levels.DEBUG,!1)),r}var U=xj();class wye{constructor(e,r){this.parent=e,E(this,"name",void 0),this.name=r+":"}trace(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];this.parent.trace(this.name,...r)}debug(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];this.parent.debug(this.name,...r)}info(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];this.parent.info(this.name,...r)}warn(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];this.parent.warn(this.name,...r)}error(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];this.parent.error(this.name,...r)}}var G4={exports:{}},_d=typeof Reflect=="object"?Reflect:null,cA=_d&&typeof _d.apply=="function"?_d.apply:function(e,r,n){return Function.prototype.apply.call(e,r,n)},Jg;_d&&typeof _d.ownKeys=="function"?Jg=_d.ownKeys:Object.getOwnPropertySymbols?Jg=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Jg=function(e){return Object.getOwnPropertyNames(e)};function wce(t){console&&console.warn&&console.warn(t)}var Cj=Number.isNaN||function(e){return e!==e};function zt(){zt.init.call(this)}G4.exports=zt;G4.exports.once=Tce;zt.EventEmitter=zt;zt.prototype._events=void 0;zt.prototype._eventsCount=0;zt.prototype._maxListeners=void 0;var dA=10;function Hb(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(zt,"defaultMaxListeners",{enumerable:!0,get:function(){return dA},set:function(t){if(typeof t!="number"||t<0||Cj(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");dA=t}});zt.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};zt.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||Cj(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function Tj(t){return t._maxListeners===void 0?zt.defaultMaxListeners:t._maxListeners}zt.prototype.getMaxListeners=function(){return Tj(this)};zt.prototype.emit=function(e){for(var r=[],n=1;n<arguments.length;n++)r.push(arguments[n]);var i=e==="error",a=this._events;if(a!==void 0)i=i&&a.error===void 0;else if(!i)return!1;if(i){var o;if(r.length>0&&(o=r[0]),o instanceof Error)throw o;var s=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw s.context=o,s}var l=a[e];if(l===void 0)return!1;if(typeof l=="function")cA(l,this,r);else for(var c=l.length,d=Pj(l,c),n=0;n<c;++n)cA(d[n],this,r);return!0};function Dj(t,e,r,n){var i,a,o;if(Hb(r),a=t._events,a===void 0?(a=t._events=Object.create(null),t._eventsCount=0):(a.newListener!==void 0&&(t.emit("newListener",e,r.listener?r.listener:r),a=t._events),o=a[e]),o===void 0)o=a[e]=r,++t._eventsCount;else if(typeof o=="function"?o=a[e]=n?[r,o]:[o,r]:n?o.unshift(r):o.push(r),i=Tj(t),i>0&&o.length>i&&!o.warned){o.warned=!0;var s=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");s.name="MaxListenersExceededWarning",s.emitter=t,s.type=e,s.count=o.length,wce(s)}return t}zt.prototype.addListener=function(e,r){return Dj(this,e,r,!1)};zt.prototype.on=zt.prototype.addListener;zt.prototype.prependListener=function(e,r){return Dj(this,e,r,!0)};function Ece(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Rj(t,e,r){var n={fired:!1,wrapFn:void 0,target:t,type:e,listener:r},i=Ece.bind(n);return i.listener=r,n.wrapFn=i,i}zt.prototype.once=function(e,r){return Hb(r),this.on(e,Rj(this,e,r)),this};zt.prototype.prependOnceListener=function(e,r){return Hb(r),this.prependListener(e,Rj(this,e,r)),this};zt.prototype.removeListener=function(e,r){var n,i,a,o,s;if(Hb(r),i=this._events,i===void 0)return this;if(n=i[e],n===void 0)return this;if(n===r||n.listener===r)--this._eventsCount===0?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||r));else if(typeof n!="function"){for(a=-1,o=n.length-1;o>=0;o--)if(n[o]===r||n[o].listener===r){s=n[o].listener,a=o;break}if(a<0)return this;a===0?n.shift():xce(n,a),n.length===1&&(i[e]=n[0]),i.removeListener!==void 0&&this.emit("removeListener",e,s||r)}return this};zt.prototype.off=zt.prototype.removeListener;zt.prototype.removeAllListeners=function(e){var r,n,i;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete n[e]),this;if(arguments.length===0){var a=Object.keys(n),o;for(i=0;i<a.length;++i)o=a[i],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(r=n[e],typeof r=="function")this.removeListener(e,r);else if(r!==void 0)for(i=r.length-1;i>=0;i--)this.removeListener(e,r[i]);return this};function Mj(t,e,r){var n=t._events;if(n===void 0)return[];var i=n[e];return i===void 0?[]:typeof i=="function"?r?[i.listener||i]:[i]:r?Cce(i):Pj(i,i.length)}zt.prototype.listeners=function(e){return Mj(this,e,!0)};zt.prototype.rawListeners=function(e){return Mj(this,e,!1)};zt.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):Ij.call(t,e)};zt.prototype.listenerCount=Ij;function Ij(t){var e=this._events;if(e!==void 0){var r=e[t];if(typeof r=="function")return 1;if(r!==void 0)return r.length}return 0}zt.prototype.eventNames=function(){return this._eventsCount>0?Jg(this._events):[]};function Pj(t,e){for(var r=new Array(e),n=0;n<e;++n)r[n]=t[n];return r}function xce(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function Cce(t){for(var e=new Array(t.length),r=0;r<e.length;++r)e[r]=t[r].listener||t[r];return e}function Tce(t,e){return new Promise(function(r,n){function i(o){t.removeListener(e,a),n(o)}function a(){typeof t.removeListener=="function"&&t.removeListener("error",i),r([].slice.call(arguments))}Aj(t,e,a,{once:!0}),e!=="error"&&Dce(t,i,{once:!0})})}function Dce(t,e,r){typeof t.on=="function"&&Aj(t,"error",e,r)}function Aj(t,e,r,n){if(typeof t.on=="function")n.once?t.once(e,r):t.on(e,r);else if(typeof t.addEventListener=="function")t.addEventListener(e,function i(a){n.once&&t.removeEventListener(e,i),r(a)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}var Wb=G4.exports,kj=function(t){return t.NewListener="newListener",t.RemoveListener="removeListener",t.Error="error",t}({});class nr extends Wb.EventEmitter{addListener(e,r){return super.addListener(e,r)}emit(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return super.emit(e,...n)}emitPromised(e){var r=arguments,n=this;return K(function*(){for(var i=r.length,a=new Array(i>1?i-1:0),o=1;o<i;o++)a[o-1]=r[o];var s=n.listeners(e);return Promise.allSettled(s.map(l=>l(...a))).then(()=>s.length>0)})()}listenerCount(e){return super.listenerCount(e)}listeners(e){return super.listeners(e)}off(e,r){return super.off(e,r)}on(e,r){return super.on(e,r)}once(e,r){return super.once(e,r)}prependListener(e,r){return super.prependListener(e,r)}prependOnceListener(e,r){return super.prependOnceListener(e,r)}removeAllListeners(e){return e===void 0?super.removeAllListeners():super.removeAllListeners(e)}removeListener(e,r){return super.removeListener(e,r)}rawListeners(e){return super.rawListeners(e)}}var ge=function(t){return t.RoomCanonicalAlias="m.room.canonical_alias",t.RoomCreate="m.room.create",t.RoomJoinRules="m.room.join_rules",t.RoomMember="m.room.member",t.RoomThirdPartyInvite="m.room.third_party_invite",t.RoomPowerLevels="m.room.power_levels",t.RoomName="m.room.name",t.RoomTopic="m.room.topic",t.RoomAvatar="m.room.avatar",t.RoomPinnedEvents="m.room.pinned_events",t.RoomEncryption="m.room.encryption",t.RoomHistoryVisibility="m.room.history_visibility",t.RoomGuestAccess="m.room.guest_access",t.RoomServerAcl="m.room.server_acl",t.RoomTombstone="m.room.tombstone",t.RoomPredecessor="org.matrix.msc3946.room_predecessor",t.PolicyRuleUser="m.policy.rule.user",t.PolicyRuleRoom="m.policy.rule.room",t.PolicyRuleServer="m.policy.rule.server",t.SpaceChild="m.space.child",t.SpaceParent="m.space.parent",t.RoomRedaction="m.room.redaction",t.RoomMessage="m.room.message",t.RoomMessageEncrypted="m.room.encrypted",t.Sticker="m.sticker",t.CallInvite="m.call.invite",t.CallCandidates="m.call.candidates",t.CallAnswer="m.call.answer",t.CallHangup="m.call.hangup",t.CallReject="m.call.reject",t.CallSelectAnswer="m.call.select_answer",t.CallNegotiate="m.call.negotiate",t.CallSDPStreamMetadataChanged="m.call.sdp_stream_metadata_changed",t.CallSDPStreamMetadataChangedPrefix="org.matrix.call.sdp_stream_metadata_changed",t.CallReplaces="m.call.replaces",t.CallAssertedIdentity="m.call.asserted_identity",t.CallAssertedIdentityPrefix="org.matrix.call.asserted_identity",t.CallEncryptionKeysPrefix="io.element.call.encryption_keys",t.KeyVerificationRequest="m.key.verification.request",t.KeyVerificationStart="m.key.verification.start",t.KeyVerificationCancel="m.key.verification.cancel",t.KeyVerificationMac="m.key.verification.mac",t.KeyVerificationDone="m.key.verification.done",t.KeyVerificationKey="m.key.verification.key",t.KeyVerificationAccept="m.key.verification.accept",t.KeyVerificationReady="m.key.verification.ready",t.RoomMessageFeedback="m.room.message.feedback",t.Reaction="m.reaction",t.PollStart="org.matrix.msc3381.poll.start",t.Typing="m.typing",t.Receipt="m.receipt",t.Presence="m.presence",t.FullyRead="m.fully_read",t.Tag="m.tag",t.SpaceOrder="org.matrix.msc3230.space_order",t.PushRules="m.push_rules",t.Direct="m.direct",t.IgnoredUserList="m.ignored_user_list",t.RoomKey="m.room_key",t.RoomKeyRequest="m.room_key_request",t.ForwardedRoomKey="m.forwarded_room_key",t.Dummy="m.dummy",t.SecretRequest="m.secret.request",t.SecretSend="m.secret.send",t.GroupCallPrefix="org.matrix.msc3401.call",t.GroupCallMemberPrefix="org.matrix.msc3401.call.member",t.CallNotify="org.matrix.msc4075.call.notify",t}({}),gr=function(t){return t.Annotation="m.annotation",t.Replace="m.replace",t.Reference="m.reference",t.Thread="m.thread",t}({}),Ma=function(t){return t.Text="m.text",t.Emote="m.emote",t.Notice="m.notice",t.Image="m.image",t.File="m.file",t.Audio="m.audio",t.Location="m.location",t.Video="m.video",t.KeyVerificationRequest="m.key.verification.request",t}({}),T0="type",Sd=function(t){return t.Space="m.space",t.UnstableCall="org.matrix.msc3417.call",t.ElementVideo="io.element.video",t}({}),Gb="org.matrix.msgid",ux=new Rr("m.room.purpose","org.matrix.msc3088.purpose"),cx=new Rr("m.enabled","org.matrix.msc3088.enabled"),dx=new Rr("m.data_tree","org.matrix.msc3089.data_tree"),Oj=new Rr("m.leaf","org.matrix.msc3089.leaf"),Io=new Rr("m.branch","org.matrix.msc3089.branch"),$j=new Rr("m.room.marker","org.matrix.msc2716.marker"),fx=new Rr("with_rel_types","org.matrix.msc3912.with_relations"),Lj=new Rr("io.element.functional_members","io.element.functional_members"),su=new Rr("m.visibility","org.matrix.msc3531.visibility"),hx=new Rr("enabled","org.matrix.msc3881.enabled"),Rce=new Rr("device_id","org.matrix.msc3881.device_id"),Bj=new Rr("m.local_notification_settings","org.matrix.msc3890.local_notification_settings"),D0=new Rr("thread_id","org.matrix.msc4023.thread_id"),Nj=new Wm("membership","io.element.msc4115.membership"),ct=function(t){return t.Ban="ban",t.Invite="invite",t.Join="join",t.Knock="knock",t.Leave="leave",t}({}),Xn=function(t){return t.Membership="RoomMember.membership",t.Name="RoomMember.name",t.PowerLevel="RoomMember.powerLevel",t.Typing="RoomMember.typing",t}({});class tm extends nr{constructor(e,r){super(),this.roomId=e,this.userId=r,E(this,"_isOutOfBand",!1),E(this,"modified",-1),E(this,"requestedProfileInfo",!1),E(this,"typing",!1),E(this,"name",void 0),E(this,"rawDisplayName",void 0),E(this,"powerLevel",0),E(this,"powerLevelNorm",0),E(this,"user",void 0),E(this,"membership",void 0),E(this,"disambiguate",!1),E(this,"events",{}),this.name=r,this.rawDisplayName=r,this.updateModifiedTime()}markOutOfBand(){this._isOutOfBand=!0}isOutOfBand(){return this._isOutOfBand}setMembershipEvent(e,r){var n,i,a=(n=e.getDirectionalContent().displayname)!==null&&n!==void 0?n:"";if(e.getType()===ge.RoomMember){this._isOutOfBand=!1,this.events.member=e;var o=this.membership;this.membership=e.getDirectionalContent().membership,this.membership===void 0&&U.trace("membership event with membership undefined (forwardLooking: ".concat(e.forwardLooking,")!"),e.getContent(),"prevcontent is ",e.getPrevContent()),this.disambiguate=Pce(this.userId,a,r);var s=this.name;this.name=Ace(this.userId,a,this.disambiguate),this.rawDisplayName=ix((i=e.getDirectionalContent().displayname)!==null&&i!==void 0?i:""),(!this.rawDisplayName||!_u(this.rawDisplayName))&&(this.rawDisplayName=this.userId),o!==this.membership&&(this.updateModifiedTime(),this.emit(Xn.Membership,e,this,o)),s!==this.name&&(this.updateModifiedTime(),this.emit(Xn.Name,e,this,s))}}setPowerLevelEvent(e){if(!(e.getType()!==ge.RoomPowerLevels||e.getStateKey()!=="")){var r=e.getDirectionalContent(),n=r.users_default||0,i=r.users||{};Object.values(i).forEach(s=>{n=Math.max(n,s)});var a=this.powerLevel,o=this.powerLevelNorm;i[this.userId]!==void 0&&Number.isInteger(i[this.userId])?this.powerLevel=i[this.userId]:r.users_default!==void 0?this.powerLevel=r.users_default:this.powerLevel=0,this.powerLevelNorm=0,n>0&&(this.powerLevelNorm=this.powerLevel*100/n),(a!==this.powerLevel||o!==this.powerLevelNorm)&&(this.updateModifiedTime(),this.emit(Xn.PowerLevel,e,this))}}setTypingEvent(e){if(e.getType()==="m.typing"){var r=this.typing;this.typing=!1;var n=e.getContent().user_ids;Array.isArray(n)&&(n.indexOf(this.userId)!==-1&&(this.typing=!0),r!==this.typing&&(this.updateModifiedTime(),this.emit(Xn.Typing,e,this)))}}updateModifiedTime(){this.modified=Date.now()}getLastModifiedTime(){return this.modified}isKicked(){return this.membership===ct.Leave&&this.events.member!==void 0&&this.events.member.getSender()!==this.events.member.getStateKey()}getDMInviter(){if(this.events.member){var e=this.events.member,r=e.getContent(),n=e.getSender();if(r.membership===ct.Join&&(r=e.getPrevContent(),n=e.getUnsigned().prev_sender),r.membership===ct.Invite&&r.is_direct)return n}}getAvatarUrl(e,r,n,i){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,o=arguments.length>5?arguments[5]:void 0,s=arguments.length>6&&arguments[6]!==void 0?arguments[6]:!1,l=this.getMxcAvatarUrl();if(!l&&!a)return null;var c=Kb(e,l,r,n,i,o,void 0,s);return c||null}getMxcAvatarUrl(){if(this.events.member)return this.events.member.getDirectionalContent().avatar_url;if(this.user)return this.user.avatarUrl}}var Mce=/@.+:.+/,Ice=/[\u200E\u200F\u202A-\u202F]/;function Pce(t,e,r){if(!e||e===t||!r)return!1;var n=_u(e);if(!n)return!1;if(Mce.test(n)||Ice.test(e))return!0;var i=r.getUserIdsWithDisplayName(e);return!!i.some(a=>a!==t)}function Ace(t,e,r){return!e||e===t?t:r?ix(e)+" ("+t+")":_u(e)?ix(e):t}var Fn={},qb={},Jm={};Object.defineProperty(Jm,"__esModule",{value:!0});Jm.NamespacedMap=void 0;function kce(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=Oce(t))||e){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(c){throw c},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,s;return{s:function(){r=r.call(t)},n:function(){var c=r.next();return a=c.done,c},e:function(c){o=!0,s=c},f:function(){try{!a&&r.return!=null&&r.return()}finally{if(o)throw s}}}}function Oce(t,e){if(t){if(typeof t=="string")return fA(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return fA(t,e)}}function fA(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function $ce(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Lce(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Bce(t,e,r){return e&&Lce(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function Nce(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var Uce=function(){function t(e){if($ce(this,t),Nce(this,"internalMap",new Map),e){var r=kce(e),n;try{for(r.s();!(n=r.n()).done;){var i=n.value;this.set(i[0],i[1])}}catch(a){r.e(a)}finally{r.f()}}}return Bce(t,[{key:"get",value:function(r){return r.name&&this.internalMap.has(r.name)?this.internalMap.get(r.name):r.altName&&this.internalMap.has(r.altName)?this.internalMap.get(r.altName):null}},{key:"set",value:function(r,n){r.name&&this.internalMap.set(r.name,n),r.altName&&this.internalMap.set(r.altName,n)}},{key:"has",value:function(r){return!!this.get(r)}},{key:"delete",value:function(r){r.name&&this.internalMap.delete(r.name),r.altName&&this.internalMap.delete(r.altName)}},{key:"hasNamespaced",value:function(r){return this.internalMap.has(r)}},{key:"getNamespaced",value:function(r){return this.internalMap.get(r)}}]),t}();Jm.NamespacedMap=Uce;var ss={};function px(t){"@babel/helpers - typeof";return px=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},px(t)}Object.defineProperty(ss,"__esModule",{value:!0});ss.InvalidEventError=void 0;function Fce(t,e,r){return Object.defineProperty(t,"prototype",{writable:!1}),t}function jce(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Vce(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&rm(t,e)}function zce(t){var e=Uj();return function(){var n=nm(t),i;if(e){var a=nm(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Kce(this,i)}}function Kce(t,e){if(e&&(px(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Hce(t)}function Hce(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function mx(t){var e=typeof Map=="function"?new Map:void 0;return mx=function(n){if(n===null||!Wce(n))return n;if(typeof n!="function")throw new TypeError("Super expression must either be null or a function");if(typeof e<"u"){if(e.has(n))return e.get(n);e.set(n,i)}function i(){return Xg(n,arguments,nm(this).constructor)}return i.prototype=Object.create(n.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),rm(i,n)},mx(t)}function Xg(t,e,r){return Uj()?Xg=Reflect.construct:Xg=function(i,a,o){var s=[null];s.push.apply(s,a);var l=Function.bind.apply(i,s),c=new l;return o&&rm(c,o.prototype),c},Xg.apply(null,arguments)}function Uj(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Wce(t){return Function.toString.call(t).indexOf("[native code]")!==-1}function rm(t,e){return rm=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},rm(t,e)}function nm(t){return nm=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},nm(t)}var Gce=function(t){Vce(r,t);var e=zce(r);function r(n){return jce(this,r),e.call(this,n)}return Fce(r)}(mx(Error));ss.InvalidEventError=Gce;var Rf={},po={},Cl={};Object.defineProperty(Cl,"__esModule",{value:!0});Cl.ExtensibleEvent=void 0;function qce(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Zce(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Yce(t,e,r){return e&&Zce(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}var Jce=function(){function t(e){qce(this,t),this.wireFormat=e}return Yce(t,[{key:"wireContent",get:function(){return this.wireFormat.content}}]),t}();Cl.ExtensibleEvent=Jce;var Xm={};Object.defineProperty(Xm,"__esModule",{value:!0});Xm.isOptionalAString=Xce;Xm.isProvided=Fj;function Xce(t){return Fj(t)&&typeof t=="string"}function Fj(t){return t!=null}var Tr={},Ta={};function vx(t){"@babel/helpers - typeof";return vx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},vx(t)}Object.defineProperty(Ta,"__esModule",{value:!0});Ta.UnstableValue=Ta.NamespacedValue=void 0;function Qce(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&gx(t,e)}function gx(t,e){return gx=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},gx(t,e)}function ede(t){var e=nde();return function(){var n=R0(t),i;if(e){var a=R0(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return tde(this,i)}}function tde(t,e){if(e&&(vx(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return rde(t)}function rde(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function nde(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function R0(t){return R0=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},R0(t)}function jj(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ide(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Vj(t,e,r){return e&&ide(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}var zj=function(){function t(e,r){if(jj(this,t),this.stable=e,this.unstable=r,!this.unstable&&!this.stable)throw new Error("One of stable or unstable values must be supplied")}return Vj(t,[{key:"name",get:function(){return this.stable?this.stable:this.unstable}},{key:"altName",get:function(){return this.stable?this.unstable:null}},{key:"matches",value:function(r){return!!this.name&&this.name===r||!!this.altName&&this.altName===r}},{key:"findIn",value:function(r){var n;return this.name&&(n=r==null?void 0:r[this.name]),!n&&this.altName&&(n=r==null?void 0:r[this.altName]),n}},{key:"includedIn",value:function(r){var n=!1;return this.name&&(n=r.includes(this.name)),!n&&this.altName&&(n=r.includes(this.altName)),n}}]),t}();Ta.NamespacedValue=zj;var ade=function(t){Qce(r,t);var e=ede(r);function r(n,i){var a;if(jj(this,r),a=e.call(this,n,i),!a.unstable)throw new Error("Unstable value must be supplied");return a}return Vj(r,[{key:"name",get:function(){return this.unstable}},{key:"altName",get:function(){return this.stable}}]),r}(zj);Ta.UnstableValue=ade;Object.defineProperty(Tr,"__esModule",{value:!0});Tr.M_TEXT=Tr.M_NOTICE=Tr.M_MESSAGE=Tr.M_HTML=Tr.M_EMOTE=void 0;var Qm=Ta,ode=new Qm.UnstableValue("m.message","org.matrix.msc1767.message");Tr.M_MESSAGE=ode;var sde=new Qm.UnstableValue("m.text","org.matrix.msc1767.text");Tr.M_TEXT=sde;var lde=new Qm.UnstableValue("m.html","org.matrix.msc1767.html");Tr.M_HTML=lde;var ude=new Qm.UnstableValue("m.emote","org.matrix.msc1767.emote");Tr.M_EMOTE=ude;var cde=new Qm.UnstableValue("m.notice","org.matrix.msc1767.notice");Tr.M_NOTICE=cde;var ls={};Object.defineProperty(ls,"__esModule",{value:!0});ls.isEventTypeSame=dde;function dde(t,e){if(typeof t=="string")return typeof e=="string"?e===t:e.matches(t);if(typeof e=="string")return t.matches(e);var r=e,n=t;return r.matches(n.name)||r.matches(n.altName)}function yx(t){"@babel/helpers - typeof";return yx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},yx(t)}Object.defineProperty(po,"__esModule",{value:!0});po.MessageEvent=void 0;var fde=Cl,hh=Xm,yw=ss,li=Tr,hde=ls;function hA(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function pA(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?hA(Object(r),!0).forEach(function(n){xs(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):hA(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function pde(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function mA(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function mde(t,e,r){return e&&mA(t.prototype,e),r&&mA(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function vde(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&bx(t,e)}function bx(t,e){return bx=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},bx(t,e)}function gde(t){var e=bde();return function(){var n=M0(t),i;if(e){var a=M0(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return yde(this,i)}}function yde(t,e){if(e&&(yx(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Qg(t)}function Qg(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function bde(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function M0(t){return M0=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},M0(t)}function xs(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var _de=function(t){vde(r,t);var e=gde(r);function r(n){var i;pde(this,r),i=e.call(this,n),xs(Qg(i),"text",void 0),xs(Qg(i),"html",void 0),xs(Qg(i),"renderings",void 0);var a=li.M_MESSAGE.findIn(i.wireContent),o=li.M_TEXT.findIn(i.wireContent),s=li.M_HTML.findIn(i.wireContent);if((0,hh.isProvided)(a)){if(!Array.isArray(a))throw new yw.InvalidEventError("m.message contents must be an array");var l=a.find(function(d){return!(0,hh.isProvided)(d.mimetype)||d.mimetype==="text/plain"}),c=a.find(function(d){return d.mimetype==="text/html"});if(!l)throw new yw.InvalidEventError("m.message is missing a plain text representation");i.text=l.body,i.html=c==null?void 0:c.body,i.renderings=a}else if((0,hh.isOptionalAString)(o))i.text=o,i.html=s,i.renderings=[{body:o,mimetype:"text/plain"}],i.html&&i.renderings.push({body:i.html,mimetype:"text/html"});else throw new yw.InvalidEventError("Missing textual representation for event");return i}return mde(r,[{key:"isEmote",get:function(){return li.M_EMOTE.matches(this.wireFormat.type)||(0,hh.isProvided)(li.M_EMOTE.findIn(this.wireFormat.content))}},{key:"isNotice",get:function(){return li.M_NOTICE.matches(this.wireFormat.type)||(0,hh.isProvided)(li.M_NOTICE.findIn(this.wireFormat.content))}},{key:"isEquivalentTo",value:function(i){return(0,hde.isEventTypeSame)(i,li.M_MESSAGE)}},{key:"serializeMMessageOnly",value:function(){var i=xs({},li.M_MESSAGE.name,this.renderings);if(this.renderings.length===1){var a=this.renderings[0].mimetype;(a===void 0||a==="text/plain")&&(i=xs({},li.M_TEXT.name,this.renderings[0].body))}return i}},{key:"serialize",value:function(){var i;return{type:"m.room.message",content:pA(pA({},this.serializeMMessageOnly()),{},{body:this.text,msgtype:"m.text",format:this.html?"org.matrix.custom.html":void 0,formatted_body:(i=this.html)!==null&&i!==void 0?i:void 0})}}}],[{key:"from",value:function(i,a){var o;return new r({type:li.M_MESSAGE.name,content:(o={},xs(o,li.M_TEXT.name,i),xs(o,li.M_HTML.name,a),o)})}}]),r}(fde.ExtensibleEvent);po.MessageEvent=_de;var Mf={};function _x(t){"@babel/helpers - typeof";return _x=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_x(t)}Object.defineProperty(Mf,"__esModule",{value:!0});Mf.NoticeEvent=void 0;var Sde=po,fg=Tr,wde=ls;function vA(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Ede(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function gA(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function xde(t,e,r){return e&&gA(t.prototype,e),r&&gA(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function cp(){return typeof Reflect<"u"&&Reflect.get?cp=Reflect.get:cp=function(e,r,n){var i=Cde(e,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?e:n):a.value}},cp.apply(this,arguments)}function Cde(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=Lu(t),t!==null););return t}function Tde(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Sx(t,e)}function Sx(t,e){return Sx=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},Sx(t,e)}function Dde(t){var e=Ide();return function(){var n=Lu(t),i;if(e){var a=Lu(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Rde(this,i)}}function Rde(t,e){if(e&&(_x(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Mde(t)}function Mde(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ide(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Lu(t){return Lu=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},Lu(t)}var Pde=function(t){Tde(r,t);var e=Dde(r);function r(n){return Ede(this,r),e.call(this,n)}return xde(r,[{key:"isNotice",get:function(){return!0}},{key:"isEquivalentTo",value:function(i){return(0,wde.isEventTypeSame)(i,fg.M_NOTICE)||cp(Lu(r.prototype),"isEquivalentTo",this).call(this,i)}},{key:"serialize",value:function(){var i=cp(Lu(r.prototype),"serialize",this).call(this);return i.content.msgtype="m.notice",i}}],[{key:"from",value:function(i,a){var o;return new r({type:fg.M_NOTICE.name,content:(o={},vA(o,fg.M_TEXT.name,i),vA(o,fg.M_HTML.name,a),o)})}}]),r}(Sde.MessageEvent);Mf.NoticeEvent=Pde;var If={};function wx(t){"@babel/helpers - typeof";return wx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},wx(t)}Object.defineProperty(If,"__esModule",{value:!0});If.EmoteEvent=void 0;var Ade=po,hg=Tr,kde=ls;function yA(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Ode(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function bA(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function $de(t,e,r){return e&&bA(t.prototype,e),r&&bA(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function dp(){return typeof Reflect<"u"&&Reflect.get?dp=Reflect.get:dp=function(e,r,n){var i=Lde(e,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?e:n):a.value}},dp.apply(this,arguments)}function Lde(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=Bu(t),t!==null););return t}function Bde(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ex(t,e)}function Ex(t,e){return Ex=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},Ex(t,e)}function Nde(t){var e=jde();return function(){var n=Bu(t),i;if(e){var a=Bu(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Ude(this,i)}}function Ude(t,e){if(e&&(wx(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Fde(t)}function Fde(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function jde(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Bu(t){return Bu=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},Bu(t)}var Vde=function(t){Bde(r,t);var e=Nde(r);function r(n){return Ode(this,r),e.call(this,n)}return $de(r,[{key:"isEmote",get:function(){return!0}},{key:"isEquivalentTo",value:function(i){return(0,kde.isEventTypeSame)(i,hg.M_EMOTE)||dp(Bu(r.prototype),"isEquivalentTo",this).call(this,i)}},{key:"serialize",value:function(){var i=dp(Bu(r.prototype),"serialize",this).call(this);return i.content.msgtype="m.emote",i}}],[{key:"from",value:function(i,a){var o;return new r({type:hg.M_EMOTE.name,content:(o={},yA(o,hg.M_TEXT.name,i),yA(o,hg.M_HTML.name,a),o)})}}]),r}(Ade.MessageEvent);If.EmoteEvent=Vde;Object.defineProperty(Rf,"__esModule",{value:!0});Rf.LEGACY_M_ROOM_MESSAGE=void 0;Rf.parseMRoomMessage=Gde;var _A=po,zde=Mf,Kde=If,Hde=Ta,vs=Tr;function SA(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Ni(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?SA(Object(r),!0).forEach(function(n){Wl(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):SA(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Wl(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var Wde=new Hde.NamespacedValue("m.room.message");Rf.LEGACY_M_ROOM_MESSAGE=Wde;function Gde(t){var e,r,n;if(vs.M_MESSAGE.findIn(t.content)||vs.M_TEXT.findIn(t.content))return new _A.MessageEvent(t);var i=(e=t.content)===null||e===void 0?void 0:e.msgtype,a=(r=t.content)===null||r===void 0?void 0:r.body,o=((n=t.content)===null||n===void 0?void 0:n.format)==="org.matrix.custom.html"?t.content.formatted_body:null;if(i==="m.text"){var s;return new _A.MessageEvent(Ni(Ni({},t),{},{content:Ni(Ni({},t.content),{},(s={},Wl(s,vs.M_TEXT.name,a),Wl(s,vs.M_HTML.name,o),s))}))}else if(i==="m.notice"){var l;return new zde.NoticeEvent(Ni(Ni({},t),{},{content:Ni(Ni({},t.content),{},(l={},Wl(l,vs.M_TEXT.name,a),Wl(l,vs.M_HTML.name,o),l))}))}else if(i==="m.emote"){var c;return new Kde.EmoteEvent(Ni(Ni({},t),{},{content:Ni(Ni({},t.content),{},(c={},Wl(c,vs.M_TEXT.name,a),Wl(c,vs.M_HTML.name,o),c))}))}else return null}var Zb={};Object.defineProperty(Zb,"__esModule",{value:!0});Zb.parseMMessage=Jde;var qde=po,wA=Tr,Zde=If,Yde=Mf;function Jde(t){return wA.M_EMOTE.matches(t.type)?new Zde.EmoteEvent(t):wA.M_NOTICE.matches(t.type)?new Yde.NoticeEvent(t):new qde.MessageEvent(t)}var pn={};Object.defineProperty(pn,"__esModule",{value:!0});pn.M_POLL_START=pn.M_POLL_RESPONSE=pn.M_POLL_KIND_UNDISCLOSED=pn.M_POLL_KIND_DISCLOSED=pn.M_POLL_END=void 0;var ev=Ta,Xde=new ev.UnstableValue("m.poll.disclosed","org.matrix.msc3381.poll.disclosed");pn.M_POLL_KIND_DISCLOSED=Xde;var Qde=new ev.UnstableValue("m.poll.undisclosed","org.matrix.msc3381.poll.undisclosed");pn.M_POLL_KIND_UNDISCLOSED=Qde;var efe=new ev.UnstableValue("m.poll.start","org.matrix.msc3381.poll.start");pn.M_POLL_START=efe;var tfe=new ev.UnstableValue("m.poll.response","org.matrix.msc3381.poll.response");pn.M_POLL_RESPONSE=tfe;var rfe=new ev.UnstableValue("m.poll.end","org.matrix.msc3381.poll.end");pn.M_POLL_END=rfe;var Yb={},Nu={};function xx(t){"@babel/helpers - typeof";return xx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xx(t)}Object.defineProperty(Nu,"__esModule",{value:!0});Nu.PollStartEvent=Nu.PollAnswerSubevent=void 0;var Eo=pn,Kj=po,Bh=Tr,ey=ss,nfe=Ta,ife=ls,afe=Cl;function ofe(t){return cfe(t)||ufe(t)||lfe(t)||sfe()}function sfe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function lfe(t,e){if(t){if(typeof t=="string")return Cx(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Cx(t,e)}}function ufe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function cfe(t){if(Array.isArray(t))return Cx(t)}function Cx(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function EA(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function dfe(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?EA(Object(r),!0).forEach(function(n){Wn(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):EA(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Hj(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function xA(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Wj(t,e,r){return e&&xA(t.prototype,e),r&&xA(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Gj(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Tx(t,e)}function Tx(t,e){return Tx=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},Tx(t,e)}function qj(t){var e=hfe();return function(){var n=I0(t),i;if(e){var a=I0(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return ffe(this,i)}}function ffe(t,e){if(e&&(xx(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ql(t)}function Ql(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function hfe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function I0(t){return I0=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},I0(t)}function Wn(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var Zj=function(t){Gj(r,t);var e=qj(r);function r(n){var i;Hj(this,r),i=e.call(this,n),Wn(Ql(i),"id",void 0);var a=n.content.id;if(!a||typeof a!="string")throw new ey.InvalidEventError("Answer ID must be a non-empty string");return i.id=a,i}return Wj(r,[{key:"serialize",value:function(){return{type:"org.matrix.sdk.poll.answer",content:dfe({id:this.id},this.serializeMMessageOnly())}}}],[{key:"from",value:function(i,a){return new r({type:"org.matrix.sdk.poll.answer",content:Wn({id:i},Bh.M_TEXT.name,a)})}}]),r}(Kj.MessageEvent);Nu.PollAnswerSubevent=Zj;var pfe=function(t){Gj(r,t);var e=qj(r);function r(n){var i;Hj(this,r),i=e.call(this,n),Wn(Ql(i),"question",void 0),Wn(Ql(i),"kind",void 0),Wn(Ql(i),"rawKind",void 0),Wn(Ql(i),"maxSelections",void 0),Wn(Ql(i),"answers",void 0);var a=Eo.M_POLL_START.findIn(i.wireContent);if(!a.question)throw new ey.InvalidEventError("A question is required");if(i.question=new Kj.MessageEvent({type:"org.matrix.sdk.poll.question",content:a.question}),i.rawKind=a.kind,Eo.M_POLL_KIND_DISCLOSED.matches(i.rawKind)?i.kind=Eo.M_POLL_KIND_DISCLOSED:i.kind=Eo.M_POLL_KIND_UNDISCLOSED,i.maxSelections=Number.isFinite(a.max_selections)&&a.max_selections>0?a.max_selections:1,!Array.isArray(a.answers))throw new ey.InvalidEventError("Poll answers must be an array");var o=a.answers.slice(0,20).map(function(s){return new Zj({type:"org.matrix.sdk.poll.answer",content:s})});if(o.length<=0)throw new ey.InvalidEventError("No answers available");return i.answers=o,i}return Wj(r,[{key:"isEquivalentTo",value:function(i){return(0,ife.isEventTypeSame)(i,Eo.M_POLL_START)}},{key:"serialize",value:function(){var i;return{type:Eo.M_POLL_START.name,content:(i={},Wn(i,Eo.M_POLL_START.name,{question:this.question.serialize().content,kind:this.rawKind,max_selections:this.maxSelections,answers:this.answers.map(function(a){return a.serialize().content})}),Wn(i,Bh.M_TEXT.name,"".concat(this.question.text,`
`).concat(this.answers.map(function(a,o){return"".concat(o+1,". ").concat(a.text)}).join(`
`))),i)}}}],[{key:"from",value:function(i,a,o){var s,l=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;return new r({type:Eo.M_POLL_START.name,content:(s={},Wn(s,Bh.M_TEXT.name,i),Wn(s,Eo.M_POLL_START.name,{question:Wn({},Bh.M_TEXT.name,i),kind:o instanceof nfe.NamespacedValue?o.name:o,max_selections:l,answers:a.map(function(c){return Wn({id:mfe()},Bh.M_TEXT.name,c)})}),s)})}}]),r}(afe.ExtensibleEvent);Nu.PollStartEvent=pfe;var CA="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";function mfe(){return ofe(Array(16)).map(function(){return CA.charAt(Math.floor(Math.random()*CA.length))}).join("")}var tv={},Pf={};Object.defineProperty(Pf,"__esModule",{value:!0});Pf.REFERENCE_RELATION=void 0;var vfe=Ta,gfe=new vfe.NamespacedValue("m.reference");Pf.REFERENCE_RELATION=gfe;function Dx(t){"@babel/helpers - typeof";return Dx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Dx(t)}Object.defineProperty(tv,"__esModule",{value:!0});tv.PollResponseEvent=void 0;var yfe=Cl,bc=pn,bfe=ss,bw=Pf,_fe=ls;function Sfe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function TA(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function wfe(t,e,r){return e&&TA(t.prototype,e),r&&TA(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Efe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Rx(t,e)}function Rx(t,e){return Rx=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},Rx(t,e)}function xfe(t){var e=Tfe();return function(){var n=P0(t),i;if(e){var a=P0(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Cfe(this,i)}}function Cfe(t,e){if(e&&(Dx(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ty(t)}function ty(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Tfe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function P0(t){return P0=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},P0(t)}function ph(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var Dfe=function(t){Efe(r,t);var e=xfe(r);function r(n){var i;Sfe(this,r),i=e.call(this,n),ph(ty(i),"internalAnswerIds",void 0),ph(ty(i),"internalSpoiled",void 0),ph(ty(i),"pollEventId",void 0);var a=i.wireContent["m.relates_to"];if(!bw.REFERENCE_RELATION.matches(a==null?void 0:a.rel_type)||typeof(a==null?void 0:a.event_id)!="string")throw new bfe.InvalidEventError("Relationship must be a reference to an event");return i.pollEventId=a.event_id,i.validateAgainst(null),i}return wfe(r,[{key:"answerIds",get:function(){return this.internalAnswerIds}},{key:"spoiled",get:function(){return this.internalSpoiled}},{key:"validateAgainst",value:function(i){var a=bc.M_POLL_RESPONSE.findIn(this.wireContent);if(!Array.isArray(a==null?void 0:a.answers)){this.internalSpoiled=!0,this.internalAnswerIds=[];return}var o=a.answers;if(o.some(function(s){return typeof s!="string"})||o.length===0){this.internalSpoiled=!0,this.internalAnswerIds=[];return}if(i){if(o.some(function(s){return!i.answers.some(function(l){return l.id===s})})){this.internalSpoiled=!0,this.internalAnswerIds=[];return}o=o.slice(0,i.maxSelections)}this.internalAnswerIds=o,this.internalSpoiled=!1}},{key:"isEquivalentTo",value:function(i){return(0,_fe.isEventTypeSame)(i,bc.M_POLL_RESPONSE)}},{key:"serialize",value:function(){return{type:bc.M_POLL_RESPONSE.name,content:ph({"m.relates_to":{rel_type:bw.REFERENCE_RELATION.name,event_id:this.pollEventId}},bc.M_POLL_RESPONSE.name,{answers:this.spoiled?void 0:this.answerIds})}}}],[{key:"from",value:function(i,a){return new r({type:bc.M_POLL_RESPONSE.name,content:ph({"m.relates_to":{rel_type:bw.REFERENCE_RELATION.name,event_id:a}},bc.M_POLL_RESPONSE.name,{answers:i})})}}]),r}(yfe.ExtensibleEvent);tv.PollResponseEvent=Dfe;var rv={};function Mx(t){"@babel/helpers - typeof";return Mx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Mx(t)}Object.defineProperty(rv,"__esModule",{value:!0});rv.PollEndEvent=void 0;var mh=pn,Rfe=ss,_w=Pf,Mfe=po,Ife=Tr,Pfe=ls,Afe=Cl;function DA(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function kfe(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?DA(Object(r),!0).forEach(function(n){$c(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):DA(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Ofe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function RA(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function $fe(t,e,r){return e&&RA(t.prototype,e),r&&RA(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Lfe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ix(t,e)}function Ix(t,e){return Ix=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},Ix(t,e)}function Bfe(t){var e=Ufe();return function(){var n=A0(t),i;if(e){var a=A0(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Nfe(this,i)}}function Nfe(t,e){if(e&&(Mx(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Px(t)}function Px(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ufe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function A0(t){return A0=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},A0(t)}function $c(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var Ffe=function(t){Lfe(r,t);var e=Bfe(r);function r(n){var i;Ofe(this,r),i=e.call(this,n),$c(Px(i),"pollEventId",void 0),$c(Px(i),"closingMessage",void 0);var a=i.wireContent["m.relates_to"];if(!_w.REFERENCE_RELATION.matches(a==null?void 0:a.rel_type)||typeof(a==null?void 0:a.event_id)!="string")throw new Rfe.InvalidEventError("Relationship must be a reference to an event");return i.pollEventId=a.event_id,i.closingMessage=new Mfe.MessageEvent(i.wireFormat),i}return $fe(r,[{key:"isEquivalentTo",value:function(i){return(0,Pfe.isEventTypeSame)(i,mh.M_POLL_END)}},{key:"serialize",value:function(){return{type:mh.M_POLL_END.name,content:kfe($c({"m.relates_to":{rel_type:_w.REFERENCE_RELATION.name,event_id:this.pollEventId}},mh.M_POLL_END.name,{}),this.closingMessage.serialize().content)}}}],[{key:"from",value:function(i,a){var o;return new r({type:mh.M_POLL_END.name,content:(o={"m.relates_to":{rel_type:_w.REFERENCE_RELATION.name,event_id:i}},$c(o,mh.M_POLL_END.name,{}),$c(o,Ife.M_TEXT.name,a),o)})}}]),r}(Afe.ExtensibleEvent);rv.PollEndEvent=Ffe;Object.defineProperty(Yb,"__esModule",{value:!0});Yb.parseMPoll=Kfe;var Sw=pn,jfe=Nu,Vfe=tv,zfe=rv;function Kfe(t){return Sw.M_POLL_START.matches(t.type)?new jfe.PollStartEvent(t):Sw.M_POLL_RESPONSE.matches(t.type)?new Vfe.PollResponseEvent(t):Sw.M_POLL_END.matches(t.type)?new zfe.PollEndEvent(t):null}Object.defineProperty(qb,"__esModule",{value:!0});qb.ExtensibleEvents=void 0;var Hfe=Jm,Wfe=ss,MA=Rf,ww=Zb,pg=Tr,Ew=pn,xw=Yb;function Gfe(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=qfe(t))||e){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(c){throw c},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,s;return{s:function(){r=r.call(t)},n:function(){var c=r.next();return a=c.done,c},e:function(c){o=!0,s=c},f:function(){try{!a&&r.return!=null&&r.return()}finally{if(o)throw s}}}}function qfe(t,e){if(t){if(typeof t=="string")return IA(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return IA(t,e)}}function IA(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Zfe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function PA(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Yfe(t,e,r){return e&&PA(t.prototype,e),r&&PA(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Ax(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var kx=function(){function t(){Zfe(this,t),Ax(this,"interpreters",new Hfe.NamespacedMap([[MA.LEGACY_M_ROOM_MESSAGE,MA.parseMRoomMessage],[pg.M_MESSAGE,ww.parseMMessage],[pg.M_EMOTE,ww.parseMMessage],[pg.M_NOTICE,ww.parseMMessage],[Ew.M_POLL_START,xw.parseMPoll],[Ew.M_POLL_RESPONSE,xw.parseMPoll],[Ew.M_POLL_END,xw.parseMPoll]])),Ax(this,"_unknownInterpretOrder",[pg.M_MESSAGE])}return Yfe(t,[{key:"unknownInterpretOrder",get:function(){var r;return(r=this._unknownInterpretOrder)!==null&&r!==void 0?r:[]},set:function(r){this._unknownInterpretOrder=r}},{key:"registerInterpreter",value:function(r,n){this.interpreters.set(r,n)}},{key:"parse",value:function(r){try{if(this.interpreters.hasNamespaced(r.type))return this.interpreters.getNamespaced(r.type)(r);var n=Gfe(this.unknownInterpretOrder),i;try{for(n.s();!(i=n.n()).done;){var a=i.value;if(this.interpreters.has(a)){var o=this.interpreters.get(a)(r);if(o)return o}}}catch(s){n.e(s)}finally{n.f()}return null}catch(s){if(s instanceof Wfe.InvalidEventError)return null;throw s}}}],[{key:"defaultInstance",get:function(){return t._defaultInstance}},{key:"unknownInterpretOrder",get:function(){return t.defaultInstance.unknownInterpretOrder},set:function(r){t.defaultInstance.unknownInterpretOrder=r}},{key:"registerInterpreter",value:function(r,n){t.defaultInstance.registerInterpreter(r,n)}},{key:"parse",value:function(r){return t.defaultInstance.parse(r)}}]),t}();qb.ExtensibleEvents=kx;Ax(kx,"_defaultInstance",new kx);var Yj={};Object.defineProperty(Yj,"__esModule",{value:!0});var Af={};Object.defineProperty(Af,"__esModule",{value:!0});Af.LegacyMsgType=void 0;Af.isEventLike=Jfe;var Cw=Tr,wd;Af.LegacyMsgType=wd;(function(t){t.Text="m.text",t.Notice="m.notice",t.Emote="m.emote"})(wd||(Af.LegacyMsgType=wd={}));function Jfe(t,e){var r=t.content;return e===wd.Text?Cw.M_MESSAGE.matches(t.type)||t.type==="m.room.message"&&(r==null?void 0:r.msgtype)==="m.text":e===wd.Emote?Cw.M_EMOTE.matches(t.type)||t.type==="m.room.message"&&(r==null?void 0:r.msgtype)==="m.emote":e===wd.Notice?Cw.M_NOTICE.matches(t.type)||t.type==="m.room.message"&&(r==null?void 0:r.msgtype)==="m.notice":!1}(function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=qb;Object.keys(e).forEach(function(C){C==="default"||C==="__esModule"||C in t&&t[C]===e[C]||Object.defineProperty(t,C,{enumerable:!0,get:function(){return e[C]}})});var r=Yj;Object.keys(r).forEach(function(C){C==="default"||C==="__esModule"||C in t&&t[C]===r[C]||Object.defineProperty(t,C,{enumerable:!0,get:function(){return r[C]}})});var n=ss;Object.keys(n).forEach(function(C){C==="default"||C==="__esModule"||C in t&&t[C]===n[C]||Object.defineProperty(t,C,{enumerable:!0,get:function(){return n[C]}})});var i=Ta;Object.keys(i).forEach(function(C){C==="default"||C==="__esModule"||C in t&&t[C]===i[C]||Object.defineProperty(t,C,{enumerable:!0,get:function(){return i[C]}})});var a=Jm;Object.keys(a).forEach(function(C){C==="default"||C==="__esModule"||C in t&&t[C]===a[C]||Object.defineProperty(t,C,{enumerable:!0,get:function(){return a[C]}})});var o=Xm;Object.keys(o).forEach(function(C){C==="default"||C==="__esModule"||C in t&&t[C]===o[C]||Object.defineProperty(t,C,{enumerable:!0,get:function(){return o[C]}})});var s=Af;Object.keys(s).forEach(function(C){C==="default"||C==="__esModule"||C in t&&t[C]===s[C]||Object.defineProperty(t,C,{enumerable:!0,get:function(){return s[C]}})});var l=ls;Object.keys(l).forEach(function(C){C==="default"||C==="__esModule"||C in t&&t[C]===l[C]||Object.defineProperty(t,C,{enumerable:!0,get:function(){return l[C]}})});var c=Rf;Object.keys(c).forEach(function(C){C==="default"||C==="__esModule"||C in t&&t[C]===c[C]||Object.defineProperty(t,C,{enumerable:!0,get:function(){return c[C]}})});var d=Zb;Object.keys(d).forEach(function(C){C==="default"||C==="__esModule"||C in t&&t[C]===d[C]||Object.defineProperty(t,C,{enumerable:!0,get:function(){return d[C]}})});var h=Yb;Object.keys(h).forEach(function(C){C==="default"||C==="__esModule"||C in t&&t[C]===h[C]||Object.defineProperty(t,C,{enumerable:!0,get:function(){return h[C]}})});var p=Pf;Object.keys(p).forEach(function(C){C==="default"||C==="__esModule"||C in t&&t[C]===p[C]||Object.defineProperty(t,C,{enumerable:!0,get:function(){return p[C]}})});var m=Cl;Object.keys(m).forEach(function(C){C==="default"||C==="__esModule"||C in t&&t[C]===m[C]||Object.defineProperty(t,C,{enumerable:!0,get:function(){return m[C]}})});var g=Tr;Object.keys(g).forEach(function(C){C==="default"||C==="__esModule"||C in t&&t[C]===g[C]||Object.defineProperty(t,C,{enumerable:!0,get:function(){return g[C]}})});var y=po;Object.keys(y).forEach(function(C){C==="default"||C==="__esModule"||C in t&&t[C]===y[C]||Object.defineProperty(t,C,{enumerable:!0,get:function(){return y[C]}})});var R=If;Object.keys(R).forEach(function(C){C==="default"||C==="__esModule"||C in t&&t[C]===R[C]||Object.defineProperty(t,C,{enumerable:!0,get:function(){return R[C]}})});var b=Mf;Object.keys(b).forEach(function(C){C==="default"||C==="__esModule"||C in t&&t[C]===b[C]||Object.defineProperty(t,C,{enumerable:!0,get:function(){return b[C]}})});var _=pn;Object.keys(_).forEach(function(C){C==="default"||C==="__esModule"||C in t&&t[C]===_[C]||Object.defineProperty(t,C,{enumerable:!0,get:function(){return _[C]}})});var x=Nu;Object.keys(x).forEach(function(C){C==="default"||C==="__esModule"||C in t&&t[C]===x[C]||Object.defineProperty(t,C,{enumerable:!0,get:function(){return x[C]}})});var T=tv;Object.keys(T).forEach(function(C){C==="default"||C==="__esModule"||C in t&&t[C]===T[C]||Object.defineProperty(t,C,{enumerable:!0,get:function(){return T[C]}})});var I=rv;Object.keys(I).forEach(function(C){C==="default"||C==="__esModule"||C in t&&t[C]===I[C]||Object.defineProperty(t,C,{enumerable:!0,get:function(){return I[C]}})})})(Fn);function Xfe(t,e){if(t==null)return{};var r,n,i=p7(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}var mi=function(t){return t.DisplayName="User.displayName",t.AvatarUrl="User.avatarUrl",t.Presence="User.presence",t.CurrentlyActive="User.currentlyActive",t.LastPresenceTs="User.lastPresenceTs",t}({});class Zo extends nr{constructor(e){super(),this.userId=e,E(this,"modified",-1),E(this,"displayName",void 0),E(this,"rawDisplayName",void 0),E(this,"avatarUrl",void 0),E(this,"presenceStatusMsg",void 0),E(this,"presence","offline"),E(this,"lastActiveAgo",0),E(this,"lastPresenceTs",0),E(this,"currentlyActive",!1),E(this,"events",{}),this.displayName=e,this.rawDisplayName=e,this.updateModifiedTime()}static createUser(e,r){var n=new Zo(e);return r.reEmitter.reEmit(n,[mi.AvatarUrl,mi.DisplayName,mi.Presence,mi.CurrentlyActive,mi.LastPresenceTs]),n}setPresenceEvent(e){if(e.getType()==="m.presence"){var r=this.events.presence===null;this.events.presence=e;var n=[];(e.getContent().presence!==this.presence||r)&&n.push(mi.Presence),e.getContent().avatar_url&&e.getContent().avatar_url!==this.avatarUrl&&n.push(mi.AvatarUrl),e.getContent().displayname&&e.getContent().displayname!==this.displayName&&n.push(mi.DisplayName),e.getContent().currently_active!==void 0&&e.getContent().currently_active!==this.currentlyActive&&n.push(mi.CurrentlyActive),this.presence=e.getContent().presence,n.push(mi.LastPresenceTs),e.getContent().status_msg&&(this.presenceStatusMsg=e.getContent().status_msg),e.getContent().displayname&&(this.displayName=e.getContent().displayname),e.getContent().avatar_url&&(this.avatarUrl=e.getContent().avatar_url),this.lastActiveAgo=e.getContent().last_active_ago,this.lastPresenceTs=Date.now(),this.currentlyActive=e.getContent().currently_active,this.updateModifiedTime();for(var i of n)this.emit(i,e,this)}}setDisplayName(e){var r=this.displayName;this.displayName=e,e!==r&&this.updateModifiedTime()}setRawDisplayName(e){this.rawDisplayName=e}setAvatarUrl(e){var r=this.avatarUrl;this.avatarUrl=e,e!==r&&this.updateModifiedTime()}updateModifiedTime(){this.modified=Date.now()}getLastModifiedTime(){return this.modified}getLastActiveTs(){return this.lastPresenceTs-this.lastActiveAgo}}var st=function(t){return t.Backward="b",t.Forward="f",t}({});class Be{static setEventMetadata(e,r,n){e.setMetadata(r,n)}constructor(e){var r,n;this.eventTimelineSet=e,E(this,"roomId",void 0),E(this,"name",void 0),E(this,"events",[]),E(this,"baseIndex",0),E(this,"startState",void 0),E(this,"endState",void 0),E(this,"startToken",null),E(this,"endToken",null),E(this,"prevTimeline",null),E(this,"nextTimeline",null),E(this,"paginationRequests",{[st.Backward]:null,[st.Forward]:null}),this.roomId=(r=(n=e.room)===null||n===void 0?void 0:n.roomId)!==null&&r!==void 0?r:null,this.roomId&&(this.startState=new cm(this.roomId),this.endState=new cm(this.roomId)),this.paginationRequests={b:null,f:null},this.name=this.roomId+":"+new Date().toISOString()}initialiseState(e){var r,n,{timelineWasEmpty:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(this.events.length>0)throw new Error("Cannot initialise state after events are added");(r=this.startState)===null||r===void 0||r.setStateEvents(e,{timelineWasEmpty:i}),(n=this.endState)===null||n===void 0||n.setStateEvents(e,{timelineWasEmpty:i})}forkLive(e){var r=this.getState(e),n=new Be(this.eventTimelineSet);return n.startState=r==null?void 0:r.clone(),n.endState=r,this.endState=r==null?void 0:r.clone(),n}fork(e){var r=this.getState(e),n=new Be(this.eventTimelineSet);return n.startState=r==null?void 0:r.clone(),n.endState=r==null?void 0:r.clone(),n}getRoomId(){return this.roomId}getFilter(){return this.eventTimelineSet.getFilter()}getTimelineSet(){return this.eventTimelineSet}getBaseIndex(){return this.baseIndex}getEvents(){return this.events}getState(e){if(e==Be.BACKWARDS)return this.startState;if(e==Be.FORWARDS)return this.endState;throw new Error("Invalid direction '"+e+"'")}getPaginationToken(e){return this.roomId?this.getState(e).paginationToken:e===st.Backward?this.startToken:this.endToken}setPaginationToken(e,r){this.roomId?this.getState(r).paginationToken=e:r===st.Backward?this.startToken=e:this.endToken=e}getNeighbouringTimeline(e){if(e==Be.BACKWARDS)return this.prevTimeline;if(e==Be.FORWARDS)return this.nextTimeline;throw new Error("Invalid direction '"+e+"'")}setNeighbouringTimeline(e,r){if(this.getNeighbouringTimeline(r))throw new Error("timeline already has a neighbouring timeline - cannot reset neighbour (direction: "+r+")");if(r==Be.BACKWARDS)this.prevTimeline=e;else if(r==Be.FORWARDS)this.nextTimeline=e;else throw new Error("Invalid direction '"+r+"'");this.setPaginationToken(null,r)}addEvent(e,r){var{toStartOfTimeline:n,roomState:i,timelineWasEmpty:a,addToState:o}=r;i||(i=n?this.startState:this.endState);var s=this.getTimelineSet();if(s.room&&(Be.setEventMetadata(e,i,n),o&&e.isState()&&s.room.getUnfilteredTimelineSet()===s)){var l;(l=i)===null||l===void 0||l.setStateEvents([e],{timelineWasEmpty:a}),(!e.sender||e.getType()===ge.RoomMember&&!n)&&Be.setEventMetadata(e,i,n)}var c;n?c=0:c=this.events.length,this.events.splice(c,0,e),n&&this.baseIndex++}insertEvent(e,r,n,i){var a=this.getTimelineSet();a.room&&(Be.setEventMetadata(e,n,!1),i&&e.isState()&&a.room.getUnfilteredTimelineSet()===a&&(n.setStateEvents([e],{}),(!e.sender||e.getType()===ge.RoomMember)&&Be.setEventMetadata(e,n,!1))),this.events.splice(r,0,e)}removeEvent(e){for(var r=this.events.length-1;r>=0;r--){var n=this.events[r];if(n.getId()==e)return this.events.splice(r,1),r<this.baseIndex&&this.baseIndex--,n}return null}toString(){return this.name}}E(Be,"BACKWARDS",st.Backward);E(Be,"FORWARDS",st.Forward);var ry=function(t){return t.Add="Relations.add",t.Remove="Relations.remove",t.Redaction="Relations.redaction",t}({}),Qfe=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];return[r,...n].includes(e)};class q4 extends nr{constructor(e,r,n,i){var a;super(),a=this,this.relationType=e,this.eventType=r,this.altEventTypes=i,E(this,"relationEventIds",new Set),E(this,"relations",new Set),E(this,"annotationsByKey",{}),E(this,"annotationsBySender",{}),E(this,"sortedAnnotationsByKey",[]),E(this,"targetEvent",null),E(this,"creationEmitted",!1),E(this,"client",void 0),E(this,"onEventStatus",(o,s)=>{if(!o.isSending()){o.removeListener(At.Status,this.onEventStatus);return}s===Ze.CANCELLED&&(o.removeListener(At.Status,this.onEventStatus),this.removeEvent(o))}),E(this,"onBeforeRedaction",function(){var o=K(function*(s){if(a.relations.has(s)){if(a.relations.delete(s),a.relationType===gr.Annotation)a.removeAnnotationFromAggregation(s);else if(a.relationType===gr.Replace&&a.targetEvent&&!a.targetEvent.isState()){var l=yield a.getLastReplacement();a.targetEvent.makeReplaced(l)}s.removeListener(At.BeforeRedaction,a.onBeforeRedaction),a.emit(ry.Redaction,s)}});return function(s){return o.apply(this,arguments)}}()),this.client=n instanceof Xb?n.client:n}addEvent(e){var r=this;return K(function*(){if(!r.relationEventIds.has(e.getId())){var n=e.getRelation();if(!n){U.error("Event must have relation info");return}var i=n.rel_type,a=e.getType();if(r.relationType!==i||!Qfe(a,r.eventType,r.altEventTypes)){U.error("Event relation info doesn't match this container");return}if(e.isSending()&&e.on(At.Status,r.onEventStatus),r.relations.add(e),r.relationEventIds.add(e.getId()),r.relationType===gr.Annotation)r.addAnnotationToAggregation(e);else if(r.relationType===gr.Replace&&r.targetEvent&&!r.targetEvent.isState()){var o=yield r.getLastReplacement();r.targetEvent.makeReplaced(o)}e.on(At.BeforeRedaction,r.onBeforeRedaction),r.emit(ry.Add,e),r.maybeEmitCreated()}})()}removeEvent(e){var r=this;return K(function*(){if(r.relations.has(e)){if(r.relations.delete(e),r.relationType===gr.Annotation)r.removeAnnotationFromAggregation(e);else if(r.relationType===gr.Replace&&r.targetEvent&&!r.targetEvent.isState()){var n=yield r.getLastReplacement();r.targetEvent.makeReplaced(n)}r.emit(ry.Remove,e)}})()}getRelations(){return[...this.relations]}addAnnotationToAggregation(e){var r,{key:n}=(r=e.getRelation())!==null&&r!==void 0?r:{};if(n){var i=this.annotationsByKey[n];i||(i=this.annotationsByKey[n]=new Set,this.sortedAnnotationsByKey.push([n,i])),i.add(e),this.sortedAnnotationsByKey.sort((s,l)=>{var c=s[1],d=l[1];return d.size-c.size});var a=e.getSender(),o=this.annotationsBySender[a];o||(o=this.annotationsBySender[a]=new Set),o.add(e)}}removeAnnotationFromAggregation(e){var r,{key:n}=(r=e.getRelation())!==null&&r!==void 0?r:{};if(n){var i=this.annotationsByKey[n];i&&(i.delete(e),this.sortedAnnotationsByKey.sort((s,l)=>{var c=s[1],d=l[1];return d.size-c.size}));var a=e.getSender(),o=this.annotationsBySender[a];o&&o.delete(e)}}getSortedAnnotationsByKey(){return this.relationType!==gr.Annotation?null:this.sortedAnnotationsByKey}getAnnotationsBySender(){return this.relationType!==gr.Annotation?null:this.annotationsBySender}getLastReplacement(){var e=this;return K(function*(){if(e.relationType!==gr.Replace||!e.targetEvent)return null;var r=e.targetEvent.getServerAggregatedRelation(gr.Replace),n=r==null?void 0:r.origin_server_ts,i=e.getRelations().reduce((a,o)=>o.getSender()!==e.targetEvent.getSender()||n&&n>o.getTs()||a&&a.getTs()>o.getTs()?a:o,null);return i!=null&&i.shouldAttemptDecryption()&&e.client.getCrypto()?yield i.attemptDecryption(e.client.getCrypto()):i!=null&&i.isBeingDecrypted()&&(yield i.getDecryptionPromise()),i})()}setTargetEvent(e){var r=this;return K(function*(){if(!r.targetEvent){if(r.targetEvent=e,r.relationType===gr.Replace&&!r.targetEvent.isState()){var n=yield r.getLastReplacement();n&&r.targetEvent.makeReplaced(n)}r.maybeEmitCreated()}})()}maybeEmitCreated(){this.creationEmitted||!this.targetEvent||!this.relations.size||(this.creationEmitted=!0,this.targetEvent.emit(At.RelationsCreated,this.relationType,this.eventType))}}class Jj{constructor(e,r){this.client=e,this.room=r,E(this,"relations",new Map)}getChildEventsForEvent(e,r,n){var i;return(i=this.relations.get(e))===null||i===void 0||(i=i.get(r))===null||i===void 0?void 0:i.get(n)}getAllChildEventsForEvent(e){var r,n=(r=this.relations.get(e))!==null&&r!==void 0?r:new Map,i=[];for(var a of n.values())for(var o of a.values())i.push(...o.getRelations());return i}aggregateParentEvent(e){var r=this.relations.get(e.getId());if(r)for(var n of r.values())for(var i of n.values())i.setTargetEvent(e)}aggregateChildEvent(e,r){if(!(e.isRedacted()||e.status===Ze.CANCELLED)){var n=e.getRelation();if(n){var i=()=>{if(e.isDecryptionFailure()){e.once(At.Decrypted,i);return}this.aggregateChildEvent(e,r)};if(e.isBeingDecrypted()||e.shouldAttemptDecryption()){e.once(At.Decrypted,i);return}var{event_id:a,rel_type:o}=n,s=e.getType(),l=this.relations.get(a);l||(l=new Map,this.relations.set(a,l));var c=l.get(o);c||(c=new Map,l.set(o,c));var d=c.get(s);if(!d){var h,p,m;d=new q4(o,s,this.client),c.set(s,d);var g=(h=this.room)!==null&&h!==void 0?h:r==null?void 0:r.room,y=(p=(m=r==null?void 0:r.findEventById(a))!==null&&m!==void 0?m:g==null?void 0:g.findEventById(a))!==null&&p!==void 0?p:g==null?void 0:g.getPendingEvent(a);y&&d.setTargetEvent(y)}d.addEvent(e)}}}}var Lc;Lc=U.log.bind(U);var fp=function(t){return t.Ignore="ignore",t.Replace="replace",t}({});class Qc extends nr{constructor(e){var r,n,i,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0,l=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null;super(),this.room=e,this.thread=s,this.threadListType=l,E(this,"relations",void 0),E(this,"timelineSupport",void 0),E(this,"displayPendingEvents",void 0),E(this,"liveTimeline",void 0),E(this,"timelines",void 0),E(this,"_eventIdToTimeline",new Map),E(this,"filter",void 0),this.timelineSupport=!!a.timelineSupport,this.liveTimeline=new Be(this),this.displayPendingEvents=a.pendingEvents!==!1,this.timelines=[this.liveTimeline],this._eventIdToTimeline=new Map,this.filter=a.filter,this.relations=(r=(n=this.room)===null||n===void 0?void 0:n.relations)!==null&&r!==void 0?r:new Jj((i=e==null?void 0:e.client)!==null&&i!==void 0?i:o)}getTimelines(){return this.timelines}getFilter(){return this.filter}setFilter(e){this.filter=e}getPendingEvents(){return!this.room||!this.displayPendingEvents?[]:this.room.getPendingEvents()}getLiveTimeline(){return this.liveTimeline}setLiveTimeline(e){this.liveTimeline=e}eventIdToTimeline(e){return this._eventIdToTimeline.get(e)}replaceEventId(e,r){var n=this._eventIdToTimeline.get(e);n&&(this._eventIdToTimeline.delete(e),this._eventIdToTimeline.set(r,n))}resetLiveTimeline(e,r){var n=!this.timelineSupport||!r,i=this.liveTimeline,a=n?i.forkLive(Be.FORWARDS):i.fork(Be.FORWARDS);n?(this.timelines=[a],this._eventIdToTimeline=new Map):this.timelines.push(a),r&&i.setPaginationToken(r,Be.FORWARDS),a.setPaginationToken(e??null,Be.BACKWARDS),this.liveTimeline=a,this.emit(Ue.TimelineReset,this.room,this,n)}getTimelineForEvent(e){if(e==null)return null;var r=this._eventIdToTimeline.get(e);return r===void 0?null:r}findEventById(e){var r=this.getTimelineForEvent(e);if(r)return r.getEvents().find(function(n){return n.getId()==e})}addTimeline(){if(!this.timelineSupport)throw new Error("timeline support is disabled. Set the 'timelineSupport' parameter to true when creating MatrixClient to enable it.");var e=new Be(this);return this.timelines.push(e),e}addEventsToTimeline(e,r,n,i,a){if(!i)throw new Error("'timeline' not specified for EventTimelineSet.addEventsToTimeline");if(!r&&i==this.liveTimeline)throw new Error("EventTimelineSet.addEventsToTimeline cannot be used for adding events to the live timeline - use Room.addLiveEvents instead");if(!(this.filter&&(e=this.filter.filterRoomTimeline(e),!e.length))){var o=r?Be.BACKWARDS:Be.FORWARDS,s=r?Be.FORWARDS:Be.BACKWARDS,l=!1,c=!1;for(var d of e){var h=d.getId(),p=this._eventIdToTimeline.get(h);if(!p){this.addEventToTimeline(d,i,{toStartOfTimeline:r,addToState:n}),c=!0,l=!0;continue}if(c=!1,p==i){Lc("Event "+h+" already in timeline "+i);continue}var m=i.getNeighbouringTimeline(o);if(m){p==m?Lc("Event "+h+" in neighbouring timeline - switching to "+p):Lc("Event "+h+" already in a different timeline "+p),i=p;continue}U.info("Already have timeline for "+h+" - joining timeline "+i+" to "+p);var g=p===this.liveTimeline,y=i===this.liveTimeline,R=o===Be.BACKWARDS&&g,b=o===Be.FORWARDS&&y;if(R||b){R&&U.warn("Refusing to set a preceding existingTimeLine on our timeline as the existingTimeLine is live ("+p+")"),b&&U.warn("Refusing to set our preceding timeline on a existingTimeLine as our timeline is live ("+i+")");continue}i.setNeighbouringTimeline(p,o),p.setNeighbouringTimeline(i,s),i=p,l=!0}if(c||!l){if(o===Be.FORWARDS&&i===this.liveTimeline){U.warn({lastEventWasNew:c,didUpdate:l}),U.warn("Refusing to set forwards pagination token of live timeline "+"".concat(i," to ").concat(a));return}i.setPaginationToken(a??null,o)}}}addLiveEvent(e,r){var{duplicateStrategy:n,fromCache:i,roomState:a,timelineWasEmpty:o,addToState:s}=r;if(this.filter){var l=this.filter.filterRoomTimeline([e]);if(!l.length)return}var c=this._eventIdToTimeline.get(e.getId());if(c){if(n===fp.Replace){Lc("EventTimelineSet.addLiveEvent: replacing duplicate event "+e.getId());for(var d=c.getEvents(),h=0;h<d.length;h++)if(d[h].getId()===e.getId()){a||(a=c.getState(Be.FORWARDS)),Be.setEventMetadata(e,a,!1),d[h]=e;break}}else Lc("EventTimelineSet.addLiveEvent: ignoring duplicate event "+e.getId());return}this.addEventToTimeline(e,this.liveTimeline,{toStartOfTimeline:!1,fromCache:i,roomState:a,timelineWasEmpty:o,addToState:s})}addEventToTimeline(e,r,n){var{toStartOfTimeline:i,fromCache:a=!1,roomState:o,timelineWasEmpty:s,addToState:l}=n;if(r.getTimelineSet()!==this){var c;throw new Error("EventTimelineSet.addEventToTimeline: Timeline=".concat(r.toString(),` does not belong " +
                "in timelineSet(threadId=`).concat((c=this.thread)===null||c===void 0?void 0:c.id,")"))}var d=e.getId();if(this.relations.aggregateParentEvent(e),this.relations.aggregateChildEvent(e,this),this.room&&!this.canContain(e)){var h,p="event=".concat(d);e.threadRootId&&(p+="(belongs to thread=".concat(e.threadRootId,")")),U.warn("EventTimelineSet.addEventToTimeline: Ignoring ".concat(p," that does not belong ")+"in timeline=".concat(r.toString()," timelineSet(threadId=").concat((h=this.thread)===null||h===void 0?void 0:h.id,")"));return}r.addEvent(e,{toStartOfTimeline:i,roomState:o,timelineWasEmpty:s,addToState:l}),this._eventIdToTimeline.set(d,r);var m={timeline:r,liveEvent:!i&&r==this.liveTimeline&&!a};this.emit(Ue.Timeline,e,this.room,!!i,!1,m)}insertEventIntoTimeline(e,r,n,i){if(r.getTimelineSet()!==this){var a;throw new Error("EventTimelineSet.insertEventIntoTimeline: Timeline=".concat(r.toString(),` does not belong " +
                "in timelineSet(threadId=`).concat((a=this.thread)===null||a===void 0?void 0:a.id,")"))}var o=e.getId();if(this.relations.aggregateParentEvent(e),this.relations.aggregateChildEvent(e,this),this.room&&!this.canContain(e)){var s,l="event=".concat(o);e.threadRootId&&(l+="(belongs to thread=".concat(e.threadRootId,")")),U.warn("EventTimelineSet.insertEventIntoTimeline: Ignoring ".concat(l," that does not belong ")+"in timeline=".concat(r.toString()," timelineSet(threadId=").concat((s=this.thread)===null||s===void 0?void 0:s.id,")"));return}var c=e.relationEventId;if(!c){this.addEventToTimeline(e,r,{toStartOfTimeline:!1,fromCache:!1,timelineWasEmpty:!1,roomState:n,addToState:i});return}for(var d=this.findEventById(c),h=r.getEvents(),p=d!==void 0?h.indexOf(d):0,m=p;m<h.length;m++){var g=h[m];if(g.getTs()>e.getTs())break}r.insertEvent(e,m,n,i),this._eventIdToTimeline.set(o,r);var y={timeline:r,liveEvent:!1};this.emit(Ue.Timeline,e,this.room,!1,!1,y)}handleRemoteEcho(e,r,n){var i=this._eventIdToTimeline.get(r);i?(this._eventIdToTimeline.delete(r),this._eventIdToTimeline.set(n,i)):(!this.filter||this.filter.filterRoomTimeline([e]).length)&&this.addEventToTimeline(e,this.liveTimeline,{toStartOfTimeline:!1,addToState:!1})}removeEvent(e){var r=this._eventIdToTimeline.get(e);if(!r)return null;var n=r.removeEvent(e);if(n){this._eventIdToTimeline.delete(e);var i={timeline:r};this.emit(Ue.Timeline,n,this.room,void 0,!0,i)}return n}compareEventOrdering(e,r){if(e==r)return 0;var n=this._eventIdToTimeline.get(e),i=this._eventIdToTimeline.get(r);if(n===void 0||i===void 0)return null;if(n===i){for(var a=void 0,o=void 0,s=n.getEvents(),l=0;l<s.length&&(a===void 0||o===void 0);l++){var c=s[l].getId();c==e&&(a=l),c==r&&(o=l)}var d=a-o;return d<0?-1:d>0?1:0}for(var h=n;h;){if(h===i)return-1;h=h.getNeighbouringTimeline(Be.FORWARDS)}for(h=n;h;){if(h===i)return 1;h=h.getNeighbouringTimeline(Be.BACKWARDS)}return null}canContain(e){if(!this.room)throw new Error("Cannot call `EventTimelineSet::canContain without a `room` set. Set the room when creating the EventTimelineSet to call this method.");var{threadId:r,shouldLiveInRoom:n,shouldLiveInThread:i}=this.room.eventShouldLiveIn(e);if(this.thread)return this.thread.id===r;if(!n&&!i){var a;U.warn("EventTimelineSet:canContain event encountered which cannot be added to any timeline roomId=".concat((a=this.room)===null||a===void 0?void 0:a.roomId," eventId=").concat(e.getId()," threadId=").concat(e.threadRootId))}return n}}var Ze=function(t){return t.NOT_SENT="not_sent",t.ENCRYPTING="encrypting",t.SENDING="sending",t.QUEUED="queued",t.SENT="sent",t.CANCELLED="cancelled",t}({});class Xj{constructor(e,r){this.roomId=e}}class Qj{constructor(e){this.target=e,E(this,"reEmitters",new WeakMap)}reEmit(e,r){var n=this,i=this.reEmitters.get(e);i||(i=new Map,this.reEmitters.set(e,i));var a=function(l){if(i.has(l))return 1;var c=function(){if(!(l==="error"&&n.target.listenerCount("error")===0)){for(var h=arguments.length,p=new Array(h),m=0;m<h;m++)p[m]=arguments[m];n.target.emit(l,...p,e)}};e.on(l,c),i.set(l,c)};for(var o of r)a(o)}stopReEmitting(e,r){var n=this.reEmitters.get(e);if(n){for(var i of r)e.off(i,n.get(i)),n.delete(i);n.size===0&&this.reEmitters.delete(e)}}}class kf extends Qj{constructor(e){super(e)}reEmit(e,r){super.reEmit(e,r)}stopReEmitting(e,r){super.stopReEmitting(e,r)}}var im=new Vb("unread_thread_notifications","org.matrix.msc3773.unread_thread_notifications");function ehe(t,e){if(e.endsWith("*")){var r=e.slice(0,-1);return t.slice(0,r.length)===r}else return t===e}class AA{constructor(e,r){this.filterJson=e,this.userId=r}check(e){var r,n,i=((r=e.getUnsigned())===null||r===void 0?void 0:r["m.relations"])||{},a=Object.keys(i),o=[];return this.userId&&i!==null&&i!==void 0&&(n=i[jt.name])!==null&&n!==void 0&&n.current_user_participated&&o.push(this.userId),this.checkFields(e.getRoomId(),e.getSender(),e.getType(),e.getContent()?e.getContent().url!==void 0:!1,a,o)}toJSON(){return{types:this.filterJson.types||null,not_types:this.filterJson.not_types||[],rooms:this.filterJson.rooms||null,not_rooms:this.filterJson.not_rooms||[],senders:this.filterJson.senders||null,not_senders:this.filterJson.not_senders||[],contains_url:this.filterJson.contains_url||null,[Rd.name]:this.filterJson[Rd.name]||[],[Md.name]:this.filterJson[Md.name]||[]}}checkFields(e,r,n,i,a,o){var s={rooms:function(b){return e===b},senders:function(b){return r===b},types:function(b){return ehe(n,b)}};for(var l in s){var c=s[l],d="not_"+l,h=this.filterJson[d];if(h!=null&&h.some(c))return!1;var p=this.filterJson[l];if(p&&!p.some(c))return!1}var m=this.filterJson.contains_url;if(m!==void 0&&m!==i)return!1;var g=this.filterJson[Md.name];if(g!==void 0&&!this.arrayMatchesFilter(g,a))return!1;var y=this.filterJson[Rd.name];return!(y!==void 0&&!this.arrayMatchesFilter(y,o))}arrayMatchesFilter(e,r){return r.length>0&&e.every(n=>r.includes(n))}filter(e){return e.filter(this.check,this)}limit(){return this.filterJson.limit!==void 0?this.filterJson.limit:10}}function kA(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function _c(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?kA(Object(r),!0).forEach(function(n){E(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):kA(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Tw(t,e,r){for(var n=e.split("."),i=t,a=0;a<n.length-1;a++)i[n[a]]||(i[n[a]]={}),i=i[n[a]];i[n[n.length-1]]=r}class Yn{static fromJson(e,r,n){var i=new Yn(e,r);return i.setDefinition(n),i}constructor(e,r){this.userId=e,this.filterId=r,E(this,"definition",{}),E(this,"roomFilter",void 0),E(this,"roomTimelineFilter",void 0)}getFilterId(){return this.filterId}getDefinition(){return this.definition}setDefinition(e){this.definition=e;var r=e.room,n={};r&&(r.rooms&&(n.rooms=r.rooms),r.rooms&&(n.not_rooms=r.not_rooms)),this.roomFilter=new AA(n,this.userId),this.roomTimelineFilter=new AA((r==null?void 0:r.timeline)||{},this.userId)}getRoomTimelineFilterComponent(){return this.roomTimelineFilter}filterRoomTimeline(e){return this.roomFilter&&(e=this.roomFilter.filter(e)),this.roomTimelineFilter&&(e=this.roomTimelineFilter.filter(e)),e}setTimelineLimit(e){Tw(this.definition,"room.timeline.limit",e)}setUnreadThreadNotifications(e){var r,n;this.definition=_c(_c({},this.definition),{},{room:_c(_c({},(r=this.definition)===null||r===void 0?void 0:r.room),{},{timeline:_c(_c({},(n=this.definition)===null||n===void 0||(n=n.room)===null||n===void 0?void 0:n.timeline),{},{[im.name]:e})})})}setLazyLoadMembers(e){Tw(this.definition,"room.state.lazy_load_members",e)}setIncludeLeaveRooms(e){Tw(this.definition,"room.include_leave",e)}}E(Yn,"LAZY_LOADING_MESSAGES_FILTER",{lazy_load_members:!0});function k0(t){return t!=null}var the=new Fn.UnstableValue("m.message","org.matrix.msc1767.message"),Z4=new Fn.UnstableValue("m.text","org.matrix.msc1767.text"),rhe=new Fn.UnstableValue("m.html","org.matrix.msc1767.html"),eV=new Fn.NamespacedValue("m.reference");function nhe(t,e){if(typeof t=="string")return typeof e=="string"?e===t:e.matches(t);if(typeof e=="string")return t.matches(e);var r=e,n=t;return r.matches(n.name)||k0(n.altName)&&r.matches(n.altName)}var Y4=new Wm("m.topic");function OA(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function ihe(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?OA(Object(r),!0).forEach(function(n){E(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):OA(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function tV(t,e){return{msgtype:Ma.Text,format:"org.matrix.custom.html",body:t,formatted_body:e}}function rV(t,e){return{msgtype:Ma.Notice,format:"org.matrix.custom.html",body:t,formatted_body:e}}function nV(t,e){return{msgtype:Ma.Emote,format:"org.matrix.custom.html",body:t,formatted_body:e}}function iV(t){return{msgtype:Ma.Text,body:t}}function aV(t){return{msgtype:Ma.Notice,body:t}}function oV(t){return{msgtype:Ma.Emote,body:t}}var sV=(t,e,r,n)=>{var i="at ".concat(new Date(r).toISOString()),a=e===Qd.Self?"User":void 0,o=n?'"'.concat(n,'"'):void 0;return[a,"Location",o,t,i].filter(Boolean).join(" ")},lV=(t,e,r,n,i)=>{var a=t??sV(e,i||Qd.Self,r,n),o=r?{[xl.name]:r}:{};return ihe({msgtype:Ma.Location,body:a,geo_uri:e,[qm.name]:{description:n,uri:e},[Gm.name]:{type:i||Qd.Self},[Z4.name]:a},o)},ahe=t=>{var e,r,n=qm.findIn(t),i=Gm.findIn(t),a=xl.findIn(t),o=Z4.findIn(t),s=(e=n==null?void 0:n.uri)!==null&&e!==void 0?e:t==null?void 0:t.geo_uri,l=n==null?void 0:n.description,c=(r=i==null?void 0:i.type)!==null&&r!==void 0?r:Qd.Self,d=o??t.body;return lV(d,s,a??void 0,l,c)},uV=(t,e)=>{var r=[];return k0(e)&&r.push({body:e,mimetype:"text/html"}),k0(t)&&r.push({body:t,mimetype:"text/plain"}),{topic:t,[Y4.name]:r}},ohe=t=>{var e,r,n,i,a=Y4.findIn(t);if(!Array.isArray(a)){var o;return{text:(o=t.topic)!==null&&o!==void 0?o:void 0}}var s=(e=(r=a==null||(n=a.find(c=>!k0(c.mimetype)||c.mimetype==="text/plain"))===null||n===void 0?void 0:n.body)!==null&&r!==void 0?r:t.topic)!==null&&e!==void 0?e:void 0,l=a==null||(i=a.find(c=>c.mimetype==="text/html"))===null||i===void 0?void 0:i.body;return{text:s,html:l}},she=(t,e,r,n,i)=>({description:r,timeout:t,live:e,[xl.name]:i||Date.now(),[Gm.name]:{type:n??Qd.Self}}),cV=t=>{var e,{description:r,timeout:n,live:i}=t,a=(e=xl.findIn(t))!==null&&e!==void 0?e:void 0,o=Gm.findIn(t);return{description:r,timeout:n,live:i,assetType:o==null?void 0:o.type,timestamp:a}},lhe=(t,e,r,n)=>({[qm.name]:{description:n,uri:t},[xl.name]:e,"m.relates_to":{rel_type:eV.name,event_id:r}}),Ox=t=>{var e,r=qm.findIn(t),n=(e=xl.findIn(t))!==null&&e!==void 0?e:void 0;return{description:r==null?void 0:r.description,uri:r==null?void 0:r.uri,timestamp:n}};const uhe=Object.freeze(Object.defineProperty({__proto__:null,getTextForLocationEvent:sV,makeBeaconContent:lhe,makeBeaconInfoContent:she,makeEmoteMessage:oV,makeHtmlEmote:nV,makeHtmlMessage:tV,makeHtmlNotice:rV,makeLocationContent:lV,makeNotice:aV,makeTextMessage:iV,makeTopicContent:uV,parseBeaconContent:Ox,parseBeaconInfoContent:cV,parseLocationEvent:ahe,parseTopicContent:ohe},Symbol.toStringTag,{value:"Module"}));var er=function(t){return t.New="Beacon.new",t.Update="Beacon.update",t.LivenessChange="Beacon.LivenessChange",t.Destroy="Beacon.Destroy",t.LocationUpdate="Beacon.LocationUpdate",t}({}),$x=(t,e,r)=>r>=t&&t+e>=r,O0=t=>"".concat(t.getRoomId(),"_").concat(t.getStateKey());class dV extends nr{constructor(e){super(),this.rootEvent=e,E(this,"roomId",void 0),E(this,"_beaconInfo",void 0),E(this,"_isLive",void 0),E(this,"livenessWatchTimeout",void 0),E(this,"_latestLocationEvent",void 0),E(this,"clearLatestLocation",()=>{this._latestLocationEvent=void 0,this.emit(er.LocationUpdate,this.latestLocationState)}),this.roomId=this.rootEvent.getRoomId(),this.setBeaconInfo(this.rootEvent)}get isLive(){return!!this._isLive}get identifier(){return O0(this.rootEvent)}get beaconInfoId(){return this.rootEvent.getId()}get beaconInfoOwner(){return this.rootEvent.getStateKey()}get beaconInfoEventType(){return this.rootEvent.getType()}get beaconInfo(){return this._beaconInfo}get latestLocationState(){return this._latestLocationEvent&&Ox(this._latestLocationEvent.getContent())}get latestLocationEvent(){return this._latestLocationEvent}update(e){if(O0(e)!==this.identifier)throw new Error("Invalid updating event");e.getTs()<this.rootEvent.getTs()||(this.rootEvent=e,this.setBeaconInfo(this.rootEvent),this.emit(er.Update,e,this),this.clearLatestLocation())}destroy(){this.livenessWatchTimeout&&clearTimeout(this.livenessWatchTimeout),this._isLive=!1,this.emit(er.Destroy,this.identifier)}monitorLiveness(){if(this.livenessWatchTimeout&&clearTimeout(this.livenessWatchTimeout),this.checkLiveness(),!!this.beaconInfo)if(this.isLive){var e=this.beaconInfo.timestamp+this.beaconInfo.timeout-Date.now();e>1&&(this.livenessWatchTimeout=setTimeout(()=>{this.monitorLiveness()},e))}else this.beaconInfo.timestamp>Date.now()&&(this.livenessWatchTimeout=setTimeout(()=>{this.monitorLiveness()},this.beaconInfo.timestamp-Date.now()))}addLocations(e){var r;if(this.isLive){var n=e.filter(a=>{var o=a.getContent(),s=Ox(o);if(!s.uri||!s.timestamp)return!1;var{timestamp:l}=s;return this._beaconInfo.timestamp&&$x(this._beaconInfo.timestamp,this._beaconInfo.timeout,l)&&(!this.latestLocationState||l>this.latestLocationState.timestamp)}),i=(r=n.sort(pce))===null||r===void 0?void 0:r[0];i&&(this._latestLocationEvent=i,this.emit(er.LocationUpdate,this.latestLocationState))}}setBeaconInfo(e){this._beaconInfo=cV(e.getContent()),this.checkLiveness()}checkLiveness(){var e=this.isLive;if(this.beaconInfo){var r=this.beaconInfo.timestamp>Date.now()?this.beaconInfo.timestamp-36e4:this.beaconInfo.timestamp;this._isLive=!!this._beaconInfo.live&&!!r&&$x(r,this._beaconInfo.timeout,Date.now()),e!==this.isLive&&this.emit(er.LivenessChange,this.isLive,this)}}}function $A(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function che(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?$A(Object(r),!0).forEach(function(n){E(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):$A(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function fV(t,e,r){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;return new Bn({content:{[e.getId()]:{[r]:{[t]:che({ts:e.getTs()},!n&&{thread_id:lf(e)})}}},type:ge.Receipt,room_id:e.getRoomId()})}var Sc=0,wc=1;class hV extends nr{constructor(){super(...arguments),E(this,"receipts",new qo(()=>new Map)),E(this,"receiptCacheByEventId",new Map)}getReadReceiptForUserId(e){var r,n,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:In.Read,[o,s]=(r=(n=this.receipts.get(a))===null||n===void 0?void 0:n.get(e))!==null&&r!==void 0?r:[null,null];return i?o:s??o}compareReceipts(e,r){var n;return(n=this.getUnfilteredTimelineSet().compareEventOrdering(e.eventId,r.eventId))!==null&&n!==void 0?n:e.data.ts-r.data.ts}getEventReadUpTo(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=this.getLatestReceipt(e,r);return n&&this.receiptPointsAtConsistentEvent(n)?n.eventId:null}receiptPointsAtConsistentEvent(e){var r,n=this.findEventById(e.eventId);if(!n)return!1;if(!((r=e.data)!==null&&r!==void 0&&r.thread_id))return!0;if(e.data.thread_id===Zm){var i=um(n);if(i)return!0}else if(n.threadRootId===e.data.thread_id)return!0;return U.warn("Ignoring receipt because its thread_id (".concat(e.data.thread_id,") disagrees ")+"with the thread root (".concat(n.threadRootId,") of the referenced event ")+"(event ID = ".concat(e.eventId,")")),!1}getLatestReceipt(e,r){var n,i,a=this.getReadReceiptForUserId(e,r,In.Read),o=this.getReadReceiptForUserId(e,r,In.ReadPrivate),s;return a!=null&&a.eventId&&o!==null&&o!==void 0&&o.eventId&&(s=this.compareReceipts(a,o)),s?(i=s<0?o:a)!==null&&i!==void 0?i:null:(n=o??a)!==null&&n!==void 0?n:null}addReceiptToStructure(e,r,n,i,a){var o,s,l=this.receipts.getOrCreate(r),c=l.get(n);c||(c=[null,null],l.set(n,c));var d=c[Sc];if(a){var h;d=(h=c[wc])!==null&&h!==void 0?h:c[Sc]}var p={eventId:e,data:i};if(d){var m=this.compareReceipts(d,p);if(m>=0)return}var g=a?c[Sc]:p,y=a?p:c[wc],R=null;g&&y&&(R=this.getUnfilteredTimelineSet().compareEventOrdering(g.eventId,y.eventId));var b=R===null||R<0,_=(o=c[wc])!==null&&o!==void 0?o:c[Sc];a&&b?c[wc]=p:a||(c[Sc]=p,b||(c[wc]=null));var x=(s=c[wc])!==null&&s!==void 0?s:c[Sc];if(_!==x){if(_&&this.receiptCacheByEventId.get(_.eventId)){var T=_.eventId;this.receiptCacheByEventId.set(T,this.receiptCacheByEventId.get(T).filter(I=>I.type!==r||I.userId!==n)),this.receiptCacheByEventId.get(T).length<1&&this.receiptCacheByEventId.delete(T)}this.receiptCacheByEventId.get(e)||this.receiptCacheByEventId.set(e,[]),this.receiptCacheByEventId.get(e).push({userId:n,type:r,data:i})}}getReceiptsForEvent(e){return this.receiptCacheByEventId.get(e.getId())||[]}fixupNotifications(e){var r=this.getReadReceiptForUserId(e,!1),n=this.timeline[this.timeline.length-1];n&&(r==null?void 0:r.eventId)===n.getId()&&e===n.getSender()&&(this.setUnread(It.Total,0),this.setUnread(It.Highlight,0))}addLocalEchoReceipt(e,r,n){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;this.addReceipt(fV(e,r,n,i),!0)}getUsersReadUpTo(e){return this.getReceiptsForEvent(e).filter(function(r){return W4(r.type)}).map(function(r){return r.userId})}}var dhe=new Fn.UnstableValue("m.poll.disclosed","org.matrix.msc3381.poll.disclosed"),fhe=new Fn.UnstableValue("m.poll.undisclosed","org.matrix.msc3381.poll.undisclosed"),hhe=new Fn.UnstableValue("m.poll.start","org.matrix.msc3381.poll.start"),am=new Fn.UnstableValue("m.poll.response","org.matrix.msc3381.poll.response"),$0=new Fn.UnstableValue("m.poll.end","org.matrix.msc3381.poll.end"),As=function(t){return t.New="Poll.new",t.End="Poll.end",t.Update="Poll.update",t.Responses="Poll.Responses",t.Destroy="Poll.Destroy",t.UndecryptableRelations="Poll.UndecryptableRelations",t}({}),LA=(t,e)=>{var r=t.filter(n=>{if(!n.isDecryptionFailure())return am.matches(n.getType())&&n.getTs()<=e});return{responseEvents:r}};class pV extends nr{constructor(e,r,n){if(super(),this.rootEvent=e,this.matrixClient=r,this.room=n,E(this,"roomId",void 0),E(this,"pollEvent",void 0),E(this,"_isFetchingResponses",!1),E(this,"relationsNextBatch",void 0),E(this,"responses",null),E(this,"endEvent",void 0),E(this,"undecryptableRelationEventIds",new Set),E(this,"countUndecryptableEvents",i=>{var a=i.filter(s=>s.isDecryptionFailure()).map(s=>s.getId()),o=this.undecryptableRelationsCount;this.undecryptableRelationEventIds=new Set([...this.undecryptableRelationEventIds,...a]),this.undecryptableRelationsCount!==o&&this.emit(As.UndecryptableRelations,this.undecryptableRelationsCount)}),!this.rootEvent.getRoomId()||!this.rootEvent.getId())throw new Error("Invalid poll start event.");this.roomId=this.rootEvent.getRoomId(),this.pollEvent=this.rootEvent.unstableExtensibleEvent}get pollId(){return this.rootEvent.getId()}get endEventId(){var e;return(e=this.endEvent)===null||e===void 0?void 0:e.getId()}get isEnded(){return!!this.endEvent}get isFetchingResponses(){return this._isFetchingResponses}get undecryptableRelationsCount(){return this.undecryptableRelationEventIds.size}getResponses(){var e=this;return K(function*(){return e.responses||e.isFetchingResponses||(yield e.fetchResponses()),e.responses})()}onNewRelation(e){var r;if($0.matches(e.getType())&&this.validateEndEvent(e)&&(this.endEvent=e,this.refilterResponsesOnEnd(),this.emit(As.End)),!!this.responses){var n=((r=this.endEvent)===null||r===void 0?void 0:r.getTs())||Number.MAX_SAFE_INTEGER,{responseEvents:i}=LA([e],n);this.countUndecryptableEvents([e]),i.length&&(i.forEach(a=>{this.responses.addEvent(a)}),this.emit(As.Responses,this.responses))}}fetchResponses(){var e=this;return K(function*(){var r,n;e._isFetchingResponses=!0;var i=yield e.matrixClient.relations(e.roomId,e.rootEvent.getId(),"m.reference",void 0,{from:e.relationsNextBatch||void 0});yield Promise.all(i.events.map(c=>e.matrixClient.decryptEventIfNeeded(c)));var a=e.responses||new q4("m.reference",am.name,e.matrixClient,[am.altName]),o=i.events.find(c=>$0.matches(c.getType()));e.validateEndEvent(o)&&(e.endEvent=o,e.refilterResponsesOnEnd(),e.emit(As.End));var s=((r=e.endEvent)===null||r===void 0?void 0:r.getTs())||Number.MAX_SAFE_INTEGER,{responseEvents:l}=LA(i.events,s);l.forEach(c=>{a.addEvent(c)}),e.relationsNextBatch=(n=i.nextBatch)!==null&&n!==void 0?n:void 0,e.responses=a,e.countUndecryptableEvents(i.events),e.relationsNextBatch?e.fetchResponses():e._isFetchingResponses=!1,e.emit(As.Responses,e.responses)})()}refilterResponsesOnEnd(){var e;if(this.responses){var r=((e=this.endEvent)===null||e===void 0?void 0:e.getTs())||Number.MAX_SAFE_INTEGER;this.responses.getRelations().forEach(n=>{if(n.getTs()>r){var i;(i=this.responses)===null||i===void 0||i.removeEvent(n)}}),this.emit(As.Responses,this.responses)}}validateEndEvent(e){if(!e||this.endEvent&&this.endEvent.getTs()<e.getTs())return!1;var r=this.room.currentState,n=e.getSender();return!!n&&(n===this.rootEvent.getSender()||r.maySendRedactionForEvent(this.rootEvent,n))}}var mV=t=>{var e=t.getType();return Fn.M_POLL_START.matches(e)||am.matches(e)||$0.matches(e)};class phe{constructor(e){E(this,"room",void 0),E(this,"threadedReceipts",void 0),E(this,"unthreadedReceipts",void 0),E(this,"danglingReceipts",void 0),E(this,"onTimelineEvent",r=>{var n=r.getId();if(n){var i=this.danglingReceipts.remove(n);i==null||i.forEach(a=>{a.receipt.thread_id?this.threadedReceipts.set(a.receipt.thread_id,a.eventId,a.receiptType,a.userId,a.receipt.ts,a.synthetic):this.unthreadedReceipts.set(n,a.receiptType,a.userId,a.receipt.ts,a.synthetic)})}}),this.room=e,this.threadedReceipts=new yhe(e),this.unthreadedReceipts=new vV(e),this.danglingReceipts=new bhe,e.on(Ue.Timeline,this.onTimelineEvent)}add(e,r){for(var[n,i]of Object.entries(e))for(var[a,o]of Object.entries(i))for(var[s,l]of Object.entries(o)){var c=this.room.findEventById(n);c?l.thread_id?this.threadedReceipts.set(l.thread_id,n,a,s,l.ts,r):this.unthreadedReceipts.set(n,a,s,l.ts,r):this.danglingReceipts.add(new vhe(n,a,s,l,r))}}hasUserReadEvent(e,r){var n=this.unthreadedReceipts.get(e);if(n&&Lx(n.eventId,r,this.room))return!0;var i=this.room.findEventById(r);if(!i)return U.warn("hasUserReadEvent event ID ".concat(r," not found in room ").concat(this.room.roomId,": this shouldn't happen!")),!1;var a=lf(i),o=this.threadedReceipts.get(a,e);return!!(o&&Lx(o.eventId,r,this.room)||this.userSentLatestEventInThread(a,e))}userSentLatestEventInThread(e,r){var n,i=e===Zm?this.room.getLiveTimeline().getEvents():(n=this.room.getThread(e))===null||n===void 0?void 0:n.timeline;return!!(i&&i.length>0&&i[i.length-1].getSender()===r)}}class mhe{constructor(e,r,n){this.eventId=e,this.receiptType=r,this.ts=n}}class vhe{constructor(e,r,n,i,a){this.eventId=e,this.receiptType=r,this.userId=n,this.receipt=i,this.synthetic=a}}class ghe{constructor(e){E(this,"room",void 0),E(this,"real",void 0),E(this,"synthetic",void 0),this.room=e,this.real=void 0,this.synthetic=void 0}set(e,r){e?this.synthetic=r:this.real=r,this.synthetic&&this.real&&Lx(this.real.eventId,this.synthetic.eventId,this.room)&&(this.synthetic=void 0)}get(){var e;return(e=this.synthetic)!==null&&e!==void 0?e:this.real}getByType(e){return e?this.synthetic:this.real}}class vV{constructor(e){E(this,"room",void 0),E(this,"data",void 0),this.room=e,this.data=new Map}set(e,r,n,i,a){var o=J4(this.data,n,()=>new ghe(this.room)),s=o.getByType(a);s&&_he(s.eventId,e,this.room)||o.set(a,new mhe(e,r,i))}get(e){var r;return(r=this.data.get(e))===null||r===void 0?void 0:r.get()}}class yhe{constructor(e){E(this,"room",void 0),E(this,"data",void 0),this.room=e,this.data=new Map}set(e,r,n,i,a,o){var s=J4(this.data,e,()=>new vV(this.room));s.set(r,n,i,a,o)}get(e,r){var n;return(n=this.data.get(e))===null||n===void 0?void 0:n.get(r)}}class bhe{constructor(){E(this,"data",new Map)}add(e){var r=J4(this.data,e.eventId,()=>[]);r.push(e)}remove(e){var r=this.data.get(e);return this.data.delete(e),r}}function J4(t,e,r){var n=t.get(e);if(n)return n;var i=r();return t.set(e,i),i}function Lx(t,e,r){var n=r.compareEventOrdering(t,e);return n!==null&&n>=0}function _he(t,e,r){var n=r.compareEventOrdering(t,e);return n!==null&&n>0}function She(t,e,r){var n=t.findEventById(e),i=t.findEventById(r);if(!n||!i)return null;var a=um(n),o=um(i);return a&&o?whe(t,e,r,n,i):Ehe(e,r,n,i)}function whe(t,e,r,n,i){var a=t.getUnfilteredTimelineSet(),o=a.compareEventOrdering(e,r);if(o!==null)return o;var s=a.getTimelineForEvent(e);if(s===a.getLiveTimeline())return 1;var l=a.getTimelineForEvent(r);return l===a.getLiveTimeline()?-1:gV(n,i)}function Ehe(t,e,r,n){var i=lf(r),a=lf(n),o=r.getThread();return o&&i===a?o.timelineSet.compareEventOrdering(t,e):gV(r,n)}function gV(t,e){var r=t.getTs(),n=e.getTs();return r<n?-1:r>n?1:0}var _e=function(t){return t.Get="GET",t.Put="PUT",t.Post="POST",t.Delete="DELETE",t.Options="OPTIONS",t.Head="HEAD",t.Patch="PATCH",t}({});function BA(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function xhe(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?BA(Object(r),!0).forEach(function(n){E(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):BA(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}class gl extends Error{constructor(e,r,n){super(e),this.httpStatus=r,this.httpHeaders=n}isRateLimitError(){return this.httpStatus===429}getRetryAfterMs(){var e,r=(e=this.httpHeaders)===null||e===void 0?void 0:e.get("Retry-After");if(r!=null){if(/^\d+$/.test(r)){var n=Number.parseInt(r)*1e3;if(!Number.isFinite(n))throw new Error("Retry-After header integer value is too large");return n}var i=new Date(r);if(i.toUTCString()!==r)throw new Error("Retry-After header value is not a valid HTTP-date or non-negative decimal integer");return i.getTime()-Date.now()}return null}}class ur extends gl{constructor(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0,o=e.error||"Unknown message";r&&(o="[".concat(r,"] ").concat(o)),n&&(o="".concat(o," (").concat(n,")")),super("MatrixError: ".concat(o),r,a),this.url=n,this.event=i,E(this,"errcode",void 0),E(this,"data",void 0),this.errcode=e.errcode,this.name=e.errcode||"Unknown error code",this.data=e}isRateLimitError(){return this.errcode==="M_LIMIT_EXCEEDED"||(this.errcode==="M_UNKNOWN"||this.errcode===void 0)&&super.isRateLimitError()}getRetryAfterMs(){var e=super.getRetryAfterMs();if(e!==null)return e;if(this.errcode==="M_LIMIT_EXCEEDED"&&"retry_after_ms"in this.data){if(!Number.isInteger(this.data.retry_after_ms))throw new Error("retry_after_ms is not an integer");return this.data.retry_after_ms}return null}asWidgetApiErrorData(){var e,r,n,i,a={};if(this.httpHeaders)for(var[o,s]of this.httpHeaders)a[o]=s;return{http_status:(e=this.httpStatus)!==null&&e!==void 0?e:400,http_headers:a,url:(r=this.url)!==null&&r!==void 0?r:"",response:xhe({errcode:(n=this.errcode)!==null&&n!==void 0?n:"M_UNKNOWN",error:(i=this.data.error)!==null&&i!==void 0?i:"Unknown message"},this.data)}}static fromWidgetApiErrorData(e){return new ur(e.response,e.http_status,e.url,void 0,new Headers(e.http_headers))}}function X4(t,e){if(!(t instanceof gl)||!t.isRateLimitError())return e;try{var r;return(r=t.getRetryAfterMs())!==null&&r!==void 0?r:e}catch{return e}}class Xu extends Error{constructor(e,r){super(e+(r?": ".concat(r.message):""))}get name(){return"ConnectionError"}}class yV extends Error{constructor(e){var r;super((r=e==null?void 0:e.message)!==null&&r!==void 0?r:"")}get name(){return"TokenRefreshError"}}class Q4 extends Error{constructor(e){var r;super((r=e==null?void 0:e.message)!==null&&r!==void 0?r:"")}get name(){return"TokenRefreshLogoutError"}}var Bx=function(t){return t.SessionLoggedOut="Session.logged_out",t.NoConsent="no_consent",t}({});/*!
 * content-type
 * Copyright(c) 2015 Douglas Christopher Wilson
 * MIT Licensed
 */var NA=/; *([!#$%&'*+.^_`|~0-9A-Za-z-]+) *= *("(?:[\u000b\u0020\u0021\u0023-\u005b\u005d-\u007e\u0080-\u00ff]|\\[\u000b\u0020-\u00ff])*"|[!#$%&'*+.^_`|~0-9A-Za-z-]+) */g,Che=/\\([\u000b\u0020-\u00ff])/g,The=/^[!#$%&'*+.^_`|~0-9A-Za-z-]+\/[!#$%&'*+.^_`|~0-9A-Za-z-]+$/,Dhe=Rhe;function Rhe(t){if(!t)throw new TypeError("argument string is required");var e=typeof t=="object"?Mhe(t):t;if(typeof e!="string")throw new TypeError("argument string is required to be a string");var r=e.indexOf(";"),n=r!==-1?e.slice(0,r).trim():e.trim();if(!The.test(n))throw new TypeError("invalid media type");var i=new Ihe(n.toLowerCase());if(r!==-1){var a,o,s;for(NA.lastIndex=r;o=NA.exec(e);){if(o.index!==r)throw new TypeError("invalid parameter format");r+=o[0].length,a=o[1].toLowerCase(),s=o[2],s.charCodeAt(0)===34&&(s=s.slice(1,-1),s.indexOf("\\")!==-1&&(s=s.replace(Che,"$1"))),i.parameters[a]=s}if(r!==e.length)throw new TypeError("invalid parameter format")}return i}function Mhe(t){var e;if(typeof t.getHeader=="function"?e=t.getHeader("content-type"):typeof t.headers=="object"&&(e=t.headers&&t.headers["content-type"]),typeof e!="string")throw new TypeError("content-type header is missing from object");return e}function Ihe(t){this.parameters=Object.create(null),this.type=t}function Jb(t){var e=new AbortController;return setTimeout(()=>{e.abort()},t),e.signal}function bV(t){var e=new AbortController;function r(){for(var a of t)a.removeEventListener("abort",n)}function n(){e.abort(),r()}for(var i of t){if(i.aborted){n();break}i.addEventListener("abort",n)}return{signal:e.signal,cleanup:r}}function e3(t,e){var r,n,i=UA(t)?new Headers(t.getAllResponseHeaders().trim().split(/[\r\n]+/).map(o=>{var s=o.indexOf(":");return[o.substring(0,s),o.substring(s+1)]})):t.headers,a;try{a=Phe(i)}catch(o){return o}return((r=a)===null||r===void 0?void 0:r.type)==="application/json"&&e?new ur(JSON.parse(e),t.status,UA(t)?t.responseURL:t.url,void 0,i):((n=a)===null||n===void 0?void 0:n.type)==="text/plain"?new gl("Server returned ".concat(t.status," error: ").concat(e),t.status,i):new gl("Server returned ".concat(t.status," error"),t.status,i)}function UA(t){return"getResponseHeader"in t}function Phe(t){var e=t.get("Content-Type");if(e===null)return null;try{return Dhe(e)}catch(r){throw new Error("Error parsing Content-Type '".concat(e,"': ").concat(r))}}function Nx(t,e){return Ux.apply(this,arguments)}function Ux(){return Ux=K(function*(t,e){for(var r=0,n=null;r<t;)try{if(r>0){var i=1e3*Math.pow(2,r);U.log("network operation failed ".concat(r," times, retrying in ").concat(i,"ms...")),yield $u(i)}return yield e()}catch(a){if(a instanceof Xu)r+=1,n=a;else throw a}throw n}),Ux.apply(this,arguments)}function _V(t,e,r){return e>4||t instanceof Xu&&!r||t.httpStatus&&Math.floor(t.httpStatus/100)===4&&t.httpStatus!==429||t.name==="AbortError"||t.name==="M_TOO_LARGE"?-1:X4(t,1e3*Math.pow(2,e))}var ks=function(t){return t.Success="success",t.Failure="failure",t.Logout="logout",t}({}),Ahe=500,khe=60*1e3;class Ohe{constructor(e){this.opts=e,E(this,"tokenRefreshPromise",void 0),E(this,"latestTokenRefreshExpiry",void 0)}prepareForRequest(){var e=this;return K(function*(){return yield e.refreshIfNeeded(),{accessToken:e.opts.accessToken,refreshToken:e.opts.refreshToken,expiry:e.latestTokenRefreshExpiry}})()}refreshIfNeeded(){var e=this;return K(function*(){if(e.tokenRefreshPromise)return e.tokenRefreshPromise;if(e.latestTokenRefreshExpiry){var r=e.latestTokenRefreshExpiry.getTime()-Date.now();r<=Ahe&&(yield e._handleUnknownToken())}})()}handleUnknownToken(e,r){var n=this;return K(function*(){return n._handleUnknownToken(e,r)})()}_handleUnknownToken(e,r){var n=this;return K(function*(){if(e!=null&&e.expiry){var i=e.expiry.getTime()-Date.now();if(i>=khe)return ks.Logout}if(!e||(e==null?void 0:e.accessToken)===n.opts.accessToken){var a;(a=n.tokenRefreshPromise)!==null&&a!==void 0||(n.tokenRefreshPromise=n.doTokenRefresh(r));try{return yield n.tokenRefreshPromise}finally{n.tokenRefreshPromise=void 0}}return ks.Success})()}doTokenRefresh(e){var r=this;return K(function*(){if(!r.opts.refreshToken||!r.opts.tokenRefreshFunction){var n;return(n=r.opts.logger)===null||n===void 0||n.error("Unable to refresh token - no refresh token or refresh function"),ks.Logout}e&&e>1&&(yield $u(1e3*Math.min(32,2**e)));try{var i,a;(i=r.opts.logger)===null||i===void 0||i.debug("Attempting to refresh token");var{accessToken:o,refreshToken:s,expiry:l}=yield r.opts.tokenRefreshFunction(r.opts.refreshToken);return r.opts.accessToken=o,r.opts.refreshToken=s,r.latestTokenRefreshExpiry=l,(a=r.opts.logger)===null||a===void 0||a.debug("... token refresh complete, new token expiry:",l),ks.Success}catch(h){var c;if(h instanceof Q4||h instanceof ur){var d;return(d=r.opts.logger)===null||d===void 0||d.error("Failed to refresh token",h),ks.Logout}return(c=r.opts.logger)===null||c===void 0||c.warn("Failed to refresh token",h),ks.Failure}})()}}class $he{constructor(e,r){var n;this.eventEmitter=e,this.opts=r,E(this,"abortController",new AbortController),E(this,"tokenRefresher",void 0),gj(r,["baseUrl","prefix"]),r.onlyData=!!r.onlyData,r.useAuthorizationHeader=(n=r.useAuthorizationHeader)!==null&&n!==void 0?n:!0,this.tokenRefresher=new Ohe(r)}abort(){this.abortController.abort(),this.abortController=new AbortController}fetch(e,r){return this.opts.fetchFn?this.opts.fetchFn(e,r):globalThis.fetch(e,r)}setIdBaseUrl(e){this.opts.idBaseUrl=e}idServerRequest(e,r,n,i,a){if(!this.opts.idBaseUrl)throw new Error("No identity server base URL set");var o=void 0,s=void 0;e===_e.Get?o=n:s=n;var l=this.getUrl(r,o,i,this.opts.idBaseUrl),c={json:!0,headers:{}};return a&&(c.headers.Authorization="Bearer ".concat(a)),this.requestOtherUrl(e,l,s,c)}authedRequest(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=arguments.length>3?arguments[3]:void 0,a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{};return this.doAuthedRequest(1,e,r,n,i,a)}doAuthedRequest(e,r,n,i,a){var o=arguments,s=this;return K(function*(){var l=o.length>5&&o[5]!==void 0?o[5]:{},c=Ym(l);c.abortSignal=l.abortSignal;var d=yield s.tokenRefresher.prepareForRequest();d.accessToken&&(s.opts.useAuthorizationHeader?(c.headers||(c.headers={}),c.headers.Authorization||(c.headers.Authorization="Bearer ".concat(d.accessToken)),i.access_token&&delete i.access_token):i.access_token||(i.access_token=d.accessToken));try{var h=yield s.request(r,n,i,a,c);return h}catch(m){if(!(m instanceof ur))throw m;if(m.errcode==="M_UNKNOWN_TOKEN"){var p=yield s.tokenRefresher.handleUnknownToken(d,e);if(p===ks.Success)return s.doAuthedRequest(e+1,r,n,i,a,l);if(p===ks.Failure)throw new yV(m);c!=null&&c.inhibitLogoutEmit||s.eventEmitter.emit(Bx.SessionLoggedOut,m)}else m.errcode=="M_CONSENT_NOT_GIVEN"&&s.eventEmitter.emit(Bx.NoConsent,m.message,m.data.consent_uri);throw m}})()}request(e,r,n,i,a){var o=this.getUrl(r,n,a==null?void 0:a.prefix,a==null?void 0:a.baseUrl);return this.requestOtherUrl(e,o,i,a)}requestOtherUrl(e,r,n){var i=arguments,a=this;return K(function*(){var o,s,l,c,d,h=i.length>3&&i[3]!==void 0?i[3]:{},p=a.sanitizeUrlForLogs(r);(o=a.opts.logger)===null||o===void 0||o.debug("FetchHttpApi: --> ".concat(e," ").concat(p));var m=Object.assign({},h.headers||{}),g=(s=h.json)!==null&&s!==void 0?s:!0,y=g&&(n==null||(l=n.constructor)===null||l===void 0?void 0:l.name)===Object.name;g&&(y&&!m["Content-Type"]&&(m["Content-Type"]="application/json"),m.Accept||(m.Accept="application/json"));var R=(c=h.localTimeoutMs)!==null&&c!==void 0?c:a.opts.localTimeoutMs,b=(d=h.keepAlive)!==null&&d!==void 0?d:!1,_=[a.abortController.signal];R!==void 0&&_.push(Jb(R)),h.abortSignal&&_.push(h.abortSignal);var x;y?x=JSON.stringify(n):x=n;var{signal:T,cleanup:I}=bV(_),C,k=Date.now();try{var S;C=yield a.fetch(r,{signal:T,method:e,body:x,headers:m,mode:"cors",redirect:"follow",referrer:"",referrerPolicy:"no-referrer",cache:"no-cache",credentials:"omit",keepalive:b,priority:h.priority}),(S=a.opts.logger)===null||S===void 0||S.debug("FetchHttpApi: <-- ".concat(e," ").concat(p," [").concat(Date.now()-k,"ms ").concat(C.status,"]"))}catch(z){var V;throw(V=a.opts.logger)===null||V===void 0||V.debug("FetchHttpApi: <-- ".concat(e," ").concat(p," [").concat(Date.now()-k,"ms ").concat(z,"]")),z.name==="AbortError"?z:new Xu("fetch failed",z)}finally{I()}if(!C.ok)throw e3(C,yield C.text());return a.opts.onlyData?g?C.json():C.text():C})()}sanitizeUrlForLogs(e){try{var r;typeof e=="string"?r=new URL(e):r=e;var n=new URLSearchParams;for(var i of r.searchParams.keys())n.append(i,"xxx");var a=n.toString(),o=a?"?".concat(a):"";return r.origin+r.pathname+o}catch{return"??"}}getUrl(e,r,n,i){var a=i??this.opts.baseUrl,o=a.endsWith("/")?a.slice(0,-1):a,s=new URL(o+(n??this.opts.prefix)+e);return r&&rx(r,s.searchParams),s}}var Ur=function(t){return t.V1="/_matrix/client/v1",t.V3="/_matrix/client/v3",t.Unstable="/_matrix/client/unstable",t}({}),xo=function(t){return t.V2="/_matrix/identity/v2",t}({}),Ed=function(t){return t.V1="/_matrix/media/v1",t.V3="/_matrix/media/v3",t}({}),Lhe=1e3,Bhe=0,Dw,Fo=[],Nhe=function(){};function FA(t,e){for(var r=arguments.length,n=new Array(r>2?r-2:0),i=2;i<r;i++)n[i-2]=arguments[i];e=e||0,e<0&&(e=0);var a=Date.now()+e,o=Bhe++,s={runAt:a,func:t,params:n,key:o},l=Fhe(Fo,function(c){return c.runAt-a});return Fo.splice(l,0,s),t3(),o}function jA(t){if(Fo.length!==0){var e;for(e=0;e<Fo.length;e++){var r=Fo[e];if(r.key==t){Fo.splice(e,1);break}}e===0&&t3()}}function t3(){Dw&&globalThis.clearTimeout(Dw);var t=Fo[0];if(t){var e=Date.now(),r=Math.min(t.runAt-e,Lhe);Dw=globalThis.setTimeout(Uhe,r)}}function Uhe(){for(var t=Date.now(),e=[];;){var r=Fo[0];if(!r||r.runAt>t)break;var n=Fo.shift();Nhe("runCallbacks: popping",n.key),e.push(n)}t3();for(var i of e)try{i.func.apply(globalThis,i.params)}catch(a){U.error("Uncaught exception in callback function",a)}}function Fhe(t,e){for(var r=0,n=t.length;r<n;){var i=r+n>>1,a=e(t[i]);a>0?n=i:r=i+1}return r}class SV extends $he{constructor(){super(...arguments),E(this,"uploads",[])}uploadContent(e){var r,n,i,a,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=(r=o.includeFilename)!==null&&r!==void 0?r:!0,l=(n=o.abortController)!==null&&n!==void 0?n:new AbortController,c=((i=o.type)!==null&&i!==void 0?i:e.type)||"application/octet-stream",d=(a=o.name)!==null&&a!==void 0?a:e.name,h={loaded:0,total:0,abortController:l},p=ml();if(globalThis.XMLHttpRequest){var m=new globalThis.XMLHttpRequest,g=function(){m.abort(),p.reject(new Error("Timeout"))},y=FA(g,3e4);m.onreadystatechange=function(){switch(m.readyState){case globalThis.XMLHttpRequest.DONE:jA(y);try{if(m.status===0)throw new DOMException(m.statusText,"AbortError");if(!m.responseText)throw new Error("No response body.");m.status>=400?p.reject(e3(m,m.responseText)):p.resolve(JSON.parse(m.responseText))}catch(x){if(x.name==="AbortError"){p.reject(x);return}p.reject(new Xu("request failed",x))}break}},m.upload.onprogress=x=>{var T;jA(y),h.loaded=x.loaded,h.total=x.total,y=FA(g,3e4),(T=o.progressHandler)===null||T===void 0||T.call(o,{loaded:x.loaded,total:x.total})};var R=this.getUrl("/upload",void 0,Ed.V3);s&&d&&R.searchParams.set("filename",encodeURIComponent(d)),!this.opts.useAuthorizationHeader&&this.opts.accessToken&&R.searchParams.set("access_token",encodeURIComponent(this.opts.accessToken)),m.open(_e.Post,R.href),this.opts.useAuthorizationHeader&&this.opts.accessToken&&m.setRequestHeader("Authorization","Bearer "+this.opts.accessToken),m.setRequestHeader("Content-Type",c),m.send(e),l.signal.addEventListener("abort",()=>{m.abort()})}else{var b={};s&&d&&(b.filename=d);var _={"Content-Type":c};this.authedRequest(_e.Post,"/upload",b,e,{prefix:Ed.V3,headers:_,abortSignal:l.signal}).then(x=>this.opts.onlyData?x:x.json()).then(p.resolve,p.reject)}return h.promise=p.promise.finally(()=>{E0(this.uploads,x=>x===h)}),l.signal.addEventListener("abort",()=>{E0(this.uploads,x=>x===h),p.reject(new DOMException("Aborted","AbortError"))}),this.uploads.push(h),h.promise}cancelUpload(e){var r=this.uploads.find(n=>n.promise===e);return r?(r.abortController.abort(),!0):!1}getCurrentUploads(){return this.uploads}getContentUri(){return{base:this.opts.baseUrl,path:Ed.V3+"/upload",params:{access_token:this.opts.accessToken}}}}var jhe=6*60*60*1e3,Vhe=30*1e3,wV=function(t){return t.Stable="stable",t.Unstable="unstable",t}({});class EV{constructor(e){var r=this;this.http=e,E(this,"capabilities",void 0),E(this,"retryTimeout",void 0),E(this,"refreshTimeout",void 0),E(this,"fetchCapabilities",K(function*(){var n=yield r.http.authedRequest(_e.Get,"/capabilities");return r.capabilities=n.capabilities,r.capabilities})),E(this,"poll",K(function*(){try{yield r.fetchCapabilities(),r.clearTimeouts(),r.refreshTimeout=setTimeout(r.poll,jhe),U.debug("Fetched new server capabilities")}catch(i){r.clearTimeouts();var n=Math.floor(Vhe+Math.random()*5e3);r.retryTimeout=setTimeout(r.poll,n),U.warn("Failed to refresh capabilities: retrying in ".concat(n,"ms"),i)}}))}start(){this.poll().then()}stop(){this.clearTimeouts()}getCachedCapabilities(){return this.capabilities}clearTimeouts(){this.refreshTimeout&&(clearInterval(this.refreshTimeout),this.refreshTimeout=void 0),this.retryTimeout&&(clearTimeout(this.retryTimeout),this.retryTimeout=void 0)}}function VA(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function vh(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?VA(Object(r),!0).forEach(function(n){E(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):VA(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var xV="10",zhe=["1","2","3","4","5","6","7","8","9","10"],Khe=30,It=function(t){return t.Highlight="highlight",t.Total="total",t}({}),Ue=function(t){return t.MyMembership="Room.myMembership",t.Tags="Room.tags",t.AccountData="Room.accountData",t.Receipt="Room.receipt",t.Name="Room.name",t.Redaction="Room.redaction",t.RedactionCancelled="Room.redactionCancelled",t.LocalEchoUpdated="Room.localEchoUpdated",t.Timeline="Room.timeline",t.TimelineReset="Room.timelineReset",t.TimelineRefresh="Room.TimelineRefresh",t.OldStateUpdated="Room.OldStateUpdated",t.CurrentStateUpdated="Room.CurrentStateUpdated",t.HistoryImportedWithinTimeline="Room.historyImportedWithinTimeline",t.UnreadNotifications="Room.UnreadNotifications",t.Summary="Room.Summary",t}({});class Xb extends hV{constructor(e,r,n){var i,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};super(),i=this,this.roomId=e,this.client=r,this.myUserId=n,this.opts=a,E(this,"reEmitter",void 0),E(this,"txnToEvent",new Map),E(this,"notificationCounts",{}),E(this,"bumpStamp",void 0),E(this,"threadNotifications",new Map),E(this,"cachedThreadReadReceipts",new Map),E(this,"oldestThreadedReceiptTs",1/0),E(this,"unthreadedReceipts",new Map),E(this,"timelineSets",void 0),E(this,"polls",new Map),E(this,"threadsTimelineSets",[]),E(this,"filteredTimelineSets",{}),E(this,"timelineNeedsRefresh",!1),E(this,"pendingEventList",void 0),E(this,"blacklistUnverifiedDevices",void 0),E(this,"selfMembership",void 0),E(this,"heroes",null),E(this,"getTypeWarning",!1),E(this,"getVersionWarning",!1),E(this,"membersPromise",void 0),E(this,"name",void 0),E(this,"normalizedName",void 0),E(this,"tags",{}),E(this,"accountData",new Map),E(this,"summary",null),E(this,"oldState",void 0),E(this,"currentState",void 0),E(this,"relations",void 0),E(this,"threads",new Map),E(this,"visibilityEvents",new Map),E(this,"roomReceipts",new phe(this)),E(this,"threadTimelineSetsPromise",null),E(this,"threadsReady",!1),E(this,"updateThreadRootEvents",(o,s,l)=>{if(o.length){var c;if(this.updateThreadRootEvent((c=this.threadsTimelineSets)===null||c===void 0?void 0:c[0],o,s,l),o.hasCurrentUserParticipated){var d;this.updateThreadRootEvent((d=this.threadsTimelineSets)===null||d===void 0?void 0:d[1],o,s,l)}}}),E(this,"updateThreadRootEvent",(o,s,l,c)=>{o&&s.rootEvent&&(c&&o.removeEvent(s.id),Jt.hasServerSideSupport?o.addLiveEvent(s.rootEvent,{duplicateStrategy:fp.Replace,fromCache:!1,roomState:this.currentState,addToState:!1}):o.addEventToTimeline(s.rootEvent,o.getLiveTimeline(),{toStartOfTimeline:l,addToState:!1}))}),E(this,"applyRedaction",o=>{if(o.isRedaction()){var s=o.event.redacts,l=s?this.findEventById(s):void 0;if(l){var c=l.threadRootId;if(l.makeRedacted(o,this),l.isState()){var d=this.currentState.getStateEvents(l.getType(),l.getStateKey());(d==null?void 0:d.getId())===l.getId()&&this.currentState.setStateEvents([l])}this.emit(Ue.Redaction,o,this,c),this.visibilityEvents.delete(s),l.isVisibilityEvent()&&this.redactVisibilityChangeEvent(o)}}}),this.setMaxListeners(100),this.reEmitter=new kf(this),a.pendingEventOrdering=a.pendingEventOrdering||sf.Chronological,this.name=e,this.normalizedName=e,this.relations=new Jj(this.client,this),this.on(Ue.Receipt,this.onReceipt),this.timelineSets=[new Qc(this,a)],this.reEmitter.reEmit(this.getUnfilteredTimelineSet(),[Ue.Timeline,Ue.TimelineReset]),this.fixUpLegacyTimelineFields(),this.opts.pendingEventOrdering===sf.Detached&&(this.pendingEventList=[],this.client.store.getPendingEvents(this.roomId).then(o=>{var s=this.client.getEventMapper({toDevice:!1,decrypt:!1});o.forEach(function(){var l=K(function*(c){var d=s(c);yield r.decryptEventIfNeeded(d),d.setStatus(Ze.NOT_SENT),i.addPendingEvent(d,d.getTxnId())});return function(c){return l.apply(this,arguments)}}())})),this.opts.lazyLoadMembers?this.membersPromise=void 0:this.membersPromise=Promise.resolve(!1)}createThreadsTimelineSets(){var e=this;return K(function*(){var r;if(e.threadTimelineSetsPromise)return e.threadTimelineSetsPromise;if((r=e.client)!==null&&r!==void 0&&r.supportsThreads())try{e.threadTimelineSetsPromise=Promise.all([e.createThreadTimelineSet(),e.createThreadTimelineSet(pa.My)]);var n=yield e.threadTimelineSetsPromise;return e.threadsTimelineSets[0]=n[0],e.threadsTimelineSets[1]=n[1],n}catch{return e.threadTimelineSetsPromise=null,null}return null})()}decryptCriticalEvents(){var e=this;return K(function*(){if(e.client.getCrypto()){var r=e.getEventReadUpTo(e.client.getUserId(),!0),n=e.getLiveTimeline().getEvents(),i=n.findIndex(o=>o.event.event_id===r),a=n.slice(i).reverse().map(o=>e.client.decryptEventIfNeeded(o));yield Promise.allSettled(a)}})()}decryptAllEvents(){var e=this;return K(function*(){if(e.client.getCrypto()){var r=e.getUnfilteredTimelineSet().getLiveTimeline().getEvents().slice(0).reverse().map(n=>e.client.decryptEventIfNeeded(n));yield Promise.allSettled(r)}})()}getCreator(){var e,r=this.currentState.getStateEvents(ge.RoomCreate,"");return(e=r==null?void 0:r.getSender())!==null&&e!==void 0?e:null}getVersion(){var e,r=this.currentState.getStateEvents(ge.RoomCreate,"");return r?(e=r.getContent().room_version)!==null&&e!==void 0?e:"1":(this.getVersionWarning||(U.warn("[getVersion] Room "+this.roomId+" does not have an m.room.create event"),this.getVersionWarning=!0),"1")}getRecommendedVersion(){var e=this;return K(function*(){var r={};try{r=yield e.client.getCapabilities()}catch{}var n=r["m.room_versions"];if(!n){n={default:xV,available:{}};for(var i of zhe)n.available[i]=wV.Stable}var a=e.checkVersionAgainstCapability(n);if(a.urgent&&a.needsUpgrade){U.warn("Refreshing room version capability because the server looks to be supporting a newer room version we don't know about.");try{r=yield e.client.fetchCapabilities()}catch(o){U.warn("Failed to refresh room version capabilities",o)}if(n=r["m.room_versions"],n)a=e.checkVersionAgainstCapability(n);else return U.warn("No room version capability - assuming upgrade required."),a}return a})()}checkVersionAgainstCapability(e){var r=this.getVersion();U.log("[".concat(this.roomId,"] Current version: ").concat(r)),U.log("[".concat(this.roomId,"] Version capability: "),e);var n={version:r,needsUpgrade:!1,urgent:!1};if(r===e.default)return n;var i=Object.keys(e.available).filter(a=>e.available[a]==="stable");return i.includes(r)||(n.version=e.default,n.needsUpgrade=!0,n.urgent=!!this.getVersion().match(/^[0-9]+[0-9.]*$/g),n.urgent?U.warn("URGENT upgrade required on ".concat(this.roomId)):U.warn("Non-urgent upgrade required on ".concat(this.roomId))),n}userMayUpgradeRoom(e){return this.currentState.maySendStateEvent(ge.RoomTombstone,e)}getPendingEvents(){if(!this.pendingEventList)throw new Error("Cannot call getPendingEvents with pendingEventOrdering == "+this.opts.pendingEventOrdering);return this.pendingEventList}removePendingEvent(e){if(!this.pendingEventList)throw new Error("Cannot call removePendingEvent with pendingEventOrdering == "+this.opts.pendingEventOrdering);var r=E0(this.pendingEventList,function(n){return n.getId()==e},!1);return this.savePendingEvents(),r}hasPendingEvent(e){var r,n;return(r=(n=this.pendingEventList)===null||n===void 0?void 0:n.some(i=>i.getId()===e))!==null&&r!==void 0?r:!1}getPendingEvent(e){var r,n;return(r=(n=this.pendingEventList)===null||n===void 0?void 0:n.find(i=>i.getId()===e))!==null&&r!==void 0?r:null}getLiveTimeline(){return this.getUnfilteredTimelineSet().getLiveTimeline()}get timeline(){return this.getLiveTimeline().getEvents()}getLastActiveTimestamp(){var e=this.getLiveTimeline(),r=e.getEvents();if(r.length){var n=r[r.length-1];return n.getTs()}else return Number.MIN_SAFE_INTEGER}getLastLiveEvent(){var e,r,n=this.getLiveTimeline().getEvents(),i=n[n.length-1],a=this.getLastThread();if(!a)return i;var o=a.events[a.events.length-1];return((e=i==null?void 0:i.getTs())!==null&&e!==void 0?e:0)>((r=o==null?void 0:o.getTs())!==null&&r!==void 0?r:0)?i:o}getLastThread(){return this.getThreads().reduce((e,r)=>{var n,i;if(!e)return r;var a=r.events[r.events.length-1],o=e.events[e.events.length-1];return((n=a==null?void 0:a.getTs())!==null&&n!==void 0?n:0)>=((i=o==null?void 0:o.getTs())!==null&&i!==void 0?i:0)?r:e},void 0)}getMyMembership(){var e;return(e=this.selfMembership)!==null&&e!==void 0?e:ct.Leave}getDMInviter(){var e=this.getMember(this.myUserId);if(e)return e.getDMInviter();if(this.selfMembership===ct.Invite){var r=this.getInvitedAndJoinedMemberCount();if(r===2){var n;return(n=this.heroes)===null||n===void 0||(n=n[0])===null||n===void 0?void 0:n.userId}}}guessDMUserId(){var e=this.getMember(this.myUserId);if(e){var r=e.getDMInviter();if(r)return r}if(Array.isArray(this.heroes)&&this.heroes.length)return this.heroes[0].userId;var n=this.currentState.getMembers(),i=n.find(a=>a.userId!==this.myUserId);return i?i.userId:this.myUserId}getFunctionalMembers(){var e=this.currentState.getStateEvents(Lj.name,"");return Array.isArray(e==null?void 0:e.getContent().service_members)?e.getContent().service_members:[]}getAvatarFallbackMember(){var e,r=this.getFunctionalMembers(),n=0;if(this.getMembers().forEach(y=>{y.membership!=="join"&&y.membership!=="invite"||r.includes(y.userId)||n++}),!(n>2)){var i=(e=this.heroes)===null||e===void 0?void 0:e.filter(y=>!r.includes(y.userId)),a=Array.isArray(i)&&i.length;if(a){for(var o of i)if(o.fromMSC4186){var l=new tm(this.roomId,o.userId);return l.setMembershipEvent(new Bn({event_id:"$"+this.roomId+o.userId+new Date().getTime(),type:ge.RoomMember,state_key:o.userId,content:{displayname:o.displayName,avatar_url:o.avatarUrl}})),l}else{var s=this.getMember(o.userId);if(s)return s}var c=i.map(y=>this.getMember(y.userId)).find(y=>!!y);if(c)return c}var d=this.getMembers(),h=d==null?void 0:d.filter(y=>!r.includes(y.userId));if(h.length<=2){var p=h.find(y=>y.userId!==this.myUserId);if(p)return p}if(a){var m=i.map(y=>this.client.getUser(y.userId)).find(y=>!!y);if(m){var g=new tm(this.roomId,m.userId);return g.user=m,g}}}}updateMyMembership(e){var r=this.selfMembership;this.selfMembership=e,r!==e&&(e===ct.Leave&&this.cleanupAfterLeaving(),this.emit(Ue.MyMembership,this,e,r))}loadMembersFromServer(){var e=this;return K(function*(){var r=e.client.store.getSyncToken(),n=yield e.client.members(e.roomId,void 0,ct.Leave,r??void 0);return n.chunk})()}loadMembers(){var e=this;return K(function*(){var r=!1,n=yield e.client.store.getOutOfBandMembers(e.roomId);(n===null||e.hasEncryptionStateEvent())&&(r=!0,n=yield e.loadMembersFromServer(),U.log("LL: got ".concat(n.length," ")+"members from server for room ".concat(e.roomId)));var i=n.filter(ya).map(e.client.getEventMapper());return{memberEvents:i,fromServer:r}})()}membersLoaded(){return this.opts.lazyLoadMembers?this.currentState.outOfBandMembersReady():!0}loadMembersIfNeeded(){if(this.membersPromise)return this.membersPromise;this.currentState.markOutOfBandMembersStarted();var e=this.loadMembers().then(r=>(this.currentState.setOutOfBandMembers(r.memberEvents),r.fromServer)).catch(r=>{throw this.membersPromise=void 0,this.currentState.markOutOfBandMembersFailed(),r});return e.then(r=>{if(r){var n=this.currentState.getMembers().filter(a=>a.isOutOfBand()).map(a=>{var o;return(o=a.events.member)===null||o===void 0?void 0:o.event});U.log("LL: telling store to write ".concat(n.length)+" members for room ".concat(this.roomId));var i=this.client.store;return i.setOutOfBandMembers(this.roomId,n).catch(a=>{U.log("LL: storing OOB room members failed, oh well",a)})}}).catch(r=>{U.error(r)}),this.membersPromise=e,this.membersPromise}clearLoadedMembersIfNeeded(){var e=this;return K(function*(){e.opts.lazyLoadMembers&&e.membersPromise&&(yield e.loadMembersIfNeeded(),yield e.client.store.clearOutOfBandMembers(e.roomId),e.currentState.clearOutOfBandMembers(),e.membersPromise=void 0)})()}cleanupAfterLeaving(){this.clearLoadedMembersIfNeeded().catch(e=>{U.error("error after clearing loaded members from "+"room ".concat(this.roomId," after leaving")),U.log(e)})}refreshLiveTimeline(){var e=this;return K(function*(){var r=e.getLiveTimeline(),n=r.getPaginationToken(Be.FORWARDS),i=r.getPaginationToken(Be.BACKWARDS),a=r.getEvents(),o=a[a.length-1];U.log("[refreshLiveTimeline for ".concat(e.roomId,"] at ")+"mostRecentEventInTimeline=".concat(o&&o.getId()," ")+"liveTimelineBefore=".concat(r.toString()," ")+"forwardPaginationToken=".concat(n," ")+"backwardPaginationToken=".concat(i));var s=e.getUnfilteredTimelineSet(),l;o?(e.resetLiveTimeline(null,null),e.emit(Ue.TimelineRefresh,e,s),l=yield e.client.getEventTimeline(s,o.getId())):l=yield e.client.getLatestTimeline(s);var c=s.getLiveTimeline();!c||c.getPaginationToken(st.Forward)===null&&c.getPaginationToken(st.Backward)===null&&c.getEvents().length===0?(U.log("[refreshLiveTimeline for ".concat(e.roomId,"] using our new live timeline")),l.setPaginationToken(n,Be.FORWARDS),s.setLiveTimeline(l),e.fixUpLegacyTimelineFields()):U.log("[refreshLiveTimeline for ".concat(e.roomId,"] `/sync` or some other request beat us to creating a new ")+"live timeline after we reset it. We'll use that instead since any events in the scrollback from this timeline will include the history."),e.setTimelineNeedsRefresh(!1),e.emit(Ue.TimelineRefresh,e,s)})()}resetLiveTimeline(e,r){for(var n of this.timelineSets)n.resetLiveTimeline(e??void 0,r??void 0);for(var i of this.threads.values())i.resetLiveTimeline(e,r);this.fixUpLegacyTimelineFields()}fixUpLegacyTimelineFields(){var e=this.oldState,r=this.currentState;this.oldState=this.getLiveTimeline().getState(Be.BACKWARDS),this.currentState=this.getLiveTimeline().getState(Be.FORWARDS),e!==this.oldState&&this.emit(Ue.OldStateUpdated,this,e,this.oldState),r!==this.currentState&&(this.emit(Ue.CurrentStateUpdated,this,r,this.currentState),this.reEmitter.stopReEmitting(r,[dt.Events,dt.Members,dt.NewMember,dt.Update,dt.Marker,er.New,er.Update,er.Destroy,er.LivenessChange]),this.reEmitter.reEmit(this.currentState,[dt.Events,dt.Members,dt.NewMember,dt.Update,dt.Marker,er.New,er.Update,er.Destroy,er.LivenessChange]))}onReceipt(e){this.hasEncryptionStateEvent()&&this.clearNotificationsOnReceipt(e)}clearNotificationsOnReceipt(e){var r=[],n=!1,i=e.getContent();for(var a of Object.values(i))for(var[o,s]of Object.entries(a))if(W4(o)&&s){for(var[l,c]of Object.entries(s))if(!(!c||typeof c!="object")){var d=c;l===this.client.getUserId()&&(d.thread_id===void 0?n=!0:typeof d.thread_id=="string"&&r.push(d.thread_id))}}n&&(r=this.getThreads().filter(I=>this.getThreadUnreadNotificationCount(I.id,It.Total)>0||this.getThreadUnreadNotificationCount(I.id,It.Highlight)>0).map(I=>I.id),r.push("main"));for(var h of r){var p,m=20,g=h==="main"?this.getLiveTimeline():(p=this.getThread(h))===null||p===void 0?void 0:p.liveTimeline;if(!g){U.warn("Couldn't find timeline for thread ID ".concat(h," in room ").concat(this.roomId));continue}for(var y=g.getEvents(),R=0,b=y.length-1;b>=0;b--){var _;if(b===y.length-m)return;var x=y[b];if(this.hasUserReadEvent(this.client.getUserId(),x.getId()))break;var T=this.client.getPushActionsForEvent(x);R+=T!=null&&(_=T.tweaks)!==null&&_!==void 0&&_.highlight?1:0}h==="main"?this.setUnreadNotificationCount(It.Highlight,R):this.setThreadUnreadNotificationCount(h,It.Highlight,R)}}getTimelineSets(){return this.timelineSets}getUnfilteredTimelineSet(){return this.timelineSets[0]}getTimelineForEvent(e){var r=this.findEventById(e),n=this.findThreadForEvent(r);return n?n.timelineSet.getTimelineForEvent(e):this.getUnfilteredTimelineSet().getTimelineForEvent(e)}addTimeline(){return this.getUnfilteredTimelineSet().addTimeline()}setTimelineNeedsRefresh(e){this.timelineNeedsRefresh=e}getTimelineNeedsRefresh(){return this.timelineNeedsRefresh}findEventById(e){var r=this.getUnfilteredTimelineSet().findEventById(e);if(!r)for(var n=this.getThreads(),i=0;i<n.length;i++){var a=n[i];if(r=a.findEventById(e),r)return r}return r}getUnreadNotificationCount(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:It.Total,r=this.getRoomUnreadNotificationCount(e);for(var n of this.threadNotifications.values()){var i;r+=(i=n[e])!==null&&i!==void 0?i:0}return r}getUnreadCountForEventContext(){var e,r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:It.Total,n=arguments.length>1?arguments[1]:void 0,i=!!n.threadRootId&&!n.isThreadRoot;return(e=i?this.getThreadUnreadNotificationCount(n.threadRootId,r):this.getRoomUnreadNotificationCount(r))!==null&&e!==void 0?e:0}getRoomUnreadNotificationCount(){var e,r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:It.Total;return(e=this.notificationCounts[r])!==null&&e!==void 0?e:0}getThreadUnreadNotificationCount(e){var r,n,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:It.Total;return(r=(n=this.threadNotifications.get(e))===null||n===void 0?void 0:n[i])!==null&&r!==void 0?r:0}hasThreadUnreadNotification(){for(var e of this.threadNotifications.values()){var r,n;if(((r=e.highlight)!==null&&r!==void 0?r:0)>0||((n=e.total)!==null&&n!==void 0?n:0)>0)return!0}return!1}setThreadUnreadNotificationCount(e,r,n){var i,a,o=vh({highlight:(i=this.threadNotifications.get(e))===null||i===void 0?void 0:i.highlight,total:(a=this.threadNotifications.get(e))===null||a===void 0?void 0:a.total},{[r]:n});this.threadNotifications.set(e,o),this.emit(Ue.UnreadNotifications,o,e)}get threadsAggregateNotificationType(){var e=null;for(var r of this.threadNotifications.values()){var n,i;if(((n=r.highlight)!==null&&n!==void 0?n:0)>0)return It.Highlight;((i=r.total)!==null&&i!==void 0?i:0)>0&&!e&&(e=It.Total)}return e}resetThreadUnreadNotificationCountFromSync(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],r=this.hasEncryptionStateEvent();for(var[n,i]of this.threadNotifications)e.includes(n)||(i.total=0,r||(i.highlight=0));this.emit(Ue.UnreadNotifications)}setBumpStamp(e){this.bumpStamp=e}getBumpStamp(){return this.bumpStamp}setUnreadNotificationCount(e,r){this.notificationCounts[e]=r,this.emit(Ue.UnreadNotifications,this.notificationCounts)}setUnread(e,r){return this.setUnreadNotificationCount(e,r)}setSummary(e){var r,n=(r=e["m.heroes"])===null||r===void 0?void 0:r.map(o=>({userId:o,fromMSC4186:!1})),i=e["m.joined_member_count"],a=e["m.invited_member_count"];Number.isInteger(i)&&this.currentState.setJoinedMemberCount(i),Number.isInteger(a)&&this.currentState.setInvitedMemberCount(a),Array.isArray(n)&&(this.heroes=n.filter(o=>o.userId!=this.myUserId)),this.emit(Ue.Summary,e)}setMSC4186SummaryData(e,r,n){e&&(this.heroes=e.filter(i=>i.user_id!==this.myUserId).map(i=>({userId:i.user_id,displayName:i.displayname,avatarUrl:i.avatar_url,fromMSC4186:!0}))),r!==void 0&&Number.isInteger(r)&&this.currentState.setJoinedMemberCount(r),n!==void 0&&Number.isInteger(n)&&this.currentState.setInvitedMemberCount(n),this.emit(Ue.Summary,{"m.heroes":this.heroes?this.heroes.map(i=>i.userId):[],"m.joined_member_count":r,"m.invited_member_count":n})}setBlacklistUnverifiedDevices(e){this.blacklistUnverifiedDevices=e}getBlacklistUnverifiedDevices(){return this.blacklistUnverifiedDevices===void 0?null:this.blacklistUnverifiedDevices}getAvatarUrl(e,r,n,i){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!1,s=this.currentState.getStateEvents(ge.RoomAvatar,"");if(!s&&!a)return null;var l=s?s.getContent().url:null;return l?Kb(e,l,r,n,i,void 0,void 0,o):null}getMxcAvatarUrl(){var e;return((e=this.currentState.getStateEvents(ge.RoomAvatar,""))===null||e===void 0||(e=e.getContent())===null||e===void 0?void 0:e.url)||null}getCanonicalAlias(){var e=this.currentState.getStateEvents(ge.RoomCanonicalAlias,"");return e&&e.getContent().alias||null}getAltAliases(){var e=this.currentState.getStateEvents(ge.RoomCanonicalAlias,"");return e?e.getContent().alt_aliases||[]:[]}addEventsToTimeline(e,r,n,i,a){i.getTimelineSet().addEventsToTimeline(e,r,n,i,a)}getThread(e){var r;return(r=this.threads.get(e))!==null&&r!==void 0?r:null}getThreads(){return Array.from(this.threads.values())}getMember(e){return this.currentState.getMember(e)}getMembers(){return this.currentState.getMembers()}getJoinedMembers(){return this.getMembersWithMembership(ct.Join)}getJoinedMemberCount(){return this.currentState.getJoinedMemberCount()}getInvitedMemberCount(){return this.currentState.getInvitedMemberCount()}getInvitedAndJoinedMemberCount(){return this.getInvitedMemberCount()+this.getJoinedMemberCount()}getMembersWithMembership(e){return this.currentState.getMembers().filter(function(r){return r.membership===e})}getEncryptionTargetMembers(){var e=this;return K(function*(){yield e.loadMembersIfNeeded();var r=e.getMembersWithMembership(ct.Join);return e.shouldEncryptForInvitedMembers()&&(r=r.concat(e.getMembersWithMembership(ct.Invite))),r})()}shouldEncryptForInvitedMembers(){var e,r=this.currentState.getStateEvents(ge.RoomHistoryVisibility,"");return(r==null||(e=r.getContent())===null||e===void 0?void 0:e.history_visibility)!=="joined"}getDefaultRoomName(e){return this.calculateRoomName(e,!0)}hasMembershipState(e,r){var n=this.getMember(e);return n?n.membership===r:!1}getOrCreateFilteredTimelineSet(e){var{prepopulateTimeline:r=!0,useSyncEvents:n=!0,pendingEvents:i=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(this.filteredTimelineSets[e.filterId])return this.filteredTimelineSets[e.filterId];var a=Object.assign({filter:e,pendingEvents:i},this.opts),o=new Qc(this,a);this.reEmitter.reEmit(o,[Ue.Timeline,Ue.TimelineReset]),n&&(this.filteredTimelineSets[e.filterId]=o,this.timelineSets.push(o));var s=this.getLiveTimeline();if(r){s.getEvents().forEach(function(d){o.addLiveEvent(d,{addToState:!1})});for(var l=s;l.getNeighbouringTimeline(Be.BACKWARDS);)l=l.getNeighbouringTimeline(Be.BACKWARDS);o.getLiveTimeline().setPaginationToken(l.getPaginationToken(Be.BACKWARDS),Be.BACKWARDS)}else if(n){var c=s.getPaginationToken(st.Forward);o.getLiveTimeline().setPaginationToken(c,st.Backward)}return o}getThreadListFilter(){var e=arguments,r=this;return K(function*(){var n=e.length>0&&e[0]!==void 0?e[0]:pa.All,i=r.client.getUserId(),a=new Yn(i),o={room:{timeline:{[Md.name]:[jt.name]}}};n===pa.My&&(o.room.timeline[Rd.name]=[i]),a.setDefinition(o);var s=yield r.client.getOrCreateFilter("THREAD_PANEL_".concat(r.roomId,"_").concat(n),a);return a.filterId=s,a})()}createThreadTimelineSet(e){var r=this;return K(function*(){var n;if(Jt.hasServerSideListSupport)n=new Qc(r,vh(vh({},r.opts),{},{pendingEvents:!1}),void 0,void 0,e??pa.All),r.reEmitter.reEmit(n,[Ue.Timeline,Ue.TimelineReset]);else if(Jt.hasServerSideSupport){var i=yield r.getThreadListFilter(e);n=r.getOrCreateFilteredTimelineSet(i,{prepopulateTimeline:!1,useSyncEvents:!1,pendingEvents:!1})}else n=new Qc(r,{pendingEvents:!1}),Array.from(r.threads).forEach(a=>{var[,o]=a;if(o.length!==0){var s=o.timeline.some(l=>l.getSender()===r.client.getUserId());(e!==pa.My||s)&&n.getLiveTimeline().addEvent(o.rootEvent,{toStartOfTimeline:!1,addToState:!1})}});return n})()}processThreadRoots(e,r){if(this.client.supportsThreads())for(var n of e)Be.setEventMetadata(n,this.currentState,r),this.getThread(n.getId())||this.createThread(n.getId(),n,[],r)}fetchRoomThreads(){var e=this;return K(function*(){if(!(e.threadsReady||!e.client.supportsThreads())){if(Jt.hasServerSideListSupport)yield Promise.all([e.fetchRoomThreadList(pa.All),e.fetchRoomThreadList(pa.My)]);else{var r=yield e.getThreadListFilter(),{chunk:n}=yield e.client.createMessagesRequest(e.roomId,"",Number.MAX_SAFE_INTEGER,st.Backward,r);if(!n.length)return;var i=n.map(e.client.getEventMapper()).sort((p,m)=>{var g=p.getServerAggregatedRelation(jt.name),y=m.getServerAggregatedRelation(jt.name);return g.latest_event.origin_server_ts-y.latest_event.origin_server_ts}),a,o=e.getLiveTimeline().getState(Be.FORWARDS);for(var s of i){var l,c={duplicateStrategy:fp.Ignore,fromCache:!1,addToState:!1,roomState:o};(l=e.threadsTimelineSets[0])===null||l===void 0||l.addLiveEvent(s,c);var d=s.getServerAggregatedRelation(jt.name);if(d!=null&&d.current_user_participated){var h;(h=e.threadsTimelineSets[1])===null||h===void 0||h.addLiveEvent(s,c),a=s}}e.processThreadRoots(i,!0),e.client.decryptEventIfNeeded(i[i.length-1]),a&&e.client.decryptEventIfNeeded(a)}e.on(Pn.NewReply,e.onThreadReply),e.on(Pn.Update,e.onThreadUpdate),e.on(Pn.Delete,e.onThreadDelete),e.threadsReady=!0}})()}processPollEvents(e){var r=this;return K(function*(){for(var n of e)try{if(!n.isEncrypted()&&!mV(n))continue;yield r.client.decryptEventIfNeeded(n),r.processPollEvent(n)}catch(i){U.warn("Error processing poll event",n.getId(),i)}})()}processPollEvent(e){var r=this;return K(function*(){if(e.isDecryptionFailure()){e.once(At.Decrypted,o=>{r.processPollEvent(o)});return}if(Fn.M_POLL_START.matches(e.getType())){try{var n=new pV(e,r.client,r);r.polls.set(e.getId(),n),r.emit(As.New,n),e.once(At.BeforeRedaction,o=>{r.polls.delete(o.getId())})}catch{}return}var i=e.relationEventId;if(i&&r.polls.has(i)){var a=r.polls.get(i);a==null||a.onNewRelation(e)}})()}fetchRoomThreadList(e){var r=this;return K(function*(){if(r.client.supportsThreads()&&r.threadsTimelineSets.length!==0){var n=e===pa.My?r.threadsTimelineSets[1]:r.threadsTimelineSets[0],{chunk:i,end:a}=yield r.client.createThreadListMessagesRequest(r.roomId,null,void 0,st.Backward,n.threadListType,n.getFilter());if(n.getLiveTimeline().setPaginationToken(a??null,st.Backward),!!i.length){var o=i.map(r.client.getEventMapper());r.processThreadRoots(o,!0);var s=r.getLiveTimeline().getState(Be.FORWARDS);for(var l of o)n.addLiveEvent(l,{duplicateStrategy:fp.Replace,fromCache:!1,roomState:s,addToState:!1})}}})()}onThreadUpdate(e){this.updateThreadRootEvents(e,!1,!1)}onThreadReply(e){this.updateThreadRootEvents(e,!1,!0)}onThreadDelete(e){var r;this.threads.delete(e.id);var n=this.getTimelineForEvent(e.id),i=n==null||(r=n.getEvents())===null||r===void 0?void 0:r.find(o=>o.getId()===e.id);i?e.clearEventMetadata(i):U.debug("onThreadDelete: Could not find root event in room timeline");for(var a of this.threadsTimelineSets)a.removeEvent(e.id)}removeFilteredTimelineSet(e){var r=this.filteredTimelineSets[e.filterId];delete this.filteredTimelineSets[e.filterId];var n=this.timelineSets.indexOf(r);n>-1&&this.timelineSets.splice(n,1)}eventShouldLiveIn(e,r,n){var i;if(!((i=this.client)!==null&&i!==void 0&&i.supportsThreads()))return{shouldLiveInRoom:!0,shouldLiveInThread:!1};if(e.isThreadRoot||n!=null&&n.has(e.getId()))return{shouldLiveInRoom:!0,shouldLiveInThread:!0,threadId:e.getId()};var a=e.isRelation(jt.name),o=e.getAssociatedId(),s=e.threadRootId;if(o&&!a&&(s===o||n!=null&&n.has(o)))return{shouldLiveInRoom:!0,shouldLiveInThread:!1};var l;if(o){var c;l=(c=this.findEventById(o))!==null&&c!==void 0?c:r==null?void 0:r.find(d=>d.getId()===o)}return l&&!a?this.eventShouldLiveIn(l,r,n):s!=null?{shouldLiveInRoom:!1,shouldLiveInThread:!0,threadId:s}:!o||e.replyEventId?{shouldLiveInRoom:!0,shouldLiveInThread:!1}:{shouldLiveInRoom:!1,shouldLiveInThread:!1}}findThreadForEvent(e){if(!e)return null;var{threadId:r}=this.eventShouldLiveIn(e);return r?this.getThread(r):null}addThreadedEvents(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=this.getThread(e);if(i)i.addEvents(r,n);else{var a,o=(a=this.findEventById(e))!==null&&a!==void 0?a:r.find(s=>s.getId()===e);this.createThread(e,o,r,n)}}processThreadedEvents(e,r){e.forEach(this.applyRedaction);var n={};for(var i of e){var a,{threadId:o,shouldLiveInThread:s}=this.eventShouldLiveIn(i);s&&!n[o]&&(n[o]=[]),(a=n[o])===null||a===void 0||a.push(i)}Object.entries(n).map(l=>{var[c,d]=l;return this.addThreadedEvents(c,d,r)})}createThread(e,r){var n,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],a=arguments.length>3?arguments[3]:void 0;if(this.threads.has(e))return this.threads.get(e);if(r){var o=this.relations.getAllChildEventsForEvent(r.getId());o!=null&&o.length&&(i=i.concat(o.filter(l=>!l.isRelation(gr.Replace))))}var s=new Jt(e,r,{room:this,client:this.client,pendingEventOrdering:this.opts.pendingEventOrdering,receipts:(n=this.cachedThreadReadReceipts.get(e))!==null&&n!==void 0?n:[]});return this.reEmitter.reEmit(s,[Pn.Delete,Pn.Update,Pn.NewReply,Ue.Timeline,Ue.TimelineReset]),this.cachedThreadReadReceipts.delete(e),this.threads.set(s.id,s),s.addEvents(i,!1),this.threadsReady&&s.initialEventsFetched&&this.updateThreadRootEvents(s,a,!1),this.emit(Pn.New,s,a),s}processLiveEvent(e){this.applyRedaction(e),e.isVisibilityEvent()&&this.applyNewVisibilityEvent(e),this.applyPendingVisibilityEvents(e);var r=e.getUnsigned().transaction_id;if(!r&&e.getSender()===this.myUserId){for(var[n,i]of this.txnToEvent)if(i.getId()===e.getId()){U.debug("processLiveEvent: found sent event without txn ID: ",n,e.getId());var a=e.getUnsigned();a.transaction_id=n,e.setUnsigned(a);break}}}addLiveEvent(e,r){var{duplicateStrategy:n,timelineWasEmpty:i,fromCache:a,addToState:o}=r;for(var s of this.timelineSets)s.addLiveEvent(e,{duplicateStrategy:n,fromCache:a,timelineWasEmpty:i,addToState:o});e.sender&&e.getType()!==ge.RoomRedaction&&this.addReceipt(fV(e.sender.userId,e,In.Read),!0)}addPendingEvent(e,r){if(e.status!==Ze.SENDING&&e.status!==Ze.NOT_SENT)throw new Error("addPendingEvent called on an event with status "+e.status);if(this.txnToEvent.get(r))throw new Error("addPendingEvent called on an event with known txnId "+r);if(Be.setEventMetadata(e,this.getLiveTimeline().getState(Be.FORWARDS),!1),this.txnToEvent.set(r,e),this.pendingEventList){if(this.pendingEventList.some(o=>o.status===Ze.NOT_SENT)&&(U.warn("Setting event as NOT_SENT due to messages in the same state"),e.setStatus(Ze.NOT_SENT)),this.pendingEventList.push(e),this.savePendingEvents(),e.isRelation()&&this.aggregateNonLiveRelation(e),e.isRedaction()){var n=e.event.redacts,i=this.pendingEventList.find(o=>o.getId()===n);!i&&n&&(i=this.findEventById(n)),i&&(i.markLocallyRedacted(e),this.emit(Ue.Redaction,e,this,i.threadRootId))}}else for(var a of this.timelineSets)a.getFilter()?a.getFilter().filterRoomTimeline([e]).length&&a.addEventToTimeline(e,a.getLiveTimeline(),{toStartOfTimeline:!1,addToState:!1}):a.addEventToTimeline(e,a.getLiveTimeline(),{toStartOfTimeline:!1,addToState:!1});this.emit(Ue.LocalEchoUpdated,e,this)}savePendingEvents(){if(this.pendingEventList){var e=this.pendingEventList.map(r=>vh(vh({},r.event),{},{txn_id:r.getTxnId()})).filter(r=>{var n=r.type===ge.RoomMessageEncrypted,i=this.hasEncryptionStateEvent();return n||!i});this.client.store.setPendingEvents(this.roomId,e)}}aggregateNonLiveRelation(e){this.relations.aggregateChildEvent(e)}getEventForTxnId(e){return this.txnToEvent.get(e)}handleRemoteEcho(e,r){var n=r.getId(),i=e.getId(),a=r.status;U.debug("Got remote echo for event ".concat(n," -> ").concat(i," old status ").concat(a)),this.txnToEvent.delete(e.getUnsigned().transaction_id),this.pendingEventList&&this.removePendingEvent(n),r.handleRemoteEcho(e.event);var{shouldLiveInRoom:o,threadId:s}=this.eventShouldLiveIn(e),l=s?this.getThread(s):null;if(l==null||l.setEventMetadata(r),l==null||l.timelineSet.handleRemoteEcho(r,n,i),o)for(var c of this.timelineSets)c.handleRemoteEcho(r,n,i);this.emit(Ue.LocalEchoUpdated,r,this,n,a)}updatePendingEvent(e,r,n){if(U.log("setting pendingEvent status to ".concat(r," in ").concat(e.getRoomId()," ")+"event ID ".concat(e.getId()," -> ").concat(n)),r==Ze.SENT&&!n)throw new Error("updatePendingEvent called with status=SENT, but no new event id");if(r==Ze.SENT){var i=this.getTimelineForEvent(n);if(i){var a=this.findEventById(n),o=a==null?void 0:a.getUnsigned().transaction_id;if(!o&&a){var s=a.getUnsigned();s.transaction_id=e.getTxnId(),a.setUnsigned(s),this.removeEvent(a.getId()),this.handleRemoteEcho(a,e)}return}}var l=e.status,c=e.getId();if(!l)throw new Error("updatePendingEventStatus called on an event which is not a local echo.");var d=Hhe[l];if(!(d!=null&&d.includes(r)))throw new Error("Invalid EventStatus transition ".concat(l,"->").concat(r));if(e.setStatus(r),r==Ze.SENT){e.replaceLocalEventId(n);var{shouldLiveInRoom:h,threadId:p}=this.eventShouldLiveIn(e),m=p?this.getThread(p):void 0;if(m==null||m.setEventMetadata(e),m==null||m.timelineSet.replaceEventId(c,n),h)for(var g of this.timelineSets)g.replaceEventId(c,n)}else if(r==Ze.CANCELLED){if(this.pendingEventList){var y=this.getPendingEvent(c);this.removePendingEvent(c),y!=null&&y.isRedaction()&&this.revertRedactionLocalEcho(y)}this.removeEvent(c)}this.savePendingEvents(),this.emit(Ue.LocalEchoUpdated,e,this,c,l)}revertRedactionLocalEcho(e){var r=e.event.redacts;if(r){var n=this.getUnfilteredTimelineSet().findEventById(r);n&&(n.unmarkLocallyRedacted(),this.emit(Ue.RedactionCancelled,e,this),n.isRelation()&&this.aggregateNonLiveRelation(n))}}assertTimelineSetsAreLive(){for(var e=0;e<this.timelineSets.length;e++){var r=this.timelineSets[e].getLiveTimeline();if(r.getPaginationToken(Be.FORWARDS))throw new Error("live timeline "+e+" is no longer live - it has a pagination token ("+r.getPaginationToken(Be.FORWARDS)+")");if(r.getNeighbouringTimeline(Be.FORWARDS))throw new Error("live timeline ".concat(e," is no longer live - it has a neighbouring timeline"))}}addLiveEvents(e,r){var n=this;return K(function*(){var{duplicateStrategy:i,fromCache:a,timelineWasEmpty:o=!1,addToState:s}=r;if(i&&["replace","ignore"].indexOf(i)===-1)throw new Error("duplicateStrategy MUST be either 'replace' or 'ignore'");n.assertTimelineSetsAreLive();var l=n.findThreadRoots(e),c={},d={duplicateStrategy:i,fromCache:a,timelineWasEmpty:o,addToState:s},h=[...e];for(var p of e){var m;if(n.processLiveEvent(p),p.getUnsigned().transaction_id){var g=n.txnToEvent.get(p.getUnsigned().transaction_id);if(g){n.handleRemoteEcho(p,g);continue}}var{shouldLiveInRoom:y,shouldLiveInThread:R,threadId:b=""}=n.eventShouldLiveIn(p,h,l);if(!R&&!y&&p.isRelation())try{var _=new Bn(yield n.client.fetchRoomEvent(n.roomId,p.relationEventId));if(h.push(_),_.threadRootId){l.add(_.threadRootId);var x=p.getUnsigned();x[D0.name]=_.threadRootId,p.setUnsigned(x)}({shouldLiveInRoom:y,shouldLiveInThread:R,threadId:b=""}=n.eventShouldLiveIn(p,h,l))}catch(T){U.error("Failed to load parent event of unhandled relation",T)}R&&!c[b]&&(c[b]=[]),(m=c[b])===null||m===void 0||m.push(p),y?n.addLiveEvent(p,d):!R&&p.isRelation()&&n.relations.aggregateChildEvent(p)}Object.entries(c).forEach(T=>{var[I,C]=T;n.addThreadedEvents(I,C,!1)})})()}partitionThreadedEvents(e){var r=0,n=1,i=2;if(this.client.supportsThreads()){var a=this.findThreadRoots(e);return e.reduce((o,s)=>{var{shouldLiveInRoom:l,shouldLiveInThread:c,threadId:d}=this.eventShouldLiveIn(s,e,a);return l&&o[r].push(s),c&&(s.setThreadId(d??""),o[n].push(s)),!c&&!l&&o[i].push(s),o},[[],[],[]])}else return[e,[],[]]}findThreadRoots(e){var r=new Set;for(var n of e){var i=n.threadRootId;i!=null&&r.add(i)}return r}addReceipt(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=e.getContent();this.roomReceipts.add(n,r),Object.keys(n).forEach(i=>{Object.keys(n[i]).forEach(a=>{Object.keys(n[i][a]).forEach(o=>{var s,l,c,d=n[i][a][o],h=!d.thread_id||d.thread_id===Zm,p=h?this:this.threads.get((s=d.thread_id)!==null&&s!==void 0?s:"");if(p){if(p.addReceiptToStructure(i,a,o,d,r),!r&&this.client.isInitialSyncComplete()&&o===this.client.getUserId()){var m=p.timeline[p.timeline.length-1];m&&i===m.getId()&&o===m.getSender()&&(p.setUnread(It.Total,0),p.setUnread(It.Highlight,0))}}else{var g;this.cachedThreadReadReceipts.set(d.thread_id,[...(g=this.cachedThreadReadReceipts.get(d.thread_id))!==null&&g!==void 0?g:[],{eventId:i,receiptType:a,userId:o,receipt:d,synthetic:r}])}var y=this.client.getUserId();o===y&&!h&&d.ts<this.oldestThreadedReceiptTs&&(this.oldestThreadedReceiptTs=d.ts),!d.thread_id&&d.ts>((l=(c=this.unthreadedReceipts.get(o))===null||c===void 0?void 0:c.ts)!==null&&l!==void 0?l:0)&&this.unthreadedReceipts.set(o,d)})})}),this.emit(Ue.Receipt,e,this)}addEphemeralEvents(e){for(var r of e)r.getType()===ge.Typing?this.currentState.setTypingEvent(r):r.getType()===ge.Receipt&&this.addReceipt(r)}removeEvents(e){for(var r of e)this.removeEvent(r)}removeEvent(e){var r=!1;for(var n of this.timelineSets){var i=n.removeEvent(e);i&&(i.isRedaction()&&this.revertRedactionLocalEcho(i),r=!0)}return r}recalculate(){var e=this.currentState.getStateEvents(ge.RoomMember,this.myUserId);if(e){var r=e.getContent().membership;if(this.updateMyMembership(r),r===ct.Invite){var n=e.getUnsigned().invite_room_state||[];n.forEach(a=>{var o=this.currentState.getStateEvents(a.type,a.state_key);o||this.currentState.setStateEvents([new Bn({type:a.type,state_key:a.state_key,content:a.content,event_id:"$fake"+Date.now(),room_id:this.roomId,sender:this.myUserId})])})}}var i=this.name;this.name=this.calculateRoomName(this.myUserId),this.normalizedName=uce(this.name),this.summary=new Xj(this.roomId,{title:this.name}),i!==this.name&&this.emit(Ue.Name,this)}addTags(e){this.tags=e.getContent().tags||{},this.emit(Ue.Tags,e,this)}addAccountData(e){for(var r of e){r.getType()==="m.tag"&&this.addTags(r);var n=r.getType(),i=this.accountData.get(n);this.accountData.set(n,r),this.emit(Ue.AccountData,r,this,i)}}getAccountData(e){return this.accountData.get(e)}maySendMessage(){return this.getMyMembership()===ct.Join&&(this.hasEncryptionStateEvent()?this.currentState.maySendEvent(ge.RoomMessageEncrypted,this.myUserId):this.currentState.maySendEvent(ge.RoomMessage,this.myUserId))}canInvite(e){var r=this.getMyMembership()===ct.Join,n=this.currentState.getStateEvents(ge.RoomPowerLevels,""),i=n&&n.getContent(),a=this.getMember(e);return i&&a&&i.invite>a.powerLevel&&(r=!1),r}getJoinRule(){return this.currentState.getJoinRule()}getHistoryVisibility(){return this.currentState.getHistoryVisibility()}getGuestAccess(){return this.currentState.getGuestAccess()}getType(){var e=this.currentState.getStateEvents(ge.RoomCreate,"");if(!e){this.getTypeWarning||(U.warn("[getType] Room "+this.roomId+" does not have an m.room.create event"),this.getTypeWarning=!0);return}return e.getContent()[T0]}isSpaceRoom(){return this.getType()===Sd.Space}isCallRoom(){return this.getType()===Sd.UnstableCall}isElementVideoRoom(){return this.getType()===Sd.ElementVideo}findPredecessor(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,r=this.getLiveTimeline().getState(Be.FORWARDS);return r?r.findPredecessor(e):null}roomNameGenerator(e){if(this.client.roomNameGenerator){var r=this.client.roomNameGenerator(this.roomId,e);if(r!==null)return r}switch(e.type){case Na.Actual:return e.name;case Na.Generated:switch(e.subtype){case"Inviting":return"Inviting ".concat(zA(e.names,e.count));default:return zA(e.names,e.count)}case Na.EmptyRoom:return e.oldName?"Empty room (was ".concat(e.oldName,")"):"Empty room"}}calculateRoomName(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(!r){var n=this.currentState.getStateEvents(ge.RoomName,"");if(n!=null&&n.getContent().name)return this.roomNameGenerator({type:Na.Actual,name:n.getContent().name})}var i=this.getCanonicalAlias();if(i)return this.roomNameGenerator({type:Na.Actual,name:i});var a=this.currentState.getJoinedMemberCount(),o=this.currentState.getInvitedMemberCount(),s=a+o-1,l=this.getFunctionalMembers(),c=[];if(this.heroes)this.heroes.forEach(b=>{if(l.includes(b.userId)){s--;return}if(b.displayName)c.push(b.displayName);else{var _=this.getMember(b.userId);c.push(_?_.name:b.userId)}});else{var d=this.currentState.getMembers().filter(b=>b.userId!==e&&(b.membership===ct.Invite||b.membership===ct.Join));d=d.filter(b=>{var{userId:_}=b;return l.includes(_)?(s--,!1):!0});var h=new Intl.Collator;d.sort((b,_)=>h.compare(b.userId,_.userId)),d=d.slice(0,5),c=d.map(b=>b.name)}if(s)return this.roomNameGenerator({type:Na.Generated,names:c,count:s});var p=this.getMyMembership();if(p==ct.Join){var m=this.currentState.getStateEvents(ge.RoomThirdPartyInvite);if(m!=null&&m.length){var g=m.map(b=>b.getContent().display_name);return this.roomNameGenerator({type:Na.Generated,subtype:"Inviting",names:g,count:g.length+1})}}var y=c;y.length||(y=this.currentState.getMembers().filter(b=>b.userId!==e&&b.membership!==ct.Invite&&b.membership!==ct.Join).map(b=>b.name));var R;return y.length&&(R=this.roomNameGenerator({type:Na.Generated,names:y,count:y.length+1})),this.roomNameGenerator({type:Na.EmptyRoom,oldName:R})}applyNewVisibilityEvent(e){var r=e.asVisibilityChange();if(r){var n=e.getSender();if(n){var i=su.name&&this.currentState.maySendStateEvent(su.name,n)||su.altName&&this.currentState.maySendStateEvent(su.altName,n);if(i){var a=this.visibilityEvents.get(r.eventId);if(a){for(var o=a.length-1,s=Math.max(0,a.length-Khe);o>=s;--o){var l=a[o];if(l.getTs()<e.getTs())break}o===-1?a.unshift(e):a.splice(o+1,0,e)}else this.visibilityEvents.set(r.eventId,[e]);var c=this.findEventById(r.eventId);c&&c.applyVisibilityEvent(r)}}}}redactVisibilityChangeEvent(e){if(!e.isVisibilityEvent)throw new Error("expected a visibility change event");var r=e.getRelation(),n=r==null?void 0:r.event_id,i=this.visibilityEvents.get(n);if(i){var a=i.findIndex(c=>c.getId()===e.getId());if(a!==-1&&(i.splice(a,1),a===i.length)){var o=this.findEventById(n);if(!o)return;if(a===0)this.visibilityEvents.delete(n),o.applyVisibilityEvent();else{var s=i[i.length-1],l=s.asVisibilityChange();if(!l)throw new Error("at this stage, visibility changes should be well-formed");o.applyVisibilityEvent(l)}}}}applyPendingVisibilityEvents(e){var r=this.visibilityEvents.get(e.getId());if(!(!r||r.length==0)){var n=r[r.length-1],i=n.asVisibilityChange();i&&(i.visible,!(n.getTs()<e.getTs())&&e.applyVisibilityEvent(i))}}getOldestThreadedReceiptTs(){return this.oldestThreadedReceiptTs}hasUserReadEvent(e,r){return this.roomReceipts.hasUserReadEvent(e,r)}getLastUnthreadedReceiptFor(e){return this.unthreadedReceipts.get(e)}fixupNotifications(e){super.fixupNotifications(e);var r=this.getThreads().filter(i=>this.getThreadUnreadNotificationCount(i.id,It.Total)>0);for(var n of r)n.fixupNotifications(e)}compareEventOrdering(e,r){return She(this,e,r)}hasEncryptionStateEvent(){var e;return!!(!((e=this.getLiveTimeline().getState(Be.FORWARDS))===null||e===void 0)&&e.getStateEvents(ge.RoomEncryption,""))}}var Hhe={[Ze.ENCRYPTING]:[Ze.SENDING,Ze.NOT_SENT,Ze.CANCELLED],[Ze.SENDING]:[Ze.ENCRYPTING,Ze.QUEUED,Ze.NOT_SENT,Ze.SENT],[Ze.QUEUED]:[Ze.SENDING,Ze.NOT_SENT,Ze.CANCELLED],[Ze.SENT]:[],[Ze.NOT_SENT]:[Ze.SENDING,Ze.QUEUED,Ze.CANCELLED],[Ze.CANCELLED]:[]},Na=function(t){return t[t.EmptyRoom=0]="EmptyRoom",t[t.Generated=1]="Generated",t[t.Actual=2]="Actual",t}({});function zA(t,e){var r=e-1;if(t.length){if(t.length===1&&r<=1)return t[0];if(t.length===2&&r<=2)return"".concat(t[0]," and ").concat(t[1]);var n=r>1;return n?"".concat(t[0]," and ").concat(r," others"):"".concat(t[0]," and 1 other")}else return"Empty room"}var Fr=function(t){return t[t.Stable=0]="Stable",t[t.Unstable=1]="Unstable",t[t.Unsupported=2]="Unsupported",t}({}),jr=function(t){return t.Thread="Thread",t.ThreadUnreadNotifications="ThreadUnreadNotifications",t.LoginTokenRequest="LoginTokenRequest",t.RelationBasedRedactions="RelationBasedRedactions",t.AccountDataDeletion="AccountDataDeletion",t.RelationsRecursion="RelationsRecursion",t.IntentionalMentions="IntentionalMentions",t}({}),Whe={[jr.Thread]:{unstablePrefixes:["org.matrix.msc3440"],matrixVersion:"v1.3"},[jr.ThreadUnreadNotifications]:{unstablePrefixes:["org.matrix.msc3771","org.matrix.msc3773"],matrixVersion:"v1.4"},[jr.LoginTokenRequest]:{unstablePrefixes:["org.matrix.msc3882"]},[jr.RelationBasedRedactions]:{unstablePrefixes:["org.matrix.msc3912"]},[jr.AccountDataDeletion]:{unstablePrefixes:["org.matrix.msc3391"]},[jr.RelationsRecursion]:{unstablePrefixes:["org.matrix.msc3981"],matrixVersion:"v1.10"},[jr.IntentionalMentions]:{unstablePrefixes:["org.matrix.msc3952_intentional_mentions"],matrixVersion:"v1.7"}};function Ghe(t){return Fx.apply(this,arguments)}function Fx(){return Fx=K(function*(t){var e=new Map;for(var[r,n]of Object.entries(Whe)){var i,a,o,s,l=(i=(a=t.versions)===null||a===void 0?void 0:a.includes(n.matrixVersion||""))!==null&&i!==void 0?i:!1,c=(o=(s=n.unstablePrefixes)===null||s===void 0?void 0:s.every(d=>{var h;return((h=t.unstable_features)===null||h===void 0?void 0:h[d])===!0}))!==null&&o!==void 0?o:!1;l?e.set(r,Fr.Stable):c?e.set(r,Fr.Unstable):e.set(r,Fr.Unsupported)}return e}),Fx.apply(this,arguments)}function KA(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function L0(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?KA(Object(r),!0).forEach(function(n){E(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):KA(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var HA=80*1e3,qhe=3,Lt=function(t){return t.Error="ERROR",t.Prepared="PREPARED",t.Stopped="STOPPED",t.Syncing="SYNCING",t.Catchup="CATCHUP",t.Reconnecting="RECONNECTING",t}({}),Zhe=["org.matrix.msc2716v3"];function WA(t,e){return"FILTER_SYNC_".concat(t)+(e?"_"+e:"")}function ar(){U.log(...arguments)}var CV=function(t){return t.Offline="offline",t.Online="online",t.Unavailable="unavailable",t}({});function TV(t){return L0({initialSyncLimit:8,resolveInvitesToProfiles:!1,pollTimeout:30*1e3,pendingEventOrdering:sf.Chronological,threadSupport:!1},t)}function DV(t){return L0({canResetEntireTimeline:e=>!1},t)}class lu{constructor(e,r,n){var i=this;this.client=e,E(this,"opts",void 0),E(this,"syncOpts",void 0),E(this,"_peekRoom",null),E(this,"currentSyncRequest",void 0),E(this,"abortController",void 0),E(this,"syncState",null),E(this,"syncStateData",void 0),E(this,"catchingUp",!1),E(this,"running",!1),E(this,"keepAliveTimer",void 0),E(this,"connectionReturnedDefer",void 0),E(this,"notifEvents",[]),E(this,"failedSyncCount",0),E(this,"storeIsInvalid",!1),E(this,"presence",void 0),E(this,"getPushRules",K(function*(){try{ar("Getting push rules...");var a=yield i.client.getPushRules();ar("Got push rules"),i.client.pushRules=a}catch(o){return U.error("Getting push rules failed",o),i.shouldAbortSync(o)?void 0:(ar("Waiting for saved sync before retrying push rules..."),yield i.recoverFromSyncStartupError(i.savedSyncPromise,o),i.getPushRules())}})),E(this,"buildDefaultFilter",()=>{var a=new Yn(this.client.credentials.userId);return this.client.canSupport.get(jr.ThreadUnreadNotifications)!==Fr.Unsupported&&a.setUnreadThreadNotifications(!0),a}),E(this,"prepareLazyLoadingForSync",K(function*(){ar("Prepare lazy loading for sync..."),i.client.isGuest()&&(i.opts.lazyLoadMembers=!1),i.opts.lazyLoadMembers&&(ar("Enabling lazy load on sync filter..."),i.opts.filter||(i.opts.filter=i.buildDefaultFilter()),i.opts.filter.setLazyLoadMembers(!0))})),E(this,"storeClientOptions",K(function*(){try{ar("Storing client options..."),yield i.client.storeClientOptions(),ar("Stored client options")}catch(a){throw U.error("Storing client options failed",a),a}})),E(this,"getFilter",K(function*(){ar("Getting filter...");var a;i.opts.filter?a=i.opts.filter:a=i.buildDefaultFilter();var o;try{o=yield i.client.getOrCreateFilter(WA(i.client.credentials.userId),a)}catch(s){return U.error("Getting filter failed",s),i.shouldAbortSync(s)?{}:(ar("Waiting for saved sync before retrying filter..."),yield i.recoverFromSyncStartupError(i.savedSyncPromise,s),i.getFilter())}return{filter:a,filterId:o}})),E(this,"savedSyncPromise",void 0),E(this,"onOnline",()=>{ar("Browser thinks we are back online"),this.startKeepAlives(0)}),this.opts=TV(r),this.syncOpts=DV(n),e.getNotifTimelineSet()&&e.reEmitter.reEmit(e.getNotifTimelineSet(),[Ue.Timeline,Ue.TimelineReset])}createRoom(e){var r=RV(this.client,e,this.opts);return r.on(dt.Marker,(n,i)=>{this.onMarkerStateEvent(r,n,i)}),r}onMarkerStateEvent(e,r){var{timelineWasEmpty:n}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(n){U.debug("MarkerState: Ignoring markerEventId=".concat(r.getId()," in roomId=").concat(e.roomId," ")+"because the timeline was empty before the marker arrived which means there is nothing to refresh.");return}var i=Zhe.includes(e.getVersion())||r.getSender()===e.getCreator();i?(U.debug("MarkerState: Timeline needs to be refreshed because "+"a new markerEventId=".concat(r.getId()," was sent in roomId=").concat(e.roomId)),e.setTimelineNeedsRefresh(!0),e.emit(Ue.HistoryImportedWithinTimeline,r,e)):U.debug("MarkerState: Ignoring markerEventId=".concat(r.getId()," in roomId=").concat(e.roomId," because ")+"MSC2716 is not supported in the room version or for any room version, the marker wasn't sent by the room creator.")}syncLeftRooms(){var e=this;return K(function*(){var r,n=e.client,i=new Yn(e.client.credentials.userId);i.setTimelineLimit(1),i.setIncludeLeaveRooms(!0);var a=e.opts.pollTimeout+HA,o=yield n.getOrCreateFilter(WA(n.credentials.userId,"LEFT_ROOMS"),i),s={timeout:0,filter:o,"org.matrix.msc4222.use_state_after":!0},l=yield n.http.authedRequest(_e.Get,"/sync",s,void 0,{localTimeoutMs:a}),c=[];(r=l.rooms)!==null&&r!==void 0&&r.leave&&(c=e.mapSyncResponseToRoomArray(l.rooms.leave));var d=yield Promise.all(c.map(function(){var h=K(function*(p){var m=p.room;if(p.isBrandNewRoom){p.timeline=p.timeline||{prev_batch:null,events:[]},m.getLiveTimeline().setPaginationToken(p.timeline.prev_batch,Be.BACKWARDS);var{timelineEvents:g}=yield e.mapAndInjectRoomEvents(p);return m.recalculate(),n.store.storeRoom(m),n.emit(je.Room,m),e.processEventsForNotifs(m,g),m}});return function(p){return h.apply(this,arguments)}}()));return d.filter(Boolean)})()}peek(e){var r,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:20;if(((r=this._peekRoom)===null||r===void 0?void 0:r.roomId)===e)return Promise.resolve(this._peekRoom);var i=this.client;return this._peekRoom=this.createRoom(e),this.client.roomInitialSync(e,n).then(a=>{var o;if(((o=this._peekRoom)===null||o===void 0?void 0:o.roomId)!==e)throw new Error("Peeking aborted");a.messages=a.messages||{chunk:[]},a.messages.chunk=a.messages.chunk||[],a.state=a.state||[];var s=Ym(a.state).map(i.getEventMapper()),l=a.state.map(i.getEventMapper()),c=a.messages.chunk.map(i.getEventMapper());return Array.isArray(a.presence)&&a.presence.map(i.getEventMapper()).forEach(function(d){var h=i.store.getUser(d.getContent().user_id);h?h.setPresenceEvent(d):(h=Zo.createUser(d.getContent().user_id,i),h.setPresenceEvent(d),i.store.storeUser(h)),i.emit(je.Event,d)}),a.messages.start&&(this._peekRoom.oldState.paginationToken=a.messages.start),this._peekRoom.oldState.setStateEvents(s),this._peekRoom.currentState.setStateEvents(l),this.resolveInvites(this._peekRoom),this._peekRoom.recalculate(),this._peekRoom.addEventsToTimeline(c.reverse(),!0,!0,this._peekRoom.getLiveTimeline(),a.messages.start),i.store.storeRoom(this._peekRoom),i.emit(je.Room,this._peekRoom),this.peekPoll(this._peekRoom),this._peekRoom})}stopPeeking(){this._peekRoom=null}peekPoll(e,r){var n,i=this;if(this._peekRoom!==e){ar("Stopped peeking in room %s",e.roomId);return}this.client.http.authedRequest(_e.Get,"/events",{room_id:e.roomId,timeout:String(30*1e3),from:r},void 0,{localTimeoutMs:50*1e3,abortSignal:(n=this.abortController)===null||n===void 0?void 0:n.signal}).then(function(){var a=K(function*(o){if(i._peekRoom!==e){ar("Stopped peeking in room %s",e.roomId);return}o.chunk.filter(function(l){return l.type==="m.presence"}).map(i.client.getEventMapper()).forEach(l=>{var c=i.client.store.getUser(l.getContent().user_id);c?c.setPresenceEvent(l):(c=Zo.createUser(l.getContent().user_id,i.client),c.setPresenceEvent(l),i.client.store.storeUser(c)),i.client.emit(je.Event,l)});var s=o.chunk.filter(function(l){return l.room_id===e.roomId&&l.event_id}).map(i.client.getEventMapper());yield e.addLiveEvents(s,{addToState:!0}),i.peekPoll(e,o.end)});return function(o){return a.apply(this,arguments)}}(),a=>{U.error("[%s] Peek poll failed: %s",e.roomId,a),setTimeout(()=>{this.peekPoll(e,r)},30*1e3)})}getSyncState(){return this.syncState}getSyncStateData(){var e;return(e=this.syncStateData)!==null&&e!==void 0?e:null}recoverFromSyncStartupError(e,r){var n=this;return K(function*(){yield e;var i=n.startKeepAlives();n.updateSyncState(Lt.Error,{error:r}),yield i})()}shouldAbortSync(e){return e.errcode==="M_UNKNOWN_TOKEN"?(U.warn("Token no longer valid - assuming logout"),this.stop(),this.updateSyncState(Lt.Error,{error:e}),!0):!1}sync(){var e=this;return K(function*(){var r,n;if(e.running=!0,e.abortController=new AbortController,(r=globalThis.window)===null||r===void 0||(n=r.addEventListener)===null||n===void 0||n.call(r,"online",e.onOnline,!1),e.client.isGuest())return e.doSync({});ar("Getting saved sync token...");var i=e.client.store.getSavedSyncToken().then(d=>(ar("Got saved sync token"),d));e.savedSyncPromise=e.client.store.getSavedSync().then(d=>{if(ar("Got reply from saved sync, exists? ".concat(!!d)),d)return e.syncFromCache(d)}).catch(d=>{U.error("Getting saved sync failed",d)}),yield e.getPushRules(),yield e.prepareLazyLoadingForSync(),yield e.storeClientOptions();var{filterId:a,filter:o}=yield e.getFilter();if(o){if(e.client.resetNotifTimelineSet(),!e.currentSyncRequest){var s=a,l=yield i;if(l)ar("Sending first sync request...");else{ar("Sending initial sync request...");var c=e.buildDefaultFilter();c.setDefinition(o.getDefinition()),c.setTimelineLimit(e.opts.initialSyncLimit),s=JSON.stringify(c.getDefinition())}e.currentSyncRequest=e.doSyncRequest({filter:s},l)}return ar("Waiting for saved sync before starting sync processing..."),yield e.savedSyncPromise,e.doSync({filter:a})}})()}stop(){var e,r,n;ar("SyncApi.stop"),(e=globalThis.window)===null||e===void 0||(r=e.removeEventListener)===null||r===void 0||r.call(e,"online",this.onOnline,!1),this.running=!1,(n=this.abortController)===null||n===void 0||n.abort(),this.keepAliveTimer&&(clearTimeout(this.keepAliveTimer),this.keepAliveTimer=void 0)}retryImmediately(){return this.connectionReturnedDefer?(this.startKeepAlives(0),!0):!1}syncFromCache(e){var r=this;return K(function*(){ar("sync(): not doing HTTP hit, instead returning stored /sync data");var n=e.nextBatch;r.client.store.setSyncToken(n);var i={nextSyncToken:n,catchingUp:!1,fromCache:!0},a={next_batch:n,rooms:e.roomsData,account_data:{events:e.accountData}};try{yield r.processSyncResponse(i,a)}catch(o){U.error("Error processing cached sync",o)}r.storeIsInvalid||r.updateSyncState(Lt.Prepared,i)})()}doSync(e){var r=this;return K(function*(){for(;r.running;){var n=r.client.store.getSyncToken(),i=void 0;try{r.currentSyncRequest||(r.currentSyncRequest=r.doSyncRequest(e,n)),i=yield r.currentSyncRequest}catch(s){var a=yield r.onSyncError(s);if(a)return;continue}finally{r.currentSyncRequest=void 0}r.client.store.setSyncToken(i.next_batch),r.failedSyncCount=0;var o={oldSyncToken:n??void 0,nextSyncToken:i.next_batch,catchingUp:r.catchingUp};try{yield r.processSyncResponse(o,i)}catch(s){U.error("Caught /sync error",s),r.client.emit(je.SyncUnexpectedError,s)}yield r.client.store.setSyncData(i),o.catchingUp=r.catchingUp,e.hasSyncedBefore||(r.updateSyncState(Lt.Prepared,o),e.hasSyncedBefore=!0),r.syncOpts.cryptoCallbacks&&(yield r.syncOpts.cryptoCallbacks.onSyncCompleted(o)),r.updateSyncState(Lt.Syncing,o),r.client.store.wantsSave()&&(yield r.client.store.save())}r.running||(ar("Sync no longer running: exiting."),r.connectionReturnedDefer&&(r.connectionReturnedDefer.reject(),r.connectionReturnedDefer=void 0),r.updateSyncState(Lt.Stopped))})()}doSyncRequest(e,r){var n,i=this.getSyncParams(e,r);return this.client.http.authedRequest(_e.Get,"/sync",i,void 0,{localTimeoutMs:i.timeout+HA,abortSignal:(n=this.abortController)===null||n===void 0?void 0:n.signal})}getSyncParams(e,r){var n=this.opts.pollTimeout;(this.getSyncState()!==Lt.Syncing||this.catchingUp)&&(this.catchingUp=!0,n=0);var i=e.filter;this.client.isGuest()&&!i&&(i=this.getGuestFilter());var a={filter:i,timeout:n,"org.matrix.msc4222.use_state_after":!0};return this.opts.disablePresence?a.set_presence=CV.Offline:this.presence!==void 0&&(a.set_presence=this.presence),r?a.since=r:a._cacheBuster=Date.now(),[Lt.Reconnecting,Lt.Error].includes(this.getSyncState())&&(a.timeout=0),a}setPresence(e){this.presence=e}onSyncError(e){var r=this;return K(function*(){if(!r.running)return ar("Sync no longer running: exiting"),r.connectionReturnedDefer&&(r.connectionReturnedDefer.reject(),r.connectionReturnedDefer=void 0),r.updateSyncState(Lt.Stopped),!0;if(U.error("/sync error %s",e),r.shouldAbortSync(e))return!0;r.failedSyncCount++,U.log("Number of consecutive failed sync requests:",r.failedSyncCount),ar("Starting keep-alive");var n=r.startKeepAlives();r.currentSyncRequest=void 0,r.updateSyncState(r.failedSyncCount>=qhe?Lt.Error:Lt.Reconnecting,{error:e});var i=yield n;return i&&r.getSyncState()===Lt.Error&&r.updateSyncState(Lt.Catchup,{catchingUp:!0}),!1})()}processSyncResponse(e,r){var n=this;return K(function*(){var i,a,o,s,l=n.client;if(Array.isArray((i=r.presence)===null||i===void 0?void 0:i.events)&&r.presence.events.filter(ya).map(l.getEventMapper()).forEach(function(b){var _=l.store.getUser(b.getSender());_?_.setPresenceEvent(b):(_=Zo.createUser(b.getSender(),l),_.setPresenceEvent(b),l.store.storeUser(_)),l.emit(je.Event,b)}),Array.isArray((a=r.account_data)===null||a===void 0?void 0:a.events)){var c=r.account_data.events.filter(ya).map(l.getEventMapper()),d=c.reduce((b,_)=>(b[_.getType()]=l.store.getAccountData(_.getType()),b),{});l.store.storeAccountDataEvents(c),c.forEach(function(b){if(b.getType()===ge.PushRules){var _=b.getContent();l.setPushRules(_)}var x=d[b.getType()];return l.emit(je.AccountData,b,x),b})}if(r.to_device&&Array.isArray(r.to_device.events)&&r.to_device.events.length>0){var h=r.to_device.events.filter(ya);n.syncOpts.cryptoCallbacks&&(h=yield n.syncOpts.cryptoCallbacks.preprocessToDeviceMessages(h));var p=[];h.map(MV).map(b=>{if(b.getType()==="m.key.verification.cancel"){var _=b.getContent().transaction_id;_&&p.push(_)}return b}).forEach(function(b){var _=b.getContent();if(b.getType()=="m.room.message"&&_.msgtype=="m.bad.encrypted"){U.log("Ignoring undecryptable to-device event from "+b.getSender());return}if(b.getType()==="m.key.verification.start"||b.getType()==="m.key.verification.request"){var x=_.transaction_id;p.includes(x)&&b.flagCancelled()}l.emit(je.ToDeviceEvent,b)})}else n.catchingUp=!1;var m=[],g=[],y=[],R=[];r.rooms&&(r.rooms.invite&&(m=n.mapSyncResponseToRoomArray(r.rooms.invite)),r.rooms.join&&(g=n.mapSyncResponseToRoomArray(r.rooms.join)),r.rooms.leave&&(y=n.mapSyncResponseToRoomArray(r.rooms.leave)),r.rooms.knock&&(R=n.mapSyncResponseToRoomArray(r.rooms.knock))),n.notifEvents=[],yield Xc(m,function(){var b=K(function*(_){var x=_.room,T=n.mapSyncEventsFormat(_.invite_state,x);yield n.injectRoomEvents(x,T,void 0),_.isBrandNewRoom?(x.recalculate(),l.store.storeRoom(x),l.emit(je.Room,x)):x.recalculate(),T.forEach(function(I){l.emit(je.Event,I)})});return function(_){return b.apply(this,arguments)}}()),yield Xc(g,function(){var b=K(function*(_){var x,T=_.room,I=n.mapSyncEventsFormat(_.state,T),C=n.mapSyncEventsFormat(_["org.matrix.msc4222.state_after"],T),k=n.mapSyncEventsFormat(_.timeline,T,!1),S=n.mapSyncEventsFormat(_.ephemeral),V=n.mapSyncEventsFormat(_.account_data),z=_["org.matrix.msc4222.state_after"]?C:I.concat(k),j=n.isRoomEncrypted(T,z);if(_.unread_notifications){if(!j||_.unread_notifications.notification_count===0){var J;T.setUnreadNotificationCount(It.Total,(J=_.unread_notifications.notification_count)!==null&&J!==void 0?J:0)}if(!j||T.getUnreadNotificationCount(It.Highlight)<=0){var $;T.setUnreadNotificationCount(It.Highlight,($=_.unread_notifications.highlight_count)!==null&&$!==void 0?$:0)}}var le=(x=_[im.name])!==null&&x!==void 0?x:_[im.altName];if(le){T.resetThreadUnreadNotificationCountFromSync(Object.keys(le));for(var[ie,Z]of Object.entries(le)){if(!j||Z.notification_count===0){var te;T.setThreadUnreadNotificationCount(ie,It.Total,(te=Z.notification_count)!==null&&te!==void 0?te:0)}var H=T.getThreadUnreadNotificationCount(ie,It.Highlight)<=0;if(!j||j&&H){var fe;T.setThreadUnreadNotificationCount(ie,It.Highlight,(fe=Z.highlight_count)!==null&&fe!==void 0?fe:0)}}}else T.resetThreadUnreadNotificationCountFromSync();if(_.timeline=_.timeline||{},_.isBrandNewRoom)_.timeline.prev_batch!==null&&T.getLiveTimeline().setPaginationToken(_.timeline.prev_batch,Be.BACKWARDS);else if(_.timeline.limited){for(var ne=!0,he=k.length-1;he>=0;he--){var oe=k[he].getId();if(T.getTimelineForEvent(oe)){ar("Already have event ".concat(oe," in limited sync - not resetting")),ne=!1,k.splice(0,he);break}}if(ne){var me;T.resetLiveTimeline(_.timeline.prev_batch,n.syncOpts.canResetEntireTimeline(T.roomId)?null:(me=e.oldSyncToken)!==null&&me!==void 0?me:null),l.resetNotifTimelineSet()}}if(n.syncOpts.cryptoCallbacks)for(var ee of z)ee.isState()&&ee.getType()===ge.RoomEncryption&&ee.getStateKey()===""&&(yield n.syncOpts.cryptoCallbacks.onCryptoEvent(T,ee));try{"org.matrix.msc4222.state_after"in _?yield n.injectRoomEvents(T,void 0,C,k,e.fromCache):yield n.injectRoomEvents(T,I,void 0,k,e.fromCache)}catch(q){U.error("Failed to process events on room ".concat(T.roomId,":"),q)}_.summary&&T.setSummary(_.summary),T.addEphemeralEvents(S),T.addAccountData(V),T.recalculate(),_.isBrandNewRoom&&(l.store.storeRoom(T),l.emit(je.Room,T)),n.processEventsForNotifs(T,k);var Y=q=>l.emit(je.Event,q);I.forEach(Y),k.forEach(Y),S.forEach(Y),V.forEach(Y),T.decryptCriticalEvents()});return function(_){return b.apply(this,arguments)}}()),yield Xc(y,function(){var b=K(function*(_){var x=_.room,{timelineEvents:T,stateEvents:I,stateAfterEvents:C}=yield n.mapAndInjectRoomEvents(_),k=n.mapSyncEventsFormat(_.account_data);x.addAccountData(k),x.recalculate(),_.isBrandNewRoom&&(l.store.storeRoom(x),l.emit(je.Room,x)),n.processEventsForNotifs(x,T),I==null||I.forEach(function(S){l.emit(je.Event,S)}),C==null||C.forEach(function(S){l.emit(je.Event,S)}),T.forEach(function(S){l.emit(je.Event,S)}),k.forEach(function(S){l.emit(je.Event,S)})});return function(_){return b.apply(this,arguments)}}()),yield Xc(R,function(){var b=K(function*(_){var x=_.room,T=n.mapSyncEventsFormat(_.knock_state,x);yield n.injectRoomEvents(x,T,void 0),_.isBrandNewRoom?(x.recalculate(),l.store.storeRoom(x),l.emit(je.Room,x)):x.recalculate(),T.forEach(function(I){l.emit(je.Event,I)})});return function(_){return b.apply(this,arguments)}}()),e.oldSyncToken&&n.notifEvents.length&&(n.notifEvents.sort(function(b,_){return b.getTs()-_.getTs()}),n.notifEvents.forEach(function(b){var _;(_=l.getNotifTimelineSet())===null||_===void 0||_.addLiveEvent(b,{addToState:!0})})),r.device_lists&&n.syncOpts.cryptoCallbacks&&(yield n.syncOpts.cryptoCallbacks.processDeviceLists(r.device_lists)),yield(o=n.syncOpts.cryptoCallbacks)===null||o===void 0?void 0:o.processKeyCounts(r.device_one_time_keys_count,(s=r.device_unused_fallback_key_types)!==null&&s!==void 0?s:r["org.matrix.msc2732.device_unused_fallback_key_types"])})()}startKeepAlives(e){return e===void 0&&(e=2e3+Math.floor(Math.random()*5e3)),this.keepAliveTimer!==null&&clearTimeout(this.keepAliveTimer),e>0?this.keepAliveTimer=setTimeout(this.pokeKeepAlive.bind(this),e):this.pokeKeepAlive(),this.connectionReturnedDefer||(this.connectionReturnedDefer=ml()),this.connectionReturnedDefer.promise}pokeKeepAlive(){var e,r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.running){clearTimeout(this.keepAliveTimer),this.connectionReturnedDefer&&(this.connectionReturnedDefer.reject("SyncApi.stop() was called"),this.connectionReturnedDefer=void 0);return}var n=()=>{clearTimeout(this.keepAliveTimer),this.connectionReturnedDefer&&(this.connectionReturnedDefer.resolve(r),this.connectionReturnedDefer=void 0)};this.client.http.request(_e.Get,"/_matrix/client/versions",void 0,void 0,{prefix:"",localTimeoutMs:15*1e3,abortSignal:(e=this.abortController)===null||e===void 0?void 0:e.signal}).then(()=>{n()},i=>{i.httpStatus==400||i.httpStatus==404?this.keepAliveTimer=setTimeout(n,2e3):(r=!0,this.keepAliveTimer=setTimeout(this.pokeKeepAlive.bind(this,r),5e3+Math.floor(Math.random()*5e3)),this.updateSyncState(Lt.Error,{error:i}))})}mapSyncResponseToRoomArray(e){var r=this.client;return Object.keys(e).filter(n=>!up(n)).map(n=>{var i=r.store.getRoom(n),a=!1;return i||(i=this.createRoom(n),a=!0),L0(L0({},e[n]),{},{room:i,isBrandNewRoom:a})})}mapSyncEventsFormat(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!Array.isArray(e.events))return[];var i=this.client.getEventMapper({decrypt:n});return e.events.filter(ya).map(function(a){return r&&(a.room_id=r.roomId),i(a)})}resolveInvites(e){if(!(!e||!this.opts.resolveInvitesToProfiles)){var r=this.client;e.getMembersWithMembership(ct.Invite).forEach(function(n){if(!n.requestedProfileInfo){n.requestedProfileInfo=!0;var i=r.getUser(n.userId),a;i?a=Promise.resolve({avatar_url:i.avatarUrl,displayname:i.displayName}):a=r.getProfileInfo(n.userId),a.then(function(o){var s=n.events.member;(s==null?void 0:s.getContent().membership)===ct.Invite&&(s.getContent().avatar_url=o.avatar_url,s.getContent().displayname=o.displayname,n.setMembershipEvent(s,e.currentState))},function(o){})}})}}findEncryptionEvent(e){return e==null?void 0:e.find(r=>r.getType()===ge.RoomEncryption&&r.getStateKey()==="")}isRoomEncrypted(e,r){return e.hasEncryptionStateEvent()||!!this.findEncryptionEvent(r)}mapAndInjectRoomEvents(e){var r=this;return K(function*(){var n=r.mapSyncEventsFormat(e.state,e.room),i=r.mapSyncEventsFormat(e["org.matrix.msc4222.state_after"],e.room),a=r.mapSyncEventsFormat(e.timeline,e.room);return"org.matrix.msc4222.state_after"in e?yield r.injectRoomEvents(e.room,void 0,i,a):yield r.injectRoomEvents(e.room,n,void 0,a),{timelineEvents:a,stateEvents:n,stateAfterEvents:i}})()}injectRoomEvents(e,r,n,i){var a=arguments,o=this;return K(function*(){var s=a.length>4&&a[4]!==void 0?a[4]:!1,l=n??r,c=e.getLiveTimeline(),d=c.getEvents().length==0;if(d){for(var h of l)o.client.getPushActionsForEvent(h);c.initialiseState(l,{timelineWasEmpty:d})}o.resolveInvites(e),e.recalculate(),d||(e.oldState.setStateEvents(l),e.currentState.setStateEvents(l)),yield e.addLiveEvents(i||[],{fromCache:s,timelineWasEmpty:d,addToState:n===void 0}),o.client.processBeaconEvents(e,i)})()}processEventsForNotifs(e,r){if(this.client.getNotifTimelineSet())for(var n of r){var i,a=this.client.getPushActionsForEvent(n);a!=null&&a.notify&&(i=a.tweaks)!==null&&i!==void 0&&i.highlight&&this.notifEvents.push(n)}}getGuestFilter(){return"{}"}updateSyncState(e,r){var n=this.syncState;this.syncState=e,this.syncStateData=r,this.client.emit(je.Sync,this.syncState,n,r)}}function RV(t,e,r){var{timelineSupport:n}=t,i=new Xb(e,t,t.getUserId(),{lazyLoadMembers:r.lazyLoadMembers,pendingEventOrdering:r.pendingEventOrdering,timelineSupport:n});return t.reEmitter.reEmit(i,[Ue.Name,Ue.Redaction,Ue.RedactionCancelled,Ue.Receipt,Ue.Tags,Ue.LocalEchoUpdated,Ue.AccountData,Ue.MyMembership,Ue.Timeline,Ue.TimelineReset,dt.Events,dt.Members,dt.NewMember,dt.Update,er.New,er.Update,er.Destroy,er.LivenessChange]),i.on(dt.NewMember,(a,o,s)=>{var l;s.user=(l=t.getUser(s.userId))!==null&&l!==void 0?l:void 0,t.reEmitter.reEmit(s,[Xn.Name,Xn.Typing,Xn.PowerLevel,Xn.Membership])}),i}function MV(t){return delete t.room_id,new Bn(t)}class Yhe{constructor(){E(this,"accountData",new Map),E(this,"fromToken",null)}isNewlyCreated(){return Promise.resolve(!0)}getSyncToken(){return this.fromToken}setSyncToken(e){this.fromToken=e}storeRoom(e){}getRoom(e){return null}getRooms(){return[]}removeRoom(e){}getRoomSummaries(){return[]}storeUser(e){}getUser(e){return null}getUsers(){return[]}scrollback(e,r){return[]}setUserCreator(e){}storeEvents(e,r,n,i){}storeFilter(e){}getFilter(e,r){return null}getFilterIdByName(e){return null}setFilterIdByName(e,r){}storeAccountDataEvents(e){}getAccountData(e){}setSyncData(e){return Promise.resolve()}wantsSave(){return!1}save(){return Promise.resolve()}startup(){return Promise.resolve()}getSavedSync(){return Promise.resolve(null)}getSavedSyncToken(){return Promise.resolve(null)}deleteAllData(){return Promise.resolve()}getOutOfBandMembers(){return Promise.resolve(null)}setOutOfBandMembers(e,r){return Promise.resolve()}clearOutOfBandMembers(){return Promise.resolve()}getClientOptions(){return Promise.resolve(void 0)}storeClientOptions(e){return Promise.resolve()}getPendingEvents(e){return K(function*(){return[]})()}setPendingEvents(e,r){return Promise.resolve()}saveToDeviceBatches(e){return K(function*(){return Promise.resolve()})()}getOldestToDeviceBatch(){return Promise.resolve(null)}removeToDeviceBatch(e){return K(function*(){return Promise.resolve()})()}destroy(){return K(function*(){})()}}const dn=[];for(let t=0;t<256;++t)dn.push((t+256).toString(16).slice(1));function Jhe(t,e=0){return(dn[t[e+0]]+dn[t[e+1]]+dn[t[e+2]]+dn[t[e+3]]+"-"+dn[t[e+4]]+dn[t[e+5]]+"-"+dn[t[e+6]]+dn[t[e+7]]+"-"+dn[t[e+8]]+dn[t[e+9]]+"-"+dn[t[e+10]]+dn[t[e+11]]+dn[t[e+12]]+dn[t[e+13]]+dn[t[e+14]]+dn[t[e+15]]).toLowerCase()}let Rw;const Xhe=new Uint8Array(16);function Qhe(){if(!Rw){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");Rw=crypto.getRandomValues.bind(crypto)}return Rw(Xhe)}const epe=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),GA={randomUUID:epe};function tpe(t,e,r){var i;if(GA.randomUUID&&!t)return GA.randomUUID();t=t||{};const n=t.random??((i=t.rng)==null?void 0:i.call(t))??Qhe();if(n.length<16)throw new Error("Random bytes length must be >= 16");return n[6]=n[6]&15|64,n[8]=n[8]&63|128,Jhe(n)}var IV={},PV={exports:{}},qA=PV.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(t){return t.encoding?"rtpmap:%d %s/%s/%s":t.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(t){return t.address!=null?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%s trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(t){return t.subtype!=null?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function(t){return"extmap:%d"+(t.direction?"/%s":"%v")+(t["encrypt-uri"]?" %s":"%v")+" %s"+(t.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(t){return t.sessionConfig!=null?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(t){var e="candidate:%s %d %s %d %s %d typ %s";return e+=t.raddr!=null?" raddr %s rport %d":"%v%v",e+=t.tcptype!=null?" tcptype %s":"%v",t.generation!=null&&(e+=" generation %d"),e+=t["network-id"]!=null?" network-id %d":"%v",e+=t["network-cost"]!=null?" network-cost %d":"%v",e}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(t){var e="ssrc:%d";return t.attribute!=null&&(e+=" %s",t.value!=null&&(e+=":%s")),e}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(t){return t.maxMessageSize!=null?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(t){return t.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(t){return"imageattr:%s %s %s"+(t.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(t){return"simulcast:%s %s"+(t.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function(t){return"ts-refclk:%s"+(t.clksrcExt!=null?"=%s":"")}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function(t){var e="mediaclk:";return e+=t.id!=null?"id=%s %s":"%v%s",e+=t.mediaClockValue!=null?"=%s":"",e+=t.rateNumerator!=null?" rate=%s":"",e+=t.rateDenominator!=null?"/%s":"",e}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};Object.keys(qA).forEach(function(t){var e=qA[t];e.forEach(function(r){r.reg||(r.reg=/(.*)/),r.format||(r.format="%s")})});var AV=PV.exports;(function(t){var e=function(s){return String(Number(s))===s?Number(s):s},r=function(s,l,c,d){if(d&&!c)l[d]=e(s[1]);else for(var h=0;h<c.length;h+=1)s[h+1]!=null&&(l[c[h]]=e(s[h+1]))},n=function(s,l,c){var d=s.name&&s.names;s.push&&!l[s.push]?l[s.push]=[]:d&&!l[s.name]&&(l[s.name]={});var h=s.push?{}:d?l[s.name]:l;r(c.match(s.reg),h,s.names,s.name),s.push&&l[s.push].push(h)},i=AV,a=RegExp.prototype.test.bind(/^([a-z])=(.*)/);t.parse=function(s){var l={},c=[],d=l;return s.split(/(\r\n|\r|\n)/).filter(a).forEach(function(h){var p=h[0],m=h.slice(2);p==="m"&&(c.push({rtp:[],fmtp:[]}),d=c[c.length-1]);for(var g=0;g<(i[p]||[]).length;g+=1){var y=i[p][g];if(y.reg.test(m))return n(y,d,m)}}),l.media=c,l};var o=function(s,l){var c=l.split(/=(.+)/,2);return c.length===2?s[c[0]]=e(c[1]):c.length===1&&l.length>1&&(s[c[0]]=void 0),s};t.parseParams=function(s){return s.split(/;\s?/).reduce(o,{})},t.parseFmtpConfig=t.parseParams,t.parsePayloads=function(s){return s.toString().split(" ").map(Number)},t.parseRemoteCandidates=function(s){for(var l=[],c=s.split(" ").map(e),d=0;d<c.length;d+=3)l.push({component:c[d],ip:c[d+1],port:c[d+2]});return l},t.parseImageAttributes=function(s){return s.split(" ").map(function(l){return l.substring(1,l.length-1).split(",").reduce(o,{})})},t.parseSimulcastStreamList=function(s){return s.split(";").map(function(l){return l.split(",").map(function(c){var d,h=!1;return c[0]!=="~"?d=e(c):(d=e(c.substring(1,c.length)),h=!0),{scid:d,paused:h}})})}})(IV);var Mw=AV,rpe=/%[sdv%]/g,npe=function(t){var e=1,r=arguments,n=r.length;return t.replace(rpe,function(i){if(e>=n)return i;var a=r[e];switch(e+=1,i){case"%%":return"%";case"%s":return String(a);case"%d":return Number(a);case"%v":return""}})},gh=function(t,e,r){var n=e.format instanceof Function?e.format(e.push?r:r[e.name]):e.format,i=[t+"="+n];if(e.names)for(var a=0;a<e.names.length;a+=1){var o=e.names[a];e.name?i.push(r[e.name][o]):i.push(r[e.names[a]])}else i.push(r[e.name]);return npe.apply(null,i)},ipe=["v","o","s","i","u","e","p","c","b","t","r","z","a"],ape=["i","c","b","a"],ope=function(t,e){e=e||{},t.version==null&&(t.version=0),t.name==null&&(t.name=" "),t.media.forEach(function(a){a.payloads==null&&(a.payloads="")});var r=e.outerOrder||ipe,n=e.innerOrder||ape,i=[];return r.forEach(function(a){Mw[a].forEach(function(o){o.name in t&&t[o.name]!=null?i.push(gh(a,o,t)):o.push in t&&t[o.push]!=null&&t[o.push].forEach(function(s){i.push(gh(a,o,s))})})}),t.media.forEach(function(a){i.push(gh("m",Mw.m[0],a)),n.forEach(function(o){Mw[o].forEach(function(s){s.name in a&&a[s.name]!=null?i.push(gh(o,s,a)):s.push in a&&a[s.push]!=null&&a[s.push].forEach(function(l){i.push(gh(o,s,l))})})})}),i.join(`\r
`)+`\r
`},Qu=IV,spe=ope,lpe=spe,kV=Qu.parse;Qu.parseParams;Qu.parseFmtpConfig;Qu.parsePayloads;Qu.parseRemoteCandidates;Qu.parseImageAttributes;Qu.parseSimulcastStreamList;function r3(t,e){if(typeof t.toBase64=="function")return t.toBase64(e);var r=btoa(t.reduce((n,i)=>n+String.fromCharCode(i),""));return e.omitPadding&&(r=r.replace(/={1,2}$/,"")),e.alphabet==="base64url"&&(r=r.replace(/\+/g,"-").replace(/\//g,"_")),r}function ny(t){return r3(t,{alphabet:"base64",omitPadding:!1})}function OV(t){return r3(t,{alphabet:"base64",omitPadding:!0})}function Qb(t){return r3(t,{alphabet:"base64url",omitPadding:!0})}function upe(t,e){return typeof Uint8Array.fromBase64=="function"?Uint8Array.fromBase64(t,e):Uint8Array.from(atob(t),r=>r.charCodeAt(0))}function xd(t){return upe(t.replace(/-/g,"+").replace(/_/g,"/"),{alphabet:"base64",lastChunkHandling:"loose"})}var cpe="abcdefghijklmnopqrstuvwxyz",dpe="ABCDEFGHIJKLMNOPQRSTUVWXYZ",fpe="0123456789";function hpe(t){var e=new Uint8Array(t);return globalThis.crypto.getRandomValues(e),Qb(e)}function al(t){return ppe(t,dpe+cpe+fpe)}function ppe(t,e){if(e.length<2||e.length>256)throw new Error("Character set must be between 2 and 256 characters long");if(t<1||t>32768)throw new Error("Requested random string length must be between 1 and 32768");for(var r=256-256%e.length,n=new Uint8Array(Math.floor(t*1.3)),i=n.length,a=[];a.length<t;){i===n.length&&(globalThis.crypto.getRandomValues(n),i=0);var o=n[i++];o<r&&a.push(e[o%e.length])}return a.join("")}var gs="org.matrix.msc3077.sdp_stream_metadata",Ht=function(t){return t.Usermedia="m.usermedia",t.Screenshare="m.screenshare",t}({}),hp=null,jx=0,mpe=()=>(hp===null&&(hp=new AudioContext),jx++,hp),vpe=()=>{if(jx--,jx===0){var t;(t=hp)===null||t===void 0||t.close(),hp=null}},gpe=200,Vx=-60,ype=8,Ua=function(t){return t.NewStream="new_stream",t.MuteStateChanged="mute_state_changed",t.LocalVolumeChanged="local_volume_changed",t.VolumeChanged="volume_changed",t.ConnectedChanged="connected_changed",t.Speaking="speaking",t.Disposed="disposed",t}({});class Po extends nr{constructor(e){super(),E(this,"stream",void 0),E(this,"sdpMetadataStreamId",void 0),E(this,"userId",void 0),E(this,"deviceId",void 0),E(this,"purpose",void 0),E(this,"speakingVolumeSamples",void 0),E(this,"client",void 0),E(this,"call",void 0),E(this,"roomId",void 0),E(this,"audioMuted",void 0),E(this,"videoMuted",void 0),E(this,"localVolume",1),E(this,"measuringVolumeActivity",!1),E(this,"audioContext",void 0),E(this,"analyser",void 0),E(this,"frequencyBinCount",void 0),E(this,"speakingThreshold",Vx),E(this,"speaking",!1),E(this,"volumeLooperTimeout",void 0),E(this,"_disposed",!1),E(this,"_connected",!1),E(this,"onAddTrack",()=>{this.emit(Ua.NewStream,this.stream)}),E(this,"onCallState",r=>{r===Je.Connected?this.connected=!0:r===Je.Connecting&&(this.connected=!1)}),E(this,"volumeLooper",()=>{if(this.analyser&&this.measuringVolumeActivity){this.analyser.getFloatFrequencyData(this.frequencyBinCount);var r=-1/0;for(var n of this.frequencyBinCount)n>r&&(r=n);this.speakingVolumeSamples.shift(),this.speakingVolumeSamples.push(r),this.emit(Ua.VolumeChanged,r);var i=!1;for(var a of this.speakingVolumeSamples)if(a>this.speakingThreshold){i=!0;break}this.speaking!==i&&(this.speaking=i,this.emit(Ua.Speaking,this.speaking)),this.volumeLooperTimeout=setTimeout(this.volumeLooper,gpe)}}),this.client=e.client,this.call=e.call,this.roomId=e.roomId,this.userId=e.userId,this.deviceId=e.deviceId,this.purpose=e.purpose,this.audioMuted=e.audioMuted,this.videoMuted=e.videoMuted,this.speakingVolumeSamples=new Array(ype).fill(-1/0),this.sdpMetadataStreamId=e.stream.id,this.updateStream(null,e.stream),this.stream=e.stream,this.hasAudioTrack&&this.initVolumeMeasuring(),e.call&&(e.call.addListener(ut.State,this.onCallState),this.onCallState(e.call.state))}get connected(){return this.isLocal()||this._connected}set connected(e){this._connected=e,this.emit(Ua.ConnectedChanged,this.connected)}get hasAudioTrack(){return this.stream.getAudioTracks().length>0}updateStream(e,r){if(r!==e){var n=this.measuringVolumeActivity;e&&(e.removeEventListener("addtrack",this.onAddTrack),this.measureVolumeActivity(!1)),this.stream=r,r.addEventListener("addtrack",this.onAddTrack),this.hasAudioTrack?(this.initVolumeMeasuring(),n&&this.measureVolumeActivity(!0)):this.measureVolumeActivity(!1),this.emit(Ua.NewStream,this.stream)}}initVolumeMeasuring(){if(this.hasAudioTrack){this.audioContext||(this.audioContext=mpe()),this.analyser=this.audioContext.createAnalyser(),this.analyser.fftSize=512,this.analyser.smoothingTimeConstant=.1;var e=this.audioContext.createMediaStreamSource(this.stream);e.connect(this.analyser),this.frequencyBinCount=new Float32Array(this.analyser.frequencyBinCount)}}getMember(){var e,r=this.client.getRoom(this.roomId);return(e=r==null?void 0:r.getMember(this.userId))!==null&&e!==void 0?e:null}isLocal(){return this.userId===this.client.getUserId()&&(this.deviceId===void 0||this.deviceId===this.client.getDeviceId())}isAudioMuted(){return this.stream.getAudioTracks().length===0||this.audioMuted}isVideoMuted(){return this.stream.getVideoTracks().length===0||this.videoMuted}isSpeaking(){return this.speaking}setNewStream(e){this.updateStream(this.stream,e)}setAudioVideoMuted(e,r){e!==null&&(this.audioMuted!==e&&this.speakingVolumeSamples.fill(-1/0),this.audioMuted=e),r!==null&&(this.videoMuted=r),this.emit(Ua.MuteStateChanged,this.audioMuted,this.videoMuted)}measureVolumeActivity(e){if(e){if(!this.analyser||!this.frequencyBinCount||!this.hasAudioTrack)return;this.measuringVolumeActivity=!0,this.volumeLooper()}else this.measuringVolumeActivity=!1,this.speakingVolumeSamples.fill(-1/0),this.emit(Ua.VolumeChanged,-1/0)}setSpeakingThreshold(e){this.speakingThreshold=e}clone(){var e=this.client.getMediaHandler(),r=this.stream.clone();return U.log("CallFeed clone() cloning stream (originalStreamId=".concat(this.stream.id,", newStreamId").concat(r.id,")")),this.purpose===Ht.Usermedia?e.userMediaStreams.push(r):e.screensharingStreams.push(r),new Po({client:this.client,roomId:this.roomId,userId:this.userId,deviceId:this.deviceId,stream:r,purpose:this.purpose,audioMuted:this.audioMuted,videoMuted:this.videoMuted})}dispose(){var e,r;clearTimeout(this.volumeLooperTimeout),(e=this.stream)===null||e===void 0||e.removeEventListener("addtrack",this.onAddTrack),(r=this.call)===null||r===void 0||r.removeListener(ut.State,this.onCallState),this.audioContext&&(this.audioContext=void 0,this.analyser=void 0,vpe()),this._disposed=!0,this.emit(Ua.Disposed)}get disposed(){return this._disposed}set disposed(e){this._disposed=e}getLocalVolume(){return this.localVolume}setLocalVolume(e){this.localVolume=e,this.emit(Ua.LocalVolumeChanged,e)}}var bpe=3e3,zx=function(t){return t.Incoming="Call.incoming",t}({});class _pe{constructor(e){E(this,"calls",void 0),E(this,"callEventBuffer",void 0),E(this,"nextSeqByCall",new Map),E(this,"toDeviceEventBuffers",new Map),E(this,"client",void 0),E(this,"candidateEventsByCall",void 0),E(this,"eventBufferPromiseChain",void 0),E(this,"onSync",()=>{var r=this.callEventBuffer;this.callEventBuffer=[],this.eventBufferPromiseChain?this.eventBufferPromiseChain=this.eventBufferPromiseChain.then(()=>this.evaluateEventBuffer(r)):this.eventBufferPromiseChain=this.evaluateEventBuffer(r)}),E(this,"onRoomTimeline",r=>{this.callEventBuffer.push(r)}),E(this,"onToDeviceEvent",r=>{var n=r.getContent();if(!n.call_id){this.callEventBuffer.push(r);return}if(this.nextSeqByCall.has(n.call_id)||this.nextSeqByCall.set(n.call_id,0),n.seq===void 0){this.callEventBuffer.push(r);return}var i=this.nextSeqByCall.get(n.call_id)||0;if(n.seq!==i){this.toDeviceEventBuffers.has(n.call_id)||this.toDeviceEventBuffers.set(n.call_id,[]);var a=this.toDeviceEventBuffers.get(n.call_id),o=a.findIndex(d=>d.getContent().seq>n.seq);o===-1?a.push(r):a.splice(o,0,r)}else{var s=n.call_id;this.callEventBuffer.push(r),this.nextSeqByCall.set(s,n.seq+1);for(var l=this.toDeviceEventBuffers.get(s),c=l&&l.shift();c&&c.getContent().seq===this.nextSeqByCall.get(s);)this.callEventBuffer.push(c),this.nextSeqByCall.set(s,c.getContent().seq+1),c=l.shift()}}),this.client=e,this.calls=new Map,this.callEventBuffer=[],this.candidateEventsByCall=new Map}start(){this.client.on(je.Sync,this.onSync),this.client.on(Ue.Timeline,this.onRoomTimeline),this.client.on(je.ToDeviceEvent,this.onToDeviceEvent)}stop(){this.client.removeListener(je.Sync,this.onSync),this.client.removeListener(Ue.Timeline,this.onRoomTimeline),this.client.removeListener(je.ToDeviceEvent,this.onToDeviceEvent)}evaluateEventBuffer(e){var r=this;return K(function*(){yield Promise.all(e.map(d=>r.client.decryptEventIfNeeded(d)));var n=e.filter(d=>{var h=d.getType();return h.startsWith("m.call.")||h.startsWith("org.matrix.call.")}),i=new Set;for(var a of n){var o=a.getType();(o===ge.CallAnswer||o===ge.CallHangup)&&i.add(a.getContent().call_id)}for(var s of n){var l=s.getType(),c=s.getContent().call_id;if(!(l===ge.CallInvite&&i.has(c)))try{yield r.handleCallEvent(s)}catch(d){U.error("CallEventHandler evaluateEventBuffer() caught exception handling call event",d)}}})()}handleCallEvent(e){var r=this;return K(function*(){var n;r.client.emit(je.ReceivedVoipEvent,e);var i=e.getContent(),a=e.getRoomId()||((n=r.client.groupCallEventHandler.getGroupCallById(i.conf_id))===null||n===void 0||(n=n.room)===null||n===void 0?void 0:n.roomId),o=i.conf_id,s=e.getType(),l=e.getSender(),c=i.call_id?r.calls.get(i.call_id):void 0,d,h;if(o){if(h=r.client.groupCallEventHandler.getGroupCallById(o),!h){U.warn("CallEventHandler handleCallEvent() could not find a group call - ignoring event (groupCallId=".concat(o,", type=").concat(s,")"));return}if(d=i.device_id,!d){U.warn("CallEventHandler handleCallEvent() could not find a device id - ignoring event (senderId=".concat(l,")")),h.emit(Kt.Error,new BV(l));return}if(i.dest_session_id!==r.client.getSessionId()){U.warn("CallEventHandler handleCallEvent() call event does not match current session id - ignoring");return}}var p=l===r.client.credentials.userId&&(d===void 0||d===r.client.getDeviceId());if(a){if(s===ge.CallInvite){var m,g,y;if(p||e.getLocalAge()>i.lifetime-bpe||c&&c.state===Je.Ended||(c&&U.warn("CallEventHandler handleCallEvent() already has a call but got an invite - clobbering (callId=".concat(i.call_id,")")),i.invitee&&i.invitee!==r.client.getUserId()))return;var R=((m=r.client.getTurnServersExpiry())!==null&&m!==void 0?m:0)-Date.now();if(U.info("CallEventHandler handleCallEvent() current turn creds expire in "+R+" ms"),c=(g=om(r.client,a,{forceTURN:r.client.forceTURN,opponentDeviceId:d,groupCallId:o,opponentSessionId:i.sender_session_id}))!==null&&g!==void 0?g:void 0,!c){U.log("CallEventHandler handleCallEvent() this client does not support WebRTC (callId=".concat(i.call_id,")"));return}c.callId=i.call_id;var b=(y=h)===null||y===void 0?void 0:y.getGroupCallStats();b&&c.initStats(b);try{yield c.initWithInvite(e)}catch(V){if(V instanceof Do)if(V.code===mp.UnknownDevice){var _;(_=h)===null||_===void 0||_.emit(Kt.Error,V)}else U.error(V)}if(r.calls.set(c.callId,c),r.candidateEventsByCall.get(c.callId))for(var x of r.candidateEventsByCall.get(c.callId))c.onRemoteIceCandidatesReceived(x);var T;for(var I of r.calls.values()){var C,k=[Je.WaitLocalMedia,Je.CreateOffer,Je.InviteSent].includes(I.state);if(c.roomId===I.roomId&&I.direction===Cs.Outbound&&((C=c.getOpponentMember())===null||C===void 0?void 0:C.userId)===I.invitee&&k){T=I;break}}T?T.callId>c.callId?(U.log("CallEventHandler handleCallEvent() detected glare - answering incoming call and canceling outgoing call (incomingId=".concat(c.callId,", outgoingId=").concat(T.callId,")")),T.replacedBy(c)):(U.log("CallEventHandler handleCallEvent() detected glare - hanging up incoming call (incomingId=".concat(c.callId,", outgoingId=").concat(T.callId,")")),c.hangup(ot.Replaced,!0)):r.client.emit(zx.Incoming,c);return}else if(s===ge.CallCandidates){if(p)return;c?c.onRemoteIceCandidatesReceived(e):(r.candidateEventsByCall.has(i.call_id)||r.candidateEventsByCall.set(i.call_id,[]),r.candidateEventsByCall.get(i.call_id).push(e));return}else if([ge.CallHangup,ge.CallReject].includes(s)){if(c)c.state!==Je.Ended&&(s===ge.CallHangup?c.onHangupReceived(i):c.onRejectReceived(i),c.state===Je.Ended&&r.calls.delete(i.call_id));else{var S;c=(S=om(r.client,a,{opponentDeviceId:d,opponentSessionId:i.sender_session_id}))!==null&&S!==void 0?S:void 0,c&&(c.callId=i.call_id,c.initWithHangup(e),r.calls.set(i.call_id,c))}return}if(!c||!c.hasPeerConnection){U.info("CallEventHandler handleCallEvent() discarding possible call event as we don't have a call (type=".concat(s,")"));return}if(e.getContent().party_id!==c.ourPartyId)switch(s){case ge.CallAnswer:p?c.state===Je.Ringing&&c.onAnsweredElsewhere(i):c.onAnswerReceived(e);break;case ge.CallSelectAnswer:c.onSelectAnswerReceived(e);break;case ge.CallNegotiate:c.onNegotiateReceived(e);break;case ge.CallAssertedIdentity:case ge.CallAssertedIdentityPrefix:c.onAssertedIdentityReceived(e);break;case ge.CallSDPStreamMetadataChanged:case ge.CallSDPStreamMetadataChangedPrefix:c.onSDPStreamMetadataChangedReceived(e);break}}})()}}var Kx=function(t){return t.Incoming="GroupCall.incoming",t.Outgoing="GroupCall.outgoing",t.Ended="GroupCall.ended",t.Participants="GroupCall.participants",t}({});class Spe{constructor(e){this.client=e,E(this,"groupCalls",new Map),E(this,"roomDeferreds",new Map),E(this,"onRoomsChanged",r=>{this.createGroupCallForRoom(r)}),E(this,"onRoomStateChanged",(r,n)=>{var i=r.getType();if(i===ge.GroupCallPrefix){var a=r.getStateKey(),o=r.getContent(),s=this.groupCalls.get(n.roomId);!s&&!o["m.terminated"]&&!r.isRedacted()?this.createGroupCallFromRoomStateEvent(r):s&&s.groupCallId===a?o["m.terminated"]||r.isRedacted()?s.terminate(!1):o["m.type"]!==s.type&&U.warn("GroupCallEventHandler onRoomStateChanged() currently does not support changing type (roomId=".concat(n.roomId,")")):s&&s.groupCallId!==a&&U.warn("GroupCallEventHandler onRoomStateChanged() currently does not support multiple calls (roomId=".concat(n.roomId,")"))}})}start(){var e=this;return K(function*(){e.client.getSyncState()!==Lt.Syncing&&(U.debug("GroupCallEventHandler start() waiting for client to start syncing"),yield new Promise(i=>{var a=()=>{if(e.client.getSyncState()===Lt.Syncing)return e.client.off(je.Sync,a),i()};e.client.on(je.Sync,a)}));var r=e.client.getRooms();for(var n of r)e.createGroupCallForRoom(n);e.client.on(je.Room,e.onRoomsChanged),e.client.on(dt.Events,e.onRoomStateChanged)})()}stop(){this.client.removeListener(je.Room,this.onRoomsChanged),this.client.removeListener(dt.Events,this.onRoomStateChanged)}getRoomDeferred(e){var r=this.roomDeferreds.get(e);if(r===void 0){var n;r={prom:new Promise(i=>{n=i})},r.resolve=n,this.roomDeferreds.set(e,r)}return r}waitUntilRoomReadyForGroupCalls(e){return this.getRoomDeferred(e).prom}getGroupCallById(e){return[...this.groupCalls.values()].find(r=>r.groupCallId===e)}createGroupCallForRoom(e){var r=e.currentState.getStateEvents(ge.GroupCallPrefix),n=r.sort((o,s)=>s.getTs()-o.getTs());for(var i of n){var a=i.getContent();if(!(a["m.terminated"]||i.isRedacted())){U.debug("GroupCallEventHandler createGroupCallForRoom() choosing group call from possible calls (stateKey=".concat(i.getStateKey(),", ts=").concat(i.getTs(),", roomId=").concat(e.roomId,", numOfPossibleCalls=").concat(r.length,")")),this.createGroupCallFromRoomStateEvent(i);break}}this.getRoomDeferred(e.roomId).resolve()}createGroupCallFromRoomStateEvent(e){var r=e.getRoomId(),n=e.getContent(),i=this.client.getRoom(r);if(!i){U.warn("GroupCallEventHandler createGroupCallFromRoomStateEvent() couldn't find room for call (roomId=".concat(r,")"));return}var a=e.getStateKey(),o=n["m.type"];if(!Object.values(e_).includes(o)){U.warn("GroupCallEventHandler createGroupCallFromRoomStateEvent() received invalid call type (type=".concat(o,", roomId=").concat(r,")"));return}var s=n["m.intent"];if(!Object.values(LV).includes(s)){U.warn("Received invalid group call intent (type=".concat(o,", roomId=").concat(r,")"));return}var l=!!n["io.element.ptt"],c;if(n!=null&&n.dataChannelsEnabled&&n!==null&&n!==void 0&&n.dataChannelOptions){var{ordered:d,maxPacketLifeTime:h,maxRetransmits:p,protocol:m}=n.dataChannelOptions;c={ordered:d,maxPacketLifeTime:h,maxRetransmits:p,protocol:m}}var g=new n3(this.client,i,o,l,s,a,(n==null?void 0:n.dataChannelsEnabled)||this.client.isVoipWithNoMediaAllowed,c,this.client.isVoipWithNoMediaAllowed,this.client.useLivekitForGroupCalls,n["io.element.livekit_service_url"]);return this.groupCalls.set(i.roomId,g),this.client.emit(Kx.Incoming,g),g}}class wpe{constructor(){E(this,"bandwidth",{}),E(this,"bitrate",{}),E(this,"packetLoss",{}),E(this,"transport",[])}}class Epe{static buildBandwidthReport(e){var r=e.availableIncomingBitrate,n=e.availableOutgoingBitrate;return{download:r?Math.round(r/1e3):0,upload:n?Math.round(n/1e3):0}}}class xpe{static buildReport(e,r,n,i){var a=e==null?void 0:e.get(r.localCandidateId),o=e==null?void 0:e.get(r.remoteCandidateId);if(o&&a){var s=o.ip!==void 0?o.ip:o.address,l=o.port,c="".concat(s,":").concat(l),d=a.ip!==void 0?a.ip:a.address,h=a.port,p="".concat(d,":").concat(h),m=o.protocol;n.some(g=>g.ip===c&&g.type===m&&g.localIp===p)||n.push({ip:c,type:m,localIp:p,isFocus:i,localCandidateType:a.candidateType,remoteCandidateType:o.candidateType,networkType:a.networkType,rtt:r.currentRoundTripTime?r.currentRoundTripTime*1e3:NaN})}return n}}class Cpe{constructor(){E(this,"ssrcToMid",{local:new Map,remote:new Map})}findMidBySsrc(e,r){var n;return this.ssrcToMid[r].forEach((i,a)=>{if(i.find(o=>o==e)){n=a;return}}),n}parse(e,r){var n=kV(e),i=new Map;n.media.forEach(a=>{if(a.mid&&a.type==="video"||a.type==="audio"){var o,s=[];(o=a.ssrcs)===null||o===void 0||o.forEach(l=>{l.attribute==="cname"&&s.push("".concat(l.id))}),i.set("".concat(a.mid),s)}}),this.ssrcToMid[r]=i}getSsrcToMidMap(e){return this.ssrcToMid[e]}}class Tpe{constructor(e){this.pc=e}getLocalTracks(e){var r=n=>n!==null&&n.kind===e;return this.pc.getTransceivers().filter(n=>n.currentDirection==="sendonly"||n.currentDirection==="sendrecv").filter(n=>n.sender!==null).map(n=>n.sender).map(n=>n.track).filter(r)}getTackById(e){return this.pc.getTransceivers().map(r=>{if((r==null?void 0:r.sender.track)!==null&&r.sender.track.id===e)return r.sender.track;if((r==null?void 0:r.receiver.track)!==null&&r.receiver.track.id===e)return r.receiver.track}).find(r=>r!==void 0)}getLocalTrackIdByMid(e){var r,n=this.pc.getTransceivers().find(i=>i.mid===e);return n==null||(r=n.sender)===null||r===void 0||(r=r.track)===null||r===void 0?void 0:r.id}getRemoteTrackIdByMid(e){var r,n=this.pc.getTransceivers().find(i=>i.mid===e);return n==null||(r=n.receiver)===null||r===void 0||(r=r.track)===null||r===void 0?void 0:r.id}getActiveSimulcastStreams(){return 3}getTransceiverByTrackId(e){return this.pc.getTransceivers().find(r=>r.receiver.track.id===e||r.sender.track!==null&&r.sender.track.id===e)}}class Dpe{constructor(e,r,n){this.trackId=e,this.type=r,this.kind=n,E(this,"loss",{packetsTotal:0,packetsLost:0,isDownloadStream:!1}),E(this,"bitrate",{download:0,upload:0}),E(this,"resolution",{width:-1,height:-1}),E(this,"audioConcealment",{concealedAudio:0,totalAudioDuration:0}),E(this,"framerate",0),E(this,"jitter",0),E(this,"codec",""),E(this,"isAlive",!0),E(this,"isMuted",!1),E(this,"isEnabled",!0)}getType(){return this.type}setLoss(e){this.loss=e}getLoss(){return this.loss}setResolution(e){this.resolution=e}getResolution(){return this.resolution}setFramerate(e){this.framerate=e}getFramerate(){return this.framerate}setBitrate(e){this.bitrate=e}getBitrate(){return this.bitrate}setCodec(e){return this.codec=e,!0}getCodec(){return this.codec}resetBitrate(){this.bitrate={download:0,upload:0}}set alive(e){this.isAlive=e}get alive(){return this.isAlive}set muted(e){this.isMuted=e}get muted(){return this.isMuted}set enabled(e){this.isEnabled=e}get enabled(){return this.isEnabled}setJitter(e){this.jitter=e}getJitter(){return this.jitter}setAudioConcealment(e,r){this.audioConcealment.concealedAudio=e,this.audioConcealment.totalAudioDuration=r}getAudioConcealment(){return this.audioConcealment}}class Rpe{constructor(e,r){this.mediaSsrcHandler=e,this.mediaTrackHandler=r,E(this,"track2stats",new Map)}findTrack2Stats(e,r){var n;if(e.trackIdentifier)n=e.trackIdentifier;else if(e.mid)n=r==="remote"?this.mediaTrackHandler.getRemoteTrackIdByMid(e.mid):this.mediaTrackHandler.getLocalTrackIdByMid(e.mid);else if(e.ssrc){var i=this.mediaSsrcHandler.findMidBySsrc(e.ssrc,r);if(!i)return;n=r==="remote"?this.mediaTrackHandler.getRemoteTrackIdByMid(e.mid):this.mediaTrackHandler.getLocalTrackIdByMid(e.mid)}if(n){var a=this.track2stats.get(n);if(!a){var o=this.mediaTrackHandler.getTackById(n);if(o!==void 0){var s=o.kind==="audio"?o.kind:"video";a=new Dpe(n,r,s),this.track2stats.set(n,a)}else return}return a}}findLocalVideoTrackStats(e){var r=this.mediaTrackHandler.getLocalTracks("video");if(r.length!==0)return this.findTrack2Stats(e,"local")}getTrack2stats(){return this.track2stats}findTransceiverByTrackId(e){return this.mediaTrackHandler.getTransceiverByTrackId(e)}}class Gl{static getNonNegativeValue(e){var r=e;return typeof r!="number"&&(r=Number(r)),isNaN(r)?0:Math.max(0,r)}}class fi{static buildFramerateResolution(e,r){var n={height:r.frameHeight,width:r.frameWidth},i=r.framesPerSecond;n.height&&n.width&&e.setResolution(n),e.setFramerate(Math.round(i||0))}static calculateSimulcastFramerate(e,r,n,i){var a=e.getFramerate();if(!a){if(n){var o=r.timestamp-n.timestamp;if(o>0&&r.framesSent){var s=r.framesSent-n.framesSent;a=s/o*1e3}}if(!a)return}a=i?Math.round(a/i):0,e.setFramerate(a)}static buildCodec(e,r,n){var i=e==null?void 0:e.get(n.codecId);if(i){var a=i.mimeType.split("/")[1];a&&r.setCodec(a)}}static buildBitrateReceived(e,r,n){e.setBitrate({download:fi.calculateBitrate(r.bytesReceived,n.bytesReceived,r.timestamp,n.timestamp),upload:0})}static buildBitrateSend(e,r,n){e.setBitrate({download:0,upload:this.calculateBitrate(r.bytesSent,n.bytesSent,r.timestamp,n.timestamp)})}static buildPacketsLost(e,r,n){var i=r.type==="outbound-rtp"?"packetsSent":"packetsReceived",a=r[i];(!a||a<0)&&(a=0);var o=Gl.getNonNegativeValue(n[i]),s=Math.max(0,a-o),l=Gl.getNonNegativeValue(r.packetsLost),c=Gl.getNonNegativeValue(n.packetsLost),d=Math.max(0,l-c);e.setLoss({packetsTotal:s+d,packetsLost:d,isDownloadStream:r.type!=="outbound-rtp"})}static calculateBitrate(e,r,n,i){var a=Gl.getNonNegativeValue(e),o=Gl.getNonNegativeValue(r),s=Math.max(0,a-o),l=n-i,c=0;return l>0&&(c=Math.round(s*8/l)),c}static setTrackStatsState(e,r){var n;if(r===void 0){e.alive=!1;return}var i=e.getType()==="remote"?r.receiver.track:r==null||(n=r.sender)===null||n===void 0?void 0:n.track;if(i==null){e.alive=!1;return}if(i.readyState==="ended"){e.alive=!1;return}e.muted=i.muted,e.enabled=i.enabled,e.alive=!0}static buildTrackSummary(e){var r={count:0,muted:0,maxJitter:0,maxPacketLoss:0,concealedAudio:0,totalAudio:0},n={count:0,muted:0,maxJitter:0,maxPacketLoss:0,concealedAudio:0,totalAudio:0},i=e.filter(o=>o.getType()==="remote"),a=i.filter(o=>o.kind==="audio");return i.forEach(o=>{var s=o.kind==="video"?r:n;if(s.count++,o.alive&&o.muted&&s.muted++,s.maxJitter<o.getJitter()&&(s.maxJitter=o.getJitter()),s.maxPacketLoss<o.getLoss().packetsLost&&(s.maxPacketLoss=o.getLoss().packetsLost),a.length>0){var l,c;s.concealedAudio+=(l=o.getAudioConcealment())===null||l===void 0?void 0:l.concealedAudio,s.totalAudio+=(c=o.getAudioConcealment())===null||c===void 0?void 0:c.totalAudioDuration}}),{audioTrackSummary:n,videoTrackSummary:r}}static buildJitter(e,r){if(r.type==="inbound-rtp"){var n=r==null?void 0:r.jitter;if(n!==void 0){var i=Gl.getNonNegativeValue(n);e.setJitter(Math.round(i*1e3))}else e.setJitter(-1)}}static buildAudioConcealment(e,r){if(r.type==="inbound-rtp"){var n=1e3*(r==null?void 0:r.totalSamplesDuration)/(r==null?void 0:r.totalSamplesReceived),i=n*(r==null?void 0:r.concealedSamples),a=1e3*(r==null?void 0:r.totalSamplesDuration);e.setAudioConcealment(i,a)}}}class pp{static build(e){var r={},n={download:0,upload:0},i={download:0,upload:0},a=0,o=0,s={local:new Map,remote:new Map},l={local:new Map,remote:new Map},c={local:new Map,remote:new Map},d=new Map,h=new Map,p=0,m=0,g=0,y=0,R=0,b=0;for(var[_,x]of e){var T=x.getLoss(),I=T.isDownloadStream?"download":"upload";if(n[I]+=T.packetsTotal,i[I]+=T.packetsLost,a+=x.getBitrate().download,o+=x.getBitrate().upload,x.kind==="audio"){var C=x.getAudioConcealment();R+=C.concealedAudio,b+=C.totalAudioDuration,p+=x.getBitrate().download,m+=x.getBitrate().upload}else g+=x.getBitrate().download,y+=x.getBitrate().upload;s[x.getType()].set(_,x.getResolution()),l[x.getType()].set(_,x.getFramerate()),c[x.getType()].set(_,x.getCodec()),x.getType()==="remote"&&(d.set(_,x.getJitter()),x.kind==="audio"&&h.set(_,x.getAudioConcealment())),x.resetBitrate()}return r.bitrate={upload:o,download:a},r.bitrate.audio={upload:m,download:p},r.bitrate.video={upload:y,download:g},r.packetLoss={total:pp.calculatePacketLoss(i.download+i.upload,n.download+n.upload),download:pp.calculatePacketLoss(i.download,n.download),upload:pp.calculatePacketLoss(i.upload,n.upload)},r.audioConcealment=h,r.totalAudioConcealment={concealedAudio:R,totalAudioDuration:b},r.framerate=l,r.resolution=s,r.codec=c,r.jitter=d,r}static calculatePacketLoss(e,r){return!r||r<=0||!e||e<=0?0:Math.round(e/r*100)}}class Ws{static buildCallFeedReport(e,r,n){var i=n.getTransceivers(),a=[],o=[];return i.forEach(s=>{var l,c=(l=s.sender)!==null&&l!==void 0&&l.track?Ws.buildTrackStats(s.sender.track,"sender"):null,d=Ws.buildTrackStats(s.receiver.track,"receiver");a.push({mid:s.mid==null?"null":s.mid,direction:s.direction,currentDirection:s.currentDirection==null?"null":s.currentDirection,sender:c,receiver:d})}),{callId:e,opponentMemberId:r,transceiver:a,callFeeds:o}}static buildTrackStats(e){var r,n,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"--",a=(r=e.getSettings())===null||r===void 0?void 0:r.deviceId,o=(n=e.getConstraints())===null||n===void 0?void 0:n.deviceId;return{id:e.id,kind:e.kind,settingDeviceId:a??"unknown",constrainDeviceId:o??"unknown",muted:e.muted,enabled:e.enabled,readyState:e.readyState,label:i}}static expandCallFeedReport(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"unknown";return r.forEach(i=>{var a=i.stream.getAudioTracks(),o=i.stream.getVideoTracks(),s=a.length>0?Ws.buildTrackStats(i.stream.getAudioTracks()[0],i.purpose):null,l=o.length>0?Ws.buildTrackStats(i.stream.getVideoTracks()[0],i.purpose):null,c={stream:i.stream.id,type:i.isLocal()?"local":"remote",audio:s,video:l,purpose:i.purpose,prefix:n,isVideoMuted:i.isVideoMuted(),isAudioMuted:i.isAudioMuted()};e.callFeeds.push(c)}),e}}function ZA(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function mg(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ZA(Object(r),!0).forEach(function(n){E(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ZA(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}class Mpe{constructor(e,r,n,i){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0;this.callId=e,this.opponentMemberId=r,this.pc=n,this.emitter=i,this.isFocus=a,E(this,"isActive",!0),E(this,"previousStatsReport",void 0),E(this,"currentStatsReport",void 0),E(this,"connectionStats",new wpe),E(this,"trackStats",void 0),n.addEventListener("signalingstatechange",this.onSignalStateChange.bind(this)),this.trackStats=new Rpe(new Cpe,new Tpe(n))}processStats(e,r){var n=this;return K(function*(){var i={isFirstCollection:n.previousStatsReport===void 0,receivedMedia:0,receivedAudioMedia:0,receivedVideoMedia:0,audioTrackSummary:{count:0,muted:0,maxPacketLoss:0,maxJitter:0,concealedAudio:0,totalAudio:0},videoTrackSummary:{count:0,muted:0,maxPacketLoss:0,maxJitter:0,concealedAudio:0,totalAudio:0}};if(n.isActive){var a=n.pc.getStats();if(typeof(a==null?void 0:a.then)=="function")return a.then(o=>{var s,l;n.currentStatsReport=typeof(o==null?void 0:o.result)=="function"?o.result():o;try{n.processStatsReport(e,r)}catch(d){return n.handleError(d),i}n.previousStatsReport=n.currentStatsReport,i.receivedMedia=n.connectionStats.bitrate.download,i.receivedAudioMedia=((s=n.connectionStats.bitrate.audio)===null||s===void 0?void 0:s.download)||0,i.receivedVideoMedia=((l=n.connectionStats.bitrate.video)===null||l===void 0?void 0:l.download)||0;var c=fi.buildTrackSummary(Array.from(n.trackStats.getTrack2stats().values()));return mg(mg({},i),{},{audioTrackSummary:c.audioTrackSummary,videoTrackSummary:c.videoTrackSummary})}).catch(o=>(n.handleError(o),i));n.isActive=!1}return Promise.resolve(i)})()}processStatsReport(e,r){var n,i=new Map;i.callId=this.callId,i.opponentMemberId=this.opponentMemberId,(n=this.currentStatsReport)===null||n===void 0||n.forEach(a=>{var o=this.previousStatsReport?this.previousStatsReport.get(a.id):null;if(a.type==="candidate-pair"&&a.nominated&&a.state==="succeeded")this.connectionStats.bandwidth=Epe.buildBandwidthReport(a),this.connectionStats.transport=xpe.buildReport(this.currentStatsReport,a,this.connectionStats.transport,this.isFocus);else if(a.type==="inbound-rtp"||a.type==="outbound-rtp"){var s=this.trackStats.findTrack2Stats(a,a.type==="inbound-rtp"?"remote":"local");if(!s)return;if(o&&fi.buildPacketsLost(s,a,o),a.type==="inbound-rtp"){fi.buildFramerateResolution(s,a),o&&fi.buildBitrateReceived(s,a,o);var l=this.trackStats.findTransceiverByTrackId(s.trackId);fi.setTrackStatsState(s,l),fi.buildJitter(s,a),fi.buildAudioConcealment(s,a)}else o&&(i.set(s.trackId,Gl.getNonNegativeValue(a.bytesSent)),fi.buildBitrateSend(s,a,o));fi.buildCodec(this.currentStatsReport,s,a)}else if(a.type==="track"&&a.kind==="video"&&!a.remoteSource){var c=this.trackStats.findLocalVideoTrackStats(a);if(!c)return;fi.buildFramerateResolution(c,a),fi.calculateSimulcastFramerate(c,a,o,this.trackStats.mediaTrackHandler.getActiveSimulcastStreams())}}),this.emitter.emitByteSendReport(i),this.emitter.emitCallFeedReport(Ws.buildCallFeedReport(this.callId,this.opponentMemberId,this.pc)),this.processAndEmitConnectionStatsReport()}setActive(e){this.isActive=e}getActive(){return this.isActive}handleError(e){this.isActive=!1,U.warn("CallStatsReportGatherer ".concat(this.callId," processStatsReport fails and set to inactive ").concat(e))}processAndEmitConnectionStatsReport(){var e=pp.build(this.trackStats.getTrack2stats());e.callId=this.callId,e.opponentMemberId=this.opponentMemberId,this.connectionStats.bandwidth=e.bandwidth,this.connectionStats.bitrate=e.bitrate,this.connectionStats.packetLoss=e.packetLoss,this.emitter.emitConnectionStatsReport(mg(mg({},e),{},{transport:this.connectionStats.transport})),this.connectionStats.transport=[]}stopProcessingStats(){}onSignalStateChange(){this.pc.signalingState==="stable"&&(this.pc.currentRemoteDescription&&this.trackStats.mediaSsrcHandler.parse(this.pc.currentRemoteDescription.sdp,"remote"),this.pc.currentLocalDescription&&this.trackStats.mediaSsrcHandler.parse(this.pc.currentLocalDescription.sdp,"local"))}setOpponentMemberId(e){this.opponentMemberId=e}}var jo=function(t){return t.CONNECTION_STATS="StatsReport.connection_stats",t.CALL_FEED_REPORT="StatsReport.call_feed_report",t.BYTE_SENT_STATS="StatsReport.byte_sent_stats",t.SUMMARY_STATS="StatsReport.summary_stats",t}({});class Ipe extends nr{emitByteSendReport(e){this.emit(jo.BYTE_SENT_STATS,e)}emitConnectionStatsReport(e){this.emit(jo.CONNECTION_STATS,e)}emitCallFeedReport(e){this.emit(jo.CALL_FEED_REPORT,e)}emitSummaryStatsReport(e){this.emit(jo.SUMMARY_STATS,e)}}class $V{constructor(e){this.emitter=e}build(e){var r=e.filter(d=>!d.isFirstCollection),n=r.length,i=e.length;if(n!==0){var a={receivedAudio:0,receivedVideo:0,receivedMedia:0,concealedAudio:0,totalAudio:0},o=0,s=0;r.forEach(d=>{this.countTrackListReceivedMedia(a,d),this.countConcealedAudio(a,d),o=this.buildMaxJitter(o,d),s=this.buildMaxPacketLoss(s,d)});var l=5,c={percentageReceivedMedia:Number((a.receivedMedia/n).toFixed(l)),percentageReceivedVideoMedia:Number((a.receivedVideo/n).toFixed(l)),percentageReceivedAudioMedia:Number((a.receivedAudio/n).toFixed(l)),maxJitter:o,maxPacketLoss:s,percentageConcealedAudio:Number(a.totalAudio>0?(a.concealedAudio/a.totalAudio).toFixed(l):0),peerConnections:i};this.emitter.emitSummaryStatsReport(c)}}static extendSummaryReport(e,r){var n=[],i=[];for(var a of r){i.push(a);for(var o of a[1])n.push(o)}e.opponentDevicesInCall=Math.max(0,n.length-1),e.opponentUsersInCall=Math.max(0,i.length-1),e.diffDevicesToPeerConnections=Math.max(0,n.length-1)-e.peerConnections,e.ratioPeerConnectionToDevices=Math.max(0,n.length-1)==0?0:e.peerConnections/(n.length-1)}countTrackListReceivedMedia(e,r){var n=!1,i=!1;(r.receivedAudioMedia>0||r.audioTrackSummary.count===0)&&(e.receivedAudio++,n=!0),(r.receivedVideoMedia>0||r.videoTrackSummary.count===0||r.videoTrackSummary.muted>0&&r.videoTrackSummary.muted===r.videoTrackSummary.count)&&(e.receivedVideo++,i=!0),i&&n&&e.receivedMedia++}buildMaxJitter(e,r){return e<r.videoTrackSummary.maxJitter&&(e=r.videoTrackSummary.maxJitter),e<r.audioTrackSummary.maxJitter&&(e=r.audioTrackSummary.maxJitter),e}buildMaxPacketLoss(e,r){return e<r.videoTrackSummary.maxPacketLoss&&(e=r.videoTrackSummary.maxPacketLoss),e<r.audioTrackSummary.maxPacketLoss&&(e=r.audioTrackSummary.maxPacketLoss),e}countConcealedAudio(e,r){e.concealedAudio+=r.audioTrackSummary.concealedAudio,e.totalAudio+=r.audioTrackSummary.totalAudio}}class Ppe{constructor(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1e4;this.groupCallId=e,this.userId=r,this.interval=n,E(this,"timer",void 0),E(this,"gatherers",new Map),E(this,"reports",new Ipe),E(this,"summaryStatsReportGatherer",new $V(this.reports))}start(){this.timer===void 0&&this.interval>0&&(this.timer=setInterval(()=>{this.processStats()},this.interval))}stop(){this.timer!==void 0&&(clearInterval(this.timer),this.gatherers.forEach(e=>e.stopProcessingStats()))}hasStatsReportGatherer(e){return this.gatherers.has(e)}addStatsReportGatherer(e,r,n){return this.hasStatsReportGatherer(e)?!1:(this.gatherers.set(e,new Mpe(e,r,n,this.reports)),!0)}removeStatsReportGatherer(e){return this.gatherers.delete(e)}getStatsReportGatherer(e){return this.hasStatsReportGatherer(e)?this.gatherers.get(e):void 0}updateOpponentMember(e,r){var n;(n=this.getStatsReportGatherer(e))===null||n===void 0||n.setOpponentMemberId(r)}processStats(){var e=[];this.gatherers.forEach(r=>{e.push(r.processStats(this.groupCallId,this.userId))}),Promise.all(e).then(r=>this.summaryStatsReportGatherer.build(r)).catch(r=>{U.error("Could not build summary stats report",r)})}setInterval(e){this.interval=e}}function YA(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function vg(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?YA(Object(r),!0).forEach(function(n){E(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):YA(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var LV=function(t){return t.Ring="m.ring",t.Prompt="m.prompt",t.Room="m.room",t}({}),e_=function(t){return t.Video="m.video",t.Voice="m.voice",t}({}),Ape=function(t){return t.CallEnded="call_ended",t}({}),Kt=function(t){return t.GroupCallStateChanged="group_call_state_changed",t.ActiveSpeakerChanged="active_speaker_changed",t.CallsChanged="calls_changed",t.UserMediaFeedsChanged="user_media_feeds_changed",t.ScreenshareFeedsChanged="screenshare_feeds_changed",t.LocalScreenshareStateChanged="local_screenshare_state_changed",t.LocalMuteStateChanged="local_mute_state_changed",t.ParticipantsChanged="participants_changed",t.Error="group_call_error",t}({}),Nh=function(t){return t.ConnectionStats="GroupCall.connection_stats",t.ByteSentStats="GroupCall.byte_sent_stats",t.SummaryStats="GroupCall.summary_stats",t.CallFeedStats="GroupCall.call_feed_stats",t}({}),mp=function(t){return t.NoUserMedia="no_user_media",t.UnknownDevice="unknown_device",t.PlaceCallFailed="place_call_failed",t}({});class Hx extends Error{constructor(e,r,n){n?(super(r+": "+n),E(this,"code",void 0)):(super(r),E(this,"code",void 0)),this.code=e}}class BV extends Hx{constructor(e){super(mp.UnknownDevice,"No device found for "+e),this.userId=e}}var vr=function(t){return t.LocalCallFeedUninitialized="local_call_feed_uninitialized",t.InitializingLocalCallFeed="initializing_local_call_feed",t.LocalCallFeedInitialized="local_call_feed_initialized",t.Entered="entered",t.Ended="ended",t}({}),JA=1e3*60*60;function gg(t){var e;return((e=t.getOpponentMember())===null||e===void 0?void 0:e.userId)||t.invitee||null}class n3 extends nr{constructor(e,r,n,i,a,o,s,l,c){var d,h,p=arguments.length>9&&arguments[9]!==void 0?arguments[9]:!1,m=arguments.length>10?arguments[10]:void 0;super(),this.client=e,this.room=r,this.type=n,this.isPtt=i,this.intent=a,this.dataChannelsEnabled=s,this.dataChannelOptions=l,this.useLivekit=p,E(this,"activeSpeakerInterval",1e3),E(this,"retryCallInterval",5e3),E(this,"participantTimeout",1e3*15),E(this,"pttMaxTransmitTime",1e3*20),E(this,"activeSpeaker",void 0),E(this,"localCallFeed",void 0),E(this,"localScreenshareFeed",void 0),E(this,"localDesktopCapturerSourceId",void 0),E(this,"userMediaFeeds",[]),E(this,"screenshareFeeds",[]),E(this,"groupCallId",void 0),E(this,"allowCallWithoutVideoAndAudio",void 0),E(this,"calls",new Map),E(this,"callHandlers",new Map),E(this,"activeSpeakerLoopInterval",void 0),E(this,"retryCallLoopInterval",void 0),E(this,"retryCallCounts",new Map),E(this,"reEmitter",void 0),E(this,"transmitTimer",null),E(this,"participantsExpirationTimer",null),E(this,"resendMemberStateTimer",null),E(this,"initWithAudioMuted",!1),E(this,"initWithVideoMuted",!1),E(this,"initCallFeedPromise",void 0),E(this,"_livekitServiceURL",void 0),E(this,"stats",void 0),E(this,"statsCollectIntervalTime",0),E(this,"onConnectionStats",g=>{this.emit(Nh.ConnectionStats,{report:g})}),E(this,"onByteSentStats",g=>{this.emit(Nh.ByteSentStats,{report:g})}),E(this,"onSummaryStats",g=>{$V.extendSummaryReport(g,this.participants),this.emit(Nh.SummaryStats,{report:g})}),E(this,"onCallFeedReport",g=>{this.localCallFeed&&(g=Ws.expandCallFeedReport(g,[this.localCallFeed],"from-local-feed"));var y=[];this.forEachCall(R=>{R.callId===g.callId&&R.getFeeds().forEach(b=>y.push(b))}),g=Ws.expandCallFeedReport(g,y,"from-call-feed"),this.emit(Nh.CallFeedStats,{report:g})}),E(this,"_state",vr.LocalCallFeedUninitialized),E(this,"_participants",new Map),E(this,"_creationTs",null),E(this,"_enteredViaAnotherSession",!1),E(this,"onIncomingCall",g=>{var y,R;if(g.roomId===this.room.roomId){if(g.state!==Je.Ringing){U.warn("GroupCall ".concat(this.groupCallId," onIncomingCall() incoming call no longer in ringing state - ignoring"));return}if(!g.groupCallId||g.groupCallId!==this.groupCallId){U.log("GroupCall ".concat(this.groupCallId," onIncomingCall() ignored because it doesn't match the current group call")),g.reject();return}var b=(y=g.getOpponentMember())===null||y===void 0?void 0:y.userId;if(b===void 0){U.warn("GroupCall ".concat(this.groupCallId," onIncomingCall() incoming call with no member - ignoring"));return}if(this.useLivekit){U.info("Received incoming call whilst in signaling-only mode! Ignoring.");return}var _=(R=this.calls.get(b))!==null&&R!==void 0?R:new Map,x=_.get(g.getOpponentDeviceId());if((x==null?void 0:x.callId)!==g.callId){U.log("GroupCall ".concat(this.groupCallId," onIncomingCall() incoming call (userId=").concat(b,", callId=").concat(g.callId,")")),x&&x.hangup(ot.Replaced,!1),_.set(g.getOpponentDeviceId(),g),this.calls.set(b,_),this.initCall(g);var T=this.getLocalFeeds().map(C=>C.clone());if(!this.callExpected(g))for(var I of T)Pr(I.stream.getAudioTracks(),!1),Pr(I.stream.getVideoTracks(),!1);g.answerWithCallFeeds(T),this.emit(Kt.CallsChanged,this.calls)}}}),E(this,"onRetryCallLoop",()=>{var g=!1;for(var[{userId:y},R]of this.participants){var b=this.calls.get(y),_=this.retryCallCounts.get(y);for(var[x,T]of R){var I,C,k=b==null?void 0:b.get(x),S=(I=(C=_)===null||C===void 0?void 0:C.get(x))!==null&&I!==void 0?I:0;(k==null?void 0:k.getOpponentSessionId())!==T.sessionId&&this.wantsOutgoingCall(y,x)&&S<3&&(_===void 0&&(_=new Map,this.retryCallCounts.set(y,_)),_.set(x,S+1),g=!0)}}g&&this.placeOutgoingCalls()}),E(this,"onCallFeedsChanged",g=>{var y=gg(g),R=g.getOpponentDeviceId();if(!y)throw new Error("Cannot change call feeds without user id");var b=this.getUserMediaFeed(y,R),_=g.remoteUsermediaFeed,x=_!==b,T=this.calls.get(y),I=T==null?void 0:T.get(R);if((I==null?void 0:I.callId)===g.callId){x&&(!b&&_?this.addUserMediaFeed(_):b&&_?this.replaceUserMediaFeed(b,_):b&&!_&&this.removeUserMediaFeed(b));var C=this.getScreenshareFeed(y,R),k=g.remoteScreensharingFeed,S=k!==C;S&&(!C&&k?this.addScreenshareFeed(k):C&&k?this.replaceScreenshareFeed(C,k):C&&!k&&this.removeScreenshareFeed(C))}}),E(this,"onCallStateChanged",(g,y,R)=>{var b;if(y!==Je.Ended){var _=this.localCallFeed.isAudioMuted();g.localUsermediaStream&&g.isMicrophoneMuted()!==_&&g.setMicrophoneMuted(_);var x=this.localCallFeed.isVideoMuted();g.localUsermediaStream&&g.isLocalVideoMuted()!==x&&g.setLocalVideoMuted(x);var T=(b=g.getOpponentMember())===null||b===void 0?void 0:b.userId;if(y===Je.Connected&&T){var I=this.retryCallCounts.get(T);I==null||I.delete(g.getOpponentDeviceId()),(I==null?void 0:I.size)===0&&this.retryCallCounts.delete(T)}}}),E(this,"onCallHangup",g=>{var y,R;if(g.hangupReason!==ot.Replaced){var b=(y=(R=g.getOpponentMember())===null||R===void 0?void 0:R.userId)!==null&&y!==void 0?y:this.room.getMember(g.invitee).userId,_=this.calls.get(b);(_==null?void 0:_.get(g.getOpponentDeviceId()))===g&&(this.disposeCall(g,g.hangupReason),_.delete(g.getOpponentDeviceId()),_.size===0&&this.calls.delete(b),this.emit(Kt.CallsChanged,this.calls))}}),E(this,"onCallReplaced",(g,y)=>{var R=g.getOpponentMember().userId,b=this.calls.get(R);b===void 0&&(b=new Map,this.calls.set(R,b)),g.hangup(ot.Replaced,!1),this.initCall(y),b.set(g.getOpponentDeviceId(),y),this.emit(Kt.CallsChanged,this.calls)}),E(this,"onActiveSpeakerLoop",()=>{var g=void 0,y=void 0;for(var R of this.userMediaFeeds)if(!(R.isLocal()&&this.userMediaFeeds.length>1)){var b=R.speakingVolumeSamples.reduce((x,T)=>x+Math.max(T,Vx)),_=b/R.speakingVolumeSamples.length;(!g||_>g)&&(g=_,y=R)}y&&this.activeSpeaker!==y&&g&&g>Vx&&(this.activeSpeaker=y,this.emit(Kt.ActiveSpeakerChanged,this.activeSpeaker))}),E(this,"onRoomState",()=>this.updateParticipants()),E(this,"onParticipantsChanged",()=>{this.forEachCall(g=>{var y=this.callExpected(g);for(var R of g.getLocalFeeds())Pr(R.stream.getAudioTracks(),!R.isAudioMuted()&&y),Pr(R.stream.getVideoTracks(),!R.isVideoMuted()&&y)}),this.state===vr.Entered&&!this.useLivekit&&this.placeOutgoingCalls()}),E(this,"onStateChanged",(g,y)=>{(g===vr.Entered||y===vr.Entered||g===vr.Ended)&&(this.updateParticipants(),this.updateMemberState().catch(R=>U.error("GroupCall ".concat(this.groupCallId,' onStateChanged() failed to update member state devices"'),R)))}),E(this,"onLocalFeedsChanged",()=>{this.state===vr.Entered&&this.updateMemberState().catch(g=>U.error("GroupCall ".concat(this.groupCallId," onLocalFeedsChanged() failed to update member state feeds"),g))}),this.reEmitter=new Qj(this),this.groupCallId=o??ql(),this._livekitServiceURL=m,this.creationTs=(d=(h=r.currentState.getStateEvents(ge.GroupCallPrefix,this.groupCallId))===null||h===void 0?void 0:h.getTs())!==null&&d!==void 0?d:null,this.updateParticipants(),r.on(dt.Update,this.onRoomState),this.on(Kt.ParticipantsChanged,this.onParticipantsChanged),this.on(Kt.GroupCallStateChanged,this.onStateChanged),this.on(Kt.LocalScreenshareStateChanged,this.onLocalFeedsChanged),this.allowCallWithoutVideoAndAudio=!!c}create(){var e=this;return K(function*(){return e.creationTs=Date.now(),e.client.groupCallEventHandler.groupCalls.set(e.room.roomId,e),e.client.emit(Kx.Outgoing,e),yield e.sendCallStateEvent(),e})()}sendCallStateEvent(){var e=this;return K(function*(){var r={"m.intent":e.intent,"m.type":e.type,"io.element.ptt":e.isPtt,dataChannelsEnabled:e.dataChannelsEnabled,dataChannelOptions:e.dataChannelsEnabled?e.dataChannelOptions:void 0};e.livekitServiceURL&&(r["io.element.livekit_service_url"]=e.livekitServiceURL),yield e.client.sendStateEvent(e.room.roomId,ge.GroupCallPrefix,r,e.groupCallId)})()}get livekitServiceURL(){return this._livekitServiceURL}updateLivekitServiceURL(e){return this._livekitServiceURL=e,this.sendCallStateEvent()}get state(){return this._state}set state(e){var r=this._state;e!==r&&(this._state=e,this.emit(Kt.GroupCallStateChanged,e,r))}get participants(){return this._participants}set participants(e){var r=this._participants,n=(a,o)=>a.sessionId===o.sessionId&&a.screensharing===o.screensharing,i=(a,o)=>sA(a,o,n);sA(e,r,i)||(this._participants=e,this.emit(Kt.ParticipantsChanged,e))}get creationTs(){return this._creationTs}set creationTs(e){this._creationTs=e}get enteredViaAnotherSession(){return this._enteredViaAnotherSession}set enteredViaAnotherSession(e){this._enteredViaAnotherSession=e,this.updateParticipants()}forEachCall(e){for(var r of this.calls.values())for(var n of r.values())e(n)}getLocalFeeds(){var e=[];return this.localCallFeed&&e.push(this.localCallFeed),this.localScreenshareFeed&&e.push(this.localScreenshareFeed),e}hasLocalParticipant(){var e,r;return(e=(r=this.participants.get(this.room.getMember(this.client.getUserId())))===null||r===void 0?void 0:r.has(this.client.getDeviceId()))!==null&&e!==void 0?e:!1}callExpected(e){var r,n=gg(e),i=n===null?null:this.room.getMember(n),a=e.getOpponentDeviceId();return i!==null&&a!==void 0&&((r=this.participants.get(i))===null||r===void 0?void 0:r.get(a))!==void 0}initLocalCallFeed(){var e=this;return K(function*(){if(e.useLivekit){U.info("Livekit group call: not starting local call feed.");return}if(e.state!==vr.LocalCallFeedUninitialized)throw new Error('Cannot initialize local call feed in the "'.concat(e.state,'" state.'));if(e.state=vr.InitializingLocalCallFeed,e.initCallFeedPromise)return e.initCallFeedPromise;try{e.initCallFeedPromise=e.initLocalCallFeedInternal(),yield e.initCallFeedPromise}finally{e.initCallFeedPromise=void 0}})()}initLocalCallFeedInternal(){var e=this;return K(function*(){U.log("GroupCall ".concat(e.groupCallId," initLocalCallFeedInternal() running"));var r;try{r=yield e.client.getMediaHandler().getUserMediaStream(!0,e.type===e_.Video)}catch(i){if(e.allowCallWithoutVideoAndAudio)r=new MediaStream;else throw e.state=vr.LocalCallFeedUninitialized,i}if(e._state!==vr.InitializingLocalCallFeed)throw e.client.getMediaHandler().stopUserMediaStream(r),new Error("Group call disposed while gathering media stream");var n=new Po({client:e.client,roomId:e.room.roomId,userId:e.client.getUserId(),deviceId:e.client.getDeviceId(),stream:r,purpose:Ht.Usermedia,audioMuted:e.initWithAudioMuted||r.getAudioTracks().length===0||e.isPtt,videoMuted:e.initWithVideoMuted||r.getVideoTracks().length===0});Pr(r.getAudioTracks(),!n.isAudioMuted()),Pr(r.getVideoTracks(),!n.isVideoMuted()),e.localCallFeed=n,e.addUserMediaFeed(n),e.state=vr.LocalCallFeedInitialized})()}updateLocalUsermediaStream(e){var r=this;return K(function*(){if(r.localCallFeed){var n=r.localCallFeed.stream;r.localCallFeed.setNewStream(e);var i=r.localCallFeed.isAudioMuted(),a=r.localCallFeed.isVideoMuted();U.log("GroupCall ".concat(r.groupCallId," updateLocalUsermediaStream() (oldStreamId=").concat(n.id,", newStreamId=").concat(e.id,", micShouldBeMuted=").concat(i,", vidShouldBeMuted=").concat(a,")")),Pr(e.getAudioTracks(),!i),Pr(e.getVideoTracks(),!a),r.client.getMediaHandler().stopUserMediaStream(n)}})()}enter(){var e=this;return K(function*(){if(e.state===vr.LocalCallFeedUninitialized)yield e.initLocalCallFeed();else if(e.state!==vr.LocalCallFeedInitialized)throw new Error('Cannot enter call in the "'.concat(e.state,'" state'));U.log("GroupCall ".concat(e.groupCallId," enter() running")),e.state=vr.Entered,e.client.on(zx.Incoming,e.onIncomingCall);for(var r of e.client.callEventHandler.calls.values())e.onIncomingCall(r);e.useLivekit||(e.retryCallLoopInterval=setInterval(e.onRetryCallLoop,e.retryCallInterval),e.activeSpeaker=void 0,e.onActiveSpeakerLoop(),e.activeSpeakerLoopInterval=setInterval(e.onActiveSpeakerLoop,e.activeSpeakerInterval))})()}dispose(){var e;this.localCallFeed&&(this.removeUserMediaFeed(this.localCallFeed),this.localCallFeed=void 0),this.localScreenshareFeed&&(this.client.getMediaHandler().stopScreensharingStream(this.localScreenshareFeed.stream),this.removeScreenshareFeed(this.localScreenshareFeed),this.localScreenshareFeed=void 0,this.localDesktopCapturerSourceId=void 0),this.client.getMediaHandler().stopAllStreams(),this.transmitTimer!==null&&(clearTimeout(this.transmitTimer),this.transmitTimer=null),this.retryCallLoopInterval!==void 0&&(clearInterval(this.retryCallLoopInterval),this.retryCallLoopInterval=void 0),this.participantsExpirationTimer!==null&&(clearTimeout(this.participantsExpirationTimer),this.participantsExpirationTimer=null),this.state===vr.Entered&&(this.forEachCall(r=>r.hangup(ot.UserHangup,!1)),this.activeSpeaker=void 0,clearInterval(this.activeSpeakerLoopInterval),this.retryCallCounts.clear(),clearInterval(this.retryCallLoopInterval),this.client.removeListener(zx.Incoming,this.onIncomingCall),(e=this.stats)===null||e===void 0||e.stop())}leave(){this.dispose(),this.state=vr.LocalCallFeedUninitialized}terminate(){var e=arguments,r=this;return K(function*(){var n=e.length>0&&e[0]!==void 0?e[0]:!0;if(r.dispose(),r.room.off(dt.Update,r.onRoomState),r.client.groupCallEventHandler.groupCalls.delete(r.room.roomId),r.client.emit(Kx.Ended,r),r.state=vr.Ended,n){var i=r.room.currentState.getStateEvents(ge.GroupCallPrefix,r.groupCallId);yield r.client.sendStateEvent(r.room.roomId,ge.GroupCallPrefix,vg(vg({},i.getContent()),{},{"m.terminated":Ape.CallEnded}),r.groupCallId)}})()}isLocalVideoMuted(){return this.localCallFeed?this.localCallFeed.isVideoMuted():!0}isMicrophoneMuted(){return this.localCallFeed?this.localCallFeed.isAudioMuted():!0}setMicrophoneMuted(e){var r=this;return K(function*(){if(!e&&!(yield r.client.getMediaHandler().hasAudioDevice()))return!1;var n=!e&&r.isPtt;r.isPtt&&(!e&&r.isMicrophoneMuted()?r.transmitTimer=setTimeout(()=>{r.setMicrophoneMuted(!0)},r.pttMaxTransmitTime):e&&!r.isMicrophoneMuted()&&(r.transmitTimer!==null&&clearTimeout(r.transmitTimer),r.transmitTimer=null)),r.forEachCall(o=>{var s;return(s=o.localUsermediaFeed)===null||s===void 0?void 0:s.setAudioVideoMuted(e,null)});var i=function(){var o=K(function*(){var s=[];r.forEachCall(l=>s.push(l.sendMetadataUpdate())),yield Promise.all(s).catch(l=>U.info("GroupCall ".concat(r.groupCallId," setMicrophoneMuted() failed to send some metadata updates"),l))});return function(){return o.apply(this,arguments)}}();if(n&&(yield i()),r.localCallFeed){U.log("GroupCall ".concat(r.groupCallId," setMicrophoneMuted() (streamId=").concat(r.localCallFeed.stream.id,", muted=").concat(e,")"));var a=yield r.checkAudioPermissionIfNecessary(e);if(!a)return!1;r.localCallFeed.setAudioVideoMuted(e,null),Pr(r.localCallFeed.stream.getAudioTracks(),!e)}else U.log("GroupCall ".concat(r.groupCallId," setMicrophoneMuted() no stream muted (muted=").concat(e,")")),r.initWithAudioMuted=e;return r.forEachCall(o=>Pr(o.localUsermediaFeed.stream.getAudioTracks(),!e&&r.callExpected(o))),r.emit(Kt.LocalMuteStateChanged,e,r.isLocalVideoMuted()),n||(yield i()),!0})()}checkAudioPermissionIfNecessary(e){var r=this;return K(function*(){try{if(!e&&r.localCallFeed&&!r.localCallFeed.hasAudioTrack){var n=yield r.client.getMediaHandler().getUserMediaStream(!0,!r.localCallFeed.isVideoMuted());if((n==null?void 0:n.getTracks().length)===0)return U.log("GroupCall ".concat(r.groupCallId," setMicrophoneMuted() no device to receive local stream, muted=").concat(e)),!1}}catch{return U.log("GroupCall ".concat(r.groupCallId," setMicrophoneMuted() no device or permission to receive local stream, muted=").concat(e)),!1}return!0})()}setLocalVideoMuted(e){var r=this;return K(function*(){if(!e&&!(yield r.client.getMediaHandler().hasVideoDevice()))return!1;if(r.localCallFeed){U.log("GroupCall ".concat(r.groupCallId," setLocalVideoMuted() (stream=").concat(r.localCallFeed.stream.id,", muted=").concat(e,")"));try{var n=yield r.client.getMediaHandler().getUserMediaStream(!0,!e);yield r.updateLocalUsermediaStream(n),r.localCallFeed.setAudioVideoMuted(null,e),Pr(r.localCallFeed.stream.getVideoTracks(),!e)}catch{return U.log("GroupCall ".concat(r.groupCallId," setLocalVideoMuted() no device or permission to receive local stream, muted=").concat(e)),!1}}else U.log("GroupCall ".concat(r.groupCallId," setLocalVideoMuted() no stream muted (muted=").concat(e,")")),r.initWithVideoMuted=e;var i=[];return r.forEachCall(a=>i.push(a.setLocalVideoMuted(e))),yield Promise.all(i),r.forEachCall(a=>Pr(a.localUsermediaFeed.stream.getVideoTracks(),!e&&r.callExpected(a))),r.emit(Kt.LocalMuteStateChanged,r.isMicrophoneMuted(),e),!0})()}setScreensharingEnabled(e){var r=arguments,n=this;return K(function*(){var i=r.length>1&&r[1]!==void 0?r[1]:{};if(e===n.isScreensharing())return e;if(e)try{U.log("GroupCall ".concat(n.groupCallId," setScreensharingEnabled() is asking for screensharing permissions"));var a=yield n.client.getMediaHandler().getScreensharingStream(i),o=function*(c){var d=()=>{n.setScreensharingEnabled(!1),c.removeEventListener("ended",d)};c.addEventListener("ended",d)};for(var s of a.getTracks())yield*o(s);return U.log("GroupCall ".concat(n.groupCallId," setScreensharingEnabled() granted screensharing permissions. Setting screensharing enabled on all calls")),n.localDesktopCapturerSourceId=i.desktopCapturerSourceId,n.localScreenshareFeed=new Po({client:n.client,roomId:n.room.roomId,userId:n.client.getUserId(),deviceId:n.client.getDeviceId(),stream:a,purpose:Ht.Screenshare,audioMuted:!1,videoMuted:!1}),n.addScreenshareFeed(n.localScreenshareFeed),n.emit(Kt.LocalScreenshareStateChanged,!0,n.localScreenshareFeed,n.localDesktopCapturerSourceId),n.forEachCall(l=>l.pushLocalFeed(n.localScreenshareFeed.clone())),!0}catch(l){if(i.throwOnFail)throw l;return U.error("GroupCall ".concat(n.groupCallId," setScreensharingEnabled() enabling screensharing error"),l),n.emit(Kt.Error,new Hx(mp.NoUserMedia,"Failed to get screen-sharing stream: ",l)),!1}else return n.forEachCall(l=>{l.localScreensharingFeed&&l.removeLocalFeed(l.localScreensharingFeed)}),n.client.getMediaHandler().stopScreensharingStream(n.localScreenshareFeed.stream),n.removeScreenshareFeed(n.localScreenshareFeed),n.localScreenshareFeed=void 0,n.localDesktopCapturerSourceId=void 0,n.emit(Kt.LocalScreenshareStateChanged,!1,void 0,void 0),!1})()}isScreensharing(){return!!this.localScreenshareFeed}wantsOutgoingCall(e,r){var n=this.client.getUserId(),i=this.client.getDeviceId();return e>=n&&(e!==n||r>i)}placeOutgoingCalls(){var e=this,r=!1,n=function(s){var l,c=(l=e.calls.get(s))!==null&&l!==void 0?l:new Map,d=function(g){var y=c.get(g);if((y==null?void 0:y.getOpponentSessionId())!==p.sessionId&&e.wantsOutgoingCall(s,g)){r=!0,y!==void 0&&(U.debug("GroupCall ".concat(e.groupCallId," placeOutgoingCalls() replacing call (userId=").concat(s,", deviceId=").concat(g,", callId=").concat(y.callId,")")),y.hangup(ot.NewSession,!1));var R=om(e.client,e.room.roomId,{invitee:s,opponentDeviceId:g,opponentSessionId:p.sessionId,groupCallId:e.groupCallId});R===null?(U.error("GroupCall ".concat(e.groupCallId," placeOutgoingCalls() failed to create call (userId=").concat(s,", device=").concat(g,")")),c.delete(g)):(e.initCall(R),c.set(g,R),U.debug("GroupCall ".concat(e.groupCallId," placeOutgoingCalls() placing call (userId=").concat(s,", deviceId=").concat(g,", sessionId=").concat(p.sessionId,")")),R.placeCallWithCallFeeds(e.getLocalFeeds().map(b=>b.clone()),p.screensharing).then(()=>{e.dataChannelsEnabled&&R.createDataChannel("datachannel",e.dataChannelOptions)}).catch(b=>{U.warn("GroupCall ".concat(e.groupCallId," placeOutgoingCalls() failed to place call (userId=").concat(s,")"),b),b instanceof Do&&b.code===mp.UnknownDevice?e.emit(Kt.Error,b):e.emit(Kt.Error,new Hx(mp.PlaceCallFailed,"Failed to place call to ".concat(s))),R.hangup(ot.SignallingFailed,!1),c.get(g)===R&&c.delete(g)}))}};for(var[h,p]of a)d(h);c.size>0?e.calls.set(s,c):e.calls.delete(s)};for(var[{userId:i},a]of this.participants)n(i);r&&this.emit(Kt.CallsChanged,this.calls)}getMemberStateEvents(e){return e===void 0?this.room.currentState.getStateEvents(ge.GroupCallMemberPrefix):this.room.currentState.getStateEvents(ge.GroupCallMemberPrefix,e)}initCall(e){var r=gg(e);if(!r)throw new Error("Cannot init call without user id");var n=()=>this.onCallFeedsChanged(e),i=(l,c)=>this.onCallStateChanged(e,l,c),a=this.onCallHangup,o=l=>this.onCallReplaced(e,l),s=this.callHandlers.get(r);s===void 0&&(s=new Map,this.callHandlers.set(r,s)),s.set(e.getOpponentDeviceId(),{onCallFeedsChanged:n,onCallStateChanged:i,onCallHangup:a,onCallReplaced:o}),e.on(ut.FeedsChanged,n),e.on(ut.State,i),e.on(ut.Hangup,a),e.on(ut.Replaced,o),e.isPtt=this.isPtt,this.reEmitter.reEmit(e,Object.values(ut)),e.initStats(this.getGroupCallStats()),n()}disposeCall(e,r){var n=gg(e),i=e.getOpponentDeviceId();if(!n)throw new Error("Cannot dispose call without user id");var a=this.callHandlers.get(n),{onCallFeedsChanged:o,onCallStateChanged:s,onCallHangup:l,onCallReplaced:c}=a.get(i);if(e.removeListener(ut.FeedsChanged,o),e.removeListener(ut.State,s),e.removeListener(ut.Hangup,l),e.removeListener(ut.Replaced,c),a.delete(n),a.size===0&&this.callHandlers.delete(n),e.hangupReason!==ot.Replaced){var d=this.getUserMediaFeed(n,i);d&&this.removeUserMediaFeed(d);var h=this.getScreenshareFeed(n,i);h&&this.removeScreenshareFeed(h)}}getUserMediaFeed(e,r){return this.userMediaFeeds.find(n=>n.userId===e&&n.deviceId===r)}addUserMediaFeed(e){this.userMediaFeeds.push(e),e.measureVolumeActivity(!0),this.emit(Kt.UserMediaFeedsChanged,this.userMediaFeeds)}replaceUserMediaFeed(e,r){var n=this.userMediaFeeds.findIndex(i=>i.userId===e.userId&&i.deviceId===e.deviceId);if(n===-1)throw new Error("Couldn't find user media feed to replace");this.userMediaFeeds.splice(n,1,r),e.dispose(),r.measureVolumeActivity(!0),this.emit(Kt.UserMediaFeedsChanged,this.userMediaFeeds)}removeUserMediaFeed(e){var r=this.userMediaFeeds.findIndex(n=>n.userId===e.userId&&n.deviceId===e.deviceId);if(r===-1)throw new Error("Couldn't find user media feed to remove");this.userMediaFeeds.splice(r,1),e.dispose(),this.emit(Kt.UserMediaFeedsChanged,this.userMediaFeeds),this.activeSpeaker===e&&(this.activeSpeaker=this.userMediaFeeds[0],this.emit(Kt.ActiveSpeakerChanged,this.activeSpeaker))}getScreenshareFeed(e,r){return this.screenshareFeeds.find(n=>n.userId===e&&n.deviceId===r)}addScreenshareFeed(e){this.screenshareFeeds.push(e),this.emit(Kt.ScreenshareFeedsChanged,this.screenshareFeeds)}replaceScreenshareFeed(e,r){var n=this.screenshareFeeds.findIndex(i=>i.userId===e.userId&&i.deviceId===e.deviceId);if(n===-1)throw new Error("Couldn't find screenshare feed to replace");this.screenshareFeeds.splice(n,1,r),e.dispose(),this.emit(Kt.ScreenshareFeedsChanged,this.screenshareFeeds)}removeScreenshareFeed(e){var r=this.screenshareFeeds.findIndex(n=>n.userId===e.userId&&n.deviceId===e.deviceId);if(r===-1)throw new Error("Couldn't find screenshare feed to remove");this.screenshareFeeds.splice(r,1),e.dispose(),this.emit(Kt.ScreenshareFeedsChanged,this.screenshareFeeds)}updateParticipants(){var e=this.room.getMember(this.client.getSafeUserId());if(!e){U.warn("GroupCall ".concat(this.groupCallId," updateParticipants() tried to update participants before local room member is available"));return}if(this.participantsExpirationTimer!==null&&(clearTimeout(this.participantsExpirationTimer),this.participantsExpirationTimer=null),this.state===vr.Ended){this.participants=new Map;return}var r=new Map,n=Date.now(),i=this.state===vr.Entered||this.enteredViaAnotherSession,a=1/0;for(var o of this.getMemberStateEvents()){var s=this.room.getMember(o.getStateKey()),l=o.getContent(),c=Array.isArray(l["m.calls"])?l["m.calls"]:[],d=c.find(R=>R["m.call_id"]===this.groupCallId),h=Array.isArray(d==null?void 0:d["m.devices"])?d["m.devices"]:[],p=h.filter(R=>typeof R.device_id=="string"&&typeof R.session_id=="string"&&typeof R.expires_ts=="number"&&R.expires_ts>n&&Array.isArray(R.feeds));if(!i&&(s==null?void 0:s.userId)===this.client.getUserId()&&(p=p.filter(R=>R.device_id!==this.client.getDeviceId())),p.length>0&&(s==null?void 0:s.membership)===ct.Join){var m=new Map;r.set(s,m);for(var g of p)m.set(g.device_id,{sessionId:g.session_id,screensharing:g.feeds.some(R=>R.purpose===Ht.Screenshare)}),g.expires_ts<a&&(a=g.expires_ts)}}if(i){var y=r.get(e);y===void 0&&(y=new Map,r.set(e,y)),y.has(this.client.getDeviceId())||y.set(this.client.getDeviceId(),{sessionId:this.client.getSessionId(),screensharing:this.getLocalFeeds().some(R=>R.purpose===Ht.Screenshare)})}this.participants=r,a<1/0&&(this.participantsExpirationTimer=setTimeout(()=>this.updateParticipants(),a-n))}updateDevices(e){var r=arguments,n=this;return K(function*(){var i,a=r.length>1&&r[1]!==void 0?r[1]:!1,o=Date.now(),s=n.client.getUserId(),l=n.getMemberStateEvents(s),c=(i=l==null?void 0:l.getContent())!==null&&i!==void 0?i:{},d=Array.isArray(c["m.calls"])?c["m.calls"]:[],h=null,p=[];for(var m of d)m["m.call_id"]===n.groupCallId?h=m:p.push(m);h===null&&(h={});var g=Array.isArray(h["m.devices"])?h["m.devices"]:[],y=g.filter(x=>typeof x.device_id=="string"&&typeof x.session_id=="string"&&typeof x.expires_ts=="number"&&x.expires_ts>o&&Array.isArray(x.feeds)),R=e(y);if(R!==null){var b=[...p];R.length>0&&b.push(vg(vg({},h),{},{"m.call_id":n.groupCallId,"m.devices":R}));var _={"m.calls":b};yield n.client.sendStateEvent(n.room.roomId,ge.GroupCallMemberPrefix,_,s,{keepAlive:a})}})()}addDeviceToMemberState(){var e=this;return K(function*(){yield e.updateDevices(r=>[...r.filter(n=>n.device_id!==e.client.getDeviceId()),{device_id:e.client.getDeviceId(),session_id:e.client.getSessionId(),expires_ts:Date.now()+JA,feeds:e.getLocalFeeds().map(n=>({purpose:n.purpose}))}])})()}updateMemberState(){var e=this;return K(function*(){e.resendMemberStateTimer!==null&&(clearInterval(e.resendMemberStateTimer),e.resendMemberStateTimer=null),e.state===vr.Entered?(yield e.addDeviceToMemberState(),e.resendMemberStateTimer=setInterval(K(function*(){U.log("GroupCall ".concat(e.groupCallId,' updateMemberState() resending call member state"'));try{yield e.addDeviceToMemberState()}catch(r){U.error("GroupCall ".concat(e.groupCallId," updateMemberState() failed to resend call member state"),r)}}),JA*3/4)):yield e.updateDevices(r=>r.filter(n=>n.device_id!==e.client.getDeviceId()),!0)})()}cleanMemberState(){var e=this;return K(function*(){var{devices:r}=yield e.client.getDevices(),n=new Map(r.map(i=>[i.device_id,i]));yield e.updateDevices(i=>{var a=i.filter(o=>{var s=n.get(o.device_id);return(s==null?void 0:s.last_seen_ts)!==void 0&&!(o.device_id===e.client.getDeviceId()&&e.state!==vr.Entered&&!e.enteredViaAnotherSession)});return a.length===i.length?null:a})})()}getGroupCallStats(){if(this.stats===void 0){var e=this.client.getUserId()||"unknown";this.stats=new Ppe(this.groupCallId,e,this.statsCollectIntervalTime),this.stats.reports.on(jo.CONNECTION_STATS,this.onConnectionStats),this.stats.reports.on(jo.BYTE_SENT_STATS,this.onByteSentStats),this.stats.reports.on(jo.SUMMARY_STATS,this.onSummaryStats),this.stats.reports.on(jo.CALL_FEED_REPORT,this.onCallFeedReport)}return this.stats}setGroupCallStatsInterval(e){this.statsCollectIntervalTime=e,this.stats!==void 0&&(this.stats.stop(),this.stats.setInterval(e),e>0&&this.stats.start())}}function XA(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function yg(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?XA(Object(r),!0).forEach(function(n){E(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):XA(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var Je=function(t){return t.Fledgling="fledgling",t.InviteSent="invite_sent",t.WaitLocalMedia="wait_local_media",t.CreateOffer="create_offer",t.CreateAnswer="create_answer",t.Connecting="connecting",t.Connected="connected",t.Ringing="ringing",t.Ended="ended",t}({}),QA=function(t){return t.Voice="voice",t.Video="video",t}({}),Cs=function(t){return t.Inbound="inbound",t.Outbound="outbound",t}({}),yr=function(t){return t.Local="local",t.Remote="remote",t}({}),ut=function(t){return t.Hangup="hangup",t.State="state",t.Error="error",t.Replaced="replaced",t.LocalHoldUnhold="local_hold_unhold",t.RemoteHoldUnhold="remote_hold_unhold",t.HoldUnhold="hold_unhold",t.FeedsChanged="feeds_changed",t.AssertedIdentityChanged="asserted_identity_changed",t.LengthChanged="length_changed",t.DataChannel="datachannel",t.SendVoipEvent="send_voip_event",t.PeerConnectionCreated="peer_connection_created",t}({}),ot=function(t){return t.UserHangup="user_hangup",t.LocalOfferFailed="local_offer_failed",t.NoUserMedia="no_user_media",t.UnknownDevices="unknown_devices",t.SendInvite="send_invite",t.CreateAnswer="create_answer",t.CreateOffer="create_offer",t.SendAnswer="send_answer",t.SetRemoteDescription="set_remote_description",t.SetLocalDescription="set_local_description",t.AnsweredElsewhere="answered_elsewhere",t.IceFailed="ice_failed",t.InviteTimeout="invite_timeout",t.Replaced="replaced",t.SignallingFailed="signalling_timeout",t.UserBusy="user_busy",t.Transferred="transferred",t.NewSession="new_session",t}({}),kpe="1",Ope="stun:turn.matrix.org",Iw=60*1e3,$pe=1e3,Lpe=30*1e3,Bpe=2*1e3;class Do extends Error{constructor(e,r,n){super(r+": "+n),E(this,"code",void 0),this.code=e}}function ql(){return Date.now().toString()+al(16)}function ek(t){var e=[{mediaType:"audio",codec:"opus",enableDtx:!0,maxAverageBitrate:t?12e3:void 0}];return e}function ha(t,e){return t+":"+e}class Npe extends nr{constructor(e){var r,n;if(super(),r=this,E(this,"roomId",void 0),E(this,"callId",void 0),E(this,"invitee",void 0),E(this,"hangupParty",void 0),E(this,"hangupReason",void 0),E(this,"direction",void 0),E(this,"ourPartyId",void 0),E(this,"peerConn",void 0),E(this,"toDeviceSeq",0),E(this,"isPtt",!1),E(this,"_state",Je.Fledgling),E(this,"client",void 0),E(this,"forceTURN",void 0),E(this,"turnServers",void 0),E(this,"candidateSendQueue",[]),E(this,"candidateSendTries",0),E(this,"candidatesEnded",!1),E(this,"feeds",[]),E(this,"transceivers",new Map),E(this,"inviteOrAnswerSent",!1),E(this,"waitForLocalAVStream",!1),E(this,"successor",void 0),E(this,"opponentMember",void 0),E(this,"opponentVersion",void 0),E(this,"opponentPartyId",void 0),E(this,"opponentCaps",void 0),E(this,"iceDisconnectedTimeout",void 0),E(this,"iceReconnectionTimeOut",void 0),E(this,"inviteTimeout",void 0),E(this,"removeTrackListeners",new Map),E(this,"remoteOnHold",!1),E(this,"callStatsAtEnd",void 0),E(this,"makingOffer",!1),E(this,"ignoreOffer",!1),E(this,"isSettingRemoteAnswerPending",!1),E(this,"responsePromiseChain",void 0),E(this,"remoteCandidateBuffer",new Map),E(this,"remoteAssertedIdentity",void 0),E(this,"remoteSDPStreamMetadata",void 0),E(this,"callLengthInterval",void 0),E(this,"callStartTime",void 0),E(this,"opponentDeviceId",void 0),E(this,"hasOpponentDeviceInfo",void 0),E(this,"opponentSessionId",void 0),E(this,"groupCallId",void 0),E(this,"stopVideoTrackTimer",void 0),E(this,"isOnlyDataChannelAllowed",void 0),E(this,"stats",void 0),E(this,"gotLocalIceCandidate",a=>{if(a.candidate){if(this.candidatesEnded&&U.warn("Call ".concat(this.callId," gotLocalIceCandidate() got candidate after candidates have ended!")),U.debug("Call ".concat(this.callId," got local ICE ").concat(a.candidate.sdpMid," ").concat(a.candidate.candidate)),this.callHasEnded())return;a.candidate.candidate===""?this.queueCandidate(null):this.queueCandidate(a.candidate)}}),E(this,"onIceGatheringStateChange",a=>{var o;U.debug("Call ".concat(this.callId," onIceGatheringStateChange() ice gathering state changed to ").concat(this.peerConn.iceGatheringState)),((o=this.peerConn)===null||o===void 0?void 0:o.iceGatheringState)==="complete"&&(this.queueCandidate(null),U.debug("Call ".concat(this.callId," onIceGatheringStateChange() ice gathering state complete, set candidates have ended")))}),E(this,"getLocalOfferFailed",a=>{U.error("Call ".concat(this.callId," getLocalOfferFailed() running"),a),this.emit(ut.Error,new Do(ot.LocalOfferFailed,"Failed to get local offer!",a),this),this.terminate(yr.Local,ot.LocalOfferFailed,!1)}),E(this,"getUserMediaFailed",a=>{if(this.successor){this.successor.getUserMediaFailed(a);return}U.warn("Call ".concat(this.callId," getUserMediaFailed() failed to get user media - ending call"),a),this.emit(ut.Error,new Do(ot.NoUserMedia,"Couldn't start capturing media! Is your microphone set up and does this app have permission?",a),this),this.terminate(yr.Local,ot.NoUserMedia,!1)}),E(this,"placeCallFailed",a=>{if(this.successor){this.successor.placeCallFailed(a);return}U.warn("Call ".concat(this.callId," placeCallWithCallFeeds() failed - ending call"),a),this.emit(ut.Error,new Do(ot.IceFailed,"Couldn't start call! Invalid ICE server configuration.",a),this),this.terminate(yr.Local,ot.IceFailed,!1)}),E(this,"onIceConnectionStateChanged",()=>{var a,o,s,l,c,d;if(!this.callHasEnded()){if(U.debug("Call ".concat(this.callId," onIceConnectionStateChanged() running (state=").concat((a=this.peerConn)===null||a===void 0?void 0:a.iceConnectionState,", conn=").concat((o=this.peerConn)===null||o===void 0?void 0:o.connectionState,")")),["connected","completed"].includes((s=(l=this.peerConn)===null||l===void 0?void 0:l.iceConnectionState)!==null&&s!==void 0?s:""))clearTimeout(this.iceDisconnectedTimeout),this.iceDisconnectedTimeout=void 0,this.iceReconnectionTimeOut&&clearTimeout(this.iceReconnectionTimeOut),this.state=Je.Connected,!this.callLengthInterval&&!this.callStartTime&&(this.callStartTime=Date.now(),this.callLengthInterval=setInterval(()=>{this.emit(ut.LengthChanged,Math.round((Date.now()-this.callStartTime)/1e3),this)},$pe));else if(((c=this.peerConn)===null||c===void 0?void 0:c.iceConnectionState)=="failed"){var h;if(this.candidatesEnded=!1,(h=this.peerConn)!==null&&h!==void 0&&h.restartIce){var p;this.candidatesEnded=!1,U.debug("Call ".concat(this.callId," onIceConnectionStateChanged() ice restart (state=").concat((p=this.peerConn)===null||p===void 0?void 0:p.iceConnectionState,")")),this.peerConn.restartIce()}else U.info("Call ".concat(this.callId," onIceConnectionStateChanged() hanging up call (ICE failed and no ICE restart method)")),this.hangup(ot.IceFailed,!1)}else((d=this.peerConn)===null||d===void 0?void 0:d.iceConnectionState)=="disconnected"&&(this.candidatesEnded=!1,this.iceReconnectionTimeOut=setTimeout(()=>{var g,y,R;U.info("Call ".concat(this.callId," onIceConnectionStateChanged() ICE restarting because of ICE disconnected, (state=").concat((g=this.peerConn)===null||g===void 0?void 0:g.iceConnectionState,", conn=").concat((y=this.peerConn)===null||y===void 0?void 0:y.connectionState,")")),(R=this.peerConn)!==null&&R!==void 0&&R.restartIce&&(this.candidatesEnded=!1,this.peerConn.restartIce()),this.iceReconnectionTimeOut=void 0},Bpe),this.iceDisconnectedTimeout=setTimeout(()=>{U.info("Call ".concat(this.callId," onIceConnectionStateChanged() hanging up call (ICE disconnected for too long)")),this.hangup(ot.IceFailed,!1)},Lpe),this.state=Je.Connecting);if(this.isPtt&&["failed","disconnected"].includes(this.peerConn.iceConnectionState))for(var m of this.getRemoteFeeds())m.setAudioVideoMuted(!0,!0)}}),E(this,"onSignallingStateChanged",()=>{var a;U.debug("Call ".concat(this.callId," onSignallingStateChanged() running (state=").concat((a=this.peerConn)===null||a===void 0?void 0:a.signalingState,")"))}),E(this,"onTrack",a=>{if(a.streams.length===0){U.warn("Call ".concat(this.callId," onTrack() called with streamless track streamless (kind=").concat(a.track.kind,")"));return}var o=a.streams[0];if(this.pushRemoteFeed(o),!this.removeTrackListeners.has(o)){var s=()=>{o.getTracks().length===0&&(U.info("Call ".concat(this.callId," onTrack() removing track (streamId=").concat(o.id,")")),this.deleteFeedByStream(o),o.removeEventListener("removetrack",s),this.removeTrackListeners.delete(o))};o.addEventListener("removetrack",s),this.removeTrackListeners.set(o,s)}}),E(this,"onDataChannel",a=>{this.emit(ut.DataChannel,a.channel,this)}),E(this,"onNegotiationNeeded",K(function*(){if(U.info("Call ".concat(r.callId," onNegotiationNeeded() negotiation is needed!")),r.state!==Je.CreateOffer&&r.opponentVersion===0){U.info("Call ".concat(r.callId," onNegotiationNeeded() opponent does not support renegotiation: ignoring negotiationneeded event"));return}r.queueGotLocalOffer()})),E(this,"onHangupReceived",a=>{U.debug("Call ".concat(this.callId," onHangupReceived() running")),this.partyIdMatches(a)||this.state===Je.Ringing?this.terminate(yr.Remote,a.reason||ot.UserHangup,!0):U.info("Call ".concat(this.callId," onHangupReceived() ignoring message from party ID ").concat(a.party_id,": our partner is ").concat(this.opponentPartyId))}),E(this,"onRejectReceived",a=>{U.debug("Call ".concat(this.callId," onRejectReceived() running"));var o=[Je.InviteSent,Je.Ringing].includes(this.state)||this.state===Je.Fledgling&&this.direction===Cs.Inbound;o?this.terminate(yr.Remote,a.reason||ot.UserHangup,!0):U.debug("Call ".concat(this.callId," onRejectReceived() called in wrong state (state=").concat(this.state,")"))}),E(this,"onAnsweredElsewhere",a=>{U.debug("Call ".concat(this.callId," onAnsweredElsewhere() running")),this.terminate(yr.Remote,ot.AnsweredElsewhere,!0)}),this.roomId=e.roomId,this.invitee=e.invitee,this.client=e.client,!this.client.deviceId)throw new Error("Client must have a device ID to start calls");this.forceTURN=(n=e.forceTURN)!==null&&n!==void 0?n:!1,this.ourPartyId=this.client.deviceId,this.opponentDeviceId=e.opponentDeviceId,this.opponentSessionId=e.opponentSessionId,this.groupCallId=e.groupCallId,this.turnServers=e.turnServers||[],this.turnServers.length===0&&this.client.isFallbackICEServerAllowed()&&this.turnServers.push({urls:[Ope]});for(var i of this.turnServers)gj(i,["urls"]);this.callId=ql(),this.isOnlyDataChannelAllowed=this.client.isVoipWithNoMediaAllowed}placeVoiceCall(){var e=this;return K(function*(){yield e.placeCall(!0,!1)})()}placeVideoCall(){var e=this;return K(function*(){yield e.placeCall(!0,!0)})()}createDataChannel(e,r){var n=this.peerConn.createDataChannel(e,r);return this.emit(ut.DataChannel,n,this),n}getOpponentMember(){return this.opponentMember}getOpponentDeviceId(){return this.opponentDeviceId}getOpponentSessionId(){return this.opponentSessionId}opponentCanBeTransferred(){return!!(this.opponentCaps&&this.opponentCaps["m.call.transferee"])}opponentSupportsDTMF(){return!!(this.opponentCaps&&this.opponentCaps["m.call.dtmf"])}getRemoteAssertedIdentity(){return this.remoteAssertedIdentity}get state(){return this._state}set state(e){var r=this._state;this._state=e,this.emit(ut.State,e,r,this)}get type(){return this.hasUserMediaVideoSender||this.hasRemoteUserMediaVideoTrack?QA.Video:QA.Voice}get hasLocalUserMediaVideoTrack(){var e;return!!((e=this.localUsermediaStream)!==null&&e!==void 0&&e.getVideoTracks().length)}get hasRemoteUserMediaVideoTrack(){return this.getRemoteFeeds().some(e=>{var r;return e.purpose===Ht.Usermedia&&((r=e.stream)===null||r===void 0?void 0:r.getVideoTracks().length)})}get hasLocalUserMediaAudioTrack(){var e;return!!((e=this.localUsermediaStream)!==null&&e!==void 0&&e.getAudioTracks().length)}get hasRemoteUserMediaAudioTrack(){return this.getRemoteFeeds().some(e=>{var r;return e.purpose===Ht.Usermedia&&!!((r=e.stream)!==null&&r!==void 0&&r.getAudioTracks().length)})}get hasUserMediaAudioSender(){var e;return!!(!((e=this.transceivers.get(ha(Ht.Usermedia,"audio")))===null||e===void 0)&&e.sender)}get hasUserMediaVideoSender(){var e;return!!(!((e=this.transceivers.get(ha(Ht.Usermedia,"video")))===null||e===void 0)&&e.sender)}get localUsermediaFeed(){return this.getLocalFeeds().find(e=>e.purpose===Ht.Usermedia)}get localScreensharingFeed(){return this.getLocalFeeds().find(e=>e.purpose===Ht.Screenshare)}get localUsermediaStream(){var e;return(e=this.localUsermediaFeed)===null||e===void 0?void 0:e.stream}get localScreensharingStream(){var e;return(e=this.localScreensharingFeed)===null||e===void 0?void 0:e.stream}get remoteUsermediaFeed(){return this.getRemoteFeeds().find(e=>e.purpose===Ht.Usermedia)}get remoteScreensharingFeed(){return this.getRemoteFeeds().find(e=>e.purpose===Ht.Screenshare)}get remoteUsermediaStream(){var e;return(e=this.remoteUsermediaFeed)===null||e===void 0?void 0:e.stream}get remoteScreensharingStream(){var e;return(e=this.remoteScreensharingFeed)===null||e===void 0?void 0:e.stream}getFeedByStreamId(e){return this.getFeeds().find(r=>r.stream.id===e)}getFeeds(){return this.feeds}getLocalFeeds(){return this.feeds.filter(e=>e.isLocal())}getRemoteFeeds(){return this.feeds.filter(e=>!e.isLocal())}initOpponentCrypto(){var e=this;return K(function*(){var r;if(e.opponentDeviceId&&e.client.getUseE2eForGroupCall()){if(!e.client.getCrypto()){e.hasOpponentDeviceInfo=!0;return}var n=e.invitee||((r=e.getOpponentMember())===null||r===void 0?void 0:r.userId);throw n?(e.hasOpponentDeviceInfo=!1,new BV(n)):new Error("Couldn't find opponent user ID to init crypto")}})()}getLocalSDPStreamMetadata(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,r={};for(var n of this.getLocalFeeds())e&&(n.sdpMetadataStreamId=n.stream.id),r[n.sdpMetadataStreamId]={purpose:n.purpose,audio_muted:n.isAudioMuted(),video_muted:n.isVideoMuted()};return r}noIncomingFeeds(){return!this.feeds.some(e=>!e.isLocal())}pushRemoteFeed(e){if(!this.opponentSupportsSDPStreamMetadata()){this.pushRemoteFeedWithoutMetadata(e);return}var r=this.getOpponentMember().userId,n=this.remoteSDPStreamMetadata[e.id].purpose,i=this.remoteSDPStreamMetadata[e.id].audio_muted,a=this.remoteSDPStreamMetadata[e.id].video_muted;if(!n){U.warn("Call ".concat(this.callId," pushRemoteFeed() ignoring stream because we didn't get any metadata about it (streamId=").concat(e.id,")"));return}if(this.getFeedByStreamId(e.id)){U.warn("Call ".concat(this.callId," pushRemoteFeed() ignoring stream because we already have a feed for it (streamId=").concat(e.id,")"));return}this.feeds.push(new Po({client:this.client,call:this,roomId:this.roomId,userId:r,deviceId:this.getOpponentDeviceId(),stream:e,purpose:n,audioMuted:i,videoMuted:a})),this.emit(ut.FeedsChanged,this.feeds,this),U.info("Call ".concat(this.callId," pushRemoteFeed() pushed stream (streamId=").concat(e.id,", active=").concat(e.active,", purpose=").concat(n,")"))}pushRemoteFeedWithoutMetadata(e){var r,n=this.getOpponentMember().userId,i=Ht.Usermedia,a=(r=this.feeds.find(o=>!o.isLocal()))===null||r===void 0?void 0:r.stream;if(a&&e.id!==a.id){U.warn("Call ".concat(this.callId," pushRemoteFeedWithoutMetadata() ignoring new stream because we already have stream (streamId=").concat(e.id,")"));return}if(this.getFeedByStreamId(e.id)){U.warn("Call ".concat(this.callId," pushRemoteFeedWithoutMetadata() ignoring stream because we already have a feed for it (streamId=").concat(e.id,")"));return}this.feeds.push(new Po({client:this.client,call:this,roomId:this.roomId,audioMuted:!1,videoMuted:!1,userId:n,deviceId:this.getOpponentDeviceId(),stream:e,purpose:i})),this.emit(ut.FeedsChanged,this.feeds,this),U.info("Call ".concat(this.callId," pushRemoteFeedWithoutMetadata() pushed stream (streamId=").concat(e.id,", active=").concat(e.active,")"))}pushNewLocalFeed(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=this.client.getUserId();if(Pr(e.getAudioTracks(),!0),Pr(e.getVideoTracks(),!0),this.getFeedByStreamId(e.id)){U.warn("Call ".concat(this.callId," pushNewLocalFeed() ignoring stream because we already have a feed for it (streamId=").concat(e.id,")"));return}this.pushLocalFeed(new Po({client:this.client,roomId:this.roomId,audioMuted:!1,videoMuted:!1,userId:i,deviceId:this.getOpponentDeviceId(),stream:e,purpose:r}),n)}pushLocalFeed(e){var r=this,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(this.feeds.some(o=>e.stream.id===o.stream.id)){U.info("Call ".concat(this.callId," pushLocalFeed() ignoring duplicate local stream (streamId=").concat(e.stream.id,")"));return}if(this.feeds.push(e),n){var i=function(){U.info("Call ".concat(r.callId," pushLocalFeed() adding track to peer connection (id=").concat(a.id,", kind=").concat(a.kind,", streamId=").concat(e.stream.id,", streamPurpose=").concat(e.purpose,", enabled=").concat(a.enabled,")"));var s=ha(e.purpose,a.kind);if(r.transceivers.has(s)){var l=r.transceivers.get(s);l.sender.replaceTrack(a),l.direction=l.direction==="inactive"?"sendonly":"sendrecv"}else{var c=r.peerConn.addTrack(a,e.stream),d=r.peerConn.getTransceivers().find(h=>h.sender===c);d?r.transceivers.set(s,d):U.warn("Call ".concat(r.callId," pushLocalFeed() didn't find a matching transceiver after adding track!"))}};for(var a of e.stream.getTracks())i()}U.info("Call ".concat(this.callId," pushLocalFeed() pushed stream (id=").concat(e.stream.id,", active=").concat(e.stream.active,", purpose=").concat(e.purpose,")")),this.emit(ut.FeedsChanged,this.feeds,this)}removeLocalFeed(e){var r=ha(e.purpose,"audio"),n=ha(e.purpose,"video");for(var i of[r,n])if(this.transceivers.has(i)){var a=this.transceivers.get(i);a.sender&&this.peerConn.removeTrack(a.sender)}e.purpose===Ht.Screenshare&&this.client.getMediaHandler().stopScreensharingStream(e.stream),this.deleteFeed(e)}deleteAllFeeds(){for(var e of this.feeds)(!e.isLocal()||!this.groupCallId)&&e.dispose();this.feeds=[],this.emit(ut.FeedsChanged,this.feeds,this)}deleteFeedByStream(e){var r=this.getFeedByStreamId(e.id);if(!r){U.warn("Call ".concat(this.callId," deleteFeedByStream() didn't find the feed to delete (streamId=").concat(e.id,")"));return}this.deleteFeed(r)}deleteFeed(e){e.dispose(),this.feeds.splice(this.feeds.indexOf(e),1),this.emit(ut.FeedsChanged,this.feeds,this)}getCurrentCallStats(){var e=this;return K(function*(){return e.callHasEnded()?e.callStatsAtEnd:e.collectCallStats()})()}collectCallStats(){var e=this;return K(function*(){if(e.peerConn){var r=yield e.peerConn.getStats(),n=[];return r.forEach(i=>{n.push(i)}),n}})()}initWithInvite(e){var r=this;return K(function*(){var n,i=e.getContent();r.direction=Cs.Inbound;var a=yield r.client.checkTurnServers();a||U.warn("Call ".concat(r.callId," initWithInvite() failed to get TURN credentials! Proceeding with call anyway..."));var o=i[gs];o?r.updateRemoteSDPStreamMetadata(o):U.debug("Call ".concat(r.callId," initWithInvite() did not get any SDPStreamMetadata! Can not send/receive multiple streams")),r.peerConn=r.createPeerConnection(),r.emit(ut.PeerConnectionCreated,r.peerConn,r),r.chooseOpponent(e),yield r.initOpponentCrypto();try{yield r.peerConn.setRemoteDescription(i.offer),U.debug("Call ".concat(r.callId," initWithInvite() set remote description: ").concat(i.offer.type)),yield r.addBufferedIceCandidates()}catch(d){U.debug("Call ".concat(r.callId," initWithInvite() failed to set remote description"),d),r.terminate(yr.Local,ot.SetRemoteDescription,!1);return}var s=(n=r.feeds.find(d=>!d.isLocal()))===null||n===void 0?void 0:n.stream;if(!r.isOnlyDataChannelAllowed&&(!s||s.getTracks().length===0)){U.error("Call ".concat(r.callId," initWithInvite() no remote stream or no tracks after setting remote description!")),r.terminate(yr.Local,ot.SetRemoteDescription,!1);return}if(r.state=Je.Ringing,e.getLocalAge()){var l=setTimeout(()=>{if(r.state==Je.Ringing){var d;U.debug("Call ".concat(r.callId," initWithInvite() invite has expired. Hanging up.")),r.hangupParty=yr.Remote,r.state=Je.Ended,r.stopAllMedia(),r.peerConn.signalingState!="closed"&&r.peerConn.close(),(d=r.stats)===null||d===void 0||d.removeStatsReportGatherer(r.callId),r.emit(ut.Hangup,r)}},i.lifetime-e.getLocalAge()),c=d=>{d!==Je.Ringing&&(clearTimeout(l),r.off(ut.State,c))};r.on(ut.State,c)}})()}initWithHangup(e){this.state=Je.Ended}shouldAnswerWithMediaType(e,r,n){return e&&!r?(U.warn("Call ".concat(this.callId," shouldAnswerWithMediaType() unable to answer with ").concat(n," because the other side isn't sending it either.")),!1):!_j(e)&&e!==r&&!this.opponentSupportsSDPStreamMetadata()?(U.warn("Call ".concat(this.callId," shouldAnswerWithMediaType() unable to answer with ").concat(n,"=").concat(e," because the other side doesn't support it. Answering with ").concat(n,"=").concat(r,".")),r):e??r}answer(e,r){var n=this;return K(function*(){if(!n.inviteOrAnswerSent){if(e===!1&&r===!1)throw new Error("You CANNOT answer a call without media");if(!n.localUsermediaStream&&!n.waitForLocalAVStream){var i=n.state,a=n.shouldAnswerWithMediaType(e,n.hasRemoteUserMediaAudioTrack,"audio"),o=n.shouldAnswerWithMediaType(r,n.hasRemoteUserMediaVideoTrack,"video");n.state=Je.WaitLocalMedia,n.waitForLocalAVStream=!0;try{var s,l=yield n.client.getMediaHandler().getUserMediaStream(a,o);n.waitForLocalAVStream=!1;var c=new Po({client:n.client,roomId:n.roomId,userId:n.client.getUserId(),deviceId:(s=n.client.getDeviceId())!==null&&s!==void 0?s:void 0,stream:l,purpose:Ht.Usermedia,audioMuted:!1,videoMuted:!1}),d=[c];n.localScreensharingFeed&&d.push(n.localScreensharingFeed),n.answerWithCallFeeds(d)}catch(h){if(o)U.warn("Call ".concat(n.callId," answer() failed to getUserMedia(), trying to getUserMedia() without video")),n.state=i,n.waitForLocalAVStream=!1,yield n.answer(a,!1);else{n.getUserMediaFailed(h);return}}}else n.waitForLocalAVStream&&(n.state=Je.WaitLocalMedia)}})()}answerWithCallFeeds(e){this.inviteOrAnswerSent||this.queueGotCallFeedsForAnswer(e)}replacedBy(e){U.debug("Call ".concat(this.callId," replacedBy() running (newCallId=").concat(e.callId,")")),this.state===Je.WaitLocalMedia?(U.debug("Call ".concat(this.callId," replacedBy() telling new call to wait for local media (newCallId=").concat(e.callId,")")),e.waitForLocalAVStream=!0):[Je.CreateOffer,Je.InviteSent].includes(this.state)&&(e.direction===Cs.Outbound?e.queueGotCallFeedsForAnswer([]):(U.debug("Call ".concat(this.callId," replacedBy() handing local stream to new call(newCallId=").concat(e.callId,")")),e.queueGotCallFeedsForAnswer(this.getLocalFeeds().map(r=>r.clone())))),this.successor=e,this.emit(ut.Replaced,e,this),this.hangup(ot.Replaced,!0)}hangup(e,r){if(!this.callHasEnded()&&(U.debug("Call ".concat(this.callId," hangup() ending call (reason=").concat(e,")")),this.terminate(yr.Local,e,!r),![Je.Fledgling,Je.WaitLocalMedia].includes(this.state))){var n={};(this.opponentVersion&&this.opponentVersion!==0||e!==ot.UserHangup)&&(n.reason=e),this.sendVoipEvent(ge.CallHangup,n)}}reject(){if(this.state!==Je.Ringing)throw Error("Call must be in 'ringing' state to reject!");if(this.opponentVersion===0){U.info("Call ".concat(this.callId," reject() opponent version is less than 1: sending hangup instead of reject (opponentVersion=").concat(this.opponentVersion,")")),this.hangup(ot.UserHangup,!0);return}U.debug("Rejecting call: "+this.callId),this.terminate(yr.Local,ot.UserHangup,!0),this.sendVoipEvent(ge.CallReject,{})}upgradeCall(e,r){var n=this;return K(function*(){if(!(!e&&!r)&&n.opponentSupportsSDPStreamMetadata())try{U.debug("Call ".concat(n.callId," upgradeCall() upgrading call (audio=").concat(e,", video=").concat(r,")"));var i=e||n.hasLocalUserMediaAudioTrack,a=r||n.hasLocalUserMediaVideoTrack,o=yield n.client.getMediaHandler().getUserMediaStream(i,a,!1);yield n.updateLocalUsermediaStream(o,e,r)}catch(s){U.error("Call ".concat(n.callId," upgradeCall() failed to upgrade the call"),s),n.emit(ut.Error,new Do(ot.NoUserMedia,"Failed to get camera access: ",s),n)}})()}opponentSupportsSDPStreamMetadata(){return!!this.remoteSDPStreamMetadata}isScreensharing(){return!!this.localScreensharingStream}setScreensharingEnabled(e,r){var n=this;return K(function*(){if(e&&n.isScreensharing())return U.warn("Call ".concat(n.callId," setScreensharingEnabled() there is already a screensharing stream - there is nothing to do!")),!0;if(!e&&!n.isScreensharing())return U.warn("Call ".concat(n.callId," setScreensharingEnabled() there already isn't a screensharing stream - there is nothing to do!")),!1;if(!n.opponentSupportsSDPStreamMetadata())return n.setScreensharingEnabledWithoutMetadataSupport(e,r);if(U.debug("Call ".concat(n.callId," setScreensharingEnabled() running (enabled=").concat(e,")")),e)try{var i=yield n.client.getMediaHandler().getScreensharingStream(r);return i?(n.pushNewLocalFeed(i,Ht.Screenshare),!0):!1}catch(l){return U.error("Call ".concat(n.callId," setScreensharingEnabled() failed to get screen-sharing stream:"),l),!1}else{var a=n.transceivers.get(ha(Ht.Screenshare,"audio")),o=n.transceivers.get(ha(Ht.Screenshare,"video"));for(var s of[a,o])s&&s.sender&&n.peerConn.removeTrack(s.sender);return n.client.getMediaHandler().stopScreensharingStream(n.localScreensharingStream),n.deleteFeedByStream(n.localScreensharingStream),!1}})()}setScreensharingEnabledWithoutMetadataSupport(e,r){var n=this;return K(function*(){if(U.debug("Call ".concat(n.callId," setScreensharingEnabledWithoutMetadataSupport() running (enabled=").concat(e,")")),e)try{var i,a=yield n.client.getMediaHandler().getScreensharingStream(r);if(!a)return!1;var o=a.getTracks().find(p=>p.kind==="video"),s=(i=n.transceivers.get(ha(Ht.Usermedia,"video")))===null||i===void 0?void 0:i.sender;return s==null||s.replaceTrack(o??null),n.pushNewLocalFeed(a,Ht.Screenshare,!1),!0}catch(p){return U.error("Call ".concat(n.callId," setScreensharingEnabledWithoutMetadataSupport() failed to get screen-sharing stream:"),p),!1}else{var l,c,d=(l=n.localUsermediaStream)===null||l===void 0?void 0:l.getTracks().find(p=>p.kind==="video"),h=(c=n.transceivers.get(ha(Ht.Usermedia,"video")))===null||c===void 0?void 0:c.sender;return h==null||h.replaceTrack(d??null),n.client.getMediaHandler().stopScreensharingStream(n.localScreensharingStream),n.deleteFeedByStream(n.localScreensharingStream),!1}})()}updateLocalUsermediaStream(e){var r=arguments,n=this;return K(function*(){var i=r.length>1&&r[1]!==void 0?r[1]:!1,a=r.length>2&&r[2]!==void 0?r[2]:!1,o=n.localUsermediaFeed,s=i||!o.isAudioMuted()&&!n.remoteOnHold,l=a||!o.isVideoMuted()&&!n.remoteOnHold;U.log("Call ".concat(n.callId," updateLocalUsermediaStream() running (streamId=").concat(e.id,", audio=").concat(s,", video=").concat(l,")")),Pr(e.getAudioTracks(),s),Pr(e.getVideoTracks(),l);for(var c of n.localUsermediaStream.getTracks())n.localUsermediaStream.removeTrack(c),c.stop();for(var d of e.getTracks())n.localUsermediaStream.addTrack(d);var h=function*(){var g=ha(Ht.Usermedia,p.kind),y=n.transceivers.get(g),R=y==null?void 0:y.sender,b=!1;if(R)try{U.info("Call ".concat(n.callId," updateLocalUsermediaStream() replacing track (id=").concat(p.id,", kind=").concat(p.kind,", streamId=").concat(e.id,", streamPurpose=").concat(o.purpose,")")),yield R.replaceTrack(p),y.direction=y.direction==="inactive"?"sendonly":"sendrecv",b=!0}catch(T){U.warn("Call ".concat(n.callId," updateLocalUsermediaStream() replaceTrack failed: adding new transceiver instead"),T)}if(!b){U.info("Call ".concat(n.callId," updateLocalUsermediaStream() adding track to peer connection (id=").concat(p.id,", kind=").concat(p.kind,", streamId=").concat(e.id,", streamPurpose=").concat(o.purpose,")"));var _=n.peerConn.addTrack(p,n.localUsermediaStream),x=n.peerConn.getTransceivers().find(T=>T.sender===_);x?n.transceivers.set(g,x):U.warn("Call ".concat(n.callId," updateLocalUsermediaStream() couldn't find matching transceiver for newly added track!"))}};for(var p of e.getTracks())yield*h()})()}setLocalVideoMuted(e){var r=this;return K(function*(){var n;if(U.log("Call ".concat(r.callId," setLocalVideoMuted() running ").concat(e)),!e&&r.stopVideoTrackTimer!==void 0&&(clearTimeout(r.stopVideoTrackTimer),r.stopVideoTrackTimer=void 0),!(yield r.client.getMediaHandler().hasVideoDevice()))return r.isLocalVideoMuted();if(!r.hasUserMediaVideoSender&&!e){var i;return(i=r.localUsermediaFeed)===null||i===void 0||i.setAudioVideoMuted(null,e),yield r.upgradeCall(!1,!0),r.isLocalVideoMuted()}if(!e&&r.localUsermediaStream.getVideoTracks().length===0){var a=yield r.client.getMediaHandler().getUserMediaStream(!0,!0);yield r.updateLocalUsermediaStream(a)}return(n=r.localUsermediaFeed)===null||n===void 0||n.setAudioVideoMuted(null,e),r.updateMuteStatus(),yield r.sendMetadataUpdate(),e&&(r.stopVideoTrackTimer=setTimeout(()=>{for(var o of r.localUsermediaStream.getVideoTracks())o.stop(),r.localUsermediaStream.removeTrack(o)},120)),r.isLocalVideoMuted()})()}isLocalVideoMuted(){var e,r;return(e=(r=this.localUsermediaFeed)===null||r===void 0?void 0:r.isVideoMuted())!==null&&e!==void 0?e:!1}setMicrophoneMuted(e){var r=this;return K(function*(){var n;return U.log("Call ".concat(r.callId," setMicrophoneMuted() running ").concat(e)),(yield r.client.getMediaHandler().hasAudioDevice())?!e&&(!r.hasUserMediaAudioSender||!r.hasLocalUserMediaAudioTrack)?(yield r.upgradeCall(!0,!1),r.isMicrophoneMuted()):((n=r.localUsermediaFeed)===null||n===void 0||n.setAudioVideoMuted(e,null),r.updateMuteStatus(),yield r.sendMetadataUpdate(),r.isMicrophoneMuted()):r.isMicrophoneMuted()})()}isMicrophoneMuted(){var e,r;return(e=(r=this.localUsermediaFeed)===null||r===void 0?void 0:r.isAudioMuted())!==null&&e!==void 0?e:!1}isRemoteOnHold(){return this.remoteOnHold}setRemoteOnHold(e){if(this.isRemoteOnHold()!==e){this.remoteOnHold=e;for(var r of this.peerConn.getTransceivers())r.direction=e?"sendonly":"sendrecv";this.updateMuteStatus(),this.sendMetadataUpdate(),this.emit(ut.RemoteHoldUnhold,this.remoteOnHold,this)}}isLocalOnHold(){if(this.state!==Je.Connected)return!1;var e=!0;for(var r of this.peerConn.getTransceivers()){var n=["inactive","recvonly"].includes(r.currentDirection);n||(e=!1)}return e}sendDtmfDigit(e){for(var r of this.peerConn.getSenders()){var n;if(((n=r.track)===null||n===void 0?void 0:n.kind)==="audio"&&r.dtmf){r.dtmf.insertDTMF(e);return}}throw new Error("Unable to find a track to send DTMF on")}updateMuteStatus(){var e=this.isMicrophoneMuted()||this.remoteOnHold,r=this.isLocalVideoMuted()||this.remoteOnHold;U.log("Call ".concat(this.callId," updateMuteStatus stream ").concat(this.localUsermediaStream.id," micShouldBeMuted ").concat(e," vidShouldBeMuted ").concat(r)),Pr(this.localUsermediaStream.getAudioTracks(),!e),Pr(this.localUsermediaStream.getVideoTracks(),!r)}sendMetadataUpdate(){var e=this;return K(function*(){yield e.sendVoipEvent(ge.CallSDPStreamMetadataChangedPrefix,{[gs]:e.getLocalSDPStreamMetadata()})})()}gotCallFeedsForInvite(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(this.successor){this.successor.queueGotCallFeedsForAnswer(e);return}if(this.callHasEnded()){this.stopAllMedia();return}for(var n of e)this.pushLocalFeed(n);r&&this.peerConn.addTransceiver("video",{direction:"recvonly"}),this.state=Je.CreateOffer,U.debug("Call ".concat(this.callId," gotUserMediaForInvite() run"))}sendAnswer(){var e=this;return K(function*(){var r={answer:{sdp:e.peerConn.localDescription.sdp,type:e.peerConn.localDescription.type},[gs]:e.getLocalSDPStreamMetadata(!0)};r.capabilities={"m.call.transferee":e.client.supportsCallTransfer,"m.call.dtmf":!1};var n=e.discardDuplicateCandidates();U.info("Call ".concat(e.callId," sendAnswer() discarding ").concat(n," candidates that will be sent in answer"));try{yield e.sendVoipEvent(ge.CallAnswer,r),e.inviteOrAnswerSent=!0}catch(o){e.state=Je.Ringing,o instanceof ur&&o.event&&e.client.cancelPendingEvent(o.event);var i=ot.SendAnswer,a="Failed to send answer";throw o.name=="UnknownDeviceError"&&(i=ot.UnknownDevices,a="Unknown devices present in the room"),e.emit(ut.Error,new Do(i,a,o),e),o}e.sendCandidateQueue()})()}queueGotCallFeedsForAnswer(e){this.responsePromiseChain?this.responsePromiseChain=this.responsePromiseChain.then(()=>this.gotCallFeedsForAnswer(e)):this.responsePromiseChain=this.gotCallFeedsForAnswer(e)}mungeSdp(e,r){var n=kV(e.sdp);n.media.forEach(i=>{var a=new Map,o=new Map;for(var s of i.rtp)a.set(s.payload,s.codec),o.set(s.codec,s.payload);for(var l of r)if(l.mediaType===i.type){if(!o.has(l.codec)){U.info("Call ".concat(this.callId," mungeSdp() ignoring SDP modifications for ").concat(l.codec," as it's not present."));continue}var c=[];l.enableDtx!==void 0&&c.push("usedtx=".concat(l.enableDtx?"1":"0")),l.maxAverageBitrate!==void 0&&c.push("maxaveragebitrate=".concat(l.maxAverageBitrate));var d=!1;for(var h of i.fmtp)a.get(h.payload)===l.codec&&(d=!0,h.config+=";"+c.join(";"));d||i.fmtp.push({payload:o.get(l.codec),config:c.join(";")})}}),e.sdp=lpe(n)}createOffer(){var e=this;return K(function*(){var r=yield e.peerConn.createOffer();return e.mungeSdp(r,ek(e.isPtt)),r})()}createAnswer(){var e=this;return K(function*(){var r=yield e.peerConn.createAnswer();return e.mungeSdp(r,ek(e.isPtt)),r})()}gotCallFeedsForAnswer(e){var r=this;return K(function*(){if(!r.callHasEnded()){r.waitForLocalAVStream=!1;for(var n of e)r.pushLocalFeed(n);r.state=Je.CreateAnswer;var i;try{r.getRidOfRTXCodecs(),i=yield r.createAnswer()}catch(a){U.debug("Call ".concat(r.callId," gotCallFeedsForAnswer() failed to create answer: "),a),r.terminate(yr.Local,ot.CreateAnswer,!0);return}try{if(yield r.peerConn.setLocalDescription(i),r.callHasEnded()||(r.state=Je.Connecting,yield new Promise(a=>{setTimeout(a,200)}),r.callHasEnded()))return;r.sendAnswer()}catch(a){U.debug("Call ".concat(r.callId," gotCallFeedsForAnswer() error setting local description!"),a),r.terminate(yr.Local,ot.SetLocalDescription,!0);return}}})()}onRemoteIceCandidatesReceived(e){var r=this;return K(function*(){if(!r.callHasEnded()){var n=e.getContent(),i=n.candidates;if(!i){U.info("Call ".concat(r.callId," onRemoteIceCandidatesReceived() ignoring candidates event with no candidates!"));return}var a=n.version===0?null:n.party_id||null;if(r.opponentPartyId===void 0){if(a){U.info("Call ".concat(r.callId," onRemoteIceCandidatesReceived() buffering ").concat(i.length," candidates until we pick an opponent"));var o=r.remoteCandidateBuffer.get(a)||[];o.push(...i),r.remoteCandidateBuffer.set(a,o)}return}if(!r.partyIdMatches(n)){U.info("Call ".concat(r.callId," onRemoteIceCandidatesReceived() ignoring candidates from party ID ").concat(n.party_id,": we have chosen party ID ").concat(r.opponentPartyId));return}yield r.addIceCandidates(i)}})()}onAnswerReceived(e){var r=this;return K(function*(){var n=e.getContent();if(U.debug("Call ".concat(r.callId," onAnswerReceived() running (hangupParty=").concat(n.party_id,")")),r.callHasEnded()){U.debug("Call ".concat(r.callId," onAnswerReceived() ignoring answer because call has ended"));return}if(r.opponentPartyId!==void 0){U.info("Call ".concat(r.callId," onAnswerReceived() ignoring answer from party ID ").concat(n.party_id,": we already have an answer/reject from ").concat(r.opponentPartyId));return}r.chooseOpponent(e),yield r.addBufferedIceCandidates(),r.state=Je.Connecting;var i=n[gs];i?r.updateRemoteSDPStreamMetadata(i):U.warn("Call ".concat(r.callId," onAnswerReceived() did not get any SDPStreamMetadata! Can not send/receive multiple streams"));try{r.isSettingRemoteAnswerPending=!0,yield r.peerConn.setRemoteDescription(n.answer),r.isSettingRemoteAnswerPending=!1,U.debug("Call ".concat(r.callId," onAnswerReceived() set remote description: ").concat(n.answer.type))}catch(a){r.isSettingRemoteAnswerPending=!1,U.debug("Call ".concat(r.callId," onAnswerReceived() failed to set remote description"),a),r.terminate(yr.Local,ot.SetRemoteDescription,!1);return}if(r.opponentPartyId!==null)try{yield r.sendVoipEvent(ge.CallSelectAnswer,{selected_party_id:r.opponentPartyId})}catch(a){U.warn("Call ".concat(r.callId," onAnswerReceived() failed to send select_answer event"),a)}})()}onSelectAnswerReceived(e){var r=this;return K(function*(){if(r.direction!==Cs.Inbound){U.warn("Call ".concat(r.callId," onSelectAnswerReceived() got select_answer for an outbound call: ignoring"));return}var n=e.getContent().selected_party_id;if(n==null){U.warn("Call ".concat(r.callId," onSelectAnswerReceived() got nonsensical select_answer with null/undefined selected_party_id: ignoring"));return}n!==r.ourPartyId&&(U.info("Call ".concat(r.callId," onSelectAnswerReceived() got select_answer for party ID ").concat(n,": we are party ID ").concat(r.ourPartyId,".")),yield r.terminate(yr.Remote,ot.AnsweredElsewhere,!0))})()}onNegotiateReceived(e){var r=this;return K(function*(){var n=e.getContent(),i=n.description;if(!i||!i.sdp||!i.type){U.info("Call ".concat(r.callId," onNegotiateReceived() ignoring invalid m.call.negotiate event"));return}var a=r.direction===Cs.Inbound,o=!r.makingOffer&&(r.peerConn.signalingState==="stable"||r.isSettingRemoteAnswerPending),s=i.type==="offer"&&!o;if(r.ignoreOffer=!a&&s,r.ignoreOffer){U.info("Call ".concat(r.callId," onNegotiateReceived() ignoring colliding negotiate event because we're impolite"));return}var l=r.isLocalOnHold(),c=n[gs];c?r.updateRemoteSDPStreamMetadata(c):U.warn("Call ".concat(r.callId," onNegotiateReceived() received negotiation event without SDPStreamMetadata!"));try{if(r.isSettingRemoteAnswerPending=i.type=="answer",yield r.peerConn.setRemoteDescription(i),r.isSettingRemoteAnswerPending=!1,U.debug("Call ".concat(r.callId," onNegotiateReceived() set remote description: ").concat(i.type)),i.type==="offer"){var d,h;try{r.getRidOfRTXCodecs(),h=yield r.createAnswer()}catch(m){U.debug("Call ".concat(r.callId," onNegotiateReceived() failed to create answer: "),m),r.terminate(yr.Local,ot.CreateAnswer,!0);return}yield r.peerConn.setLocalDescription(h),U.debug("Call ".concat(r.callId," onNegotiateReceived() create an answer")),r.sendVoipEvent(ge.CallNegotiate,{lifetime:Iw,description:(d=r.peerConn.localDescription)===null||d===void 0?void 0:d.toJSON(),[gs]:r.getLocalSDPStreamMetadata(!0)})}}catch(m){r.isSettingRemoteAnswerPending=!1,U.warn("Call ".concat(r.callId," onNegotiateReceived() failed to complete negotiation"),m)}var p=r.isLocalOnHold();l!==p&&(r.emit(ut.LocalHoldUnhold,p,r),r.emit(ut.HoldUnhold,p))})()}updateRemoteSDPStreamMetadata(e){this.remoteSDPStreamMetadata=Sj(this.remoteSDPStreamMetadata||{},e,!0);for(var r of this.getRemoteFeeds()){var n,i=r.stream.id,a=this.remoteSDPStreamMetadata[i];r.setAudioVideoMuted(a==null?void 0:a.audio_muted,a==null?void 0:a.video_muted),r.purpose=(n=this.remoteSDPStreamMetadata[i])===null||n===void 0?void 0:n.purpose}}onSDPStreamMetadataChangedReceived(e){var r=e.getContent(),n=r[gs];this.updateRemoteSDPStreamMetadata(n)}onAssertedIdentityReceived(e){var r=this;return K(function*(){var n=e.getContent();n.asserted_identity&&(r.remoteAssertedIdentity={id:n.asserted_identity.id,displayName:n.asserted_identity.display_name},r.emit(ut.AssertedIdentityChanged,r))})()}callHasEnded(){return this.state===Je.Ended}queueGotLocalOffer(){this.responsePromiseChain?this.responsePromiseChain=this.responsePromiseChain.then(()=>this.wrappedGotLocalOffer()):this.responsePromiseChain=this.wrappedGotLocalOffer()}wrappedGotLocalOffer(){var e=this;return K(function*(){e.makingOffer=!0;try{yield e.gotLocalOffer()}catch(r){e.getLocalOfferFailed(r);return}finally{e.makingOffer=!1}})()}gotLocalOffer(){var e=this;return K(function*(){if(U.debug("Call ".concat(e.callId," gotLocalOffer() running")),e.callHasEnded()){U.debug("Call ".concat(e.callId,' gotLocalOffer() ignoring newly created offer because the call has ended"'));return}var r;try{e.getRidOfRTXCodecs(),r=yield e.createOffer()}catch(d){U.debug("Call ".concat(e.callId," gotLocalOffer() failed to create offer: "),d),e.terminate(yr.Local,ot.CreateOffer,!0);return}try{yield e.peerConn.setLocalDescription(r)}catch(d){U.debug("Call ".concat(e.callId," gotLocalOffer() error setting local description!"),d),e.terminate(yr.Local,ot.SetLocalDescription,!0);return}if(e.peerConn.iceGatheringState==="gathering"&&(yield new Promise(d=>{setTimeout(d,200)})),!e.callHasEnded()){var n=e.state===Je.CreateOffer?ge.CallInvite:ge.CallNegotiate,i={lifetime:Iw};if(n===ge.CallInvite&&e.invitee&&(i.invitee=e.invitee),e.state===Je.CreateOffer){var a;i.offer=(a=e.peerConn.localDescription)===null||a===void 0?void 0:a.toJSON()}else{var o;i.description=(o=e.peerConn.localDescription)===null||o===void 0?void 0:o.toJSON()}i.capabilities={"m.call.transferee":e.client.supportsCallTransfer,"m.call.dtmf":!1},i[gs]=e.getLocalSDPStreamMetadata(!0);var s=e.discardDuplicateCandidates();U.info("Call ".concat(e.callId," gotLocalOffer() discarding ").concat(s," candidates that will be sent in offer"));try{yield e.sendVoipEvent(n,i)}catch(d){U.error("Call ".concat(e.callId," gotLocalOffer() failed to send invite"),d),d instanceof ur&&d.event&&e.client.cancelPendingEvent(d.event);var l=ot.SignallingFailed,c="Signalling failed";e.state===Je.CreateOffer&&(l=ot.SendInvite,c="Failed to send invite"),d.name=="UnknownDeviceError"&&(l=ot.UnknownDevices,c="Unknown devices present in the room"),e.emit(ut.Error,new Do(l,c,d),e),e.terminate(yr.Local,l,!1);return}e.sendCandidateQueue(),e.state===Je.CreateOffer&&(e.inviteOrAnswerSent=!0,e.state=Je.InviteSent,e.inviteTimeout=setTimeout(()=>{e.inviteTimeout=void 0,e.state===Je.InviteSent&&e.hangup(ot.InviteTimeout,!1)},Iw))}})()}getRidOfRTXCodecs(){if(!(!RTCRtpReceiver.getCapabilities||!RTCRtpSender.getCapabilities)){var e=this.transceivers.get(ha(Ht.Screenshare,"video"));if(!(!e||!e.setCodecPreferences)){var r=RTCRtpReceiver.getCapabilities("video").codecs,n=RTCRtpSender.getCapabilities("video").codecs,i=[];for(var a of[...r,...n])if(a.mimeType!=="video/rtx"){i.push(a);try{e.setCodecPreferences(i)}catch(o){U.info("Working around buggy WebRTC impl: claimed to support codec but threw when setting codec preferences",a,o),i.pop()}}}}}sendVoipEvent(e,r){var n=this;return K(function*(){var i=yg(yg({},r),{},{version:kpe,call_id:n.callId,party_id:n.ourPartyId,conf_id:n.groupCallId});if(n.opponentDeviceId){var a,o=n.toDeviceSeq++,s=yg(yg({},i),{},{device_id:n.client.deviceId,sender_session_id:n.client.getSessionId(),dest_session_id:n.opponentSessionId,seq:o,[Gb]:tpe()});n.emit(ut.SendVoipEvent,{type:"toDevice",eventType:e,userId:n.invitee||((a=n.getOpponentMember())===null||a===void 0?void 0:a.userId),opponentDeviceId:n.opponentDeviceId,content:s},n);var l=n.invitee||n.getOpponentMember().userId;if(n.client.getUseE2eForGroupCall()){if(!n.hasOpponentDeviceInfo){U.warn("Call ".concat(n.callId," sendVoipEvent() failed: we do not have opponentDeviceInfo"));return}throw new Error("Unimplemented")}else yield n.client.sendToDevice(e,new Map([[l,new Map([[n.opponentDeviceId,s]])]]))}else{var c;n.emit(ut.SendVoipEvent,{type:"sendEvent",eventType:e,roomId:n.roomId,content:i,userId:n.invitee||((c=n.getOpponentMember())===null||c===void 0?void 0:c.userId)},n),yield n.client.sendEvent(n.roomId,e,i)}})()}queueCandidate(e){if(e?this.candidateSendQueue.push(e):this.candidatesEnded=!0,!(this.state===Je.Ringing||!this.inviteOrAnswerSent)){var r=this.direction===Cs.Inbound?500:2e3;this.candidateSendTries===0&&setTimeout(()=>{this.sendCandidateQueue()},r)}}discardDuplicateCandidates(){for(var e=0,r=[],n=0;n<this.candidateSendQueue.length;n++){var i=this.candidateSendQueue[n];i.candidate===""?r.push(i):e++}return this.candidateSendQueue=r,e}transfer(e){var r=this;return K(function*(){var n=yield r.client.getProfileInfo(e),i=ql(),a={replacement_id:ql(),target_user:{id:e,display_name:n.displayname,avatar_url:n.avatar_url},create_call:i};yield r.sendVoipEvent(ge.CallReplaces,a),yield r.terminate(yr.Local,ot.Transferred,!0)})()}transferToCall(e){var r=this;return K(function*(){var n,i,a=(n=e.getOpponentMember())===null||n===void 0?void 0:n.userId,o=a?yield r.client.getProfileInfo(a):void 0,s=(i=r.getOpponentMember())===null||i===void 0?void 0:i.userId,l=s?yield r.client.getProfileInfo(s):void 0,c=ql(),d={replacement_id:ql(),target_user:{id:s,display_name:l==null?void 0:l.displayname,avatar_url:l==null?void 0:l.avatar_url},await_call:c};yield e.sendVoipEvent(ge.CallReplaces,d);var h={replacement_id:ql(),target_user:{id:a,display_name:o==null?void 0:o.displayname,avatar_url:o==null?void 0:o.avatar_url},create_call:c};yield r.sendVoipEvent(ge.CallReplaces,h),yield r.terminate(yr.Local,ot.Transferred,!0),yield e.terminate(yr.Local,ot.Transferred,!0)})()}terminate(e,r,n){var i=this;return K(function*(){var a;if(!i.callHasEnded()){i.hangupParty=e,i.hangupReason=r,i.state=Je.Ended,i.inviteTimeout&&(clearTimeout(i.inviteTimeout),i.inviteTimeout=void 0),i.iceDisconnectedTimeout!==void 0&&(clearTimeout(i.iceDisconnectedTimeout),i.iceDisconnectedTimeout=void 0),i.callLengthInterval&&(clearInterval(i.callLengthInterval),i.callLengthInterval=void 0),i.stopVideoTrackTimer!==void 0&&(clearTimeout(i.stopVideoTrackTimer),i.stopVideoTrackTimer=void 0);for(var[o,s]of i.removeTrackListeners)o.removeEventListener("removetrack",s);i.removeTrackListeners.clear(),i.callStatsAtEnd=yield i.collectCallStats(),i.stopAllMedia(),i.deleteAllFeeds(),i.peerConn&&i.peerConn.signalingState!=="closed"&&i.peerConn.close(),(a=i.stats)===null||a===void 0||a.removeStatsReportGatherer(i.callId),n&&i.emit(ut.Hangup,i),i.client.callEventHandler.calls.delete(i.callId)}})()}stopAllMedia(){U.debug("Call ".concat(this.callId," stopAllMedia() running"));for(var e of this.feeds)if(e.isLocal()&&e.purpose===Ht.Usermedia)this.client.getMediaHandler().stopUserMediaStream(e.stream);else if(e.isLocal()&&e.purpose===Ht.Screenshare)this.client.getMediaHandler().stopScreensharingStream(e.stream);else if(!e.isLocal()){U.debug("Call ".concat(this.callId," stopAllMedia() stopping stream (streamId=").concat(e.stream.id,")"));for(var r of e.stream.getTracks())r.stop()}}checkForErrorListener(){if(this.listeners(kj.Error).length===0)throw new Error("You MUST attach an error listener using call.on('error', function() {})")}sendCandidateQueue(){var e=this;return K(function*(){if(!(e.candidateSendQueue.length===0||e.callHasEnded())){var r=e.candidateSendQueue;e.candidateSendQueue=[],++e.candidateSendTries;var n={candidates:r.map(s=>s.toJSON())};e.candidatesEnded&&n.candidates.push({candidate:""}),U.debug("Call ".concat(e.callId," sendCandidateQueue() attempting to send ").concat(r.length," candidates"));try{yield e.sendVoipEvent(ge.CallCandidates,n),e.candidateSendTries=0,e.sendCandidateQueue()}catch(s){if(s instanceof ur&&s.event&&e.client.cancelPendingEvent(s.event),e.candidateSendQueue.push(...r),e.candidateSendTries>5){U.debug("Call ".concat(e.callId," sendCandidateQueue() failed to send candidates on attempt ").concat(e.candidateSendTries,". Giving up on this call."),s);var i=ot.SignallingFailed,a="Signalling failed";e.emit(ut.Error,new Do(i,a,s),e),e.hangup(i,!1);return}var o=500*Math.pow(2,e.candidateSendTries);++e.candidateSendTries,U.debug("Call ".concat(e.callId," sendCandidateQueue() failed to send candidates. Retrying in ").concat(o,"ms"),s),setTimeout(()=>{e.sendCandidateQueue()},o)}}})()}placeCall(e,r){var n=this;return K(function*(){if(!e)throw new Error("You CANNOT start a call without audio");n.state=Je.WaitLocalMedia;var i;try{var a,o=yield n.client.getMediaHandler().getUserMediaStream(e,r);Pr(o.getAudioTracks(),!0),Pr(o.getVideoTracks(),!0),i=new Po({client:n.client,roomId:n.roomId,userId:n.client.getUserId(),deviceId:(a=n.client.getDeviceId())!==null&&a!==void 0?a:void 0,stream:o,purpose:Ht.Usermedia,audioMuted:!1,videoMuted:!1})}catch(s){n.getUserMediaFailed(s);return}try{yield n.placeCallWithCallFeeds([i])}catch(s){n.placeCallFailed(s);return}})()}placeCallWithCallFeeds(e){var r=arguments,n=this;return K(function*(){var i=r.length>1&&r[1]!==void 0?r[1]:!1;n.checkForErrorListener(),n.direction=Cs.Outbound,yield n.initOpponentCrypto(),n.client.callEventHandler.calls.set(n.callId,n);var a=yield n.client.checkTurnServers();a||U.warn("Call ".concat(n.callId," placeCallWithCallFeeds() failed to get TURN credentials! Proceeding with call anyway...")),n.peerConn=n.createPeerConnection(),n.emit(ut.PeerConnectionCreated,n.peerConn,n),n.gotCallFeedsForInvite(e,i)})()}createPeerConnection(){var e,r=new window.RTCPeerConnection({iceTransportPolicy:this.forceTURN?"relay":void 0,iceServers:this.turnServers.length?this.turnServers:void 0,iceCandidatePoolSize:this.client.iceCandidatePoolSize,bundlePolicy:"max-bundle"});r.addEventListener("iceconnectionstatechange",this.onIceConnectionStateChanged),r.addEventListener("signalingstatechange",this.onSignallingStateChanged),r.addEventListener("icecandidate",this.gotLocalIceCandidate),r.addEventListener("icegatheringstatechange",this.onIceGatheringStateChange),r.addEventListener("track",this.onTrack),r.addEventListener("negotiationneeded",this.onNegotiationNeeded),r.addEventListener("datachannel",this.onDataChannel);var n=this.getOpponentMember(),i=n?n.userId:"unknown";return(e=this.stats)===null||e===void 0||e.addStatsReportGatherer(this.callId,i,r),r}partyIdMatches(e){var r=e.version===0?null:e.party_id||null;return r===this.opponentPartyId}chooseOpponent(e){var r,n=e.getContent();if(U.debug("Call ".concat(this.callId," chooseOpponent() running (partyId=").concat(n.party_id,")")),this.opponentVersion=n.version,this.opponentVersion===0?this.opponentPartyId=null:this.opponentPartyId=n.party_id||null,this.opponentCaps=n.capabilities||{},this.opponentMember=(r=this.client.getRoom(this.roomId).getMember(e.getSender()))!==null&&r!==void 0?r:void 0,this.opponentMember){var i;(i=this.stats)===null||i===void 0||i.updateOpponentMember(this.callId,this.opponentMember.userId)}}addBufferedIceCandidates(){var e=this;return K(function*(){var r=e.remoteCandidateBuffer.get(e.opponentPartyId);r&&(U.info("Call ".concat(e.callId," addBufferedIceCandidates() adding ").concat(r.length," buffered candidates for opponent ").concat(e.opponentPartyId)),yield e.addIceCandidates(r)),e.remoteCandidateBuffer.clear()})()}addIceCandidates(e){var r=this;return K(function*(){for(var n of e){(n.sdpMid===null||n.sdpMid===void 0)&&(n.sdpMLineIndex===null||n.sdpMLineIndex===void 0)?U.debug("Call ".concat(r.callId," addIceCandidates() got remote ICE end-of-candidates")):U.debug("Call ".concat(r.callId," addIceCandidates() got remote ICE candidate (sdpMid=").concat(n.sdpMid,", candidate=").concat(n.candidate,")"));try{yield r.peerConn.addIceCandidate(n)}catch(i){r.ignoreOffer?U.debug("Call ".concat(r.callId," addIceCandidates() failed to add remote ICE candidate because ignoring offer"),i):U.info("Call ".concat(r.callId," addIceCandidates() failed to add remote ICE candidate"),i)}}})()}get hasPeerConnection(){return!!this.peerConn}initStats(e){this.stats=e,this.stats.start()}}function Pr(t,e){for(var r of t)r.enabled=e}function Wx(){if(typeof window>"u"||typeof document>"u")return!1;try{var t,e,r,n=!!((t=(e=(r=window.RTCPeerConnection)!==null&&r!==void 0?r:window.RTCSessionDescription)!==null&&e!==void 0?e:window.RTCIceCandidate)!==null&&t!==void 0?t:navigator.mediaDevices);if(!n)return U.error("WebRTC is not supported in this browser / environment"),!1}catch(i){return U.error("Exception thrown when trying to access WebRTC",i),!1}return!0}function om(t,e,r){if(!Wx())return null;var n=r?r.forceTURN:!1,i={client:t,roomId:e,invitee:r==null?void 0:r.invitee,turnServers:t.getTurnServers(),forceTURN:t.forceTURN||n,opponentDeviceId:r==null?void 0:r.opponentDeviceId,opponentSessionId:r==null?void 0:r.opponentSessionId,groupCallId:r==null?void 0:r.groupCallId},a=new Npe(i);return t.reEmitter.reEmit(a,Object.values(ut)),a}var ol=function(t){return t.DontNotify="dont_notify",t.Notify="notify",t.Coalesce="coalesce",t}({}),i3=function(t){return t.Highlight="highlight",t.Sound="sound",t}({}),Upe=function(t){return t.ExactEquals="==",t.LessThan="<",t.GreaterThan=">",t.GreaterThanOrEqual=">=",t.LessThanOrEqual="<=",t}({}),Fpe="2";function jpe(t){return t==="==2"||t==="2"}var Ar=function(t){return t.EventMatch="event_match",t.EventPropertyIs="event_property_is",t.EventPropertyContains="event_property_contains",t.ContainsDisplayName="contains_display_name",t.RoomMemberCount="room_member_count",t.SenderNotificationPermission="sender_notification_permission",t.CallStarted="call_started",t.CallStartedPrefix="org.matrix.msc3914.call_started",t}({}),en=function(t){return t.Override="override",t.ContentSpecific="content",t.RoomSpecific="room",t.SenderSpecific="sender",t.Underride="underride",t}({}),Xr=function(t){return t.Master=".m.rule.master",t.IsUserMention=".m.rule.is_user_mention",t.IsRoomMention=".m.rule.is_room_mention",t.ContainsDisplayName=".m.rule.contains_display_name",t.ContainsUserName=".m.rule.contains_user_name",t.AtRoomNotification=".m.rule.roomnotif",t.DM=".m.rule.room_one_to_one",t.EncryptedDM=".m.rule.encrypted_room_one_to_one",t.Message=".m.rule.message",t.EncryptedMessage=".m.rule.encrypted",t.InviteToSelf=".m.rule.invite_for_me",t.MemberEvent=".m.rule.member_event",t.IncomingCall=".m.rule.call",t.SuppressNotices=".m.rule.suppress_notices",t.Tombstone=".m.rule.tombstone",t.PollStart=".m.rule.poll_start",t.PollStartUnstable=".org.matrix.msc3930.rule.poll_start",t.PollEnd=".m.rule.poll_end",t.PollEndUnstable=".org.matrix.msc3930.rule.poll_end",t.PollStartOneToOne=".m.rule.poll_start_one_to_one",t.PollStartOneToOneUnstable=".org.matrix.msc3930.rule.poll_start_one_to_one",t.PollEndOneToOne=".m.rule.poll_end_one_to_one",t.PollEndOneToOneUnstable=".org.matrix.msc3930.rule.poll_end_one_to_one",t}({});function tk(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function rk(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?tk(Object(r),!0).forEach(function(n){E(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):tk(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var nk=[en.Override,en.ContentSpecific,en.RoomSpecific,en.SenderSpecific,en.Underride],Vpe={".m.rule.is_room_mention":{rule_id:".m.rule.is_room_mention",default:!0,enabled:!0,conditions:[{kind:Ar.EventPropertyIs,key:"content.m\\.mentions.room",value:!0},{kind:Ar.SenderNotificationPermission,key:"room"}],actions:[ol.Notify,{set_tweak:i3.Highlight}]},".m.rule.reaction":{rule_id:".m.rule.reaction",default:!0,enabled:!0,conditions:[{kind:Ar.EventMatch,key:"type",pattern:"m.reaction"}],actions:[ol.DontNotify]},".org.matrix.msc3786.rule.room.server_acl":{rule_id:".org.matrix.msc3786.rule.room.server_acl",default:!0,enabled:!0,conditions:[{kind:Ar.EventMatch,key:"type",pattern:ge.RoomServerAcl},{kind:Ar.EventMatch,key:"state_key",pattern:""}],actions:[]}},a3=Symbol("UserDefinedRules"),zpe=[Xr.Master,a3,Xr.SuppressNotices,Xr.InviteToSelf,Xr.MemberEvent,Xr.IsUserMention,Xr.ContainsDisplayName,Xr.IsRoomMention,Xr.AtRoomNotification,Xr.Tombstone,".m.rule.reaction",".m.rule.room.server_acl",".org.matrix.msc3786.rule.room.server_acl",".m.rule.suppress_edits"],Kpe={".org.matrix.msc3914.rule.room.call":{rule_id:".org.matrix.msc3914.rule.room.call",default:!0,enabled:!0,conditions:[{kind:Ar.EventMatch,key:"type",pattern:"org.matrix.msc3401.call"},{kind:Ar.CallStarted}],actions:[ol.Notify,{set_tweak:i3.Sound,value:"default"}]}},Hpe=[a3,Xr.IncomingCall,".org.matrix.msc3914.rule.room.call",Xr.EncryptedDM,Xr.DM,Xr.Message,Xr.EncryptedMessage];function ik(t,e,r,n){var i=e.filter(m=>m.default),a=e.filter(m=>!m.default);function o(m){m===a3?l.push(...a):m in r?(U.warn("Adding default global ".concat(t," push rule ").concat(m)),l.push(r[m])):U.warn("Missing default global ".concat(t," push rule ").concat(m))}var s=0,l=[];for(var c of i){var d=n.indexOf(c.rule_id);if(d===-1){l.push(c);continue}for(;d>s;){var h=n[s];o(h),s+=1}l.push(c),s+=1}for(var p of n.slice(s))o(p);return l}class ga{constructor(e){this.client=e,E(this,"parsedKeys",new Map)}static actionListToActionsObject(e){var r={notify:!1,tweaks:{}};for(var n of e)n===ol.Notify?r.notify=!0:typeof n=="object"&&(n.value===void 0&&(n.value=!0),r.tweaks[n.set_tweak]=n.value);return r}static rewriteDefaultRules(e){var r=JSON.parse(JSON.stringify(e));return r||(r={}),r.global||(r.global={}),r.global.override||(r.global.override=[]),r.global.underride||(r.global.underride=[]),r.global.override=ik(en.Override,r.global.override,Vpe,zpe),r.global.underride=ik(en.Underride,r.global.underride,Kpe,Hpe),r}static getPushRuleGlobRegex(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"i",[i,a]=r?["(?<=^|\\W)","(?=\\W|$)"]:["^","$"],o="".concat(r,"-").concat(n,"-").concat(e);return ga.cachedGlobToRegex[o]||(ga.cachedGlobToRegex[o]=new RegExp(i+"("+bj(e)+")"+a,n)),ga.cachedGlobToRegex[o]}updateCachedPushRuleKeys(e){e||(e={}),e.global||(e.global={}),e.global.override||(e.global.override=[]),e.global.room||(e.global.room=[]),e.global.sender||(e.global.sender=[]),e.global.underride||(e.global.underride=[]);var r=new Set(this.parsedKeys.keys());for(var n of[e.global.override,e.global.room,e.global.sender,e.global.underride])for(var i of n)if(i.conditions)for(var a of i.conditions)a.kind===Ar.EventMatch&&(r.delete(a.key),this.parsedKeys.set(a.key,ga.partsForDottedKey(a.key)));r.forEach(o=>this.parsedKeys.delete(o))}matchingRuleFromKindSet(e,r){for(var n of nk){var i=r[n];if(i){for(var a of i)if(a.enabled){var o=this.templateRuleToRaw(n,a);if(o&&this.ruleMatchesEvent(o,e))return rk(rk({},a),{},{kind:n})}}}return null}templateRuleToRaw(e,r){var n={rule_id:r.rule_id,actions:r.actions,conditions:[]};switch(e){case en.Underride:case en.Override:n.conditions=r.conditions;break;case en.RoomSpecific:if(!r.rule_id)return null;n.conditions.push({kind:Ar.EventMatch,key:"room_id",value:r.rule_id});break;case en.SenderSpecific:if(!r.rule_id)return null;n.conditions.push({kind:Ar.EventMatch,key:"user_id",value:r.rule_id});break;case en.ContentSpecific:if(!r.pattern)return null;n.conditions.push({kind:Ar.EventMatch,key:"content.body",pattern:r.pattern});break}return n}eventFulfillsCondition(e,r){switch(e.kind){case Ar.EventMatch:return this.eventFulfillsEventMatchCondition(e,r);case Ar.EventPropertyIs:return this.eventFulfillsEventPropertyIsCondition(e,r);case Ar.EventPropertyContains:return this.eventFulfillsEventPropertyContains(e,r);case Ar.ContainsDisplayName:return this.eventFulfillsDisplayNameCondition(e,r);case Ar.RoomMemberCount:return this.eventFulfillsRoomMemberCountCondition(e,r);case Ar.SenderNotificationPermission:return this.eventFulfillsSenderNotifPermCondition(e,r);case Ar.CallStarted:case Ar.CallStartedPrefix:return this.eventFulfillsCallStartedCondition(e,r)}return!1}eventFulfillsSenderNotifPermCondition(e,r){var n=e.key;if(!n)return!1;var i=this.client.getRoom(r.getRoomId());return i!=null&&i.currentState?i.currentState.mayTriggerNotifOfType(n,r.getSender()):!1}eventFulfillsRoomMemberCountCondition(e,r){if(!e.is)return!1;var n=this.client.getRoom(r.getRoomId());if(!n||!n.currentState||!n.currentState.members)return!1;var i=n.currentState.getJoinedMemberCount(),a=e.is.match(/^([=<>]*)(\d*)$/);if(!a)return!1;var o=a[1],s=parseInt(a[2]);if(isNaN(s))return!1;switch(o){case"":case"==":return i==s;case"<":return i<s;case">":return i>s;case"<=":return i<=s;case">=":return i>=s;default:return!1}}eventFulfillsDisplayNameCondition(e,r){var n,i=r.getContent();if(r.isEncrypted()&&r.getClearContent()&&(i=r.getClearContent()),!i||!i.body||typeof i.body!="string")return!1;var a=this.client.getRoom(r.getRoomId()),o=a==null||(n=a.currentState)===null||n===void 0?void 0:n.getMember(this.client.credentials.userId);if(!o)return!1;var s=o.name,l=new RegExp("(^|\\W)"+yj(s)+"(\\W|$)","i");return i.body.search(l)>-1}eventFulfillsEventMatchCondition(e,r){if(!e.key)return!1;var n=this.valueForDottedKey(e.key,r);if(typeof n!="string")return!1;if(e.value)return e.value===n;if(typeof e.pattern!="string")return!1;var i=ga.getPushRuleGlobRegex(e.pattern,e.key==="content.body");return!!n.match(i)}eventFulfillsEventPropertyIsCondition(e,r){return!e.key||e.value===void 0?!1:e.value===this.valueForDottedKey(e.key,r)}eventFulfillsEventPropertyContains(e,r){if(!e.key||e.value===void 0)return!1;var n=this.valueForDottedKey(e.key,r);return Array.isArray(n)?n.includes(e.value):!1}eventFulfillsCallStartedCondition(e,r){return["m.ring","m.prompt"].includes(r.getContent()["m.intent"])&&!("m.terminated"in r.getContent())&&(r.getPrevContent()["m.terminated"]!==r.getContent()["m.terminated"]||ef(r.getPrevContent(),{}))}static partsForDottedKey(e){var r=[],n="",i=!1;for(var a of e){if(i){a==="\\"||a==="."?n+=a:n+="\\"+a,i=!1;continue}a=="."?(r.push(n),n=""):a=="\\"?i=!0:n+=a}return i&&(n+="\\"),r.push(n),r}valueForDottedKey(e,r){var n=this.parsedKeys.get(e);n===void 0&&(n=ga.partsForDottedKey(e),this.parsedKeys.set(e,n));var i,a=n[0],o=0;for(a==="content"?(i=r.getContent(),++o):a==="type"?(i=r.getType(),++o):i=r.event;o<n.length;++o){if(_j(i))return;var s=n[o];i=i[s]}return i}matchingRuleForEventWithRulesets(e,r){return!r||e.getSender()===this.client.getSafeUserId()?null:this.matchingRuleFromKindSet(e,r.global)}pushActionsForEventAndRulesets(e,r){var n=this.matchingRuleForEventWithRulesets(e,r);if(!n)return{};var i=ga.actionListToActionsObject(n.actions);return i.tweaks.highlight===void 0&&(i.tweaks.highlight=n.kind==en.ContentSpecific),{actions:i,rule:n}}ruleMatchesEvent(e,r){var n;return this.client.supportsIntentionalMentions()&&r.getContent()["m.mentions"]!==void 0&&(e.rule_id===Xr.ContainsUserName||e.rule_id===Xr.ContainsDisplayName||e.rule_id===Xr.AtRoomNotification)?!1:!((n=e.conditions)!==null&&n!==void 0&&n.some(i=>!this.eventFulfillsCondition(i,r)))}actionsForEvent(e){var{actions:r}=this.pushActionsForEventAndRulesets(e,this.client.pushRules);return r||{}}actionsAndRuleForEvent(e){return this.pushActionsForEventAndRulesets(e,this.client.pushRules)}getPushRuleById(e){var r,n=this.getPushRuleAndKindById(e);return(r=n==null?void 0:n.rule)!==null&&r!==void 0?r:null}getPushRuleAndKindById(e){for(var r of["global"]){var n;if(((n=this.client.pushRules)===null||n===void 0?void 0:n[r])!==void 0){for(var i of nk)if(this.client.pushRules[r][i]!==void 0){for(var a of this.client.pushRules[r][i])if(a.rule_id===e)return{rule:a,kind:i}}}}return null}}E(ga,"cachedGlobToRegex",{});var sm=["v1.1","v1.2","v1.3","v1.4","v1.5","v1.6","v1.7","v1.8","v1.9"],Wpe=sm[0],Gpe=sm[sm.length-1],gi=function(t){return t.SUCCESS="SUCCESS",t.IGNORE="IGNORE",t.PROMPT="PROMPT",t.FAIL_PROMPT="FAIL_PROMPT",t.FAIL_ERROR="FAIL_ERROR",t}({}),ua=function(t){return t.Invalid="Invalid homeserver discovery response",t.GenericFailure="Failed to get autodiscovery configuration from server",t.InvalidHsBaseUrl="Invalid base_url for m.homeserver",t.InvalidHomeserver="Homeserver URL does not appear to be a valid Matrix homeserver",t.InvalidIsBaseUrl="Invalid base_url for m.identity_server",t.InvalidIdentityServer="Identity server URL does not appear to be a valid identity server",t.InvalidIs="Invalid identity server discovery response",t.MissingWellknown="No .well-known JSON file found",t.InvalidJson="Invalid JSON",t.UnsupportedHomeserverSpecVersion="The homeserver does not meet the version requirements",t}({});class tt{static fromDiscoveryConfig(e){var r=this;return K(function*(){var n,i={"m.homeserver":{state:tt.FAIL_ERROR,error:tt.ERROR_INVALID,base_url:null},"m.identity_server":{state:tt.PROMPT,error:null,base_url:null}};if(!(e!=null&&e["m.homeserver"]))return U.error("No m.homeserver key in config"),i["m.homeserver"].state=tt.FAIL_PROMPT,i["m.homeserver"].error=tt.ERROR_INVALID,Promise.resolve(i);if(!e["m.homeserver"].base_url)return U.error("No m.homeserver base_url in config"),i["m.homeserver"].state=tt.FAIL_PROMPT,i["m.homeserver"].error=tt.ERROR_INVALID_HS_BASE_URL,Promise.resolve(i);var a=r.sanitizeWellKnownUrl(e["m.homeserver"].base_url);if(!a)return U.error("Invalid base_url for m.homeserver"),i["m.homeserver"].error=tt.ERROR_INVALID_HS_BASE_URL,Promise.resolve(i);var o=yield r.fetchWellKnownObject("".concat(a,"/_matrix/client/versions"));if(!o||!Array.isArray((n=o.raw)===null||n===void 0?void 0:n.versions))return U.error("Invalid /versions response"),i["m.homeserver"].error=tt.ERROR_INVALID_HOMESERVER,i["m.homeserver"].base_url=a,Promise.resolve(i);var s=new Set(o.raw.versions),l=!1;for(var c of sm)if(s.has(c)){l=!0;break}if(!l)return U.error("Homeserver does not meet version requirements"),i["m.homeserver"].error=tt.ERROR_UNSUPPORTED_HOMESERVER_SPEC_VERSION,i["m.homeserver"].base_url=a,Promise.resolve(i);i["m.homeserver"]={state:tt.SUCCESS,error:null,base_url:a};var d="";if(e["m.identity_server"]){var h={"m.homeserver":i["m.homeserver"],"m.identity_server":{state:tt.FAIL_PROMPT,error:tt.ERROR_INVALID_IS,base_url:null}};if(d=r.sanitizeWellKnownUrl(e["m.identity_server"].base_url),!d)return U.error("Invalid base_url for m.identity_server"),h["m.identity_server"].error=tt.ERROR_INVALID_IS_BASE_URL,Promise.resolve(h);var p=yield r.fetchWellKnownObject("".concat(d,"/_matrix/identity/v2"));if(!(p!=null&&p.raw)||p.action!==gi.SUCCESS)return U.error("Invalid /v2 response"),h["m.identity_server"].error=tt.ERROR_INVALID_IDENTITY_SERVER,h["m.identity_server"].base_url=d,Promise.resolve(h)}return d&&d.toString().length>0&&(i["m.identity_server"]={state:tt.SUCCESS,error:null,base_url:d}),Object.keys(e).forEach(m=>{if(m==="m.homeserver"||m==="m.identity_server"){var g=["error","state","base_url"];for(var y of Object.keys(e[m]))g.includes(y)||(i[m][y]=e[m][y])}else i[m]=e[m]}),Promise.resolve(i)})()}static findClientConfig(e){var r=this;return K(function*(){if(!e||typeof e!="string"||e.length===0)throw new Error("'domain' must be a string of non-zero length");var n={"m.homeserver":{state:tt.FAIL_ERROR,error:tt.ERROR_INVALID,base_url:null},"m.identity_server":{state:tt.PROMPT,error:null,base_url:null}},i=e.includes("://")?e:"https://".concat(e),a=yield r.fetchWellKnownObject("".concat(i,"/.well-known/matrix/client"));return!a||a.action!==gi.SUCCESS?(U.error("No response or error when parsing .well-known"),a.reason&&U.error(a.reason),a.action===gi.IGNORE?n["m.homeserver"]={state:tt.PROMPT,error:null,base_url:null}:(n["m.homeserver"].state=tt.FAIL_PROMPT,n["m.homeserver"].error=tt.ERROR_INVALID),Promise.resolve(n)):tt.fromDiscoveryConfig(a.raw)})()}static getRawClientConfig(e){var r=this;return K(function*(){var n;if(!e||typeof e!="string"||e.length===0)throw new Error("'domain' must be a string of non-zero length");var i=yield r.fetchWellKnownObject("https://".concat(e,"/.well-known/matrix/client"));return i?(n=i.raw)!==null&&n!==void 0?n:{}:{}})()}static sanitizeWellKnownUrl(e){if(!e)return!1;try{var r,n;try{n=new URL(e)}catch(s){U.error("Could not parse url",s)}if(!((r=n)!==null&&r!==void 0&&r.hostname)||n.protocol!=="http:"&&n.protocol!=="https:")return!1;var i=n.port?":".concat(n.port):"",a=n.pathname?n.pathname:"",o="".concat(n.protocol,"//").concat(n.hostname).concat(i).concat(a);return o.endsWith("/")&&(o=o.substring(0,o.length-1)),o}catch(s){return U.error(s),!1}}static fetch(e,r){return this.fetchFn?this.fetchFn(e,r):globalThis.fetch(e,r)}static setFetchFn(e){tt.fetchFn=e}static fetchWellKnownObject(e){return K(function*(){var r;try{if(r=yield tt.fetch(e,{method:_e.Get,signal:Jb(5e3)}),r.status===404)return{raw:{},action:gi.IGNORE,reason:tt.ERROR_MISSING_WELLKNOWN};if(!r.ok)return{raw:{},action:gi.FAIL_PROMPT,reason:"General failure"}}catch(o){var n=o,i="";return typeof n=="object"&&(i=n==null?void 0:n.message),{error:n,raw:{},action:gi.FAIL_PROMPT,reason:i||"General failure"}}try{return{raw:yield r.json(),action:gi.SUCCESS}}catch(o){var a=o;return{error:a,raw:{},action:gi.FAIL_PROMPT,reason:(a==null?void 0:a.name)==="SyntaxError"?tt.ERROR_INVALID_JSON:tt.ERROR_INVALID}}})()}}E(tt,"ERROR_INVALID",ua.Invalid);E(tt,"ERROR_GENERIC_FAILURE",ua.GenericFailure);E(tt,"ERROR_INVALID_HS_BASE_URL",ua.InvalidHsBaseUrl);E(tt,"ERROR_INVALID_HOMESERVER",ua.InvalidHomeserver);E(tt,"ERROR_INVALID_IS_BASE_URL",ua.InvalidIsBaseUrl);E(tt,"ERROR_INVALID_IDENTITY_SERVER",ua.InvalidIdentityServer);E(tt,"ERROR_INVALID_IS",ua.InvalidIs);E(tt,"ERROR_MISSING_WELLKNOWN",ua.MissingWellknown);E(tt,"ERROR_INVALID_JSON",ua.InvalidJson);E(tt,"ERROR_UNSUPPORTED_HOMESERVER_SPEC_VERSION",ua.UnsupportedHomeserverSpecVersion);E(tt,"ALL_ERRORS",Object.keys(ua));E(tt,"FAIL_ERROR",gi.FAIL_ERROR);E(tt,"FAIL_PROMPT",gi.FAIL_PROMPT);E(tt,"PROMPT",gi.PROMPT);E(tt,"SUCCESS",gi.SUCCESS);E(tt,"fetchFn",void 0);var Gx=function(t){return t.IS="SERVICE_TYPE_IS",t.IM="SERVICE_TYPE_IM",t}({});class qpe{constructor(e){this.ourEvent=e,E(this,"timeline",void 0),E(this,"ourEventIndex",0),E(this,"paginateTokens",{[st.Backward]:null,[st.Forward]:null}),this.timeline=[e]}getEvent(){return this.timeline[this.ourEventIndex]}getTimeline(){return this.timeline}getOurEventIndex(){return this.ourEventIndex}getPaginateToken(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.paginateTokens[e?st.Backward:st.Forward]}setPaginateToken(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.paginateTokens[r?st.Backward:st.Forward]=e??null}addEvents(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;r?(this.timeline=e.concat(this.timeline),this.ourEventIndex+=e.length):this.timeline=this.timeline.concat(e)}}class t_{static fromJson(e,r){var n=e.context||{},i=(n.events_before||[]).map(r),a=(n.events_after||[]).map(r),o=new qpe(r(e.result)),s=o.ourEvent.threadRootId;return i=i.filter(l=>l.threadRootId===s),a=a.filter(l=>l.threadRootId===s),o.setPaginateToken(n.start,!0),o.addEvents(i,!0),o.addEvents(a,!1),o.setPaginateToken(n.end,!1),new t_(e.rank,o)}constructor(e,r){this.rank=e,this.context=r}}var Zpe=function(t){return t.Public="public",t.Private="private",t}({}),o3=function(t){return t.PrivateChat="private_chat",t.TrustedPrivateChat="trusted_private_chat",t.PublicChat="public_chat",t}({}),NV=function(t){return t.Public="public",t.Invite="invite",t.Private="private",t.Knock="knock",t.Restricted="restricted",t}({}),Ype=function(t){return t.RoomMembership="m.room_membership",t}({}),B0=function(t){return t.CanJoin="can_join",t.Forbidden="forbidden",t}({}),s3=function(t){return t.Invited="invited",t.Joined="joined",t.Shared="shared",t.WorldReadable="world_readable",t}({});function ak(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function ok(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ak(Object(r),!0).forEach(function(n){E(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ak(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Jpe(t,e){var r=!!e.preventReEmit,n=e.decrypt!==!1;function i(a){var o=t.getRoom(a.room_id),s;o&&a.state_key===void 0&&(s=o.findEventById(a.event_id)),!s||s.status?s=new Bn(a):(s.setUnsigned(ok(ok({},s.getUnsigned()),a.unsigned)),r=!0);var l=s.getServerAggregatedRelation(gr.Replace);if(l!=null&&l.content){var c=i(l);s.makeReplaced(c)}var d=o==null?void 0:o.findThreadForEvent(s);return d&&s.setThread(d),s.isEncrypted()&&(r||t.reEmitter.reEmit(s,[At.Decrypted]),n&&t.decryptEventIfNeeded(s)),r||(t.reEmitter.reEmit(s,[At.Replaced,At.VisibilityChange]),o==null||o.reEmitter.reEmit(s,[At.BeforeRedaction])),s}return i}function sk(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function ys(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?sk(Object(r),!0).forEach(function(n){E(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):sk(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}class lk{constructor(e,r,n){this.client=e,this.indexEvent=r,this.directory=n}get id(){var e=this.indexEvent.getStateKey();if(!e)throw new Error("State key not found for branch");return e}get isActive(){return this.indexEvent.getContent().active===!0}get version(){var e;return(e=this.indexEvent.getContent().version)!==null&&e!==void 0?e:1}get roomId(){return this.indexEvent.getRoomId()}delete(){var e=this;return K(function*(){yield e.client.sendStateEvent(e.roomId,Io.name,{},e.id),yield e.client.redactEvent(e.roomId,e.id);var r=(yield e.getVersionHistory())[1];r&&(yield r.delete())})()}getName(){return this.indexEvent.getContent().name||"Unnamed File"}setName(e){var r=this;return K(function*(){yield r.client.sendStateEvent(r.roomId,Io.name,ys(ys({},r.indexEvent.getContent()),{},{name:e}),r.id)})()}isLocked(){return this.indexEvent.getContent().locked||!1}setLocked(e){var r=this;return K(function*(){yield r.client.sendStateEvent(r.roomId,Io.name,ys(ys({},r.indexEvent.getContent()),{},{locked:e}),r.id)})()}getFileInfo(){var e=this;return K(function*(){var r=yield e.getFileEvent(),n=r.getOriginalContent().file,i=e.client.mxcUrlToHttp(n.url);if(!i)throw new Error("No HTTP URL available for ".concat(n.url));return{info:n,httpUrl:i}})()}getFileEvent(){var e=this;return K(function*(){var r=e.client.getRoom(e.roomId);if(!r)throw new Error("Unknown room");for(var n=r.getUnfilteredTimelineSet().findEventById(e.id);!n&&r.getLiveTimeline().getState(Be.BACKWARDS).paginationToken;)yield e.client.scrollback(r,100),n=r.getUnfilteredTimelineSet().findEventById(e.id);if(!n)throw new Error("Failed to find event");return yield e.client.decryptEventIfNeeded(n),n})()}createNewVersion(e,r,n,i){var a=this;return K(function*(){var o=yield a.directory.createFile(e,r,n,ys(ys({},i??{}),{},{"m.new_content":!0,"m.relates_to":{rel_type:gr.Replace,event_id:a.id}}));return yield a.client.sendStateEvent(a.roomId,Io.name,{active:!0,name:e,version:a.version+1},o.event_id),yield a.client.sendStateEvent(a.roomId,Io.name,ys(ys({},a.indexEvent.getContent()),{},{active:!1}),a.id),o})()}getVersionHistory(){var e=this;return K(function*(){var r=[];r.push(e);var n=e.client.getRoom(e.roomId);if(!n)throw new Error("Invalid or unknown room");var i=[...n.getLiveTimeline().getEvents()].reverse(),a,o=yield e.getFileEvent();do if(a=i.find(l=>l.replacingEventId()===o.getId()),a){var s=e.directory.getFile(a.getId());if(s)r.push(s),o=a;else break}while(a);return r})()}}function uk(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Bl(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?uk(Object(r),!0).forEach(function(n){E(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):uk(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var Xpe={invite:100,kick:100,ban:100,redact:50,state_default:50,events_default:50,users_default:0,events:{[ge.RoomPowerLevels]:100,[ge.RoomHistoryVisibility]:100,[ge.RoomTombstone]:100,[ge.RoomEncryption]:100,[ge.RoomName]:50,[ge.RoomMessage]:50,[ge.RoomMessageEncrypted]:50,[ge.Sticker]:50},users:{}},Ec=function(t){return t.Viewer="viewer",t.Editor="editor",t.Owner="owner",t}({});class ck{constructor(e,r){if(this.client=e,this.roomId=r,E(this,"room",void 0),this.room=this.client.getRoom(this.roomId),!this.room)throw new Error("Unknown room")}get id(){return this.roomId}get isTopLevel(){var e=this.room.currentState.getStateEvents(ge.SpaceParent);return e!=null&&e.length?e.every(r=>{var n;return!((n=r.getContent())!==null&&n!==void 0&&n.via)}):!0}setName(e){var r=this;return K(function*(){yield r.client.sendStateEvent(r.roomId,ge.RoomName,{name:e},"")})()}invite(e){var r=arguments,n=this;return K(function*(){var i=r.length>1&&r[1]!==void 0?r[1]:!0,a=[n.retryInvite(e)];i&&a.push(...n.getDirectories().map(o=>o.invite(e,i))),yield Promise.all(a)})()}retryInvite(e){var r=this;return fce(K(function*(){yield r.client.invite(r.roomId,e).catch(n=>{throw(n==null?void 0:n.errcode)==="M_FORBIDDEN"?new vj.AbortError(n):n})}))}setPermissions(e,r){var n=this;return K(function*(){var i,a=n.room.currentState.getStateEvents(ge.RoomPowerLevels,"");if(Array.isArray(a))throw new Error("Unexpected return type for power levels");var o=(a==null?void 0:a.getContent())||{},s=o.users_default||0,l=o.events_default||50,c=((i=o.events)===null||i===void 0?void 0:i[ge.RoomPowerLevels])||100,d=o.users||{};switch(r){case Ec.Viewer:d[e]=s;break;case Ec.Editor:d[e]=l;break;case Ec.Owner:d[e]=c;break;default:throw new Error("Invalid role: "+r)}o.users=d,yield n.client.sendStateEvent(n.roomId,ge.RoomPowerLevels,o,"")})()}getPermissions(e){var r,n,i=this.room.currentState.getStateEvents(ge.RoomPowerLevels,"");if(Array.isArray(i))throw new Error("Unexpected return type for power levels");var a=(i==null?void 0:i.getContent())||{},o=a.users_default||0,s=a.events_default||50,l=((r=a.events)===null||r===void 0?void 0:r[ge.RoomPowerLevels])||100,c=((n=a.users)===null||n===void 0?void 0:n[e])||o;return c>=l?Ec.Owner:c>=s?Ec.Editor:Ec.Viewer}createDirectory(e){var r=this;return K(function*(){var n=yield r.client.unstableCreateFileTree(e);return yield r.client.sendStateEvent(r.roomId,ge.SpaceChild,{via:[r.client.getDomain()]},n.roomId),yield r.client.sendStateEvent(n.roomId,ge.SpaceParent,{via:[r.client.getDomain()]},r.roomId),n})()}getDirectories(){var e=[],r=this.room.currentState.getStateEvents(ge.SpaceChild);for(var n of r)try{var i=n.getStateKey();if(i){var a=this.client.unstableGetFileTreeSpace(i);a&&e.push(a)}}catch(o){U.warn("Unable to create tree space instance for listing. Are we joined?",o)}return e}getDirectory(e){return this.getDirectories().find(r=>r.roomId===e)}delete(){var e=this;return K(function*(){var r=e.getDirectories();for(var n of r)yield n.delete();var i=[ct.Invite,ct.Knock,ct.Join],a=e.room.currentState.getStateEvents(ge.RoomMember);for(var o of a){var s=o.getStateKey()!==e.client.getUserId();if(s&&i.includes(o.getContent().membership)){var l=o.getStateKey();if(!l)throw new Error("State key not found for branch");yield e.client.kick(e.roomId,l,"Room deleted")}}yield e.client.leave(e.roomId)})()}getOrderedChildren(e){var r=e.map(n=>({roomId:n.getStateKey(),order:n.getContent().order})).filter(n=>n.roomId);return r.sort((n,i)=>{if(n.order&&!i.order)return-1;if(!n.order&&i.order)return 1;if(!n.order&&!i.order){var a,o,s,l,c=this.client.getRoom(n.roomId),d=this.client.getRoom(i.roomId);if(!c||!d)return Yg(n.roomId,i.roomId);var h=(a=(o=c.currentState.getStateEvents(ge.RoomCreate,""))===null||o===void 0?void 0:o.getTs())!==null&&a!==void 0?a:0,p=(s=(l=d.currentState.getStateEvents(ge.RoomCreate,""))===null||l===void 0?void 0:l.getTs())!==null&&s!==void 0?s:0;return h===p?Yg(n.roomId,i.roomId):h-p}else return Yg(n.order,i.order)}),r}getParentRoom(){var e=this.room.currentState.getStateEvents(ge.SpaceParent),r=e[0];if(!r)throw new Error("Expected to have a parent in a non-top level space");var n=r.getStateKey();if(!n)throw new Error("No state key found for parent");var i=this.client.getRoom(n);if(!i)throw new Error("Unable to locate room for parent");return i}getOrder(){if(this.isTopLevel)return-1;var e=this.getParentRoom(),r=e.currentState.getStateEvents(ge.SpaceChild),n=this.getOrderedChildren(r);return n.findIndex(i=>i.roomId===this.roomId)}setOrder(e){var r=this;return K(function*(){var n;if(r.isTopLevel)throw new Error("Cannot set order of top level spaces currently");var i=r.getParentRoom(),a=i.currentState.getStateEvents(ge.SpaceChild),o=r.getOrderedChildren(a);e=Math.max(Math.min(e,o.length-1),0);var s=r.getOrder(),l=s<e;l&&e===o.length-1?e--:!l&&e===0&&e++;var c=o[l?e:e-1],d=o[l?e+1:e],h=vl[0],p=!1;if(!c)d!=null&&d.order&&(h=aA(d.order));else if(e===o.length-1)d!=null&&d.order&&(h=fh(d.order));else{var m=c==null?void 0:c.order,g=d==null?void 0:d.order;m&&g?m===g?h=fh(m):h=hce(m,g):m?h=fh(m):g?h=aA(g):p=!0}if(p){for(var y,R=0;R<=e;R++){var b=o[R];if(R===0&&(y=b.order),b.order)y=b.order;else{var _;y=y?fh(y):vl[0];var x=i.currentState.getStateEvents(ge.SpaceChild,b.roomId),T=(_=x==null?void 0:x.getContent())!==null&&_!==void 0?_:{via:[r.client.getDomain()]};yield r.client.sendStateEvent(i.roomId,ge.SpaceChild,Bl(Bl({},T),{},{order:y}),b.roomId)}}y&&(h=fh(y))}var I=i.currentState.getStateEvents(ge.SpaceChild,r.roomId),C=(n=I==null?void 0:I.getContent())!==null&&n!==void 0?n:{via:[r.client.getDomain()]};yield r.client.sendStateEvent(i.roomId,ge.SpaceChild,Bl(Bl({},C),{},{order:h}),r.roomId)})()}createFile(e,r,n,i){var a=this;return K(function*(){var{content_uri:o}=yield a.client.uploadContent(r,{includeFilename:!1});n.url=o;var s={msgtype:Ma.File,body:e,url:o,file:n};i=i??{},i["m.new_content"]&&(i["m.new_content"]=s);var l=yield a.client.sendMessage(a.roomId,Bl(Bl(Bl({},i),s),{},{[Oj.name]:{}}));return yield a.client.sendStateEvent(a.roomId,Io.name,{active:!0,name:e},l.event_id),l})()}getFile(e){var r=this.room.currentState.getStateEvents(Io.name,e);return r?new lk(this.client,r,this):null}listFiles(){return this.listAllFiles().filter(e=>e.isActive)}listAllFiles(){var e,r=(e=this.room.currentState.getStateEvents(Io.name))!==null&&e!==void 0?e:[];return r.map(n=>new lk(this.client,n,this))}}var UV=function(t){return t.Recent="recent",t.Rank="rank",t}({}),Zl=function(t){return t.LocalStreamsChanged="local_streams_changed",t}({});class Qpe extends nr{constructor(e){super(),this.client=e,E(this,"audioInput",void 0),E(this,"audioSettings",void 0),E(this,"videoInput",void 0),E(this,"localUserMediaStream",void 0),E(this,"userMediaStreams",[]),E(this,"screensharingStreams",[]),E(this,"getMediaStreamPromise",void 0)}restoreMediaSettings(e,r){this.audioInput=e,this.videoInput=r}setAudioInput(e){var r=this;return K(function*(){U.info("MediaHandler setAudioInput() running (deviceId=".concat(e,")")),r.audioInput!==e&&(r.audioInput=e,yield r.updateLocalUsermediaStreams())})()}setAudioSettings(e){var r=this;return K(function*(){U.info("MediaHandler setAudioSettings() running (opts=".concat(JSON.stringify(e),")")),r.audioSettings=Object.assign({},e),yield r.updateLocalUsermediaStreams()})()}setVideoInput(e){var r=this;return K(function*(){U.info("MediaHandler setVideoInput() running (deviceId=".concat(e,")")),r.videoInput!==e&&(r.videoInput=e,yield r.updateLocalUsermediaStreams())})()}setMediaInputs(e,r){var n=this;return K(function*(){U.log("MediaHandler setMediaInputs() running (audioInput: ".concat(e," videoInput: ").concat(r,")")),n.audioInput=e,n.videoInput=r,yield n.updateLocalUsermediaStreams()})()}updateLocalUsermediaStreams(){var e=this;return K(function*(){if(e.userMediaStreams.length!==0){var r=new Map;for(var n of e.client.callEventHandler.calls.values())r.set(n.callId,{audio:n.hasLocalUserMediaAudioTrack,video:n.hasLocalUserMediaVideoTrack});for(var i of e.userMediaStreams){U.log("MediaHandler updateLocalUsermediaStreams() stopping all tracks (streamId=".concat(i.id,")"));for(var a of i.getTracks())a.stop()}e.userMediaStreams=[],e.localUserMediaStream=void 0;for(var o of e.client.callEventHandler.calls.values())if(!(o.callHasEnded()||!r.has(o.callId))){var{audio:s,video:l}=r.get(o.callId);U.log("MediaHandler updateLocalUsermediaStreams() calling getUserMediaStream() (callId=".concat(o.callId,")"));var c=yield e.getUserMediaStream(s,l);o.callHasEnded()||(yield o.updateLocalUsermediaStream(c))}for(var d of e.client.groupCallEventHandler.groupCalls.values())if(d.localCallFeed){U.log("MediaHandler updateLocalUsermediaStreams() calling getUserMediaStream() (groupCallId=".concat(d.groupCallId,")"));var h=yield e.getUserMediaStream(!0,d.type===e_.Video);d.state!==vr.Ended&&(yield d.updateLocalUsermediaStream(h))}e.emit(Zl.LocalStreamsChanged)}})()}hasAudioDevice(){return K(function*(){try{var e=yield navigator.mediaDevices.enumerateDevices();return e.filter(r=>r.kind==="audioinput").length>0}catch(r){return U.log("MediaHandler hasAudioDevice() calling navigator.mediaDevices.enumerateDevices with error",r),!1}})()}hasVideoDevice(){return K(function*(){try{var e=yield navigator.mediaDevices.enumerateDevices();return e.filter(r=>r.kind==="videoinput").length>0}catch(r){return U.log("MediaHandler hasVideoDevice() calling navigator.mediaDevices.enumerateDevices with error",r),!1}})()}getUserMediaStream(e,r){var n=arguments,i=this;return K(function*(){var a=n.length>2&&n[2]!==void 0?n[2]:!0;return i.getMediaStreamPromise?i.getMediaStreamPromise=i.getMediaStreamPromise.then(()=>i.getUserMediaStreamInternal(e,r,a)):i.getMediaStreamPromise=i.getUserMediaStreamInternal(e,r,a),i.getMediaStreamPromise})()}getUserMediaStreamInternal(e,r,n){var i=this;return K(function*(){var a=e&&(yield i.hasAudioDevice()),o=r&&(yield i.hasVideoDevice()),s,l=!0;if(i.localUserMediaStream){var c,d;a!==i.localUserMediaStream.getAudioTracks().length>0&&(l=!1),o!==i.localUserMediaStream.getVideoTracks().length>0&&(l=!1),a&&((c=i.localUserMediaStream.getAudioTracks()[0])===null||c===void 0||(c=c.getSettings())===null||c===void 0?void 0:c.deviceId)!==i.audioInput&&(l=!1),o&&((d=i.localUserMediaStream.getVideoTracks()[0])===null||d===void 0||(d=d.getSettings())===null||d===void 0?void 0:d.deviceId)!==i.videoInput&&(l=!1)}else l=!1;if(l){var g;if(s=i.localUserMediaStream.clone(),U.log("MediaHandler getUserMediaStreamInternal() cloning (oldStreamId=".concat((g=i.localUserMediaStream)===null||g===void 0?void 0:g.id," newStreamId=").concat(s.id," shouldRequestAudio=").concat(a," shouldRequestVideo=").concat(o,")")),!a)for(var y of s.getAudioTracks())s.removeTrack(y);if(!o)for(var R of s.getVideoTracks())s.removeTrack(R)}else{var h=i.getUserMediaContraints(a,o);s=yield navigator.mediaDevices.getUserMedia(h),U.log("MediaHandler getUserMediaStreamInternal() calling getUserMediaStream (streamId=".concat(s.id,", shouldRequestAudio=").concat(a,", shouldRequestVideo=").concat(o,", constraints=").concat(JSON.stringify(h),")"));for(var p of s.getTracks()){var m=p.getSettings();p.kind==="audio"?i.audioInput=m.deviceId:p.kind==="video"&&(i.videoInput=m.deviceId)}n&&(i.localUserMediaStream=s)}return n&&i.userMediaStreams.push(s),i.emit(Zl.LocalStreamsChanged),s})()}stopUserMediaStream(e){U.log("MediaHandler stopUserMediaStream() stopping (streamId=".concat(e.id,")"));for(var r of e.getTracks())r.stop();var n=this.userMediaStreams.indexOf(e);if(n!==-1&&(U.debug("MediaHandler stopUserMediaStream() splicing usermedia stream out stream array (streamId=".concat(e.id,")"),e.id),this.userMediaStreams.splice(n,1)),this.emit(Zl.LocalStreamsChanged),this.localUserMediaStream===e)this.localUserMediaStream=void 0;else for(var i of e.getTracks()){var a;if((a=this.localUserMediaStream)!==null&&a!==void 0&&a.getTrackById(i.id)){this.stopUserMediaStream(this.localUserMediaStream);break}}}getScreensharingStream(){var e=arguments,r=this;return K(function*(){var n=e.length>0&&e[0]!==void 0?e[0]:{},i=e.length>1&&e[1]!==void 0?e[1]:!0,a;if(r.screensharingStreams.length===0){var o=r.getScreenshareContraints(n);n.desktopCapturerSourceId?(U.debug("MediaHandler getScreensharingStream() calling getUserMedia() (opts=".concat(JSON.stringify(n),")")),a=yield navigator.mediaDevices.getUserMedia(o)):(U.debug("MediaHandler getScreensharingStream() calling getDisplayMedia() (opts=".concat(JSON.stringify(n),")")),a=yield navigator.mediaDevices.getDisplayMedia(o))}else{var s=r.screensharingStreams[r.screensharingStreams.length-1];U.log("MediaHandler getScreensharingStream() cloning (streamId=".concat(s.id,")")),a=s.clone()}return i&&r.screensharingStreams.push(a),r.emit(Zl.LocalStreamsChanged),a})()}stopScreensharingStream(e){U.debug("MediaHandler stopScreensharingStream() stopping stream (streamId=".concat(e.id,")"));for(var r of e.getTracks())r.stop();var n=this.screensharingStreams.indexOf(e);n!==-1&&(U.debug("MediaHandler stopScreensharingStream() splicing stream out (streamId=".concat(e.id,")")),this.screensharingStreams.splice(n,1)),this.emit(Zl.LocalStreamsChanged)}stopAllStreams(){for(var e of this.userMediaStreams){U.log("MediaHandler stopAllStreams() stopping (streamId=".concat(e.id,")"));for(var r of e.getTracks())r.stop()}for(var n of this.screensharingStreams)for(var i of n.getTracks())i.stop();this.userMediaStreams=[],this.screensharingStreams=[],this.localUserMediaStream=void 0,this.emit(Zl.LocalStreamsChanged)}getUserMediaContraints(e,r){var n=!!navigator.webkitGetUserMedia;return{audio:e?{deviceId:this.audioInput?{ideal:this.audioInput}:void 0,autoGainControl:this.audioSettings?{ideal:this.audioSettings.autoGainControl}:void 0,echoCancellation:this.audioSettings?{ideal:this.audioSettings.echoCancellation}:void 0,noiseSuppression:this.audioSettings?{ideal:this.audioSettings.noiseSuppression}:void 0}:!1,video:r?{deviceId:this.videoInput?{ideal:this.videoInput}:void 0,width:n?{exact:640}:{ideal:640},height:n?{exact:360}:{ideal:360}}:!1}}getScreenshareContraints(e){var{desktopCapturerSourceId:r,audio:n}=e;return r?{audio:n??!1,video:{mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:r}}}:{audio:n??!1,video:!0}}}var dk=function(t){return t.RequestFinished="FINISHED",t.Complete="COMPLETE",t}({}),nv=function(t){return t.PreProcess="ExtState.PreProcess",t.PostProcess="ExtState.PostProcess",t}({}),qx=function(t){return t.RoomData="SlidingSync.RoomData",t.Lifecycle="SlidingSync.Lifecycle",t}({}),eme=3;class tme{constructor(e){this.crypto=e}name(){return"e2ee"}when(){return nv.PreProcess}onRequest(e){var r=this;return K(function*(){return e&&(U.log("ExtensionE2EE: invalidating all device lists due to missing 'pos'"),yield r.crypto.markAllTrackedUsersAsDirty()),{enabled:!0}})()}onResponse(e){var r=this;return K(function*(){e.device_lists&&(yield r.crypto.processDeviceLists(e.device_lists)),yield r.crypto.processKeyCounts(e.device_one_time_keys_count,e.device_unused_fallback_key_types||e["org.matrix.msc2732.device_unused_fallback_key_types"]),r.crypto.onSyncCompleted({})})()}}class rme{constructor(e,r){this.client=e,this.cryptoCallbacks=r,E(this,"nextBatch",null)}name(){return"to_device"}when(){return nv.PreProcess}onRequest(e){var r=this;return K(function*(){return{since:r.nextBatch!==null?r.nextBatch:void 0,limit:100,enabled:!0}})()}onResponse(e){var r=this;return K(function*(){var n=[],i=e.events||[];i.length>0&&r.cryptoCallbacks&&(i=yield r.cryptoCallbacks.preprocessToDeviceMessages(i)),i.map(MV).map(a=>{if(a.getType()==="m.key.verification.cancel"){var o=a.getContent().transaction_id;o&&n.push(o)}return a}).forEach(a=>{var o=a.getContent();if(a.getType()=="m.room.message"&&o.msgtype=="m.bad.encrypted"){U.log("Ignoring undecryptable to-device event from "+a.getSender());return}if(a.getType()==="m.key.verification.start"||a.getType()==="m.key.verification.request"){var s=o.transaction_id;n.includes(s)&&a.flagCancelled()}r.client.emit(je.ToDeviceEvent,a)}),r.nextBatch=e.next_batch})()}}class nme{constructor(e){this.client=e}name(){return"account_data"}when(){return nv.PostProcess}onRequest(e){return K(function*(){return{enabled:!0}})()}onResponse(e){var r=this;return K(function*(){e.global&&e.global.length>0&&r.processGlobalAccountData(e.global);for(var n in e.rooms){var i=Cd(r.client,n,e.rooms[n]),a=r.client.getRoom(n);if(!a){U.warn("got account data for room but room doesn't exist on client:",n);continue}a.addAccountData(i),i.forEach(o=>{r.client.emit(je.Event,o)})}})()}processGlobalAccountData(e){var r=Cd(this.client,void 0,e),n=r.reduce((i,a)=>(i[a.getType()]=this.client.store.getAccountData(a.getType()),i),{});this.client.store.storeAccountDataEvents(r),r.forEach(i=>{if(i.getType()===ge.PushRules){var a=i.getContent();this.client.setPushRules(a)}var o=n[i.getType()];return this.client.emit(je.AccountData,i,o),i})}}class ime{constructor(e){this.client=e}name(){return"typing"}when(){return nv.PostProcess}onRequest(e){return K(function*(){return{enabled:!0}})()}onResponse(e){var r=this;return K(function*(){if(e!=null&&e.rooms)for(var n in e.rooms)jV(r.client,n,[e.rooms[n]])})()}}class ame{constructor(e){this.client=e}name(){return"receipts"}when(){return nv.PostProcess}onRequest(e){return K(function*(){return{enabled:!0}})()}onResponse(e){var r=this;return K(function*(){if(e!=null&&e.rooms)for(var n in e.rooms)jV(r.client,n,[e.rooms[n]])})()}}class FV{constructor(e,r,n,i){this.slidingSync=e,this.client=r,E(this,"opts",void 0),E(this,"syncOpts",void 0),E(this,"syncState",null),E(this,"syncStateData",void 0),E(this,"lastPos",null),E(this,"failCount",0),E(this,"notifEvents",[]),this.opts=TV(n),this.syncOpts=DV(i),r.getNotifTimelineSet()&&r.reEmitter.reEmit(r.getNotifTimelineSet(),[Ue.Timeline,Ue.TimelineReset]),this.slidingSync.on(qx.Lifecycle,this.onLifecycle.bind(this)),this.slidingSync.on(qx.RoomData,this.onRoomData.bind(this));var a=[new rme(this.client,this.syncOpts.cryptoCallbacks),new nme(this.client),new ime(this.client),new ame(this.client)];this.syncOpts.cryptoCallbacks&&a.push(new tme(this.syncOpts.cryptoCallbacks)),a.forEach(o=>{this.slidingSync.registerExtension(o)})}onRoomData(e,r){var n=this;return K(function*(){var i=n.client.store.getRoom(e);if(!i){if(!r.initial){U.debug("initial flag not set but no stored room exists for room ",e,r);return}i=RV(n.client,e,n.opts)}yield n.processRoomData(n.client,i,r)})()}onLifecycle(e,r,n){switch(n&&U.debug("onLifecycle",e,n),e){case dk.Complete:if(this.purgeNotifications(),!r)break;this.lastPos||this.updateSyncState(Lt.Prepared,{oldSyncToken:void 0,nextSyncToken:r.pos,catchingUp:!1,fromCache:!1}),this.updateSyncState(Lt.Syncing,{oldSyncToken:this.lastPos,nextSyncToken:r.pos,catchingUp:!1,fromCache:!1}),this.lastPos=r.pos;break;case dk.RequestFinished:if(n){if(this.failCount+=1,this.updateSyncState(this.failCount>eme?Lt.Error:Lt.Reconnecting,{error:new ur(n)}),this.shouldAbortSync(new ur(n)))return}else this.failCount=0,U.log("SlidingSyncState.RequestFinished with ".concat(Object.keys((r==null?void 0:r.rooms)||[]).length," rooms"));break}}syncLeftRooms(){return K(function*(){return[]})()}peek(e){return K(function*(){return null})()}stopPeeking(){}setPresence(e){}getSyncState(){return this.syncState}getSyncStateData(){var e;return(e=this.syncStateData)!==null&&e!==void 0?e:null}createRoom(e){var{timelineSupport:r}=this.client,n=new Xb(e,this.client,this.client.getUserId(),{lazyLoadMembers:this.opts.lazyLoadMembers,pendingEventOrdering:this.opts.pendingEventOrdering,timelineSupport:r});return this.client.reEmitter.reEmit(n,[Ue.Name,Ue.Redaction,Ue.RedactionCancelled,Ue.Receipt,Ue.Tags,Ue.LocalEchoUpdated,Ue.AccountData,Ue.MyMembership,Ue.Timeline,Ue.TimelineReset]),this.registerStateListeners(n),n}registerStateListeners(e){this.client.reEmitter.reEmit(e.currentState,[dt.Events,dt.Members,dt.NewMember,dt.Update]),e.currentState.on(dt.NewMember,(r,n,i)=>{var a;i.user=(a=this.client.getUser(i.userId))!==null&&a!==void 0?a:void 0,this.client.reEmitter.reEmit(i,[Xn.Name,Xn.Typing,Xn.PowerLevel,Xn.Membership])})}shouldAbortSync(e){return e.errcode==="M_UNKNOWN_TOKEN"?(U.warn("Token no longer valid - assuming logout"),this.stop(),this.updateSyncState(Lt.Error,{error:e}),!0):!1}processRoomData(e,r,n){var i=this;return K(function*(){n=ome(e,r.roomId,n);var a=Cd(i.client,r.roomId,n.required_state),o=Cd(i.client,r.roomId,n.timeline,!1),s=[];if(n.limited||n.initial){var l=new Set;r.getLiveTimeline().getEvents().forEach(_=>{l.add(_.getId())});for(var c=[],d=[],h=!1,p=o.length-1;p>=0;p--){var m=o[p];if(l.has(m.getId())){h=!0;continue}h?c.push(m):d.unshift(m)}o=d,c.length>0&&r.addEventsToTimeline(c,!0,!1,r.getLiveTimeline(),n.prev_batch)}var g=r.hasEncryptionStateEvent();if(n.notification_count!=null&&r.setUnreadNotificationCount(It.Total,n.notification_count),n.highlight_count!=null&&(!g||g&&r.getUnreadNotificationCount(It.Highlight)<=0)&&r.setUnreadNotificationCount(It.Highlight,n.highlight_count),n.bump_stamp&&r.setBumpStamp(n.bump_stamp),Number.isInteger(n.invited_count)&&r.currentState.setInvitedMemberCount(n.invited_count),Number.isInteger(n.joined_count)&&r.currentState.setJoinedMemberCount(n.joined_count),n.invite_state){var y=Cd(i.client,r.roomId,n.invite_state);yield i.injectRoomEvents(r,y),n.initial&&(r.recalculate(),i.client.store.storeRoom(r),i.client.emit(je.Room,r)),y.forEach(_=>{i.client.emit(je.Event,_)});return}if(n.limited){var R;r.getLiveTimeline().setPaginationToken((R=n.prev_batch)!==null&&R!==void 0?R:null,Be.BACKWARDS)}yield i.injectRoomEvents(r,a,o,n.num_live),r.addEphemeralEvents(s),r.updateMyMembership(ct.Join),r.setMSC4186SummaryData(n.heroes,n.joined_count,n.invited_count),r.recalculate(),n.initial&&(e.store.storeRoom(r),e.emit(je.Room,r)),i.addNotifications(o);var b=function(){var _=K(function*(x){e.emit(je.Event,x),x.isState()&&x.getType()==ge.RoomEncryption&&i.syncOpts.cryptoCallbacks&&(yield i.syncOpts.cryptoCallbacks.onCryptoEvent(r,x))});return function(T){return _.apply(this,arguments)}}();yield Xc(a,b),yield Xc(o,b),s.forEach(function(_){e.emit(je.Event,_)}),r.decryptCriticalEvents()})()}injectRoomEvents(e,r){var n=arguments,i=this;return K(function*(){var a=n.length>2&&n[2]!==void 0?n[2]:[],o=n.length>3&&n[3]!==void 0?n[3]:0,s=e.getLiveTimeline(),l=s.getEvents().length==0;if(l){for(var c of r)i.client.getPushActionsForEvent(c);s.initialiseState(r)}l||(e.oldState.setStateEvents(r),e.currentState.setStateEvents(r));var d=[];o>0&&(d=a.slice(-1*o),a=a.slice(0,-1*d.length)),yield e.addLiveEvents(a,{fromCache:!0,addToState:!1}),d.length>0&&(yield e.addLiveEvents(d,{fromCache:!1,addToState:!1})),e.recalculate(),i.resolveInvites(e)})()}resolveInvites(e){if(!(!e||!this.opts.resolveInvitesToProfiles)){var r=this.client;e.getMembersWithMembership(ct.Invite).forEach(function(n){if(!n.requestedProfileInfo){n.requestedProfileInfo=!0;var i=r.getUser(n.userId),a;i?a=Promise.resolve({avatar_url:i.avatarUrl,displayname:i.displayName}):a=r.getProfileInfo(n.userId),a.then(function(o){var s=n.events.member;s.getContent().membership===ct.Invite&&(s.getContent().avatar_url=o.avatar_url,s.getContent().displayname=o.displayname,n.setMembershipEvent(s,e.currentState))},function(o){})}})}}retryImmediately(){return!0}sync(){var e=this;return K(function*(){for(U.debug("Sliding sync init loop");!e.client.isGuest();)try{U.debug("Getting push rules...");var r=yield e.client.getPushRules();U.debug("Got push rules"),e.client.pushRules=r;break}catch(n){if(U.error("Getting push rules failed",n),e.shouldAbortSync(n))return}yield e.slidingSync.start()})()}stop(){U.debug("SyncApi.stop"),this.slidingSync.stop()}updateSyncState(e,r){var n=this.syncState;this.syncState=e,this.syncStateData=r,this.client.emit(je.Sync,this.syncState,n,r)}addNotifications(e){if(this.client.getNotifTimelineSet())for(var r of e){var n=this.client.getPushActionsForEvent(r);n&&n.notify&&n.tweaks&&n.tweaks.highlight&&this.notifEvents.push(r)}}purgeNotifications(){this.notifEvents.sort(function(e,r){return e.getTs()-r.getTs()}),this.notifEvents.forEach(e=>{var r;(r=this.client.getNotifTimelineSet())===null||r===void 0||r.addLiveEvent(e,{addToState:!1})}),this.notifEvents=[]}}function ome(t,e,r){if(!r.name)return r;for(var n of r.required_state)if(n.type===ge.RoomName&&n.state_key==="")return n.content={name:r.name},r;return r.required_state.push({event_id:"$fake-sliding-sync-name-event-"+e,state_key:"",type:ge.RoomName,content:{name:r.name},sender:t.getUserId(),origin_server_ts:new Date().getTime()}),r}function Cd(t,e,r){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,i=t.getEventMapper({decrypt:n});return r.map(function(a){return a.room_id=e,i(a)})}function jV(t,e,r){var n=Cd(t,e,r),i=t.getRoom(e);if(!i){U.warn("got ephemeral events for room but room doesn't exist on client:",e);return}i.addEphemeralEvents(n),n.forEach(a=>{t.emit(je.Event,a)})}var l3=new Rr("m.beacon_info","org.matrix.msc3672.beacon_info"),Zx=new Rr("m.beacon","org.matrix.msc3672.beacon");class nf{static RETRY_BACKOFF_RATELIMIT(e,r,n){return _V(n,r,!1)}static QUEUE_MESSAGES(e){return e.getType()===ge.RoomMessage||e.hasAssociation()?"message":null}constructor(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:nf.RETRY_BACKOFF_RATELIMIT,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:nf.QUEUE_MESSAGES;this.retryAlgorithm=e,this.queueAlgorithm=r,E(this,"queues",{}),E(this,"activeQueues",[]),E(this,"procFn",null),E(this,"processQueue",n=>{var i=this.peekNextEvent(n);if(!i){this.disableQueue(n);return}this.queues[n].length,Promise.resolve().then(()=>this.procFn(i.event)).then(a=>{this.removeNextEvent(n),i.event.getId(),i.defer.resolve(a),this.processQueue(n)},a=>{i.attempts+=1;var o=this.retryAlgorithm(i.event,i.attempts,a);i.attempts,i.event.getId(),o===-1?(U.info("Queue '%s' giving up on event %s",n,i.event.getId()),this.clearQueue(n,a)):setTimeout(this.processQueue,o,n)})})}getQueueForEvent(e){var r=this.queueAlgorithm(e);return!r||!this.queues[r]?null:this.queues[r].map(function(n){return n.event})}removeEventFromQueue(e){var r=this.queueAlgorithm(e);if(!r||!this.queues[r])return!1;var n=!1;return E0(this.queues[r],i=>i.event.getId()===e.getId()?(n=!0,!0):!1),n}setProcessFunction(e){this.procFn=e,this.startProcessingQueues()}queueEvent(e){var r=this.queueAlgorithm(e);if(!r)return null;this.queues[r]||(this.queues[r]=[]);var n=ml();return this.queues[r].push({event:e,defer:n,attempts:0}),e.getId(),this.startProcessingQueues(),n.promise}startProcessingQueues(){this.procFn&&Object.keys(this.queues).filter(e=>this.activeQueues.indexOf(e)===-1&&this.queues[e].length>0).forEach(e=>{this.activeQueues.push(e),this.processQueue(e)})}disableQueue(e){var r=this.activeQueues.indexOf(e);r>=0&&this.activeQueues.splice(r,1),U.info("Stopping queue '%s' as it is now empty",e)}clearQueue(e,r){U.info("clearing queue '%s'",e);for(var n;n=this.removeNextEvent(e);)n.defer.reject(r);this.disableQueue(e)}peekNextEvent(e){var r=this.queues[e];if(Array.isArray(r))return r[0]}removeNextEvent(e){var r=this.queues[e];if(Array.isArray(r))return r.shift()}}var fk=20;class sme{constructor(e){var r=this;this.client=e,E(this,"sending",!1),E(this,"running",!0),E(this,"retryTimeout",null),E(this,"retryAttempts",0),E(this,"sendQueue",K(function*(){if(r.retryTimeout!==null&&clearTimeout(r.retryTimeout),r.retryTimeout=null,!(r.sending||!r.running)){U.debug("Attempting to send queued to-device messages"),r.sending=!0;var n;try{for(;r.running&&(n=yield r.client.store.getOldestToDeviceBatch(),n!==null);)yield r.sendBatch(n),yield r.client.store.removeToDeviceBatch(n.id),r.retryAttempts=0;if(!r.running)return;U.debug("All queued to-device messages sent")}catch(a){++r.retryAttempts;var i=nf.RETRY_BACKOFF_RATELIMIT(null,r.retryAttempts,a);if(i===-1){Math.floor(a.httpStatus/100)===4?(U.error("Fatal error when sending to-device message - dropping to-device batch!",a),yield r.client.store.removeToDeviceBatch(n.id)):U.info("Automatic retry limit reached for to-device messages.");return}U.info("Failed to send batch of to-device messages. Will retry in ".concat(i,"ms"),a),r.retryTimeout=setTimeout(r.sendQueue,i)}finally{r.sending=!1}}})),E(this,"onResumedSync",(n,i)=>{n===Lt.Syncing&&i!==Lt.Syncing&&(U.info("Resuming queue after resumed sync"),this.sendQueue())})}start(){this.running=!0,this.sendQueue(),this.client.on(je.Sync,this.onResumedSync)}stop(){this.running=!1,this.retryTimeout!==null&&clearTimeout(this.retryTimeout),this.retryTimeout=null,this.client.removeListener(je.Sync,this.onResumedSync)}queueBatch(e){var r=this;return K(function*(){for(var n=[],i=0;i<e.batch.length;i+=fk){var a={eventType:e.eventType,batch:e.batch.slice(i,i+fk),txnId:r.client.makeTxnId()};n.push(a);var o=a.batch.map(s=>"".concat(s.userId,"/").concat(s.deviceId," (msgid ").concat(s.payload[Gb],")"));U.info("Enqueuing batch of to-device messages. type=".concat(e.eventType," txnid=").concat(a.txnId),o)}yield r.client.store.saveToDeviceBatches(n),r.sendQueue()})()}sendBatch(e){var r=this;return K(function*(){var n=new qo(()=>new Map);for(var i of e.batch)n.getOrCreate(i.userId).set(i.deviceId,i.payload);U.info("Sending batch of ".concat(e.batch.length," to-device messages with ID ").concat(e.id," and txnId ").concat(e.txnId)),yield r.client.sendToDevice(e.eventType,n,e.txnId)})()}}var Pw=new Fn.UnstableValue("m.policies","org.matrix.msc3847.policies"),bg=new Fn.UnstableValue("m.ignore.invites","org.matrix.msc3847.ignore.invites"),hk=function(t){return t.Ban="m.ban",t}({}),Td=function(t){return t.User="m.policy.user",t.Room="m.policy.room",t.Server="m.policy.server",t}({}),pk={[Td.User]:ge.PolicyRuleUser,[Td.Room]:ge.PolicyRuleRoom,[Td.Server]:ge.PolicyRuleServer};class lme{constructor(e){this.client=e}addRule(e,r,n){var i=this;return K(function*(){var a=yield i.getOrCreateTargetRoom(),o=yield i.client.sendStateEvent(a.roomId,pk[e],{entity:r,reason:n,recommendation:hk.Ban});return o.event_id})()}removeRule(e){var r=this;return K(function*(){yield r.client.redactEvent(e.getRoomId(),e.getId())})()}addSource(e){var r=this;return K(function*(){yield r.client.joinRoom(e);var n=(yield r.getOrCreateSourceRooms()).map(i=>i.roomId);return n.includes(e)?!1:(n.push(e),yield r.withIgnoreInvitesPolicies(i=>{i.sources=n}),!0)})()}getRuleForInvite(e){var r=this;return K(function*(){var{sender:n,roomId:i}=e,a=yield r.getOrCreateSourceRooms(),o=n.split(":")[1],s=i.split(":")[1];for(var l of a){var c=l.getUnfilteredTimelineSet().getLiveTimeline().getState(Be.FORWARDS);for(var{scope:d,entities:h}of[{scope:Td.Room,entities:[i]},{scope:Td.User,entities:[n]},{scope:Td.Server,entities:[o,s]}]){var p=c.getStateEvents(pk[d]);for(var m of p){var g=m.getContent();if((g==null?void 0:g.recommendation)==hk.Ban){var y=g==null?void 0:g.entity;if(y){var R=void 0;try{R=new RegExp(bj(y))}catch{continue}for(var b of h)if(b&&R.test(b))return m}}}}}return null})()}getOrCreateTargetRoom(){var e=this;return K(function*(){var r=e.getIgnoreInvitesPolicies(),n=r.target;if(typeof n!="string"&&(n=null),n){var i=e.client.getRoom(n);if(i)return i;n=null}return n=(yield e.client.createRoom({name:"Individual Policy Room",preset:o3.PrivateChat})).room_id,yield e.withIgnoreInvitesPolicies(a=>{a.target=n}),e.client.getRoom(n)})()}getOrCreateSourceRooms(){var e=this;return K(function*(){var r=e.getIgnoreInvitesPolicies(),n=r.sources,i=!1;Array.isArray(n)||(i=!0,n=[]);var a=n.filter(s=>typeof s=="string").map(s=>e.client.getRoom(s)).filter(s=>!!s);if(a.length!=n.length&&(i=!0),a.length==0){var o=yield e.getOrCreateTargetRoom();i=!0,a=[o]}return i&&(yield e.withIgnoreInvitesPolicies(s=>{s.sources=n})),a})()}getIgnoreInvitesPolicies(){return this.getPoliciesAndIgnoreInvitesPolicies().ignoreInvitesPolicies}withIgnoreInvitesPolicies(e){var r=this;return K(function*(){var{policies:n,ignoreInvitesPolicies:i}=r.getPoliciesAndIgnoreInvitesPolicies();e(i),n[bg.name]=i,yield r.client.setAccountData(Pw.name,n)})()}getPoliciesAndIgnoreInvitesPolicies(){var e={};for(var r of[Pw.name,Pw.altName]){var n;if(r){var i=(n=this.client.getAccountData(r))===null||n===void 0?void 0:n.getContent();if(i){e=i;break}}}var a={},o=!1;for(var s of[bg.name,bg.altName])if(s){var l=e[s];if(l&&typeof l=="object"){a=l,o=!0;break}}return o||(e[bg.name]=a),{policies:e,ignoreInvitesPolicies:a}}}var Aw="matrix-js-sdk";function ume(t){if(t.length>=255)throw new TypeError("Alphabet too long");const e=new Uint8Array(256);for(let c=0;c<e.length;c++)e[c]=255;for(let c=0;c<t.length;c++){const d=t.charAt(c),h=d.charCodeAt(0);if(e[h]!==255)throw new TypeError(d+" is ambiguous");e[h]=c}const r=t.length,n=t.charAt(0),i=Math.log(r)/Math.log(256),a=Math.log(256)/Math.log(r);function o(c){if(c instanceof Uint8Array||(ArrayBuffer.isView(c)?c=new Uint8Array(c.buffer,c.byteOffset,c.byteLength):Array.isArray(c)&&(c=Uint8Array.from(c))),!(c instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(c.length===0)return"";let d=0,h=0,p=0;const m=c.length;for(;p!==m&&c[p]===0;)p++,d++;const g=(m-p)*a+1>>>0,y=new Uint8Array(g);for(;p!==m;){let _=c[p],x=0;for(let T=g-1;(_!==0||x<h)&&T!==-1;T--,x++)_+=256*y[T]>>>0,y[T]=_%r>>>0,_=_/r>>>0;if(_!==0)throw new Error("Non-zero carry");h=x,p++}let R=g-h;for(;R!==g&&y[R]===0;)R++;let b=n.repeat(d);for(;R<g;++R)b+=t.charAt(y[R]);return b}function s(c){if(typeof c!="string")throw new TypeError("Expected String");if(c.length===0)return new Uint8Array;let d=0,h=0,p=0;for(;c[d]===n;)h++,d++;const m=(c.length-d)*i+1>>>0,g=new Uint8Array(m);for(;d<c.length;){const _=c.charCodeAt(d);if(_>255)return;let x=e[_];if(x===255)return;let T=0;for(let I=m-1;(x!==0||T<p)&&I!==-1;I--,T++)x+=r*g[I]>>>0,g[I]=x%256>>>0,x=x/256>>>0;if(x!==0)throw new Error("Non-zero carry");p=T,d++}let y=m-p;for(;y!==m&&g[y]===0;)y++;const R=new Uint8Array(h+(m-y));let b=h;for(;y!==m;)R[b++]=g[y++];return R}function l(c){const d=s(c);if(d)return d;throw new Error("Non-base"+r+" character")}return{encode:o,decodeUnsafe:s,decode:l}}var cme="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";const Eye=ume(cme);var Yr=function(t){return t.UserTrustStatusChanged="userTrustStatusChanged",t.KeyBackupStatus="crypto.keyBackupStatus",t.KeyBackupFailed="crypto.keyBackupFailed",t.KeyBackupSessionsRemaining="crypto.keyBackupSessionsRemaining",t.KeyBackupDecryptionKeyCached="crypto.keyBackupDecryptionKeyCached",t.VerificationRequestReceived="crypto.verificationRequestReceived",t.WillUpdateDevices="crypto.willUpdateDevices",t.DevicesUpdated="crypto.devicesUpdated",t.KeysChanged="crossSigning.keysChanged",t.LegacyCryptoStoreMigrationProgress="crypto.legacyCryptoStoreMigrationProgress",t.DehydratedDeviceCreated="dehydration.DehydratedDeviceCreated",t.DehydratedDeviceUploaded="dehydration.DehydratedDeviceUploaded",t.RehydrationStarted="dehydration.RehydrationStarted",t.RehydrationProgress="dehydration.RehydrationProgress",t.RehydrationCompleted="dehydration.RehydrationCompleted",t.RehydrationError="dehydration.RehydrationError",t.DehydrationKeyCached="dehydration.DehydrationKeyCached",t.DehydratedDeviceRotationError="dehydration.DehydratedDeviceRotationError",t}({}),mk=function(t){return t.MEGOLM_UNKNOWN_INBOUND_SESSION_ID="MEGOLM_UNKNOWN_INBOUND_SESSION_ID",t.MEGOLM_KEY_WITHHELD="MEGOLM_KEY_WITHHELD",t.MEGOLM_KEY_WITHHELD_FOR_UNVERIFIED_DEVICE="MEGOLM_KEY_WITHHELD_FOR_UNVERIFIED_DEVICE",t.OLM_UNKNOWN_MESSAGE_INDEX="OLM_UNKNOWN_MESSAGE_INDEX",t.HISTORICAL_MESSAGE_NO_KEY_BACKUP="HISTORICAL_MESSAGE_NO_KEY_BACKUP",t.HISTORICAL_MESSAGE_BACKUP_UNCONFIGURED="HISTORICAL_MESSAGE_BACKUP_UNCONFIGURED",t.HISTORICAL_MESSAGE_WORKING_BACKUP="HISTORICAL_MESSAGE_WORKING_BACKUP",t.HISTORICAL_MESSAGE_USER_NOT_JOINED="HISTORICAL_MESSAGE_USER_NOT_JOINED",t.SENDER_IDENTITY_PREVIOUSLY_VERIFIED="SENDER_IDENTITY_PREVIOUSLY_VERIFIED",t.UNSIGNED_SENDER_DEVICE="UNSIGNED_SENDER_DEVICE",t.UNKNOWN_SENDER_DEVICE="UNKNOWN_SENDER_DEVICE",t.UNKNOWN_ERROR="UNKNOWN_ERROR",t.MEGOLM_BAD_ROOM="MEGOLM_BAD_ROOM",t.MEGOLM_MISSING_FIELDS="MEGOLM_MISSING_FIELDS",t.OLM_DECRYPT_GROUP_MESSAGE_ERROR="OLM_DECRYPT_GROUP_MESSAGE_ERROR",t.OLM_BAD_ENCRYPTED_MESSAGE="OLM_BAD_ENCRYPTED_MESSAGE",t.OLM_BAD_RECIPIENT="OLM_BAD_RECIPIENT",t.OLM_BAD_RECIPIENT_KEY="OLM_BAD_RECIPIENT_KEY",t.OLM_BAD_ROOM="OLM_BAD_ROOM",t.OLM_BAD_SENDER_CHECK_FAILED="OLM_BAD_SENDER_CHECK_FAILED",t.OLM_BAD_SENDER="OLM_BAD_SENDER",t.OLM_FORWARDED_MESSAGE="OLM_FORWARDED_MESSAGE",t.OLM_MISSING_CIPHERTEXT="OLM_MISSING_CIPHERTEXT",t.OLM_NOT_INCLUDED_IN_RECIPIENTS="OLM_NOT_INCLUDED_IN_RECIPIENTS",t.UNKNOWN_ENCRYPTION_ALGORITHM="UNKNOWN_ENCRYPTION_ALGORITHM",t}({}),dme=function(t){return t[t.AllDevicesIsolationMode=0]="AllDevicesIsolationMode",t[t.OnlySignedDevicesIsolationMode=1]="OnlySignedDevicesIsolationMode",t}({});class xye{constructor(e){this.errorOnVerifiedUserProblems=e,E(this,"kind",dme.AllDevicesIsolationMode)}}class Cye{constructor(e,r,n){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;this.crossSigningVerified=e,this.crossSigningVerifiedBefore=r,this.tofu=n,E(this,"needsUserApproval",void 0),this.needsUserApproval=i}isVerified(){return this.isCrossSigningVerified()}isCrossSigningVerified(){return this.crossSigningVerified}wasCrossSigningVerified(){return this.crossSigningVerifiedBefore}isTofu(){return this.tofu}}class Tye{constructor(e){var r,n,i,a,o;E(this,"signedByOwner",void 0),E(this,"crossSigningVerified",void 0),E(this,"tofu",void 0),E(this,"localVerified",void 0),E(this,"trustCrossSignedDevices",void 0),this.signedByOwner=(r=e.signedByOwner)!==null&&r!==void 0?r:!1,this.crossSigningVerified=(n=e.crossSigningVerified)!==null&&n!==void 0?n:!1,this.tofu=(i=e.tofu)!==null&&i!==void 0?i:!1,this.localVerified=(a=e.localVerified)!==null&&a!==void 0?a:!1,this.trustCrossSignedDevices=(o=e.trustCrossSignedDevices)!==null&&o!==void 0?o:!1}isVerified(){return this.localVerified||this.trustCrossSignedDevices&&this.crossSigningVerified}}var Dye=function(t){return t.Fetch="fetch",t.LoadKeys="load_keys",t}({}),Rye=function(t){return t.Master="master",t.SelfSigning="self_signing",t.UserSigning="user_signing",t}({}),Mye=function(t){return t[t.NONE=0]="NONE",t[t.GREY=1]="GREY",t[t.RED=2]="RED",t}({}),Iye=function(t){return t[t.UNKNOWN=0]="UNKNOWN",t[t.UNVERIFIED_IDENTITY=1]="UNVERIFIED_IDENTITY",t[t.UNSIGNED_DEVICE=2]="UNSIGNED_DEVICE",t[t.UNKNOWN_DEVICE=3]="UNKNOWN_DEVICE",t[t.AUTHENTICITY_NOT_GUARANTEED=4]="AUTHENTICITY_NOT_GUARANTEED",t[t.MISMATCHED_SENDER_KEY=5]="MISMATCHED_SENDER_KEY",t[t.SENT_IN_CLEAR=6]="SENT_IN_CLEAR",t[t.VERIFICATION_VIOLATION=7]="VERIFICATION_VIOLATION",t}({}),fme=new Uint8Array(8);function VV(t,e){return Yx.apply(this,arguments)}function Yx(){return Yx=K(function*(t,e){var r=yield globalThis.crypto.subtle.importKey("raw",t,{name:"HKDF"},!1,["deriveBits"]),n=yield globalThis.crypto.subtle.deriveBits({name:"HKDF",salt:fme,info:new TextEncoder().encode(e),hash:"SHA-256"},r,512),i=n.slice(0,32),a=n.slice(32),o=globalThis.crypto.subtle.importKey("raw",i,{name:"AES-CTR"},!1,["encrypt","decrypt"]),s=globalThis.crypto.subtle.importKey("raw",a,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign","verify"]);return Promise.all([o,s])}),Yx.apply(this,arguments)}function zV(t,e,r,n){return Jx.apply(this,arguments)}function Jx(){return Jx=K(function*(t,e,r,n){var i;n?i=xd(n):(i=new Uint8Array(16),globalThis.crypto.getRandomValues(i),i[8]&=127);var[a,o]=yield VV(e,r),s=new TextEncoder().encode(t),l=yield globalThis.crypto.subtle.encrypt({name:"AES-CTR",counter:i,length:64},a,s),c=yield globalThis.crypto.subtle.sign({name:"HMAC"},o,l);return{iv:ny(i),ciphertext:ny(new Uint8Array(l)),mac:ny(new Uint8Array(c))}}),Jx.apply(this,arguments)}function hme(t,e,r){return Xx.apply(this,arguments)}function Xx(){return Xx=K(function*(t,e,r){var[n,i]=yield VV(e,r),a=xd(t.ciphertext);if(!(yield globalThis.crypto.subtle.verify({name:"HMAC"},i,xd(t.mac),a)))throw new Error("Error decrypting secret ".concat(r,": bad MAC"));var o=yield globalThis.crypto.subtle.decrypt({name:"AES-CTR",counter:xd(t.iv),length:64},n,a);return new TextDecoder().decode(new Uint8Array(o))}),Xx.apply(this,arguments)}var Yl="m.secret_storage.v1.aes-hmac-sha2";class KV{constructor(e,r){this.accountDataAdapter=e,this.callbacks=r}getDefaultKeyId(){var e=this;return K(function*(){var r,n=yield e.accountDataAdapter.getAccountDataFromServer("m.secret_storage.default_key");return n&&(r=n.key)!==null&&r!==void 0?r:null})()}setDefaultKeyId(e){return new Promise((r,n)=>{var i=o=>{if(o.getType()==="m.secret_storage.default_key"){var s=o.getContent(),l=e===null?Object.keys(s).length===0:s.key===e;l&&(this.accountDataAdapter.removeListener(je.AccountData,i),r())}};this.accountDataAdapter.on(je.AccountData,i);var a=e===null?{}:{key:e};this.accountDataAdapter.setAccountData("m.secret_storage.default_key",a).catch(o=>{this.accountDataAdapter.removeListener(je.AccountData,i),n(o)})})}addKey(e,r,n){var i=this;return K(function*(){if(e!==Yl)throw new Error("Unknown key algorithm ".concat(e));var a={algorithm:e};r.name&&(a.name=r.name),r.passphrase&&(a.passphrase=r.passphrase);var{iv:o,mac:s}=yield eC(r.key);if(a.iv=o,a.mac=s,!n)do n=al(32);while(yield i.accountDataAdapter.getAccountDataFromServer("m.secret_storage.key.".concat(n)));return yield i.accountDataAdapter.setAccountData("m.secret_storage.key.".concat(n),a),{keyId:n,keyInfo:a}})()}getKey(e){var r=this;return K(function*(){if(e||(e=yield r.getDefaultKeyId()),!e)return null;var n=yield r.accountDataAdapter.getAccountDataFromServer("m.secret_storage.key.".concat(e));return n?[e,n]:null})()}hasKey(e){var r=this;return K(function*(){var n=yield r.getKey(e);return!!n})()}checkKey(e,r){return K(function*(){if(r.algorithm===Yl)if(r.mac){var{mac:n}=yield eC(e,r.iv);return Qx(r.mac)===Qx(n)}else return!0;else throw new Error("Unknown algorithm")})()}store(e,r,n){var i=this;return K(function*(){if(r===null){yield i.accountDataAdapter.setAccountData(e,{});return}var a={};if(!n){var o=yield i.getDefaultKeyId();if(!o)throw new Error("No keys specified and no default key present");n=[o]}if(n.length===0)throw new Error("Zero keys given to encrypt with!");for(var s of n){var l=yield i.accountDataAdapter.getAccountDataFromServer("m.secret_storage.key.".concat(s));if(!l)throw new Error("Unknown key: "+s);if(l.algorithm===Yl){var c={[s]:l},[,d]=yield i.getSecretStorageKey(c,e);a[s]=yield d.encrypt(r)}else U.warn("unknown algorithm for secret storage key "+s+": "+l.algorithm)}yield i.accountDataAdapter.setAccountData(e,{encrypted:a})})()}get(e){var r=this;return K(function*(){var n=yield r.accountDataAdapter.getAccountDataFromServer(e);if(n){if(!n.encrypted)throw new Error("Content is not encrypted!");var i={};for(var a of Object.keys(n.encrypted)){var o=yield r.accountDataAdapter.getAccountDataFromServer("m.secret_storage.key.".concat(a)),s=n.encrypted[a];(o==null?void 0:o.algorithm)===Yl&&s.iv&&s.ciphertext&&s.mac&&(i[a]=o)}if(Object.keys(i).length===0)throw new Error("Could not decrypt ".concat(e," because none of ")+"the keys it is encrypted with are for a supported algorithm");var[l,c]=yield r.getSecretStorageKey(i,e),d=n.encrypted[l];return c.decrypt(d)}})()}isStored(e){var r=this;return K(function*(){var n=yield r.accountDataAdapter.getAccountDataFromServer(e);if(!(n!=null&&n.encrypted))return null;var i={};for(var a of Object.keys(n.encrypted)){var o=yield r.accountDataAdapter.getAccountDataFromServer("m.secret_storage.key.".concat(a));if(o){var s=n.encrypted[a];o.algorithm===Yl&&s.iv&&s.ciphertext&&s.mac&&(i[a]=o)}}return Object.keys(i).length?i:null})()}getSecretStorageKey(e,r){var n=this;return K(function*(){if(!n.callbacks.getSecretStorageKey)throw new Error("No getSecretStorageKey callback supplied");var i=yield n.callbacks.getSecretStorageKey({keys:e},r);if(!i)throw new Error("getSecretStorageKey callback returned falsey");if(i.length<2)throw new Error("getSecretStorageKey callback returned invalid data");var[a,o]=i;if(!e[a])throw new Error("App returned unknown key from getSecretStorageKey!");if(e[a].algorithm===Yl){var s={encrypt:function(c){return zV(c,o,r)},decrypt:function(c){return hme(c,o,r)}};return[a,s]}else throw new Error("Unknown key type: "+e[a].algorithm)})()}}function Qx(t){for(var e=t.length;e>=1&&t.charCodeAt(e-1)==61;)e--;return e<t.length?t.substring(0,e):t}var pme="\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0";function eC(t,e){return zV(pme,t,"",e)}const mme=Object.freeze(Object.defineProperty({__proto__:null,SECRET_STORAGE_ALGORITHM_V1_AES:Yl,ServerSideSecretStorageImpl:KV,calculateKeyCheck:eC,trimTrailingEquals:Qx},Symbol.toStringTag,{value:"Module"}));var u3=t=>t.type==="livekit"&&"focus_selection"in t,c3=1e3*60*60*4,vme=(t,e)=>{var r,n="Malformed session membership event: ";return typeof t.device_id!="string"&&e.push(n+"device_id must be string"),typeof t.call_id!="string"&&e.push(n+"call_id must be string"),typeof t.application!="string"&&e.push(n+"application must be a string"),typeof((r=t.focus_active)===null||r===void 0?void 0:r.type)!="string"&&e.push(n+"focus_active.type must be a string"),Array.isArray(t.foci_preferred)||e.push(n+"foci_preferred must be an array"),t.created_ts&&typeof t.created_ts!="number"&&e.push(n+"created_ts must be number"),t.scope&&typeof t.scope!="string"&&e.push(n+"scope must be string"),e.length===0};class vk{static equal(e,r){return ef(e.membershipData,r.membershipData)}constructor(e,r){this.parentEvent=e,E(this,"membershipData",void 0);var n=[];if(vme(r,n))this.membershipData=r;else throw Error("unknown CallMembership data. Does not match MSC4143 call.member (".concat(n.join(" & "),") events this could be a legacy membership event: (").concat(r,")"))}get sender(){return this.parentEvent.getSender()}get eventId(){return this.parentEvent.getId()}get callId(){return this.membershipData.call_id}get deviceId(){return this.membershipData.device_id}get application(){return this.membershipData.application}get scope(){return this.membershipData.scope}get membershipID(){return this.createdTs().toString()}createdTs(){var e;return(e=this.membershipData.created_ts)!==null&&e!==void 0?e:this.parentEvent.getTs()}getAbsoluteExpiry(){var e;return this.createdTs()+((e=this.membershipData.expires)!==null&&e!==void 0?e:c3)}getMsUntilExpiry(){return this.getAbsoluteExpiry()-Date.now()}isExpired(){return this.getMsUntilExpiry()<=0}getPreferredFoci(){return this.membershipData.foci_preferred}getFocusSelection(){var e=this.membershipData.focus_active;if(u3(e))return e.focus_selection}}var Su=function(t){return t.Cancel="cancel",t.Restart="restart",t.Send="send",t}({}),d3=function(t){return t.TooNew="TOO_NEW",t}({});class f3 extends Error{constructor(e){var r="Crypto store is invalid because ".concat(e,", ")+"please stop the client, delete all data and start the client again";super(r),this.reason=e,this.name="InvalidCryptoStoreError"}}E(f3,"TOO_NEW",d3.TooNew);class gme extends Error{constructor(e,r){super(e),this.value=r}}class yme extends Error{constructor(){super("MatrixClient has been stopped")}}class Gs extends Error{constructor(e,r){super(e),this.clientEndpoint=r,this.name="UnsupportedDelayedEventsEndpointError"}}var Ts=function(t){return t.Disconnected="Disconnected",t.Connecting="Connecting",t.ConnectingFailed="ConnectingFailed",t.Connected="Connected",t.Reconnecting="Reconnecting",t.Disconnecting="Disconnecting",t.Stuck="Stuck",t.Unknown="Unknown",t}({}),iy=(t,e,r)=>t.sender===e&&t.deviceId===r;class bme{constructor(e,r){this.membershipLoopHandler=e,E(this,"logger",void 0),E(this,"running",!1),E(this,"wakeup",n=>{this.logger.error("Cannot call wakeup before calling `startWithJoin()`")}),E(this,"_actions",[]),this.logger=(r??U).getChild("[NewMembershipActionScheduler]")}get actions(){return this._actions}startWithJoin(){var e=this;return K(function*(){if(e.running){e.logger.error("Cannot call startWithJoin() on NewMembershipActionScheduler while already running");return}e.running=!0,e._actions=[{ts:Date.now(),type:et.SendDelayedEvent}];try{for(var r=function*(){e._actions.sort((c,d)=>c.ts-d.ts);var i=e._actions[0],a=void 0,o=new Promise(c=>{e.wakeup=d=>{a=d,c()}});i.ts>Date.now()&&(yield Promise.race([o,$u(i.ts-Date.now())]));var s={};if(!a){e.logger.debug("Current MembershipManager processing: ".concat(i.type,`
Queue:`),e._actions,`
Date.now: "`.concat(Date.now()));try{s=yield e.membershipLoopHandler(i.type)}catch(c){throw Error("The MembershipManager shut down because of the end condition: ".concat(c))}}e._actions.splice(0,1);var l=a??s;"replace"in l?e._actions=l.replace:"insert"in l&&e._actions.push(...l.insert)};e._actions.length>0;)yield*r()}finally{e.running=!1}e.logger.debug("Leave MembershipManager ActionScheduler loop (no more actions)")})()}initiateJoin(){var e;(e=this.wakeup)===null||e===void 0||e.call(this,{replace:[{ts:Date.now(),type:et.SendDelayedEvent}]})}initiateLeave(){var e;(e=this.wakeup)===null||e===void 0||e.call(this,{replace:[{ts:Date.now(),type:et.SendScheduledDelayedLeaveEvent}]})}}var gk=function(t){return t.StatusChanged="StatusChanged",t}({}),et=function(t){return t.SendDelayedEvent="SendDelayedEvent",t.SendJoinEvent="SendJoinEvent",t.RestartDelayedEvent="RestartDelayedEvent",t.UpdateExpiry="UpdateExpiry",t.SendScheduledDelayedLeaveEvent="SendScheduledDelayedLeaveEvent",t.SendLeaveEvent="SendLeaveEvent",t}({});class N0 extends nr{isActivated(){return this.activated}isJoined(){return this.isActivated()}join(e,r,n){if(this.scheduler.running){this.logger.error("MembershipManager is already running. Ignoring join request.");return}this.fociPreferred=e,this.focusActive=r,this.leavePromiseDefer=void 0,this.activated=!0,this.oldStatus=this.status,this.state=N0.defaultState,this.scheduler.startWithJoin().catch(i=>{this.logger.error("MembershipManager stopped because: ",i),n==null||n(i)}).finally(()=>{if(this.activated=!1,this.oldStatus&&this.oldStatus!==this.status&&this.emit(gk.StatusChanged,this.oldStatus,this.status),!this.scheduler.running){var i;(i=this.leavePromiseDefer)===null||i===void 0||i.resolve(!0),this.leavePromiseDefer=void 0}})}leave(e){return this.scheduler.running?(this.leavePromiseDefer||(this.leavePromiseDefer=ml(),this.activated=!1,this.scheduler.initiateLeave(),e&&setTimeout(()=>{var r;return(r=this.leavePromiseDefer)===null||r===void 0?void 0:r.resolve(!1)},e)),this.leavePromiseDefer.promise):(this.logger.warn("Called MembershipManager.leave() even though the MembershipManager is not running"),Promise.resolve(!0))}onRTCSessionMemberUpdate(e){var r=this;return K(function*(){var n=r.client.getUserId(),i=r.client.getDeviceId();if(n&&i&&r.isJoined()&&!e.some(o=>iy(o,n,i))){var a=[et.SendDelayedEvent,et.SendJoinEvent];r.logger.warn("Missing own membership: force re-join"),r.scheduler.actions.find(o=>a.includes(o.type))?r.logger.error("NewMembershipManger tried adding another `SendFirstDelayedEvent` actions even though we already have one in the Queue\nActionQueueOnMemberUpdate:",r.scheduler.actions):(r.state.hasMemberStateEvent=!1,r.scheduler.initiateJoin())}return Promise.resolve()})()}getActiveFocus(){if(this.focusActive)if(u3(this.focusActive)){if(this.focusActive.focus_selection==="oldest_membership"){var e=this.getOldestMembership();return e==null?void 0:e.getPreferredFoci()[0]}}else this.logger.warn("Unknown own ActiveFocus type. This makes it impossible to connect to an SFU.");else{var r=this.getOldestMembership();return r==null?void 0:r.getPreferredFoci()[0]}}constructor(e,r,n,i,a){super(),this.joinConfig=e,this.room=r,this.client=n,this.getOldestMembership=i,E(this,"activated",!1),E(this,"logger",void 0),E(this,"leavePromiseDefer",void 0),E(this,"oldStatus",void 0),E(this,"scheduler",void 0),E(this,"state",void 0),E(this,"deviceId",void 0),E(this,"stateKey",void 0),E(this,"fociPreferred",void 0),E(this,"focusActive",void 0),E(this,"membershipServerSideExpiryTimeoutOverride",void 0),this.logger=(a??U).getChild("[NewMembershipManager]");var[o,s]=[this.client.getUserId(),this.client.getDeviceId()];if(o===null)throw Error("Missing userId in client");if(s===null)throw Error("Missing deviceId in client");this.deviceId=s,this.stateKey=this.makeMembershipStateKey(o,s),this.state=N0.defaultState,this.scheduler=new bme(l=>(this.oldStatus&&(this.logger.debug("MembershipManager applied action changes. Status: ".concat(this.oldStatus," -> ").concat(this.status)),this.oldStatus!==this.status&&this.emit(gk.StatusChanged,this.oldStatus,this.status)),this.oldStatus=this.status,this.logger.debug("MembershipManager before processing action. status=".concat(this.oldStatus)),this.membershipLoopHandler(l)),this.logger)}static get defaultState(){return{hasMemberStateEvent:!1,delayId:void 0,startTime:0,rateLimitRetries:new Map,networkErrorRetries:new Map,expireUpdateIterations:1}}get callMemberEventRetryDelayMinimum(){var e,r;return(e=(r=this.joinConfig)===null||r===void 0?void 0:r.callMemberEventRetryDelayMinimum)!==null&&e!==void 0?e:3e3}get membershipEventExpiryTimeout(){var e,r;return(e=(r=this.joinConfig)===null||r===void 0?void 0:r.membershipExpiryTimeout)!==null&&e!==void 0?e:c3}get membershipEventExpiryTimeoutHeadroom(){var e,r;return(e=(r=this.joinConfig)===null||r===void 0?void 0:r.membershipExpiryTimeoutHeadroom)!==null&&e!==void 0?e:5e3}computeNextExpiryActionTs(e){return this.state.startTime+this.membershipEventExpiryTimeout*e-this.membershipEventExpiryTimeoutHeadroom}get membershipServerSideExpiryTimeout(){var e,r,n;return(e=(r=this.membershipServerSideExpiryTimeoutOverride)!==null&&r!==void 0?r:(n=this.joinConfig)===null||n===void 0?void 0:n.membershipServerSideExpiryTimeout)!==null&&e!==void 0?e:8e3}get membershipKeepAlivePeriod(){var e,r;return(e=(r=this.joinConfig)===null||r===void 0?void 0:r.membershipKeepAlivePeriod)!==null&&e!==void 0?e:5e3}get maximumRateLimitRetryCount(){var e,r;return(e=(r=this.joinConfig)===null||r===void 0?void 0:r.maximumRateLimitRetryCount)!==null&&e!==void 0?e:10}get maximumNetworkErrorRetryCount(){var e,r;return(e=(r=this.joinConfig)===null||r===void 0?void 0:r.maximumNetworkErrorRetryCount)!==null&&e!==void 0?e:10}membershipLoopHandler(e){var r=this;return K(function*(){switch(e){case et.SendDelayedEvent:return r.state.delayId?r.cancelKnownDelayIdBeforeSendFirstDelayedEvent(r.state.delayId):r.sendOrResendDelayedLeaveEvent();case et.RestartDelayedEvent:return r.state.delayId?r.restartDelayedEvent(r.state.delayId):Ui(et.SendDelayedEvent);case et.SendScheduledDelayedLeaveEvent:return r.state.hasMemberStateEvent?r.state.delayId?r.sendScheduledDelayedLeaveEventOrFallbackToSendLeaveEvent(r.state.delayId):Ui(et.SendLeaveEvent):{replace:[]};case et.SendJoinEvent:return r.sendJoinEvent();case et.UpdateExpiry:return r.updateExpiryOnJoinedEvent();case et.SendLeaveEvent:return r.state.hasMemberStateEvent?r.sendFallbackLeaveEvent():{replace:[]}}})()}sendOrResendDelayedLeaveEvent(){var e=this;return K(function*(){return yield e.client._unstable_sendDelayedStateEvent(e.room.roomId,{delay:e.membershipServerSideExpiryTimeout},ge.GroupCallMemberPrefix,{},e.stateKey).then(r=>(e.resetRateLimitCounter(et.SendDelayedEvent),e.state.delayId=r.delay_id,e.state.hasMemberStateEvent?Ui(et.RestartDelayedEvent,e.membershipKeepAlivePeriod):Ui(et.SendJoinEvent))).catch(r=>{var n=et.SendDelayedEvent;if(e.manageMaxDelayExceededSituation(r))return Ui(n);var i=e.actionUpdateFromErrors(r,n,"sendDelayedStateEvent");if(i)return i;if(e.state.hasMemberStateEvent){if(e.isUnsupportedDelayedEndpoint(r))return{};throw Error("Could not send delayed event, even though delayed events are supported. "+r)}else return e.isUnsupportedDelayedEndpoint(r)?e.logger.info("Not using delayed event because the endpoint is not supported"):e.logger.info("Not using delayed event because: "+r),Ui(et.SendJoinEvent)})})()}cancelKnownDelayIdBeforeSendFirstDelayedEvent(e){var r=this;return K(function*(){return yield r.client._unstable_updateDelayedEvent(e,Su.Cancel).then(()=>(r.state.delayId=void 0,r.resetRateLimitCounter(et.SendDelayedEvent),kw(et.SendDelayedEvent))).catch(n=>{var i=et.SendDelayedEvent,a=r.actionUpdateFromErrors(n,i,"updateDelayedEvent");if(a)return a;if(r.isNotFoundError(n))return r.state.delayId=void 0,kw(i);if(r.isUnsupportedDelayedEndpoint(n))return kw(et.SendJoinEvent);throw Error("We failed to cancel a delayed event where we already had a delay id with an error we cannot automatically handle")})})()}restartDelayedEvent(e){var r=this;return K(function*(){return yield r.client._unstable_updateDelayedEvent(e,Su.Restart).then(()=>(r.resetRateLimitCounter(et.RestartDelayedEvent),Ui(et.RestartDelayedEvent,r.membershipKeepAlivePeriod))).catch(n=>{var i=et.RestartDelayedEvent;if(r.isNotFoundError(n))return r.state.delayId=void 0,Ui(et.SendDelayedEvent);if(r.isUnsupportedDelayedEndpoint(n))return{};var a=r.actionUpdateFromErrors(n,i,"updateDelayedEvent");if(a)return a;throw Error("Could not restart delayed event, even though delayed events are supported. "+n)})})()}sendScheduledDelayedLeaveEventOrFallbackToSendLeaveEvent(e){var r=this;return K(function*(){return yield r.client._unstable_updateDelayedEvent(e,Su.Send).then(()=>(r.state.hasMemberStateEvent=!1,r.resetRateLimitCounter(et.SendScheduledDelayedLeaveEvent),{replace:[]})).catch(n=>{var i=et.SendLeaveEvent;if(r.isUnsupportedDelayedEndpoint(n))return{};if(r.isNotFoundError(n))return r.state.delayId=void 0,Ui(i);var a=r.actionUpdateFromErrors(n,i,"updateDelayedEvent");return a||(r.logger.warn("Encountered unexpected error during SendScheduledDelayedLeaveEvent. Falling back to SendLeaveEvent",n),Ui(i))})})()}sendJoinEvent(){var e=this;return K(function*(){return yield e.client.sendStateEvent(e.room.roomId,ge.GroupCallMemberPrefix,e.makeMyMembership(e.membershipEventExpiryTimeout),e.stateKey).then(()=>(e.state.startTime=Date.now(),e.state.expireUpdateIterations=1,e.state.hasMemberStateEvent=!0,e.resetRateLimitCounter(et.SendJoinEvent),{insert:[{ts:Date.now(),type:et.RestartDelayedEvent},{ts:e.computeNextExpiryActionTs(e.state.expireUpdateIterations),type:et.UpdateExpiry}]})).catch(r=>{var n=e.actionUpdateFromErrors(r,et.SendJoinEvent,"sendStateEvent");if(n)return n;throw r})})()}updateExpiryOnJoinedEvent(){var e=this;return K(function*(){var r=e.state.expireUpdateIterations+1;return yield e.client.sendStateEvent(e.room.roomId,ge.GroupCallMemberPrefix,e.makeMyMembership(e.membershipEventExpiryTimeout*r),e.stateKey).then(()=>(e.resetRateLimitCounter(et.UpdateExpiry),e.state.expireUpdateIterations=r,{insert:[{ts:e.computeNextExpiryActionTs(r),type:et.UpdateExpiry}]})).catch(n=>{var i=e.actionUpdateFromErrors(n,et.UpdateExpiry,"sendStateEvent");if(i)return i;throw n})})()}sendFallbackLeaveEvent(){var e=this;return K(function*(){return yield e.client.sendStateEvent(e.room.roomId,ge.GroupCallMemberPrefix,{},e.stateKey).then(()=>(e.resetRateLimitCounter(et.SendLeaveEvent),e.state.hasMemberStateEvent=!1,{replace:[]})).catch(r=>{var n=e.actionUpdateFromErrors(r,et.SendLeaveEvent,"sendStateEvent");if(n)return n;throw r})})()}makeMembershipStateKey(e,r){var n="".concat(e,"_").concat(r);return/^org\.matrix\.msc(3757|3779)\b/.exec(this.room.getVersion())?n:"_".concat(n)}makeMyMembership(e){var r;return{call_id:"",scope:"m.room",application:"m.call",device_id:this.deviceId,expires:e,focus_active:{type:"livekit",focus_selection:"oldest_membership"},foci_preferred:(r=this.fociPreferred)!==null&&r!==void 0?r:[]}}isNotFoundError(e){return e instanceof ur&&e.errcode==="M_NOT_FOUND"}manageMaxDelayExceededSituation(e){if(e instanceof ur&&e.errcode==="M_UNKNOWN"&&e.data["org.matrix.msc4140.errcode"]==="M_MAX_DELAY_EXCEEDED"){var r=e.data["org.matrix.msc4140.max_delay"];return typeof r=="number"&&this.membershipServerSideExpiryTimeout>r&&(this.membershipServerSideExpiryTimeoutOverride=r),this.logger.warn("Retry sending delayed disconnection event due to server timeout limitations:",e),!0}return!1}actionUpdateFromErrors(e,r,n){var i=this.actionUpdateFromRateLimitError(e,n,r);if(i)return i;var a=this.actionUpdateFromNetworkErrorRetry(e,r);if(a)return a}actionUpdateFromRateLimitError(e,r,n){var i;if((e instanceof gl||e instanceof ur)&&e.isRateLimitError()){var a=(i=this.state.rateLimitRetries.get(n))!==null&&i!==void 0?i:0;if(a<this.maximumRateLimitRetryCount){var o,s=5e3;try{var l;o=(l=e.getRetryAfterMs())!==null&&l!==void 0?l:s,this.logger.info("Rate limited by server, retrying in ".concat(o,"ms"))}catch(c){this.logger.warn("Error while retrieving a rate-limit retry delay, retrying after default delay of ".concat(s),c),o=s}return this.state.rateLimitRetries.set(n,a+1),Ui(n,o)}throw Error("Exceeded maximum retries for "+n+" attempts (client."+r+"): "+e)}}actionUpdateFromNetworkErrorRetry(e,r){var n,i=(n=this.state.networkErrorRetries.get(r))!==null&&n!==void 0?n:0,a=this.callMemberEventRetryDelayMinimum/1e3+"s",o="("+i+"/"+this.maximumNetworkErrorRetryCount+")";if(e instanceof Error&&e.name==="AbortError")this.logger.warn("Network local timeout error while sending event, retrying in "+a+" "+o,e);else if(e instanceof Error&&e.message.includes("updating delayed event"))this.logger.warn("delayed event update timeout error, retrying in "+a+" "+o,e);else if(e instanceof Xu)this.logger.warn("Network connection error while sending event, retrying in "+a+" "+o,e);else if((e instanceof gl||e instanceof ur)&&typeof e.httpStatus=="number"&&e.httpStatus>=500&&e.httpStatus<600)this.logger.warn("Server error while sending event, retrying in "+a+" "+o,e);else return;if(i<this.maximumNetworkErrorRetryCount)return this.state.networkErrorRetries.set(r,i+1),Ui(r,this.callMemberEventRetryDelayMinimum);throw Error("Reached maximum ("+this.maximumNetworkErrorRetryCount+") retries cause by: "+e)}isUnsupportedDelayedEndpoint(e){return e instanceof Gs}resetRateLimitCounter(e){this.state.rateLimitRetries.set(e,0),this.state.networkErrorRetries.set(e,0)}get status(){var e=this.scheduler.actions;if(e.length===1){var{type:r}=e[0];switch(r){case et.SendDelayedEvent:case et.SendJoinEvent:return Ts.Connecting;case et.UpdateExpiry:return Ts.Connected;case et.SendScheduledDelayedLeaveEvent:case et.SendLeaveEvent:return Ts.Disconnecting}}else if(e.length===2){var n=e.map(a=>a.type);if((n.includes(et.RestartDelayedEvent)||n.includes(et.SendDelayedEvent)&&this.state.hasMemberStateEvent)&&n.includes(et.UpdateExpiry))return Ts.Connected}else if(e.length===3){var i=e.map(a=>a.type);if(i.filter(a=>a===et.RestartDelayedEvent).length===2&&i.includes(et.UpdateExpiry))return Ts.Connected}return this.scheduler.running?(this.logger.error("MembershipManager has an unknown state. Actions: ",e),Ts.Unknown):Ts.Disconnected}}function Ui(t,e){return{insert:[{ts:Date.now()+(e??0),type:t}]}}function kw(t,e){return{replace:[{ts:Date.now()+0,type:t}]}}var qs=function(t){return t.ReceivedKeys="received_keys",t}({}),h3=function(t){return t.EnabledTransportsChanged="enabled_transports_changed",t}({});class HV extends nr{constructor(e,r,n){var i;super(),i=this,this.toDeviceTransport=e,this.roomKeyTransport=r,E(this,"logger",void 0),E(this,"_enabled",{toDevice:!0,room:!1}),this.logger=(n??U).getChild("[RoomAndToDeviceTransport]"),this.toDeviceTransport.setParentLogger(this.logger),this.roomKeyTransport.setParentLogger(this.logger),this.roomKeyTransport.on(qs.ReceivedKeys,function(){i._enabled.room||(i.logger.debug("Received room key, enabling room key transport, disabling toDevice transport"),i.setEnabled({toDevice:!1,room:!0}));for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];i.emit(qs.ReceivedKeys,...o)}),this.toDeviceTransport.on(qs.ReceivedKeys,function(){if(i._enabled.toDevice){for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];i.emit(qs.ReceivedKeys,...o)}else i.logger.debug("To Device transport is disabled, ignoring received keys")})}setEnabled(e){(this.enabled.toDevice!==e.toDevice||this.enabled.room!==e.room)&&(this._enabled=e,this.emit(h3.EnabledTransportsChanged,e))}get enabled(){return this._enabled}start(){this.roomKeyTransport.start(),this.toDeviceTransport.start()}stop(){this.roomKeyTransport.stop(),this.toDeviceTransport.stop()}sendKey(e,r,n){var i=this;return K(function*(){i.logger.debug("Sending key with index ".concat(r," to call members (count=").concat(n.length,") via:")+(i._enabled.room?"room transport":"")+(i._enabled.room&&i._enabled.toDevice?"and":"")+(i._enabled.toDevice?"to device transport":"")),i._enabled.room&&(yield i.roomKeyTransport.sendKey(e,r,n)),i._enabled.toDevice&&(yield i.toDeviceTransport.sendKey(e,r,n))})()}}class _me{get updateEncryptionKeyThrottle(){var e,r;return(e=(r=this.joinConfig)===null||r===void 0?void 0:r.updateEncryptionKeyThrottle)!==null&&e!==void 0?e:3e3}get makeKeyDelay(){var e,r;return(e=(r=this.joinConfig)===null||r===void 0?void 0:r.makeKeyDelay)!==null&&e!==void 0?e:3e3}get useKeyDelay(){var e,r;return(e=(r=this.joinConfig)===null||r===void 0?void 0:r.useKeyDelay)!==null&&e!==void 0?e:5e3}constructor(e,r,n,i,a,o,s){var l=this;this.userId=e,this.deviceId=r,this.getMemberships=n,this.transport=i,this.statistics=a,this.onEncryptionKeysChanged=o,E(this,"manageMediaKeys",!1),E(this,"keysEventUpdateTimeout",void 0),E(this,"makeNewKeyTimeout",void 0),E(this,"setNewKeyTimeouts",new Set),E(this,"encryptionKeys",new Map),E(this,"lastEncryptionKeyUpdateRequest",void 0),E(this,"lastMembershipFingerprints",void 0),E(this,"latestGeneratedKeyIndex",-1),E(this,"joinConfig",void 0),E(this,"logger",void 0),E(this,"joined",!1),E(this,"sendEncryptionKeysEvent",function(){var c=K(function*(d){if(l.keysEventUpdateTimeout!==void 0&&(clearTimeout(l.keysEventUpdateTimeout),l.keysEventUpdateTimeout=void 0),l.lastEncryptionKeyUpdateRequest=Date.now(),!!l.joined){var h=l.getKeysForParticipant(l.userId,l.deviceId);if(!h){l.logger.warn("Tried to send encryption keys event but no keys found!");return}if(typeof d!="number"&&l.latestGeneratedKeyIndex===-1){l.logger.warn("Tried to send encryption keys event but no current key index found!");return}var p=d??l.latestGeneratedKeyIndex;l.logger.info("Try sending encryption keys event. keyIndexToSend=".concat(p," (method parameter: ").concat(d,")"));var m=h[p];try{l.statistics.counters.roomEventEncryptionKeysSent+=1,yield l.transport.sendKey(OV(m),p,l.getMemberships()),l.logger.debug("sendEncryptionKeysEvent participantId=".concat(l.userId,":").concat(l.deviceId," numKeys=").concat(h.length," currentKeyIndex=").concat(l.latestGeneratedKeyIndex," keyIndexToSend=").concat(p),l.encryptionKeys)}catch(y){if(l.keysEventUpdateTimeout===void 0){var g=X4(y,5e3);l.logger.warn("Failed to send m.call.encryption_key, retrying in ".concat(g),y),l.keysEventUpdateTimeout=setTimeout(()=>void l.sendEncryptionKeysEvent(),g)}else l.logger.info("Not scheduling key resend as another re-send is already pending")}}});return function(d){return c.apply(this,arguments)}}()),E(this,"onTransportChanged",()=>{this.requestSendCurrentKey()}),E(this,"onNewKeyReceived",(c,d,h,p,m)=>{this.logger.debug("Received key over key transport ".concat(c,":").concat(d," at index ").concat(p)),this.setEncryptionKey(c,d,p,h,m)}),E(this,"onRotateKeyTimeout",()=>{if(this.manageMediaKeys){this.makeNewKeyTimeout=void 0,this.logger.info("Making new sender key for key rotation");var c=this.makeNewSenderKey(!0);this.sendEncryptionKeysEvent(c)}}),this.logger=(s??U).getChild("[EncryptionManager]")}getEncryptionKeys(){return this.encryptionKeys}join(e){var r,n,i;this.joinConfig=e,this.joined=!0,this.manageMediaKeys=(r=(n=this.joinConfig)===null||n===void 0?void 0:n.manageMediaKeys)!==null&&r!==void 0?r:this.manageMediaKeys,this.transport.on(qs.ReceivedKeys,this.onNewKeyReceived),this.transport instanceof HV&&this.transport.on(h3.EnabledTransportsChanged,this.onTransportChanged),this.transport.start(),(i=this.joinConfig)!==null&&i!==void 0&&i.manageMediaKeys&&(this.makeNewSenderKey(),this.requestSendCurrentKey())}leave(){this.encryptionKeys.set(ay(this.userId,this.deviceId),[]),this.transport.off(qs.ReceivedKeys,this.onNewKeyReceived),this.transport.stop(),this.makeNewKeyTimeout!==void 0&&(clearTimeout(this.makeNewKeyTimeout),this.makeNewKeyTimeout=void 0);for(var e of this.setNewKeyTimeouts)clearTimeout(e);this.setNewKeyTimeouts.clear(),this.manageMediaKeys=!1,this.joined=!1}onMembershipsUpdate(e){if(this.manageMediaKeys&&this.joined){var r=new Set(e.filter(c=>!iy(c,this.userId,this.deviceId)).map(Ow)),n=new Set(this.getMemberships().filter(c=>!iy(c,this.userId,this.deviceId)).map(Ow)),i=Array.from(r).some(c=>!n.has(c)),a=Array.from(n).some(c=>!r.has(c)),o=this.lastMembershipFingerprints;if(this.storeLastMembershipFingerprints(),i)this.makeNewKeyTimeout||(this.logger.debug("Member(s) have left: queueing sender key rotation"),this.makeNewKeyTimeout=setTimeout(this.onRotateKeyTimeout,this.makeKeyDelay));else if(a)this.logger.debug("New member(s) have joined: re-sending keys"),this.requestSendCurrentKey();else if(o){var s=this.lastMembershipFingerprints,l=Array.from(o).some(c=>!s.has(c))||Array.from(s).some(c=>!o.has(c));l&&(this.logger.debug("Member(s) have updated/reconnected: re-sending keys to everyone"),this.requestSendCurrentKey())}}}makeNewSenderKey(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,r=hpe(16),n=this.getNewEncryptionKeyIndex();return this.logger.info("Generated new key at index "+n),this.setEncryptionKey(this.userId,this.deviceId,n,r,Date.now(),e),n}requestSendCurrentKey(){if(this.manageMediaKeys){if(this.lastEncryptionKeyUpdateRequest&&this.lastEncryptionKeyUpdateRequest+this.updateEncryptionKeyThrottle>Date.now()){this.logger.info("Last encryption key event sent too recently: postponing"),this.keysEventUpdateTimeout===void 0&&(this.keysEventUpdateTimeout=setTimeout(()=>void this.sendEncryptionKeysEvent(),this.updateEncryptionKeyThrottle));return}this.sendEncryptionKeysEvent()}}getKeysForParticipant(e,r){var n;return(n=this.encryptionKeys.get(ay(e,r)))===null||n===void 0?void 0:n.map(i=>i.key)}storeLastMembershipFingerprints(){this.lastMembershipFingerprints=new Set(this.getMemberships().filter(e=>!iy(e,this.userId,this.deviceId)).map(e=>"".concat(Ow(e),":").concat(e.createdTs())))}getNewEncryptionKeyIndex(){return this.latestGeneratedKeyIndex===-1?0:(this.latestGeneratedKeyIndex+1)%256}setEncryptionKey(e,r,n,i,a){var o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!1;this.logger.debug("Setting encryption key for ".concat(e,":").concat(r," at index ").concat(n));var s=xd(i),l=ay(e,r);this.encryptionKeys.has(l)||this.encryptionKeys.set(l,[]);var c=this.encryptionKeys.get(l),d=c[n];if(d){if(d.timestamp>a){this.logger.info("Ignoring new key at index ".concat(n," for ").concat(l," as it is older than existing known key"));return}if(Sme(d.key,s)){d.timestamp=a;return}}if(e===this.userId&&r===this.deviceId&&(this.latestGeneratedKeyIndex=n),c[n]={key:s,timestamp:a},o){var h=setTimeout(()=>{this.setNewKeyTimeouts.delete(h),this.logger.info("Delayed-emitting key changed event for ".concat(l," index ").concat(n)),this.onEncryptionKeysChanged(s,n,l)},this.useKeyDelay);this.setNewKeyTimeouts.add(h)}else this.onEncryptionKeysChanged(s,n,l)}}var ay=(t,e)=>"".concat(t,":").concat(e);function Sme(t,e){return t===e?!0:!!t&&!!e&&t.length===e.length&&t.every((r,n)=>r===e[n])}var Ow=t=>ay(t.sender,t.deviceId);class wme{get callMemberEventRetryDelayMinimum(){var e,r;return(e=(r=this.joinConfig)===null||r===void 0?void 0:r.callMemberEventRetryDelayMinimum)!==null&&e!==void 0?e:3e3}get membershipExpiryTimeout(){var e,r;return(e=(r=this.joinConfig)===null||r===void 0?void 0:r.membershipExpiryTimeout)!==null&&e!==void 0?e:c3}get membershipServerSideExpiryTimeout(){var e,r,n;return(e=(r=this.membershipServerSideExpiryTimeoutOverride)!==null&&r!==void 0?r:(n=this.joinConfig)===null||n===void 0?void 0:n.membershipServerSideExpiryTimeout)!==null&&e!==void 0?e:8e3}get membershipKeepAlivePeriod(){var e,r;return(e=(r=this.joinConfig)===null||r===void 0?void 0:r.membershipKeepAlivePeriod)!==null&&e!==void 0?e:5e3}get callMemberEventRetryJitter(){var e,r;return(e=(r=this.joinConfig)===null||r===void 0?void 0:r.callMemberEventRetryJitter)!==null&&e!==void 0?e:2e3}constructor(e,r,n,i){var a=this;this.joinConfig=e,this.room=r,this.client=n,this.getOldestMembership=i,E(this,"relativeExpiry",void 0),E(this,"memberEventTimeout",void 0),E(this,"ownFociPreferred",void 0),E(this,"ownFocusActive",void 0),E(this,"updateCallMembershipRunning",!1),E(this,"needCallMembershipUpdate",!1),E(this,"membershipServerSideExpiryTimeoutOverride",void 0),E(this,"disconnectDelayId",void 0),E(this,"triggerCallMembershipEventUpdate",K(function*(){if(a.updateCallMembershipRunning){a.needCallMembershipUpdate=!0;return}a.updateCallMembershipRunning=!0;try{do a.needCallMembershipUpdate=!1,yield a.updateCallMembershipEvent();while(a.needCallMembershipUpdate)}finally{a.updateCallMembershipRunning=!1}})),E(this,"delayDisconnection",K(function*(){try{var o=a.disconnectDelayId;yield xc(()=>a.client._unstable_updateDelayedEvent(o,Su.Restart)),a.scheduleDelayDisconnection()}catch(s){U.error("Failed to delay our disconnection event:",s)}}))}off(e,r){return U.error("off is not implemented on LegacyMembershipManager"),this}on(e,r){return U.error("on is not implemented on LegacyMembershipManager"),this}isJoined(){return this.relativeExpiry!==void 0}isActivated(){return this.isJoined()}get status(){return Ts.Unknown}join(e,r){this.ownFocusActive=r,this.ownFociPreferred=e,this.relativeExpiry=this.membershipExpiryTimeout,this.triggerCallMembershipEventUpdate()}leave(){var e=arguments,r=this;return K(function*(){var n=e.length>0&&e[0]!==void 0?e[0]:void 0;if(r.relativeExpiry=void 0,r.ownFocusActive=void 0,r.memberEventTimeout&&(clearTimeout(r.memberEventTimeout),r.memberEventTimeout=void 0),n){var i=yield Promise.race([r.triggerCallMembershipEventUpdate(),$u(n,"timeout")]);return i!=="timeout"}else return yield r.triggerCallMembershipEventUpdate(),!0})()}onRTCSessionMemberUpdate(e){var r=this;return K(function*(){var n=i=>i.sender===r.client.getUserId()&&i.deviceId===r.client.getDeviceId();if(r.isJoined()&&!e.some(n))return U.warn("Missing own membership: force re-join"),r.triggerCallMembershipEventUpdate()})()}getActiveFocus(){if(this.ownFocusActive)if(u3(this.ownFocusActive)){if(this.ownFocusActive.focus_selection==="oldest_membership"){var e=this.getOldestMembership();return e==null?void 0:e.getPreferredFoci()[0]}}else U.warn("Unknown own ActiveFocus type. This makes it impossible to connect to an SFU.");else{var r=this.getOldestMembership();return r==null?void 0:r.getPreferredFoci()[0]}}makeNewMembership(e){return this.isJoined()?this.makeMyMembership(e):{}}makeMyMembership(e){var r;return{call_id:"",scope:"m.room",application:"m.call",device_id:e,expires:this.relativeExpiry,focus_active:{type:"livekit",focus_selection:"oldest_membership"},foci_preferred:(r=this.ownFociPreferred)!==null&&r!==void 0?r:[]}}updateCallMembershipEvent(){var e=this;return K(function*(){e.memberEventTimeout&&(clearTimeout(e.memberEventTimeout),e.memberEventTimeout=void 0);var r=e.room.getLiveTimeline().getState(Be.FORWARDS);if(!r)throw new Error("Couldn't get room state for room "+e.room.roomId);var n=e.client.getUserId(),i=e.client.getDeviceId();if(!n||!i)throw new Error("User ID or device ID was null!");var a={};a=e.makeNewMembership(i);try{if(e.isJoined()){var o=e.makeMembershipStateKey(n,i),s=function(){var p=K(function*(){try{var m=yield xc(()=>e.client._unstable_sendDelayedStateEvent(e.room.roomId,{delay:e.membershipServerSideExpiryTimeout},ge.GroupCallMemberPrefix,{},o));e.disconnectDelayId=m.delay_id}catch(y){if(y instanceof ur&&y.errcode==="M_UNKNOWN"&&y.data["org.matrix.msc4140.errcode"]==="M_MAX_DELAY_EXCEEDED"){var g=y.data["org.matrix.msc4140.max_delay"];if(typeof g=="number"&&e.membershipServerSideExpiryTimeout>g)return e.membershipServerSideExpiryTimeoutOverride=g,s()}U.error("Failed to prepare delayed disconnection event:",y)}});return function(){return p.apply(this,arguments)}}();if(yield s(),yield xc(()=>e.client.sendStateEvent(e.room.roomId,ge.GroupCallMemberPrefix,a,o)),e.disconnectDelayId!==void 0)try{var l=e.disconnectDelayId;yield xc(()=>e.client._unstable_updateDelayedEvent(l,Su.Restart))}catch(p){p instanceof ur&&p.errcode==="M_NOT_FOUND"&&(U.warn("Failed to update delayed disconnection event, prepare it again:",p),e.disconnectDelayId=void 0,yield s())}e.disconnectDelayId!==void 0&&e.scheduleDelayDisconnection()}else{var c=!1;if(e.disconnectDelayId!==void 0){try{var d=e.disconnectDelayId;yield xc(()=>e.client._unstable_updateDelayedEvent(d,Su.Send)),c=!0}catch(p){U.error("Failed to send our delayed disconnection event:",p)}e.disconnectDelayId=void 0}c||(yield xc(()=>e.client.sendStateEvent(e.room.roomId,ge.GroupCallMemberPrefix,{},e.makeMembershipStateKey(n,i))))}U.info("Sent updated call member event.")}catch(p){var h=e.callMemberEventRetryDelayMinimum+Math.random()*e.callMemberEventRetryJitter;U.warn("Failed to send call member event (retrying in ".concat(h,"): ").concat(p)),yield $u(h),yield e.triggerCallMembershipEventUpdate()}})()}scheduleDelayDisconnection(){this.memberEventTimeout=setTimeout(()=>void this.delayDisconnection(),this.membershipKeepAlivePeriod)}makeMembershipStateKey(e,r){var n="".concat(e,"_").concat(r);return/^org\.matrix\.msc(3757|3779)\b/.exec(this.room.getVersion())?n:"_".concat(n)}}function xc(t){return tC.apply(this,arguments)}function tC(){return tC=K(function*(t){for(var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;;)try{return yield t()}catch(a){if(e>0&&a instanceof gl&&a.isRateLimitError()){e--;var r=void 0,n=5e3;try{var i;r=(i=a.getRetryAfterMs())!==null&&i!==void 0?i:n,U.info("Rate limited by server, retrying in ".concat(r,"ms"))}catch(o){U.warn("Error while retrieving a rate-limit retry delay, retrying after default delay of ".concat(n),o),r=n}yield $u(r)}else throw a}}),tC.apply(this,arguments)}class yk extends nr{setParentLogger(e){this.logger=e.getChild("[RoomKeyTransport]")}constructor(e,r,n,i){super(),this.room=e,this.client=r,this.statistics=n,E(this,"logger",U),this.setParentLogger(i??U)}start(){this.room.on(Ue.Timeline,e=>void this.consumeCallEncryptionEvent(e))}stop(){this.room.off(Ue.Timeline,e=>void this.consumeCallEncryptionEvent(e))}consumeCallEncryptionEvent(e){var r=arguments,n=this;return K(function*(){var i=r.length>1&&r[1]!==void 0?r[1]:!1;if(yield n.client.decryptEventIfNeeded(e),e.isDecryptionFailure()){i?n.logger.warn("Decryption failed for event ".concat(e.getId(),": ").concat(e.decryptionFailureReason)):(n.logger.warn("Decryption failed for event ".concat(e.getId(),": ").concat(e.decryptionFailureReason," will retry once only")),setTimeout(()=>void n.consumeCallEncryptionEvent(e,!0),1e3));return}else i&&n.logger.info("Decryption succeeded for event ".concat(e.getId()," after retry"));if(e.getType()!==ge.CallEncryptionKeysPrefix)return Promise.resolve();if(!n.room)return n.logger.error("Got room state event for unknown room ".concat(e.getRoomId(),"!")),Promise.resolve();n.onEncryptionEvent(e)})()}sendKey(e,r,n){var i=this;return K(function*(){var a={keys:[{index:r,key:e}],device_id:i.client.getDeviceId(),call_id:"",sent_ts:Date.now()};try{yield i.client.sendEvent(i.room.roomId,ge.CallEncryptionKeysPrefix,a)}catch(s){i.logger.error("Failed to send call encryption keys",s);var o=s;throw o.event&&i.client.cancelPendingEvent(o.event),s}})()}onEncryptionEvent(e){var r=e.getSender(),n=e.getContent(),i=n.device_id,a=n.call_id;if(!r){this.logger.warn("Received m.call.encryption_keys with no userId: callId=".concat(a));return}if(a!==""){this.logger.warn("Received m.call.encryption_keys with unsupported callId: userId=".concat(r,", deviceId=").concat(i,", callId=").concat(a));return}if(!Array.isArray(n.keys)){this.logger.warn("Received m.call.encryption_keys where keys wasn't an array: callId=".concat(a));return}if(r===this.client.getUserId()&&i===this.client.getDeviceId()){this.logger.info("Ignoring our own keys event");return}this.statistics.counters.roomEventEncryptionKeysReceived+=1;var o=Date.now()-(typeof n.sent_ts=="number"?n.sent_ts:e.getTs());this.statistics.totals.roomEventEncryptionKeysReceivedTotalAge+=o;for(var s of n.keys){if(!s){this.logger.info("Ignoring false-y key in keys event");continue}var l=s.key,c=s.index;!l||c===void 0||c===null||a===void 0||a===null||typeof i!="string"||typeof a!="string"||typeof l!="string"||typeof c!="number"?this.logger.warn("Malformed call encryption_key: userId=".concat(r,", deviceId=").concat(i,", encryptionKeyIndex=").concat(c," callId=").concat(a)):(this.logger.debug("onCallEncryption userId=".concat(r,":").concat(i," encryptionKeyIndex=").concat(c," age=").concat(o,"ms")),this.emit(qs.ReceivedKeys,r,i,l,c,e.getTs()))}}}class Eme extends nr{setParentLogger(e){this.logger=e.getChild("[ToDeviceKeyTransport]")}constructor(e,r,n,i,a,o){super(),this.userId=e,this.deviceId=r,this.roomId=n,this.client=i,this.statistics=a,E(this,"logger",U),E(this,"onToDeviceEvent",s=>{if(s.getType()===ge.CallEncryptionKeysPrefix){var l=this.getValidEventContent(s);l&&s.getSender()&&this.receiveCallKeyEvent(s.getSender(),l)}}),this.setParentLogger(o??U)}start(){this.client.on(je.ToDeviceEvent,this.onToDeviceEvent)}stop(){this.client.off(je.ToDeviceEvent,this.onToDeviceEvent)}sendKey(e,r,n){var i=this;return K(function*(){var a={keys:{index:r,key:e},room_id:i.roomId,member:{claimed_device_id:i.deviceId},session:{call_id:"",application:"m.call",scope:"m.room"}},o=n.filter(s=>s.sender==null||s.deviceId==null?(i.logger.warn("Malformed call member: ".concat(s.sender,"|").concat(s.deviceId)),!1):!(s.sender==i.userId&&s.deviceId==i.deviceId)).map(s=>({userId:s.sender,deviceId:s.deviceId}));o.length>0?(yield i.client.encryptAndSendToDevice(ge.CallEncryptionKeysPrefix,o,a),i.statistics.counters.roomEventEncryptionKeysSent+=1):i.logger.warn("No targets found for sending key")})()}receiveCallKeyEvent(e,r){this.statistics.counters.roomEventEncryptionKeysReceived+=1;var n=Date.now(),i=n-(typeof r.sent_ts=="number"?r.sent_ts:n);this.statistics.totals.roomEventEncryptionKeysReceivedTotalAge+=i,this.emit(qs.ReceivedKeys,e,r.member.claimed_device_id,r.keys.key,r.keys.index,n)}getValidEventContent(e){var r=e.getContent(),n=r.room_id;if(!n){this.logger.warn("Malformed Event: invalid call encryption keys event, no roomId");return}if(n!==this.roomId){this.logger.warn("Malformed Event: Mismatch roomId");return}if(!r.keys||!r.keys.key||typeof r.keys.index!="number"){this.logger.warn("Malformed Event: Missing keys field");return}if(!r.member||!r.member.claimed_device_id){this.logger.warn("Malformed Event: Missing claimed_device_id");return}return r}}var Nl=function(t){return t.MembershipsChanged="memberships_changed",t.JoinStateChanged="join_state_changed",t.EncryptionKeyChanged="encryption_key_changed",t.MembershipManagerError="membership_manager_error",t}({});class Dd extends nr{get callId(){return this._callId}static callMembershipsForRoom(e){var r=U.getChild("[MatrixRTCSession ".concat(e.roomId,"]")),n=e.getLiveTimeline().getState(Be.FORWARDS);if(!n)throw r.warn("Couldn't get state for room "+e.roomId),new Error("Could't get state for room "+e.roomId);var i=n.getStateEvents(ge.GroupCallMemberPrefix),a=[];for(var o of i){var s=o.getContent(),l=Object.keys(s).length;if(l!==0){var c=[];if(l>1&&"focus_active"in s?c.push(s):l===1&&"memberships"in s&&r.warn("Legacy event found. Those are ignored, they do not contribute to the MatrixRTC session"),c.length!==0)for(var d of c)try{var h,p=new vk(o,d);if(p.callId!==""||p.scope!=="m.room"){r.info("Ignoring user-scoped call");continue}if(p.isExpired()){r.info("Ignoring expired device membership ".concat(p.sender,"/").concat(p.deviceId));continue}if(!e.hasMembershipState((h=p.sender)!==null&&h!==void 0?h:"",ct.Join)){r.info("Ignoring membership of user ".concat(p.sender," who is not in the room."));continue}a.push(p)}catch(m){r.warn("Couldn't construct call membership: ",m)}}}return a.sort((m,g)=>m.createdTs()-g.createdTs()),a.length>1&&r.debug("Call memberships in room ".concat(e.roomId,", in order: "),a.map(m=>[m.createdTs(),m.sender])),a}static roomSessionForRoom(e,r){var n=Dd.callMembershipsForRoom(r);return new Dd(e,r,n)}get room(){return this.roomSubset}constructor(e,r,n){var i;super(),this.client=e,this.roomSubset=r,this.memberships=n,E(this,"membershipManager",void 0),E(this,"encryptionManager",void 0),E(this,"_callId",void 0),E(this,"logger",void 0),E(this,"expiryTimeout",void 0),E(this,"statistics",{counters:{roomEventEncryptionKeysSent:0,roomEventEncryptionKeysReceived:0},totals:{roomEventEncryptionKeysReceivedTotalAge:0}}),E(this,"reEmitter",new kf(this)),E(this,"onRoomMemberUpdate",()=>{this.recalculateSessionMembers()}),E(this,"onRTCSessionMemberUpdate",()=>{this.recalculateSessionMembers()}),E(this,"recalculateSessionMembers",()=>{var o,s,l,c=this.memberships;this.memberships=Dd.callMembershipsForRoom(this.room),this._callId=(o=this._callId)!==null&&o!==void 0?o:(s=this.memberships[0])===null||s===void 0?void 0:s.callId;var d=c.length!=this.memberships.length||c.some((p,m)=>!vk.equal(p,this.memberships[m]));if(d){var h;this.logger.info("Memberships for call in room ".concat(this.roomSubset.roomId," have changed: emitting")),dce(this.logger,"emit MatrixRTCSessionEvent.MembershipsChanged",()=>{this.emit(Nl.MembershipsChanged,c,this.memberships)}),(h=this.membershipManager)===null||h===void 0||h.onRTCSessionMemberUpdate(this.memberships)}(l=this.encryptionManager)===null||l===void 0||l.onMembershipsUpdate(c),this.setExpiryTimer()}),this.logger=U.getChild("[MatrixRTCSession ".concat(r.roomId,"]")),this._callId=(i=n[0])===null||i===void 0?void 0:i.callId;var a=this.roomSubset.getLiveTimeline().getState(Be.FORWARDS);a==null||a.on(dt.Members,this.onRoomMemberUpdate),this.setExpiryTimer()}isJoined(){var e,r;return(e=(r=this.membershipManager)===null||r===void 0?void 0:r.isJoined())!==null&&e!==void 0?e:!1}stop(){var e=this;return K(function*(){var r;yield(r=e.membershipManager)===null||r===void 0?void 0:r.leave(1e3),e.expiryTimeout&&(clearTimeout(e.expiryTimeout),e.expiryTimeout=void 0);var n=e.roomSubset.getLiveTimeline().getState(Be.FORWARDS);n==null||n.off(dt.Members,e.onRoomMemberUpdate)})()}joinRoomSession(e,r,n){if(this.isJoined()){this.logger.info("Already joined to session in room ".concat(this.roomSubset.roomId,": ignoring join call"));return}else{var i;(i=n==null?void 0:n.useNewMembershipManager)!==null&&i!==void 0&&i?this.membershipManager=new N0(n,this.roomSubset,this.client,()=>this.getOldestMembership(),this.logger):this.membershipManager=new wme(n,this.roomSubset,this.client,()=>this.getOldestMembership());var a;if(n!=null&&n.useExperimentalToDeviceTransport){this.logger.info("Using to-device with room fallback transport for encryption keys");var[o,s]=[this.client.getUserId(),this.client.getDeviceId()],[l,c,d]=[this.roomSubset,this.client,this.statistics],h=new yk(l,c,d),p=new Eme(o,s,l.roomId,c,d);a=new HV(p,h,this.logger),this.reEmitter.reEmit(a,[h3.EnabledTransportsChanged])}else a=new yk(this.roomSubset,this.client,this.statistics);this.encryptionManager=new _me(this.client.getUserId(),this.client.getDeviceId(),()=>this.memberships,a,this.statistics,(m,g,y)=>{this.emit(Nl.EncryptionKeyChanged,m,g,y)},this.logger)}this.membershipManager.join(e,r,m=>{this.logger.error("MembershipManager encountered an unrecoverable error: ",m),this.emit(Nl.MembershipManagerError,m),this.emit(Nl.JoinStateChanged,this.isJoined())}),this.encryptionManager.join(n),this.emit(Nl.JoinStateChanged,!0)}leaveRoomSession(){var e=arguments,r=this;return K(function*(){var n=e.length>0&&e[0]!==void 0?e[0]:void 0;if(!r.isJoined())return r.logger.info("Not joined to session in room ".concat(r.roomSubset.roomId,": ignoring leave call")),!1;r.logger.info("Leaving call session in room ".concat(r.roomSubset.roomId)),r.encryptionManager.leave();var i=r.membershipManager.leave(n);return r.emit(Nl.JoinStateChanged,!1),yield i})()}getActiveFocus(){var e;return(e=this.membershipManager)===null||e===void 0?void 0:e.getActiveFocus()}getOldestMembership(){return this.memberships[0]}getFocusInUse(){var e=this.getOldestMembership();if((e==null?void 0:e.getFocusSelection())==="oldest_membership")return e.getPreferredFoci()[0]}reemitEncryptionKeys(){var e;(e=this.encryptionManager)===null||e===void 0||e.getEncryptionKeys().forEach((r,n)=>{r.forEach((i,a)=>{this.emit(Nl.EncryptionKeyChanged,i.key,a,n)})})}getEncryptionKeys(){var e,r,n=(e=(r=this.encryptionManager)===null||r===void 0?void 0:r.getEncryptionKeys())!==null&&e!==void 0?e:new Map;return Array.from(n.entries()).map(i=>{var[a,o]=i;return[a,o.map(s=>s.key)]}).values()}setExpiryTimer(){this.expiryTimeout&&(clearTimeout(this.expiryTimeout),this.expiryTimeout=void 0);var e;for(var r of this.memberships){var n=r.getMsUntilExpiry();n!==void 0&&(e===void 0||n<e)&&(e=n)}e!=null&&(this.expiryTimeout=setTimeout(this.onRTCSessionMemberUpdate,e))}}var bk=function(t){return t.SessionStarted="session_started",t.SessionEnded="session_ended",t}({});class xme extends nr{constructor(e){super(),this.client=e,E(this,"roomSessions",new Map),E(this,"logger",void 0),E(this,"onRoom",r=>{this.refreshRoom(r)}),E(this,"onRoomState",(r,n)=>{var i=this.client.getRoom(r.getRoomId());if(!i){this.logger.error("Got room state event for unknown room ".concat(r.getRoomId(),"!"));return}r.getType()==ge.GroupCallMemberPrefix&&this.refreshRoom(i)}),this.logger=U.getChild("[MatrixRTCSessionManager]")}start(){for(var e of(r=this.client.getRooms())!==null&&r!==void 0?r:[]){var r,n=Dd.roomSessionForRoom(this.client,e);n.memberships.length>0&&this.roomSessions.set(e.roomId,n)}this.client.on(je.Room,this.onRoom),this.client.on(dt.Events,this.onRoomState)}stop(){for(var e of this.roomSessions.values())e.stop();this.roomSessions.clear(),this.client.off(je.Room,this.onRoom),this.client.off(dt.Events,this.onRoomState)}getActiveRoomSession(e){return this.roomSessions.get(e.roomId)}getRoomSession(e){return this.roomSessions.has(e.roomId)||this.roomSessions.set(e.roomId,Dd.roomSessionForRoom(this.client,e)),this.roomSessions.get(e.roomId)}refreshRoom(e){var r=!this.roomSessions.has(e.roomId),n=this.getRoomSession(e),i=n.memberships.length>0&&!r;n.onRTCSessionMemberUpdate();var a=n.memberships.length>0;i&&!a?(this.logger.trace("Session ended for ".concat(e.roomId," (").concat(n.memberships.length," members)")),this.emit(bk.SessionEnded,e.roomId,this.roomSessions.get(e.roomId))):!i&&a&&(this.logger.trace("Session started for ".concat(e.roomId," (").concat(n.memberships.length," members)")),this.emit(bk.SessionStarted,e.roomId,this.roomSessions.get(e.roomId)))}}function $w(t){return e=>{var r,n;return((r=e.content)===null||r===void 0||(r=r["m.relates_to"])===null||r===void 0?void 0:r.event_id)!==t||((n=e.content)===null||n===void 0||(n=n["m.relates_to"])===null||n===void 0?void 0:n.rel_type)===jt.name}}function WV(t){return rC.apply(this,arguments)}function rC(){return rC=K(function*(t){if(!globalThis.crypto.subtle)throw new Error("Crypto.subtle is not available: insecure context?");var e=new TextEncoder().encode(t),r=yield globalThis.crypto.subtle.digest("SHA-256",e);return new Uint8Array(r)}),rC.apply(this,arguments)}class Uh extends Error{}Uh.prototype.name="InvalidTokenError";function Cme(t){return decodeURIComponent(atob(t).replace(/(.)/g,(e,r)=>{let n=r.charCodeAt(0).toString(16).toUpperCase();return n.length<2&&(n="0"+n),"%"+n}))}function Tme(t){let e=t.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return Cme(e)}catch{return atob(e)}}function GV(t,e){if(typeof t!="string")throw new Uh("Invalid token specified: must be a string");e||(e={});const r=e.header===!0?0:1,n=t.split(".")[r];if(typeof n!="string")throw new Uh(`Invalid token specified: missing part #${r+1}`);let i;try{i=Tme(n)}catch(a){throw new Uh(`Invalid token specified: invalid base64 for part #${r+1} (${a.message})`)}try{return JSON.parse(i)}catch(a){throw new Uh(`Invalid token specified: invalid json for part #${r+1} (${a.message})`)}}var Dme={debug:()=>{},info:()=>{},warn:()=>{},error:()=>{}},Va,za,lm=(t=>(t[t.NONE=0]="NONE",t[t.ERROR=1]="ERROR",t[t.WARN=2]="WARN",t[t.INFO=3]="INFO",t[t.DEBUG=4]="DEBUG",t))(lm||{});(t=>{function e(){Va=3,za=Dme}t.reset=e;function r(i){if(!(0<=i&&i<=4))throw new Error("Invalid log level");Va=i}t.setLevel=r;function n(i){za=i}t.setLogger=n})(lm||(lm={}));var Dr=class Fa{constructor(e){this._name=e}debug(...e){Va>=4&&za.debug(Fa._format(this._name,this._method),...e)}info(...e){Va>=3&&za.info(Fa._format(this._name,this._method),...e)}warn(...e){Va>=2&&za.warn(Fa._format(this._name,this._method),...e)}error(...e){Va>=1&&za.error(Fa._format(this._name,this._method),...e)}throw(e){throw this.error(e),e}create(e){const r=Object.create(this);return r._method=e,r.debug("begin"),r}static createStatic(e,r){const n=new Fa(`${e}.${r}`);return n.debug("begin"),n}static _format(e,r){const n=`[${e}]`;return r?`${n} ${r}:`:n}static debug(e,...r){Va>=4&&za.debug(Fa._format(e),...r)}static info(e,...r){Va>=3&&za.info(Fa._format(e),...r)}static warn(e,...r){Va>=2&&za.warn(Fa._format(e),...r)}static error(e,...r){Va>=1&&za.error(Fa._format(e),...r)}};lm.reset();var U0=class{static decode(t){try{return GV(t)}catch(e){throw Dr.error("JwtUtils.decode",e),e}}static async generateSignedJwt(t,e,r){const n=wa.encodeBase64Url(new TextEncoder().encode(JSON.stringify(t))),i=wa.encodeBase64Url(new TextEncoder().encode(JSON.stringify(e))),a=`${n}.${i}`,o=await window.crypto.subtle.sign({name:"ECDSA",hash:{name:"SHA-256"}},r,new TextEncoder().encode(a)),s=wa.encodeBase64Url(new Uint8Array(o));return`${a}.${s}`}},Rme="10000000-1000-4000-8000-100000000000",nC=t=>btoa([...new Uint8Array(t)].map(e=>String.fromCharCode(e)).join("")),qV=class ja{static _randomWord(){const e=new Uint32Array(1);return crypto.getRandomValues(e),e[0]}static generateUUIDv4(){return Rme.replace(/[018]/g,r=>(+r^ja._randomWord()&15>>+r/4).toString(16)).replace(/-/g,"")}static generateCodeVerifier(){return ja.generateUUIDv4()+ja.generateUUIDv4()+ja.generateUUIDv4()}static async generateCodeChallenge(e){if(!crypto.subtle)throw new Error("Crypto.subtle is available only in secure contexts (HTTPS).");try{const n=new TextEncoder().encode(e),i=await crypto.subtle.digest("SHA-256",n);return nC(i).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}catch(r){throw Dr.error("CryptoUtils.generateCodeChallenge",r),r}}static generateBasicAuth(e,r){const i=new TextEncoder().encode([e,r].join(":"));return nC(i)}static async hash(e,r){const n=new TextEncoder().encode(r),i=await crypto.subtle.digest(e,n);return new Uint8Array(i)}static async customCalculateJwkThumbprint(e){let r;switch(e.kty){case"RSA":r={e:e.e,kty:e.kty,n:e.n};break;case"EC":r={crv:e.crv,kty:e.kty,x:e.x,y:e.y};break;case"OKP":r={crv:e.crv,kty:e.kty,x:e.x};break;case"oct":r={crv:e.k,kty:e.kty};break;default:throw new Error("Unknown jwk type")}const n=await ja.hash("SHA-256",JSON.stringify(r));return ja.encodeBase64Url(n)}static async generateDPoPProof({url:e,accessToken:r,httpMethod:n,keyPair:i,nonce:a}){let o,s;const l={jti:window.crypto.randomUUID(),htm:n??"GET",htu:e,iat:Math.floor(Date.now()/1e3)};r&&(o=await ja.hash("SHA-256",r),s=ja.encodeBase64Url(o),l.ath=s),a&&(l.nonce=a);try{const c=await crypto.subtle.exportKey("jwk",i.publicKey),d={alg:"ES256",typ:"dpop+jwt",jwk:{crv:c.crv,kty:c.kty,x:c.x,y:c.y}};return await U0.generateSignedJwt(d,l,i.privateKey)}catch(c){throw c instanceof TypeError?new Error(`Error exporting dpop public key: ${c.message}`):c}}static async generateDPoPJkt(e){try{const r=await crypto.subtle.exportKey("jwk",e.publicKey);return await ja.customCalculateJwkThumbprint(r)}catch(r){throw r instanceof TypeError?new Error(`Could not retrieve dpop keys from storage: ${r.message}`):r}}static async generateDPoPKeys(){return await window.crypto.subtle.generateKey({name:"ECDSA",namedCurve:"P-256"},!1,["sign","verify"])}};qV.encodeBase64Url=t=>nC(t).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_");var wa=qV,Mme=class{constructor(e){this._name=e,this._callbacks=[],this._logger=new Dr(`Event('${this._name}')`)}addHandler(e){return this._callbacks.push(e),()=>this.removeHandler(e)}removeHandler(e){const r=this._callbacks.lastIndexOf(e);r>=0&&this._callbacks.splice(r,1)}async raise(...e){this._logger.debug("raise:",...e);for(const r of this._callbacks)await r(...e)}},F0=class oy extends Mme{constructor(){super(...arguments),this._logger=new Dr(`Timer('${this._name}')`),this._timerHandle=null,this._expiration=0,this._callback=()=>{const e=this._expiration-oy.getEpochTime();this._logger.debug("timer completes in",e),this._expiration<=oy.getEpochTime()&&(this.cancel(),super.raise())}}static getEpochTime(){return Math.floor(Date.now()/1e3)}init(e){const r=this._logger.create("init");e=Math.max(Math.floor(e),1);const n=oy.getEpochTime()+e;if(this.expiration===n&&this._timerHandle){r.debug("skipping since already initialized for expiration at",this.expiration);return}this.cancel(),r.debug("using duration",e),this._expiration=n;const i=Math.min(e,5);this._timerHandle=setInterval(this._callback,i*1e3)}get expiration(){return this._expiration}cancel(){this._logger.create("cancel"),this._timerHandle&&(clearInterval(this._timerHandle),this._timerHandle=null)}},_k=class{static readParams(t,e="query"){if(!t)throw new TypeError("Invalid URL");const n=new URL(t,"http://127.0.0.1")[e==="fragment"?"hash":"search"];return new URLSearchParams(n.slice(1))}},af=";",of=class extends Error{constructor(t,e){var r,n,i;if(super(t.error_description||t.error||""),this.form=e,this.name="ErrorResponse",!t.error)throw Dr.error("ErrorResponse","No error passed"),new Error("No error passed");this.error=t.error,this.error_description=(r=t.error_description)!=null?r:null,this.error_uri=(n=t.error_uri)!=null?n:null,this.state=t.userState,this.session_state=(i=t.session_state)!=null?i:null,this.url_state=t.url_state}},Ime=class extends Error{constructor(t){super(t),this.name="ErrorTimeout"}},Pme=class{constructor(){this._logger=new Dr("InMemoryWebStorage"),this._data={}}clear(){this._logger.create("clear"),this._data={}}getItem(t){return this._logger.create(`getItem('${t}')`),this._data[t]}setItem(t,e){this._logger.create(`setItem('${t}')`),this._data[t]=e}removeItem(t){this._logger.create(`removeItem('${t}')`),delete this._data[t]}get length(){return Object.getOwnPropertyNames(this._data).length}key(t){return Object.getOwnPropertyNames(this._data)[t]}},iC=class extends Error{constructor(t,e){super(e),this.name="ErrorDPoPNonce",this.nonce=t}},p3=class{constructor(t=[],e=null,r={}){this._jwtHandler=e,this._extraHeaders=r,this._logger=new Dr("JsonService"),this._contentTypes=[],this._contentTypes.push(...t,"application/json"),e&&this._contentTypes.push("application/jwt")}async fetchWithTimeout(t,e={}){const{timeoutInSeconds:r,...n}=e;if(!r)return await fetch(t,n);const i=new AbortController,a=setTimeout(()=>i.abort(),r*1e3);try{return await fetch(t,{...e,signal:i.signal})}catch(o){throw o instanceof DOMException&&o.name==="AbortError"?new Ime("Network timed out"):o}finally{clearTimeout(a)}}async getJson(t,{token:e,credentials:r,timeoutInSeconds:n}={}){const i=this._logger.create("getJson"),a={Accept:this._contentTypes.join(", ")};e&&(i.debug("token passed, setting Authorization header"),a.Authorization="Bearer "+e),this._appendExtraHeaders(a);let o;try{i.debug("url:",t),o=await this.fetchWithTimeout(t,{method:"GET",headers:a,timeoutInSeconds:n,credentials:r})}catch(c){throw i.error("Network Error"),c}i.debug("HTTP response received, status",o.status);const s=o.headers.get("Content-Type");if(s&&!this._contentTypes.find(c=>s.startsWith(c))&&i.throw(new Error(`Invalid response Content-Type: ${s??"undefined"}, from URL: ${t}`)),o.ok&&this._jwtHandler&&(s!=null&&s.startsWith("application/jwt")))return await this._jwtHandler(await o.text());let l;try{l=await o.json()}catch(c){throw i.error("Error parsing JSON response",c),o.ok?c:new Error(`${o.statusText} (${o.status})`)}if(!o.ok)throw i.error("Error from server:",l),l.error?new of(l):new Error(`${o.statusText} (${o.status}): ${JSON.stringify(l)}`);return l}async postForm(t,{body:e,basicAuth:r,timeoutInSeconds:n,initCredentials:i,extraHeaders:a}){const o=this._logger.create("postForm"),s={Accept:this._contentTypes.join(", "),"Content-Type":"application/x-www-form-urlencoded",...a};r!==void 0&&(s.Authorization="Basic "+r),this._appendExtraHeaders(s);let l;try{o.debug("url:",t),l=await this.fetchWithTimeout(t,{method:"POST",headers:s,body:e,timeoutInSeconds:n,credentials:i})}catch(p){throw o.error("Network error"),p}o.debug("HTTP response received, status",l.status);const c=l.headers.get("Content-Type");if(c&&!this._contentTypes.find(p=>c.startsWith(p)))throw new Error(`Invalid response Content-Type: ${c??"undefined"}, from URL: ${t}`);const d=await l.text();let h={};if(d)try{h=JSON.parse(d)}catch(p){throw o.error("Error parsing JSON response",p),l.ok?p:new Error(`${l.statusText} (${l.status})`)}if(!l.ok){if(o.error("Error from server:",h),l.headers.has("dpop-nonce")){const p=l.headers.get("dpop-nonce");throw new iC(p,`${JSON.stringify(h)}`)}throw h.error?new of(h,e):new Error(`${l.statusText} (${l.status}): ${JSON.stringify(h)}`)}return h}_appendExtraHeaders(t){const e=this._logger.create("appendExtraHeaders"),r=Object.keys(this._extraHeaders),n=["accept","content-type"],i=["authorization"];r.length!==0&&r.forEach(a=>{if(n.includes(a.toLocaleLowerCase())){e.warn("Protected header could not be set",a,n);return}if(i.includes(a.toLocaleLowerCase())&&Object.keys(t).includes(a)){e.warn("Header could not be overridden",a,i);return}const o=typeof this._extraHeaders[a]=="function"?this._extraHeaders[a]():this._extraHeaders[a];o&&o!==""&&(t[a]=o)})}},ZV=class{constructor(t){this._settings=t,this._logger=new Dr("MetadataService"),this._signingKeys=null,this._metadata=null,this._metadataUrl=this._settings.metadataUrl,this._jsonService=new p3(["application/jwk-set+json"],null,this._settings.extraHeaders),this._settings.signingKeys&&(this._logger.debug("using signingKeys from settings"),this._signingKeys=this._settings.signingKeys),this._settings.metadata&&(this._logger.debug("using metadata from settings"),this._metadata=this._settings.metadata),this._settings.fetchRequestCredentials&&(this._logger.debug("using fetchRequestCredentials from settings"),this._fetchRequestCredentials=this._settings.fetchRequestCredentials)}resetSigningKeys(){this._signingKeys=null}async getMetadata(){const t=this._logger.create("getMetadata");if(this._metadata)return t.debug("using cached values"),this._metadata;if(!this._metadataUrl)throw t.throw(new Error("No authority or metadataUrl configured on settings")),null;t.debug("getting metadata from",this._metadataUrl);const e=await this._jsonService.getJson(this._metadataUrl,{credentials:this._fetchRequestCredentials,timeoutInSeconds:this._settings.requestTimeoutInSeconds});return t.debug("merging remote JSON with seed metadata"),this._metadata=Object.assign({},e,this._settings.metadataSeed),this._metadata}getIssuer(){return this._getMetadataProperty("issuer")}getAuthorizationEndpoint(){return this._getMetadataProperty("authorization_endpoint")}getUserInfoEndpoint(){return this._getMetadataProperty("userinfo_endpoint")}getTokenEndpoint(t=!0){return this._getMetadataProperty("token_endpoint",t)}getCheckSessionIframe(){return this._getMetadataProperty("check_session_iframe",!0)}getEndSessionEndpoint(){return this._getMetadataProperty("end_session_endpoint",!0)}getRevocationEndpoint(t=!0){return this._getMetadataProperty("revocation_endpoint",t)}getKeysEndpoint(t=!0){return this._getMetadataProperty("jwks_uri",t)}async _getMetadataProperty(t,e=!1){const r=this._logger.create(`_getMetadataProperty('${t}')`),n=await this.getMetadata();if(r.debug("resolved"),n[t]===void 0){if(e===!0){r.warn("Metadata does not contain optional property");return}r.throw(new Error("Metadata does not contain property "+t))}return n[t]}async getSigningKeys(){const t=this._logger.create("getSigningKeys");if(this._signingKeys)return t.debug("returning signingKeys from cache"),this._signingKeys;const e=await this.getKeysEndpoint(!1);t.debug("got jwks_uri",e);const r=await this._jsonService.getJson(e,{timeoutInSeconds:this._settings.requestTimeoutInSeconds});if(t.debug("got key set",r),!Array.isArray(r.keys))throw t.throw(new Error("Missing keys on keyset")),null;return this._signingKeys=r.keys,this._signingKeys}},r_=class{constructor({prefix:t="oidc.",store:e=localStorage}={}){this._logger=new Dr("WebStorageStateStore"),this._store=e,this._prefix=t}async set(t,e){this._logger.create(`set('${t}')`),t=this._prefix+t,await this._store.setItem(t,e)}async get(t){return this._logger.create(`get('${t}')`),t=this._prefix+t,await this._store.getItem(t)}async remove(t){this._logger.create(`remove('${t}')`),t=this._prefix+t;const e=await this._store.getItem(t);return await this._store.removeItem(t),e}async getAllKeys(){this._logger.create("getAllKeys");const t=await this._store.length,e=[];for(let r=0;r<t;r++){const n=await this._store.key(r);n&&n.indexOf(this._prefix)===0&&e.push(n.substr(this._prefix.length))}return e}},Ame="code",kme="openid",Ome="client_secret_post",$me=60*15,aC=class{constructor({authority:t,metadataUrl:e,metadata:r,signingKeys:n,metadataSeed:i,client_id:a,client_secret:o,response_type:s=Ame,scope:l=kme,redirect_uri:c,post_logout_redirect_uri:d,client_authentication:h=Ome,prompt:p,display:m,max_age:g,ui_locales:y,acr_values:R,resource:b,response_mode:_,filterProtocolClaims:x=!0,loadUserInfo:T=!1,requestTimeoutInSeconds:I,staleStateAgeInSeconds:C=$me,mergeClaimsStrategy:k={array:"replace"},disablePKCE:S=!1,stateStore:V,revokeTokenAdditionalContentTypes:z,fetchRequestCredentials:j,refreshTokenAllowedScope:J,extraQueryParams:$={},extraTokenParams:le={},extraHeaders:ie={},dpop:Z,omitScopeWhenRequesting:te=!1}){var H;if(this.authority=t,e?this.metadataUrl=e:(this.metadataUrl=t,t&&(this.metadataUrl.endsWith("/")||(this.metadataUrl+="/"),this.metadataUrl+=".well-known/openid-configuration")),this.metadata=r,this.metadataSeed=i,this.signingKeys=n,this.client_id=a,this.client_secret=o,this.response_type=s,this.scope=l,this.redirect_uri=c,this.post_logout_redirect_uri=d,this.client_authentication=h,this.prompt=p,this.display=m,this.max_age=g,this.ui_locales=y,this.acr_values=R,this.resource=b,this.response_mode=_,this.filterProtocolClaims=x??!0,this.loadUserInfo=!!T,this.staleStateAgeInSeconds=C,this.mergeClaimsStrategy=k,this.omitScopeWhenRequesting=te,this.disablePKCE=!!S,this.revokeTokenAdditionalContentTypes=z,this.fetchRequestCredentials=j||"same-origin",this.requestTimeoutInSeconds=I,V)this.stateStore=V;else{const fe=typeof window<"u"?window.localStorage:new Pme;this.stateStore=new r_({store:fe})}if(this.refreshTokenAllowedScope=J,this.extraQueryParams=$,this.extraTokenParams=le,this.extraHeaders=ie,this.dpop=Z,this.dpop&&!((H=this.dpop)!=null&&H.store))throw new Error("A DPoPStore is required when dpop is enabled")}},Lme=class{constructor(t,e){this._settings=t,this._metadataService=e,this._logger=new Dr("UserInfoService"),this._getClaimsFromJwt=async r=>{const n=this._logger.create("_getClaimsFromJwt");try{const i=U0.decode(r);return n.debug("JWT decoding successful"),i}catch(i){throw n.error("Error parsing JWT response"),i}},this._jsonService=new p3(void 0,this._getClaimsFromJwt,this._settings.extraHeaders)}async getClaims(t){const e=this._logger.create("getClaims");t||this._logger.throw(new Error("No token passed"));const r=await this._metadataService.getUserInfoEndpoint();e.debug("got userinfo url",r);const n=await this._jsonService.getJson(r,{token:t,credentials:this._settings.fetchRequestCredentials,timeoutInSeconds:this._settings.requestTimeoutInSeconds});return e.debug("got claims",n),n}},YV=class{constructor(t,e){this._settings=t,this._metadataService=e,this._logger=new Dr("TokenClient"),this._jsonService=new p3(this._settings.revokeTokenAdditionalContentTypes,null,this._settings.extraHeaders)}async exchangeCode({grant_type:t="authorization_code",redirect_uri:e=this._settings.redirect_uri,client_id:r=this._settings.client_id,client_secret:n=this._settings.client_secret,extraHeaders:i,...a}){const o=this._logger.create("exchangeCode");r||o.throw(new Error("A client_id is required")),e||o.throw(new Error("A redirect_uri is required")),a.code||o.throw(new Error("A code is required"));const s=new URLSearchParams({grant_type:t,redirect_uri:e});for(const[h,p]of Object.entries(a))p!=null&&s.set(h,p);let l;switch(this._settings.client_authentication){case"client_secret_basic":if(n==null)throw o.throw(new Error("A client_secret is required")),null;l=wa.generateBasicAuth(r,n);break;case"client_secret_post":s.append("client_id",r),n&&s.append("client_secret",n);break}const c=await this._metadataService.getTokenEndpoint(!1);o.debug("got token endpoint");const d=await this._jsonService.postForm(c,{body:s,basicAuth:l,timeoutInSeconds:this._settings.requestTimeoutInSeconds,initCredentials:this._settings.fetchRequestCredentials,extraHeaders:i});return o.debug("got response"),d}async exchangeCredentials({grant_type:t="password",client_id:e=this._settings.client_id,client_secret:r=this._settings.client_secret,scope:n=this._settings.scope,...i}){const a=this._logger.create("exchangeCredentials");e||a.throw(new Error("A client_id is required"));const o=new URLSearchParams({grant_type:t});this._settings.omitScopeWhenRequesting||o.set("scope",n);for(const[d,h]of Object.entries(i))h!=null&&o.set(d,h);let s;switch(this._settings.client_authentication){case"client_secret_basic":if(r==null)throw a.throw(new Error("A client_secret is required")),null;s=wa.generateBasicAuth(e,r);break;case"client_secret_post":o.append("client_id",e),r&&o.append("client_secret",r);break}const l=await this._metadataService.getTokenEndpoint(!1);a.debug("got token endpoint");const c=await this._jsonService.postForm(l,{body:o,basicAuth:s,timeoutInSeconds:this._settings.requestTimeoutInSeconds,initCredentials:this._settings.fetchRequestCredentials});return a.debug("got response"),c}async exchangeRefreshToken({grant_type:t="refresh_token",client_id:e=this._settings.client_id,client_secret:r=this._settings.client_secret,timeoutInSeconds:n,extraHeaders:i,...a}){const o=this._logger.create("exchangeRefreshToken");e||o.throw(new Error("A client_id is required")),a.refresh_token||o.throw(new Error("A refresh_token is required"));const s=new URLSearchParams({grant_type:t});for(const[h,p]of Object.entries(a))Array.isArray(p)?p.forEach(m=>s.append(h,m)):p!=null&&s.set(h,p);let l;switch(this._settings.client_authentication){case"client_secret_basic":if(r==null)throw o.throw(new Error("A client_secret is required")),null;l=wa.generateBasicAuth(e,r);break;case"client_secret_post":s.append("client_id",e),r&&s.append("client_secret",r);break}const c=await this._metadataService.getTokenEndpoint(!1);o.debug("got token endpoint");const d=await this._jsonService.postForm(c,{body:s,basicAuth:l,timeoutInSeconds:n,initCredentials:this._settings.fetchRequestCredentials,extraHeaders:i});return o.debug("got response"),d}async revoke(t){var e;const r=this._logger.create("revoke");t.token||r.throw(new Error("A token is required"));const n=await this._metadataService.getRevocationEndpoint(!1);r.debug(`got revocation endpoint, revoking ${(e=t.token_type_hint)!=null?e:"default token type"}`);const i=new URLSearchParams;for(const[a,o]of Object.entries(t))o!=null&&i.set(a,o);i.set("client_id",this._settings.client_id),this._settings.client_secret&&i.set("client_secret",this._settings.client_secret),await this._jsonService.postForm(n,{body:i,timeoutInSeconds:this._settings.requestTimeoutInSeconds}),r.debug("got response")}},Bme=class{constructor(t,e,r){this._settings=t,this._metadataService=e,this._claimsService=r,this._logger=new Dr("ResponseValidator"),this._userInfoService=new Lme(this._settings,this._metadataService),this._tokenClient=new YV(this._settings,this._metadataService)}async validateSigninResponse(t,e,r){const n=this._logger.create("validateSigninResponse");this._processSigninState(t,e),n.debug("state processed"),await this._processCode(t,e,r),n.debug("code processed"),t.isOpenId&&this._validateIdTokenAttributes(t),n.debug("tokens validated"),await this._processClaims(t,e==null?void 0:e.skipUserInfo,t.isOpenId),n.debug("claims processed")}async validateCredentialsResponse(t,e){const r=this._logger.create("validateCredentialsResponse"),n=t.isOpenId&&!!t.id_token;n&&this._validateIdTokenAttributes(t),r.debug("tokens validated"),await this._processClaims(t,e,n),r.debug("claims processed")}async validateRefreshResponse(t,e){var r,n;const i=this._logger.create("validateRefreshResponse");t.userState=e.data,(r=t.session_state)!=null||(t.session_state=e.session_state),(n=t.scope)!=null||(t.scope=e.scope),t.isOpenId&&t.id_token&&(this._validateIdTokenAttributes(t,e.id_token),i.debug("ID Token validated")),t.id_token||(t.id_token=e.id_token,t.profile=e.profile);const a=t.isOpenId&&!!t.id_token;await this._processClaims(t,!1,a),i.debug("claims processed")}validateSignoutResponse(t,e){const r=this._logger.create("validateSignoutResponse");if(e.id!==t.state&&r.throw(new Error("State does not match")),r.debug("state validated"),t.userState=e.data,t.error)throw r.warn("Response was error",t.error),new of(t)}_processSigninState(t,e){var r;const n=this._logger.create("_processSigninState");if(e.id!==t.state&&n.throw(new Error("State does not match")),e.client_id||n.throw(new Error("No client_id on state")),e.authority||n.throw(new Error("No authority on state")),this._settings.authority!==e.authority&&n.throw(new Error("authority mismatch on settings vs. signin state")),this._settings.client_id&&this._settings.client_id!==e.client_id&&n.throw(new Error("client_id mismatch on settings vs. signin state")),n.debug("state validated"),t.userState=e.data,t.url_state=e.url_state,(r=t.scope)!=null||(t.scope=e.scope),t.error)throw n.warn("Response was error",t.error),new of(t);e.code_verifier&&!t.code&&n.throw(new Error("Expected code in response"))}async _processClaims(t,e=!1,r=!0){const n=this._logger.create("_processClaims");if(t.profile=this._claimsService.filterProtocolClaims(t.profile),e||!this._settings.loadUserInfo||!t.access_token){n.debug("not loading user info");return}n.debug("loading user info");const i=await this._userInfoService.getClaims(t.access_token);n.debug("user info claims received from user info endpoint"),r&&i.sub!==t.profile.sub&&n.throw(new Error("subject from UserInfo response does not match subject in ID Token")),t.profile=this._claimsService.mergeClaims(t.profile,this._claimsService.filterProtocolClaims(i)),n.debug("user info claims received, updated profile:",t.profile)}async _processCode(t,e,r){const n=this._logger.create("_processCode");if(t.code){n.debug("Validating code");const i=await this._tokenClient.exchangeCode({client_id:e.client_id,client_secret:e.client_secret,code:t.code,redirect_uri:e.redirect_uri,code_verifier:e.code_verifier,extraHeaders:r,...e.extraTokenParams});Object.assign(t,i)}else n.debug("No code to process")}_validateIdTokenAttributes(t,e){var r;const n=this._logger.create("_validateIdTokenAttributes");n.debug("decoding ID Token JWT");const i=U0.decode((r=t.id_token)!=null?r:"");if(i.sub||n.throw(new Error("ID Token is missing a subject claim")),e){const a=U0.decode(e);i.sub!==a.sub&&n.throw(new Error("sub in id_token does not match current sub")),i.auth_time&&i.auth_time!==a.auth_time&&n.throw(new Error("auth_time in id_token does not match original auth_time")),i.azp&&i.azp!==a.azp&&n.throw(new Error("azp in id_token does not match original azp")),!i.azp&&a.azp&&n.throw(new Error("azp not in id_token, but present in original id_token"))}t.profile=i}},j0=class oC{constructor(e){this.id=e.id||wa.generateUUIDv4(),this.data=e.data,e.created&&e.created>0?this.created=e.created:this.created=F0.getEpochTime(),this.request_type=e.request_type,this.url_state=e.url_state}toStorageString(){return new Dr("State").create("toStorageString"),JSON.stringify({id:this.id,data:this.data,created:this.created,request_type:this.request_type,url_state:this.url_state})}static fromStorageString(e){return Dr.createStatic("State","fromStorageString"),Promise.resolve(new oC(JSON.parse(e)))}static async clearStaleState(e,r){const n=Dr.createStatic("State","clearStaleState"),i=F0.getEpochTime()-r,a=await e.getAllKeys();n.debug("got keys",a);for(let o=0;o<a.length;o++){const s=a[o],l=await e.get(s);let c=!1;if(l)try{const d=await oC.fromStorageString(l);n.debug("got item from key:",s,d.created),d.created<=i&&(c=!0)}catch(d){n.error("Error parsing state for key:",s,d),c=!0}else n.debug("no item in storage for key:",s),c=!0;c&&(n.debug("removed item for key:",s),e.remove(s))}}},m3=class sC extends j0{constructor(e){super(e),this.code_verifier=e.code_verifier,this.code_challenge=e.code_challenge,this.authority=e.authority,this.client_id=e.client_id,this.redirect_uri=e.redirect_uri,this.scope=e.scope,this.client_secret=e.client_secret,this.extraTokenParams=e.extraTokenParams,this.response_mode=e.response_mode,this.skipUserInfo=e.skipUserInfo}static async create(e){const r=e.code_verifier===!0?wa.generateCodeVerifier():e.code_verifier||void 0,n=r?await wa.generateCodeChallenge(r):void 0;return new sC({...e,code_verifier:r,code_challenge:n})}toStorageString(){return new Dr("SigninState").create("toStorageString"),JSON.stringify({id:this.id,data:this.data,created:this.created,request_type:this.request_type,url_state:this.url_state,code_verifier:this.code_verifier,authority:this.authority,client_id:this.client_id,redirect_uri:this.redirect_uri,scope:this.scope,client_secret:this.client_secret,extraTokenParams:this.extraTokenParams,response_mode:this.response_mode,skipUserInfo:this.skipUserInfo})}static fromStorageString(e){Dr.createStatic("SigninState","fromStorageString");const r=JSON.parse(e);return sC.create(r)}},JV=class XV{constructor(e){this.url=e.url,this.state=e.state}static async create({url:e,authority:r,client_id:n,redirect_uri:i,response_type:a,scope:o,state_data:s,response_mode:l,request_type:c,client_secret:d,nonce:h,url_state:p,resource:m,skipUserInfo:g,extraQueryParams:y,extraTokenParams:R,disablePKCE:b,dpopJkt:_,omitScopeWhenRequesting:x,...T}){if(!e)throw this._logger.error("create: No url passed"),new Error("url");if(!n)throw this._logger.error("create: No client_id passed"),new Error("client_id");if(!i)throw this._logger.error("create: No redirect_uri passed"),new Error("redirect_uri");if(!a)throw this._logger.error("create: No response_type passed"),new Error("response_type");if(!o)throw this._logger.error("create: No scope passed"),new Error("scope");if(!r)throw this._logger.error("create: No authority passed"),new Error("authority");const I=await m3.create({data:s,request_type:c,url_state:p,code_verifier:!b,client_id:n,authority:r,redirect_uri:i,response_mode:l,client_secret:d,scope:o,extraTokenParams:R,skipUserInfo:g}),C=new URL(e);C.searchParams.append("client_id",n),C.searchParams.append("redirect_uri",i),C.searchParams.append("response_type",a),x||C.searchParams.append("scope",o),h&&C.searchParams.append("nonce",h),_&&C.searchParams.append("dpop_jkt",_);let k=I.id;p&&(k=`${k}${af}${p}`),C.searchParams.append("state",k),I.code_challenge&&(C.searchParams.append("code_challenge",I.code_challenge),C.searchParams.append("code_challenge_method","S256")),m&&(Array.isArray(m)?m:[m]).forEach(V=>C.searchParams.append("resource",V));for(const[S,V]of Object.entries({response_mode:l,...T,...y}))V!=null&&C.searchParams.append(S,V.toString());return new XV({url:C.href,state:I})}};JV._logger=new Dr("SigninRequest");var Nme=JV,Ume="openid",sy=class{constructor(t){if(this.access_token="",this.token_type="",this.profile={},this.state=t.get("state"),this.session_state=t.get("session_state"),this.state){const e=decodeURIComponent(this.state).split(af);this.state=e[0],e.length>1&&(this.url_state=e.slice(1).join(af))}this.error=t.get("error"),this.error_description=t.get("error_description"),this.error_uri=t.get("error_uri"),this.code=t.get("code")}get expires_in(){if(this.expires_at!==void 0)return this.expires_at-F0.getEpochTime()}set expires_in(t){typeof t=="string"&&(t=Number(t)),t!==void 0&&t>=0&&(this.expires_at=Math.floor(t)+F0.getEpochTime())}get isOpenId(){var t;return((t=this.scope)==null?void 0:t.split(" ").includes(Ume))||!!this.id_token}},Fme=class{constructor({url:t,state_data:e,id_token_hint:r,post_logout_redirect_uri:n,extraQueryParams:i,request_type:a,client_id:o,url_state:s}){if(this._logger=new Dr("SignoutRequest"),!t)throw this._logger.error("ctor: No url passed"),new Error("url");const l=new URL(t);if(r&&l.searchParams.append("id_token_hint",r),o&&l.searchParams.append("client_id",o),n&&(l.searchParams.append("post_logout_redirect_uri",n),e||s)){this.state=new j0({data:e,request_type:a,url_state:s});let c=this.state.id;s&&(c=`${c}${af}${s}`),l.searchParams.append("state",c)}for(const[c,d]of Object.entries({...i}))d!=null&&l.searchParams.append(c,d.toString());this.url=l.href}},jme=class{constructor(t){if(this.state=t.get("state"),this.state){const e=decodeURIComponent(this.state).split(af);this.state=e[0],e.length>1&&(this.url_state=e.slice(1).join(af))}this.error=t.get("error"),this.error_description=t.get("error_description"),this.error_uri=t.get("error_uri")}},Vme=["nbf","jti","auth_time","nonce","acr","amr","azp","at_hash"],zme=["sub","iss","aud","exp","iat"],Kme=class{constructor(t){this._settings=t,this._logger=new Dr("ClaimsService")}filterProtocolClaims(t){const e={...t};if(this._settings.filterProtocolClaims){let r;Array.isArray(this._settings.filterProtocolClaims)?r=this._settings.filterProtocolClaims:r=Vme;for(const n of r)zme.includes(n)||delete e[n]}return e}mergeClaims(t,e){const r={...t};for(const[n,i]of Object.entries(e))if(r[n]!==i)if(Array.isArray(r[n])||Array.isArray(i))if(this._settings.mergeClaimsStrategy.array=="replace")r[n]=i;else{const a=Array.isArray(r[n])?r[n]:[r[n]];for(const o of Array.isArray(i)?i:[i])a.includes(o)||a.push(o);r[n]=a}else typeof r[n]=="object"&&typeof i=="object"?r[n]=this.mergeClaims(r[n],i):r[n]=i;return r}},Hme=class{constructor(t,e){this.keys=t,this.nonce=e}},v3=class{constructor(t,e){this._logger=new Dr("OidcClient"),this.settings=t instanceof aC?t:new aC(t),this.metadataService=e??new ZV(this.settings),this._claimsService=new Kme(this.settings),this._validator=new Bme(this.settings,this.metadataService,this._claimsService),this._tokenClient=new YV(this.settings,this.metadataService)}async createSigninRequest({state:t,request:e,request_uri:r,request_type:n,id_token_hint:i,login_hint:a,skipUserInfo:o,nonce:s,url_state:l,response_type:c=this.settings.response_type,scope:d=this.settings.scope,redirect_uri:h=this.settings.redirect_uri,prompt:p=this.settings.prompt,display:m=this.settings.display,max_age:g=this.settings.max_age,ui_locales:y=this.settings.ui_locales,acr_values:R=this.settings.acr_values,resource:b=this.settings.resource,response_mode:_=this.settings.response_mode,extraQueryParams:x=this.settings.extraQueryParams,extraTokenParams:T=this.settings.extraTokenParams,dpopJkt:I,omitScopeWhenRequesting:C=this.settings.omitScopeWhenRequesting}){const k=this._logger.create("createSigninRequest");if(c!=="code")throw new Error("Only the Authorization Code flow (with PKCE) is supported");const S=await this.metadataService.getAuthorizationEndpoint();k.debug("Received authorization endpoint",S);const V=await Nme.create({url:S,authority:this.settings.authority,client_id:this.settings.client_id,redirect_uri:h,response_type:c,scope:d,state_data:t,url_state:l,prompt:p,display:m,max_age:g,ui_locales:y,id_token_hint:i,login_hint:a,acr_values:R,dpopJkt:I,resource:b,request:e,request_uri:r,extraQueryParams:x,extraTokenParams:T,request_type:n,response_mode:_,client_secret:this.settings.client_secret,skipUserInfo:o,nonce:s,disablePKCE:this.settings.disablePKCE,omitScopeWhenRequesting:C});await this.clearStaleState();const z=V.state;return await this.settings.stateStore.set(z.id,z.toStorageString()),V}async readSigninResponseState(t,e=!1){const r=this._logger.create("readSigninResponseState"),n=new sy(_k.readParams(t,this.settings.response_mode));if(!n.state)throw r.throw(new Error("No state in response")),null;const i=await this.settings.stateStore[e?"remove":"get"](n.state);if(!i)throw r.throw(new Error("No matching state found in storage")),null;return{state:await m3.fromStorageString(i),response:n}}async processSigninResponse(t,e,r=!0){const n=this._logger.create("processSigninResponse"),{state:i,response:a}=await this.readSigninResponseState(t,r);if(n.debug("received state from storage; validating response"),this.settings.dpop&&this.settings.dpop.store){const o=await this.getDpopProof(this.settings.dpop.store);e={...e,DPoP:o}}try{await this._validator.validateSigninResponse(a,i,e)}catch(o){if(o instanceof iC&&this.settings.dpop){const s=await this.getDpopProof(this.settings.dpop.store,o.nonce);e.DPoP=s,await this._validator.validateSigninResponse(a,i,e)}else throw o}return a}async getDpopProof(t,e){let r,n;return(await t.getAllKeys()).includes(this.settings.client_id)?(n=await t.get(this.settings.client_id),n.nonce!==e&&e&&(n.nonce=e,await t.set(this.settings.client_id,n))):(r=await wa.generateDPoPKeys(),n=new Hme(r,e),await t.set(this.settings.client_id,n)),await wa.generateDPoPProof({url:await this.metadataService.getTokenEndpoint(!1),httpMethod:"POST",keyPair:n.keys,nonce:n.nonce})}async processResourceOwnerPasswordCredentials({username:t,password:e,skipUserInfo:r=!1,extraTokenParams:n={}}){const i=await this._tokenClient.exchangeCredentials({username:t,password:e,...n}),a=new sy(new URLSearchParams);return Object.assign(a,i),await this._validator.validateCredentialsResponse(a,r),a}async useRefreshToken({state:t,redirect_uri:e,resource:r,timeoutInSeconds:n,extraHeaders:i,extraTokenParams:a}){var o;const s=this._logger.create("useRefreshToken");let l;if(this.settings.refreshTokenAllowedScope===void 0)l=t.scope;else{const h=this.settings.refreshTokenAllowedScope.split(" ");l=(((o=t.scope)==null?void 0:o.split(" "))||[]).filter(m=>h.includes(m)).join(" ")}if(this.settings.dpop&&this.settings.dpop.store){const h=await this.getDpopProof(this.settings.dpop.store);i={...i,DPoP:h}}let c;try{c=await this._tokenClient.exchangeRefreshToken({refresh_token:t.refresh_token,scope:l,redirect_uri:e,resource:r,timeoutInSeconds:n,extraHeaders:i,...a})}catch(h){if(h instanceof iC&&this.settings.dpop)i.DPoP=await this.getDpopProof(this.settings.dpop.store,h.nonce),c=await this._tokenClient.exchangeRefreshToken({refresh_token:t.refresh_token,scope:l,redirect_uri:e,resource:r,timeoutInSeconds:n,extraHeaders:i,...a});else throw h}const d=new sy(new URLSearchParams);return Object.assign(d,c),s.debug("validating response",d),await this._validator.validateRefreshResponse(d,{...t,scope:l}),d}async createSignoutRequest({state:t,id_token_hint:e,client_id:r,request_type:n,url_state:i,post_logout_redirect_uri:a=this.settings.post_logout_redirect_uri,extraQueryParams:o=this.settings.extraQueryParams}={}){const s=this._logger.create("createSignoutRequest"),l=await this.metadataService.getEndSessionEndpoint();if(!l)throw s.throw(new Error("No end session endpoint")),null;s.debug("Received end session endpoint",l),!r&&a&&!e&&(r=this.settings.client_id);const c=new Fme({url:l,id_token_hint:e,client_id:r,post_logout_redirect_uri:a,state_data:t,extraQueryParams:o,request_type:n,url_state:i});await this.clearStaleState();const d=c.state;return d&&(s.debug("Signout request has state to persist"),await this.settings.stateStore.set(d.id,d.toStorageString())),c}async readSignoutResponseState(t,e=!1){const r=this._logger.create("readSignoutResponseState"),n=new jme(_k.readParams(t,this.settings.response_mode));if(!n.state){if(r.debug("No state in response"),n.error)throw r.warn("Response was error:",n.error),new of(n);return{state:void 0,response:n}}const i=await this.settings.stateStore[e?"remove":"get"](n.state);if(!i)throw r.throw(new Error("No matching state found in storage")),null;return{state:await j0.fromStorageString(i),response:n}}async processSignoutResponse(t){const e=this._logger.create("processSignoutResponse"),{state:r,response:n}=await this.readSignoutResponseState(t,!0);return r?(e.debug("Received state from storage; validating response"),this._validator.validateSignoutResponse(n,r)):e.debug("No state from storage; skipping response validation"),n}clearStaleState(){return this._logger.create("clearStaleState"),j0.clearStaleState(this.settings.stateStore,this.settings.staleStateAgeInSeconds)}async revokeToken(t,e){return this._logger.create("revokeToken"),await this._tokenClient.revoke({token:t,token_type_hint:e})}},Sn=function(t){return t.NotSupported="OIDC authentication not supported",t.Misconfigured="OIDC is misconfigured",t.General="Something went wrong with OIDC discovery",t.OpSupport="Configured OIDC OP does not support required functions",t.DynamicRegistrationNotSupported="Dynamic registration not supported",t.DynamicRegistrationFailed="Dynamic registration failed",t.DynamicRegistrationInvalid="Dynamic registration invalid response",t.CodeExchangeFailed="Failed to exchange code for token",t.InvalidBearerTokenResponse="Invalid bearer token response",t.InvalidIdToken="Invalid ID token",t.MissingOrInvalidStoredState="State required to finish logging in is not found in storage.",t}({}),g3=t=>!!t&&typeof t=="object"&&!Array.isArray(t),Vo=(t,e)=>!t[e]||!vp(t,e)?(U.error("Missing or invalid property: ".concat(e)),!1):!0,vp=(t,e)=>t[e]&&typeof t[e]!="string"?(U.error("Invalid property: ".concat(e)),!1):!0,Sk=(t,e)=>t[e]&&(!Array.isArray(t[e])||!t[e].every(r=>typeof r=="string"))?(U.error("Invalid property: ".concat(e)),!1):!0,Lw=(t,e,r)=>{var n=t[e];return!n||!Array.isArray(n)||!n.includes(r)?(U.error("Invalid property: ".concat(e,". ").concat(r," is required.")),!1):!0},QV=t=>{if(!g3(t))throw U.error("Issuer configuration not found or malformed"),new Error(Sn.OpSupport);var e=[Vo(t,"issuer"),Vo(t,"authorization_endpoint"),Vo(t,"token_endpoint"),Vo(t,"revocation_endpoint"),vp(t,"registration_endpoint"),vp(t,"account_management_uri"),vp(t,"device_authorization_endpoint"),Sk(t,"account_management_actions_supported"),Lw(t,"response_types_supported","code"),Lw(t,"grant_types_supported","authorization_code"),Lw(t,"code_challenge_methods_supported","S256"),Sk(t,"prompt_values_supported")].some(r=>!r);if(!e)return t;throw U.error("Issuer configuration not valid"),new Error(Sn.OpSupport)},ez=t=>{try{return GV(t)}catch(e){throw U.error("Could not decode id_token",e),e}},tz=(t,e,r,n)=>{try{if(!t)throw new Error("No ID token");var i=ez(t);if(i.iss!==e)throw new Error("Invalid issuer");var a=typeof i.aud=="string"?[i.aud]:i.aud;if(!a.includes(r))throw new Error("Invalid audience");if(n!==void 0&&i.nonce!==n)throw new Error("Invalid nonce");if(!i.exp||Date.now()>i.exp*1e3)throw new Error("Invalid expiry")}catch(o){throw U.error("Invalid ID token",o),new Error(Sn.InvalidIdToken)}};function rz(t){if(!g3(t))throw U.error("Stored user state not found"),new Error(Sn.MissingOrInvalidStoredState);var e=[Vo(t,"homeserverUrl"),Vo(t,"nonce"),vp(t,"identityServerUrl")].some(r=>!r);if(e)throw new Error(Sn.MissingOrInvalidStoredState)}var Wme=t=>g3(t)&&Vo(t,"token_type")&&t.token_type.toLowerCase()==="bearer"&&Vo(t,"access_token")&&Vo(t,"refresh_token")&&(!("expires_in"in t)||typeof t.expires_in=="number");function nz(t){if(!Wme(t))throw new Error(Sn.InvalidBearerTokenResponse)}function wk(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function V0(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?wk(Object(r),!0).forEach(function(n){E(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):wk(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var n_=t=>{var e=t??al(10);return"openid urn:matrix:org.matrix.msc2967.client:api:* urn:matrix:org.matrix.msc2967.client:device:".concat(e)},Gme=function(){var t=K(function*(e){if(!globalThis.crypto.subtle)return U.warn("A secure context is required to generate code challenge. Using plain text code challenge"),e;var r=yield WV(e);return Qb(r)});return function(r){return t.apply(this,arguments)}}(),qme=t=>{var{redirectUri:e}=t;return{scope:n_(),redirectUri:e,state:al(8),nonce:al(8),codeVerifier:al(64)}},Zme=function(){var t=K(function*(e,r,n){var{scope:i,redirectUri:a,state:o,nonce:s,codeVerifier:l}=n,c=new URL(e);return c.searchParams.append("response_mode","query"),c.searchParams.append("response_type","code"),c.searchParams.append("redirect_uri",a),c.searchParams.append("client_id",r),c.searchParams.append("state",o),c.searchParams.append("scope",i),c.searchParams.append("nonce",s),c.searchParams.append("code_challenge_method","S256"),c.searchParams.append("code_challenge",yield Gme(l)),c.toString()});return function(r,n,i){return t.apply(this,arguments)}}(),Yme=function(){var t=K(function*(e){var{metadata:r,redirectUri:n,clientId:i,homeserverUrl:a,identityServerUrl:o,nonce:s,prompt:l,urlState:c}=e,d=n_(),h=new v3(V0(V0({},r),{},{client_id:i,redirect_uri:n,authority:r.issuer,response_mode:"query",response_type:"code",scope:d,stateStore:new r_({prefix:"mx_oidc_",store:window.sessionStorage})})),p={homeserverUrl:a,nonce:s,identityServerUrl:o},m=yield h.createSigninRequest({state:p,nonce:s,prompt:l,url_state:c});return m.url});return function(r){return t.apply(this,arguments)}}(),Jme=t=>({id_token:t.id_token,scope:t.scope,expires_at:t.expires_at,refresh_token:t.refresh_token,access_token:t.access_token,token_type:"Bearer"}),Xme=function(){var t=K(function*(e,r){var n=new URL(window.location.origin);n.searchParams.append("code",e),n.searchParams.append("state",r),lm.setLogger(U);try{var i=new sy(n.searchParams),a=new r_({prefix:"mx_oidc_",store:window.sessionStorage}),o=yield a.get(i.state);if(!o)throw new Error(Sn.MissingOrInvalidStoredState);var s=yield m3.fromStorageString(o),l=new v3(V0(V0({},s),{},{stateStore:a})),c=yield l.processSigninResponse(n.href),d=c.userState;rz(d),nz(c),tz(c.id_token,l.settings.authority,l.settings.client_id,d.nonce);var h=Jme(c);return{oidcClientSettings:{clientId:l.settings.client_id,issuer:l.settings.authority},tokenResponse:h,homeserverUrl:d.homeserverUrl,identityServerUrl:d.identityServerUrl,idTokenClaims:c.profile}}catch(m){U.error("Oidc login failed",m);var p=m.message;throw Object.values(Sn).includes(p)?m:new Error(Sn.CodeExchangeFailed)}});return function(r,n){return t.apply(this,arguments)}}();function Ek(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function xk(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Ek(Object(r),!0).forEach(function(n){E(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Ek(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var y3=function(){var t=K(function*(e){var r=new URL(".well-known/openid-configuration",e),n=yield fetch(r,{method:_e.Get,signal:Jb(5e3)}),i=yield n.json();return b3(i)});return function(r){return t.apply(this,arguments)}}(),b3=function(){var t=K(function*(e){var r=QV(e),n=new aC({authority:r.issuer,metadata:r,redirect_uri:"",client_id:""}),i=new ZV(n);return xk(xk({},r),{},{signingKeys:yield i.getSigningKeys()})});return function(r){return t.apply(this,arguments)}}(),Qme="urn:ietf:params:oauth:grant-type:device_code",Bw=(t,e)=>{if(!e)return!1;var r=new URL(e);return!(r.protocol!==t.protocol||r.hostname!==t.hostname&&!r.hostname.endsWith(".".concat(t.hostname)))},eve=function(){var t=K(function*(e,r){if(!e.registration_endpoint)throw new Error(Sn.DynamicRegistrationNotSupported);var n=["authorization_code","refresh_token"];if(n.some(d=>!e.grant_types_supported.includes(d)))throw new Error(Sn.DynamicRegistrationNotSupported);var i=new URL(r.clientUri),a={client_name:r.clientName,client_uri:r.clientUri,response_types:["code"],grant_types:n,redirect_uris:r.redirectUris,id_token_signed_response_alg:"RS256",token_endpoint_auth_method:"none",application_type:r.applicationType,contacts:r.contacts,logo_uri:Bw(i,r.logoUri)?r.logoUri:void 0,policy_uri:Bw(i,r.policyUri)?r.policyUri:void 0,tos_uri:Bw(i,r.tosUri)?r.tosUri:void 0},o={Accept:"application/json","Content-Type":"application/json"};try{var s=yield fetch(e.registration_endpoint,{method:_e.Post,headers:o,body:JSON.stringify(a)});if(s.status>=400)throw new Error(Sn.DynamicRegistrationFailed);var l=yield s.json(),c=l.client_id;if(!c||typeof c!="string")throw new Error(Sn.DynamicRegistrationInvalid);return c}catch(d){throw Object.values(Sn).includes(d.message)?d:(U.error("Dynamic registration request failed",d),new Error(Sn.DynamicRegistrationFailed))}});return function(r,n){return t.apply(this,arguments)}}();class tve{constructor(e,r,n,i,a){this.idTokenClaims=a,E(this,"oidcClientReady",void 0),E(this,"oidcClient",void 0),E(this,"inflightRefreshRequest",void 0),this.oidcClientReady=this.initialiseOidcClient(e,r,i,n)}initialiseOidcClient(e,r,n,i){var a=this;return K(function*(){try{var o,s=yield y3(e),l=n_(n);a.oidcClient=new v3({metadata:s,signingKeys:(o=s.signingKeys)!==null&&o!==void 0?o:void 0,client_id:r,scope:l,redirect_uri:i,authority:s.issuer,stateStore:new r_({prefix:"mx_oidc_",store:window.sessionStorage})})}catch(c){throw U.error("Failed to initialise OIDC client.",c),new Error("Failed to initialise OIDC client.")}})()}doRefreshAccessToken(e){var r=this;return K(function*(){r.inflightRefreshRequest||(r.inflightRefreshRequest=r.getNewTokens(e));try{var n=yield r.inflightRefreshRequest;return n}catch(i){throw i instanceof of?new Q4(i):i}finally{r.inflightRefreshRequest=void 0}})()}persistTokens(e){return K(function*(){})()}getNewTokens(e){var r=this;return K(function*(){if(!r.oidcClient)throw new Error("Cannot get new token before OIDC client is initialised.");var n={refresh_token:e,session_state:"test",data:void 0,profile:r.idTokenClaims},i=Date.now(),a=yield r.oidcClient.useRefreshToken({state:n,timeoutInSeconds:300}),o={accessToken:a.access_token,refreshToken:a.refresh_token,expiry:a.expires_in?new Date(i+a.expires_in*1e3):void 0};return yield r.persistTokens(o),o})()}}var rve=["server","limit","since"];function Ck(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Nr(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Ck(Object(r),!0).forEach(function(n){E(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Ck(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var nve=3e3,Tk=10*60*1e3,ive=new Rr("last_seen_user_agent","org.matrix.msc3852.last_seen_user_agent"),sf=function(t){return t.Chronological="chronological",t.Detached="detached",t}({}),ave=new Wm("m.get_login_token","org.matrix.msc3882.get_login_token"),iz="uk.half-shot.msc2666",az="uk.half-shot.msc2666.mutual_rooms",oz="uk.half-shot.msc2666.query_mutual_rooms",Ka="org.matrix.msc4140",sz="uk.tcpip.msc4133",La="$",je=function(t){return t.Sync="sync",t.Event="event",t.ToDeviceEvent="toDeviceEvent",t.AccountData="accountData",t.Room="Room",t.DeleteRoom="deleteRoom",t.SyncUnexpectedError="sync.unexpectedError",t.ClientWellKnown="WellKnown.client",t.ReceivedVoipEvent="received_voip_event",t.UndecryptableToDeviceEvent="toDeviceEvent.undecryptable",t.TurnServers="turnServers",t.TurnServersError="turnServers.error",t}({}),ove=new Rr("action","org.matrix.msc3824.action");class i_ extends nr{constructor(e){var r,n,i,a;super(),i=this,E(this,"logger",void 0),E(this,"reEmitter",new kf(this)),E(this,"olmVersion",null),E(this,"usingExternalCrypto",!1),E(this,"_store",void 0),E(this,"deviceId",void 0),E(this,"credentials",void 0),E(this,"legacyPickleKey",void 0),E(this,"scheduler",void 0),E(this,"clientRunning",!1),E(this,"timelineSupport",!1),E(this,"urlPreviewCache",{}),E(this,"identityServer",void 0),E(this,"http",void 0),E(this,"cryptoBackend",void 0),E(this,"cryptoCallbacks",void 0),E(this,"callEventHandler",void 0),E(this,"groupCallEventHandler",void 0),E(this,"supportsCallTransfer",!1),E(this,"forceTURN",!1),E(this,"iceCandidatePoolSize",0),E(this,"idBaseUrl",void 0),E(this,"baseUrl",void 0),E(this,"isVoipWithNoMediaAllowed",void 0),E(this,"useLivekitForGroupCalls",void 0),E(this,"canSupportVoip",!1),E(this,"peekSync",null),E(this,"isGuestAccount",!1),E(this,"ongoingScrollbacks",{}),E(this,"notifTimelineSet",null),E(this,"legacyCryptoStore",void 0),E(this,"verificationMethods",void 0),E(this,"fallbackICEServerAllowed",!1),E(this,"syncApi",void 0),E(this,"roomNameGenerator",void 0),E(this,"pushRules",void 0),E(this,"syncLeftRoomsPromise",void 0),E(this,"syncedLeftRooms",!1),E(this,"clientOpts",void 0),E(this,"clientWellKnownIntervalID",void 0),E(this,"canResetTimelineCallback",void 0),E(this,"canSupport",new Map),E(this,"pushProcessor",new ga(this)),E(this,"serverVersionsPromise",void 0),E(this,"clientWellKnown",void 0),E(this,"clientWellKnownPromise",void 0),E(this,"turnServers",[]),E(this,"turnServersExpiry",0),E(this,"checkTurnServersIntervalID",void 0),E(this,"txnCtr",0),E(this,"mediaHandler",new Qpe(this)),E(this,"sessionId",void 0),E(this,"eventsBeingEncrypted",new Set),E(this,"useE2eForGroupCall",!0),E(this,"toDeviceMessageQueue",void 0),E(this,"livekitServiceURL",void 0),E(this,"_secretStorage",void 0),E(this,"ignoredInvites",void 0),E(this,"matrixRTC",void 0),E(this,"serverCapabilitiesService",void 0),E(this,"startCallEventHandler",()=>{this.isInitialSyncComplete()&&(Wx()&&(this.callEventHandler.start(),this.groupCallEventHandler.start()),this.off(je.Sync,this.startCallEventHandler))}),E(this,"startMatrixRTC",()=>{this.isInitialSyncComplete()&&(this.matrixRTC.start(),this.off(je.Sync,this.startMatrixRTC))}),E(this,"fixupRoomNotifications",()=>{if(this.isInitialSyncComplete()){var s,l=((s=this.getRooms())!==null&&s!==void 0?s:[]).filter(h=>h.getUnreadNotificationCount(It.Total)>0);for(var c of l){var d=this.getSafeUserId();c.fixupNotifications(d)}this.off(je.Sync,this.fixupRoomNotifications)}}),this.logger=(r=e.logger)!==null&&r!==void 0?r:U,e.baseUrl=gw(e.baseUrl),e.idBaseUrl=gw(e.idBaseUrl),this.baseUrl=e.baseUrl,this.idBaseUrl=e.idBaseUrl,this.identityServer=e.identityServer,this.usingExternalCrypto=(n=e.usingExternalCrypto)!==null&&n!==void 0?n:!1,this.store=e.store||new Yhe,this.deviceId=e.deviceId||null,this.sessionId=al(10);var o=e.userId||null;this.credentials={userId:o},this.http=new SV(this,{fetchFn:e.fetchFn,baseUrl:e.baseUrl,idBaseUrl:e.idBaseUrl,accessToken:e.accessToken,refreshToken:e.refreshToken,tokenRefreshFunction:e.tokenRefreshFunction,prefix:Ur.V3,onlyData:!0,extraParams:e.queryParams,localTimeoutMs:e.localTimeoutMs,useAuthorizationHeader:e.useAuthorizationHeader,logger:this.logger}),e.pickleKey&&(this.legacyPickleKey=e.pickleKey),this.useLivekitForGroupCalls=!!e.useLivekitForGroupCalls,this.scheduler=e.scheduler,this.scheduler&&this.scheduler.setProcessFunction(function(){var s=K(function*(l){var c=i.getRoom(l.getRoomId());l.status!==Ze.SENDING&&i.updatePendingEventStatus(c,l,Ze.SENDING);var d=yield i.sendEventHttpRequest(l);return c&&c.updatePendingEvent(l,Ze.SENT,d.event_id),d});return function(l){return s.apply(this,arguments)}}()),Wx()&&(this.callEventHandler=new _pe(this),this.groupCallEventHandler=new Spe(this),this.canSupportVoip=!0,this.on(je.Sync,this.startCallEventHandler)),this.matrixRTC=new xme(this),this.serverCapabilitiesService=new EV(this.http),this.on(je.Sync,this.fixupRoomNotifications),this.timelineSupport=!!e.timelineSupport,this.legacyCryptoStore=e.cryptoStore,this.verificationMethods=e.verificationMethods,this.cryptoCallbacks=e.cryptoCallbacks||{},this.forceTURN=e.forceTURN||!1,this.iceCandidatePoolSize=e.iceCandidatePoolSize===void 0?0:e.iceCandidatePoolSize,this.supportsCallTransfer=e.supportsCallTransfer||!1,this.fallbackICEServerAllowed=e.fallbackICEServerAllowed||!1,this.isVoipWithNoMediaAllowed=e.isVoipWithNoMediaAllowed||!1,e.useE2eForGroupCall!==void 0&&(this.useE2eForGroupCall=e.useE2eForGroupCall),this.livekitServiceURL=e.livekitServiceURL,this.roomNameGenerator=e.roomNameGenerator,this.toDeviceMessageQueue=new sme(this),this.on(At.Decrypted,s=>{lz(this,s)}),this.ignoredInvites=new lme(this),this._secretStorage=new KV(this,(a=e.cryptoCallbacks)!==null&&a!==void 0?a:{}),this.setMaxListeners(0)}set store(e){this._store=e,this._store.setUserCreator(r=>Zo.createUser(r,this))}get store(){return this._store}startClient(e){var r=this;return K(function*(){if(!r.clientRunning){r.clientRunning=!0,r.on(je.Sync,r.startMatrixRTC);var n=r.getUserId();n&&r.store.storeUser(new Zo(n)),r.canSupportVoip&&(r.checkTurnServersIntervalID=setInterval(()=>{r.checkTurnServers()},Tk),r.checkTurnServers()),r.syncApi&&(r.logger.error("Still have sync object whilst not running: stopping old one"),r.syncApi.stop());try{yield r.getVersions();var{threads:i,list:a,fwdPagination:o}=yield r.doesServerSupportThread();Jt.setServerSideSupport(i),Jt.setServerSideListSupport(a),Jt.setServerSideFwdPaginationSupport(o)}catch(s){r.logger.error("Can't fetch server versions, continuing to initialise sync, this will be retried later",s)}r.clientOpts=e??{},r.clientOpts.slidingSync?r.syncApi=new FV(r.clientOpts.slidingSync,r,r.clientOpts,r.buildSyncApiOptions()):r.syncApi=new lu(r,r.clientOpts,r.buildSyncApiOptions()),r.syncApi.sync().catch(s=>r.logger.info("Sync startup aborted with an error:",s)),r.clientOpts.clientWellKnownPollPeriod!==void 0&&(r.clientWellKnownIntervalID=setInterval(()=>{r.fetchClientWellKnown()},1e3*r.clientOpts.clientWellKnownPollPeriod),r.fetchClientWellKnown()),r.toDeviceMessageQueue.start(),r.serverCapabilitiesService.start()}})()}buildSyncApiOptions(){return{cryptoCallbacks:this.cryptoBackend,canResetEntireTimeline:e=>this.canResetTimelineCallback?this.canResetTimelineCallback(e):!1}}stopClient(){var e,r,n,i,a;(e=this.cryptoBackend)===null||e===void 0||e.stop(),this.off(je.Sync,this.startMatrixRTC),this.clientRunning&&(this.logger.debug("stopping MatrixClient"),this.clientRunning=!1,(r=this.syncApi)===null||r===void 0||r.stop(),this.syncApi=void 0,(n=this.peekSync)===null||n===void 0||n.stopPeeking(),(i=this.callEventHandler)===null||i===void 0||i.stop(),(a=this.groupCallEventHandler)===null||a===void 0||a.stop(),this.callEventHandler=void 0,this.groupCallEventHandler=void 0,globalThis.clearInterval(this.checkTurnServersIntervalID),this.checkTurnServersIntervalID=void 0,this.clientWellKnownIntervalID!==void 0&&globalThis.clearInterval(this.clientWellKnownIntervalID),this.toDeviceMessageQueue.stop(),this.matrixRTC.stop(),this.serverCapabilitiesService.stop())}clearStores(){var e=this;if(this.clientRunning)throw new Error("Cannot clear stores while client is running");var r=[];r.push(this.store.deleteAllData()),this.legacyCryptoStore&&r.push(this.legacyCryptoStore.deleteAllData());var n=function(){var i=K(function*(){var a;try{if(a=globalThis.indexedDB,!a)return}catch{return}var o=function*(c){var d=new Promise((h,p)=>{e.logger.info("Removing IndexedDB instance ".concat(c));var m=a.deleteDatabase(c);m.onsuccess=g=>{e.logger.info("Removed IndexedDB instance ".concat(c)),h(0)},m.onerror=g=>{e.logger.warn("Failed to remove IndexedDB instance ".concat(c,":"),g),h(0)},m.onblocked=g=>{e.logger.info("cannot yet remove IndexedDB instance ".concat(c))}});yield d};for(var s of["".concat(Aw,"::matrix-sdk-crypto"),"".concat(Aw,"::matrix-sdk-crypto-meta")])yield*o(s)});return function(){return i.apply(this,arguments)}}();return r.push(n()),Promise.all(r).then()}getUserId(){var e,r;return(e=(r=this.credentials)===null||r===void 0?void 0:r.userId)!==null&&e!==void 0?e:null}getSafeUserId(){var e=this.getUserId();if(!e)throw new Error("Expected logged in user but found none.");return e}getDomain(){var e;return(e=this.credentials)!==null&&e!==void 0&&e.userId?this.credentials.userId.replace(/^.*?:/,""):null}getUserIdLocalpart(){var e,r;return(e=(r=this.credentials)===null||r===void 0||(r=r.userId)===null||r===void 0?void 0:r.split(":")[0].substring(1))!==null&&e!==void 0?e:null}getDeviceId(){return this.deviceId}getSessionId(){return this.sessionId}supportsVoip(){return this.canSupportVoip}getMediaHandler(){return this.mediaHandler}setForceTURN(e){this.forceTURN=e}setSupportsCallTransfer(e){this.supportsCallTransfer=e}getUseE2eForGroupCall(){return this.useE2eForGroupCall}createCall(e){return om(this,e)}createGroupCall(e,r,n,i,a,o){var s=this;return K(function*(){if(s.getGroupCallForRoom(e))throw new Error("".concat(e," already has an existing group call"));var l=s.getRoom(e);if(!l)throw new Error("Cannot find room ".concat(e));return new n3(s,l,r,n,i,void 0,a||s.isVoipWithNoMediaAllowed,o,s.isVoipWithNoMediaAllowed,s.useLivekitForGroupCalls,s.livekitServiceURL).create()})()}getLivekitServiceURL(){return this.livekitServiceURL}setLivekitServiceURL(e){this.livekitServiceURL=e}waitUntilRoomReadyForGroupCalls(e){return this.groupCallEventHandler.waitUntilRoomReadyForGroupCalls(e)}getGroupCallForRoom(e){return this.groupCallEventHandler.groupCalls.get(e)||null}getSyncState(){var e,r;return(e=(r=this.syncApi)===null||r===void 0?void 0:r.getSyncState())!==null&&e!==void 0?e:null}getSyncStateData(){return this.syncApi?this.syncApi.getSyncStateData():null}isInitialSyncComplete(){var e=this.getSyncState();return e?e===Lt.Prepared||e===Lt.Syncing:!1}isGuest(){return this.isGuestAccount}setGuest(e){this.isGuestAccount=e}getScheduler(){return this.scheduler}retryImmediately(){var e,r;return this.toDeviceMessageQueue.sendQueue(),(e=(r=this.syncApi)===null||r===void 0?void 0:r.retryImmediately())!==null&&e!==void 0?e:!1}getNotifTimelineSet(){return this.notifTimelineSet}setNotifTimelineSet(e){this.notifTimelineSet=e}getCapabilities(){var e=this;return K(function*(){var r=e.serverCapabilitiesService.getCachedCapabilities();return r||e.serverCapabilitiesService.fetchCapabilities()})()}getCachedCapabilities(){return this.serverCapabilitiesService.getCachedCapabilities()}fetchCapabilities(){return this.serverCapabilitiesService.fetchCapabilities()}initRustCrypto(){var e=arguments,r=this;return K(function*(){var n,i=e.length>0&&e[0]!==void 0?e[0]:{};if(r.cryptoBackend){r.logger.warn("Attempt to re-initialise e2e encryption on MatrixClient");return}var a=r.getUserId();if(a===null)throw new Error("Cannot enable encryption on MatrixClient with unknown userId: ensure userId is passed in createClient().");var o=r.getDeviceId();if(o===null)throw new Error("Cannot enable encryption on MatrixClient with unknown deviceId: ensure deviceId is passed in createClient().");r.logger.debug("Downloading Rust crypto library");var s=yield El(()=>import("./index-CJl549OE.js"),[]),l=yield s.initRustCrypto({logger:r.logger,http:r.http,userId:a,deviceId:o,secretStorage:r.secretStorage,cryptoCallbacks:r.cryptoCallbacks,storePrefix:i.useIndexedDB===!1?null:Aw,storeKey:i.storageKey,storePassphrase:i.storagePassword,legacyCryptoStore:r.legacyCryptoStore,legacyPickleKey:(n=r.legacyPickleKey)!==null&&n!==void 0?n:"DEFAULT_KEY",legacyMigrationProgressListener:(c,d)=>{r.emit(Yr.LegacyCryptoStoreMigrationProgress,c,d)}});l.setSupportedVerificationMethods(r.verificationMethods),r.cryptoBackend=l,r.on(Xn.Membership,l.onRoomMembership.bind(l)),r.on(je.Event,c=>{l.onLiveEventFromSync(c)}),r.reEmitter.reEmit(l,[Yr.VerificationRequestReceived,Yr.UserTrustStatusChanged,Yr.KeyBackupStatus,Yr.KeyBackupSessionsRemaining,Yr.KeyBackupFailed,Yr.KeyBackupDecryptionKeyCached,Yr.KeysChanged,Yr.DevicesUpdated,Yr.WillUpdateDevices,Yr.DehydratedDeviceCreated,Yr.DehydratedDeviceUploaded,Yr.RehydrationStarted,Yr.RehydrationProgress,Yr.RehydrationCompleted,Yr.RehydrationError,Yr.DehydrationKeyCached,Yr.DehydratedDeviceRotationError])})()}get secretStorage(){return this._secretStorage}getCrypto(){return this.cryptoBackend}isRoomEncrypted(e){var r=this.getRoom(e);return r?r.hasEncryptionStateEvent():!1}isKeyBackupKeyStored(){return Promise.resolve(this.secretStorage.isStored("m.megolm_backup.v1"))}makeKeyBackupPath(e,r,n){var i;r!==void 0?i=Le("/room_keys/keys/$roomId/$sessionId",{$roomId:e,$sessionId:r}):e!==void 0?i=Le("/room_keys/keys/$roomId",{$roomId:e}):i="/room_keys/keys";var a=n===void 0?void 0:{version:n};return{path:i,queryData:a}}deleteKeysFromBackup(e,r,n){var i=this;return K(function*(){var a=i.makeKeyBackupPath(e,r,n);yield i.http.authedRequest(_e.Delete,a.path,a.queryData,void 0,{prefix:Ur.V3})})()}getMediaConfig(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,r=e?"/media/config":"/config";return this.http.authedRequest(_e.Get,r,void 0,void 0,{prefix:e?Ur.V1:Ed.V3})}getRoom(e){return e?this.store.getRoom(e):null}getRooms(){return this.store.getRooms()}getVisibleRooms(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,r=this.store.getRooms(),n=new Set;for(var i of r){var a,o=(a=i.findPredecessor(e))===null||a===void 0?void 0:a.roomId;o&&n.add(o)}return r.filter(s=>{var l=s.currentState.getStateEvents(ge.RoomTombstone,"");return!(l&&n.has(s.roomId))})}getUser(e){return this.store.getUser(e)}getUsers(){return this.store.getUsers()}setAccountData(e,r){var n=this;return K(function*(){if(!n.clientRunning)return U.warn("Calling `setAccountData` before the client is started: `getAccountData` may return inconsistent results."),yield Nx(5,()=>n.setAccountDataRaw(e,r));var i=n.store.getAccountData(e);if(i&&ef(i.event.content,r))return{};var a=ml();function o(l){l.getType()===e&&a.resolve()}n.addListener(je.AccountData,o);try{var s=yield Nx(5,()=>n.setAccountDataRaw(e,r));return yield a.promise,s}finally{n.removeListener(je.AccountData,o)}})()}setAccountDataRaw(e,r){var n=Le("/user/$userId/account_data/$type",{$userId:this.credentials.userId,$type:e});return this.http.authedRequest(_e.Put,n,void 0,r)}getAccountData(e){return this.store.getAccountData(e)}getAccountDataFromServer(e){var r=this;return K(function*(){if(r.isInitialSyncComplete()){var n=r.store.getAccountData(e);return n?n.getContent():null}var i=Le("/user/$userId/account_data/$type",{$userId:r.credentials.userId,$type:e});try{return yield r.http.authedRequest(_e.Get,i)}catch(o){var a;if(((a=o.data)===null||a===void 0?void 0:a.errcode)==="M_NOT_FOUND")return null;throw o}})()}deleteAccountData(e){var r=this;return K(function*(){var n=r.canSupport.get(jr.AccountDataDeletion);if(n===Fr.Unsupported){yield r.setAccountData(e,{});return}var i=Le("/user/$userId/account_data/$type",{$userId:r.getSafeUserId(),$type:e}),a=n===Fr.Unstable?{prefix:"/_matrix/client/unstable/org.matrix.msc3391"}:void 0;return yield r.http.authedRequest(_e.Delete,i,void 0,void 0,a)})()}getIgnoredUsers(){var e=this.getAccountData(ge.IgnoredUserList);return e!=null&&e.getContent().ignored_users?Object.keys(e.getContent().ignored_users):[]}setIgnoredUsers(e){var r={ignored_users:{}};return e.forEach(n=>{r.ignored_users[n]={}}),this.setAccountData(ge.IgnoredUserList,r)}isUserIgnored(e){return this.getIgnoredUsers().includes(e)}joinRoom(e){var r=arguments,n=this;return K(function*(){var i=r.length>1&&r[1]!==void 0?r[1]:{};i.syncRoom===void 0&&(i.syncRoom=!0);var a=n.getRoom(e);if(a!=null&&a.hasMembershipState(n.credentials.userId,ct.Join))return a;var o=Promise.resolve();if(i.inviteSignUrl){var s=new URL(i.inviteSignUrl);s.searchParams.set("mxid",n.credentials.userId),o=n.http.requestOtherUrl(_e.Post,s)}var l={};i.viaServers&&(l.server_name=i.viaServers,l.via=i.viaServers);var c={},d=yield o;d&&(c.third_party_signed=d);var h=Le("/join/$roomid",{$roomid:e}),p=yield n.http.authedRequest(_e.Post,h,l,c),m=p.room_id,g=n.getRoom(m);if(g!=null&&g.hasMembershipState(n.credentials.userId,ct.Join))return g;var y=new lu(n,n.clientOpts,n.buildSyncApiOptions()),R=y.createRoom(m);return i.syncRoom,R})()}knockRoom(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=this.getRoom(e);if(n!=null&&n.hasMembershipState(this.credentials.userId,ct.Knock))return Promise.resolve({room_id:n.roomId});var i=Le("/knock/$roomIdOrAlias",{$roomIdOrAlias:e}),a={};r.viaServers&&(a.server_name=r.viaServers,a.via=r.viaServers);var o={};return r.reason&&(o.reason=r.reason),this.http.authedRequest(_e.Post,i,a,o)}resendEvent(e,r){return this.toDeviceMessageQueue.sendQueue(),this.updatePendingEventStatus(r,e,Ze.SENDING),this.encryptAndSendEvent(r,e)}cancelPendingEvent(e){if(![Ze.QUEUED,Ze.NOT_SENT,Ze.ENCRYPTING].includes(e.status))throw new Error("cannot cancel an event with status "+e.status);e.status===Ze.ENCRYPTING?this.eventsBeingEncrypted.delete(e.getId()):this.scheduler&&e.status===Ze.QUEUED&&this.scheduler.removeEventFromQueue(e);var r=this.getRoom(e.getRoomId());this.updatePendingEventStatus(r,e,Ze.CANCELLED)}setRoomName(e,r){return this.sendStateEvent(e,ge.RoomName,{name:r})}setRoomTopic(e,r,n){var i=uV(r,n);return this.sendStateEvent(e,ge.RoomTopic,i)}getRoomTags(e){var r=Le("/user/$userId/rooms/$roomId/tags",{$userId:this.credentials.userId,$roomId:e});return this.http.authedRequest(_e.Get,r)}setRoomTag(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=Le("/user/$userId/rooms/$roomId/tags/$tag",{$userId:this.credentials.userId,$roomId:e,$tag:r});return this.http.authedRequest(_e.Put,i,void 0,n)}deleteRoomTag(e,r){var n=Le("/user/$userId/rooms/$roomId/tags/$tag",{$userId:this.credentials.userId,$roomId:e,$tag:r});return this.http.authedRequest(_e.Delete,n)}setRoomAccountData(e,r,n){var i=Le("/user/$userId/rooms/$roomId/account_data/$type",{$userId:this.credentials.userId,$roomId:e,$type:r});return this.http.authedRequest(_e.Put,i,void 0,n)}setPowerLevel(e,r,n){var i=this;return K(function*(){var a,o;if(i.clientRunning&&i.isInitialSyncComplete()){var s;o=(s=i.getRoom(e))===null||s===void 0||(s=s.currentState)===null||s===void 0||(s=s.getStateEvents(ge.RoomPowerLevels,""))===null||s===void 0?void 0:s.getContent()}if(!o)try{o=yield i.getStateEvent(e,ge.RoomPowerLevels,"")}catch(d){if(d instanceof ur&&d.errcode==="M_NOT_FOUND")o={};else throw d}o=Ym(o),(a=o)!==null&&a!==void 0&&a.users||(o.users={});var l=Array.isArray(r)?r:[r];for(var c of l)n==null?delete o.users[c]:o.users[c]=n;return i.sendStateEvent(e,ge.RoomPowerLevels,o,"")})()}unstable_createLiveBeacon(e,r){var n=this;return K(function*(){return n.unstable_setLiveBeacon(e,r)})()}unstable_setLiveBeacon(e,r){var n=this;return K(function*(){return n.sendStateEvent(e,l3.name,r,n.getUserId())})()}sendEvent(e,r,n,i,a){var o,s,l,c;return!(r!=null&&r.startsWith(La))&&r!==null?(c=i,l=n,s=r,o=null):(c=a,l=i,s=n,o=r),this.addThreadRelationIfNeeded(l,o,e),this.sendCompleteEvent(e,o,{type:s,content:l},c)}addThreadRelationIfNeeded(e,r,n){var i;if(r&&!((i=e["m.relates_to"])!==null&&i!==void 0&&i.rel_type)){var a,o,s=!!((a=e["m.relates_to"])!==null&&a!==void 0&&a["m.in_reply_to"]);e["m.relates_to"]=Nr(Nr({},e["m.relates_to"]),{},{rel_type:jt.name,event_id:r,is_falling_back:!s});var l=(o=this.getRoom(n))===null||o===void 0?void 0:o.getThread(r);if(l&&!s){var c,d;e["m.relates_to"]["m.in_reply_to"]={event_id:(c=(d=l.lastReply(h=>h.isRelation(jt.name)&&!h.status))===null||d===void 0?void 0:d.getId())!==null&&c!==void 0?c:r}}}}sendCompleteEvent(e,r,n,i,a){var o,s;typeof i=="string"?s=i:(o=i,s=a),s||(s=this.makeTxnId());var l=new Bn(Object.assign(n,{event_id:"~"+e+":"+s,user_id:this.credentials.userId,sender:this.credentials.userId,room_id:e,origin_server_ts:new Date().getTime()})),c=this.getRoom(e),d=r?c==null?void 0:c.getThread(r):void 0;d&&l.setThread(d),o||(this.reEmitter.reEmit(l,[At.Replaced,At.VisibilityChange]),c==null||c.reEmitter.reEmit(l,[At.BeforeRedaction]));var h=l.getAssociatedId();if(h!=null&&h.startsWith("~")){var p=c==null?void 0:c.getPendingEvents().find(g=>g.getId()===h);p==null||p.once(At.LocalEventIdReplaced,()=>{l.updateAssociatedId(p.getId())})}var m=l.getType();return this.logger.debug("sendEvent of type ".concat(m," in ").concat(e," with txnId ").concat(s).concat(o?" (delayed event)":"")),l.setTxnId(s),l.setStatus(Ze.SENDING),o?this.encryptAndSendEvent(c,l,o):(c==null||c.addPendingEvent(l,s),l.status===Ze.NOT_SENT?Promise.reject(new Error("Event blocked by other events not yet sent")):this.encryptAndSendEvent(c,l))}encryptAndSendEvent(e,r,n){var i=this;return K(function*(){if(n)return i.sendEventHttpRequest(r,n);try{var a;i.eventsBeingEncrypted.add(r.getId());try{yield i.encryptEventIfNeeded(r,e??void 0)}finally{a=!i.eventsBeingEncrypted.delete(r.getId())}if(a)return{};r.status===Ze.ENCRYPTING&&i.updatePendingEventStatus(e,r,Ze.SENDING);var o=null;return i.scheduler&&(o=i.scheduler.queueEvent(r),o&&i.scheduler.getQueueForEvent(r).length>1&&i.updatePendingEventStatus(e,r,Ze.QUEUED)),o||(o=i.sendEventHttpRequest(r),e&&(o=o.then(s=>(e.updatePendingEvent(r,Ze.SENT,s.event_id),s)))),yield o}catch(s){i.logger.error("Error sending event",s);try{r.error=s,i.updatePendingEventStatus(e,r,Ze.NOT_SENT)}catch(l){i.logger.error("Exception in error handler!",l)}throw s instanceof ur&&(s.event=r),s}})()}encryptEventIfNeeded(e,r){var n=this;return K(function*(){if(r&&(yield n.shouldEncryptEventForRoom(e,r))&&!(!n.cryptoBackend&&n.usingExternalCrypto)){if(!n.cryptoBackend)throw new Error("This room is configured to use encryption, but your client does not support encryption.");n.updatePendingEventStatus(r,e,Ze.ENCRYPTING),yield n.cryptoBackend.encryptEvent(e,r)}})()}shouldEncryptEventForRoom(e,r){var n=this;return K(function*(){var i;return e.isEncrypted()||e.getType()===ge.Reaction||e.isRedaction()?!1:!!(r.hasEncryptionStateEvent()||(yield(i=n.cryptoBackend)===null||i===void 0?void 0:i.isEncryptionEnabledInRoom(r.roomId)))})()}getEncryptedIfNeededEventType(e,r){var n;return r===ge.Reaction?r:(n=this.getRoom(e))!==null&&n!==void 0&&n.hasEncryptionStateEvent()?ge.RoomMessageEncrypted:r}updatePendingEventStatus(e,r,n){e?e.updatePendingEvent(r,n):r.setStatus(n)}sendEventHttpRequest(e,r){var n=e.getTxnId();n||(n=this.makeTxnId(),e.setTxnId(n));var i={$roomId:e.getRoomId(),$eventType:e.getWireType(),$stateKey:e.getStateKey(),$txnId:n},a;if(e.isState()){var o="/rooms/$roomId/state/$eventType";e.getStateKey()&&e.getStateKey().length>0&&(o="/rooms/$roomId/state/$eventType/$stateKey"),a=Le(o,i)}else if(e.isRedaction()&&e.event.redacts){var s="/rooms/$roomId/redact/$redactsEventId/$txnId";a=Le(s,Nr({$redactsEventId:e.event.redacts},i))}else a=Le("/rooms/$roomId/send/$eventType/$txnId",i);var l=e.getWireContent();return r?this.http.authedRequest(_e.Put,a,Dk(r),l):this.http.authedRequest(_e.Put,a,void 0,l).then(c=>(this.logger.debug("Event sent to ".concat(e.getRoomId()," with event id ").concat(c.event_id)),c))}redactEvent(e,r,n,i,a){var o,s,l;(o=n)!==null&&o!==void 0&&o.startsWith(La)||(a=i,i=n,n=r,r=null);var c=(s=a)===null||s===void 0?void 0:s.reason,d={reason:c};if(((l=a)===null||l===void 0?void 0:l.with_rel_types)!==void 0){if(this.canSupport.get(jr.RelationBasedRedactions)===Fr.Unsupported)throw new Error("Server does not support relation based redactions "+"roomId ".concat(e," eventId ").concat(n," txnId: ").concat(i," threadId ").concat(r));var h=this.canSupport.get(jr.RelationBasedRedactions)===Fr.Stable?fx.stable:fx.unstable;d[h]=a.with_rel_types}return this.sendCompleteEvent(e,r,{type:ge.RoomRedaction,content:d,redacts:n},i)}sendMessage(e,r,n,i){typeof r!="string"&&r!==null&&(i=n,n=r,r=null);var a=ge.RoomMessage,o=n;return this.sendEvent(e,r,a,o,i)}sendTextMessage(e,r,n,i){var a;!((a=r)!==null&&a!==void 0&&a.startsWith(La))&&r!==null&&(i=n,n=r,r=null);var o=iV(n);return this.sendMessage(e,r,o,i)}sendNotice(e,r,n,i){var a;!((a=r)!==null&&a!==void 0&&a.startsWith(La))&&r!==null&&(i=n,n=r,r=null);var o=aV(n);return this.sendMessage(e,r,o,i)}sendEmoteMessage(e,r,n,i){var a;!((a=r)!==null&&a!==void 0&&a.startsWith(La))&&r!==null&&(i=n,n=r,r=null);var o=oV(n);return this.sendMessage(e,r,o,i)}sendImageMessage(e,r,n,i){var a,o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:"Image";!((a=r)!==null&&a!==void 0&&a.startsWith(La))&&r!==null&&(o=i||"Image",i=n,n=r,r=null);var s={msgtype:Ma.Image,url:n,info:i,body:o};return this.sendMessage(e,r,s)}sendStickerMessage(e,r,n,i){var a,o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:"Sticker";!((a=r)!==null&&a!==void 0&&a.startsWith(La))&&r!==null&&(o=i||"Sticker",i=n,n=r,r=null);var s={url:n,info:i,body:o};return this.sendEvent(e,r,ge.Sticker,s)}sendHtmlMessage(e,r,n,i){var a;!((a=r)!==null&&a!==void 0&&a.startsWith(La))&&r!==null&&(i=n,n=r,r=null);var o=tV(n,i);return this.sendMessage(e,r,o)}sendHtmlNotice(e,r,n,i){var a;!((a=r)!==null&&a!==void 0&&a.startsWith(La))&&r!==null&&(i=n,n=r,r=null);var o=rV(n,i);return this.sendMessage(e,r,o)}sendHtmlEmote(e,r,n,i){var a;!((a=r)!==null&&a!==void 0&&a.startsWith(La))&&r!==null&&(i=n,n=r,r=null);var o=nV(n,i);return this.sendMessage(e,r,o)}_unstable_sendDelayedEvent(e,r,n,i,a,o){var s=this;return K(function*(){if(!(yield s.doesServerSupportUnstableFeature(Ka)))throw new Gs("Server does not support the delayed events API","sendDelayedEvent");return s.addThreadRelationIfNeeded(a,n,e),s.sendCompleteEvent(e,n,{type:i,content:a},r,o)})()}_unstable_sendDelayedStateEvent(e,r,n,i){var a=arguments,o=this;return K(function*(){var s=a.length>4&&a[4]!==void 0?a[4]:"",l=a.length>5&&a[5]!==void 0?a[5]:{};if(!(yield o.doesServerSupportUnstableFeature(Ka)))throw new Gs("Server does not support the delayed events API","sendDelayedStateEvent");var c={$roomId:e,$eventType:n,$stateKey:s},d=Le("/rooms/$roomId/state/$eventType",c);return s!==void 0&&(d=Le(d+"/$stateKey",c)),o.http.authedRequest(_e.Put,d,Dk(r),i,l)})()}_unstable_getDelayedEvents(e){var r=this;return K(function*(){if(!(yield r.doesServerSupportUnstableFeature(Ka)))throw new Gs("Server does not support the delayed events API","getDelayedEvents");var n=e?{from:e}:void 0;return yield r.http.authedRequest(_e.Get,"/delayed_events",n,void 0,{prefix:"".concat(Ur.Unstable,"/").concat(Ka)})})()}_unstable_updateDelayedEvent(e,r){var n=arguments,i=this;return K(function*(){var a=n.length>2&&n[2]!==void 0?n[2]:{};if(!(yield i.doesServerSupportUnstableFeature(Ka)))throw new Gs("Server does not support the delayed events API","updateDelayedEvent");var o=Le("/delayed_events/$delayId",{$delayId:e}),s={action:r};return yield i.http.authedRequest(_e.Post,o,void 0,s,Nr(Nr({},a),{},{prefix:"".concat(Ur.Unstable,"/").concat(Ka)}))})()}sendReceipt(e,r,n){var i=arguments,a=this;return K(function*(){var o=i.length>3&&i[3]!==void 0?i[3]:!1;if(a.isGuest())return Promise.resolve({});var s=Le("/rooms/$roomId/receipt/$receiptType/$eventId",{$roomId:e.getRoomId(),$receiptType:r,$eventId:e.getId()}),l=!o&&a.supportsThreads(),c=l?Nr(Nr({},n),{},{thread_id:lf(e)}):n,d=a.http.authedRequest(_e.Post,s,void 0,c||{}),h=a.getRoom(e.getRoomId());return h&&a.credentials.userId&&h.addLocalEchoReceipt(a.credentials.userId,e,r,o),d})()}sendReadReceipt(e){var r=arguments,n=this;return K(function*(){var i=r.length>1&&r[1]!==void 0?r[1]:In.Read,a=r.length>2&&r[2]!==void 0?r[2]:!1;if(e){var o=e.getId(),s=n.getRoom(e.getRoomId());if(s!=null&&s.hasPendingEvent(o))throw new Error("Cannot set read receipt to a pending event (".concat(o,")"));return n.sendReceipt(e,i,{},a)}})()}setRoomReadMarkers(e,r,n,i){var a=this;return K(function*(){var o=a.getRoom(e);if(o!=null&&o.hasPendingEvent(r))throw new Error("Cannot set read marker to a pending event (".concat(r,")"));var s;if(n){if(s=n.getId(),o!=null&&o.hasPendingEvent(s))throw new Error("Cannot set read receipt to a pending event (".concat(s,")"));o==null||o.addLocalEchoReceipt(a.credentials.userId,n,In.Read)}var l;if(i){if(l=i.getId(),o!=null&&o.hasPendingEvent(l))throw new Error("Cannot set read receipt to a pending event (".concat(l,")"));o==null||o.addLocalEchoReceipt(a.credentials.userId,i,In.ReadPrivate)}return yield a.setRoomReadMarkersHttpRequest(e,r,s,l)})()}getUrlPreview(e,r){r=Math.floor(r/6e4)*6e4;var n=new URL(e);n.hash="",e=n.toString();var i=r+"_"+e;if(i in this.urlPreviewCache)return this.urlPreviewCache[i];var a=this.http.authedRequest(_e.Get,"/preview_url",{url:e,ts:r.toString()},void 0,{prefix:Ed.V3,priority:"low"});return this.urlPreviewCache[i]=a,a}sendTyping(e,r,n){if(this.isGuest())return Promise.resolve({});var i=Le("/rooms/$roomId/typing/$userId",{$roomId:e,$userId:this.getUserId()}),a={typing:r};return r&&(a.timeout=n||2e4),this.http.authedRequest(_e.Put,i,void 0,a)}getRoomUpgradeHistory(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=this.getRoom(e);if(!i)return[];var a=this.findPredecessorRooms(i,r,n),o=this.findSuccessorRooms(i,r,n);return[...a,i,...o]}findPredecessorRooms(e,r,n){for(var i,a=[],o=new Set([e.roomId]),s=(i=e.findPredecessor(n))===null||i===void 0?void 0:i.roomId;s!==null;){var l;if(s){if(o.has(s))break;o.add(s)}var c=this.getRoom(s);if(c===null)break;if(r){var d=c.currentState.getStateEvents(ge.RoomTombstone,"");if(!d||d.getContent().replacement_room!==e.roomId)break}a.splice(0,0,c),e=c,s=(l=e.findPredecessor(n))===null||l===void 0?void 0:l.roomId}return a}findSuccessorRooms(e,r,n){for(var i=[],a=e.currentState.getStateEvents(ge.RoomTombstone,"");a;){var o=this.getRoom(a.getContent().replacement_room);if(!o||o.roomId===e.roomId)break;if(r){var s,l=(s=o.findPredecessor(n))===null||s===void 0?void 0:s.roomId;if(!l||l!==e.roomId)break}i.push(o);var c=new Set(i.map(d=>d.roomId));if(c.size<i.length)return i.slice(0,i.length-1);e=o,a=e.currentState.getStateEvents(ge.RoomTombstone,"")}return i}invite(e,r,n){return this.membershipChange(e,r,ct.Invite,n)}inviteByEmail(e,r){return this.inviteByThreePid(e,"email",r)}inviteByThreePid(e,r,n){var i=this;return K(function*(){var a,o=Le("/rooms/$roomId/invite",{$roomId:e}),s=i.getIdentityServerUrl(!0);if(!s)return Promise.reject(new ur({error:"No supplied identity server URL",errcode:"ORG.MATRIX.JSSDK_MISSING_PARAM"}));var l={id_server:s,medium:r,address:n};if((a=i.identityServer)!==null&&a!==void 0&&a.getAccessToken){var c=yield i.identityServer.getAccessToken();c&&(l.id_access_token=c)}return i.http.authedRequest(_e.Post,o,void 0,l)})()}leave(e){return this.membershipChange(e,void 0,ct.Leave)}leaveRoomChain(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=this.getRoomUpgradeHistory(e),i=n;if(!r){i=[];for(var a of n)if(i.push(a),a.roomId===e)break}var o={},s=[],l=d=>this.leave(d).then(()=>{delete o[d]}).catch(h=>{o[d]=h});for(var c of i)s.push(l(c.roomId));return Promise.all(s).then(()=>o)}ban(e,r,n){return this.membershipChange(e,r,ct.Ban,n)}forget(e){var r=arguments,n=this;return K(function*(){var i=r.length>1&&r[1]!==void 0?r[1]:!0,a=Le("/rooms/$room_id/forget",{$room_id:e}),o=yield n.http.authedRequest(_e.Post,a);return i&&(n.store.removeRoom(e),n.emit(je.DeleteRoom,e)),o})()}unban(e,r){var n=Le("/rooms/$roomId/unban",{$roomId:e}),i={user_id:r};return this.http.authedRequest(_e.Post,n,void 0,i)}kick(e,r,n){var i=Le("/rooms/$roomId/kick",{$roomId:e}),a={user_id:r,reason:n};return this.http.authedRequest(_e.Post,i,void 0,a)}membershipChange(e,r,n,i){var a=Le("/rooms/$room_id/$membership",{$room_id:e,$membership:n});return this.http.authedRequest(_e.Post,a,void 0,{user_id:r,reason:i})}getPushActionsForEvent(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(!e.getPushActions()||r){var{actions:n,rule:i}=this.pushProcessor.actionsAndRuleForEvent(e);e.setPushDetails(n,i)}return e.getPushActions()}getPushDetailsForEvent(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(!e.getPushDetails()||r){var{actions:n,rule:i}=this.pushProcessor.actionsAndRuleForEvent(e);e.setPushDetails(n,i)}return e.getPushDetails()}setProfileInfo(e,r){var n=Le("/profile/$userId/$info",{$userId:this.credentials.userId,$info:e});return this.http.authedRequest(_e.Put,n,void 0,r)}setDisplayName(e){var r=this;return K(function*(){var n=yield r.setProfileInfo("displayname",{displayname:e}),i=r.getUser(r.getUserId());return i&&(i.displayName=e,i.emit(mi.DisplayName,i.events.presence,i)),n})()}setAvatarUrl(e){var r=this;return K(function*(){var n=yield r.setProfileInfo("avatar_url",{avatar_url:e}),i=r.getUser(r.getUserId());return i&&(i.avatarUrl=e,i.emit(mi.AvatarUrl,i.events.presence,i)),n})()}mxcUrlToHttp(e,r,n,i,a,o,s){return Kb(this.baseUrl,e,r,n,i,a,o,s)}setSyncPresence(e){var r=this;return K(function*(){var n;(n=r.syncApi)===null||n===void 0||n.setPresence(e)})()}setPresence(e){var r=this;return K(function*(){var n=Le("/presence/$userId/status",{$userId:r.credentials.userId}),i=["offline","online","unavailable"];if(i.indexOf(e.presence)===-1)throw new Error("Bad presence value: "+e.presence);yield r.http.authedRequest(_e.Put,n,void 0,e)})()}getPresence(e){var r=Le("/presence/$userId/status",{$userId:e});return this.http.authedRequest(_e.Get,r)}scrollback(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:30,n=0,i=this.ongoingScrollbacks[e.roomId]||{};if(i.promise)return i.promise;if(i.errorTs){var a=Date.now()-i.errorTs;n=Math.max(nve-a,0)}if(e.oldState.paginationToken===null)return Promise.resolve(e);var o=this.store.scrollback(e,r).length;if(o===r)return Promise.resolve(e);r=r-o;var s=new Promise((l,c)=>{$u(n).then(()=>this.createMessagesRequest(e.roomId,e.oldState.paginationToken,r,st.Backward)).then(d=>{var h,p,m=d.chunk.map(this.getEventMapper());if(d.state){var g=d.state.map(this.getEventMapper());e.currentState.setUnknownStateEvents(g)}var[y,R,b]=e.partitionThreadedEvents(m);this.processAggregatedTimelineEvents(e,y),e.addEventsToTimeline(y,!0,!0,e.getLiveTimeline()),this.processThreadEvents(e,R,!0),b.forEach(_=>e.relations.aggregateChildEvent(_)),e.oldState.paginationToken=(h=d.end)!==null&&h!==void 0?h:null,d.chunk.length===0&&(e.oldState.paginationToken=null),this.store.storeEvents(e,m,(p=d.end)!==null&&p!==void 0?p:null,!0),delete this.ongoingScrollbacks[e.roomId],l(e)}).catch(d=>{this.ongoingScrollbacks[e.roomId]={errorTs:Date.now()},c(d)})});return i={promise:s},this.ongoingScrollbacks[e.roomId]=i,s}getEventMapper(e){return Jpe(this,e||{})}getEventTimeline(e,r){var n=this;return K(function*(){var i,a,o,s;if(!n.timelineSupport)throw new Error("timeline support is disabled. Set the 'timelineSupport' parameter to true when creating MatrixClient to enable it.");if(!(e!=null&&e.room))throw new Error("getEventTimeline only supports room timelines");if(e.getTimelineForEvent(r))return e.getTimelineForEvent(r);if(e.thread&&n.supportsThreads())return n.getThreadTimeline(e,r);var l=Le("/rooms/$roomId/context/$eventId",{$roomId:e.room.roomId,$eventId:r}),c=void 0;(i=n.clientOpts)!==null&&i!==void 0&&i.lazyLoadMembers&&(c={filter:JSON.stringify(Yn.LAZY_LOADING_MESSAGES_FILTER)});var d=yield n.http.authedRequest(_e.Get,l,c);if(!d.event)throw new Error("'event' not in '/context' result - homeserver too old?");if(e.getTimelineForEvent(r))return e.getTimelineForEvent(r);var h=n.getEventMapper(),p=h(d.event);if(p.isRelation(jt.name)){n.logger.warn("Tried loading a regular timeline at the position of a thread event");return}var m=[...d.events_after.reverse().map(h),p,...d.events_before.map(h)],g=e.getTimelineForEvent(m[0].getId());g?g.getState(Be.BACKWARDS).setUnknownStateEvents(d.state.map(h)):(g=e.addTimeline(),g.initialiseState(d.state.map(h)),g.getState(Be.FORWARDS).paginationToken=d.end);var[y,R,b]=e.room.partitionThreadedEvents(m);return e.addEventsToTimeline(y,!0,!1,g,d.start),n.processThreadEvents(e.room,R,!0),n.processAggregatedTimelineEvents(e.room,y),b.forEach(_=>e.relations.aggregateChildEvent(_)),(a=(o=e.getTimelineForEvent(r))!==null&&o!==void 0?o:(s=e.room.findThreadForEvent(p))===null||s===void 0?void 0:s.liveTimeline)!==null&&a!==void 0?a:g})()}getThreadTimeline(e,r){var n=this;return K(function*(){var i;if(!n.supportsThreads())throw new Error("could not get thread timeline: no client support");if(!e.room)throw new Error("could not get thread timeline: not a room timeline");if(!e.thread)throw new Error("could not get thread timeline: not a thread timeline");var a=Le("/rooms/$roomId/context/$eventId",{$roomId:e.room.roomId,$eventId:r}),o={limit:"0"};(i=n.clientOpts)!==null&&i!==void 0&&i.lazyLoadMembers&&(o.filter=JSON.stringify(Yn.LAZY_LOADING_MESSAGES_FILTER));var s=yield n.http.authedRequest(_e.Get,a,o),l=n.getEventMapper(),c=l(s.event);if(e.canContain(c)){var d=n.canSupport.get(jr.RelationsRecursion)!==Fr.Unsupported;if(Jt.hasServerSideSupport)if(Jt.hasServerSideFwdPaginationSupport){var h,p,m;if(!e.thread)throw new Error("could not get thread timeline: not a thread timeline");var g=e.thread,y=yield n.fetchRelations(e.room.roomId,g.id,null,null,{dir:st.Backward,from:s.start,recurse:d||void 0}),R=yield n.fetchRelations(e.room.roomId,g.id,null,null,{dir:st.Forward,from:s.end,recurse:d||void 0}),b=[...R.chunk.reverse().filter($w(g.id)).map(l),c,...y.chunk.filter($w(g.id)).map(l)];for(var _ of b){var x;yield(x=e.thread)===null||x===void 0?void 0:x.processEvent(_)}var T=e.getTimelineForEvent(c.getId());if(T?T.getState(Be.BACKWARDS).setUnknownStateEvents(s.state.map(l)):(T=e.addTimeline(),T.initialiseState(s.state.map(l))),e.addEventsToTimeline(b,!0,!1,T,R.next_batch),!y.next_batch){var I=yield n.fetchRoomEvent(e.room.roomId,g.id);e.addEventsToTimeline([l(I)],!0,!1,T,null)}return T.setPaginationToken((h=y.next_batch)!==null&&h!==void 0?h:null,st.Backward),T.setPaginationToken((p=R.next_batch)!==null&&p!==void 0?p:null,st.Forward),n.processAggregatedTimelineEvents(e.room,b),(m=e.getTimelineForEvent(r))!==null&&m!==void 0?m:T}else{for(var C,k=e.thread,S=yield n.fetchRelations(e.room.roomId,k.id,jt.name,null,{dir:st.Backward,from:s.start,recurse:d||void 0}),V=[],z=s.end;z;){var j,J=yield n.fetchRelations(e.room.roomId,k.id,jt.name,null,{dir:st.Forward,from:z,recurse:d||void 0});z=(j=J.next_batch)!==null&&j!==void 0?j:null,V.push(...J.chunk)}var $=[...V.reverse().map(l),c,...S.chunk.map(l)];for(var le of $){var ie;yield(ie=e.thread)===null||ie===void 0?void 0:ie.processEvent(le)}var Z=e.getLiveTimeline();if(Z.getState(Be.BACKWARDS).setUnknownStateEvents(s.state.map(l)),e.addEventsToTimeline($,!0,!1,Z,null),!S.next_batch){var te=yield n.fetchRoomEvent(e.room.roomId,k.id);e.addEventsToTimeline([l(te)],!0,!1,Z,null)}return Z.setPaginationToken((C=S.next_batch)!==null&&C!==void 0?C:null,st.Backward),Z.setPaginationToken(null,st.Forward),n.processAggregatedTimelineEvents(e.room,$),Z}}})()}getLatestTimeline(e){var r=this;return K(function*(){if(!r.timelineSupport)throw new Error("timeline support is disabled. Set the 'timelineSupport' parameter to true when creating MatrixClient to enable it.");if(!e.room)throw new Error("getLatestTimeline only supports room timelines");var n;if(e.threadListType!==null){var i,a=yield r.createThreadListMessagesRequest(e.room.roomId,null,1,st.Backward,e.threadListType,e.getFilter());n=(i=a.chunk)===null||i===void 0?void 0:i[0]}else if(e.thread&&Jt.hasServerSideSupport){var o,s=r.canSupport.get(jr.RelationsRecursion)!==Fr.Unsupported,l=yield r.fetchRelations(e.room.roomId,e.thread.id,jt.name,null,{dir:st.Backward,limit:1,recurse:s||void 0});n=(o=l.chunk)===null||o===void 0?void 0:o[0]}else{var c,d,h=Le("/rooms/$roomId/messages",{$roomId:e.room.roomId}),p={dir:"b"};(c=r.clientOpts)!==null&&c!==void 0&&c.lazyLoadMembers&&(p.filter=JSON.stringify(Yn.LAZY_LOADING_MESSAGES_FILTER));var m=yield r.http.authedRequest(_e.Get,h,p);n=(d=m.chunk)===null||d===void 0?void 0:d[0]}if(!n)throw new Error("No message returned when trying to construct getLatestTimeline");return r.getEventTimeline(e,n.event_id)})()}createMessagesRequest(e,r){var n,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:30,a=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0,s=Le("/rooms/$roomId/messages",{$roomId:e}),l={limit:i.toString(),dir:a};r&&(l.from=r);var c=null;if((n=this.clientOpts)!==null&&n!==void 0&&n.lazyLoadMembers&&(c=Object.assign({},Yn.LAZY_LOADING_MESSAGES_FILTER)),o){var d;c=c||{},Object.assign(c,(d=o.getRoomTimelineFilterComponent())===null||d===void 0?void 0:d.toJSON())}return c&&(l.filter=JSON.stringify(c)),this.http.authedRequest(_e.Get,s,l)}createThreadListMessagesRequest(e,r){var n,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:30,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:st.Backward,o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:pa.All,s=arguments.length>5?arguments[5]:void 0,l=Le("/rooms/$roomId/threads",{$roomId:e}),c={limit:i.toString(),dir:a,include:uz(o)};r&&(c.from=r);var d={};if((n=this.clientOpts)!==null&&n!==void 0&&n.lazyLoadMembers&&(d=Nr({},Yn.LAZY_LOADING_MESSAGES_FILTER)),s){var h;d=Nr(Nr({},d),(h=s.getRoomTimelineFilterComponent())===null||h===void 0?void 0:h.toJSON())}Object.keys(d).length&&(c.filter=JSON.stringify(d));var p={prefix:Jt.hasServerSideListSupport===_n.Stable?Ur.V1:"/_matrix/client/unstable/org.matrix.msc3856"};return this.http.authedRequest(_e.Get,l,c,void 0,p).then(m=>{var g;return Nr(Nr({},m),{},{chunk:(g=m.chunk)===null||g===void 0?void 0:g.reverse(),start:m.prev_batch,end:m.next_batch})})}paginateEventTimeline(e,r){var n=this,i=e.getTimelineSet()===this.notifTimelineSet,a=this.getRoom(e.getRoomId()),o=e.getTimelineSet().threadListType,s=e.getTimelineSet().thread;r=r||{};var l=r.backwards||!1;if(i&&!l)throw new Error("paginateNotifTimeline can only paginate backwards");var c=l?Be.BACKWARDS:Be.FORWARDS,d=e.getPaginationToken(c),h=e.paginationRequests[c];if(h)return h;var p,m,g;if(i){var y;p="/notifications",m={limit:((y=r.limit)!==null&&y!==void 0?y:30).toString(),only:"highlight"},d&&d!=="end"&&(m.from=d),g=this.http.authedRequest(_e.Get,p,m).then(function(){var T=K(function*(I){var C=I.next_token,k=[];I.notifications=I.notifications.filter(ya);for(var S=0;S<I.notifications.length;S++){var V=I.notifications[S],z=n.getEventMapper()(V.event);n.getPushDetailsForEvent(z,!0),z.event.room_id=V.room_id,k[S]=z}var j=e.getTimelineSet();return j.addEventsToTimeline(k,l,!1,e,C),n.processAggregatedTimelineEvents(j.room,k),l&&!I.next_token&&e.setPaginationToken(null,c),!!I.next_token});return function(I){return T.apply(this,arguments)}}()).finally(()=>{e.paginationRequests[c]=null}),e.paginationRequests[c]=g}else if(o!==null){if(!a)throw new Error("Unknown room "+e.getRoomId());if(!Jt.hasServerSideFwdPaginationSupport&&c===st.Forward)throw new Error("Cannot paginate threads forwards without server-side support for MSC 3715");g=this.createThreadListMessagesRequest(e.getRoomId(),d,r.limit,c,o,e.getFilter()).then(T=>{if(T.state){var I=e.getState(c),C=T.state.filter(ya).map(this.getEventMapper());I.setUnknownStateEvents(C)}var k=T.end,S=T.chunk.filter(ya).map(this.getEventMapper()),V=e.getTimelineSet();return V.addEventsToTimeline(S,l,!1,e,k),this.processAggregatedTimelineEvents(a,S),this.processThreadRoots(a,S,l),l&&T.end==T.start&&e.setPaginationToken(null,c),T.end!==T.start}).finally(()=>{e.paginationRequests[c]=null}),e.paginationRequests[c]=g}else if(s){var R,b,_=this.getRoom((R=e.getRoomId())!==null&&R!==void 0?R:void 0);if(!_)throw new Error("Unknown room "+e.getRoomId());var x=this.canSupport.get(jr.RelationsRecursion)!==Fr.Unsupported;g=this.fetchRelations((b=e.getRoomId())!==null&&b!==void 0?b:"",s.id,null,null,{dir:c,limit:r.limit,from:d??void 0,recurse:x||void 0}).then(function(){var T=K(function*(I){var C=n.getEventMapper(),k=I.chunk.filter(ya).filter($w(s.id)).map(C);for(var S of k.slice().reverse()){yield s==null?void 0:s.processEvent(S);var V=S.getSender();(!l||(s==null?void 0:s.getEventReadUpTo(V))===null)&&_.addLocalEchoReceipt(V,S,In.Read)}var z=I.next_batch,j=e.getTimelineSet();if(j.addEventsToTimeline(k,l,!1,e,z??null),!z&&l){var J,$,le=(J=s.rootEvent)!==null&&J!==void 0?J:C(yield n.fetchRoomEvent(($=e.getRoomId())!==null&&$!==void 0?$:"",s.id));j.addEventsToTimeline([le],!0,!1,e,null)}return n.processAggregatedTimelineEvents(j.room,k),l&&!z&&e.setPaginationToken(null,c),!!z});return function(I){return T.apply(this,arguments)}}()).finally(()=>{e.paginationRequests[c]=null}),e.paginationRequests[c]=g}else{if(!a)throw new Error("Unknown room "+e.getRoomId());g=this.createMessagesRequest(e.getRoomId(),d,r.limit,c,e.getFilter()).then(T=>{if(T.state){var I=e.getState(c),C=T.state.filter(ya).map(this.getEventMapper());I.setUnknownStateEvents(C)}var k=T.end,S=T.chunk.filter(ya).map(this.getEventMapper()),V=e.getTimelineSet(),[z,,j]=a.partitionThreadedEvents(S);V.addEventsToTimeline(z,l,!1,e,k),this.processAggregatedTimelineEvents(a,z),this.processThreadRoots(a,z.filter($=>$.getServerAggregatedRelation(jt.name)),!1),j.forEach($=>a.relations.aggregateChildEvent($));var J=T.end===void 0||T.end===T.start;return l&&J&&e.setPaginationToken(null,c),!J}).finally(()=>{e.paginationRequests[c]=null}),e.paginationRequests[c]=g}return g}resetNotifTimelineSet(){this.notifTimelineSet&&this.notifTimelineSet.resetLiveTimeline("end")}peekInRoom(e){var r,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:20;return(r=this.peekSync)===null||r===void 0||r.stopPeeking(),this.peekSync=new lu(this,this.clientOpts,this.buildSyncApiOptions()),this.peekSync.peek(e,n)}stopPeeking(){this.peekSync&&(this.peekSync.stopPeeking(),this.peekSync=null)}setGuestAccess(e,r){var n=this.sendStateEvent(e,ge.RoomGuestAccess,{guest_access:r.allowJoin?B0.CanJoin:B0.Forbidden},""),i=Promise.resolve();return r.allowRead&&(i=this.sendStateEvent(e,ge.RoomHistoryVisibility,{history_visibility:s3.WorldReadable},"")),Promise.all([i,n]).then()}requestRegisterEmailToken(e,r,n,i){return this.requestTokenFromEndpoint("/register/email/requestToken",{email:e,client_secret:r,send_attempt:n,next_link:i})}requestRegisterMsisdnToken(e,r,n,i,a){return this.requestTokenFromEndpoint("/register/msisdn/requestToken",{country:e,phone_number:r,client_secret:n,send_attempt:i,next_link:a})}requestAdd3pidEmailToken(e,r,n,i){return this.requestTokenFromEndpoint("/account/3pid/email/requestToken",{email:e,client_secret:r,send_attempt:n,next_link:i})}requestAdd3pidMsisdnToken(e,r,n,i,a){return this.requestTokenFromEndpoint("/account/3pid/msisdn/requestToken",{country:e,phone_number:r,client_secret:n,send_attempt:i,next_link:a})}requestPasswordEmailToken(e,r,n,i){return this.requestTokenFromEndpoint("/account/password/email/requestToken",{email:e,client_secret:r,send_attempt:n,next_link:i})}requestPasswordMsisdnToken(e,r,n,i,a){return this.requestTokenFromEndpoint("/account/password/msisdn/requestToken",{country:e,phone_number:r,client_secret:n,send_attempt:i,next_link:a})}requestTokenFromEndpoint(e,r){var n=this;return K(function*(){var i=Object.assign({},r);return n.http.request(_e.Post,e,void 0,i)})()}getRoomPushRule(e,r){if(this.pushRules){var n;return(n=this.pushRules[e])===null||n===void 0||(n=n.room)===null||n===void 0?void 0:n.find(i=>i.rule_id===r)}else throw new Error("SyncApi.sync() must be done before accessing to push rules.")}setRoomMutePushRule(e,r,n){var i,a=!1,o=this.getRoomPushRule(e,r);if(o!=null&&o.actions.includes(ol.DontNotify)&&(a=!0),!n)a&&(i=this.deletePushRule(e,en.RoomSpecific,o.rule_id));else if(!o)i=this.addPushRule(e,en.RoomSpecific,r,{actions:[ol.DontNotify]});else if(!a){var s=ml();this.deletePushRule(e,en.RoomSpecific,o.rule_id).then(()=>{this.addPushRule(e,en.RoomSpecific,r,{actions:[ol.DontNotify]}).then(()=>{s.resolve()}).catch(l=>{s.reject(l)})}).catch(l=>{s.reject(l)}),i=s.promise}if(i)return new Promise((l,c)=>{i.then(()=>{this.getPushRules().then(d=>{this.pushRules=d,l()}).catch(d=>{c(d)})}).catch(d=>{this.getPushRules().then(h=>{this.pushRules=h,c(d)}).catch(h=>{c(d)})})})}searchMessageText(e){var r={search_term:e.query};return"keys"in e&&(r.keys=e.keys),this.search({body:{search_categories:{room_events:r}}})}searchRoomEvents(e){var r={search_categories:{room_events:{search_term:e.term,filter:e.filter,order_by:UV.Recent,event_context:{before_limit:1,after_limit:1,include_profile:!0}}}},n={_query:r,results:[],highlights:[]};return this.search({body:r}).then(i=>this.processRoomEventsSearch(n,i))}backPaginateRoomEventsSearch(e){if(!e.next_batch)return Promise.reject(new Error("Cannot backpaginate event search any further"));if(e.pendingRequest)return e.pendingRequest;var r={body:e._query,next_batch:e.next_batch},n=this.search(r,e.abortSignal).then(i=>this.processRoomEventsSearch(e,i)).finally(()=>{e.pendingRequest=void 0});return e.pendingRequest=n,n}processRoomEventsSearch(e,r){var n,i,a=r.search_categories.room_events;e.count=a.count,e.next_batch=a.next_batch;var o=new Set(a.highlights);e.highlights.forEach(m=>{o.add(m)}),e.highlights=Array.from(o);for(var s=this.getEventMapper(),l=(n=(i=a.results)===null||i===void 0?void 0:i.length)!==null&&n!==void 0?n:0,c=0;c<l;c++){var d=t_.fromJson(a.results[c],s),h=this.getRoom(d.context.getEvent().getRoomId());if(h)for(var p of d.context.getTimeline())p.setMetadata(h.currentState,!1);e.results.push(d)}return e}syncLeftRooms(){if(this.syncedLeftRooms)return Promise.resolve([]);if(this.syncLeftRoomsPromise)return this.syncLeftRoomsPromise;var e=new lu(this,this.clientOpts,this.buildSyncApiOptions());return this.syncLeftRoomsPromise=e.syncLeftRooms(),this.syncLeftRoomsPromise.then(()=>{this.logger.debug("Marking success of sync left room request"),this.syncedLeftRooms=!0}).finally(()=>{this.syncLeftRoomsPromise=void 0}),this.syncLeftRoomsPromise}createFilter(e){var r=Le("/user/$userId/filter",{$userId:this.credentials.userId});return this.http.authedRequest(_e.Post,r,void 0,e).then(n=>{var i=Yn.fromJson(this.credentials.userId,n.filter_id,e);return this.store.storeFilter(i),i})}getFilter(e,r,n){if(n){var i=this.store.getFilter(e,r);if(i)return Promise.resolve(i)}var a=Le("/user/$userId/filter/$filterId",{$userId:e,$filterId:r});return this.http.authedRequest(_e.Get,a).then(o=>{var s=Yn.fromJson(e,r,o);return this.store.storeFilter(s),s})}getOrCreateFilter(e,r){var n=this;return K(function*(){var i=n.store.getFilterIdByName(e),a;if(i){try{var o=yield n.getFilter(n.credentials.userId,i,!0);if(o){var s=o.getDefinition(),l=r.getDefinition();ef(s,l)&&(a=i)}}catch(d){if(d.errcode!=="M_UNKNOWN"&&d.errcode!=="M_NOT_FOUND")throw d}a||n.store.setFilterIdByName(e,void 0)}if(a)return a;var c=yield n.createFilter(r.getDefinition());return n.store.setFilterIdByName(e,c.filterId),c.filterId})()}getOpenIdToken(){var e=Le("/user/$userId/openid/request_token",{$userId:this.credentials.userId});return this.http.authedRequest(_e.Post,e,void 0,{})}turnServer(){return this.http.authedRequest(_e.Get,"/voip/turnServer")}getTurnServers(){return this.turnServers||[]}getTurnServersExpiry(){return this.turnServersExpiry}get pollingTurnServers(){return this.checkTurnServersIntervalID!==void 0}checkTurnServers(){var e=this;return K(function*(){if(e.canSupportVoip){var r=!1,n=e.turnServersExpiry-Date.now();if(n>Tk)e.logger.debug("TURN creds are valid for another "+n+" ms: not fetching new ones."),r=!0;else{e.logger.debug("Fetching new TURN credentials");try{var i=yield e.turnServer();if(i.uris){e.logger.debug("Got TURN URIs: "+i.uris+" refresh in "+i.ttl+" secs");var a={urls:i.uris,username:i.username,credential:i.password};e.turnServers=[a],e.turnServersExpiry=Date.now()+i.ttl*1e3,r=!0,e.emit(je.TurnServers,e.turnServers)}}catch(o){e.logger.error("Failed to get TURN URIs",o),o.httpStatus===403?(e.logger.info("TURN access unavailable for this account: stopping credentials checks"),e.checkTurnServersIntervalID!==null&&globalThis.clearInterval(e.checkTurnServersIntervalID),e.checkTurnServersIntervalID=void 0,e.emit(je.TurnServersError,o,!0)):e.emit(je.TurnServersError,o,!1)}}return r}})()}setFallbackICEServerAllowed(e){this.fallbackICEServerAllowed=e}isFallbackICEServerAllowed(){return this.fallbackICEServerAllowed}isSynapseAdministrator(){var e=Le("/_synapse/admin/v1/users/$userId/admin",{$userId:this.getUserId()});return this.http.authedRequest(_e.Get,e,void 0,void 0,{prefix:""}).then(r=>r.admin)}whoisSynapseUser(e){var r=Le("/_synapse/admin/v1/whois/$userId",{$userId:e});return this.http.authedRequest(_e.Get,r,void 0,void 0,{prefix:""})}deactivateSynapseUser(e){var r=Le("/_synapse/admin/v1/deactivate/$userId",{$userId:e});return this.http.authedRequest(_e.Post,r,void 0,void 0,{prefix:""})}fetchClientWellKnown(){var e=this;return K(function*(){var r;e.clientWellKnownPromise=tt.getRawClientConfig((r=e.getDomain())!==null&&r!==void 0?r:void 0),e.clientWellKnown=yield e.clientWellKnownPromise,e.emit(je.ClientWellKnown,e.clientWellKnown)})()}getClientWellKnown(){return this.clientWellKnown}waitForClientWellKnown(){if(!this.clientRunning)throw new Error("Client is not running");return this.clientWellKnownPromise}storeClientOptions(){var e=["boolean","string","number"],r=Object.entries(this.clientOpts).filter(n=>{var[i,a]=n;return e.includes(typeof a)}).reduce((n,i)=>{var[a,o]=i;return n[a]=o,n},{});return this.store.storeClientOptions(r)}_unstable_getSharedRooms(e){var r=this;return K(function*(){var n=yield r.doesServerSupportUnstableFeature(iz),i=yield r.doesServerSupportUnstableFeature(az),a=yield r.doesServerSupportUnstableFeature(oz);if(!n&&!i&&!a)throw Error("Server does not support the Mutual Rooms API");var o,s;a?(o="/uk.half-shot.msc2666/user/mutual_rooms",s={user_id:e}):(o=Le("/uk.half-shot.msc2666/user/".concat(i?"mutual_rooms":"shared_rooms","/$userId"),{$userId:e}),s={});var l=[],c=null;do{var d={};c!=null&&a&&(d.batch_token=c);var h=yield r.http.authedRequest(_e.Get,o,Nr(Nr({},s),d),void 0,{prefix:Ur.Unstable});l.push(...h.joined),h.next_batch_token!==void 0?c=h.next_batch_token:c=null}while(c!=null);return l})()}getVersions(){var e=this;return K(function*(){if(e.serverVersionsPromise)return e.serverVersionsPromise;e.serverVersionsPromise=e.http.authedRequest(_e.Get,"/_matrix/client/versions",void 0,void 0,{prefix:""}).catch(n=>{throw e.serverVersionsPromise=void 0,n});var r=yield e.serverVersionsPromise;return e.canSupport=yield Ghe(r),e.serverVersionsPromise})()}isVersionSupported(e){var r=this;return K(function*(){var{versions:n}=yield r.getVersions();return n&&n.includes(e)})()}doesServerSupportUnstableFeature(e){var r=this;return K(function*(){var n=yield r.getVersions();if(!n)return!1;var i=n.unstable_features;return i&&!!i[e]})()}doesServerForceEncryptionForPreset(e){var r=this;return K(function*(){var n=yield r.getVersions();if(!n)return!1;var i=n.unstable_features,a=e.includes("_chat")?e.substring(0,e.indexOf("_chat")):e;return i&&!!i["io.element.e2ee_forced.".concat(a)]})()}doesServerSupportThread(){var e=this;return K(function*(){if(yield e.isVersionSupported("v1.4"))return{threads:_n.Stable,list:_n.Stable,fwdPagination:_n.Stable};try{var[r,n,i,a,o,s]=yield Promise.all([e.doesServerSupportUnstableFeature("org.matrix.msc3440"),e.doesServerSupportUnstableFeature("org.matrix.msc3440.stable"),e.doesServerSupportUnstableFeature("org.matrix.msc3856"),e.doesServerSupportUnstableFeature("org.matrix.msc3856.stable"),e.doesServerSupportUnstableFeature("org.matrix.msc3715"),e.doesServerSupportUnstableFeature("org.matrix.msc3715.stable")]);return{threads:ly(n,r),list:ly(a,i),fwdPagination:ly(s,o)}}catch{return{threads:_n.None,list:_n.None,fwdPagination:_n.None}}})()}hasLazyLoadMembersEnabled(){var e;return!!((e=this.clientOpts)!==null&&e!==void 0&&e.lazyLoadMembers)}setCanResetTimelineCallback(e){this.canResetTimelineCallback=e}getCanResetTimelineCallback(){return this.canResetTimelineCallback}relations(e,r,n,i){var a=arguments,o=this;return K(function*(){var s,l,c=a.length>4&&a[4]!==void 0?a[4]:{dir:st.Backward},d=i?o.getEncryptedIfNeededEventType(e,i):null,[h,p]=yield Promise.all([o.fetchRoomEvent(e,r),o.fetchRelations(e,r,n,d,c)]),m=o.getEventMapper(),g=h?m(h):void 0,y=p.chunk.map(m);if(d===ge.RoomMessageEncrypted){var R=g?y.concat(g):y;yield Promise.all(R.map(b=>o.decryptEventIfNeeded(b))),i!==null&&(y=y.filter(b=>b.getType()===i))}return g&&n===gr.Replace&&(y=y.filter(b=>b.getSender()===g.getSender())),{originalEvent:g??null,events:y,nextBatch:(s=p.next_batch)!==null&&s!==void 0?s:null,prevBatch:(l=p.prev_batch)!==null&&l!==void 0?l:null}})()}generateClientSecret(){return al(32)}decryptEventIfNeeded(e,r){return e.shouldAttemptDecryption()&&this.getCrypto()&&e.attemptDecryption(this.cryptoBackend,r),e.isBeingDecrypted()?e.getDecryptionPromise():Promise.resolve()}termsUrlForService(e,r){switch(e){case Gx.IS:return this.http.getUrl("/terms",void 0,xo.V2,r);case Gx.IM:return this.http.getUrl("/terms",void 0,"/_matrix/integrations/v1",r);default:throw new Error("Unsupported service type")}}getHomeserverUrl(){return this.baseUrl}getIdentityServerUrl(){var e,r,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return n&&((e=this.idBaseUrl)!==null&&e!==void 0&&e.startsWith("http://")||(r=this.idBaseUrl)!==null&&r!==void 0&&r.startsWith("https://"))?this.idBaseUrl.split("://")[1]:this.idBaseUrl}setIdentityServerUrl(e){this.idBaseUrl=gw(e),this.http.setIdBaseUrl(this.idBaseUrl)}getAccessToken(){return this.http.opts.accessToken||null}getRefreshToken(){var e;return(e=this.http.opts.refreshToken)!==null&&e!==void 0?e:null}setAccessToken(e){this.http.opts.accessToken=e,this.serverVersionsPromise=void 0}isLoggedIn(){return this.http.opts.accessToken!==void 0}makeTxnId(){return"m"+new Date().getTime()+"."+this.txnCtr++}isUsernameAvailable(e){return this.http.authedRequest(_e.Get,"/register/available",{username:e}).then(r=>r.available).catch(r=>r.errcode==="M_USER_IN_USE"?!1:Promise.reject(r))}register(e,r,n,i,a,o,s){n&&(i.session=n);var l={auth:i,refresh_token:!0};return e!=null&&(l.username=e),r!=null&&(l.password=r),o!=null&&(l.guest_access_token=o),s!=null&&(l.inhibit_login=s),this.registerRequest(l)}registerGuest(){var{body:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.registerRequest(e||{},"guest")}registerRequest(e,r){var n={};return r&&(n.kind=r),this.http.request(_e.Post,"/register",n,e)}refreshToken(e){var r=n=>this.http.authedRequest(_e.Post,"/refresh",void 0,{refresh_token:e},{prefix:n,inhibitLogoutEmit:!0});return r(Ur.V3).catch(n=>{if(n.errcode==="M_UNRECOGNIZED")return r(Ur.V1);throw n})}loginFlows(){return this.http.request(_e.Get,"/login")}login(e,r){return this.loginRequest(Nr(Nr({},r),{},{type:e})).then(n=>(n.access_token&&n.user_id&&(this.http.opts.accessToken=n.access_token,this.credentials={userId:n.user_id}),n))}loginWithPassword(e,r){return this.login("m.login.password",{user:e,password:r})}getCasLoginUrl(e){return this.getSsoLoginUrl(e,"cas")}getSsoLoginUrl(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"sso",n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,a="/login/"+r+"/redirect";n&&(a+="/"+n);var o={redirectUrl:e,[ove.unstable]:i};return this.http.getUrl(a,o).href}loginWithToken(e){return this.login("m.login.token",{token:e})}loginRequest(e){var r=this;return K(function*(){return yield r.http.authedRequest(_e.Post,"/login",void 0,e)})()}logout(){var e=arguments,r=this;return K(function*(){var n=e.length>0&&e[0]!==void 0?e[0]:!1;return n&&(r.stopClient(),r.http.abort()),r.http.authedRequest(_e.Post,"/logout")})()}deactivateAccount(e,r){var n={};return e&&(n.auth=e),r!==void 0&&(n.erase=r),this.http.authedRequest(_e.Post,"/account/deactivate",void 0,n)}requestLoginToken(e){var r=this;return K(function*(){var n={auth:e};return r.http.authedRequest(_e.Post,"/login/get_token",void 0,n,{prefix:Ur.V1})})()}getFallbackAuthUrl(e,r){var n=Le("/auth/$loginType/fallback/web",{$loginType:e});return this.http.getUrl(n,{session:r}).href}createRoom(e){var r=this;return K(function*(){var n,i=(e.invite_3pid||[]).filter(s=>!s.id_access_token);if(i.length>0&&(n=r.identityServer)!==null&&n!==void 0&&n.getAccessToken){var a=yield r.identityServer.getAccessToken();if(a)for(var o of i)o.id_access_token=a}return r.http.authedRequest(_e.Post,"/createRoom",void 0,e)})()}fetchRelations(e,r,n,i){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{dir:st.Backward},o=a;Jt.hasServerSideFwdPaginationSupport===_n.Experimental&&(o=rA("dir","org.matrix.msc3715.dir",o)),this.canSupport.get(jr.RelationsRecursion)===Fr.Unstable&&(o=rA("recurse","org.matrix.msc3981.recurse",o));var s=rx(o),l="/rooms/$roomId/relations/$eventId";n!==null?(l+="/$relationType",i!==null&&(l+="/$eventType")):i!==null&&(this.logger.warn("eventType: ".concat(i,` ignored when fetching
            relations as relationType is null`)),i=null);var c=Le(l+"?"+s,{$roomId:e,$eventId:r,$relationType:n,$eventType:i});return this.http.authedRequest(_e.Get,c,void 0,void 0,{prefix:Ur.V1})}roomState(e){var r=Le("/rooms/$roomId/state",{$roomId:e});return this.http.authedRequest(_e.Get,r)}fetchRoomEvent(e,r){var n=Le("/rooms/$roomId/event/$eventId",{$roomId:e,$eventId:r});return this.http.authedRequest(_e.Get,n)}members(e,r,n,i){var a={};r&&(a.membership=r),n&&(a.not_membership=n),i&&(a.at=i);var o=rx(a),s=Le("/rooms/$roomId/members?"+o,{$roomId:e});return this.http.authedRequest(_e.Get,s)}upgradeRoom(e,r){var n=Le("/rooms/$roomId/upgrade",{$roomId:e});return this.http.authedRequest(_e.Post,n,void 0,{new_version:r})}getStateEvent(e,r,n){var i={$roomId:e,$eventType:r,$stateKey:n},a=Le("/rooms/$roomId/state/$eventType",i);return n!==void 0&&(a=Le(a+"/$stateKey",i)),this.http.authedRequest(_e.Get,a)}sendStateEvent(e,r,n){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"",a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{},o={$roomId:e,$eventType:r,$stateKey:i},s=Le("/rooms/$roomId/state/$eventType",o);return i!==void 0&&(s=Le(s+"/$stateKey",o)),this.http.authedRequest(_e.Put,s,void 0,n,a)}roomInitialSync(e,r){var n,i=Le("/rooms/$roomId/initialSync",{$roomId:e});return this.http.authedRequest(_e.Get,i,{limit:(n=r==null?void 0:r.toString())!==null&&n!==void 0?n:"30"})}setRoomReadMarkersHttpRequest(e,r,n,i){var a=this;return K(function*(){var o=Le("/rooms/$roomId/read_markers",{$roomId:e}),s={[In.FullyRead]:r,[In.Read]:n};return((yield a.doesServerSupportUnstableFeature("org.matrix.msc2285.stable"))||(yield a.isVersionSupported("v1.4")))&&(s[In.ReadPrivate]=i),a.http.authedRequest(_e.Post,o,void 0,s)})()}getJoinedRooms(){var e=Le("/joined_rooms",{});return this.http.authedRequest(_e.Get,e)}getJoinedRoomMembers(e){var r=Le("/rooms/$roomId/joined_members",{$roomId:e});return this.http.authedRequest(_e.Get,r)}publicRooms(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{server:r,limit:n,since:i}=e,a=Xfe(e,rve);if(Object.keys(a).length===0){var o={server:r,limit:n,since:i};return this.http.authedRequest(_e.Get,"/publicRooms",o)}else{var s={server:r},l=Nr({limit:n,since:i},a);return this.http.authedRequest(_e.Post,"/publicRooms",s,l)}}createAlias(e,r){var n=Le("/directory/room/$alias",{$alias:e}),i={room_id:r};return this.http.authedRequest(_e.Put,n,void 0,i)}deleteAlias(e){var r=Le("/directory/room/$alias",{$alias:e});return this.http.authedRequest(_e.Delete,r)}getLocalAliases(e){var r=Le("/rooms/$roomId/aliases",{$roomId:e}),n=Ur.V3;return this.http.authedRequest(_e.Get,r,void 0,void 0,{prefix:n})}getRoomIdForAlias(e){var r=Le("/directory/room/$alias",{$alias:e});return this.http.authedRequest(_e.Get,r)}getRoomDirectoryVisibility(e){var r=Le("/directory/list/room/$roomId",{$roomId:e});return this.http.authedRequest(_e.Get,r)}setRoomDirectoryVisibility(e,r){var n=Le("/directory/list/room/$roomId",{$roomId:e});return this.http.authedRequest(_e.Put,n,void 0,{visibility:r})}searchUserDirectory(e){var{term:r,limit:n}=e,i={search_term:r};return n!==void 0&&(i.limit=n),this.http.authedRequest(_e.Post,"/user_directory/search",void 0,i)}uploadContent(e,r){return this.http.uploadContent(e,r)}cancelUpload(e){return this.http.cancelUpload(e)}getCurrentUploads(){return this.http.getCurrentUploads()}getProfileInfo(e,r){var n=r?Le("/profile/$userId/$info",{$userId:e,$info:r}):Le("/profile/$userId",{$userId:e});return this.http.authedRequest(_e.Get,n)}doesServerSupportExtendedProfiles(){var e=this;return K(function*(){return e.doesServerSupportUnstableFeature(sz)})()}getExtendedProfileRequestPrefix(){var e=this;return K(function*(){return(yield e.doesServerSupportUnstableFeature("uk.tcpip.msc4133.stable"))?Ur.V3:"/_matrix/client/unstable/uk.tcpip.msc4133"})()}getExtendedProfile(e){var r=this;return K(function*(){if(!(yield r.doesServerSupportExtendedProfiles()))throw new Error("Server does not support extended profiles");return r.http.authedRequest(_e.Get,Le("/profile/$userId",{$userId:e}),void 0,void 0,{prefix:yield r.getExtendedProfileRequestPrefix()})})()}getExtendedProfileProperty(e,r){var n=this;return K(function*(){if(!(yield n.doesServerSupportExtendedProfiles()))throw new Error("Server does not support extended profiles");var i=yield n.http.authedRequest(_e.Get,Le("/profile/$userId/$key",{$userId:e,$key:r}),void 0,void 0,{prefix:yield n.getExtendedProfileRequestPrefix()});return i[r]})()}setExtendedProfileProperty(e,r){var n=this;return K(function*(){if(!(yield n.doesServerSupportExtendedProfiles()))throw new Error("Server does not support extended profiles");var i=n.getUserId();yield n.http.authedRequest(_e.Put,Le("/profile/$userId/$key",{$userId:i,$key:e}),void 0,{[e]:r},{prefix:yield n.getExtendedProfileRequestPrefix()})})()}deleteExtendedProfileProperty(e){var r=this;return K(function*(){if(!(yield r.doesServerSupportExtendedProfiles()))throw new Error("Server does not support extended profiles");var n=r.getUserId();yield r.http.authedRequest(_e.Delete,Le("/profile/$userId/$key",{$userId:n,$key:e}),void 0,void 0,{prefix:yield r.getExtendedProfileRequestPrefix()})})()}patchExtendedProfile(e){var r=this;return K(function*(){if(!(yield r.doesServerSupportExtendedProfiles()))throw new Error("Server does not support extended profiles");var n=r.getUserId();return r.http.authedRequest(_e.Patch,Le("/profile/$userId",{$userId:n}),{},e,{prefix:yield r.getExtendedProfileRequestPrefix()})})()}setExtendedProfile(e){var r=this;return K(function*(){if(!(yield r.doesServerSupportExtendedProfiles()))throw new Error("Server does not support extended profiles");var n=r.getUserId();yield r.http.authedRequest(_e.Put,Le("/profile/$userId",{$userId:n}),{},e,{prefix:yield r.getExtendedProfileRequestPrefix()})})()}getThreePids(){return this.http.authedRequest(_e.Get,"/account/3pid")}addThreePidOnly(e){var r=this;return K(function*(){var n="/account/3pid/add";return r.http.authedRequest(_e.Post,n,void 0,e)})()}bindThreePid(e){var r=this;return K(function*(){var n="/account/3pid/bind";return r.http.authedRequest(_e.Post,n,void 0,e)})()}unbindThreePid(e,r){var n=this;return K(function*(){var i="/account/3pid/unbind",a={medium:e,address:r,id_server:n.getIdentityServerUrl(!0)};return n.http.authedRequest(_e.Post,i,void 0,a)})()}deleteThreePid(e,r){var n="/account/3pid/delete";return this.http.authedRequest(_e.Post,n,void 0,{medium:e,address:r})}setPassword(e,r,n){var i="/account/password",a={auth:e,new_password:r,logout_devices:n};return this.http.authedRequest(_e.Post,i,void 0,a)}getDevices(){return this.http.authedRequest(_e.Get,"/devices")}getDevice(e){var r=Le("/devices/$device_id",{$device_id:e});return this.http.authedRequest(_e.Get,r)}setDeviceDetails(e,r){var n=Le("/devices/$device_id",{$device_id:e});return this.http.authedRequest(_e.Put,n,void 0,r)}deleteDevice(e,r){var n=Le("/devices/$device_id",{$device_id:e}),i={};return r&&(i.auth=r),this.http.authedRequest(_e.Delete,n,void 0,i)}deleteMultipleDevices(e,r){var n={devices:e};r&&(n.auth=r);var i="/delete_devices";return this.http.authedRequest(_e.Post,i,void 0,n)}getPushers(){var e=this;return K(function*(){var r=yield e.http.authedRequest(_e.Get,"/pushers");return(yield e.doesServerSupportUnstableFeature("org.matrix.msc3881"))||(r.pushers=r.pushers.map(n=>(n.hasOwnProperty(hx.name)||(n[hx.name]=!0),n))),r})()}setPusher(e){var r="/pushers/set";return this.http.authedRequest(_e.Post,r,void 0,e)}removePusher(e,r){var n="/pushers/set",i={pushkey:e,app_id:r,kind:null};return this.http.authedRequest(_e.Post,n,void 0,i)}setLocalNotificationSettings(e,r){var n="".concat(Bj.name,".").concat(e);return this.setAccountData(n,r)}getPushRules(){return this.http.authedRequest(_e.Get,"/pushrules/").then(e=>(this.setPushRules(e),this.pushRules))}setPushRules(e){this.pushRules=ga.rewriteDefaultRules(e,this.getUserId()),this.pushProcessor.updateCachedPushRuleKeys(this.pushRules)}addPushRule(e,r,n,i){var a=Le("/pushrules/"+e+"/$kind/$ruleId",{$kind:r,$ruleId:n});return this.http.authedRequest(_e.Put,a,void 0,i)}deletePushRule(e,r,n){var i=Le("/pushrules/"+e+"/$kind/$ruleId",{$kind:r,$ruleId:n});return this.http.authedRequest(_e.Delete,i)}setPushRuleEnabled(e,r,n,i){var a=Le("/pushrules/"+e+"/$kind/$ruleId/enabled",{$kind:r,$ruleId:n});return this.http.authedRequest(_e.Put,a,void 0,{enabled:i})}setPushRuleActions(e,r,n,i){var a=Le("/pushrules/"+e+"/$kind/$ruleId/actions",{$kind:r,$ruleId:n});return this.http.authedRequest(_e.Put,a,void 0,{actions:i})}search(e,r){var{body:n,next_batch:i}=e,a={};return i&&(a.next_batch=i),this.http.authedRequest(_e.Post,"/search",a,n,{abortSignal:r})}uploadKeysRequest(e,r){return this.http.authedRequest(_e.Post,"/keys/upload",void 0,e)}uploadKeySignatures(e){return this.http.authedRequest(_e.Post,"/keys/signatures/upload",void 0,e)}downloadKeysForUsers(e){var{token:r}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n={device_keys:{}};return r!==void 0&&(n.token=r),e.forEach(i=>{n.device_keys[i]=[]}),this.http.authedRequest(_e.Post,"/keys/query",void 0,n)}claimOneTimeKeys(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"signed_curve25519",n=arguments.length>2?arguments[2]:void 0,i={};r===void 0&&(r="signed_curve25519");for(var[a,o]of e){var s=i[a]||{};C0(i,a,s),C0(s,o,r)}var l={one_time_keys:i};n&&(l.timeout=n);var c="/keys/claim";return this.http.authedRequest(_e.Post,c,void 0,l)}getKeyChanges(e,r){var n={from:e,to:r};return this.http.authedRequest(_e.Get,"/keys/changes",n)}uploadDeviceSigningKeys(e,r){var n=Object.assign({},r);return e&&Object.assign(n,{auth:e}),this.http.authedRequest(_e.Post,"/keys/device_signing/upload",void 0,n,{prefix:Ur.Unstable})}registerWithIdentityServer(e){if(!this.idBaseUrl)throw new Error("No identity server base URL set");var r=this.http.getUrl("/account/register",void 0,xo.V2,this.idBaseUrl);return this.http.requestOtherUrl(_e.Post,r,e)}requestEmailToken(e,r,n,i,a){var o={client_secret:r,email:e,send_attempt:n==null?void 0:n.toString()};return i&&(o.next_link=i),this.http.idServerRequest(_e.Post,"/validate/email/requestToken",o,xo.V2,a)}requestMsisdnToken(e,r,n,i,a,o){var s={client_secret:n,country:e,phone_number:r,send_attempt:i==null?void 0:i.toString()};return a&&(s.next_link=a),this.http.idServerRequest(_e.Post,"/validate/msisdn/requestToken",s,xo.V2,o)}submitMsisdnToken(e,r,n,i){var a={sid:e,client_secret:r,token:n};return this.http.idServerRequest(_e.Post,"/validate/msisdn/submitToken",a,xo.V2,i??void 0)}submitMsisdnTokenOtherUrl(e,r,n,i){var a={sid:r,client_secret:n,token:i};return this.http.requestOtherUrl(_e.Post,e,a)}getIdentityHashDetails(e){return this.http.idServerRequest(_e.Get,"/hash_details",void 0,xo.V2,e)}identityHashedLookup(e,r){var n=this;return K(function*(){var i={},a=yield n.getIdentityHashDetails(r);if(!a||!a.lookup_pepper||!a.algorithms)throw new Error("Unsupported identity server: bad response");i.pepper=a.lookup_pepper;var o={};if(a.algorithms.includes("sha256"))i.addresses=yield Promise.all(e.map(function(){var p=K(function*(m){var g=m[0].toLowerCase(),y=m[1].toLowerCase(),R=yield WV("".concat(g," ").concat(y," ").concat(i.pepper)),b=Qb(R);return o[b]=m[0],b});return function(m){return p.apply(this,arguments)}}())),i.algorithm="sha256";else if(a.algorithms.includes("none"))i.addresses=e.map(p=>{var m=p[0].toLowerCase(),g=p[1].toLowerCase(),y="".concat(m," ").concat(g);return o[y]=p[0],y}),i.algorithm="none";else throw new Error("Unsupported identity server: unknown hash algorithm");var s=yield n.http.idServerRequest(_e.Post,"/lookup",i,xo.V2,r);if(!(s!=null&&s.mappings))return[];var l=[];for(var c of Object.keys(s.mappings)){var d=s.mappings[c],h=o[c];if(!h)throw new Error("Identity server returned more results than expected");l.push({address:h,mxid:d})}return l})()}lookupThreePid(e,r,n){var i=this;return K(function*(){var a=yield i.identityHashedLookup([[r,e]],n),o=a.find(l=>l.address===r);if(!o)return{};var s={address:r,medium:e,mxid:o.mxid};return s})()}bulkLookupThreePids(e,r){var n=this;return K(function*(){var i=yield n.identityHashedLookup(e.map(l=>[l[1],l[0]]),r),a=[],o=function*(c){var d=e.find(h=>h[1]===c.address);if(!d)throw new Error("Identity sever returned unexpected results");a.push([d[0],c.address,c.mxid])};for(var s of i)yield*o(s);return{threepids:a}})()}getIdentityAccount(e){return this.http.idServerRequest(_e.Get,"/account",void 0,xo.V2,e)}sendToDevice(e,r,n){var i=Le("/sendToDevice/$eventType/$txnId",{$eventType:e,$txnId:n||this.makeTxnId()}),a={messages:ou(r)},o=new Map;for(var[s,l]of r)o.set(s,Array.from(l.keys()));return this.logger.debug("PUT ".concat(i),o),this.http.authedRequest(_e.Put,i,void 0,a)}encryptAndSendToDevice(e,r,n){var i=this;return K(function*(){if(!i.cryptoBackend)throw new Error("Cannot encrypt to device event, your client does not support encryption.");var a=yield i.cryptoBackend.encryptToDeviceMessages(e,r,n);yield i.queueToDevice(a)})()}queueToDevice(e){return this.toDeviceMessageQueue.queueBatch(e)}getThirdpartyProtocols(){return this.http.authedRequest(_e.Get,"/thirdparty/protocols").then(e=>{if(!e||typeof e!="object")throw new Error("/thirdparty/protocols did not return an object: ".concat(e));return e})}getThirdpartyLocation(e,r){var n=Le("/thirdparty/location/$protocol",{$protocol:e});return this.http.authedRequest(_e.Get,n,r)}getThirdpartyUser(e,r){var n=Le("/thirdparty/user/$protocol",{$protocol:e});return this.http.authedRequest(_e.Get,n,r)}getTerms(e,r){var n=this.termsUrlForService(e,r);return this.http.requestOtherUrl(_e.Get,n)}agreeToTerms(e,r,n,i){var a=this.termsUrlForService(e,r),o={Authorization:"Bearer "+n};return this.http.requestOtherUrl(_e.Post,a,{user_accepts:i},{headers:o})}reportEvent(e,r,n,i){var a=Le("/rooms/$roomId/report/$eventId",{$roomId:e,$eventId:r});return this.http.authedRequest(_e.Post,a,void 0,{score:n,reason:i})}reportRoom(e,r){var n=Le("/rooms/$roomId/report",{$roomId:e});return this.http.authedRequest(_e.Post,n,void 0,{reason:r})}getRoomHierarchy(e,r,n){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,a=arguments.length>4?arguments[4]:void 0,o=Le("/rooms/$roomId/hierarchy",{$roomId:e}),s={suggested_only:String(i),max_depth:n==null?void 0:n.toString(),from:a,limit:r==null?void 0:r.toString()};return this.http.authedRequest(_e.Get,o,s,void 0,{prefix:Ur.V1}).catch(l=>{if(l.errcode==="M_UNRECOGNIZED")return this.http.authedRequest(_e.Get,o,s,void 0,{prefix:"/_matrix/client/unstable/org.matrix.msc2946"});throw l})}unstableCreateFileTree(e){var r=this;return K(function*(){var{room_id:n}=yield r.createRoom({name:e,preset:o3.PrivateChat,power_level_content_override:Nr(Nr({},Xpe),{},{users:{[r.getUserId()]:100}}),creation_content:{[T0]:Sd.Space},initial_state:[{type:ux.name,state_key:dx.name,content:{[cx.name]:!0}},{type:ge.RoomEncryption,state_key:"",content:{algorithm:"m.megolm.v1.aes-sha2"}}]});return new ck(r,n)})()}unstableGetFileTreeSpace(e){var r,n,i=this.getRoom(e);if((i==null?void 0:i.getMyMembership())!==ct.Join)return null;var a=i.currentState.getStateEvents(ge.RoomCreate,""),o=i.currentState.getStateEvents(ux.name,dx.name);if(!a)throw new Error("Expected single room create event");return!(o!=null&&(r=o.getContent())!==null&&r!==void 0&&r[cx.name])||((n=a.getContent())===null||n===void 0?void 0:n[T0])!==Sd.Space?null:new ck(this,e)}slidingSync(e,r,n){var i={};e.pos&&(i.pos=e.pos,delete e.pos),e.timeout&&(i.timeout=e.timeout,delete e.timeout);var a=e.clientTimeout;return delete e.clientTimeout,this.http.authedRequest(_e.Post,"/sync",i,e,{prefix:"/_matrix/client/unstable/org.matrix.simplified_msc3575",baseUrl:r,localTimeoutMs:a,abortSignal:n})}supportsThreads(){var e;return((e=this.clientOpts)===null||e===void 0?void 0:e.threadSupport)||!1}supportsIntentionalMentions(){return this.canSupport.get(jr.IntentionalMentions)!==Fr.Unsupported}getRoomSummary(e,r){var n=this;return K(function*(){var i={prefix:"/_matrix/client/unstable/im.nheko.summary"};try{var a=Le("/summary/$roomid",{$roomid:e});return yield n.http.authedRequest(_e.Get,a,{via:r},void 0,i)}catch(s){if(s instanceof ur&&s.errcode==="M_UNRECOGNIZED"){var o=Le("/rooms/$roomid/summary",{$roomid:e});return yield n.http.authedRequest(_e.Get,o,{via:r},void 0,i)}else throw s}})()}processThreadEvents(e,r,n){e.processThreadedEvents(r,n)}processThreadRoots(e,r,n){this.supportsThreads()&&e.processThreadRoots(r,n)}processBeaconEvents(e,r){this.processAggregatedTimelineEvents(e,r)}processAggregatedTimelineEvents(e,r){r!=null&&r.length&&e&&(e.currentState.processBeaconEvents(r,this),e.processPollEvents(r))}whoami(){var e=this;return K(function*(){return e.http.authedRequest(_e.Get,"/account/whoami")})()}timestampToEvent(e,r,n){var i=this;return K(function*(){var a=Le("/rooms/$roomId/timestamp_to_event",{$roomId:e}),o={ts:r.toString(),dir:n};try{return yield i.http.authedRequest(_e.Get,a,o,void 0,{prefix:Ur.V1})}catch(s){if(s.errcode==="M_UNRECOGNIZED"&&(s.httpStatus===400||s.httpStatus===404||s.httpStatus===405))return yield i.http.authedRequest(_e.Get,a,o,void 0,{prefix:"/_matrix/client/unstable/org.matrix.msc3030"});throw s}})()}getAuthIssuer(){var e=this;return K(function*(){return e.http.request(_e.Get,"/auth_issuer",void 0,void 0,{prefix:Ur.Unstable+"/org.matrix.msc2965"})})()}getAuthMetadata(){var e=this;return K(function*(){var r;try{r=yield e.http.request(_e.Get,"/auth_metadata",void 0,void 0,{prefix:Ur.Unstable+"/org.matrix.msc2965"})}catch(i){if(i instanceof ur&&i.errcode==="M_UNRECOGNIZED"){var{issuer:n}=yield e.getAuthIssuer();return y3(n)}throw i}return b3(r)})()}}E(i_,"RESTORE_BACKUP_ERROR_BAD_KEY","RESTORE_BACKUP_ERROR_BAD_KEY");function Dk(t){return Object.fromEntries(Object.entries(t).map(e=>{var[r,n]=e;return["".concat(Ka,".").concat(r),n]}))}function lz(t,e){var r,n=t.getUserId(),i=e.getId(),a=t.getRoom(e.getRoomId());if(!(!a||!n||!i)){if(!a.findEventById(i)){U.info("Decrypted event ".concat(e.getId()," is not in room ").concat(a.roomId,": ignoring"));return}var o=!!e.threadRootId&&!e.isThreadRoot,s;if(o){var l=a.getThread(e.threadRootId);s=l?l.hasUserReadEvent(n,i):!0}else s=a.hasUserReadEvent(n,i);if(!s){var c=t.getPushActionsForEvent(e,!0),d=!!(c!=null&&(r=c.tweaks)!==null&&r!==void 0&&r.highlight);if(d){var h=a.getUnreadCountForEventContext(It.Highlight,e)+1;o?a.setThreadUnreadNotificationCount(e.threadRootId,It.Highlight,h):a.setUnreadNotificationCount(It.Highlight,h)}var p=!!(c!=null&&c.notify);if(p){var m=a.getUnreadCountForEventContext(It.Total,e)+1;o?a.setThreadUnreadNotificationCount(e.threadRootId,It.Total,m):a.setUnreadNotificationCount(It.Total,m)}}}}function lf(t){return um(t)?Zm:t.threadRootId}function um(t){if(!t.threadRootId||t.isThreadRoot)return!0;if(!t.isRelation())return U.warn("Event is not a relation or a thread root, but still has a threadRootId! id=".concat(t.getId())),!0;if(t.isRelation(jt.name))return!1;var e=t.relationEventId===t.threadRootId;return e}function Rk(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Mk(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Rk(Object(r),!0).forEach(function(n){E(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Rk(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var Pn=function(t){return t.New="Thread.new",t.Update="Thread.update",t.NewReply="Thread.newReply",t.ViewThread="Thread.viewThread",t.Delete="Thread.delete",t}({}),_n=function(t){return t[t.None=0]="None",t[t.Experimental=1]="Experimental",t[t.Stable=2]="Stable",t}({});function ly(t,e){return t?_n.Stable:e?_n.Experimental:_n.None}class Jt extends hV{constructor(e,r,n){var i,a;if(super(),i=this,this.id=e,this.rootEvent=r,E(this,"timelineSet",void 0),E(this,"_currentUserParticipated",!1),E(this,"reEmitter",void 0),E(this,"lastEvent",void 0),E(this,"replyCount",0),E(this,"lastPendingEvent",void 0),E(this,"pendingReplyCount",0),E(this,"room",void 0),E(this,"client",void 0),E(this,"pendingEventOrdering",void 0),E(this,"processRootEventPromise",void 0),E(this,"initialEventsFetched",!Jt.hasServerSideSupport),E(this,"initalEventFetchProm",void 0),E(this,"replayEvents",[]),E(this,"onTimelineReset",K(function*(){yield i.processRootEventPromise,i.processRootEventPromise=void 0})),E(this,"onBeforeRedaction",(o,s)=>{o!=null&&o.isRelation(jt.name)&&this.room.eventShouldLiveIn(o).threadId===this.id&&o.getId()!==this.id&&!s.status&&(this.replyCount--,this.updatePendingReplyCount(),this.emit(Pn.Update,this))}),E(this,"onRedaction",function(){var o=K(function*(s,l,c){if(c===i.id)if(i.replyCount<=0){for(var d of i.timeline)i.clearEventMetadata(d);i.lastEvent=i.rootEvent,i._currentUserParticipated=!1,i.emit(Pn.Delete,i)}else{var h;((h=i.lastEvent)===null||h===void 0?void 0:h.getId())===s.getAssociatedId()&&(yield i.processRootEventPromise,i.processRootEventPromise=void 0),yield i.updateThreadMetadata()}});return function(s,l,c){return o.apply(this,arguments)}}()),E(this,"onTimelineEvent",(o,s,l)=>{if(!l){var c=o.getSender();c&&s&&this.shouldSendLocalEchoReceipt(c,o)&&s.addLocalEchoReceipt(c,o,In.Read),o.getId()!==this.id&&o.isRelation(jt.name)&&this.replyCount++}this.onEcho(o,l??!1)}),E(this,"onLocalEcho",o=>{this.onEcho(o,!1)}),E(this,"onEcho",function(){var o=K(function*(s,l){s.threadRootId===i.id&&i.lastEvent!==s&&(yield i.updateThreadMetadata(),s.isRelation(jt.name)&&(l||(i.lastEvent=void 0,i.emit(Pn.NewReply,i,s))))});return function(s,l){return o.apply(this,arguments)}}()),this.setMaxListeners(1e3),!(n!=null&&n.room))throw new Error("element-web#22141: A thread requires a room in order to function");this.room=n.room,this.client=n.client,this.pendingEventOrdering=(a=n.pendingEventOrdering)!==null&&a!==void 0?a:sf.Chronological,this.timelineSet=new Qc(this.room,{timelineSupport:!0,pendingEvents:!0},this.client,this),this.reEmitter=new kf(this),this.reEmitter.reEmit(this.timelineSet,[Ue.Timeline,Ue.TimelineReset]),this.room.on(At.BeforeRedaction,this.onBeforeRedaction),this.room.on(Ue.Redaction,this.onRedaction),this.room.on(Ue.LocalEchoUpdated,this.onLocalEcho),this.room.on(Ue.TimelineReset,this.onTimelineReset),this.timelineSet.on(Ue.Timeline,this.onTimelineEvent),this.processReceipts(n.receipts),this.updateThreadMetadata(),this.setEventMetadata(this.rootEvent)}fetchRootEvent(){var e=this;return K(function*(){try{var r=yield e.client.fetchRoomEvent(e.roomId,e.id),n=e.client.getEventMapper();e.rootEvent=n(r)}catch(i){U.error("Failed to fetch thread root to construct thread with",i)}yield e.processEvent(e.rootEvent)})()}static setServerSideSupport(e){Jt.hasServerSideSupport=e,e!==_n.Stable&&(Rd.setPreferUnstable(!0),Md.setPreferUnstable(!0),jt.setPreferUnstable(!0))}static setServerSideListSupport(e){Jt.hasServerSideListSupport=e}static setServerSideFwdPaginationSupport(e){Jt.hasServerSideFwdPaginationSupport=e}shouldSendLocalEchoReceipt(e,r){var n,i=(n=this.client.canSupport.get(jr.RelationsRecursion))!==null&&n!==void 0?n:Fr.Unsupported;if(i===Fr.Unsupported){var a,o=(a=this.getReadReceiptForUserId(e))===null||a===void 0?void 0:a.eventId;if(o){var s=this.findEventById(o);if(s&&s.getTs()>r.getTs())return!1}}return!0}get roomState(){return this.room.getLiveTimeline().getState(Be.FORWARDS)}addEventToTimeline(e,r){this.findEventById(e.getId())||this.timelineSet.addEventToTimeline(e,this.liveTimeline,{toStartOfTimeline:r,fromCache:!1,roomState:this.roomState,addToState:!1})}insertEventIntoTimeline(e){var r=e.getId();r&&(this.findEventById(r)||this.timelineSet.insertEventIntoTimeline(e,this.liveTimeline,this.roomState,!1))}addEvents(e,r){e.forEach(n=>this.addEvent(n,r,!1)),this.updateThreadMetadata()}addEvent(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setEventMetadata(e);var i=this.lastReply(),a=!i||e.localTimestamp>=i.localTimestamp;if(!Jt.hasServerSideSupport)this.addEventToTimeline(e,r),this.client.decryptEventIfNeeded(e);else if(e.isRelation(gr.Annotation)||e.isRelation(gr.Replace)){this.addRelatedThreadEvent(e,r);return}else!r&&a?(this.addEventToTimeline(e,!1),this.fetchEditsWhereNeeded(e)):r?this.addEventToTimeline(e,r):this.insertEventIntoTimeline(e);e.getId()!==this.id&&e.isRelation(jt.name)&&!r&&a&&(this.lastEvent=void 0),n&&(this.emit(Pn.NewReply,this,e),this.updateThreadMetadata())}addRelatedThreadEvent(e,r){var n,i;if(this.initialEventsFetched){var o,s=(o=this.client.canSupport.get(jr.RelationsRecursion))!==null&&o!==void 0?o:Fr.Unsupported;s===Fr.Unsupported?this.insertEventIntoTimeline(e):this.addEventToTimeline(e,r)}else{var a;(a=this.replayEvents)===null||a===void 0||a.push(e)}(n=this.timelineSet.relations)===null||n===void 0||n.aggregateParentEvent(e),(i=this.timelineSet.relations)===null||i===void 0||i.aggregateChildEvent(e,this.timelineSet)}processEvent(e){var r=this;return K(function*(){e&&(r.setEventMetadata(e),yield r.fetchEditsWhereNeeded(e))})()}processReceipts(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];for(var{eventId:r,receiptType:n,userId:i,receipt:a,synthetic:o}of e)this.addReceiptToStructure(r,n,i,a,o)}getRootEventBundledRelationship(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.rootEvent;return e==null?void 0:e.getServerAggregatedRelation(jt.name)}processRootEvent(){var e=this;return K(function*(){var r=e.getRootEventBundledRelationship();if(Jt.hasServerSideSupport&&r){e.replyCount=r.count,e._currentUserParticipated=!!r.current_user_participated;var n=e.client.getEventMapper();e.lastEvent=n(Mk(Mk({},r.latest_event),{},{room_id:e.roomId})),e.updatePendingReplyCount(),yield e.processEvent(e.lastEvent)}})()}updatePendingReplyCount(){var e=this.pendingEventOrdering===sf.Detached?this.room.getPendingEvents():this.events,r=e.filter(n=>{var i;return n.threadRootId===this.id&&n.isRelation(jt.name)&&n.status!==null&&n.getId()!==((i=this.lastEvent)===null||i===void 0?void 0:i.getId())});this.lastPendingEvent=r.length?r[r.length-1]:void 0,this.pendingReplyCount=r.length}resetLiveTimeline(e,r){var n=this;return K(function*(){var i=n.liveTimeline;n.timelineSet.resetLiveTimeline(e??void 0,r??void 0);var a=n.liveTimeline,o,s;if(e){var l=yield n.client.createMessagesRequest(n.roomId,e,1,st.Forward);o=l.end}if(r){var c=yield n.client.createMessagesRequest(n.roomId,r,1,st.Backward);s=c.start}r&&i.getPaginationToken(st.Forward)===r&&i.setPaginationToken(s??null,st.Forward),e&&a.getPaginationToken(st.Backward)===e&&a.setPaginationToken(o??null,st.Backward)})()}updateThreadFromRootEvent(){var e=this;return K(function*(){Jt.hasServerSideSupport&&(!e.initialEventsFetched&&!e.lastEvent&&(yield e.processRootEvent()),yield e.fetchRootEvent()),yield e.processRootEvent()})()}updateThreadMetadata(){var e=this;return K(function*(){if(e.updatePendingReplyCount(),e.processRootEventPromise||(e.processRootEventPromise=e.updateThreadFromRootEvent()),yield e.processRootEventPromise,!e.initialEventsFetched)if(e.initalEventFetchProm)yield e.initalEventFetchProm;else try{e.timelineSet.resetLiveTimeline(),e.replyCount===0&&e.rootEvent?(e.timelineSet.addEventsToTimeline([e.rootEvent],!0,!1,e.liveTimeline,null),e.liveTimeline.setPaginationToken(null,st.Backward)):(e.initalEventFetchProm=e.client.paginateEventTimeline(e.liveTimeline,{backwards:!0}),yield e.initalEventFetchProm),e.initialEventsFetched=!0;for(var r of e.replayEvents)e.addEvent(r,!1);e.replayEvents=null,e.emit(Ue.TimelineReset,e.room,e.timelineSet,!0)}catch(n){U.error("Failed to load start of newly created thread: ",n),e.initialEventsFetched=!1}e.emit(Pn.Update,e)})()}fetchEditsWhereNeeded(){var e=arguments,r=this;return K(function*(){var n,i=(n=r.client.canSupport.get(jr.RelationsRecursion))!==null&&n!==void 0?n:Fr.Unsupported;if(i===Fr.Unsupported){for(var a=e.length,o=new Array(a),s=0;s<a;s++)o[s]=e[s];return Promise.all(o.filter(sve).map(function(){var l=K(function*(c){try{var d=yield r.client.relations(r.roomId,c.getId(),gr.Replace,c.getType(),{limit:1});if(d.events.length){var h=d.events[0];c.makeReplaced(h),r.insertEventIntoTimeline(h)}}catch(p){U.error("Failed to load edits for encrypted thread event",p)}});return function(c){return l.apply(this,arguments)}}()))}})()}setEventMetadata(e){e&&(Be.setEventMetadata(e,this.roomState,!1),e.setThread(this))}clearEventMetadata(e){if(e){var r;e.setThread(void 0),(r=e.event)===null||r===void 0||(r=r.unsigned)===null||r===void 0||(r=r["m.relations"])===null||r===void 0||delete r[jt.name]}}findEventById(e){return this.timelineSet.findEventById(e)}lastReply(){for(var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:i=>i.isRelation(jt.name),r=this.timeline.length-1;r>=0;r--){var n=this.timeline[r];if(e(n))return n}return null}get roomId(){return this.room.roomId}get length(){return this.replyCount+this.pendingReplyCount}get replyToEvent(){var e,r;return(e=(r=this.lastPendingEvent)!==null&&r!==void 0?r:this.lastEvent)!==null&&e!==void 0?e:this.lastReply()}get timeline(){return this.events}get events(){return this.liveTimeline.getEvents()}has(e){return this.timelineSet.findEventById(e)instanceof Bn}get hasCurrentUserParticipated(){return this._currentUserParticipated}get liveTimeline(){return this.timelineSet.getLiveTimeline()}getUnfilteredTimelineSet(){return this.timelineSet}addReceipt(e,r){throw new Error("Unsupported function on the thread model")}getEventReadUpTo(e,r){var n=e===this.client.getUserId(),i=this.timeline[this.timeline.length-1];if(n&&i){var a=i.getTs()<this.room.getOldestThreadedReceiptTs(),o=i.getId();if(a&&o)return o}var s=super.getEventReadUpTo(e,r);if(i){var l=this.room.getLastUnthreadedReceiptFor(e);if(!l)return s;for(var c=((d=this.timeline)===null||d===void 0?void 0:d.length)-1;c>=0;--c){var d,h,p=this.timeline[c];if(p.getId()===s)return s;if(p.getTs()<l.ts)return(h=p.getId())!==null&&h!==void 0?h:s}}return s}hasUserReadEvent(e,r){if(e===this.client.getUserId()){var n,i,a,o,s,l,c=((n=(i=this.lastReply())===null||i===void 0?void 0:i.getTs())!==null&&n!==void 0?n:0)<this.room.getOldestThreadedReceiptTs(),d=(a=(o=this.room.getLastUnthreadedReceiptFor(e))===null||o===void 0?void 0:o.ts)!==null&&a!==void 0?a:0,h=((s=this===null||this===void 0||(l=this.lastReply())===null||l===void 0?void 0:l.getTs())!==null&&s!==void 0?s:0)<d;if(c||h)return!0}return this.room.hasUserReadEvent(e,r)}setUnread(e,r){return this.room.setThreadUnreadNotificationCount(this.id,e,r)}getLastUnthreadedReceiptFor(e){return this.room.getLastUnthreadedReceiptFor(e)}}E(Jt,"hasServerSideSupport",_n.None);E(Jt,"hasServerSideListSupport",_n.None);E(Jt,"hasServerSideFwdPaginationSupport",_n.None);function sve(t){return t.isEncrypted()&&(t.isRelation(jt.name)||t.isThreadRoot)}var Rd=new Vb("related_by_senders","io.element.relation_senders"),Md=new Vb("related_by_rel_types","io.element.relation_types"),jt=new Vb("m.thread","io.element.thread"),pa=function(t){return t[t.My=0]="My",t[t.All=1]="All",t}({});function uz(t){switch(t){case pa.My:return"participated";default:return"all"}}class Ik extends Error{constructor(e,r,n){super(r),this.code=e,E(this,"detailedString",void 0),this.name="DecryptionError",this.detailedString=lve(this,n)}}function lve(t,e){var r=t.name+"[msg: "+t.message;return e&&(r+=", "+Object.keys(e).map(n=>n+": "+e[n]).join(", ")),r+="]",r}var Pk=Object.freeze({visible:!0}),At=function(t){return t.Decrypted="Event.decrypted",t.BeforeRedaction="Event.beforeRedaction",t.VisibilityChange="Event.visibilityChange",t.LocalEventIdReplaced="Event.localEventIdReplaced",t.Status="Event.status",t.Replaced="Event.replaced",t.RelationsCreated="Event.relationsCreated",t.SentinelUpdated="Event.sentinelUpdated",t}({});class Bn extends nr{setMetadata(e,r){var n,i,a=this.isState()&&this.getType()===ge.RoomMember&&this.getSender()===this.getStateKey(),o=!1;if(a||!((n=this.sender)!==null&&n!==void 0&&(n=n.events)!==null&&n!==void 0&&n.member)){var s=e.getSentinelMember(this.getSender());s!==this.sender&&(o=!0),this.sender=s}if(a||!((i=this.target)!==null&&i!==void 0&&(i=i.events)!==null&&i!==void 0&&i.member)&&this.getType()===ge.RoomMember){var l=e.getSentinelMember(this.getStateKey());l!==this.target&&(o=!0),this.target=l}this.isState()&&r&&(this.forwardLooking=!1),o&&this.emit(At.SentinelUpdated)}constructor(){var e,r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(),this.event=r,E(this,"pushDetails",{}),E(this,"_replacingEvent",null),E(this,"_localRedactionEvent",null),E(this,"_isCancelled",!1),E(this,"clearEvent",void 0),E(this,"visibility",Pk),E(this,"_hasCachedExtEv",!1),E(this,"_cachedExtEv",void 0),E(this,"_decryptionFailureReason",null),E(this,"senderCurve25519Key",null),E(this,"claimedEd25519Key",null),E(this,"forwardingCurve25519KeyChain",[]),E(this,"untrusted",null),E(this,"decryptionPromise",null),E(this,"retryDecryption",!1),E(this,"txnId",void 0),E(this,"thread",void 0),E(this,"threadId",void 0),E(this,"localTimestamp",void 0),E(this,"sender",null),E(this,"target",null),E(this,"status",null),E(this,"error",null),E(this,"forwardLooking",!0),E(this,"reEmitter",void 0),["state_key","type","sender","room_id","membership"].forEach(i=>{typeof r[i]=="string"&&(r[i]=vw(r[i]))}),["membership","avatar_url","displayname"].forEach(i=>{var a;typeof((a=r.content)===null||a===void 0?void 0:a[i])=="string"&&(r.content[i]=vw(r.content[i]))}),["rel_type"].forEach(i=>{var a;typeof((a=r.content)===null||a===void 0||(a=a["m.relates_to"])===null||a===void 0?void 0:a[i])=="string"&&(r.content["m.relates_to"][i]=vw(r.content["m.relates_to"][i]))}),this.txnId=r.txn_id;var n=this.getAge();this.localTimestamp=n!==void 0?Date.now()-n:(e=this.getTs())!==null&&e!==void 0?e:Date.now(),this.reEmitter=new kf(this)}get unstableExtensibleEvent(){return this._hasCachedExtEv||(this._cachedExtEv=Fn.ExtensibleEvents.parse(this.getEffectiveEvent())),this._cachedExtEv}invalidateExtensibleEvent(){this._hasCachedExtEv=!1}getEffectiveEvent(){var e=Object.assign({},this.getContent());if(this.getWireType()===ge.RoomMessageEncrypted)for(var[r,n]of Object.entries(this.getWireContent()))["algorithm","ciphertext","device_id","sender_key","session_id"].includes(r)||e[r]===void 0&&(e[r]=n);return Object.assign({},this.event,this.clearEvent,{content:e})}getId(){return this.event.event_id}getSender(){return this.event.sender}getType(){return this.clearEvent?this.clearEvent.type:this.event.type}getWireType(){return this.event.type}getRoomId(){return this.event.room_id}getTs(){return this.event.origin_server_ts}getDate(){return this.event.origin_server_ts?new Date(this.event.origin_server_ts):null}getDetails(){var e=this.getRoomId();if(e){var r;return"id=".concat(this.getId()," type=").concat(this.getWireType()," sender=").concat(this.getSender()," room=").concat(e," ts=").concat((r=this.getDate())===null||r===void 0?void 0:r.toISOString())}else{var n=this.getContent()[Gb];return"msgid=".concat(n," type=").concat(this.getWireType()," sender=").concat(this.getSender())}}getOriginalContent(){var e;if(this._localRedactionEvent)return{};if(this.clearEvent){var r;return(r=this.clearEvent.content)!==null&&r!==void 0?r:{}}return(e=this.event.content)!==null&&e!==void 0?e:{}}getContent(){if(this._localRedactionEvent)return{};if(this._replacingEvent){var e;return(e=this._replacingEvent.getContent()["m.new_content"])!==null&&e!==void 0?e:{}}else return this.getOriginalContent()}getWireContent(){return this.event.content||{}}get threadRootId(){var e;if(!this.isState()){var r=(e=this.getWireContent())===null||e===void 0?void 0:e["m.relates_to"];if((r==null?void 0:r.rel_type)===jt.name)return r.event_id;if(this.thread)return this.thread.id;if(this.threadId!==void 0)return this.threadId;var n=this.getUnsigned();if(typeof n[D0.name]=="string")return n[D0.name]}}get isThreadRoot(){if(this.isState())return!1;var e=this.getServerAggregatedRelation(jt.name);return!!e||this.threadRootId===this.getId()}get replyEventId(){var e;return(e=this.getWireContent()["m.relates_to"])===null||e===void 0||(e=e["m.in_reply_to"])===null||e===void 0?void 0:e.event_id}get relationEventId(){var e;return(e=this.getWireContent())===null||e===void 0||(e=e["m.relates_to"])===null||e===void 0?void 0:e.event_id}getPrevContent(){return this.getUnsigned().prev_content||{}}getDirectionalContent(){return this.forwardLooking?this.getContent():this.getPrevContent()}getAge(){return this.getUnsigned().age}getLocalAge(){return Date.now()-this.localTimestamp}getStateKey(){return this.event.state_key}isState(){return this.event.state_key!==void 0}getMembershipAtEvent(){var e=this.getUnsigned();return Nj.findIn(e)}makeEncrypted(e,r,n,i){this.clearEvent={type:this.event.type,content:this.event.content},this.event.type=e,this.event.content=r,this.senderCurve25519Key=n,this.claimedEd25519Key=i}isBeingDecrypted(){return this.decryptionPromise!=null}getDecryptionPromise(){return this.decryptionPromise}isDecryptionFailure(){return this._decryptionFailureReason!==null}get decryptionFailureReason(){return this._decryptionFailureReason}get isEncryptedDisabledForUnverifiedDevices(){return this.decryptionFailureReason===mk.MEGOLM_KEY_WITHHELD_FOR_UNVERIFIED_DEVICE}shouldAttemptDecryption(){return!(this.isRedacted()||this.isBeingDecrypted()||this.clearEvent||!this.isEncrypted())}attemptDecryption(e){var r=arguments,n=this;return K(function*(){var i=r.length>1&&r[1]!==void 0?r[1]:{};if(!n.isEncrypted())throw new Error("Attempt to decrypt event which isn't encrypted");var a=n.clearEvent&&!n.isDecryptionFailure(),o=i.forceRedecryptIfUntrusted&&n.isKeySourceUntrusted();if(a&&!o)throw new Error("Attempt to decrypt event which has already been decrypted");return n.decryptionPromise?(U.log("Event ".concat(n.getId()," already being decrypted; queueing a retry")),n.retryDecryption=!0,n.decryptionPromise):(n.decryptionPromise=n.decryptionLoop(e,i),n.decryptionPromise)})()}getKeyRequestRecipients(e){var r=[{userId:e,deviceId:"*"}];return r}decryptionLoop(e){var r=arguments,n=this;return K(function*(){var i=r.length>1&&r[1]!==void 0?r[1]:{};for(yield Promise.resolve();;){n.retryDecryption=!1;var a=void 0;try{var o=yield e.decryptEvent(n);i.isRetry===!0&&U.info("Decrypted event on retry (".concat(n.getDetails(),")")),n.setClearData(o),n._decryptionFailureReason=null}catch(l){var s=l instanceof Ik?l.detailedString:String(l);if(a=l,n.retryDecryption){U.log("Error decrypting event (".concat(n.getDetails(),"), but retrying: ").concat(s));continue}U.warn("Error decrypting event (".concat(n.getDetails(),"): ").concat(s)),n.setClearDataForDecryptionFailure(String(l)),n._decryptionFailureReason=l instanceof Ik?l.code:mk.UNKNOWN_ERROR}n.decryptionPromise=null,n.retryDecryption=!1,n.setPushDetails(),i.emit!==!1&&n.emit(At.Decrypted,n,a);return}})()}setClearData(e){var r,n;this.clearEvent=e.clearEvent,this.senderCurve25519Key=(r=e.senderCurve25519Key)!==null&&r!==void 0?r:null,this.claimedEd25519Key=(n=e.claimedEd25519Key)!==null&&n!==void 0?n:null,this.forwardingCurve25519KeyChain=e.forwardingCurve25519KeyChain||[],this.untrusted=e.untrusted||!1,this.invalidateExtensibleEvent()}setClearDataForDecryptionFailure(e){this.clearEvent={type:ge.RoomMessage,content:{msgtype:"m.bad.encrypted",body:"** Unable to decrypt: ".concat(e," **")}},this.senderCurve25519Key=null,this.claimedEd25519Key=null,this.forwardingCurve25519KeyChain=[],this.untrusted=!1,this.invalidateExtensibleEvent()}getClearContent(){return this.clearEvent?this.clearEvent.content:null}isEncrypted(){return!this.isState()&&this.event.type===ge.RoomMessageEncrypted}getSenderKey(){return this.senderCurve25519Key}getKeysClaimed(){return this.claimedEd25519Key?{ed25519:this.claimedEd25519Key}:{}}getClaimedEd25519Key(){return this.claimedEd25519Key}getForwardingCurve25519KeyChain(){return this.forwardingCurve25519KeyChain}isKeySourceUntrusted(){return!!this.untrusted}getUnsigned(){return this.event.unsigned||{}}setUnsigned(e){this.event.unsigned=e}unmarkLocallyRedacted(){var e=this._localRedactionEvent;return this._localRedactionEvent=null,this.event.unsigned&&(this.event.unsigned.redacted_because=void 0),!!e}markLocallyRedacted(e){this._localRedactionEvent||(this.emit(At.BeforeRedaction,this,e),this._localRedactionEvent=e,this.event.unsigned||(this.event.unsigned={}),this.event.unsigned.redacted_because=e.event)}applyVisibilityEvent(e){var r,n,i=(r=e==null?void 0:e.visible)!==null&&r!==void 0?r:!0,a=(n=e==null?void 0:e.reason)!==null&&n!==void 0?n:null,o=!1;(this.visibility.visible!==i||!this.visibility.visible&&this.visibility.reason!==a)&&(o=!0),o&&(i?this.visibility=Pk:this.visibility=Object.freeze({visible:!1,reason:a}),this.emit(At.VisibilityChange,this,i))}messageVisibility(){return this.visibility}makeRedacted(e,r){if(!e.event)throw new Error("invalid redactionEvent in makeRedacted");this._localRedactionEvent=null,this.emit(At.BeforeRedaction,this,e),this._replacingEvent=null,this.event.unsigned||(this.event.unsigned={}),this.event.unsigned.redacted_because=e.event;for(var n in this.event)this.event.hasOwnProperty(n)&&!uve.has(n)&&delete this.event[n];this.isEncrypted()&&(this.clearEvent=void 0);var i=this.getType()in Ak?Ak[this.getType()]:{},a=this.getContent();for(var o in a)a.hasOwnProperty(o)&&!i[o]&&delete a[o];!this.isThreadRoot&&this.threadRootId&&this.threadRootId!==this.getId()&&(this.moveAllRelatedToMainTimeline(r),e.moveToMainTimeline(r)),this.invalidateExtensibleEvent()}moveAllRelatedToMainTimeline(e){var r=this.thread;if(this.moveToMainTimeline(e),r)for(var n of r.events){var i;((i=n.getRelation())===null||i===void 0?void 0:i.event_id)===this.getId()&&n.moveAllRelatedToMainTimeline(e)}}moveToMainTimeline(e){var r;(r=this.thread)===null||r===void 0||r.timelineSet.removeEvent(this.getId()),this.setThread(void 0);var n=e.getLiveTimeline();n.getTimelineSet().insertEventIntoTimeline(this,n,n.getState(Be.FORWARDS),!1)}isRedacted(){return!!this.getUnsigned().redacted_because}isRedaction(){return this.getType()===ge.RoomRedaction}asVisibilityChange(){if(!su.matches(this.getType()))return null;var e=this.getRelation();if(!e||e.rel_type!="m.reference")return null;var r=e.event_id;if(!r)return null;var n=this.getWireContent(),i=!!n.visible,a=n.reason;return a&&typeof a!="string"?null:{visible:i,reason:a,eventId:r}}isVisibilityEvent(){return su.matches(this.getType())}getRedactionEvent(){var e,r;if(!this.isRedacted())return null;if((e=this.clearEvent)!==null&&e!==void 0&&e.unsigned){var n,i;return(n=(i=this.clearEvent)===null||i===void 0?void 0:i.unsigned.redacted_because)!==null&&n!==void 0?n:null}else return(r=this.event.unsigned)!==null&&r!==void 0&&r.redacted_because?this.event.unsigned.redacted_because:{}}getPushActions(){return this.pushDetails.actions||null}getPushDetails(){return this.pushDetails}setPushDetails(e,r){this.pushDetails={actions:e,rule:r}}handleRemoteEcho(e){var r,n=this.getUnsigned(),i=this.getId();this.event=e,n.redacted_because&&(this.event.unsigned||(this.event.unsigned={}),this.event.unsigned.redacted_because=n.redacted_because),this.setStatus(null),this.getId()!==i&&this.emit(At.LocalEventIdReplaced,this),this.localTimestamp=Date.now()-((r=this.getAge())!==null&&r!==void 0?r:0)}isSending(){return!!this.status}setStatus(e){this.status=e,this.emit(At.Status,this,e)}replaceLocalEventId(e){this.event.event_id=e,this.emit(At.LocalEventIdReplaced,this)}isRelation(e){var r,n=(r=this.getWireContent())===null||r===void 0?void 0:r["m.relates_to"];return this.isState()&&(n!=null&&n.rel_type)&&[gr.Replace,gr.Thread].includes(n.rel_type)?!1:!!(n!=null&&n.rel_type&&n.event_id&&(!e||n.rel_type===e))}getRelation(){var e;return this.isRelation()&&(e=this.getWireContent()["m.relates_to"])!==null&&e!==void 0?e:null}makeReplaced(e){this.isRedacted()&&e||this.isState()||this._replacingEvent!==e&&(this._replacingEvent=e??null,this.emit(At.Replaced,this),this.invalidateExtensibleEvent())}getAssociatedStatus(){return this._replacingEvent?this._replacingEvent.status:this._localRedactionEvent?this._localRedactionEvent.status:this.status}getServerAggregatedRelation(e){var r;return(r=this.getUnsigned()["m.relations"])===null||r===void 0?void 0:r[e]}replacingEventId(){var e=this.getServerAggregatedRelation(gr.Replace);if(e)return e.event_id;if(this._replacingEvent)return this._replacingEvent.getId()}replacingEvent(){return this._replacingEvent}replacingEventDate(){var e=this.getServerAggregatedRelation(gr.Replace);if(e){var r=e.origin_server_ts;if(Number.isFinite(r))return new Date(r)}else if(this._replacingEvent){var n;return(n=this._replacingEvent.getDate())!==null&&n!==void 0?n:void 0}}localRedactionEvent(){return this._localRedactionEvent}getAssociatedId(){var e=this.getRelation();if(this.replyEventId)return this.replyEventId;if(e)return e.event_id;if(this.isRedaction())return this.event.redacts}hasAssociation(){return!!this.getAssociatedId()}updateAssociatedId(e){var r=this.getRelation();r?r.event_id=e:this.isRedaction()&&(this.event.redacts=e)}flagCancelled(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this._isCancelled=e}isCancelled(){return this._isCancelled}toSnapshot(){var e=new Bn(JSON.parse(JSON.stringify(this.event)));for(var[r,n]of Object.entries(this))r!=="event"&&(e[r]=n);return e}isEquivalentTo(e){if(!e)return!1;if(e===this)return!0;var r=nx(this.event),n=nx(e.event);return JSON.stringify(r)===JSON.stringify(n)}toJSON(){var e=this.getEffectiveEvent();return this.isEncrypted()?{decrypted:e,encrypted:this.event}:e}setTxnId(e){this.txnId=e}getTxnId(){return this.txnId}setThread(e){this.isState()||(this.thread&&this.reEmitter.stopReEmitting(this.thread,[Pn.Update]),this.thread=e,this.setThreadId(e==null?void 0:e.id),e&&this.reEmitter.reEmit(e,[Pn.Update]))}getThread(){return this.thread}setThreadId(e){this.threadId=e}}var uve=new Set(["event_id","type","room_id","user_id","sender","state_key","prev_state","content","unsigned","origin_server_ts"]),Ak={[ge.RoomMember]:{membership:1},[ge.RoomJoinRules]:{join_rule:1},[ge.RoomPowerLevels]:{ban:1,events:1,events_default:1,kick:1,redact:1,state_default:1,users:1,users_default:1}},ui=function(t){return t[t.NotStarted=0]="NotStarted",t[t.InProgress=1]="InProgress",t[t.Finished=2]="Finished",t}(ui||{}),dt=function(t){return t.Events="RoomState.events",t.Members="RoomState.members",t.NewMember="RoomState.newMember",t.Update="RoomState.update",t.BeaconLiveness="RoomState.BeaconLiveness",t.Marker="RoomState.Marker",t}({});class cm extends nr{constructor(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{status:ui.NotStarted};super(),this.roomId=e,this.oobMemberFlags=r,E(this,"reEmitter",new kf(this)),E(this,"sentinels",{}),E(this,"displayNameToUserIds",new Map),E(this,"userIdsToDisplayNames",{}),E(this,"tokenToInvite",{}),E(this,"joinedMemberCount",null),E(this,"summaryJoinedMemberCount",null),E(this,"invitedMemberCount",null),E(this,"summaryInvitedMemberCount",null),E(this,"modified",-1),E(this,"members",{}),E(this,"events",new Map),E(this,"paginationToken",null),E(this,"beacons",new Map),E(this,"_liveBeaconIds",[]),this.updateModifiedTime()}getJoinedMemberCount(){return this.summaryJoinedMemberCount!==null?this.summaryJoinedMemberCount:(this.joinedMemberCount===null&&(this.joinedMemberCount=this.getMembers().reduce((e,r)=>r.membership===ct.Join?e+1:e,0)),this.joinedMemberCount)}setJoinedMemberCount(e){this.summaryJoinedMemberCount=e}getInvitedMemberCount(){return this.summaryInvitedMemberCount!==null?this.summaryInvitedMemberCount:(this.invitedMemberCount===null&&(this.invitedMemberCount=this.getMembers().reduce((e,r)=>r.membership===ct.Invite?e+1:e,0)),this.invitedMemberCount)}setInvitedMemberCount(e){this.summaryInvitedMemberCount=e}getMembers(){return Object.values(this.members)}getMembersExcept(e){return this.getMembers().filter(r=>!e.includes(r.userId))}getMember(e){return this.members[e]||null}getSentinelMember(e){if(!e)return null;var r=this.sentinels[e];if(r===void 0){r=new tm(this.roomId,e);var n=this.members[e];n!=null&&n.events.member&&r.setMembershipEvent(n.events.member,this),this.sentinels[e]=r}return r}getStateEvents(e,r){if(!this.events.has(e))return r===void 0?[]:null;if(r===void 0)return Array.from(this.events.get(e).values());var n=this.events.get(e).get(r);return n||null}get hasLiveBeacons(){var e;return!!((e=this.liveBeaconIds)!==null&&e!==void 0&&e.length)}get liveBeaconIds(){return this._liveBeaconIds}clone(){var e=new cm(this.roomId,this.oobMemberFlags),r=this.oobMemberFlags.status;return this.oobMemberFlags.status=ui.NotStarted,Array.from(this.events.values()).forEach(n=>{e.setStateEvents(Array.from(n.values()))}),this.oobMemberFlags.status=r,this.summaryInvitedMemberCount!==null&&e.setInvitedMemberCount(this.getInvitedMemberCount()),this.summaryJoinedMemberCount!==null&&e.setJoinedMemberCount(this.getJoinedMemberCount()),this.oobMemberFlags.status==ui.Finished&&this.getMembers().forEach(n=>{if(n.isOutOfBand()){var i;(i=e.getMember(n.userId))===null||i===void 0||i.markOutOfBand()}}),e}setUnknownStateEvents(e){var r=e.filter(n=>!this.events.has(n.getType())||!this.events.get(n.getType()).has(n.getStateKey()));this.setStateEvents(r)}setStateEvents(e,r){this.updateModifiedTime(),e.forEach(n=>{if(!(n.getRoomId()!==this.roomId||!n.isState())){l3.matches(n.getType())&&this.setBeacon(n);var i=this.getStateEventMatching(n);if(this.setStateEvent(n),n.getType()===ge.RoomMember){var a;this.updateDisplayNameCache(n.getStateKey(),(a=n.getContent().displayname)!==null&&a!==void 0?a:""),this.updateThirdPartyTokenCache(n)}this.emit(dt.Events,n,this,i)}}),this.onBeaconLivenessChange(),e.forEach(n=>{if(!(n.getRoomId()!==this.roomId||!n.isState()))if(n.getType()===ge.RoomMember){var i=n.getStateKey();(n.getContent().membership===ct.Leave||n.getContent().membership===ct.Ban)&&(n.getContent().avatar_url=n.getContent().avatar_url||n.getPrevContent().avatar_url,n.getContent().displayname=n.getContent().displayname||n.getPrevContent().displayname);var a=this.getOrCreateMember(i,n);a.setMembershipEvent(n,this),this.updateMember(a),this.emit(dt.Members,n,this,a)}else if(n.getType()===ge.RoomPowerLevels){if(n.getStateKey()!=="")return;var o=Object.values(this.members);o.forEach(s=>{var l=s.getLastModifiedTime();s.setPowerLevelEvent(n),l!==s.getLastModifiedTime()&&this.emit(dt.Members,n,this,s)}),this.sentinels={}}else $j.matches(n.getType())&&this.emit(dt.Marker,n,r)}),this.emit(dt.Update,this)}processBeaconEvents(e,r){var n=this;return K(function*(){if(!(!e.length||!n.beacons.size)){var i=[...n.beacons.values()].reduce((c,d)=>(c[d.beaconInfoId]=d,c),{}),a=(c,d)=>{if(Zx.matches(d.getType())){var h=i[c];h&&h.addLocations([d])}},o=function*(d){var h,p=(h=d.getRelation())===null||h===void 0?void 0:h.event_id;if(!p||!i[p])return{v:void 0};if(!Zx.matches(d.getType())&&!d.isEncrypted())return{v:void 0};try{yield r.decryptEventIfNeeded(d),a(p,d)}catch{d.isDecryptionFailure()&&d.once(At.Decrypted,K(function*(){a(p,d)}))}},s;for(var l of e)if(s=yield*o(l),s)return s.v}})()}getOrCreateMember(e,r){var n=this.members[e];return n||(n=new tm(this.roomId,e),this.members[e]=n,this.emit(dt.NewMember,r,this,n)),n}setStateEvent(e){this.events.has(e.getType())||this.events.set(e.getType(),new Map),this.events.get(e.getType()).set(e.getStateKey(),e)}setBeacon(e){var r=O0(e);if(this.beacons.has(r)){var n=this.beacons.get(r);if(e.isRedacted()){var i;n.beaconInfoId===((i=e.getRedactionEvent())===null||i===void 0?void 0:i.redacts)&&(n.destroy(),this.beacons.delete(r));return}return n.update(e)}if(!e.isRedacted()){var a=new dV(e);this.reEmitter.reEmit(a,[er.New,er.Update,er.Destroy,er.LivenessChange]),this.emit(er.New,e,a),a.on(er.LivenessChange,this.onBeaconLivenessChange.bind(this)),a.on(er.Destroy,this.onBeaconLivenessChange.bind(this)),this.beacons.set(a.identifier,a)}}onBeaconLivenessChange(){this._liveBeaconIds=Array.from(this.beacons.values()).filter(e=>e.isLive).map(e=>e.identifier),this.emit(dt.BeaconLiveness,this,this.hasLiveBeacons)}getStateEventMatching(e){var r,n;return(r=(n=this.events.get(e.getType()))===null||n===void 0?void 0:n.get(e.getStateKey()))!==null&&r!==void 0?r:null}updateMember(e){var r=this.getStateEvents(ge.RoomPowerLevels,"");r&&e.setPowerLevelEvent(r),delete this.sentinels[e.userId],this.members[e.userId]=e,this.joinedMemberCount=null,this.invitedMemberCount=null}needsOutOfBandMembers(){return this.oobMemberFlags.status===ui.NotStarted}outOfBandMembersReady(){return this.oobMemberFlags.status===ui.Finished}markOutOfBandMembersStarted(){this.oobMemberFlags.status===ui.NotStarted&&(this.oobMemberFlags.status=ui.InProgress)}markOutOfBandMembersFailed(){this.oobMemberFlags.status===ui.InProgress&&(this.oobMemberFlags.status=ui.NotStarted)}clearOutOfBandMembers(){var e=0;Object.keys(this.members).forEach(r=>{var n=this.members[r];n.isOutOfBand()&&(++e,delete this.members[r])}),U.log("LL: RoomState removed ".concat(e," members...")),this.oobMemberFlags.status=ui.NotStarted}setOutOfBandMembers(e){U.log("LL: RoomState about to set ".concat(e.length," OOB members ...")),this.oobMemberFlags.status===ui.InProgress&&(U.log("LL: RoomState put in finished state ..."),this.oobMemberFlags.status=ui.Finished,e.forEach(r=>this.setOutOfBandMember(r)),this.emit(dt.Update,this))}setOutOfBandMember(e){if(e.getType()===ge.RoomMember){var r=e.getStateKey(),n=this.getMember(r);if(!(n&&!n.isOutOfBand())){var i=this.getOrCreateMember(r,e);i.setMembershipEvent(e,this),i.markOutOfBand(),this.updateDisplayNameCache(i.userId,i.name),this.setStateEvent(e),this.updateMember(i),this.emit(dt.Members,e,this,i)}}}setTypingEvent(e){Object.values(this.members).forEach(function(r){r.setTypingEvent(e)})}getInviteForThreePidToken(e){return this.tokenToInvite[e]||null}updateModifiedTime(){this.modified=Date.now()}getLastModifiedTime(){return this.modified}getUserIdsWithDisplayName(e){var r;return(r=this.displayNameToUserIds.get(_u(e)))!==null&&r!==void 0?r:[]}maySendRedactionForEvent(e,r){var n=this.getMember(r);if(!n||n.membership===ct.Leave||e.status||e.isRedacted())return!1;var i=this.maySendEvent(ge.RoomRedaction,r);return i?e.getSender()===r?!0:this.hasSufficientPowerLevelFor("redact",n.powerLevel):!1}hasSufficientPowerLevelFor(e,r){var n=this.getStateEvents(ge.RoomPowerLevels,""),i={};n&&(i=n.getContent());var a=50;return nA(i[e])&&(a=i[e]),r>=a}maySendMessage(e){return this.maySendEventOfType(ge.RoomMessage,e,!1)}maySendEvent(e,r){return this.maySendEventOfType(e,r,!1)}mayClientSendStateEvent(e,r){return r.isGuest()||!r.credentials.userId?!1:this.maySendStateEvent(e,r.credentials.userId)}maySendStateEvent(e,r){return this.maySendEventOfType(e,r,!0)}maySendEventOfType(e,r,n){var i=this.getStateEvents(ge.RoomPowerLevels,""),a,o={},s=0,l=0,c=0;if(i){a=i.getContent(),o=a.events||{},Number.isSafeInteger(a.state_default)?s=a.state_default:s=50;var d=a.users&&a.users[r];Number.isSafeInteger(d)?c=d:Number.isSafeInteger(a.users_default)&&(c=a.users_default),Number.isSafeInteger(a.events_default)&&(l=a.events_default)}var h=n?s:l;return Number.isSafeInteger(o[e])&&(h=o[e]),c>=h}mayTriggerNotifOfType(e,r){var n=this.getMember(r);if(!n)return!1;var i=this.getStateEvents(ge.RoomPowerLevels,""),a=50;return i&&i.getContent()&&i.getContent().notifications&&nA(i.getContent().notifications[e])&&(a=i.getContent().notifications[e]),n.powerLevel>=a}getJoinRule(){var e,r=this.getStateEvents(ge.RoomJoinRules,""),n=(e=r==null?void 0:r.getContent())!==null&&e!==void 0?e:{};return n.join_rule||NV.Invite}getHistoryVisibility(){var e,r=this.getStateEvents(ge.RoomHistoryVisibility,""),n=(e=r==null?void 0:r.getContent())!==null&&e!==void 0?e:{};return n.history_visibility||s3.Shared}getGuestAccess(){var e,r=this.getStateEvents(ge.RoomGuestAccess,""),n=(e=r==null?void 0:r.getContent())!==null&&e!==void 0?e:{};return n.guest_access||B0.Forbidden}findPredecessor(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(e){var r=this.getStateEvents(ge.RoomPredecessor,"");if(r){var n=r.getContent(),i=n.predecessor_room_id,a=n.last_known_event_id;typeof a!="string"&&(a=void 0);var o=n.via_servers;if(Array.isArray(o)||(o=void 0),typeof i=="string")return{roomId:i,eventId:a,viaServers:o}}}var s=this.getStateEvents(ge.RoomCreate,"");if(s){var l=s.getContent().predecessor;if(l){var c=l.room_id;if(typeof c=="string"){var d=l.event_id;return(typeof d!="string"||d==="")&&(d=void 0),{roomId:c,eventId:d}}}}return null}updateThirdPartyTokenCache(e){if(e.getContent().third_party_invite){var r=(e.getContent().third_party_invite.signed||{}).token;if(r){var n=this.getStateEvents(ge.RoomThirdPartyInvite,r);n&&(this.tokenToInvite[r]=e)}}}updateDisplayNameCache(e,r){var n=this.userIdsToDisplayNames[e];if(delete this.userIdsToDisplayNames[e],n){var i=_u(n),a=this.displayNameToUserIds.get(i);if(a){var o=a.filter(d=>d!==e);this.displayNameToUserIds.set(i,o)}}this.userIdsToDisplayNames[e]=r;var s=r&&_u(r);if(s){var l,c=(l=this.displayNameToUserIds.get(s))!==null&&l!==void 0?l:[];c.push(e),this.displayNameToUserIds.set(s,c)}}}function kk(t){var e=typeof t=="string"&&!!t&&t!=="undefined"&&t!=="null";return e||typeof t=="number"}class _3{constructor(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};E(this,"rooms",{}),E(this,"users",{}),E(this,"syncToken",null),E(this,"filters",new qo(()=>new Map)),E(this,"accountData",new Map),E(this,"localStorage",void 0),E(this,"oobMembers",new Map),E(this,"pendingEvents",{}),E(this,"clientOptions",void 0),E(this,"pendingToDeviceBatches",[]),E(this,"nextToDeviceBatchId",0),E(this,"createUser",void 0),E(this,"onRoomMember",(r,n,i)=>{var a;if(i.membership!==ct.Invite){var o=this.users[i.userId]||((a=this.createUser)===null||a===void 0?void 0:a.call(this,i.userId));i.name&&(o.setDisplayName(i.name),i.events.member&&o.setRawDisplayName(i.events.member.getDirectionalContent().displayname)),i.events.member&&i.events.member.getContent().avatar_url&&o.setAvatarUrl(i.events.member.getContent().avatar_url),this.users[o.userId]=o}}),this.localStorage=e.localStorage}getSyncToken(){return this.syncToken}isNewlyCreated(){return Promise.resolve(!0)}setSyncToken(e){this.syncToken=e}storeRoom(e){this.rooms[e.roomId]=e,e.currentState.on(dt.Members,this.onRoomMember),e.currentState.getMembers().forEach(r=>{this.onRoomMember(null,e.currentState,r)})}setUserCreator(e){this.createUser=e}getRoom(e){return this.rooms[e]||null}getRooms(){return Object.values(this.rooms)}removeRoom(e){this.rooms[e]&&this.rooms[e].currentState.removeListener(dt.Members,this.onRoomMember),delete this.rooms[e]}getRoomSummaries(){return Object.values(this.rooms).map(function(e){return e.summary})}storeUser(e){this.users[e.userId]=e}getUser(e){return this.users[e]||null}getUsers(){return Object.values(this.users)}scrollback(e,r){return[]}storeEvents(e,r,n,i){}storeFilter(e){!(e!=null&&e.userId)||!(e!=null&&e.filterId)||this.filters.getOrCreate(e.userId).set(e.filterId,e)}getFilter(e,r){var n;return((n=this.filters.get(e))===null||n===void 0?void 0:n.get(r))||null}getFilterIdByName(e){if(!this.localStorage)return null;var r="mxjssdk_memory_filter_"+e;try{var n=this.localStorage.getItem(r);if(kk(n))return n}catch{}return null}setFilterIdByName(e,r){if(this.localStorage){var n="mxjssdk_memory_filter_"+e;try{kk(r)?this.localStorage.setItem(n,r):this.localStorage.removeItem(n)}catch{}}}storeAccountDataEvents(e){e.forEach(r=>{var n=!Object.keys(r.getContent()).length;n?this.accountData.delete(r.getType()):this.accountData.set(r.getType(),r)})}getAccountData(e){return this.accountData.get(e)}setSyncData(e){return Promise.resolve()}wantsSave(){return!1}save(e){return Promise.resolve()}startup(){return Promise.resolve()}getSavedSync(){return Promise.resolve(null)}getSavedSyncToken(){return Promise.resolve(null)}deleteAllData(){return this.rooms={},this.users={},this.syncToken=null,this.filters=new qo(()=>new Map),this.accountData=new Map,Promise.resolve()}getOutOfBandMembers(e){return Promise.resolve(this.oobMembers.get(e)||null)}setOutOfBandMembers(e,r){return this.oobMembers.set(e,r),Promise.resolve()}clearOutOfBandMembers(e){return this.oobMembers.delete(e),Promise.resolve()}getClientOptions(){return Promise.resolve(this.clientOptions)}storeClientOptions(e){return this.clientOptions=Object.assign({},e),Promise.resolve()}getPendingEvents(e){var r=this;return K(function*(){var n;return(n=r.pendingEvents[e])!==null&&n!==void 0?n:[]})()}setPendingEvents(e,r){var n=this;return K(function*(){n.pendingEvents[e]=r})()}saveToDeviceBatches(e){for(var r of e)this.pendingToDeviceBatches.push({id:this.nextToDeviceBatchId++,eventType:r.eventType,txnId:r.txnId,batch:r.batch});return Promise.resolve()}getOldestToDeviceBatch(){var e=this;return K(function*(){return e.pendingToDeviceBatches.length===0?null:e.pendingToDeviceBatches[0]})()}removeToDeviceBatch(e){return this.pendingToDeviceBatches=this.pendingToDeviceBatches.filter(r=>r.id!==e),Promise.resolve()}destroy(){return K(function*(){})()}}var Nw={},Ul={},ec={};Object.defineProperty(ec,"__esModule",{value:!0});ec.WidgetApiDirection=void 0;ec.invertedDirection=cve;var Fh=function(t){return t.ToWidget="toWidget",t.FromWidget="fromWidget",t}({});ec.WidgetApiDirection=Fh;function cve(t){if(t===Fh.ToWidget)return Fh.FromWidget;if(t===Fh.FromWidget)return Fh.ToWidget;throw new Error("Invalid direction")}var to={};Object.defineProperty(to,"__esModule",{value:!0});to.UnstableApiVersion=to.MatrixApiVersion=to.CurrentApiVersions=void 0;var lC=function(t){return t.Prerelease1="0.0.1",t.Prerelease2="0.0.2",t}({});to.MatrixApiVersion=lC;var ci=function(t){return t.MSC2762="org.matrix.msc2762",t.MSC2762_UPDATE_STATE="org.matrix.msc2762_update_state",t.MSC2871="org.matrix.msc2871",t.MSC2873="org.matrix.msc2873",t.MSC2931="org.matrix.msc2931",t.MSC2974="org.matrix.msc2974",t.MSC2876="org.matrix.msc2876",t.MSC3819="org.matrix.msc3819",t.MSC3846="town.robin.msc3846",t.MSC3869="org.matrix.msc3869",t.MSC3973="org.matrix.msc3973",t.MSC4039="org.matrix.msc4039",t}({});to.UnstableApiVersion=ci;var dve=[lC.Prerelease1,lC.Prerelease2,ci.MSC2762,ci.MSC2762_UPDATE_STATE,ci.MSC2871,ci.MSC2873,ci.MSC2931,ci.MSC2974,ci.MSC2876,ci.MSC3819,ci.MSC3846,ci.MSC3869,ci.MSC3973,ci.MSC4039];to.CurrentApiVersions=dve;var yh={},Ok;function S3(){if(Ok)return yh;Ok=1,Object.defineProperty(yh,"__esModule",{value:!0}),yh.PostmessageTransport=void 0;var t=Wb,e=c_(),r=["message"];function n(C){"@babel/helpers - typeof";return n=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(k){return typeof k}:function(k){return k&&typeof Symbol=="function"&&k.constructor===Symbol&&k!==Symbol.prototype?"symbol":typeof k},n(C)}function i(C,k){if(C==null)return{};var S=a(C,k),V,z;if(Object.getOwnPropertySymbols){var j=Object.getOwnPropertySymbols(C);for(z=0;z<j.length;z++)V=j[z],!(k.indexOf(V)>=0)&&Object.prototype.propertyIsEnumerable.call(C,V)&&(S[V]=C[V])}return S}function a(C,k){if(C==null)return{};var S={},V=Object.keys(C),z,j;for(j=0;j<V.length;j++)z=V[j],!(k.indexOf(z)>=0)&&(S[z]=C[z]);return S}function o(C,k){var S=Object.keys(C);if(Object.getOwnPropertySymbols){var V=Object.getOwnPropertySymbols(C);k&&(V=V.filter(function(z){return Object.getOwnPropertyDescriptor(C,z).enumerable})),S.push.apply(S,V)}return S}function s(C){for(var k=1;k<arguments.length;k++){var S=arguments[k]!=null?arguments[k]:{};k%2?o(Object(S),!0).forEach(function(V){_(C,V,S[V])}):Object.getOwnPropertyDescriptors?Object.defineProperties(C,Object.getOwnPropertyDescriptors(S)):o(Object(S)).forEach(function(V){Object.defineProperty(C,V,Object.getOwnPropertyDescriptor(S,V))})}return C}function l(C,k){if(!(C instanceof k))throw new TypeError("Cannot call a class as a function")}function c(C,k){for(var S=0;S<k.length;S++){var V=k[S];V.enumerable=V.enumerable||!1,V.configurable=!0,"value"in V&&(V.writable=!0),Object.defineProperty(C,x(V.key),V)}}function d(C,k,S){return k&&c(C.prototype,k),Object.defineProperty(C,"prototype",{writable:!1}),C}function h(C,k){if(typeof k!="function"&&k!==null)throw new TypeError("Super expression must either be null or a function");C.prototype=Object.create(k&&k.prototype,{constructor:{value:C,writable:!0,configurable:!0}}),Object.defineProperty(C,"prototype",{writable:!1}),k&&p(C,k)}function p(C,k){return p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(V,z){return V.__proto__=z,V},p(C,k)}function m(C){var k=R();return function(){var V=b(C),z;if(k){var j=b(this).constructor;z=Reflect.construct(V,arguments,j)}else z=V.apply(this,arguments);return g(this,z)}}function g(C,k){if(k&&(n(k)==="object"||typeof k=="function"))return k;if(k!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return y(C)}function y(C){if(C===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return C}function R(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function b(C){return b=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(S){return S.__proto__||Object.getPrototypeOf(S)},b(C)}function _(C,k,S){return k=x(k),k in C?Object.defineProperty(C,k,{value:S,enumerable:!0,configurable:!0,writable:!0}):C[k]=S,C}function x(C){var k=T(C,"string");return n(k)==="symbol"?k:String(k)}function T(C,k){if(n(C)!=="object"||C===null)return C;var S=C[Symbol.toPrimitive];if(S!==void 0){var V=S.call(C,k);if(n(V)!=="object")return V;throw new TypeError("@@toPrimitive must return a primitive value.")}return(k==="string"?String:Number)(C)}var I=function(C){h(S,C);var k=m(S);function S(V,z,j,J){var $;return l(this,S),$=k.call(this),$.sendDirection=V,$.initialWidgetId=z,$.transportWindow=j,$.inboundWindow=J,_(y($),"strictOriginCheck",!1),_(y($),"targetOrigin","*"),_(y($),"timeoutSeconds",10),_(y($),"_ready",!1),_(y($),"_widgetId",null),_(y($),"outboundRequests",new Map),_(y($),"stopController",new AbortController),$._widgetId=z,$}return d(S,[{key:"ready",get:function(){return this._ready}},{key:"widgetId",get:function(){return this._widgetId||null}},{key:"nextRequestId",get:function(){for(var z="widgetapi-".concat(Date.now()),j=0,J=z;this.outboundRequests.has(J);)J="".concat(z,"-").concat(j++);return this.outboundRequests.set(J,null),J}},{key:"sendInternal",value:function(z){console.log("[PostmessageTransport] Sending object to ".concat(this.targetOrigin,": "),z),this.transportWindow.postMessage(z,this.targetOrigin)}},{key:"reply",value:function(z,j){return this.sendInternal(s(s({},z),{},{response:j}))}},{key:"send",value:function(z,j){return this.sendComplete(z,j).then(function(J){return J.response})}},{key:"sendComplete",value:function(z,j){var J=this;if(!this.ready||!this.widgetId)return Promise.reject(new Error("Not ready or unknown widget ID"));var $={api:this.sendDirection,widgetId:this.widgetId,requestId:this.nextRequestId,action:z,data:j};return z===e.WidgetApiToWidgetAction.UpdateVisibility&&($.visible=j.visible),new Promise(function(le,ie){var Z=function(oe){ne(),le(oe)},te=function(oe){ne(),ie(oe)},H=setTimeout(function(){return te(new Error("Request timed out"))},(J.timeoutSeconds||1)*1e3),fe=function(){return te(new Error("Transport stopped"))};J.stopController.signal.addEventListener("abort",fe);var ne=function(){J.outboundRequests.delete($.requestId),clearTimeout(H),J.stopController.signal.removeEventListener("abort",fe)};J.outboundRequests.set($.requestId,{request:$,resolve:Z,reject:te}),J.sendInternal($)})}},{key:"start",value:function(){var z=this;this.inboundWindow.addEventListener("message",function(j){z.handleMessage(j)}),this._ready=!0}},{key:"stop",value:function(){this._ready=!1,this.stopController.abort()}},{key:"handleMessage",value:function(z){if(!this.stopController.signal.aborted&&z.data&&!(this.strictOriginCheck&&z.origin!==window.origin)){var j=z.data;if(!(!j.action||!j.requestId||!j.widgetId))if(j.response){if(j.api!==this.sendDirection)return;this.handleResponse(j)}else{var J=j;if(J.api!==(0,e.invertedDirection)(this.sendDirection))return;this.handleRequest(J)}}}},{key:"handleRequest",value:function(z){if(this.widgetId){if(this.widgetId!==z.widgetId)return}else this._widgetId=z.widgetId;this.emit("message",new CustomEvent("message",{detail:z}))}},{key:"handleResponse",value:function(z){if(z.widgetId===this.widgetId){var j=this.outboundRequests.get(z.requestId);if(j)if((0,e.isErrorResponse)(z.response)){var J=z.response.error,$=J.message,le=i(J,r);j.reject(new e.WidgetApiResponseError($,le))}else j.resolve(z)}}}]),S}(t.EventEmitter);return yh.PostmessageTransport=I,yh}var yl={};Object.defineProperty(yl,"__esModule",{value:!0});yl.WidgetApiToWidgetAction=yl.WidgetApiFromWidgetAction=void 0;var fve=function(t){return t.SupportedApiVersions="supported_api_versions",t.Capabilities="capabilities",t.NotifyCapabilities="notify_capabilities",t.ThemeChange="theme_change",t.LanguageChange="language_change",t.TakeScreenshot="screenshot",t.UpdateVisibility="visibility",t.OpenIDCredentials="openid_credentials",t.WidgetConfig="widget_config",t.CloseModalWidget="close_modal",t.ButtonClicked="button_clicked",t.SendEvent="send_event",t.SendToDevice="send_to_device",t.UpdateState="update_state",t.UpdateTurnServers="update_turn_servers",t}({});yl.WidgetApiToWidgetAction=fve;var hve=function(t){return t.SupportedApiVersions="supported_api_versions",t.ContentLoaded="content_loaded",t.SendSticker="m.sticker",t.UpdateAlwaysOnScreen="set_always_on_screen",t.GetOpenIDCredentials="get_openid",t.CloseModalWidget="close_modal",t.OpenModalWidget="open_modal",t.SetModalButtonEnabled="set_button_enabled",t.SendEvent="send_event",t.SendToDevice="send_to_device",t.WatchTurnServers="watch_turn_servers",t.UnwatchTurnServers="unwatch_turn_servers",t.BeeperReadRoomAccountData="com.beeper.read_room_account_data",t.MSC2876ReadEvents="org.matrix.msc2876.read_events",t.MSC2931Navigate="org.matrix.msc2931.navigate",t.MSC2974RenegotiateCapabilities="org.matrix.msc2974.request_capabilities",t.MSC3869ReadRelations="org.matrix.msc3869.read_relations",t.MSC3973UserDirectorySearch="org.matrix.msc3973.user_directory_search",t.MSC4039GetMediaConfigAction="org.matrix.msc4039.get_media_config",t.MSC4039UploadFileAction="org.matrix.msc4039.upload_file",t.MSC4039DownloadFileAction="org.matrix.msc4039.download_file",t.MSC4157UpdateDelayedEvent="org.matrix.msc4157.update_delayed_event",t}({});yl.WidgetApiFromWidgetAction=hve;var Of={};Object.defineProperty(Of,"__esModule",{value:!0});Of.OpenIDRequestState=void 0;var pve=function(t){return t.Allowed="allowed",t.Blocked="blocked",t.PendingUserConfirmation="request",t}({});Of.OpenIDRequestState=pve;var iv={};Object.defineProperty(iv,"__esModule",{value:!0});iv.MatrixWidgetType=void 0;var mve=function(t){return t.Custom="m.custom",t.JitsiMeet="m.jitsi",t.Stickerpicker="m.stickerpicker",t}({});iv.MatrixWidgetType=mve;var av={};Object.defineProperty(av,"__esModule",{value:!0});av.BuiltInModalButtonID=void 0;var vve=function(t){return t.Close="m.close",t}({});av.BuiltInModalButtonID=vve;var ro={};Object.defineProperty(ro,"__esModule",{value:!0});ro.WidgetEventCapability=ro.EventKind=ro.EventDirection=void 0;function dm(t){"@babel/helpers - typeof";return dm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},dm(t)}function gve(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=yve(t))||e){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(c){throw c},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,s;return{s:function(){r=r.call(t)},n:function(){var c=r.next();return a=c.done,c},e:function(c){o=!0,s=c},f:function(){try{!a&&r.return!=null&&r.return()}finally{if(o)throw s}}}}function yve(t,e){if(t){if(typeof t=="string")return $k(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return $k(t,e)}}function $k(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function bve(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Lk(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Sve(n.key),n)}}function _ve(t,e,r){return e&&Lk(t.prototype,e),r&&Lk(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Sve(t){var e=wve(t,"string");return dm(e)==="symbol"?e:String(e)}function wve(t,e){if(dm(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(dm(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var di=function(t){return t.Event="event",t.State="state_event",t.ToDevice="to_device",t.RoomAccount="room_account",t}({});ro.EventKind=di;var Ds=function(t){return t.Send="send",t.Receive="receive",t}({});ro.EventDirection=Ds;var Eve=function(){function t(e,r,n,i,a){bve(this,t),this.direction=e,this.eventType=r,this.kind=n,this.keyStr=i,this.raw=a}return _ve(t,[{key:"matchesAsStateEvent",value:function(r,n,i){return this.kind!==di.State||this.direction!==r||this.eventType!==n?!1:this.keyStr===null||this.keyStr===i}},{key:"matchesAsToDeviceEvent",value:function(r,n){return!(this.kind!==di.ToDevice||this.direction!==r||this.eventType!==n)}},{key:"matchesAsRoomEvent",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;if(this.kind!==di.Event||this.direction!==r||this.eventType!==n)return!1;if(this.eventType==="m.room.message"){if(this.keyStr===null||this.keyStr===i)return!0}else return!0;return!1}},{key:"matchesAsRoomAccountData",value:function(r,n){return!(this.kind!==di.RoomAccount||this.direction!==r||this.eventType!==n)}}],[{key:"forStateEvent",value:function(r,n,i){n=n.replace(/#/g,"\\#"),i=i!=null?"#".concat(i):"";var a="org.matrix.msc2762.".concat(r,".state_event:").concat(n).concat(i);return t.findEventCapabilities([a])[0]}},{key:"forToDeviceEvent",value:function(r,n){var i="org.matrix.msc3819.".concat(r,".to_device:").concat(n);return t.findEventCapabilities([i])[0]}},{key:"forRoomEvent",value:function(r,n){var i="org.matrix.msc2762.".concat(r,".event:").concat(n);return t.findEventCapabilities([i])[0]}},{key:"forRoomMessageEvent",value:function(r,n){n=n??"";var i="org.matrix.msc2762.".concat(r,".event:m.room.message#").concat(n);return t.findEventCapabilities([i])[0]}},{key:"forRoomAccountData",value:function(r,n){var i="com.beeper.capabilities.".concat(r,".room_account_data:").concat(n);return t.findEventCapabilities([i])[0]}},{key:"findEventCapabilities",value:function(r){var n=[],i=gve(r),a;try{for(i.s();!(a=i.n()).done;){var o=a.value,s=null,l=void 0,c=null;if(o.startsWith("org.matrix.msc2762.send.event:")?(s=Ds.Send,c=di.Event,l=o.substring(30)):o.startsWith("org.matrix.msc2762.send.state_event:")?(s=Ds.Send,c=di.State,l=o.substring(36)):o.startsWith("org.matrix.msc3819.send.to_device:")?(s=Ds.Send,c=di.ToDevice,l=o.substring(34)):o.startsWith("org.matrix.msc2762.receive.event:")?(s=Ds.Receive,c=di.Event,l=o.substring(33)):o.startsWith("org.matrix.msc2762.receive.state_event:")?(s=Ds.Receive,c=di.State,l=o.substring(39)):o.startsWith("org.matrix.msc3819.receive.to_device:")?(s=Ds.Receive,c=di.ToDevice,l=o.substring(37)):o.startsWith("com.beeper.capabilities.receive.room_account_data:")&&(s=Ds.Receive,c=di.RoomAccount,l=o.substring(50)),!(s===null||c===null||l===void 0)){var d=l.startsWith("m.room.message#")||c===di.State,h=null;if(l.includes("#")&&d){var p=l.split("#"),m=p.findIndex(function(g){return!g.endsWith("\\")});l=p.slice(0,m+1).map(function(g){return g.endsWith("\\")?g.substring(0,g.length-1):g}).join("#"),h=p.slice(m+1).join("#")}n.push(new t(s,l,c,h,o))}}}catch(g){i.e(g)}finally{i.f()}return n}}]),t}();ro.WidgetEventCapability=Eve;var $f={};Object.defineProperty($f,"__esModule",{value:!0});$f.Symbols=void 0;var xve=function(t){return t.AnyRoom="*",t}({});$f.Symbols=xve;var Bk;function Cve(){if(Bk)return Ul;Bk=1;function t(oe){"@babel/helpers - typeof";return t=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(me){return typeof me}:function(me){return me&&typeof Symbol=="function"&&me.constructor===Symbol&&me!==Symbol.prototype?"symbol":typeof me},t(oe)}Object.defineProperty(Ul,"__esModule",{value:!0}),Ul.WidgetApiResponseError=Ul.WidgetApi=void 0;var e=Wb,r=ec,n=to,i=S3(),a=yl,o=Of,s=iv,l=av,c=ro,d=$f;function h(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */h=function(){return oe};var oe={},me=Object.prototype,ee=me.hasOwnProperty,Y=Object.defineProperty||function(G,re,Q){G[re]=Q.value},q=typeof Symbol=="function"?Symbol:{},X=q.iterator||"@@iterator",F=q.asyncIterator||"@@asyncIterator",se=q.toStringTag||"@@toStringTag";function N(G,re,Q){return Object.defineProperty(G,re,{value:Q,enumerable:!0,configurable:!0,writable:!0}),G[re]}try{N({},"")}catch{N=function(Q,ae,ve){return Q[ae]=ve}}function ce(G,re,Q,ae){var ve=re&&re.prototype instanceof be?re:be,xe=Object.create(ve.prototype),Me=new B(ae||[]);return Y(xe,"_invoke",{value:Pe(G,Q,Me)}),xe}function ue(G,re,Q){try{return{type:"normal",arg:G.call(re,Q)}}catch(ae){return{type:"throw",arg:ae}}}oe.wrap=ce;var pe={};function be(){}function we(){}function Ce(){}var $e={};N($e,X,function(){return this});var Ne=Object.getPrototypeOf,Ie=Ne&&Ne(Ne(M([])));Ie&&Ie!==me&&ee.call(Ie,X)&&($e=Ie);var Ge=Ce.prototype=be.prototype=Object.create($e);function nt(G){["next","throw","return"].forEach(function(re){N(G,re,function(Q){return this._invoke(re,Q)})})}function ze(G,re){function Q(ve,xe,Me,Ee){var ke=ue(G[ve],G,xe);if(ke.type!=="throw"){var pt=ke.arg,gt=pt.value;return gt&&t(gt)=="object"&&ee.call(gt,"__await")?re.resolve(gt.__await).then(function(hr){Q("next",hr,Me,Ee)},function(hr){Q("throw",hr,Me,Ee)}):re.resolve(gt).then(function(hr){pt.value=hr,Me(pt)},function(hr){return Q("throw",hr,Me,Ee)})}Ee(ke.arg)}var ae;Y(this,"_invoke",{value:function(xe,Me){function Ee(){return new re(function(ke,pt){Q(xe,Me,ke,pt)})}return ae=ae?ae.then(Ee,Ee):Ee()}})}function Pe(G,re,Q){var ae="suspendedStart";return function(ve,xe){if(ae==="executing")throw new Error("Generator is already running");if(ae==="completed"){if(ve==="throw")throw xe;return P()}for(Q.method=ve,Q.arg=xe;;){var Me=Q.delegate;if(Me){var Ee=vt(Me,Q);if(Ee){if(Ee===pe)continue;return Ee}}if(Q.method==="next")Q.sent=Q._sent=Q.arg;else if(Q.method==="throw"){if(ae==="suspendedStart")throw ae="completed",Q.arg;Q.dispatchException(Q.arg)}else Q.method==="return"&&Q.abrupt("return",Q.arg);ae="executing";var ke=ue(G,re,Q);if(ke.type==="normal"){if(ae=Q.done?"completed":"suspendedYield",ke.arg===pe)continue;return{value:ke.arg,done:Q.done}}ke.type==="throw"&&(ae="completed",Q.method="throw",Q.arg=ke.arg)}}}function vt(G,re){var Q=re.method,ae=G.iterator[Q];if(ae===void 0)return re.delegate=null,Q==="throw"&&G.iterator.return&&(re.method="return",re.arg=void 0,vt(G,re),re.method==="throw")||Q!=="return"&&(re.method="throw",re.arg=new TypeError("The iterator does not provide a '"+Q+"' method")),pe;var ve=ue(ae,G.iterator,re.arg);if(ve.type==="throw")return re.method="throw",re.arg=ve.arg,re.delegate=null,pe;var xe=ve.arg;return xe?xe.done?(re[G.resultName]=xe.value,re.next=G.nextLoc,re.method!=="return"&&(re.method="next",re.arg=void 0),re.delegate=null,pe):xe:(re.method="throw",re.arg=new TypeError("iterator result is not an object"),re.delegate=null,pe)}function Tt(G){var re={tryLoc:G[0]};1 in G&&(re.catchLoc=G[1]),2 in G&&(re.finallyLoc=G[2],re.afterLoc=G[3]),this.tryEntries.push(re)}function ir(G){var re=G.completion||{};re.type="normal",delete re.arg,G.completion=re}function B(G){this.tryEntries=[{tryLoc:"root"}],G.forEach(Tt,this),this.reset(!0)}function M(G){if(G){var re=G[X];if(re)return re.call(G);if(typeof G.next=="function")return G;if(!isNaN(G.length)){var Q=-1,ae=function ve(){for(;++Q<G.length;)if(ee.call(G,Q))return ve.value=G[Q],ve.done=!1,ve;return ve.value=void 0,ve.done=!0,ve};return ae.next=ae}}return{next:P}}function P(){return{value:void 0,done:!0}}return we.prototype=Ce,Y(Ge,"constructor",{value:Ce,configurable:!0}),Y(Ce,"constructor",{value:we,configurable:!0}),we.displayName=N(Ce,se,"GeneratorFunction"),oe.isGeneratorFunction=function(G){var re=typeof G=="function"&&G.constructor;return!!re&&(re===we||(re.displayName||re.name)==="GeneratorFunction")},oe.mark=function(G){return Object.setPrototypeOf?Object.setPrototypeOf(G,Ce):(G.__proto__=Ce,N(G,se,"GeneratorFunction")),G.prototype=Object.create(Ge),G},oe.awrap=function(G){return{__await:G}},nt(ze.prototype),N(ze.prototype,F,function(){return this}),oe.AsyncIterator=ze,oe.async=function(G,re,Q,ae,ve){ve===void 0&&(ve=Promise);var xe=new ze(ce(G,re,Q,ae),ve);return oe.isGeneratorFunction(re)?xe:xe.next().then(function(Me){return Me.done?Me.value:xe.next()})},nt(Ge),N(Ge,se,"Generator"),N(Ge,X,function(){return this}),N(Ge,"toString",function(){return"[object Generator]"}),oe.keys=function(G){var re=Object(G),Q=[];for(var ae in re)Q.push(ae);return Q.reverse(),function ve(){for(;Q.length;){var xe=Q.pop();if(xe in re)return ve.value=xe,ve.done=!1,ve}return ve.done=!0,ve}},oe.values=M,B.prototype={constructor:B,reset:function(re){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(ir),!re)for(var Q in this)Q.charAt(0)==="t"&&ee.call(this,Q)&&!isNaN(+Q.slice(1))&&(this[Q]=void 0)},stop:function(){this.done=!0;var re=this.tryEntries[0].completion;if(re.type==="throw")throw re.arg;return this.rval},dispatchException:function(re){if(this.done)throw re;var Q=this;function ae(pt,gt){return Me.type="throw",Me.arg=re,Q.next=pt,gt&&(Q.method="next",Q.arg=void 0),!!gt}for(var ve=this.tryEntries.length-1;ve>=0;--ve){var xe=this.tryEntries[ve],Me=xe.completion;if(xe.tryLoc==="root")return ae("end");if(xe.tryLoc<=this.prev){var Ee=ee.call(xe,"catchLoc"),ke=ee.call(xe,"finallyLoc");if(Ee&&ke){if(this.prev<xe.catchLoc)return ae(xe.catchLoc,!0);if(this.prev<xe.finallyLoc)return ae(xe.finallyLoc)}else if(Ee){if(this.prev<xe.catchLoc)return ae(xe.catchLoc,!0)}else{if(!ke)throw new Error("try statement without catch or finally");if(this.prev<xe.finallyLoc)return ae(xe.finallyLoc)}}}},abrupt:function(re,Q){for(var ae=this.tryEntries.length-1;ae>=0;--ae){var ve=this.tryEntries[ae];if(ve.tryLoc<=this.prev&&ee.call(ve,"finallyLoc")&&this.prev<ve.finallyLoc){var xe=ve;break}}xe&&(re==="break"||re==="continue")&&xe.tryLoc<=Q&&Q<=xe.finallyLoc&&(xe=null);var Me=xe?xe.completion:{};return Me.type=re,Me.arg=Q,xe?(this.method="next",this.next=xe.finallyLoc,pe):this.complete(Me)},complete:function(re,Q){if(re.type==="throw")throw re.arg;return re.type==="break"||re.type==="continue"?this.next=re.arg:re.type==="return"?(this.rval=this.arg=re.arg,this.method="return",this.next="end"):re.type==="normal"&&Q&&(this.next=Q),pe},finish:function(re){for(var Q=this.tryEntries.length-1;Q>=0;--Q){var ae=this.tryEntries[Q];if(ae.finallyLoc===re)return this.complete(ae.completion,ae.afterLoc),ir(ae),pe}},catch:function(re){for(var Q=this.tryEntries.length-1;Q>=0;--Q){var ae=this.tryEntries[Q];if(ae.tryLoc===re){var ve=ae.completion;if(ve.type==="throw"){var xe=ve.arg;ir(ae)}return xe}}throw new Error("illegal catch attempt")},delegateYield:function(re,Q,ae){return this.delegate={iterator:M(re),resultName:Q,nextLoc:ae},this.method==="next"&&(this.arg=void 0),pe}},oe}function p(oe,me,ee,Y,q,X,F){try{var se=oe[X](F),N=se.value}catch(ce){ee(ce);return}se.done?me(N):Promise.resolve(N).then(Y,q)}function m(oe){return function(){var me=this,ee=arguments;return new Promise(function(Y,q){var X=oe.apply(me,ee);function F(N){p(X,Y,q,F,se,"next",N)}function se(N){p(X,Y,q,F,se,"throw",N)}F(void 0)})}}function g(oe,me){var ee=Object.keys(oe);if(Object.getOwnPropertySymbols){var Y=Object.getOwnPropertySymbols(oe);me&&(Y=Y.filter(function(q){return Object.getOwnPropertyDescriptor(oe,q).enumerable})),ee.push.apply(ee,Y)}return ee}function y(oe){for(var me=1;me<arguments.length;me++){var ee=arguments[me]!=null?arguments[me]:{};me%2?g(Object(ee),!0).forEach(function(Y){R(oe,Y,ee[Y])}):Object.getOwnPropertyDescriptors?Object.defineProperties(oe,Object.getOwnPropertyDescriptors(ee)):g(Object(ee)).forEach(function(Y){Object.defineProperty(oe,Y,Object.getOwnPropertyDescriptor(ee,Y))})}return oe}function R(oe,me,ee){return me=x(me),me in oe?Object.defineProperty(oe,me,{value:ee,enumerable:!0,configurable:!0,writable:!0}):oe[me]=ee,oe}function b(oe,me){for(var ee=0;ee<me.length;ee++){var Y=me[ee];Y.enumerable=Y.enumerable||!1,Y.configurable=!0,"value"in Y&&(Y.writable=!0),Object.defineProperty(oe,x(Y.key),Y)}}function _(oe,me,ee){return me&&b(oe.prototype,me),Object.defineProperty(oe,"prototype",{writable:!1}),oe}function x(oe){var me=T(oe,"string");return t(me)==="symbol"?me:String(me)}function T(oe,me){if(t(oe)!=="object"||oe===null)return oe;var ee=oe[Symbol.toPrimitive];if(ee!==void 0){var Y=ee.call(oe,me);if(t(Y)!=="object")return Y;throw new TypeError("@@toPrimitive must return a primitive value.")}return(me==="string"?String:Number)(oe)}function I(oe,me){if(!(oe instanceof me))throw new TypeError("Cannot call a class as a function")}function C(oe,me){if(typeof me!="function"&&me!==null)throw new TypeError("Super expression must either be null or a function");oe.prototype=Object.create(me&&me.prototype,{constructor:{value:oe,writable:!0,configurable:!0}}),Object.defineProperty(oe,"prototype",{writable:!1}),me&&le(oe,me)}function k(oe){var me=J();return function(){var Y=ie(oe),q;if(me){var X=ie(this).constructor;q=Reflect.construct(Y,arguments,X)}else q=Y.apply(this,arguments);return S(this,q)}}function S(oe,me){if(me&&(t(me)==="object"||typeof me=="function"))return me;if(me!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return V(oe)}function V(oe){if(oe===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return oe}function z(oe){var me=typeof Map=="function"?new Map:void 0;return z=function(Y){if(Y===null||!$(Y))return Y;if(typeof Y!="function")throw new TypeError("Super expression must either be null or a function");if(typeof me<"u"){if(me.has(Y))return me.get(Y);me.set(Y,q)}function q(){return j(Y,arguments,ie(this).constructor)}return q.prototype=Object.create(Y.prototype,{constructor:{value:q,enumerable:!1,writable:!0,configurable:!0}}),le(q,Y)},z(oe)}function j(oe,me,ee){return J()?j=Reflect.construct.bind():j=function(q,X,F){var se=[null];se.push.apply(se,X);var N=Function.bind.apply(q,se),ce=new N;return F&&le(ce,F.prototype),ce},j.apply(null,arguments)}function J(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function $(oe){return Function.toString.call(oe).indexOf("[native code]")!==-1}function le(oe,me){return le=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(Y,q){return Y.__proto__=q,Y},le(oe,me)}function ie(oe){return ie=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(ee){return ee.__proto__||Object.getPrototypeOf(ee)},ie(oe)}function Z(oe){return new fe(oe,0)}function te(oe){return function(){return new H(oe.apply(this,arguments))}}function H(oe){var me,ee;function Y(X,F){try{var se=oe[X](F),N=se.value,ce=N instanceof fe;Promise.resolve(ce?N.v:N).then(function(ue){if(ce){var pe=X==="return"?"return":"next";if(!N.k||ue.done)return Y(pe,ue);ue=oe[pe](ue).value}q(se.done?"return":"normal",ue)},function(ue){Y("throw",ue)})}catch(ue){q("throw",ue)}}function q(X,F){switch(X){case"return":me.resolve({value:F,done:!0});break;case"throw":me.reject(F);break;default:me.resolve({value:F,done:!1})}(me=me.next)?Y(me.key,me.arg):ee=null}this._invoke=function(X,F){return new Promise(function(se,N){var ce={key:X,arg:F,resolve:se,reject:N,next:null};ee?ee=ee.next=ce:(me=ee=ce,Y(X,F))})},typeof oe.return!="function"&&(this.return=void 0)}H.prototype[typeof Symbol=="function"&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},H.prototype.next=function(oe){return this._invoke("next",oe)},H.prototype.throw=function(oe){return this._invoke("throw",oe)},H.prototype.return=function(oe){return this._invoke("return",oe)};function fe(oe,me){this.v=oe,this.k=me}var ne=function(oe){C(ee,oe);var me=k(ee);function ee(Y,q){var X;return I(this,ee),X=me.call(this,Y),X.data=q,X}return _(ee)}(z(Error));Ul.WidgetApiResponseError=ne,ne.prototype.name=ne.name;var he=function(oe){C(ee,oe);var me=k(ee);function ee(){var Y,q=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,X=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(I(this,ee),Y=me.call(this),Y.clientOrigin=X,R(V(Y),"transport",void 0),R(V(Y),"capabilitiesFinished",!1),R(V(Y),"supportsMSC2974Renegotiate",!1),R(V(Y),"requestedCapabilities",[]),R(V(Y),"approvedCapabilities",void 0),R(V(Y),"cachedClientVersions",void 0),R(V(Y),"turnServerWatchers",0),!window.parent)throw new Error("No parent window. This widget doesn't appear to be embedded properly.");return Y.transport=new i.PostmessageTransport(r.WidgetApiDirection.FromWidget,q,window.parent,window),Y.transport.targetOrigin=X,Y.transport.on("message",Y.handleMessage.bind(V(Y))),Y}return _(ee,[{key:"hasCapability",value:function(q){return Array.isArray(this.approvedCapabilities)?this.approvedCapabilities.includes(q):this.requestedCapabilities.includes(q)}},{key:"requestCapability",value:function(q){if(this.capabilitiesFinished&&!this.supportsMSC2974Renegotiate)throw new Error("Capabilities have already been negotiated");this.requestedCapabilities.push(q)}},{key:"requestCapabilities",value:function(q){var X=this;q.forEach(function(F){return X.requestCapability(F)})}},{key:"requestCapabilityForRoomTimeline",value:function(q){this.requestCapability("org.matrix.msc2762.timeline:".concat(q))}},{key:"requestCapabilityToSendState",value:function(q,X){this.requestCapability(c.WidgetEventCapability.forStateEvent(c.EventDirection.Send,q,X).raw)}},{key:"requestCapabilityToReceiveState",value:function(q,X){this.requestCapability(c.WidgetEventCapability.forStateEvent(c.EventDirection.Receive,q,X).raw)}},{key:"requestCapabilityToSendToDevice",value:function(q){this.requestCapability(c.WidgetEventCapability.forToDeviceEvent(c.EventDirection.Send,q).raw)}},{key:"requestCapabilityToReceiveToDevice",value:function(q){this.requestCapability(c.WidgetEventCapability.forToDeviceEvent(c.EventDirection.Receive,q).raw)}},{key:"requestCapabilityToSendEvent",value:function(q){this.requestCapability(c.WidgetEventCapability.forRoomEvent(c.EventDirection.Send,q).raw)}},{key:"requestCapabilityToReceiveEvent",value:function(q){this.requestCapability(c.WidgetEventCapability.forRoomEvent(c.EventDirection.Receive,q).raw)}},{key:"requestCapabilityToSendMessage",value:function(q){this.requestCapability(c.WidgetEventCapability.forRoomMessageEvent(c.EventDirection.Send,q).raw)}},{key:"requestCapabilityToReceiveMessage",value:function(q){this.requestCapability(c.WidgetEventCapability.forRoomMessageEvent(c.EventDirection.Receive,q).raw)}},{key:"requestCapabilityToReceiveRoomAccountData",value:function(q){this.requestCapability(c.WidgetEventCapability.forRoomAccountData(c.EventDirection.Receive,q).raw)}},{key:"requestOpenIDConnectToken",value:function(){var q=this;return new Promise(function(X,F){q.transport.sendComplete(a.WidgetApiFromWidgetAction.GetOpenIDCredentials,{}).then(function(se){var N=se.response;if(N.state===o.OpenIDRequestState.Allowed)X(N);else if(N.state===o.OpenIDRequestState.Blocked)F(new Error("User declined to verify their identity"));else if(N.state===o.OpenIDRequestState.PendingUserConfirmation){var ce=function ue(pe){pe.preventDefault();var be=pe.detail;be.data.original_request_id===se.requestId&&(be.data.state===o.OpenIDRequestState.Allowed?(X(be.data),q.transport.reply(be,{})):be.data.state===o.OpenIDRequestState.Blocked?(F(new Error("User declined to verify their identity")),q.transport.reply(be,{})):(F(new Error("Invalid state on reply: "+N.state)),q.transport.reply(be,{error:{message:"Invalid state"}})),q.off("action:".concat(a.WidgetApiToWidgetAction.OpenIDCredentials),ue))};q.on("action:".concat(a.WidgetApiToWidgetAction.OpenIDCredentials),ce)}else F(new Error("Invalid state: "+N.state))}).catch(F)})}},{key:"updateRequestedCapabilities",value:function(){return this.transport.send(a.WidgetApiFromWidgetAction.MSC2974RenegotiateCapabilities,{capabilities:this.requestedCapabilities}).then()}},{key:"sendContentLoaded",value:function(){return this.transport.send(a.WidgetApiFromWidgetAction.ContentLoaded,{}).then()}},{key:"sendSticker",value:function(q){return this.transport.send(a.WidgetApiFromWidgetAction.SendSticker,q).then()}},{key:"setAlwaysOnScreen",value:function(q){return this.transport.send(a.WidgetApiFromWidgetAction.UpdateAlwaysOnScreen,{value:q}).then(function(X){return X.success})}},{key:"openModalWidget",value:function(q,X){var F=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],se=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},N=arguments.length>4&&arguments[4]!==void 0?arguments[4]:s.MatrixWidgetType.Custom;return this.transport.send(a.WidgetApiFromWidgetAction.OpenModalWidget,{type:N,url:q,name:X,buttons:F,data:se}).then()}},{key:"closeModalWidget",value:function(){var q=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.transport.send(a.WidgetApiFromWidgetAction.CloseModalWidget,q).then()}},{key:"sendRoomEvent",value:function(q,X,F,se,N){return this.sendEvent(q,void 0,X,F,se,N)}},{key:"sendStateEvent",value:function(q,X,F,se,N,ce){return this.sendEvent(q,X,F,se,N,ce)}},{key:"sendEvent",value:function(q,X,F,se,N,ce){return this.transport.send(a.WidgetApiFromWidgetAction.SendEvent,y(y(y(y({type:q,content:F},X!==void 0&&{state_key:X}),se!==void 0&&{room_id:se}),N!==void 0&&{delay:N}),ce!==void 0&&{parent_delay_id:ce}))}},{key:"updateDelayedEvent",value:function(q,X){return this.transport.send(a.WidgetApiFromWidgetAction.MSC4157UpdateDelayedEvent,{delay_id:q,action:X})}},{key:"sendToDevice",value:function(q,X,F){return this.transport.send(a.WidgetApiFromWidgetAction.SendToDevice,{type:q,encrypted:X,messages:F})}},{key:"readRoomAccountData",value:function(q,X){var F={type:q};return X&&(X.includes(d.Symbols.AnyRoom)?F.room_ids=d.Symbols.AnyRoom:F.room_ids=X),this.transport.send(a.WidgetApiFromWidgetAction.BeeperReadRoomAccountData,F).then(function(se){return se.events})}},{key:"readRoomEvents",value:function(q,X,F,se,N){var ce={type:q,msgtype:F};return X!==void 0&&(ce.limit=X),se&&(se.includes(d.Symbols.AnyRoom)?ce.room_ids=d.Symbols.AnyRoom:ce.room_ids=se),N&&(ce.since=N),this.transport.send(a.WidgetApiFromWidgetAction.MSC2876ReadEvents,ce).then(function(ue){return ue.events})}},{key:"readEventRelations",value:function(){var Y=m(h().mark(function X(F,se,N,ce,ue,pe,be,we){var Ce,$e;return h().wrap(function(Ie){for(;;)switch(Ie.prev=Ie.next){case 0:return Ie.next=2,this.getClientVersions();case 2:if(Ce=Ie.sent,Ce.includes(n.UnstableApiVersion.MSC3869)){Ie.next=5;break}throw new Error("The read_relations action is not supported by the client.");case 5:return $e={event_id:F,rel_type:N,event_type:ce,room_id:se,to:be,from:pe,limit:ue,direction:we},Ie.abrupt("return",this.transport.send(a.WidgetApiFromWidgetAction.MSC3869ReadRelations,$e));case 7:case"end":return Ie.stop()}},X,this)}));function q(X,F,se,N,ce,ue,pe,be){return Y.apply(this,arguments)}return q}()},{key:"readStateEvents",value:function(q,X,F,se){var N={type:q,state_key:F===void 0?!0:F};return X!==void 0&&(N.limit=X),se&&(se.includes(d.Symbols.AnyRoom)?N.room_ids=d.Symbols.AnyRoom:N.room_ids=se),this.transport.send(a.WidgetApiFromWidgetAction.MSC2876ReadEvents,N).then(function(ce){return ce.events})}},{key:"setModalButtonEnabled",value:function(q,X){if(q===l.BuiltInModalButtonID.Close)throw new Error("The close button cannot be disabled");return this.transport.send(a.WidgetApiFromWidgetAction.SetModalButtonEnabled,{button:q,enabled:X}).then()}},{key:"navigateTo",value:function(q){if(!q||!q.startsWith("https://matrix.to/#"))throw new Error("Invalid matrix.to URI");return this.transport.send(a.WidgetApiFromWidgetAction.MSC2931Navigate,{uri:q}).then()}},{key:"getTurnServers",value:function(){var q=this;return te(h().mark(function X(){var F,se;return h().wrap(function(ce){for(;;)switch(ce.prev=ce.next){case 0:if(se=function(){var ue=m(h().mark(function pe(be){return h().wrap(function(Ce){for(;;)switch(Ce.prev=Ce.next){case 0:return be.preventDefault(),F(be.detail.data),Ce.next=4,q.transport.reply(be.detail,{});case 4:case"end":return Ce.stop()}},pe)}));return function(be){return ue.apply(this,arguments)}}(),q.on("action:".concat(a.WidgetApiToWidgetAction.UpdateTurnServers),se),q.turnServerWatchers!==0){ce.next=12;break}return ce.prev=3,ce.next=6,Z(q.transport.send(a.WidgetApiFromWidgetAction.WatchTurnServers,{}));case 6:ce.next=12;break;case 8:throw ce.prev=8,ce.t0=ce.catch(3),q.off("action:".concat(a.WidgetApiToWidgetAction.UpdateTurnServers),se),ce.t0;case 12:q.turnServerWatchers++,ce.prev=13;case 14:return ce.next=17,Z(new Promise(function(ue){return F=ue}));case 17:return ce.next=19,ce.sent;case 19:ce.next=14;break;case 21:if(ce.prev=21,q.off("action:".concat(a.WidgetApiToWidgetAction.UpdateTurnServers),se),q.turnServerWatchers--,q.turnServerWatchers!==0){ce.next=27;break}return ce.next=27,Z(q.transport.send(a.WidgetApiFromWidgetAction.UnwatchTurnServers,{}));case 27:return ce.finish(21);case 28:case"end":return ce.stop()}},X,null,[[3,8],[13,,21,28]])}))()}},{key:"searchUserDirectory",value:function(){var Y=m(h().mark(function X(F,se){var N,ce;return h().wrap(function(pe){for(;;)switch(pe.prev=pe.next){case 0:return pe.next=2,this.getClientVersions();case 2:if(N=pe.sent,N.includes(n.UnstableApiVersion.MSC3973)){pe.next=5;break}throw new Error("The user_directory_search action is not supported by the client.");case 5:return ce={search_term:F,limit:se},pe.abrupt("return",this.transport.send(a.WidgetApiFromWidgetAction.MSC3973UserDirectorySearch,ce));case 7:case"end":return pe.stop()}},X,this)}));function q(X,F){return Y.apply(this,arguments)}return q}()},{key:"getMediaConfig",value:function(){var Y=m(h().mark(function X(){var F,se;return h().wrap(function(ce){for(;;)switch(ce.prev=ce.next){case 0:return ce.next=2,this.getClientVersions();case 2:if(F=ce.sent,F.includes(n.UnstableApiVersion.MSC4039)){ce.next=5;break}throw new Error("The get_media_config action is not supported by the client.");case 5:return se={},ce.abrupt("return",this.transport.send(a.WidgetApiFromWidgetAction.MSC4039GetMediaConfigAction,se));case 7:case"end":return ce.stop()}},X,this)}));function q(){return Y.apply(this,arguments)}return q}()},{key:"uploadFile",value:function(){var Y=m(h().mark(function X(F){var se,N;return h().wrap(function(ue){for(;;)switch(ue.prev=ue.next){case 0:return ue.next=2,this.getClientVersions();case 2:if(se=ue.sent,se.includes(n.UnstableApiVersion.MSC4039)){ue.next=5;break}throw new Error("The upload_file action is not supported by the client.");case 5:return N={file:F},ue.abrupt("return",this.transport.send(a.WidgetApiFromWidgetAction.MSC4039UploadFileAction,N));case 7:case"end":return ue.stop()}},X,this)}));function q(X){return Y.apply(this,arguments)}return q}()},{key:"downloadFile",value:function(){var Y=m(h().mark(function X(F){var se,N;return h().wrap(function(ue){for(;;)switch(ue.prev=ue.next){case 0:return ue.next=2,this.getClientVersions();case 2:if(se=ue.sent,se.includes(n.UnstableApiVersion.MSC4039)){ue.next=5;break}throw new Error("The download_file action is not supported by the client.");case 5:return N={content_uri:F},ue.abrupt("return",this.transport.send(a.WidgetApiFromWidgetAction.MSC4039DownloadFileAction,N));case 7:case"end":return ue.stop()}},X,this)}));function q(X){return Y.apply(this,arguments)}return q}()},{key:"start",value:function(){var q=this;this.transport.start(),this.getClientVersions().then(function(X){X.includes(n.UnstableApiVersion.MSC2974)&&(q.supportsMSC2974Renegotiate=!0)})}},{key:"handleMessage",value:function(q){var X=new CustomEvent("action:".concat(q.detail.action),{detail:q.detail,cancelable:!0});if(this.emit("action:".concat(q.detail.action),X),!X.defaultPrevented)switch(q.detail.action){case a.WidgetApiToWidgetAction.SupportedApiVersions:return this.replyVersions(q.detail);case a.WidgetApiToWidgetAction.Capabilities:return this.handleCapabilities(q.detail);case a.WidgetApiToWidgetAction.UpdateVisibility:return this.transport.reply(q.detail,{});case a.WidgetApiToWidgetAction.NotifyCapabilities:return this.transport.reply(q.detail,{});default:return this.transport.reply(q.detail,{error:{message:"Unknown or unsupported action: "+q.detail.action}})}}},{key:"replyVersions",value:function(q){this.transport.reply(q,{supported_versions:n.CurrentApiVersions})}},{key:"getClientVersions",value:function(){var q=this;return Array.isArray(this.cachedClientVersions)?Promise.resolve(this.cachedClientVersions):this.transport.send(a.WidgetApiFromWidgetAction.SupportedApiVersions,{}).then(function(X){return q.cachedClientVersions=X.supported_versions,X.supported_versions}).catch(function(X){return console.warn("non-fatal error getting supported client versions: ",X),[]})}},{key:"handleCapabilities",value:function(q){var X=this;return this.capabilitiesFinished?this.transport.reply(q,{error:{message:"Capability negotiation already completed"}}):this.getClientVersions().then(function(F){return F.includes(n.UnstableApiVersion.MSC2871)?X.once("action:".concat(a.WidgetApiToWidgetAction.NotifyCapabilities),function(se){X.approvedCapabilities=se.detail.data.approved,X.emit("ready")}):X.emit("ready"),X.capabilitiesFinished=!0,X.transport.reply(q,{capabilities:X.requestedCapabilities})})}}]),ee}(e.EventEmitter);return Ul.WidgetApi=he,Ul}var bh={},ra={};Object.defineProperty(ra,"__esModule",{value:!0});ra.VideoConferenceCapabilities=ra.StickerpickerCapabilities=ra.MatrixCapabilities=void 0;ra.getTimelineRoomIDFromCapability=Ive;ra.isTimelineCapability=Rve;ra.isTimelineCapabilityFor=Mve;var w3=function(t){return t.Screenshots="m.capability.screenshot",t.StickerSending="m.sticker",t.AlwaysOnScreen="m.always_on_screen",t.RequiresClient="io.element.requires_client",t.MSC2931Navigate="org.matrix.msc2931.navigate",t.MSC3846TurnServers="town.robin.msc3846.turn_servers",t.MSC3973UserDirectorySearch="org.matrix.msc3973.user_directory_search",t.MSC4039UploadFile="org.matrix.msc4039.upload_file",t.MSC4039DownloadFile="org.matrix.msc4039.download_file",t.MSC4157SendDelayedEvent="org.matrix.msc4157.send.delayed_event",t.MSC4157UpdateDelayedEvent="org.matrix.msc4157.update_delayed_event",t}({});ra.MatrixCapabilities=w3;var Tve=[w3.StickerSending];ra.StickerpickerCapabilities=Tve;var Dve=[w3.AlwaysOnScreen];ra.VideoConferenceCapabilities=Dve;function Rve(t){return t==null?void 0:t.startsWith("org.matrix.msc2762.timeline:")}function Mve(t,e){return t==="org.matrix.msc2762.timeline:".concat(e)}function Ive(t){return t.substring(t.indexOf(":")+1)}var ov={};Object.defineProperty(ov,"__esModule",{value:!0});ov.SimpleObservable=void 0;function fm(t){"@babel/helpers - typeof";return fm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},fm(t)}function Pve(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=Ave(t))||e){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(c){throw c},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,s;return{s:function(){r=r.call(t)},n:function(){var c=r.next();return a=c.done,c},e:function(c){o=!0,s=c},f:function(){try{!a&&r.return!=null&&r.return()}finally{if(o)throw s}}}}function Ave(t,e){if(t){if(typeof t=="string")return Nk(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Nk(t,e)}}function Nk(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function kve(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ove(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,cz(n.key),n)}}function $ve(t,e,r){return e&&Ove(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function Lve(t,e,r){return e=cz(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function cz(t){var e=Bve(t,"string");return fm(e)==="symbol"?e:String(e)}function Bve(t,e){if(fm(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(fm(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Nve=function(){function t(e){kve(this,t),Lve(this,"listeners",[]),e&&this.listeners.push(e)}return $ve(t,[{key:"onUpdate",value:function(r){this.listeners.push(r)}},{key:"update",value:function(r){var n=Pve(this.listeners),i;try{for(n.s();!(i=n.n()).done;){var a=i.value;a(r)}}catch(o){n.e(o)}finally{n.f()}}},{key:"close",value:function(){this.listeners=[]}}]),t}();ov.SimpleObservable=Nve;var sv={};Object.defineProperty(sv,"__esModule",{value:!0});sv.UpdateDelayedEventAction=void 0;var Uve=function(t){return t.Cancel="cancel",t.Restart="restart",t.Send="send",t}({});sv.UpdateDelayedEventAction=Uve;var Uk;function Fve(){if(Uk)return bh;Uk=1,Object.defineProperty(bh,"__esModule",{value:!0}),bh.ClientWidgetApi=void 0;var t=Wb,e=S3(),r=ec,n=yl,i=ra,a=to,o=ro,s=Of,l=ov,c=$f,d=sv;function h(ee){"@babel/helpers - typeof";return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Y){return typeof Y}:function(Y){return Y&&typeof Symbol=="function"&&Y.constructor===Symbol&&Y!==Symbol.prototype?"symbol":typeof Y},h(ee)}function p(ee,Y){var q=Object.keys(ee);if(Object.getOwnPropertySymbols){var X=Object.getOwnPropertySymbols(ee);Y&&(X=X.filter(function(F){return Object.getOwnPropertyDescriptor(ee,F).enumerable})),q.push.apply(q,X)}return q}function m(ee){for(var Y=1;Y<arguments.length;Y++){var q=arguments[Y]!=null?arguments[Y]:{};Y%2?p(Object(q),!0).forEach(function(X){H(ee,X,q[X])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ee,Object.getOwnPropertyDescriptors(q)):p(Object(q)).forEach(function(X){Object.defineProperty(ee,X,Object.getOwnPropertyDescriptor(q,X))})}return ee}function g(ee,Y){var q=typeof Symbol<"u"&&ee[Symbol.iterator]||ee["@@iterator"];if(!q){if(Array.isArray(ee)||(q=b(ee))||Y){q&&(ee=q);var X=0,F=function(){};return{s:F,n:function(){return X>=ee.length?{done:!0}:{done:!1,value:ee[X++]}},e:function(pe){throw pe},f:F}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var se=!0,N=!1,ce;return{s:function(){q=q.call(ee)},n:function(){var pe=q.next();return se=pe.done,pe},e:function(pe){N=!0,ce=pe},f:function(){try{!se&&q.return!=null&&q.return()}finally{if(N)throw ce}}}}function y(ee){return x(ee)||_(ee)||b(ee)||R()}function R(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function b(ee,Y){if(ee){if(typeof ee=="string")return T(ee,Y);var q=Object.prototype.toString.call(ee).slice(8,-1);if(q==="Object"&&ee.constructor&&(q=ee.constructor.name),q==="Map"||q==="Set")return Array.from(ee);if(q==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(q))return T(ee,Y)}}function _(ee){if(typeof Symbol<"u"&&ee[Symbol.iterator]!=null||ee["@@iterator"]!=null)return Array.from(ee)}function x(ee){if(Array.isArray(ee))return T(ee)}function T(ee,Y){(Y==null||Y>ee.length)&&(Y=ee.length);for(var q=0,X=new Array(Y);q<Y;q++)X[q]=ee[q];return X}function I(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */I=function(){return ee};var ee={},Y=Object.prototype,q=Y.hasOwnProperty,X=Object.defineProperty||function(Q,ae,ve){Q[ae]=ve.value},F=typeof Symbol=="function"?Symbol:{},se=F.iterator||"@@iterator",N=F.asyncIterator||"@@asyncIterator",ce=F.toStringTag||"@@toStringTag";function ue(Q,ae,ve){return Object.defineProperty(Q,ae,{value:ve,enumerable:!0,configurable:!0,writable:!0}),Q[ae]}try{ue({},"")}catch{ue=function(ve,xe,Me){return ve[xe]=Me}}function pe(Q,ae,ve,xe){var Me=ae&&ae.prototype instanceof Ce?ae:Ce,Ee=Object.create(Me.prototype),ke=new P(xe||[]);return X(Ee,"_invoke",{value:Tt(Q,ve,ke)}),Ee}function be(Q,ae,ve){try{return{type:"normal",arg:Q.call(ae,ve)}}catch(xe){return{type:"throw",arg:xe}}}ee.wrap=pe;var we={};function Ce(){}function $e(){}function Ne(){}var Ie={};ue(Ie,se,function(){return this});var Ge=Object.getPrototypeOf,nt=Ge&&Ge(Ge(G([])));nt&&nt!==Y&&q.call(nt,se)&&(Ie=nt);var ze=Ne.prototype=Ce.prototype=Object.create(Ie);function Pe(Q){["next","throw","return"].forEach(function(ae){ue(Q,ae,function(ve){return this._invoke(ae,ve)})})}function vt(Q,ae){function ve(Me,Ee,ke,pt){var gt=be(Q[Me],Q,Ee);if(gt.type!=="throw"){var hr=gt.arg,Dn=hr.value;return Dn&&h(Dn)=="object"&&q.call(Dn,"__await")?ae.resolve(Dn.__await).then(function(yn){ve("next",yn,ke,pt)},function(yn){ve("throw",yn,ke,pt)}):ae.resolve(Dn).then(function(yn){hr.value=yn,ke(hr)},function(yn){return ve("throw",yn,ke,pt)})}pt(gt.arg)}var xe;X(this,"_invoke",{value:function(Ee,ke){function pt(){return new ae(function(gt,hr){ve(Ee,ke,gt,hr)})}return xe=xe?xe.then(pt,pt):pt()}})}function Tt(Q,ae,ve){var xe="suspendedStart";return function(Me,Ee){if(xe==="executing")throw new Error("Generator is already running");if(xe==="completed"){if(Me==="throw")throw Ee;return re()}for(ve.method=Me,ve.arg=Ee;;){var ke=ve.delegate;if(ke){var pt=ir(ke,ve);if(pt){if(pt===we)continue;return pt}}if(ve.method==="next")ve.sent=ve._sent=ve.arg;else if(ve.method==="throw"){if(xe==="suspendedStart")throw xe="completed",ve.arg;ve.dispatchException(ve.arg)}else ve.method==="return"&&ve.abrupt("return",ve.arg);xe="executing";var gt=be(Q,ae,ve);if(gt.type==="normal"){if(xe=ve.done?"completed":"suspendedYield",gt.arg===we)continue;return{value:gt.arg,done:ve.done}}gt.type==="throw"&&(xe="completed",ve.method="throw",ve.arg=gt.arg)}}}function ir(Q,ae){var ve=ae.method,xe=Q.iterator[ve];if(xe===void 0)return ae.delegate=null,ve==="throw"&&Q.iterator.return&&(ae.method="return",ae.arg=void 0,ir(Q,ae),ae.method==="throw")||ve!=="return"&&(ae.method="throw",ae.arg=new TypeError("The iterator does not provide a '"+ve+"' method")),we;var Me=be(xe,Q.iterator,ae.arg);if(Me.type==="throw")return ae.method="throw",ae.arg=Me.arg,ae.delegate=null,we;var Ee=Me.arg;return Ee?Ee.done?(ae[Q.resultName]=Ee.value,ae.next=Q.nextLoc,ae.method!=="return"&&(ae.method="next",ae.arg=void 0),ae.delegate=null,we):Ee:(ae.method="throw",ae.arg=new TypeError("iterator result is not an object"),ae.delegate=null,we)}function B(Q){var ae={tryLoc:Q[0]};1 in Q&&(ae.catchLoc=Q[1]),2 in Q&&(ae.finallyLoc=Q[2],ae.afterLoc=Q[3]),this.tryEntries.push(ae)}function M(Q){var ae=Q.completion||{};ae.type="normal",delete ae.arg,Q.completion=ae}function P(Q){this.tryEntries=[{tryLoc:"root"}],Q.forEach(B,this),this.reset(!0)}function G(Q){if(Q){var ae=Q[se];if(ae)return ae.call(Q);if(typeof Q.next=="function")return Q;if(!isNaN(Q.length)){var ve=-1,xe=function Me(){for(;++ve<Q.length;)if(q.call(Q,ve))return Me.value=Q[ve],Me.done=!1,Me;return Me.value=void 0,Me.done=!0,Me};return xe.next=xe}}return{next:re}}function re(){return{value:void 0,done:!0}}return $e.prototype=Ne,X(ze,"constructor",{value:Ne,configurable:!0}),X(Ne,"constructor",{value:$e,configurable:!0}),$e.displayName=ue(Ne,ce,"GeneratorFunction"),ee.isGeneratorFunction=function(Q){var ae=typeof Q=="function"&&Q.constructor;return!!ae&&(ae===$e||(ae.displayName||ae.name)==="GeneratorFunction")},ee.mark=function(Q){return Object.setPrototypeOf?Object.setPrototypeOf(Q,Ne):(Q.__proto__=Ne,ue(Q,ce,"GeneratorFunction")),Q.prototype=Object.create(ze),Q},ee.awrap=function(Q){return{__await:Q}},Pe(vt.prototype),ue(vt.prototype,N,function(){return this}),ee.AsyncIterator=vt,ee.async=function(Q,ae,ve,xe,Me){Me===void 0&&(Me=Promise);var Ee=new vt(pe(Q,ae,ve,xe),Me);return ee.isGeneratorFunction(ae)?Ee:Ee.next().then(function(ke){return ke.done?ke.value:Ee.next()})},Pe(ze),ue(ze,ce,"Generator"),ue(ze,se,function(){return this}),ue(ze,"toString",function(){return"[object Generator]"}),ee.keys=function(Q){var ae=Object(Q),ve=[];for(var xe in ae)ve.push(xe);return ve.reverse(),function Me(){for(;ve.length;){var Ee=ve.pop();if(Ee in ae)return Me.value=Ee,Me.done=!1,Me}return Me.done=!0,Me}},ee.values=G,P.prototype={constructor:P,reset:function(ae){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(M),!ae)for(var ve in this)ve.charAt(0)==="t"&&q.call(this,ve)&&!isNaN(+ve.slice(1))&&(this[ve]=void 0)},stop:function(){this.done=!0;var ae=this.tryEntries[0].completion;if(ae.type==="throw")throw ae.arg;return this.rval},dispatchException:function(ae){if(this.done)throw ae;var ve=this;function xe(hr,Dn){return ke.type="throw",ke.arg=ae,ve.next=hr,Dn&&(ve.method="next",ve.arg=void 0),!!Dn}for(var Me=this.tryEntries.length-1;Me>=0;--Me){var Ee=this.tryEntries[Me],ke=Ee.completion;if(Ee.tryLoc==="root")return xe("end");if(Ee.tryLoc<=this.prev){var pt=q.call(Ee,"catchLoc"),gt=q.call(Ee,"finallyLoc");if(pt&&gt){if(this.prev<Ee.catchLoc)return xe(Ee.catchLoc,!0);if(this.prev<Ee.finallyLoc)return xe(Ee.finallyLoc)}else if(pt){if(this.prev<Ee.catchLoc)return xe(Ee.catchLoc,!0)}else{if(!gt)throw new Error("try statement without catch or finally");if(this.prev<Ee.finallyLoc)return xe(Ee.finallyLoc)}}}},abrupt:function(ae,ve){for(var xe=this.tryEntries.length-1;xe>=0;--xe){var Me=this.tryEntries[xe];if(Me.tryLoc<=this.prev&&q.call(Me,"finallyLoc")&&this.prev<Me.finallyLoc){var Ee=Me;break}}Ee&&(ae==="break"||ae==="continue")&&Ee.tryLoc<=ve&&ve<=Ee.finallyLoc&&(Ee=null);var ke=Ee?Ee.completion:{};return ke.type=ae,ke.arg=ve,Ee?(this.method="next",this.next=Ee.finallyLoc,we):this.complete(ke)},complete:function(ae,ve){if(ae.type==="throw")throw ae.arg;return ae.type==="break"||ae.type==="continue"?this.next=ae.arg:ae.type==="return"?(this.rval=this.arg=ae.arg,this.method="return",this.next="end"):ae.type==="normal"&&ve&&(this.next=ve),we},finish:function(ae){for(var ve=this.tryEntries.length-1;ve>=0;--ve){var xe=this.tryEntries[ve];if(xe.finallyLoc===ae)return this.complete(xe.completion,xe.afterLoc),M(xe),we}},catch:function(ae){for(var ve=this.tryEntries.length-1;ve>=0;--ve){var xe=this.tryEntries[ve];if(xe.tryLoc===ae){var Me=xe.completion;if(Me.type==="throw"){var Ee=Me.arg;M(xe)}return Ee}}throw new Error("illegal catch attempt")},delegateYield:function(ae,ve,xe){return this.delegate={iterator:G(ae),resultName:ve,nextLoc:xe},this.method==="next"&&(this.arg=void 0),we}},ee}function C(ee,Y,q,X,F,se,N){try{var ce=ee[se](N),ue=ce.value}catch(pe){q(pe);return}ce.done?Y(ue):Promise.resolve(ue).then(X,F)}function k(ee){return function(){var Y=this,q=arguments;return new Promise(function(X,F){var se=ee.apply(Y,q);function N(ue){C(se,X,F,N,ce,"next",ue)}function ce(ue){C(se,X,F,N,ce,"throw",ue)}N(void 0)})}}function S(ee,Y){if(!(ee instanceof Y))throw new TypeError("Cannot call a class as a function")}function V(ee,Y){for(var q=0;q<Y.length;q++){var X=Y[q];X.enumerable=X.enumerable||!1,X.configurable=!0,"value"in X&&(X.writable=!0),Object.defineProperty(ee,fe(X.key),X)}}function z(ee,Y,q){return Y&&V(ee.prototype,Y),Object.defineProperty(ee,"prototype",{writable:!1}),ee}function j(ee,Y){if(typeof Y!="function"&&Y!==null)throw new TypeError("Super expression must either be null or a function");ee.prototype=Object.create(Y&&Y.prototype,{constructor:{value:ee,writable:!0,configurable:!0}}),Object.defineProperty(ee,"prototype",{writable:!1}),Y&&J(ee,Y)}function J(ee,Y){return J=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(X,F){return X.__proto__=F,X},J(ee,Y)}function $(ee){var Y=Z();return function(){var X=te(ee),F;if(Y){var se=te(this).constructor;F=Reflect.construct(X,arguments,se)}else F=X.apply(this,arguments);return le(this,F)}}function le(ee,Y){if(Y&&(h(Y)==="object"||typeof Y=="function"))return Y;if(Y!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ie(ee)}function ie(ee){if(ee===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return ee}function Z(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function te(ee){return te=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(q){return q.__proto__||Object.getPrototypeOf(q)},te(ee)}function H(ee,Y,q){return Y=fe(Y),Y in ee?Object.defineProperty(ee,Y,{value:q,enumerable:!0,configurable:!0,writable:!0}):ee[Y]=q,ee}function fe(ee){var Y=ne(ee,"string");return h(Y)==="symbol"?Y:String(Y)}function ne(ee,Y){if(h(ee)!=="object"||ee===null)return ee;var q=ee[Symbol.toPrimitive];if(q!==void 0){var X=q.call(ee,Y);if(h(X)!=="object")return X;throw new TypeError("@@toPrimitive must return a primitive value.")}return(Y==="string"?String:Number)(ee)}function he(ee){var Y,q,X,F=2;for(typeof Symbol<"u"&&(q=Symbol.asyncIterator,X=Symbol.iterator);F--;){if(q&&(Y=ee[q])!=null)return Y.call(ee);if(X&&(Y=ee[X])!=null)return new oe(Y.call(ee));q="@@asyncIterator",X="@@iterator"}throw new TypeError("Object is not async iterable")}function oe(ee){function Y(q){if(Object(q)!==q)return Promise.reject(new TypeError(q+" is not an object."));var X=q.done;return Promise.resolve(q.value).then(function(F){return{value:F,done:X}})}return oe=function(X){this.s=X,this.n=X.next},oe.prototype={s:null,n:null,next:function(){return Y(this.n.apply(this.s,arguments))},return:function(X){var F=this.s.return;return F===void 0?Promise.resolve({value:X,done:!0}):Y(F.apply(this.s,arguments))},throw:function(X){var F=this.s.return;return F===void 0?Promise.reject(X):Y(F.apply(this.s,arguments))}},new oe(ee)}var me=function(ee){j(q,ee);var Y=$(q);function q(X,F,se){var N;if(S(this,q),N=Y.call(this),N.widget=X,N.iframe=F,N.driver=se,H(ie(N),"transport",void 0),H(ie(N),"cachedWidgetVersions",null),H(ie(N),"contentLoadedActionSent",!1),H(ie(N),"allowedCapabilities",new Set),H(ie(N),"allowedEvents",[]),H(ie(N),"isStopped",!1),H(ie(N),"turnServers",null),H(ie(N),"contentLoadedWaitTimer",void 0),H(ie(N),"pushRoomStateTasks",new Set),H(ie(N),"pushRoomStateResult",new Map),H(ie(N),"flushRoomStateTask",null),H(ie(N),"viewedRoomId",null),!(F!=null&&F.contentWindow))throw new Error("No iframe supplied");if(!X)throw new Error("Invalid widget");if(!se)throw new Error("Invalid driver");return N.transport=new e.PostmessageTransport(r.WidgetApiDirection.ToWidget,X.id,F.contentWindow,window),N.transport.targetOrigin=X.origin,N.transport.on("message",N.handleMessage.bind(ie(N))),F.addEventListener("load",N.onIframeLoad.bind(ie(N))),N.transport.start(),N}return z(q,[{key:"hasCapability",value:function(F){return this.allowedCapabilities.has(F)}},{key:"canUseRoomTimeline",value:function(F){return this.hasCapability("org.matrix.msc2762.timeline:".concat(c.Symbols.AnyRoom))||this.hasCapability("org.matrix.msc2762.timeline:".concat(F))}},{key:"canSendRoomEvent",value:function(F){var se=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return this.allowedEvents.some(function(N){return N.matchesAsRoomEvent(o.EventDirection.Send,F,se)})}},{key:"canSendStateEvent",value:function(F,se){return this.allowedEvents.some(function(N){return N.matchesAsStateEvent(o.EventDirection.Send,F,se)})}},{key:"canSendToDeviceEvent",value:function(F){return this.allowedEvents.some(function(se){return se.matchesAsToDeviceEvent(o.EventDirection.Send,F)})}},{key:"canReceiveRoomEvent",value:function(F){var se=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return this.allowedEvents.some(function(N){return N.matchesAsRoomEvent(o.EventDirection.Receive,F,se)})}},{key:"canReceiveStateEvent",value:function(F,se){return this.allowedEvents.some(function(N){return N.matchesAsStateEvent(o.EventDirection.Receive,F,se)})}},{key:"canReceiveToDeviceEvent",value:function(F){return this.allowedEvents.some(function(se){return se.matchesAsToDeviceEvent(o.EventDirection.Receive,F)})}},{key:"canReceiveRoomAccountData",value:function(F){return this.allowedEvents.some(function(se){return se.matchesAsRoomAccountData(o.EventDirection.Receive,F)})}},{key:"stop",value:function(){this.isStopped=!0,this.transport.stop()}},{key:"getWidgetVersions",value:function(){var X=k(I().mark(function se(){var N;return I().wrap(function(ue){for(;;)switch(ue.prev=ue.next){case 0:if(!Array.isArray(this.cachedWidgetVersions)){ue.next=2;break}return ue.abrupt("return",Promise.resolve(this.cachedWidgetVersions));case 2:return ue.prev=2,ue.next=5,this.transport.send(n.WidgetApiToWidgetAction.SupportedApiVersions,{});case 5:return N=ue.sent,this.cachedWidgetVersions=N.supported_versions,ue.abrupt("return",N.supported_versions);case 10:return ue.prev=10,ue.t0=ue.catch(2),console.warn("non-fatal error getting supported widget versions: ",ue.t0),ue.abrupt("return",[]);case 14:case"end":return ue.stop()}},se,this,[[2,10]])}));function F(){return X.apply(this,arguments)}return F}()},{key:"beginCapabilities",value:function(){var F=this;this.emit("preparing");var se;this.transport.send(n.WidgetApiToWidgetAction.Capabilities,{}).then(function(N){return se=N.capabilities,F.driver.validateCapabilities(new Set(N.capabilities))}).then(function(N){F.allowCapabilities(y(N),se),F.emit("ready")}).catch(function(N){F.emit("error:preparing",N)})}},{key:"allowCapabilities",value:function(F,se){var N,ce=this;console.log("Widget ".concat(this.widget.id," is allowed capabilities:"),F);var ue=g(F),pe;try{for(ue.s();!(pe=ue.n()).done;){var be=pe.value;this.allowedCapabilities.add(be)}}catch(Pe){ue.e(Pe)}finally{ue.f()}var we=o.WidgetEventCapability.findEventCapabilities(F);(N=this.allowedEvents).push.apply(N,y(we)),this.transport.send(n.WidgetApiToWidgetAction.NotifyCapabilities,{requested:se,approved:Array.from(this.allowedCapabilities)}).catch(function(Pe){console.warn("non-fatal error notifying widget of approved capabilities:",Pe)}).then(function(){ce.emit("capabilitiesNotified")});var Ce=g(F),$e;try{for(Ce.s();!($e=Ce.n()).done;){var Ne=$e.value;if((0,i.isTimelineCapability)(Ne)){var Ie=(0,i.getTimelineRoomIDFromCapability)(Ne);if(Ie===c.Symbols.AnyRoom){var Ge=g(this.driver.getKnownRooms()),nt;try{for(Ge.s();!(nt=Ge.n()).done;){var ze=nt.value;this.pushRoomState(ze)}}catch(Pe){Ge.e(Pe)}finally{Ge.f()}}else this.pushRoomState(Ie)}}}catch(Pe){Ce.e(Pe)}finally{Ce.f()}we.length>0&&this.viewedRoomId!==null&&!this.canUseRoomTimeline(this.viewedRoomId)&&this.pushRoomState(this.viewedRoomId)}},{key:"onIframeLoad",value:function(F){this.widget.waitForIframeLoad?this.beginCapabilities():(console.log("waitForIframeLoad is false: waiting for widget to send contentLoaded"),this.contentLoadedWaitTimer=setTimeout(function(){console.error("Widget specified waitForIframeLoad=false but timed out waiting for contentLoaded event!")},1e4),this.contentLoadedActionSent=!1)}},{key:"handleContentLoadedAction",value:function(F){if(this.contentLoadedWaitTimer!==void 0&&(clearTimeout(this.contentLoadedWaitTimer),this.contentLoadedWaitTimer=void 0),this.contentLoadedActionSent)throw new Error("Improper sequence: ContentLoaded Action can only be sent once after the widget loaded and should only be used if waitForIframeLoad is false (default=true)");this.widget.waitForIframeLoad?this.transport.reply(F,{error:{message:"Improper sequence: not expecting ContentLoaded event if waitForIframeLoad is true (default=true)"}}):(this.transport.reply(F,{}),this.beginCapabilities()),this.contentLoadedActionSent=!0}},{key:"replyVersions",value:function(F){this.transport.reply(F,{supported_versions:a.CurrentApiVersions})}},{key:"supportsUpdateState",value:function(){var X=k(I().mark(function se(){return I().wrap(function(ce){for(;;)switch(ce.prev=ce.next){case 0:return ce.next=2,this.getWidgetVersions();case 2:return ce.abrupt("return",ce.sent.includes(a.UnstableApiVersion.MSC2762_UPDATE_STATE));case 3:case"end":return ce.stop()}},se,this)}));function F(){return X.apply(this,arguments)}return F}()},{key:"handleCapabilitiesRenegotiate",value:function(F){var se,N=this;this.transport.reply(F,{});var ce=((se=F.data)===null||se===void 0?void 0:se.capabilities)||[],ue=new Set(ce.filter(function(pe){return!N.hasCapability(pe)}));ue.size===0&&this.allowCapabilities([],[]),this.driver.validateCapabilities(ue).then(function(pe){return N.allowCapabilities(y(pe),y(ue))})}},{key:"handleNavigate",value:function(F){var se,N,ce=this;if(!this.hasCapability(i.MatrixCapabilities.MSC2931Navigate))return this.transport.reply(F,{error:{message:"Missing capability"}});if(!((se=F.data)!==null&&se!==void 0&&se.uri)||!((N=F.data)!==null&&N!==void 0&&N.uri.toString().startsWith("https://matrix.to/#")))return this.transport.reply(F,{error:{message:"Invalid matrix.to URI"}});var ue=function(be){console.error("[ClientWidgetApi] Failed to handle navigation: ",be),ce.handleDriverError(be,F,"Error handling navigation")};try{this.driver.navigate(F.data.uri.toString()).catch(function(pe){return ue(pe)}).then(function(){return ce.transport.reply(F,{})})}catch(pe){return ue(pe)}}},{key:"handleOIDC",value:function(F){var se=this,N=1,ce=function(we,Ce){return Ce=Ce||{},N>1?se.transport.send(n.WidgetApiToWidgetAction.OpenIDCredentials,m({state:we,original_request_id:F.requestId},Ce)):se.transport.reply(F,m({state:we},Ce))},ue=function(we){return console.error("[ClientWidgetApi] Failed to handle OIDC: ",we),N>1?ce(s.OpenIDRequestState.Blocked):se.transport.reply(F,{error:{message:we}})},pe=new l.SimpleObservable(function(be){if(be.state===s.OpenIDRequestState.PendingUserConfirmation&&N>1)return pe.close(),ue("client provided out-of-phase response to OIDC flow");if(be.state===s.OpenIDRequestState.PendingUserConfirmation){ce(be.state),N++;return}return be.state===s.OpenIDRequestState.Allowed&&!be.token?ue("client provided invalid OIDC token for an allowed request"):(be.state===s.OpenIDRequestState.Blocked&&(be.token=void 0),pe.close(),ce(be.state,be.token))});this.driver.askOpenID(pe)}},{key:"handleReadRoomAccountData",value:function(F){var se=this,N=Promise.resolve([]);return N=this.driver.readRoomAccountData(F.data.type),this.canReceiveRoomAccountData(F.data.type)?N.then(function(ce){se.transport.reply(F,{events:ce})}):this.transport.reply(F,{error:{message:"Cannot read room account data of this type"}})}},{key:"handleReadEvents",value:function(){var X=k(I().mark(function se(N){var ce=this,ue,pe,be,we,Ce,$e,Ne,Ie,Ge,nt;return I().wrap(function(Pe){for(;;)switch(Pe.prev=Pe.next){case 0:if(N.data.type){Pe.next=2;break}return Pe.abrupt("return",this.transport.reply(N,{error:{message:"Invalid request - missing event type"}}));case 2:if(!(N.data.limit!==void 0&&(!N.data.limit||N.data.limit<0))){Pe.next=4;break}return Pe.abrupt("return",this.transport.reply(N,{error:{message:"Invalid request - limit out of range"}}));case 4:if(N.data.room_ids!==void 0){Pe.next=8;break}ue=this.viewedRoomId===null?[]:[this.viewedRoomId],Pe.next=30;break;case 8:if(N.data.room_ids!==c.Symbols.AnyRoom){Pe.next=12;break}ue=this.driver.getKnownRooms().filter(function(vt){return ce.canUseRoomTimeline(vt)}),Pe.next=30;break;case 12:ue=N.data.room_ids,pe=g(ue),Pe.prev=14,pe.s();case 16:if((be=pe.n()).done){Pe.next=22;break}if(we=be.value,this.canUseRoomTimeline(we)){Pe.next=20;break}return Pe.abrupt("return",this.transport.reply(N,{error:{message:"Unable to access room timeline: ".concat(we)}}));case 20:Pe.next=16;break;case 22:Pe.next=27;break;case 24:Pe.prev=24,Pe.t0=Pe.catch(14),pe.e(Pe.t0);case 27:return Pe.prev=27,pe.f(),Pe.finish(27);case 30:if(Ce=N.data.limit||0,$e=N.data.since,Ne=void 0,Ie=void 0,N.data.state_key===void 0){Pe.next=40;break}if(Ne=N.data.state_key===!0?void 0:N.data.state_key.toString(),this.canReceiveStateEvent(N.data.type,(Ge=Ne)!==null&&Ge!==void 0?Ge:null)){Pe.next=38;break}return Pe.abrupt("return",this.transport.reply(N,{error:{message:"Cannot read state events of this type"}}));case 38:Pe.next=43;break;case 40:if(Ie=N.data.msgtype,this.canReceiveRoomEvent(N.data.type,Ie)){Pe.next=43;break}return Pe.abrupt("return",this.transport.reply(N,{error:{message:"Cannot read room events of this type"}}));case 43:if(!(N.data.room_ids===void 0&&ue.length===0)){Pe.next=50;break}return console.warn("The widgetDriver uses deprecated behaviour:\n It does not set the viewedRoomId using `setViewedRoomId`"),Pe.next=47,N.data.state_key===void 0?this.driver.readRoomEvents(N.data.type,Ie,Ce,null,$e):this.driver.readStateEvents(N.data.type,Ne,Ce,null);case 47:nt=Pe.sent,Pe.next=68;break;case 50:return Pe.next=52,this.supportsUpdateState();case 52:if(!Pe.sent){Pe.next=58;break}return Pe.next=55,Promise.all(ue.map(function(vt){return ce.driver.readRoomTimeline(vt,N.data.type,Ie,Ne,Ce,$e)}));case 55:nt=Pe.sent.flat(1),Pe.next=68;break;case 58:if(N.data.state_key!==void 0){Pe.next=64;break}return Pe.next=61,Promise.all(ue.map(function(vt){return ce.driver.readRoomTimeline(vt,N.data.type,Ie,Ne,Ce,$e)}));case 61:Pe.t1=Pe.sent,Pe.next=67;break;case 64:return Pe.next=66,Promise.all(ue.map(function(vt){return ce.driver.readRoomState(vt,N.data.type,Ne)}));case 66:Pe.t1=Pe.sent;case 67:nt=Pe.t1.flat(1);case 68:this.transport.reply(N,{events:nt});case 69:case"end":return Pe.stop()}},se,this,[[14,24,27,30]])}));function F(se){return X.apply(this,arguments)}return F}()},{key:"handleSendEvent",value:function(F){var se=this;if(!F.data.type)return this.transport.reply(F,{error:{message:"Invalid request - missing event type"}});if(F.data.room_id&&!this.canUseRoomTimeline(F.data.room_id))return this.transport.reply(F,{error:{message:"Unable to access room timeline: ".concat(F.data.room_id)}});var N=F.data.delay!==void 0||F.data.parent_delay_id!==void 0;if(N&&!this.hasCapability(i.MatrixCapabilities.MSC4157SendDelayedEvent))return this.transport.reply(F,{error:{message:"Missing capability"}});var ce;if(F.data.state_key!==void 0){if(!this.canSendStateEvent(F.data.type,F.data.state_key))return this.transport.reply(F,{error:{message:"Cannot send state events of this type"}});if(!N)ce=this.driver.sendEvent(F.data.type,F.data.content||{},F.data.state_key,F.data.room_id);else{var ue,pe;ce=this.driver.sendDelayedEvent((ue=F.data.delay)!==null&&ue!==void 0?ue:null,(pe=F.data.parent_delay_id)!==null&&pe!==void 0?pe:null,F.data.type,F.data.content||{},F.data.state_key,F.data.room_id)}}else{var be=F.data.content||{},we=be.msgtype;if(!this.canSendRoomEvent(F.data.type,we))return this.transport.reply(F,{error:{message:"Cannot send room events of this type"}});if(!N)ce=this.driver.sendEvent(F.data.type,be,null,F.data.room_id);else{var Ce,$e;ce=this.driver.sendDelayedEvent((Ce=F.data.delay)!==null&&Ce!==void 0?Ce:null,($e=F.data.parent_delay_id)!==null&&$e!==void 0?$e:null,F.data.type,be,null,F.data.room_id)}}ce.then(function(Ne){return se.transport.reply(F,m({room_id:Ne.roomId},"eventId"in Ne?{event_id:Ne.eventId}:{delay_id:Ne.delayId}))}).catch(function(Ne){console.error("error sending event: ",Ne),se.handleDriverError(Ne,F,"Error sending event")})}},{key:"handleUpdateDelayedEvent",value:function(F){var se=this;if(!F.data.delay_id)return this.transport.reply(F,{error:{message:"Invalid request - missing delay_id"}});if(!this.hasCapability(i.MatrixCapabilities.MSC4157UpdateDelayedEvent))return this.transport.reply(F,{error:{message:"Missing capability"}});switch(F.data.action){case d.UpdateDelayedEventAction.Cancel:case d.UpdateDelayedEventAction.Restart:case d.UpdateDelayedEventAction.Send:this.driver.updateDelayedEvent(F.data.delay_id,F.data.action).then(function(){return se.transport.reply(F,{})}).catch(function(N){console.error("error updating delayed event: ",N),se.handleDriverError(N,F,"Error updating delayed event")});break;default:return this.transport.reply(F,{error:{message:"Invalid request - unsupported action"}})}}},{key:"handleSendToDevice",value:function(){var X=k(I().mark(function se(N){return I().wrap(function(ue){for(;;)switch(ue.prev=ue.next){case 0:if(N.data.type){ue.next=5;break}return ue.next=3,this.transport.reply(N,{error:{message:"Invalid request - missing event type"}});case 3:ue.next=31;break;case 5:if(N.data.messages){ue.next=10;break}return ue.next=8,this.transport.reply(N,{error:{message:"Invalid request - missing event contents"}});case 8:ue.next=31;break;case 10:if(typeof N.data.encrypted=="boolean"){ue.next=15;break}return ue.next=13,this.transport.reply(N,{error:{message:"Invalid request - missing encryption flag"}});case 13:ue.next=31;break;case 15:if(this.canSendToDeviceEvent(N.data.type)){ue.next=20;break}return ue.next=18,this.transport.reply(N,{error:{message:"Cannot send to-device events of this type"}});case 18:ue.next=31;break;case 20:return ue.prev=20,ue.next=23,this.driver.sendToDevice(N.data.type,N.data.encrypted,N.data.messages);case 23:return ue.next=25,this.transport.reply(N,{});case 25:ue.next=31;break;case 27:ue.prev=27,ue.t0=ue.catch(20),console.error("error sending to-device event",ue.t0),this.handleDriverError(ue.t0,N,"Error sending event");case 31:case"end":return ue.stop()}},se,this,[[20,27]])}));function F(se){return X.apply(this,arguments)}return F}()},{key:"pollTurnServers",value:function(){var X=k(I().mark(function se(N,ce){var ue,pe,be,we,Ce,$e;return I().wrap(function(Ie){for(;;)switch(Ie.prev=Ie.next){case 0:return Ie.prev=0,Ie.next=3,this.transport.send(n.WidgetApiToWidgetAction.UpdateTurnServers,ce);case 3:ue=!1,pe=!1,Ie.prev=5,we=he(N);case 7:return Ie.next=9,we.next();case 9:if(!(ue=!(Ce=Ie.sent).done)){Ie.next=16;break}return $e=Ce.value,Ie.next=13,this.transport.send(n.WidgetApiToWidgetAction.UpdateTurnServers,$e);case 13:ue=!1,Ie.next=7;break;case 16:Ie.next=22;break;case 18:Ie.prev=18,Ie.t0=Ie.catch(5),pe=!0,be=Ie.t0;case 22:if(Ie.prev=22,Ie.prev=23,!(ue&&we.return!=null)){Ie.next=27;break}return Ie.next=27,we.return();case 27:if(Ie.prev=27,!pe){Ie.next=30;break}throw be;case 30:return Ie.finish(27);case 31:return Ie.finish(22);case 32:Ie.next=37;break;case 34:Ie.prev=34,Ie.t1=Ie.catch(0),console.error("error polling for TURN servers",Ie.t1);case 37:case"end":return Ie.stop()}},se,this,[[0,34],[5,18,22,32],[23,,27,31]])}));function F(se,N){return X.apply(this,arguments)}return F}()},{key:"handleWatchTurnServers",value:function(){var X=k(I().mark(function se(N){var ce,ue,pe,be;return I().wrap(function(Ce){for(;;)switch(Ce.prev=Ce.next){case 0:if(this.hasCapability(i.MatrixCapabilities.MSC3846TurnServers)){Ce.next=5;break}return Ce.next=3,this.transport.reply(N,{error:{message:"Missing capability"}});case 3:Ce.next=30;break;case 5:if(!this.turnServers){Ce.next=10;break}return Ce.next=8,this.transport.reply(N,{});case 8:Ce.next=30;break;case 10:return Ce.prev=10,ce=this.driver.getTurnServers(),Ce.next=14,ce.next();case 14:if(ue=Ce.sent,pe=ue.done,be=ue.value,!pe){Ce.next=19;break}throw new Error("Client refuses to provide any TURN servers");case 19:return Ce.next=21,this.transport.reply(N,{});case 21:this.pollTurnServers(ce,be),this.turnServers=ce,Ce.next=30;break;case 25:return Ce.prev=25,Ce.t0=Ce.catch(10),console.error("error getting first TURN server results",Ce.t0),Ce.next=30,this.transport.reply(N,{error:{message:"TURN servers not available"}});case 30:case"end":return Ce.stop()}},se,this,[[10,25]])}));function F(se){return X.apply(this,arguments)}return F}()},{key:"handleUnwatchTurnServers",value:function(){var X=k(I().mark(function se(N){return I().wrap(function(ue){for(;;)switch(ue.prev=ue.next){case 0:if(this.hasCapability(i.MatrixCapabilities.MSC3846TurnServers)){ue.next=5;break}return ue.next=3,this.transport.reply(N,{error:{message:"Missing capability"}});case 3:ue.next=15;break;case 5:if(this.turnServers){ue.next=10;break}return ue.next=8,this.transport.reply(N,{});case 8:ue.next=15;break;case 10:return ue.next=12,this.turnServers.return(void 0);case 12:return this.turnServers=null,ue.next=15,this.transport.reply(N,{});case 15:case"end":return ue.stop()}},se,this)}));function F(se){return X.apply(this,arguments)}return F}()},{key:"handleReadRelations",value:function(){var X=k(I().mark(function se(N){var ce=this,ue,pe;return I().wrap(function(we){for(;;)switch(we.prev=we.next){case 0:if(N.data.event_id){we.next=2;break}return we.abrupt("return",this.transport.reply(N,{error:{message:"Invalid request - missing event ID"}}));case 2:if(!(N.data.limit!==void 0&&N.data.limit<0)){we.next=4;break}return we.abrupt("return",this.transport.reply(N,{error:{message:"Invalid request - limit out of range"}}));case 4:if(!(N.data.room_id!==void 0&&!this.canUseRoomTimeline(N.data.room_id))){we.next=6;break}return we.abrupt("return",this.transport.reply(N,{error:{message:"Unable to access room timeline: ".concat(N.data.room_id)}}));case 6:return we.prev=6,we.next=9,this.driver.readEventRelations(N.data.event_id,N.data.room_id,N.data.rel_type,N.data.event_type,N.data.from,N.data.to,N.data.limit,N.data.direction);case 9:return ue=we.sent,pe=ue.chunk.filter(function(Ce){return Ce.state_key!==void 0?ce.canReceiveStateEvent(Ce.type,Ce.state_key):ce.canReceiveRoomEvent(Ce.type,Ce.content.msgtype)}),we.abrupt("return",this.transport.reply(N,{chunk:pe,prev_batch:ue.prevBatch,next_batch:ue.nextBatch}));case 14:we.prev=14,we.t0=we.catch(6),console.error("error getting the relations",we.t0),this.handleDriverError(we.t0,N,"Unexpected error while reading relations");case 18:case"end":return we.stop()}},se,this,[[6,14]])}));function F(se){return X.apply(this,arguments)}return F}()},{key:"handleUserDirectorySearch",value:function(){var X=k(I().mark(function se(N){var ce;return I().wrap(function(pe){for(;;)switch(pe.prev=pe.next){case 0:if(this.hasCapability(i.MatrixCapabilities.MSC3973UserDirectorySearch)){pe.next=2;break}return pe.abrupt("return",this.transport.reply(N,{error:{message:"Missing capability"}}));case 2:if(typeof N.data.search_term=="string"){pe.next=4;break}return pe.abrupt("return",this.transport.reply(N,{error:{message:"Invalid request - missing search term"}}));case 4:if(!(N.data.limit!==void 0&&N.data.limit<0)){pe.next=6;break}return pe.abrupt("return",this.transport.reply(N,{error:{message:"Invalid request - limit out of range"}}));case 6:return pe.prev=6,pe.next=9,this.driver.searchUserDirectory(N.data.search_term,N.data.limit);case 9:return ce=pe.sent,pe.abrupt("return",this.transport.reply(N,{limited:ce.limited,results:ce.results.map(function(be){return{user_id:be.userId,display_name:be.displayName,avatar_url:be.avatarUrl}})}));case 13:pe.prev=13,pe.t0=pe.catch(6),console.error("error searching in the user directory",pe.t0),this.handleDriverError(pe.t0,N,"Unexpected error while searching in the user directory");case 17:case"end":return pe.stop()}},se,this,[[6,13]])}));function F(se){return X.apply(this,arguments)}return F}()},{key:"handleGetMediaConfig",value:function(){var X=k(I().mark(function se(N){var ce;return I().wrap(function(pe){for(;;)switch(pe.prev=pe.next){case 0:if(this.hasCapability(i.MatrixCapabilities.MSC4039UploadFile)){pe.next=2;break}return pe.abrupt("return",this.transport.reply(N,{error:{message:"Missing capability"}}));case 2:return pe.prev=2,pe.next=5,this.driver.getMediaConfig();case 5:return ce=pe.sent,pe.abrupt("return",this.transport.reply(N,ce));case 9:pe.prev=9,pe.t0=pe.catch(2),console.error("error while getting the media configuration",pe.t0),this.handleDriverError(pe.t0,N,"Unexpected error while getting the media configuration");case 13:case"end":return pe.stop()}},se,this,[[2,9]])}));function F(se){return X.apply(this,arguments)}return F}()},{key:"handleUploadFile",value:function(){var X=k(I().mark(function se(N){var ce;return I().wrap(function(pe){for(;;)switch(pe.prev=pe.next){case 0:if(this.hasCapability(i.MatrixCapabilities.MSC4039UploadFile)){pe.next=2;break}return pe.abrupt("return",this.transport.reply(N,{error:{message:"Missing capability"}}));case 2:return pe.prev=2,pe.next=5,this.driver.uploadFile(N.data.file);case 5:return ce=pe.sent,pe.abrupt("return",this.transport.reply(N,{content_uri:ce.contentUri}));case 9:pe.prev=9,pe.t0=pe.catch(2),console.error("error while uploading a file",pe.t0),this.handleDriverError(pe.t0,N,"Unexpected error while uploading a file");case 13:case"end":return pe.stop()}},se,this,[[2,9]])}));function F(se){return X.apply(this,arguments)}return F}()},{key:"handleDownloadFile",value:function(){var X=k(I().mark(function se(N){var ce;return I().wrap(function(pe){for(;;)switch(pe.prev=pe.next){case 0:if(this.hasCapability(i.MatrixCapabilities.MSC4039DownloadFile)){pe.next=2;break}return pe.abrupt("return",this.transport.reply(N,{error:{message:"Missing capability"}}));case 2:return pe.prev=2,pe.next=5,this.driver.downloadFile(N.data.content_uri);case 5:return ce=pe.sent,pe.abrupt("return",this.transport.reply(N,{file:ce.file}));case 9:pe.prev=9,pe.t0=pe.catch(2),console.error("error while downloading a file",pe.t0),this.handleDriverError(pe.t0,N,"Unexpected error while downloading a file");case 13:case"end":return pe.stop()}},se,this,[[2,9]])}));function F(se){return X.apply(this,arguments)}return F}()},{key:"handleDriverError",value:function(F,se,N){var ce=this.driver.processError(F);this.transport.reply(se,{error:m({message:N},ce)})}},{key:"handleMessage",value:function(F){if(!this.isStopped){var se=new CustomEvent("action:".concat(F.detail.action),{detail:F.detail,cancelable:!0});if(this.emit("action:".concat(F.detail.action),se),!se.defaultPrevented)switch(F.detail.action){case n.WidgetApiFromWidgetAction.ContentLoaded:return this.handleContentLoadedAction(F.detail);case n.WidgetApiFromWidgetAction.SupportedApiVersions:return this.replyVersions(F.detail);case n.WidgetApiFromWidgetAction.SendEvent:return this.handleSendEvent(F.detail);case n.WidgetApiFromWidgetAction.SendToDevice:return this.handleSendToDevice(F.detail);case n.WidgetApiFromWidgetAction.GetOpenIDCredentials:return this.handleOIDC(F.detail);case n.WidgetApiFromWidgetAction.MSC2931Navigate:return this.handleNavigate(F.detail);case n.WidgetApiFromWidgetAction.MSC2974RenegotiateCapabilities:return this.handleCapabilitiesRenegotiate(F.detail);case n.WidgetApiFromWidgetAction.MSC2876ReadEvents:return this.handleReadEvents(F.detail);case n.WidgetApiFromWidgetAction.WatchTurnServers:return this.handleWatchTurnServers(F.detail);case n.WidgetApiFromWidgetAction.UnwatchTurnServers:return this.handleUnwatchTurnServers(F.detail);case n.WidgetApiFromWidgetAction.MSC3869ReadRelations:return this.handleReadRelations(F.detail);case n.WidgetApiFromWidgetAction.MSC3973UserDirectorySearch:return this.handleUserDirectorySearch(F.detail);case n.WidgetApiFromWidgetAction.BeeperReadRoomAccountData:return this.handleReadRoomAccountData(F.detail);case n.WidgetApiFromWidgetAction.MSC4039GetMediaConfigAction:return this.handleGetMediaConfig(F.detail);case n.WidgetApiFromWidgetAction.MSC4039UploadFileAction:return this.handleUploadFile(F.detail);case n.WidgetApiFromWidgetAction.MSC4039DownloadFileAction:return this.handleDownloadFile(F.detail);case n.WidgetApiFromWidgetAction.MSC4157UpdateDelayedEvent:return this.handleUpdateDelayedEvent(F.detail);default:return this.transport.reply(F.detail,{error:{message:"Unknown or unsupported action: "+F.detail.action}})}}}},{key:"updateTheme",value:function(F){return this.transport.send(n.WidgetApiToWidgetAction.ThemeChange,F)}},{key:"updateLanguage",value:function(F){return this.transport.send(n.WidgetApiToWidgetAction.LanguageChange,{lang:F})}},{key:"takeScreenshot",value:function(){return this.transport.send(n.WidgetApiToWidgetAction.TakeScreenshot,{})}},{key:"updateVisibility",value:function(F){return this.transport.send(n.WidgetApiToWidgetAction.UpdateVisibility,{visible:F})}},{key:"sendWidgetConfig",value:function(F){return this.transport.send(n.WidgetApiToWidgetAction.WidgetConfig,F).then()}},{key:"notifyModalWidgetButtonClicked",value:function(F){return this.transport.send(n.WidgetApiToWidgetAction.ButtonClicked,{id:F}).then()}},{key:"notifyModalWidgetClose",value:function(F){return this.transport.send(n.WidgetApiToWidgetAction.CloseModalWidget,F).then()}},{key:"feedEvent",value:function(){var X=k(I().mark(function se(N,ce){var ue;return I().wrap(function(be){for(;;)switch(be.prev=be.next){case 0:if(ce!==void 0&&this.setViewedRoomId(ce),!(N.room_id!==this.viewedRoomId&&!this.canUseRoomTimeline(N.room_id))){be.next=3;break}return be.abrupt("return");case 3:if(!(N.state_key!==void 0&&N.state_key!==null)){be.next=8;break}if(this.canReceiveStateEvent(N.type,N.state_key)){be.next=6;break}return be.abrupt("return");case 6:be.next=10;break;case 8:if(this.canReceiveRoomEvent(N.type,(ue=N.content)===null||ue===void 0?void 0:ue.msgtype)){be.next=10;break}return be.abrupt("return");case 10:return be.next=12,this.transport.send(n.WidgetApiToWidgetAction.SendEvent,N);case 12:case"end":return be.stop()}},se,this)}));function F(se,N){return X.apply(this,arguments)}return F}()},{key:"feedToDevice",value:function(){var X=k(I().mark(function se(N,ce){return I().wrap(function(pe){for(;;)switch(pe.prev=pe.next){case 0:if(!this.canReceiveToDeviceEvent(N.type)){pe.next=3;break}return pe.next=3,this.transport.send(n.WidgetApiToWidgetAction.SendToDevice,m(m({},N),{},{encrypted:ce}));case 3:case"end":return pe.stop()}},se,this)}));function F(se,N){return X.apply(this,arguments)}return F}()},{key:"setViewedRoomId",value:function(F){this.viewedRoomId=F,F!==null&&!this.canUseRoomTimeline(F)&&this.pushRoomState(F)}},{key:"flushRoomState",value:function(){var X=k(I().mark(function se(){var N,ce,ue,pe,be,we,Ce;return I().wrap(function(Ne){for(;;)switch(Ne.prev=Ne.next){case 0:Ne.prev=0;case 1:return Ne.next=3,Promise.all(y(this.pushRoomStateTasks));case 3:if(this.pushRoomStateTasks.size>0){Ne.next=1;break}case 4:N=[],ce=g(this.pushRoomStateResult.values());try{for(ce.s();!(ue=ce.n()).done;){pe=ue.value,be=g(pe.values());try{for(be.s();!(we=be.n()).done;)Ce=we.value,N.push.apply(N,y(Ce.values()))}catch(Ie){be.e(Ie)}finally{be.f()}}}catch(Ie){ce.e(Ie)}finally{ce.f()}return Ne.next=9,this.getWidgetVersions();case 9:if(!Ne.sent.includes(a.UnstableApiVersion.MSC2762_UPDATE_STATE)){Ne.next=12;break}return Ne.next=12,this.transport.send(n.WidgetApiToWidgetAction.UpdateState,{state:N});case 12:return Ne.prev=12,this.flushRoomStateTask=null,Ne.finish(12);case 15:case"end":return Ne.stop()}},se,this,[[0,,12,15]])}));function F(){return X.apply(this,arguments)}return F}()},{key:"pushRoomState",value:function(F){var se=this,N=g(this.allowedEvents),ce;try{var ue=function(){var be=ce.value;if(be.kind===o.EventKind.State&&be.direction===o.EventDirection.Receive){var we,Ce,$e=se.driver.readRoomState(F,be.eventType,(we=be.keyStr)!==null&&we!==void 0?we:void 0),Ne=$e.then(function(Ie){var Ge=g(Ie),nt;try{for(Ge.s();!(nt=Ge.n()).done;){var ze=nt.value,Pe=se.pushRoomStateResult.get(F);Pe===void 0&&(Pe=new Map,se.pushRoomStateResult.set(F,Pe));var vt=Pe.get(be.eventType);vt===void 0&&(vt=new Map,Pe.set(be.eventType,vt)),vt.has(ze.state_key)||vt.set(ze.state_key,ze)}}catch(Tt){Ge.e(Tt)}finally{Ge.f()}},function(Ie){return console.error("Failed to read room state for ".concat(F," (").concat(be.eventType,", ").concat(be.keyStr,")"),Ie)}).then(function(){se.pushRoomStateTasks.delete(Ne)});se.pushRoomStateTasks.add(Ne),(Ce=se.flushRoomStateTask)!==null&&Ce!==void 0||(se.flushRoomStateTask=se.flushRoomState()),se.flushRoomStateTask.catch(function(Ie){return console.error("Failed to push room state",Ie)})}};for(N.s();!(ce=N.n()).done;)ue()}catch(pe){N.e(pe)}finally{N.f()}}},{key:"feedStateUpdate",value:function(){var X=k(I().mark(function se(N){var ce,ue;return I().wrap(function(be){for(;;)switch(be.prev=be.next){case 0:if(N.state_key!==void 0){be.next=2;break}throw new Error("Not a state event");case 2:if(!((N.room_id===this.viewedRoomId||this.canUseRoomTimeline(N.room_id))&&this.canReceiveStateEvent(N.type,N.state_key))){be.next=21;break}if(this.pushRoomStateTasks.size!==0){be.next=11;break}return be.next=6,this.getWidgetVersions();case 6:if(!be.sent.includes(a.UnstableApiVersion.MSC2762_UPDATE_STATE)){be.next=9;break}return be.next=9,this.transport.send(n.WidgetApiToWidgetAction.UpdateState,{state:[N]});case 9:be.next=21;break;case 11:ce=this.pushRoomStateResult.get(N.room_id),ce===void 0&&(ce=new Map,this.pushRoomStateResult.set(N.room_id,ce)),ue=ce.get(N.type),ue===void 0&&(ue=new Map,ce.set(N.type,ue)),ue.has(N.type)||ue.set(N.state_key,N);case 16:return be.next=18,Promise.all(y(this.pushRoomStateTasks));case 18:if(this.pushRoomStateTasks.size>0){be.next=16;break}case 19:return be.next=21,this.flushRoomStateTask;case 21:case"end":return be.stop()}},se,this)}));function F(se){return X.apply(this,arguments)}return F}()}]),q}(t.EventEmitter);return bh.ClientWidgetApi=me,bh}var E3={};Object.defineProperty(E3,"__esModule",{value:!0});E3.isErrorResponse=jve;function uC(t){"@babel/helpers - typeof";return uC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},uC(t)}function jve(t){var e=t.error;return uC(e)==="object"&&e!==null&&"message"in e&&typeof e.message=="string"}var a_={};Object.defineProperty(a_,"__esModule",{value:!0});a_.WidgetKind=void 0;var Vve=function(t){return t.Room="room",t.Account="account",t.Modal="modal",t}({});a_.WidgetKind=Vve;var o_={};Object.defineProperty(o_,"__esModule",{value:!0});o_.ModalButtonKind=void 0;var zve=function(t){return t.Primary="m.primary",t.Secondary="m.secondary",t.Warning="m.warning",t.Danger="m.danger",t.Link="m.link",t}({});o_.ModalButtonKind=zve;var s_={};Object.defineProperty(s_,"__esModule",{value:!0});s_.isValidUrl=Kve;function Kve(t){if(!t)return!1;try{var e=new URL(t);return!(e.protocol!=="http"&&e.protocol!=="https")}catch(r){if(r instanceof TypeError)return!1;throw r}}var l_={};Object.defineProperty(l_,"__esModule",{value:!0});l_.assertPresent=Hve;function Hve(t,e){if(!t[e])throw new Error("".concat(String(e)," is required"))}var _h={},Fk;function dz(){if(Fk)return _h;Fk=1,Object.defineProperty(_h,"__esModule",{value:!0}),_h.Widget=void 0;var t=l_,e=c_();function r(c){"@babel/helpers - typeof";return r=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(d){return typeof d}:function(d){return d&&typeof Symbol=="function"&&d.constructor===Symbol&&d!==Symbol.prototype?"symbol":typeof d},r(c)}function n(c,d){if(!(c instanceof d))throw new TypeError("Cannot call a class as a function")}function i(c,d){for(var h=0;h<d.length;h++){var p=d[h];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(c,o(p.key),p)}}function a(c,d,h){return d&&i(c.prototype,d),Object.defineProperty(c,"prototype",{writable:!1}),c}function o(c){var d=s(c,"string");return r(d)==="symbol"?d:String(d)}function s(c,d){if(r(c)!=="object"||c===null)return c;var h=c[Symbol.toPrimitive];if(h!==void 0){var p=h.call(c,d);if(r(p)!=="object")return p;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(c)}var l=function(){function c(d){if(n(this,c),this.definition=d,!this.definition)throw new Error("Definition is required");(0,t.assertPresent)(d,"id"),(0,t.assertPresent)(d,"creatorUserId"),(0,t.assertPresent)(d,"type"),(0,t.assertPresent)(d,"url")}return a(c,[{key:"creatorUserId",get:function(){return this.definition.creatorUserId}},{key:"type",get:function(){return this.definition.type}},{key:"id",get:function(){return this.definition.id}},{key:"name",get:function(){return this.definition.name||null}},{key:"title",get:function(){return this.rawData.title||null}},{key:"templateUrl",get:function(){return this.definition.url}},{key:"origin",get:function(){return new URL(this.templateUrl).origin}},{key:"waitForIframeLoad",get:function(){return this.definition.waitForIframeLoad===!1?!1:(this.definition.waitForIframeLoad===!0,!0)}},{key:"rawData",get:function(){return this.definition.data||{}}},{key:"getCompleteUrl",value:function(h){return(0,e.runTemplate)(this.templateUrl,this.definition,h)}}]),c}();return _h.Widget=l,_h}var Sh={},jk;function Wve(){if(jk)return Sh;jk=1,Object.defineProperty(Sh,"__esModule",{value:!0}),Sh.WidgetParser=void 0;var t=dz(),e=s_;function r(p){"@babel/helpers - typeof";return r=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(m){return typeof m}:function(m){return m&&typeof Symbol=="function"&&m.constructor===Symbol&&m!==Symbol.prototype?"symbol":typeof m},r(p)}function n(p,m){var g=typeof Symbol<"u"&&p[Symbol.iterator]||p["@@iterator"];if(!g){if(Array.isArray(p)||(g=i(p))||m){g&&(p=g);var y=0,R=function(){};return{s:R,n:function(){return y>=p.length?{done:!0}:{done:!1,value:p[y++]}},e:function(I){throw I},f:R}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var b=!0,_=!1,x;return{s:function(){g=g.call(p)},n:function(){var I=g.next();return b=I.done,I},e:function(I){_=!0,x=I},f:function(){try{!b&&g.return!=null&&g.return()}finally{if(_)throw x}}}}function i(p,m){if(p){if(typeof p=="string")return a(p,m);var g=Object.prototype.toString.call(p).slice(8,-1);if(g==="Object"&&p.constructor&&(g=p.constructor.name),g==="Map"||g==="Set")return Array.from(p);if(g==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(g))return a(p,m)}}function a(p,m){(m==null||m>p.length)&&(m=p.length);for(var g=0,y=new Array(m);g<m;g++)y[g]=p[g];return y}function o(p,m){if(!(p instanceof m))throw new TypeError("Cannot call a class as a function")}function s(p,m){for(var g=0;g<m.length;g++){var y=m[g];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),Object.defineProperty(p,c(y.key),y)}}function l(p,m,g){return g&&s(p,g),Object.defineProperty(p,"prototype",{writable:!1}),p}function c(p){var m=d(p,"string");return r(m)==="symbol"?m:String(m)}function d(p,m){if(r(p)!=="object"||p===null)return p;var g=p[Symbol.toPrimitive];if(g!==void 0){var y=g.call(p,m);if(r(y)!=="object")return y;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(p)}var h=function(){function p(){o(this,p)}return l(p,null,[{key:"parseAccountData",value:function(g){if(!g)return[];for(var y=[],R=0,b=Object.keys(g);R<b.length;R++){var _=b[R],x=g[_];if(x&&!(x.type!=="m.widget"&&x.type!=="im.vector.modular.widgets")&&x.sender){var T=x.state_key||x.id;if(T===_){var I={content:x.content,sender:x.sender,type:"m.widget",state_key:_,event_id:"$example",room_id:"!example",origin_server_ts:1},C=p.parseRoomWidget(I);C&&y.push(C)}}}return y}},{key:"parseWidgetsFromRoomState",value:function(g){if(!g)return[];var y=[],R=n(g),b;try{for(R.s();!(b=R.n()).done;){var _=b.value,x=p.parseRoomWidget(_);x&&y.push(x)}}catch(T){R.e(T)}finally{R.f()}return y}},{key:"parseRoomWidget",value:function(g){if(!g||g.type!=="m.widget"&&g.type!=="im.vector.modular.widgets")return null;var y=g.content||{},R={id:g.state_key,creatorUserId:y.creatorUserId||g.sender,name:y.name,type:y.type,url:y.url,waitForIframeLoad:y.waitForIframeLoad,data:y.data};return p.processEstimatedWidget(R)}},{key:"processEstimatedWidget",value:function(g){return!g.id||!g.creatorUserId||!g.type||!(0,e.isValidUrl)(g.url)?null:new t.Widget(g)}}]),p}();return Sh.WidgetParser=h,Sh}var u_={};Object.defineProperty(u_,"__esModule",{value:!0});u_.runTemplate=Gve;u_.toString=fz;function Gve(t,e,r){for(var n=Object.assign({},e.data,{matrix_room_id:r.widgetRoomId||"",matrix_user_id:r.currentUserId,matrix_display_name:r.userDisplayName||r.currentUserId,matrix_avatar_url:r.userHttpAvatarUrl||"",matrix_widget_id:e.id,"org.matrix.msc2873.client_id":r.clientId||"","org.matrix.msc2873.client_theme":r.clientTheme||"","org.matrix.msc2873.client_language":r.clientLanguage||"","org.matrix.msc3819.matrix_device_id":r.deviceId||"","org.matrix.msc4039.matrix_base_url":r.baseUrl||""}),i=t,a=0,o=Object.keys(n);a<o.length;a++){var s=o[a],l="$".concat(s).replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),c=new RegExp(l,"g");i=i.replace(c,encodeURIComponent(fz(n[s])))}return i}function fz(t){return t==null?"".concat(t):String(t)}var wh={},Vk;function qve(){if(Vk)return wh;Vk=1,Object.defineProperty(wh,"__esModule",{value:!0}),wh.WidgetDriver=void 0;var t=c_();function e(l){"@babel/helpers - typeof";return e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(c){return typeof c}:function(c){return c&&typeof Symbol=="function"&&c.constructor===Symbol&&c!==Symbol.prototype?"symbol":typeof c},e(l)}function r(l,c){if(!(l instanceof c))throw new TypeError("Cannot call a class as a function")}function n(l,c){for(var d=0;d<c.length;d++){var h=c[d];h.enumerable=h.enumerable||!1,h.configurable=!0,"value"in h&&(h.writable=!0),Object.defineProperty(l,a(h.key),h)}}function i(l,c,d){return c&&n(l.prototype,c),Object.defineProperty(l,"prototype",{writable:!1}),l}function a(l){var c=o(l,"string");return e(c)==="symbol"?c:String(c)}function o(l,c){if(e(l)!=="object"||l===null)return l;var d=l[Symbol.toPrimitive];if(d!==void 0){var h=d.call(l,c);if(e(h)!=="object")return h;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(l)}var s=function(){function l(){r(this,l)}return i(l,[{key:"validateCapabilities",value:function(d){return Promise.resolve(new Set)}},{key:"sendEvent",value:function(d,h){return Promise.reject(new Error("Failed to override function"))}},{key:"sendDelayedEvent",value:function(d,h,p,m){return Promise.reject(new Error("Failed to override function"))}},{key:"updateDelayedEvent",value:function(d,h){return Promise.reject(new Error("Failed to override function"))}},{key:"sendToDevice",value:function(d,h,p){return Promise.reject(new Error("Failed to override function"))}},{key:"readRoomAccountData",value:function(d){return Promise.resolve([])}},{key:"readRoomEvents",value:function(d,h,p){return Promise.resolve([])}},{key:"readStateEvents",value:function(d,h,p){return Promise.resolve([])}},{key:"readRoomTimeline",value:function(d,h,p,m,g,y){return m===void 0?this.readRoomEvents(h,p,g,[d],y):this.readStateEvents(h,m,g,[d])}},{key:"readRoomState",value:function(d,h,p){return this.readStateEvents(h,p,Number.MAX_SAFE_INTEGER,[d])}},{key:"readEventRelations",value:function(d,h,p,m,g,y,R,b){return Promise.resolve({chunk:[]})}},{key:"askOpenID",value:function(d){d.update({state:t.OpenIDRequestState.Blocked})}},{key:"navigate",value:function(d){throw new Error("Navigation is not implemented")}},{key:"getTurnServers",value:function(){throw new Error("TURN server support is not implemented")}},{key:"searchUserDirectory",value:function(d,h){return Promise.resolve({limited:!1,results:[]})}},{key:"getMediaConfig",value:function(){throw new Error("Get media config is not implemented")}},{key:"uploadFile",value:function(d){throw new Error("Upload file is not implemented")}},{key:"downloadFile",value:function(d){throw new Error("Download file is not implemented")}},{key:"getKnownRooms",value:function(){throw new Error("Querying known rooms is not implemented")}},{key:"processError",value:function(d){}}]),l}();return wh.WidgetDriver=s,wh}var zk;function c_(){return zk||(zk=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=Cve();Object.keys(e).forEach(function(S){S==="default"||S==="__esModule"||S in t&&t[S]===e[S]||Object.defineProperty(t,S,{enumerable:!0,get:function(){return e[S]}})});var r=Fve();Object.keys(r).forEach(function(S){S==="default"||S==="__esModule"||S in t&&t[S]===r[S]||Object.defineProperty(t,S,{enumerable:!0,get:function(){return r[S]}})});var n=$f;Object.keys(n).forEach(function(S){S==="default"||S==="__esModule"||S in t&&t[S]===n[S]||Object.defineProperty(t,S,{enumerable:!0,get:function(){return n[S]}})});var i=S3();Object.keys(i).forEach(function(S){S==="default"||S==="__esModule"||S in t&&t[S]===i[S]||Object.defineProperty(t,S,{enumerable:!0,get:function(){return i[S]}})});var a=iv;Object.keys(a).forEach(function(S){S==="default"||S==="__esModule"||S in t&&t[S]===a[S]||Object.defineProperty(t,S,{enumerable:!0,get:function(){return a[S]}})});var o=E3;Object.keys(o).forEach(function(S){S==="default"||S==="__esModule"||S in t&&t[S]===o[S]||Object.defineProperty(t,S,{enumerable:!0,get:function(){return o[S]}})});var s=yl;Object.keys(s).forEach(function(S){S==="default"||S==="__esModule"||S in t&&t[S]===s[S]||Object.defineProperty(t,S,{enumerable:!0,get:function(){return s[S]}})});var l=ec;Object.keys(l).forEach(function(S){S==="default"||S==="__esModule"||S in t&&t[S]===l[S]||Object.defineProperty(t,S,{enumerable:!0,get:function(){return l[S]}})});var c=to;Object.keys(c).forEach(function(S){S==="default"||S==="__esModule"||S in t&&t[S]===c[S]||Object.defineProperty(t,S,{enumerable:!0,get:function(){return c[S]}})});var d=ra;Object.keys(d).forEach(function(S){S==="default"||S==="__esModule"||S in t&&t[S]===d[S]||Object.defineProperty(t,S,{enumerable:!0,get:function(){return d[S]}})});var h=Of;Object.keys(h).forEach(function(S){S==="default"||S==="__esModule"||S in t&&t[S]===h[S]||Object.defineProperty(t,S,{enumerable:!0,get:function(){return h[S]}})});var p=a_;Object.keys(p).forEach(function(S){S==="default"||S==="__esModule"||S in t&&t[S]===p[S]||Object.defineProperty(t,S,{enumerable:!0,get:function(){return p[S]}})});var m=o_;Object.keys(m).forEach(function(S){S==="default"||S==="__esModule"||S in t&&t[S]===m[S]||Object.defineProperty(t,S,{enumerable:!0,get:function(){return m[S]}})});var g=av;Object.keys(g).forEach(function(S){S==="default"||S==="__esModule"||S in t&&t[S]===g[S]||Object.defineProperty(t,S,{enumerable:!0,get:function(){return g[S]}})});var y=sv;Object.keys(y).forEach(function(S){S==="default"||S==="__esModule"||S in t&&t[S]===y[S]||Object.defineProperty(t,S,{enumerable:!0,get:function(){return y[S]}})});var R=ro;Object.keys(R).forEach(function(S){S==="default"||S==="__esModule"||S in t&&t[S]===R[S]||Object.defineProperty(t,S,{enumerable:!0,get:function(){return R[S]}})});var b=s_;Object.keys(b).forEach(function(S){S==="default"||S==="__esModule"||S in t&&t[S]===b[S]||Object.defineProperty(t,S,{enumerable:!0,get:function(){return b[S]}})});var _=l_;Object.keys(_).forEach(function(S){S==="default"||S==="__esModule"||S in t&&t[S]===_[S]||Object.defineProperty(t,S,{enumerable:!0,get:function(){return _[S]}})});var x=dz();Object.keys(x).forEach(function(S){S==="default"||S==="__esModule"||S in t&&t[S]===x[S]||Object.defineProperty(t,S,{enumerable:!0,get:function(){return x[S]}})});var T=Wve();Object.keys(T).forEach(function(S){S==="default"||S==="__esModule"||S in t&&t[S]===T[S]||Object.defineProperty(t,S,{enumerable:!0,get:function(){return T[S]}})});var I=u_;Object.keys(I).forEach(function(S){S==="default"||S==="__esModule"||S in t&&t[S]===I[S]||Object.defineProperty(t,S,{enumerable:!0,get:function(){return I[S]}})});var C=ov;Object.keys(C).forEach(function(S){S==="default"||S==="__esModule"||S in t&&t[S]===C[S]||Object.defineProperty(t,S,{enumerable:!0,get:function(){return C[S]}})});var k=qve();Object.keys(k).forEach(function(S){S==="default"||S==="__esModule"||S in t&&t[S]===k[S]||Object.defineProperty(t,S,{enumerable:!0,get:function(){return k[S]}})})}(Nw)),Nw}var Rs=c_();function Kk(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function _g(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Kk(Object(r),!0).forEach(function(n){E(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Kk(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Zve(t){var e,r,n,i=2;for(typeof Symbol<"u"&&(r=Symbol.asyncIterator,n=Symbol.iterator);i--;){if(r&&(e=t[r])!=null)return e.call(t);if(n&&(e=t[n])!=null)return new uy(e.call(t));r="@@asyncIterator",n="@@iterator"}throw new TypeError("Object is not async iterable")}function uy(t){function e(r){if(Object(r)!==r)return Promise.reject(new TypeError(r+" is not an object."));var n=r.done;return Promise.resolve(r.value).then(function(i){return{value:i,done:n}})}return uy=function(n){this.s=n,this.n=n.next},uy.prototype={s:null,n:null,next:function(){return e(this.n.apply(this.s,arguments))},return:function(n){var i=this.s.return;return i===void 0?Promise.resolve({value:n,done:!0}):e(i.apply(this.s,arguments))},throw:function(n){var i=this.s.return;return i===void 0?Promise.reject(n):e(i.apply(this.s,arguments))}},new uy(t)}var cy=function(t){return t.PendingEventsChanged="PendingEvent.pendingEventsChanged",t}({});class hz extends i_{constructor(e,r,n,i,a){var o,s,l,c,d,h,p,m,g,y,R,b,_;super(i),o=this,this.widgetApi=e,this.capabilities=r,this.roomId=n,E(this,"room",void 0),E(this,"widgetApiReady",void 0),E(this,"lifecycle",void 0),E(this,"syncState",null),E(this,"pendingSendingEventsTxId",[]),E(this,"eventEmitter",new nr),E(this,"updateTxId",function(){var I=K(function*(C){if(C.getSender()===o.getUserId()&&o.pendingSendingEventsTxId.some(z=>C.getType()===z.type)){for(var k,S=(k=o.pendingSendingEventsTxId.find(z=>z.id===C.getId()))===null||k===void 0?void 0:k.txId;!S&&o.pendingSendingEventsTxId.length>0;){var V;yield new Promise(z=>o.eventEmitter.once(cy.PendingEventsChanged,()=>z())),S=(V=o.pendingSendingEventsTxId.find(z=>z.id===C.getId()))===null||V===void 0?void 0:V.txId}S&&(C.setTxnId(S),C.setUnsigned(_g(_g({},C.getUnsigned()),{},{transaction_id:S}))),o.pendingSendingEventsTxId=o.pendingSendingEventsTxId.filter(z=>z.id!==C.getId()),o.pendingSendingEventsTxId.length===0&&o.eventEmitter.emit(cy.PendingEventsChanged)}});return function(C){return I.apply(this,arguments)}}()),E(this,"onEvent",function(){var I=K(function*(C){if(C.preventDefault(),C.detail.data.room_id===o.roomId){var k=new Bn(C.detail.data);yield o.updateTxId(k),o.syncApi instanceof lu?yield o.syncApi.injectRoomEvents(o.room,[],void 0,[k]):yield o.syncApi.injectRoomEvents(o.room,[],[k]),o.emit(je.Event,k),o.setSyncState(Lt.Syncing),U.info("Received event ".concat(k.getId()," ").concat(k.getType()," ").concat(k.getStateKey()))}else{var{event_id:S,room_id:V}=C.detail.data;U.info("Received event ".concat(S," for a different room ").concat(V,"; discarding"))}yield o.ack(C)});return function(C){return I.apply(this,arguments)}}()),E(this,"onToDevice",function(){var I=K(function*(C){C.preventDefault();var k=new Bn({type:C.detail.data.type,sender:C.detail.data.sender,content:C.detail.data.content});C.detail.data.encrypted&&k.makeEncrypted(ge.RoomMessageEncrypted,{},"",""),o.emit(je.ToDeviceEvent,k),o.setSyncState(Lt.Syncing),yield o.ack(C)});return function(C){return I.apply(this,arguments)}}());var x=this.widgetApi.transport.send.bind(this.widgetApi.transport);this.widgetApi.transport.send=function(){var I=K(function*(C,k){try{return yield x(C,k)}catch(S){Hk(S)}});return function(C,k){return I.apply(this,arguments)}}();var T=this.widgetApi.transport.sendComplete.bind(this.widgetApi.transport);this.widgetApi.transport.sendComplete=function(){var I=K(function*(C,k){try{return yield T(C,k)}catch(S){Hk(S)}});return function(C,k){return I.apply(this,arguments)}}(),this.widgetApiReady=new Promise(I=>this.widgetApi.once("ready",I)),((s=r.sendEvent)!==null&&s!==void 0&&s.length||(l=r.receiveEvent)!==null&&l!==void 0&&l.length||r.sendMessage===!0||Array.isArray(r.sendMessage)&&r.sendMessage.length||r.receiveMessage===!0||Array.isArray(r.receiveMessage)&&r.receiveMessage.length||(c=r.sendState)!==null&&c!==void 0&&c.length||(d=r.receiveState)!==null&&d!==void 0&&d.length)&&e.requestCapabilityForRoomTimeline(n),(h=r.sendEvent)===null||h===void 0||h.forEach(I=>e.requestCapabilityToSendEvent(I)),(p=r.receiveEvent)===null||p===void 0||p.forEach(I=>e.requestCapabilityToReceiveEvent(I)),r.sendMessage===!0?e.requestCapabilityToSendMessage():Array.isArray(r.sendMessage)&&r.sendMessage.forEach(I=>e.requestCapabilityToSendMessage(I)),r.receiveMessage===!0?e.requestCapabilityToReceiveMessage():Array.isArray(r.receiveMessage)&&r.receiveMessage.forEach(I=>e.requestCapabilityToReceiveMessage(I)),(m=r.sendState)===null||m===void 0||m.forEach(I=>{var{eventType:C,stateKey:k}=I;return e.requestCapabilityToSendState(C,k)}),(g=r.receiveState)===null||g===void 0||g.forEach(I=>{var{eventType:C,stateKey:k}=I;return e.requestCapabilityToReceiveState(C,k)}),(y=r.sendToDevice)===null||y===void 0||y.forEach(I=>e.requestCapabilityToSendToDevice(I)),(R=r.receiveToDevice)===null||R===void 0||R.forEach(I=>e.requestCapabilityToReceiveToDevice(I)),r.sendDelayedEvents&&((b=r.sendEvent)!==null&&b!==void 0&&b.length||r.sendMessage===!0||Array.isArray(r.sendMessage)&&r.sendMessage.length||(_=r.sendState)!==null&&_!==void 0&&_.length)&&e.requestCapability(Rs.MatrixCapabilities.MSC4157SendDelayedEvent),r.updateDelayedEvents&&e.requestCapability(Rs.MatrixCapabilities.MSC4157UpdateDelayedEvent),r.turnServers&&e.requestCapability(Rs.MatrixCapabilities.MSC3846TurnServers),e.on("action:".concat(Rs.WidgetApiToWidgetAction.SendEvent),this.onEvent),e.on("action:".concat(Rs.WidgetApiToWidgetAction.SendToDevice),this.onToDevice),e.start(),a&&e.sendContentLoaded()}startClient(){var e=arguments,r=this;return K(function*(){var n,i,a=e.length>0&&e[0]!==void 0?e[0]:{};r.lifecycle=new AbortController;var o=r.getUserId();o&&r.store.storeUser(new Zo(o)),a.slidingSync?r.syncApi=new FV(a.slidingSync,r,a,r.buildSyncApiOptions()):r.syncApi=new lu(r,a,r.buildSyncApiOptions()),r.room=r.syncApi.createRoom(r.roomId),r.store.storeRoom(r.room),yield r.widgetApiReady,yield Promise.all((n=(i=r.capabilities.receiveState)===null||i===void 0?void 0:i.map(function(){var s=K(function*(l){var{eventType:c,stateKey:d}=l,h=yield r.widgetApi.readStateEvents(c,void 0,d,[r.roomId]),p=h.map(m=>new Bn(m));r.syncApi instanceof lu?yield r.syncApi.injectRoomEvents(r.room,void 0,p):yield r.syncApi.injectRoomEvents(r.room,p),p.forEach(m=>{r.emit(je.Event,m),U.info("Backfilled event ".concat(m.getId()," ").concat(m.getType()," ").concat(m.getStateKey()))})});return function(l){return s.apply(this,arguments)}}()))!==null&&n!==void 0?n:[]),a.clientWellKnownPollPeriod!==void 0&&(r.clientWellKnownIntervalID=setInterval(()=>{r.fetchClientWellKnown()},1e3*a.clientWellKnownPollPeriod),r.fetchClientWellKnown()),r.setSyncState(Lt.Syncing),U.info("Finished backfilling events"),r.matrixRTC.start(),r.capabilities.turnServers&&r.watchTurnServers()})()}stopClient(){this.widgetApi.off("action:".concat(Rs.WidgetApiToWidgetAction.SendEvent),this.onEvent),this.widgetApi.off("action:".concat(Rs.WidgetApiToWidgetAction.SendToDevice),this.onToDevice),super.stopClient(),this.lifecycle.abort()}joinRoom(e){var r=this;return K(function*(){if(e===r.roomId)return r.room;throw new Error("Unknown room: ".concat(e))})()}encryptAndSendEvent(e,r,n){var i=this;return K(function*(){var a=r.event.redacts?_g(_g({},r.getContent()),{},{redacts:r.event.redacts}):r.getContent();if(n){var o=yield i.widgetApi.sendRoomEvent(r.getType(),a,e.roomId,"delay"in n?n.delay:void 0,"parent_delay_id"in n?n.parent_delay_id:void 0).catch(Ba);return i.validateSendDelayedEventResponse(o)}var s=r.getTxnId();s&&i.pendingSendingEventsTxId.push({type:r.getType(),id:void 0,txId:s});var l;try{l=yield i.widgetApi.sendRoomEvent(r.getType(),a,e.roomId).catch(Ba)}catch(c){throw i.updatePendingEventStatus(e,r,Ze.NOT_SENT),c}return e.updatePendingEvent(r,Ze.SENT,l.event_id),i.pendingSendingEventsTxId.forEach(c=>{c.txId===s&&(c.id=l.event_id)}),i.eventEmitter.emit(cy.PendingEventsChanged),{event_id:l.event_id}})()}sendStateEvent(e,r,n){var i=arguments,a=this;return K(function*(){var o=i.length>3&&i[3]!==void 0?i[3]:"",s=yield a.widgetApi.sendStateEvent(r,o,n,e).catch(Ba);if(s.event_id===void 0)throw new Error("'event_id' absent from response to an event request");return{event_id:s.event_id}})()}_unstable_sendDelayedStateEvent(e,r,n,i){var a=arguments,o=this;return K(function*(){var s=a.length>4&&a[4]!==void 0?a[4]:"";if(!(yield o.doesServerSupportUnstableFeature(Ka)))throw new Gs("Server does not support the delayed events API","sendDelayedStateEvent");var l=yield o.widgetApi.sendStateEvent(n,s,i,e,"delay"in r?r.delay:void 0,"parent_delay_id"in r?r.parent_delay_id:void 0).catch(Ba);return o.validateSendDelayedEventResponse(l)})()}validateSendDelayedEventResponse(e){if(e.delay_id===void 0)throw new Error("'delay_id' absent from response to a delayed event request");return{delay_id:e.delay_id}}_unstable_updateDelayedEvent(e,r){var n=this;return K(function*(){if(!(yield n.doesServerSupportUnstableFeature(Ka)))throw new Gs("Server does not support the delayed events API","updateDelayedEvent");return yield n.widgetApi.updateDelayedEvent(e,r).catch(Ba),{}})()}encryptAndSendToDevice(e,r,n){var i=this;return K(function*(){var a=new qo(()=>new Map);for(var{userId:o,deviceId:s}of r)a.getOrCreate(o).set(s,n);yield i.widgetApi.sendToDevice(e,!0,ou(a)).catch(Ba)})()}sendToDevice(e,r){var n=this;return K(function*(){return yield n.widgetApi.sendToDevice(e,!1,ou(r)).catch(Ba),{}})()}getOpenIdToken(){var e=this;return K(function*(){var r=yield e.widgetApi.requestOpenIDConnectToken().catch(Ba);return{access_token:r.access_token,expires_in:r.expires_in,matrix_server_name:r.matrix_server_name,token_type:r.token_type}})()}queueToDevice(e){var r=this;return K(function*(){var{eventType:n,batch:i}=e,a=new qo(()=>new Map);for(var{userId:o,deviceId:s,payload:l}of i)a.getOrCreate(o).set(s,l);yield r.widgetApi.sendToDevice(n,!1,ou(a)).catch(Ba)})()}sendToDeviceViaWidgetApi(e,r,n){var i=this;return K(function*(){yield i.widgetApi.sendToDevice(e,r,ou(n)).catch(Ba)})()}checkTurnServers(){var e=this;return K(function*(){return e.turnServers.length>0})()}getSyncState(){return this.syncState}setSyncState(e){var r=this.syncState;this.syncState=e,this.emit(je.Sync,e,r)}ack(e){var r=this;return K(function*(){yield r.widgetApi.transport.reply(e.detail,{})})()}watchTurnServers(){var e=this;return K(function*(){var r=e.widgetApi.getTurnServers(),n=()=>{r.return(void 0)};e.lifecycle.signal.addEventListener("abort",n);try{var i=!1,a=!1,o;try{for(var s=Zve(r),l;i=!(l=yield s.next()).done;i=!1){var c=l.value;e.turnServers=[{urls:c.uris,username:c.username,credential:c.password}],e.emit(je.TurnServers,e.turnServers),U.log("Received TURN server: ".concat(c.uris))}}catch(d){a=!0,o=d}finally{try{i&&s.return!=null&&(yield s.return())}finally{if(a)throw o}}}catch(d){U.warn("Error watching TURN servers",d)}finally{e.lifecycle.signal.removeEventListener("abort",n)}})()}}function Hk(t){throw t instanceof Rs.WidgetApiResponseError&&t.data.matrix_api_error?ur.fromWidgetApiErrorData(t.data.matrix_api_error):t}function Ba(t){throw t instanceof Error&&t.message==="Request timed out"?new Xu("widget api timeout"):t}class Yve{constructor(){E(this,"unthreadedReadReceipts",new Map),E(this,"threadedReadReceipts",new qo(()=>new Map))}setUnthreaded(e,r){this.unthreadedReadReceipts.set(e,r)}setThreaded(e,r,n){this.threadedReadReceipts.getOrCreate(e).set(r,n)}allUnthreaded(){return this.unthreadedReadReceipts.entries()}*allThreaded(){for(var e of this.threadedReadReceipts.values())for(var r of e.entries())yield r}consumeEphemeralEvents(e){e==null||e.forEach(r=>{r.type!==ge.Receipt||!r.content||Object.keys(r.content).forEach(n=>{Object.entries(r.content[n]).forEach(i=>{var[a,o]=i;if(W4(a))for(var s of Object.keys(o)){var l=r.content[n][a][s],c={data:r.content[n][a][s],type:a,eventId:n};l.thread_id?this.setThreaded(l.thread_id,s,c):this.setUnthreaded(s,c)}})})})}buildAccumulatedReceiptEvent(e){var r={type:ge.Receipt,room_id:e,content:{}},n=new qo(()=>new qo(()=>new Map));for(var[i,a]of this.allUnthreaded())n.getOrCreate(a.eventId).getOrCreate(a.type).set(i,a.data);for(var[o,s]of this.allThreaded())n.getOrCreate(s.eventId).getOrCreate(s.type).set(o,s.data);return r.content=ou(n),n.size>0?r:null}}var Co=function(t){return t.Invite="invite",t.Leave="leave",t.Join="join",t.Knock="knock",t}({});function Jve(t){return"_localTs"in t&&t._localTs!==void 0}class pz{constructor(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.opts=e,E(this,"accountData",{}),E(this,"inviteRooms",{}),E(this,"knockRooms",{}),E(this,"joinRooms",{}),E(this,"nextBatch",null),this.opts.maxTimelineEntries=this.opts.maxTimelineEntries||50}accumulate(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.accumulateRooms(e,r),this.accumulateAccountData(e),this.nextBatch=e.next_batch}accumulateAccountData(e){!e.account_data||!e.account_data.events||e.account_data.events.forEach(r=>{this.accountData[r.type]=r})}accumulateRooms(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;e.rooms&&(e.rooms.invite&&Object.keys(e.rooms.invite).forEach(n=>{this.accumulateRoom(n,Co.Invite,e.rooms.invite[n],r)}),e.rooms.join&&Object.keys(e.rooms.join).forEach(n=>{this.accumulateRoom(n,Co.Join,e.rooms.join[n],r)}),e.rooms.leave&&Object.keys(e.rooms.leave).forEach(n=>{this.accumulateRoom(n,Co.Leave,e.rooms.leave[n],r)}),e.rooms.knock&&Object.keys(e.rooms.knock).forEach(n=>{this.accumulateRoom(n,Co.Knock,e.rooms.knock[n],r)}))}accumulateRoom(e,r,n){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;switch(r){case Co.Invite:this.knockRooms[e]&&delete this.knockRooms[e],this.accumulateInviteState(e,n);break;case Co.Knock:this.accumulateKnockState(e,n);break;case Co.Join:this.inviteRooms[e]&&delete this.inviteRooms[e],this.accumulateJoinState(e,n,i);break;case Co.Leave:this.knockRooms[e]?delete this.knockRooms[e]:this.inviteRooms[e]?delete this.inviteRooms[e]:delete this.joinRooms[e];break;default:U.error("Unknown cateogory: ",r)}}accumulateInviteState(e,r){if(!(!r.invite_state||!r.invite_state.events)){if(!this.inviteRooms[e]){this.inviteRooms[e]={invite_state:r.invite_state};return}var n=this.inviteRooms[e];r.invite_state.events.forEach(i=>{for(var a=!1,o=0;o<n.invite_state.events.length;o++){var s=n.invite_state.events[o];s.type===i.type&&s.state_key==i.state_key&&(n.invite_state.events[o]=i,a=!0)}a||n.invite_state.events.push(i)})}}accumulateKnockState(e,r){if(!(!r.knock_state||!r.knock_state.events)){if(!this.knockRooms[e]){this.knockRooms[e]={knock_state:r.knock_state};return}var n=this.knockRooms[e];r.knock_state.events.forEach(i=>{for(var a=!1,o=0;o<n.knock_state.events.length;o++){var s=n.knock_state.events[o];s.type===i.type&&s.state_key==i.state_key&&(n.knock_state.events[o]=i,a=!0)}a||n.knock_state.events.push(i)})}}accumulateJoinState(e,r){var n,i,a,o,s,l,c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.joinRooms[e]||(this.joinRooms[e]={_currentState:Object.create(null),_timeline:[],_accountData:Object.create(null),_unreadNotifications:{},_unreadThreadNotifications:{},_summary:{},_receipts:new Yve});var d=this.joinRooms[e];if(r.account_data&&r.account_data.events&&r.account_data.events.forEach(I=>{d._accountData[I.type]=I}),r.unread_notifications&&(d._unreadNotifications=r.unread_notifications),d._unreadThreadNotifications=(n=(i=r[im.stable])!==null&&i!==void 0?i:r[im.unstable])!==null&&n!==void 0?n:void 0,r.summary){var h,p,m,g="m.heroes",y="m.invited_member_count",R="m.joined_member_count",b=d._summary,_=r.summary;b[g]=(h=_[g])!==null&&h!==void 0?h:b[g],b[R]=(p=_[R])!==null&&p!==void 0?p:b[R],b[y]=(m=_[y])!==null&&m!==void 0?m:b[y]}if(d._receipts.consumeEphemeralEvents((a=r.ephemeral)===null||a===void 0?void 0:a.events),r.timeline&&r.timeline.limited&&(d._timeline=[]),(o=r.state)===null||o===void 0||(o=o.events)===null||o===void 0||o.forEach(I=>{Sg(d._currentState,I)}),(s=r["org.matrix.msc4222.state_after"])===null||s===void 0||(s=s.events)===null||s===void 0||s.forEach(I=>{Sg(d._currentState,I)}),(l=r.timeline)===null||l===void 0||(l=l.events)===null||l===void 0||l.forEach((I,C)=>{var k;r["org.matrix.msc4222.state_after"]||Sg(d._currentState,I);var S;if(c)S=I;else{var V;S=Object.assign({},I),S.unsigned!==void 0&&(S.unsigned=Object.assign({},S.unsigned));var z=(V=I.unsigned)===null||V===void 0?void 0:V.age;z!==void 0&&(S._localTs=Date.now()-z)}d._timeline.push({event:S,token:C===0&&(k=r.timeline.prev_batch)!==null&&k!==void 0?k:null})}),d._timeline.length>this.opts.maxTimelineEntries){for(var x=d._timeline.length-this.opts.maxTimelineEntries,T=x;T<d._timeline.length;T++)if(d._timeline[T].token){d._timeline=d._timeline.slice(T,d._timeline.length);break}}}getJSON(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,r={join:{},invite:{},knock:{},leave:{}};Object.keys(this.inviteRooms).forEach(i=>{r.invite[i]=this.inviteRooms[i]}),Object.keys(this.knockRooms).forEach(i=>{r.knock[i]=this.knockRooms[i]}),Object.keys(this.joinRooms).forEach(i=>{var a=this.joinRooms[i],o={ephemeral:{events:[]},account_data:{events:[]},state:{events:[]},"org.matrix.msc4222.state_after":{events:[]},timeline:{events:[],prev_batch:null},unread_notifications:a._unreadNotifications,unread_thread_notifications:a._unreadThreadNotifications,summary:a._summary};Object.keys(a._accountData).forEach(p=>{o.account_data.events.push(a._accountData[p])});var s=a._receipts.buildAccumulatedReceiptEvent(i);s&&o.ephemeral.events.push(s),a._timeline.forEach(p=>{if(!o.timeline.prev_batch){if(!p.token)return;o.timeline.prev_batch=p.token}var m;!e&&Jve(p.event)?(m=Object.assign({},p.event),m.unsigned!==void 0&&(m.unsigned=Object.assign({},m.unsigned)),delete m._localTs,m.unsigned=m.unsigned||{},m.unsigned.age=Date.now()-p.event._localTs):m=p.event,o.timeline.events.push(m)});for(var l=Object.create(null),c=o.timeline.events.length-1;c>=0;c--){var d=o.timeline.events[c];if(!(d.state_key===null||d.state_key===void 0)){var h=Ym(d);h.unsigned&&(h.unsigned.prev_content&&(h.content=h.unsigned.prev_content),h.unsigned.prev_sender&&(h.sender=h.unsigned.prev_sender)),Sg(l,h)}}Object.keys(a._currentState).forEach(p=>{Object.keys(a._currentState[p]).forEach(m=>{var g=a._currentState[p][m];o["org.matrix.msc4222.state_after"].events.push(g),l[p]&&l[p][m]&&(g=l[p][m]),o.state.events.push(g)})}),r.join[i]=o});var n=[];return Object.keys(this.accountData).forEach(i=>{n.push(this.accountData[i])}),{nextBatch:this.nextBatch,roomsData:r,accountData:n}}getNextBatchToken(){return this.nextBatch}}function Sg(t,e){e.state_key===null||e.state_key===void 0||!e.type||(t[e.type]||(t[e.type]=Object.create(null)),t[e.type][e.state_key]=e)}var mz=function(t){return t[t.Blocked=-1]="Blocked",t[t.Unverified=0]="Unverified",t[t.Verified=1]="Verified",t}({});class Xve{constructor(e){E(this,"deviceId",void 0),E(this,"userId",void 0),E(this,"algorithms",void 0),E(this,"keys",void 0),E(this,"verified",void 0),E(this,"signatures",void 0),E(this,"displayName",void 0),E(this,"dehydrated",!1),this.deviceId=e.deviceId,this.userId=e.userId,this.algorithms=e.algorithms,this.keys=e.keys,this.verified=e.verified||mz.Unverified,this.signatures=e.signatures||new Map,this.displayName=e.displayName,this.dehydrated=!!e.dehydrated}getFingerprint(){return this.keys.get("ed25519:".concat(this.deviceId))}getIdentityKey(){return this.keys.get("curve25519:".concat(this.deviceId))}}var Wk=function(){},Qve=10;class ege{constructor(e,r){var n,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this.client=e,this.timelineSet=r,E(this,"windowLimit",void 0),E(this,"start",void 0),E(this,"end",void 0),E(this,"eventCount",0),this.windowLimit=i.windowLimit||1e3,(n=r.room)===null||n===void 0||n.on(Ue.Timeline,this.onTimelineEvent.bind(this))}load(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:20,n=i=>{if(!i)throw new Error("No timeline given to initFields");var a,o=i.getEvents();if(!e)a=o.length;else if(a=o.findIndex(c=>c.getId()===e),a<0)throw new Error("getEventTimeline result didn't include requested event");var s=Math.min(o.length,a+Math.ceil(r/2)),l=Math.max(0,s-r);this.start=new cC(i,l-i.getBaseIndex()),this.end=new cC(i,s-i.getBaseIndex()),this.eventCount=s-l};return this.timelineSet.getTimelineForEvent(e)?(n(this.timelineSet.getTimelineForEvent(e)),Promise.resolve()):e?this.client.getEventTimeline(this.timelineSet,e).then(n):(n(this.timelineSet.getLiveTimeline()),Promise.resolve())}getTimelineIndex(e){if(e==Be.BACKWARDS){var r;return(r=this.start)!==null&&r!==void 0?r:null}else if(e==Be.FORWARDS){var n;return(n=this.end)!==null&&n!==void 0?n:null}else throw new Error("Invalid direction '"+e+"'")}extend(e,r){var n=this.getTimelineIndex(e);if(!n)return!1;var i=e==Be.BACKWARDS?n.retreat(r):n.advance(r);if(i){this.eventCount+=i,Wk("TimelineWindow: increased cap by "+i+" (now "+this.eventCount+")");var a=this.eventCount-this.windowLimit;return a>0&&this.unpaginate(a,e!=Be.BACKWARDS),!0}return!1}onTimelineEvent(e,r,n,i){i&&this.onEventRemoved()}onEventRemoved(){var e=this.getEvents();e.length>0&&e[e.length-1]===void 0&&this.end&&this.end.index--}canPaginate(e){var r=this.getTimelineIndex(e);if(!r)return!1;if(e==Be.BACKWARDS){if(r.index>r.minIndex())return!0}else if(r.index<r.maxIndex())return!0;var n=r.timeline.getNeighbouringTimeline(e),i=r.timeline.getPaginationToken(e);return!!n||!!i}paginate(e,r){var n=arguments,i=this;return K(function*(){var a=n.length>2&&n[2]!==void 0?n[2]:!0,o=n.length>3&&n[3]!==void 0?n[3]:Qve,s=i.getTimelineIndex(e);if(!s)return!1;if(s.pendingPaginate)return s.pendingPaginate;if(i.extend(e,r))return!0;if(!a||o===0)return!1;var l=s.timeline.getPaginationToken(e);if(!l)return!1;var c=i.client.paginateEventTimeline(s.timeline,{backwards:e==Be.BACKWARDS,limit:r}).finally(function(){s.pendingPaginate=void 0}).then(d=>d?i.paginate(e,r,!0,o-1):i.paginate(e,r,!1,0));return s.pendingPaginate=c,c})()}unpaginate(e,r){var n=r?this.start:this.end;if(!n)throw new Error("Attempting to unpaginate startOfTimeline=".concat(r," but don't have this direction"));if(e>this.eventCount||e<0)throw new Error("Attemting to unpaginate ".concat(e," events, but only have ").concat(this.eventCount," in the timeline"));for(;e>0;){var i=r?n.advance(e):n.retreat(e);if(i<=0)throw new Error("Unable to unpaginate any further, but still have "+this.eventCount+" events");e-=i,this.eventCount-=i,Wk("TimelineWindow.unpaginate: dropped "+i+" (now "+this.eventCount+")")}}getEvents(){if(!this.start)return[];for(var e=[],r=this.start.timeline;r;){var n,i,a=r.getEvents(),o=0,s=a.length;r===this.start.timeline&&(o=this.start.index+r.getBaseIndex()),r===((n=this.end)===null||n===void 0?void 0:n.timeline)&&(s=this.end.index+r.getBaseIndex());for(var l=o;l<s;l++)e.push(a[l]);if(r===((i=this.end)===null||i===void 0?void 0:i.timeline))break;r=r.getNeighbouringTimeline(Be.FORWARDS)}return e}}class cC{constructor(e,r){this.timeline=e,this.index=r,E(this,"pendingPaginate",void 0)}minIndex(){return this.timeline.getBaseIndex()*-1}maxIndex(){return this.timeline.getEvents().length-this.timeline.getBaseIndex()}advance(e){if(!e)return 0;var r;if(e<0){if(r=Math.max(e,this.minIndex()-this.index),r<0)return this.index+=r,r}else if(r=Math.min(e,this.maxIndex()-this.index),r>0)return this.index+=r,r;var n=this.timeline.getNeighbouringTimeline(e<0?Be.BACKWARDS:Be.FORWARDS);return n?(this.timeline=n,e<0?this.index=this.maxIndex():this.index=this.minIndex(),this.advance(e)):0}retreat(e){return this.advance(e*-1)*-1}}var Eh="m.login.email.identity",Gk="m.login.msisdn",dC=function(t){return t.Password="m.login.password",t.Recaptcha="m.login.recaptcha",t.Terms="m.login.terms",t.Email="m.login.email.identity",t.Msisdn="m.login.msisdn",t.Sso="m.login.sso",t.SsoUnstable="org.matrix.login.sso",t.Dummy="m.login.dummy",t.RegistrationToken="m.login.registration_token",t.UnstableRegistrationToken="org.matrix.msc3231.login.registration_token",t}({});class vz extends Error{constructor(e,r,n){super(e),this.required_stages=r,this.flows=n,E(this,"name","NoAuthFlowFoundError")}}class tge{constructor(e){var r=this;E(this,"matrixClient",void 0),E(this,"inputs",void 0),E(this,"clientSecret",void 0),E(this,"requestCallback",void 0),E(this,"busyChangedCallback",void 0),E(this,"stateUpdatedCallback",void 0),E(this,"requestEmailTokenCallback",void 0),E(this,"supportedStages",void 0),E(this,"data",void 0),E(this,"emailSid",void 0),E(this,"requestingEmailToken",!1),E(this,"attemptAuthDeferred",null),E(this,"chosenFlow",null),E(this,"currentStage",null),E(this,"emailAttempt",1),E(this,"submitPromise",null),E(this,"requestEmailToken",K(function*(){if(r.requestingEmailToken)U.warn("Could not request email token: Already requesting");else{U.trace("Requesting email token. Attempt: "+r.emailAttempt),r.requestingEmailToken=!0;try{var n=yield r.requestEmailTokenCallback(r.inputs.emailAddress,r.clientSecret,r.emailAttempt++,r.data.session);r.emailSid=n.sid,U.trace("Email token request succeeded")}finally{r.requestingEmailToken=!1}}})),this.matrixClient=e.matrixClient,this.data=e.authData||{flows:[]},this.requestCallback=e.doRequest,this.busyChangedCallback=e.busyChanged,this.stateUpdatedCallback=e.stateUpdated||e.startAuthStage,this.requestEmailTokenCallback=e.requestEmailToken,this.inputs=e.inputs||{},e.sessionId&&(this.data.session=e.sessionId),this.clientSecret=e.clientSecret||this.matrixClient.generateClientSecret(),this.emailSid=e.emailSid,e.supportedStages!==void 0&&(this.supportedStages=new Set(e.supportedStages))}attemptAuth(){var e=this;return K(function*(){var r;e.attemptAuthDeferred=ml();var n=e.attemptAuthDeferred.promise;if((r=e.data)!==null&&r!==void 0&&(r=r.flows)!==null&&r!==void 0&&r.length)e.startNextAuthStage();else{var i;(i=e.busyChangedCallback)===null||i===void 0||i.call(e,!0);var a=e.data.session?{session:e.data.session}:null;e.doRequest(a).finally(()=>{var o;(o=e.busyChangedCallback)===null||o===void 0||o.call(e,!1)})}return n})()}poll(){var e=this;return K(function*(){if(e.data.session&&e.attemptAuthDeferred&&!e.submitPromise){var r={};if(e.currentStage==Eh&&e.emailSid){var n={sid:e.emailSid,client_secret:e.clientSecret},i=e.matrixClient.getIdentityServerUrl();i&&(n.id_server=new URL(i).host),r={type:Eh,threepid_creds:n}}e.submitAuthDict(r,!0)}})()}getSessionId(){var e;return(e=this.data)===null||e===void 0?void 0:e.session}getClientSecret(){return this.clientSecret}getStageParams(e){var r;return(r=this.data)===null||r===void 0||(r=r.params)===null||r===void 0?void 0:r[e]}getChosenFlow(){return this.chosenFlow}submitAuthDict(e){var r=arguments,n=this;return K(function*(){var i,a=r.length>1&&r[1]!==void 0?r[1]:!1;if(!n.attemptAuthDeferred)throw new Error("submitAuthDict() called before attemptAuth()");if(!a){var o;(o=n.busyChangedCallback)===null||o===void 0||o.call(n,!0)}for(;n.submitPromise;)try{yield n.submitPromise}catch{}var s;(i=n.data)!==null&&i!==void 0&&i.session?s=Object.assign({session:n.data.session},e):s=e;try{n.submitPromise=n.doRequest(s,a),yield n.submitPromise}finally{if(n.submitPromise=null,!a){var l;(l=n.busyChangedCallback)===null||l===void 0||l.call(n,!1)}}})()}getEmailSid(){return this.emailSid}setEmailSid(e){this.emailSid=e}doRequest(e){var r=arguments,n=this;return K(function*(){var i=r.length>1&&r[1]!==void 0?r[1]:!1;try{var a=yield n.requestCallback(e,i);n.attemptAuthDeferred.resolve(a),n.attemptAuthDeferred=null}catch(g){var o,s,l,c,d=g instanceof ur?g:null,h=(o=d==null||(s=d.data)===null||s===void 0?void 0:s.flows)!==null&&o!==void 0?o:null,p=((l=n.data)===null||l===void 0?void 0:l.flows)||!!h;if(!d||d.httpStatus!==401||!d.data||!p)if(i)U.log("Background poll request failed doing UI auth: ignoring",g);else{var m;(m=n.attemptAuthDeferred)===null||m===void 0||m.reject(g)}d&&!d.data&&(d.data={}),d&&!d.data.flows&&!d.data.completed&&!d.data.session&&(d.data.flows=n.data.flows,d.data.completed=n.data.completed,d.data.session=n.data.session),d&&(n.data=d.data);try{n.startNextAuthStage()}catch(y){n.attemptAuthDeferred.reject(y),n.attemptAuthDeferred=null;return}if(!n.emailSid&&(c=n.chosenFlow)!==null&&c!==void 0&&c.stages.includes(dC.Email))try{yield n.requestEmailToken()}catch(y){n.attemptAuthDeferred.reject(y),n.attemptAuthDeferred=null}}})()}startNextAuthStage(){var e,r,n=this.chooseStage();if(!n)throw new Error("No incomplete flows from the server");if(this.currentStage=n,n===dC.Dummy){this.submitAuthDict({type:"m.login.dummy"});return}if((e=this.data)!==null&&e!==void 0&&e.errcode||(r=this.data)!==null&&r!==void 0&&r.error){var i,a;this.stateUpdatedCallback(n,{errcode:((i=this.data)===null||i===void 0?void 0:i.errcode)||"",error:((a=this.data)===null||a===void 0?void 0:a.error)||""});return}this.stateUpdatedCallback(n,n===Eh?{emailSid:this.emailSid}:{})}chooseStage(){this.chosenFlow===null&&(this.chosenFlow=this.chooseFlow()),U.log("Active flow => %s",JSON.stringify(this.chosenFlow));var e=this.firstUncompletedStage(this.chosenFlow);return U.log("Next stage: %s",e),e}scoreFlow(e){var r=e.stages.length;return this.supportedStages!==void 0&&(r+=e.stages.filter(n=>!this.supportedStages.has(n)).length*10),r}chooseFlow(){var e,r=((e=this.data)===null||e===void 0?void 0:e.flows)||[],n=!!this.inputs.emailAddress||!!this.emailSid,i=!!this.inputs.phoneCountry&&!!this.inputs.phoneNumber;r.sort((d,h)=>this.scoreFlow(d)-this.scoreFlow(h));for(var a of r){var o=!1,s=!1;for(var l of a.stages)l===Eh?o=!0:l==Gk&&(s=!0);if(o==n&&s==i)return a}var c=[];throw n&&c.push(Eh),i&&c.push(Gk),new vz("No appropriate authentication flow found",c,r)}firstUncompletedStage(e){var r,n=((r=this.data)===null||r===void 0?void 0:r.completed)||[];return e.stages.find(i=>!n.includes(i))}}function gz(t,e){return new Promise((r,n)=>{var i=!0,a=t.open(e);a.onupgradeneeded=()=>{i=!1},a.onblocked=()=>n(a.error),a.onsuccess=()=>{var o=a.result;o.close(),i||t.deleteDatabase(e),r(i)},a.onerror=()=>n(a.error)})}var yz=[t=>{t.createObjectStore("users",{keyPath:["userId"]}),t.createObjectStore("accountData",{keyPath:["type"]}),t.createObjectStore("sync",{keyPath:["clobber"]})},t=>{var e=t.createObjectStore("oob_membership_events",{keyPath:["room_id","state_key"]});e.createIndex("room","room_id")},t=>{t.createObjectStore("client_options",{keyPath:["clobber"]})},t=>{t.createObjectStore("to_device_queue",{autoIncrement:!0})}],rge=yz.length;function wg(t,e,r){var n=t.openCursor(e);return new Promise((i,a)=>{var o=[];n.onerror=()=>{var s;a(new Error("Query failed: "+((s=n.error)===null||s===void 0?void 0:s.name)))},n.onsuccess=()=>{var s=n.result;if(!s){i(o);return}o.push(r(s)),s.continue()}})}function Fl(t){return new Promise((e,r)=>{t.oncomplete=function(n){e(n)},t.onerror=function(){r(t.error)}})}function bz(t){return new Promise((e,r)=>{t.onsuccess=function(n){e(n)},t.onerror=function(){r(t.error)}})}function nge(t){return new Promise((e,r)=>{t.onsuccess=()=>e(t),t.onerror=n=>r(n)})}function Uw(t){return bz(t).then(e=>t.result)}class qk{static exists(e,r){return r="matrix-js-sdk:"+(r||"default"),gz(e,r)}constructor(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"default";this.indexedDB=e,E(this,"dbName",void 0),E(this,"syncAccumulator",void 0),E(this,"db",void 0),E(this,"disconnected",!0),E(this,"_isNewlyCreated",!1),E(this,"syncToDatabasePromise",void 0),E(this,"pendingUserPresenceData",[]),this.dbName="matrix-js-sdk:"+r,this.syncAccumulator=new pz}connect(e){var r=this;if(!this.disconnected)return U.log("LocalIndexedDBStoreBackend.connect: already connected or connecting"),Promise.resolve();this.disconnected=!1,U.log("LocalIndexedDBStoreBackend.connect: connecting...");var n=this.indexedDB.open(this.dbName,rge);return n.onupgradeneeded=i=>{var a=n.result,o=i.oldVersion;U.log("LocalIndexedDBStoreBackend.connect: upgrading from ".concat(o)),o<1&&(this._isNewlyCreated=!0),yz.forEach((s,l)=>{o<=l&&s(a)})},n.onblocked=()=>{U.log("can't yet open LocalIndexedDBStoreBackend because it is open elsewhere")},U.log("LocalIndexedDBStoreBackend.connect: awaiting connection..."),bz(n).then(K(function*(){U.log("LocalIndexedDBStoreBackend.connect: connected"),r.db=n.result,r.db.onversionchange=()=>{var i;(i=r.db)===null||i===void 0||i.close(),r.disconnected=!0,r.db=void 0},r.db.onclose=()=>{r.disconnected=!0,r.db=void 0,e==null||e()},yield r.init()}))}isNewlyCreated(){return Promise.resolve(this._isNewlyCreated)}init(){return Promise.all([this.loadAccountData(),this.loadSyncData()]).then(e=>{var[r,n]=e;U.log("LocalIndexedDBStoreBackend: loaded initial data"),this.syncAccumulator.accumulate({next_batch:n.nextBatch,rooms:n.roomsData,account_data:{events:r}},!0)})}getOutOfBandMembers(e){return new Promise((r,n)=>{var i=this.db.transaction(["oob_membership_events"],"readonly"),a=i.objectStore("oob_membership_events"),o=a.index("room"),s=IDBKeyRange.only(e),l=o.openCursor(s),c=[],d=!1;l.onsuccess=()=>{var h=l.result;if(!h)return!c.length&&!d?r(null):r(c);var p=h.value;p.oob_written?d=!0:c.push(p),h.continue()},l.onerror=h=>{n(h)}}).then(r=>(U.log("LL: got ".concat(r==null?void 0:r.length," membershipEvents from storage for room ").concat(e," ...")),r))}setOutOfBandMembers(e,r){var n=this;return K(function*(){U.log("LL: backend about to store ".concat(r.length)+" members for ".concat(e));var i=n.db.transaction(["oob_membership_events"],"readwrite"),a=i.objectStore("oob_membership_events");r.forEach(s=>{a.put(s)});var o={room_id:e,oob_written:!0,state_key:0};a.put(o),yield Fl(i),U.log("LL: backend done storing for ".concat(e,"!"))})()}clearOutOfBandMembers(e){var r=this;return K(function*(){var n=r.db.transaction(["oob_membership_events"],"readonly"),i=n.objectStore("oob_membership_events"),a=i.index("room"),o=IDBKeyRange.only(e),s=Uw(a.openKeyCursor(o,"next")).then(g=>(g==null?void 0:g.primaryKey)[1]),l=Uw(a.openKeyCursor(o,"prev")).then(g=>(g==null?void 0:g.primaryKey)[1]),[c,d]=yield Promise.all([s,l]),h=r.db.transaction(["oob_membership_events"],"readwrite"),p=h.objectStore("oob_membership_events"),m=IDBKeyRange.bound([e,c],[e,d]);U.log("LL: Deleting all users + marker in storage for room ".concat(e,", with key range:"),[e,c],[e,d]),yield nge(p.delete(m))})()}clearDatabase(){return new Promise(e=>{var r;U.log("Removing indexeddb instance: ".concat(this.dbName)),(r=this.db)===null||r===void 0||r.close();var n=this.indexedDB.deleteDatabase(this.dbName);n.onblocked=()=>{U.log("can't yet delete indexeddb ".concat(this.dbName," because it is open elsewhere"))},n.onerror=()=>{var i;U.warn("unable to delete js-sdk store indexeddb: ".concat((i=n.error)===null||i===void 0?void 0:i.name)),e()},n.onsuccess=()=>{U.log("Removed indexeddb instance: ".concat(this.dbName)),e()}})}getSavedSync(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,r=this.syncAccumulator.getJSON();return r.nextBatch?e?Promise.resolve(Ym(r)):Promise.resolve(r):Promise.resolve(null)}getNextBatchToken(){return Promise.resolve(this.syncAccumulator.getNextBatchToken())}setSyncData(e){return Promise.resolve().then(()=>{this.syncAccumulator.accumulate(e)})}syncToDatabase(e){var r=this;return K(function*(){return r.syncToDatabasePromise?(U.warn("Skipping syncToDatabase() as persist already in flight"),r.pendingUserPresenceData.push(...e),r.syncToDatabasePromise):(e.unshift(...r.pendingUserPresenceData),r.syncToDatabasePromise=r.doSyncToDatabase(e),r.syncToDatabasePromise)})()}doSyncToDatabase(e){var r=this;return K(function*(){try{var n=r.syncAccumulator.getJSON(!0);yield Promise.all([r.persistUserPresenceEvents(e),r.persistAccountData(n.accountData),r.persistSyncData(n.nextBatch,n.roomsData)])}finally{r.syncToDatabasePromise=void 0}})()}persistSyncData(e,r){return U.log("Persisting sync data up to",e),yc(()=>{var n=this.db.transaction(["sync"],"readwrite"),i=n.objectStore("sync");return i.put({clobber:"-",nextBatch:e,roomsData:r}),Fl(n).then(()=>{U.log("Persisted sync data up to",e)})})}persistAccountData(e){return yc(()=>{var r=this.db.transaction(["accountData"],"readwrite"),n=r.objectStore("accountData");for(var i of e)n.put(i);return Fl(r).then()})}persistUserPresenceEvents(e){return yc(()=>{var r=this.db.transaction(["users"],"readwrite"),n=r.objectStore("users");for(var i of e)n.put({userId:i[0],event:i[1]});return Fl(r).then()})}getUserPresenceEvents(){return yc(()=>{var e=this.db.transaction(["users"],"readonly"),r=e.objectStore("users");return wg(r,void 0,n=>[n.value.userId,n.value.event])})}loadAccountData(){return U.log("LocalIndexedDBStoreBackend: loading account data..."),yc(()=>{var e=this.db.transaction(["accountData"],"readonly"),r=e.objectStore("accountData");return wg(r,void 0,n=>n.value).then(n=>(U.log("LocalIndexedDBStoreBackend: loaded account data"),n))})}loadSyncData(){return U.log("LocalIndexedDBStoreBackend: loading sync data..."),yc(()=>{var e=this.db.transaction(["sync"],"readonly"),r=e.objectStore("sync");return wg(r,void 0,n=>n.value).then(n=>(U.log("LocalIndexedDBStoreBackend: loaded sync data"),n.length>1&&U.warn("loadSyncData: More than 1 sync row found."),n.length>0?n[0]:{}))})}getClientOptions(){return Promise.resolve().then(()=>{var e=this.db.transaction(["client_options"],"readonly"),r=e.objectStore("client_options");return wg(r,void 0,n=>{var i;return(i=n.value)===null||i===void 0?void 0:i.options}).then(n=>n[0])})}storeClientOptions(e){var r=this;return K(function*(){var n=r.db.transaction(["client_options"],"readwrite"),i=n.objectStore("client_options");i.put({clobber:"-",options:e}),yield Fl(n)})()}saveToDeviceBatches(e){var r=this;return K(function*(){var n=r.db.transaction(["to_device_queue"],"readwrite"),i=n.objectStore("to_device_queue");for(var a of e)i.add(a);yield Fl(n)})()}getOldestToDeviceBatch(){var e=this;return K(function*(){var r=e.db.transaction(["to_device_queue"],"readonly"),n=r.objectStore("to_device_queue"),i=yield Uw(n.openCursor());if(!i)return null;var a=i.value;return{id:i.key,txnId:a.txnId,eventType:a.eventType,batch:a.batch}})()}removeToDeviceBatch(e){var r=this;return K(function*(){var n=r.db.transaction(["to_device_queue"],"readwrite"),i=n.objectStore("to_device_queue");i.delete(e),yield Fl(n)})()}destroy(){var e=this;return K(function*(){var r;(r=e.db)===null||r===void 0||r.close()})()}}class ige{constructor(e,r){this.workerFactory=e,this.dbName=r,E(this,"worker",void 0),E(this,"nextSeq",0),E(this,"inFlight",{}),E(this,"startPromise",void 0),E(this,"onWorkerMessage",n=>{var i=n.data;if(i.command=="closed"){var a;(a=this.onClose)===null||a===void 0||a.call(this)}else if(i.command=="cmd_success"||i.command=="cmd_fail"){if(i.seq===void 0){U.error("Got reply from worker with no seq");return}var o=this.inFlight[i.seq];if(o===void 0){U.error("Got reply for unknown seq "+i.seq);return}if(delete this.inFlight[i.seq],i.command=="cmd_success")o.resolve(i.result);else{var s=new Error(i.error.message);s.name=i.error.name,o.reject(s)}}else U.warn("Unrecognised message from worker: ",i)})}connect(e){return this.onClose=e,this.ensureStarted().then(()=>this.doCmd("connect"))}clearDatabase(){return this.ensureStarted().then(()=>this.doCmd("clearDatabase"))}isNewlyCreated(){return this.doCmd("isNewlyCreated")}getSavedSync(){return this.doCmd("getSavedSync")}getNextBatchToken(){return this.doCmd("getNextBatchToken")}setSyncData(e){return this.doCmd("setSyncData",[e])}syncToDatabase(e){return this.doCmd("syncToDatabase",[e])}getOutOfBandMembers(e){return this.doCmd("getOutOfBandMembers",[e])}setOutOfBandMembers(e,r){return this.doCmd("setOutOfBandMembers",[e,r])}clearOutOfBandMembers(e){return this.doCmd("clearOutOfBandMembers",[e])}getClientOptions(){return this.doCmd("getClientOptions")}storeClientOptions(e){return this.doCmd("storeClientOptions",[e])}getUserPresenceEvents(){return this.doCmd("getUserPresenceEvents")}saveToDeviceBatches(e){var r=this;return K(function*(){return r.doCmd("saveToDeviceBatches",[e])})()}getOldestToDeviceBatch(){var e=this;return K(function*(){return e.doCmd("getOldestToDeviceBatch")})()}removeToDeviceBatch(e){var r=this;return K(function*(){return r.doCmd("removeToDeviceBatch",[e])})()}ensureStarted(){return this.startPromise||(this.worker=this.workerFactory(),this.worker.onmessage=this.onWorkerMessage,this.startPromise=this.doCmd("setupWorker",[this.dbName]).then(()=>{U.log("IndexedDB worker is ready")})),this.startPromise}doCmd(e,r){return Promise.resolve().then(()=>{var n,i=this.nextSeq++,a=ml();return this.inFlight[i]=a,(n=this.worker)===null||n===void 0||n.postMessage({command:e,seq:i,args:r}),a.promise})}destroy(){var e=this;return K(function*(){var r;(r=e.worker)===null||r===void 0||r.terminate()})()}}var age=1e3*60*5;class oge extends _3{static exists(e,r){return qk.exists(e,r)}constructor(e){if(super(e),E(this,"backend",void 0),E(this,"startedUp",!1),E(this,"syncTs",0),E(this,"userModifiedMap",{}),E(this,"emitter",new nr),E(this,"onClose",()=>{this.emitter.emit("closed")}),E(this,"getSavedSync",this.degradable(()=>this.backend.getSavedSync(),"getSavedSync")),E(this,"isNewlyCreated",this.degradable(()=>this.backend.isNewlyCreated(),"isNewlyCreated")),E(this,"getSavedSyncToken",this.degradable(()=>this.backend.getNextBatchToken(),"getSavedSyncToken")),E(this,"deleteAllData",this.degradable(()=>(super.deleteAllData(),this.backend.clearDatabase().then(()=>{U.log("Deleted indexeddb data.")},r=>{throw U.error("Failed to delete indexeddb data: ".concat(r)),r})),null)),E(this,"reallySave",this.degradable(()=>{this.syncTs=Date.now();var r=[];for(var n of this.getUsers())this.userModifiedMap[n.userId]!==n.getLastModifiedTime()&&n.events.presence&&(r.push([n.userId,n.events.presence.event]),this.userModifiedMap[n.userId]=n.getLastModifiedTime());return this.backend.syncToDatabase(r)},null)),E(this,"setSyncData",this.degradable(r=>this.backend.setSyncData(r),"setSyncData")),E(this,"getOutOfBandMembers",this.degradable(r=>this.backend.getOutOfBandMembers(r),"getOutOfBandMembers")),E(this,"setOutOfBandMembers",this.degradable((r,n)=>(super.setOutOfBandMembers(r,n),this.backend.setOutOfBandMembers(r,n)),"setOutOfBandMembers")),E(this,"clearOutOfBandMembers",this.degradable(r=>(super.clearOutOfBandMembers(r),this.backend.clearOutOfBandMembers(r)),"clearOutOfBandMembers")),E(this,"getClientOptions",this.degradable(()=>this.backend.getClientOptions(),"getClientOptions")),E(this,"storeClientOptions",this.degradable(r=>(super.storeClientOptions(r),this.backend.storeClientOptions(r)),"storeClientOptions")),!e.indexedDB)throw new Error("Missing required option: indexedDB");e.workerFactory?this.backend=new ige(e.workerFactory,e.dbName):this.backend=new qk(e.indexedDB,e.dbName)}on(e,r){this.emitter.on(e,r)}startup(){return this.startedUp?(U.log("IndexedDBStore.startup: already started"),Promise.resolve()):(U.log("IndexedDBStore.startup: connecting to backend"),this.backend.connect(this.onClose).then(()=>(U.log("IndexedDBStore.startup: loading presence events"),this.backend.getUserPresenceEvents())).then(e=>{U.log("IndexedDBStore.startup: processing presence events"),e.forEach(r=>{var[n,i]=r;if(!this.createUser)throw new Error("`IndexedDBStore.startup` must be called after assigning it to the client, not before!");var a=this.createUser(n);i&&a.setPresenceEvent(new Bn(i)),this.userModifiedMap[a.userId]=a.getLastModifiedTime(),this.storeUser(a)}),this.startedUp=!0}))}destroy(){return this.backend.destroy()}wantsSave(){var e=Date.now();return e-this.syncTs>age}save(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return e||this.wantsSave()?this.reallySave():Promise.resolve()}degradable(e,r){var n=this,i=r?super[r]:null;return K(function*(){for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];try{return yield e.call(n,...o)}catch(l){U.error("IndexedDBStore failure, degrading to MemoryStore",l),n.emitter.emit("degraded",l);try{U.log("IndexedDBStore trying to delete degraded data"),yield n.backend.clearDatabase(),U.log("IndexedDBStore delete after degrading succeeded")}catch(c){U.warn("IndexedDBStore delete after degrading failed",c)}if(i)return i.call(n,...o)}})}getPendingEvents(e){var r=()=>super.getPendingEvents,n=this;return K(function*(){if(!n.localStorage)return r().call(n,e);var i=n.localStorage.getItem(Fw(e));if(i)try{return JSON.parse(i)}catch(a){U.error("Could not parse persisted pending events",a)}return[]})()}setPendingEvents(e,r){var n=()=>super.setPendingEvents,i=this;return K(function*(){if(!i.localStorage)return n().call(i,e,r);r.length>0?i.localStorage.setItem(Fw(e),JSON.stringify(r)):i.localStorage.removeItem(Fw(e))})()}saveToDeviceBatches(e){return this.backend.saveToDeviceBatches(e)}getOldestToDeviceBatch(){return this.backend.getOldestToDeviceBatch()}removeToDeviceBatch(e){return this.backend.removeToDeviceBatch(e)}}function Fw(t){return"mx_pending_events_".concat(t)}var Ea="crypto.",Zk=Ea+"migration",jw=Ea+"account",sge=Ea+"cross_signing_keys",dy=Ea+"inboundgroupsessions/",lge=Ea+"inboundgroupsessions.withheld/",uge=Ea+"rooms/",Vw=Ea+"sessionsneedingbackup";function Cc(t){return Ea+"sessions/"+t}function zw(t,e){return dy+t+"/"+e}function cge(t,e){return lge+t+"/"+e}function dge(t){return uge+t}class d_ extends zb{static exists(e){for(var r=e.length,n=0;n<r;n++){var i;if((i=e.key(n))!==null&&i!==void 0&&i.startsWith(Ea))return!0}return!1}constructor(e){super(),this.store=e}containsData(){var e=this;return K(function*(){return d_.exists(e.store)})()}getMigrationState(){var e=this;return K(function*(){var r;return(r=Fi(e.store,Zk))!==null&&r!==void 0?r:tf.NOT_STARTED})()}setMigrationState(e){var r=this;return K(function*(){jl(r.store,Zk,e)})()}countEndToEndSessions(e,r){for(var n=0,i=0;i<this.store.length;++i){var a=this.store.key(i);if(a!=null&&a.startsWith(Cc(""))){var o=Fi(this.store,a);n+=Object.keys(o??{}).length}}r(n)}_getEndToEndSessions(e){var r=Fi(this.store,Cc(e)),n={};for(var[i,a]of Object.entries(r||{}))typeof a=="string"?n[i]={session:a}:n[i]=a;return n}getEndToEndSession(e,r,n,i){var a,o=this._getEndToEndSessions(e);i((a=o[r])!==null&&a!==void 0?a:{})}getEndToEndSessions(e,r,n){var i;n((i=this._getEndToEndSessions(e))!==null&&i!==void 0?i:{})}storeEndToEndSession(e,r,n,i){var a=this._getEndToEndSessions(e)||{};a[r]=n,jl(this.store,Cc(e),a)}getEndToEndSessionsBatch(){var e=this;return K(function*(){for(var r=[],n=0;n<e.store.length;++n){var i;if((i=e.store.key(n))!==null&&i!==void 0&&i.startsWith(Cc(""))){var a=e.store.key(n).split("/")[1];for(var o of Object.values(e._getEndToEndSessions(a)))if(r.push(o),r.length>=rf)return r}}return r.length===0?null:r})()}deleteEndToEndSessionsBatch(e){var r=this;return K(function*(){for(var{deviceKey:n,sessionId:i}of e){var a=r._getEndToEndSessions(n)||{};delete a[i],Object.keys(a).length===0?r.store.removeItem(Cc(n)):jl(r.store,Cc(n),a)}})()}getEndToEndInboundGroupSession(e,r,n,i){i(Fi(this.store,zw(e,r)),Fi(this.store,cge(e,r)))}storeEndToEndInboundGroupSession(e,r,n,i){jl(this.store,zw(e,r),n)}countEndToEndInboundGroupSessions(){var e=this;return K(function*(){for(var r=0,n=0;n<e.store.length;++n){var i=e.store.key(n);i!=null&&i.startsWith(dy)&&(r+=1)}return r})()}getEndToEndInboundGroupSessionsBatch(){var e=this;return K(function*(){for(var r=Fi(e.store,Vw)||{},n=[],i=0;i<e.store.length;++i){var a=e.store.key(i);if(a!=null&&a.startsWith(dy)){var o=a.slice(dy.length);if(n.push({senderKey:o.slice(0,43),sessionId:o.slice(44),sessionData:Fi(e.store,a),needsBackup:o in r}),n.length>=rf)return n}}return n.length===0?null:n})()}deleteEndToEndInboundGroupSessionsBatch(e){var r=this;return K(function*(){for(var{senderKey:n,sessionId:i}of e){var a=zw(n,i);r.store.removeItem(a)}})()}getEndToEndRooms(e,r){for(var n={},i=dge(""),a=0;a<this.store.length;++a){var o=this.store.key(a);if(o!=null&&o.startsWith(i)){var s=o.slice(i.length);n[s]=Fi(this.store,o)}}r(n)}markSessionsNeedingBackup(e){var r=Fi(this.store,Vw)||{};for(var n of e)r[n.senderKey+"/"+n.sessionId]=!0;return jl(this.store,Vw,r),Promise.resolve()}deleteAllData(){return this.store.removeItem(jw),Promise.resolve()}getAccount(e,r){var n=Fi(this.store,jw);r(n)}storeAccount(e,r){jl(this.store,jw,r)}getCrossSigningKeys(e,r){var n=Fi(this.store,sge);r(n)}getSecretStorePrivateKey(e,r,n){var i=Fi(this.store,Ea+"ssss_cache.".concat(n));r(i)}storeSecretStorePrivateKey(e,r,n){jl(this.store,Ea+"ssss_cache.".concat(r),n)}doTxn(e,r,n){return Promise.resolve(n(null))}}function Fi(t,e){try{return JSON.parse(t.getItem(e))}catch(r){U.log("Error: Failed to get key %s: %s",e,r.message),U.log(r.stack)}return null}function jl(t,e,r){t.setItem(e,JSON.stringify(r))}class fge{constructor(e){this.db=e,E(this,"nextTxnId",0),e.onversionchange=()=>{U.log("versionchange for indexeddb ".concat(this.db.name,": closing")),e.close()}}containsData(){return K(function*(){throw Error("Not implemented for Backend")})()}startup(){var e=this;return K(function*(){return e})()}deleteAllData(){return K(function*(){throw Error("This is not implemented, call IDBFactory::deleteDatabase(dbName) instead.")})()}getMigrationState(){var e=this;return K(function*(){var r=tf.NOT_STARTED;return yield e.doTxn("readonly",[Dt.STORE_ACCOUNT],n=>{var i=n.objectStore(Dt.STORE_ACCOUNT),a=i.get(sx);a.onsuccess=()=>{var o;r=(o=a.result)!==null&&o!==void 0?o:tf.NOT_STARTED}}),r})()}setMigrationState(e){var r=this;return K(function*(){yield r.doTxn("readwrite",[Dt.STORE_ACCOUNT],n=>{var i=n.objectStore(Dt.STORE_ACCOUNT);i.put(e,sx)})})()}getAccount(e,r){var n=e.objectStore("account"),i=n.get("-");i.onsuccess=function(){try{r(i.result||null)}catch(a){zn(e,a)}}}storeAccount(e,r){var n=e.objectStore("account");n.put(r,"-")}getCrossSigningKeys(e,r){var n=e.objectStore("account"),i=n.get("crossSigningKeys");i.onsuccess=function(){try{r(i.result||null)}catch(a){zn(e,a)}}}getSecretStorePrivateKey(e,r,n){var i=e.objectStore("account"),a=i.get("ssss_cache:".concat(n));a.onsuccess=function(){try{r(a.result||null)}catch(o){zn(e,o)}}}storeSecretStorePrivateKey(e,r,n){var i=e.objectStore("account");i.put(n,"ssss_cache:".concat(r))}countEndToEndSessions(e,r){var n=e.objectStore("sessions"),i=n.count();i.onsuccess=function(){try{r(i.result)}catch(a){zn(e,a)}}}getEndToEndSessions(e,r,n){var i=r.objectStore("sessions"),a=i.index("deviceKey"),o=a.openCursor(e),s={};o.onsuccess=function(){var l=o.result;if(l)s[l.value.sessionId]={session:l.value.session,lastReceivedMessageTs:l.value.lastReceivedMessageTs},l.continue();else try{n(s)}catch(c){zn(r,c)}}}getEndToEndSession(e,r,n,i){var a=n.objectStore("sessions"),o=a.get([e,r]);o.onsuccess=function(){try{o.result?i({session:o.result.session,lastReceivedMessageTs:o.result.lastReceivedMessageTs}):i(null)}catch(s){zn(n,s)}}}storeEndToEndSession(e,r,n,i){var a=i.objectStore("sessions");a.put({deviceKey:e,sessionId:r,session:n.session,lastReceivedMessageTs:n.lastReceivedMessageTs})}getEndToEndSessionsBatch(){var e=this;return K(function*(){var r=[];return yield e.doTxn("readonly",[Dt.STORE_SESSIONS],n=>{var i=n.objectStore(Dt.STORE_SESSIONS),a=i.openCursor();a.onsuccess=function(){try{var o=a.result;o&&(r.push(o.value),r.length<rf&&o.continue())}catch(s){zn(n,s)}}}),r.length===0?null:r})()}deleteEndToEndSessionsBatch(e){var r=this;return K(function*(){yield r.doTxn("readwrite",[Dt.STORE_SESSIONS],function(){var n=K(function*(i){try{var a=i.objectStore(Dt.STORE_SESSIONS),o=function*(){var d=a.delete([s,l]);yield new Promise(h=>{d.onsuccess=h})};for(var{deviceKey:s,sessionId:l}of e)yield*o()}catch(c){zn(i,c)}});return function(i){return n.apply(this,arguments)}}())})()}getEndToEndInboundGroupSession(e,r,n,i){var a=!1,o=!1,s=n.objectStore("inbound_group_sessions"),l=s.get([e,r]);l.onsuccess=function(){try{l.result?a=l.result.session:a=null,o!==!1&&i(a,o)}catch(h){zn(n,h)}};var c=n.objectStore("inbound_group_sessions_withheld"),d=c.get([e,r]);d.onsuccess=function(){try{d.result?o=d.result.session:o=null,a!==!1&&i(a,o)}catch(h){zn(n,h)}}}storeEndToEndInboundGroupSession(e,r,n,i){var a=i.objectStore("inbound_group_sessions");a.put({senderCurve25519Key:e,sessionId:r,session:n})}countEndToEndInboundGroupSessions(){var e=this;return K(function*(){var r=0;return yield e.doTxn("readonly",[Dt.STORE_INBOUND_GROUP_SESSIONS],n=>{var i=n.objectStore(Dt.STORE_INBOUND_GROUP_SESSIONS),a=i.count();a.onsuccess=()=>{r=a.result}}),r})()}getEndToEndInboundGroupSessionsBatch(){var e=this;return K(function*(){var r=[];return yield e.doTxn("readonly",[Dt.STORE_INBOUND_GROUP_SESSIONS,Dt.STORE_BACKUP],n=>{var i=n.objectStore(Dt.STORE_INBOUND_GROUP_SESSIONS),a=n.objectStore(Dt.STORE_BACKUP),o=i.openCursor();o.onsuccess=function(){try{var s=o.result;if(s){var l=a.get(s.key);l.onsuccess=()=>{r.push({senderKey:s.value.senderCurve25519Key,sessionId:s.value.sessionId,sessionData:s.value.session,needsBackup:l.result!==void 0}),r.length<rf&&s.continue()}}}catch(c){zn(n,c)}}}),r.length===0?null:r})()}deleteEndToEndInboundGroupSessionsBatch(e){var r=this;return K(function*(){yield r.doTxn("readwrite",[Dt.STORE_INBOUND_GROUP_SESSIONS],function(){var n=K(function*(i){try{var a=i.objectStore(Dt.STORE_INBOUND_GROUP_SESSIONS),o=function*(){var d=a.delete([s,l]);yield new Promise(h=>{d.onsuccess=h})};for(var{senderKey:s,sessionId:l}of e)yield*o()}catch(c){zn(i,c)}});return function(i){return n.apply(this,arguments)}}())})()}getEndToEndDeviceData(e,r){var n=e.objectStore("device_data"),i=n.get("-");i.onsuccess=function(){try{r(i.result||null)}catch(a){zn(e,a)}}}getEndToEndRooms(e,r){var n={},i=e.objectStore("rooms"),a=i.openCursor();a.onsuccess=function(){var o=a.result;if(o)n[o.key]=o.value,o.continue();else try{r(n)}catch(s){zn(e,s)}}}markSessionsNeedingBackup(e,r){var n=this;return K(function*(){r||(r=n.db.transaction("sessions_needing_backup","readwrite"));var i=r.objectStore("sessions_needing_backup");yield Promise.all(e.map(a=>new Promise((o,s)=>{var l=i.put({senderCurve25519Key:a.senderKey,sessionId:a.sessionId});l.onsuccess=o,l.onerror=s})))})()}doTxn(e,r,n){var i=this.db.transaction(r,e),a=mge(i),o=n(i);return a.then(()=>o)}}var _z=[t=>{pge(t)},t=>{t.createObjectStore("account")},t=>{var e=t.createObjectStore("sessions",{keyPath:["deviceKey","sessionId"]});e.createIndex("deviceKey","deviceKey")},t=>{t.createObjectStore("inbound_group_sessions",{keyPath:["senderCurve25519Key","sessionId"]})},t=>{t.createObjectStore("device_data")},t=>{t.createObjectStore("rooms")},t=>{t.createObjectStore("sessions_needing_backup",{keyPath:["senderCurve25519Key","sessionId"]})},t=>{t.createObjectStore("inbound_group_sessions_withheld",{keyPath:["senderCurve25519Key","sessionId"]})},t=>{var e=t.createObjectStore("session_problems",{keyPath:["deviceKey","time"]});e.createIndex("deviceKey","deviceKey"),t.createObjectStore("notified_error_devices",{keyPath:["userId","deviceId"]})},t=>{t.createObjectStore("shared_history_inbound_group_sessions",{keyPath:["roomId"]})},t=>{t.createObjectStore("parked_shared_history",{keyPath:["roomId"]})}],Sz=_z.length;function hge(t,e){U.log("Upgrading IndexedDBCryptoStore from version ".concat(e)+" to ".concat(Sz)),_z.forEach((r,n)=>{e<=n&&r(t)})}function pge(t){var e=t.createObjectStore("outgoingRoomKeyRequests",{keyPath:"requestId"});e.createIndex("session",["requestBody.room_id","requestBody.session_id"]),e.createIndex("state","state")}function zn(t,e){t._mx_abortexception=e;try{t.abort()}catch{}}function mge(t){return new Promise((e,r)=>{t.oncomplete=()=>{t._mx_abortexception!==void 0&&r(t._mx_abortexception),e(null)},t.onerror=n=>{t._mx_abortexception!==void 0?r(t._mx_abortexception):(U.log("Error performing indexeddb txn",n),r(t.error))},t.onabort=n=>{t._mx_abortexception!==void 0?r(t._mx_abortexception):(U.log("Error performing indexeddb txn",n),r(t.error))}})}class Dt{static exists(e,r){return gz(e,r)}static existsAndIsNotMigrated(e,r){return new Promise((n,i)=>{var a=!0,o=e.open(r);o.onupgradeneeded=()=>{a=!1},o.onblocked=()=>i(o.error),o.onsuccess=()=>{var s=o.result;if(!a)s.close(),e.deleteDatabase(r),n(!1);else{var l=s.transaction([Dt.STORE_ACCOUNT],"readonly"),c=l.objectStore(Dt.STORE_ACCOUNT),d=c.get(sx);d.onsuccess=()=>{var h,p=(h=d.result)!==null&&h!==void 0?h:tf.NOT_STARTED;n(p===tf.NOT_STARTED)},d.onerror=()=>{i(d.error)},s.close()}},o.onerror=()=>i(o.error)})}constructor(e,r){this.indexedDB=e,this.dbName=r,E(this,"backendPromise",void 0),E(this,"backend",void 0)}containsData(){var e=this;return K(function*(){return Dt.exists(e.indexedDB,e.dbName)})()}startup(){return this.backendPromise?this.backendPromise:(this.backendPromise=new Promise((e,r)=>{if(!this.indexedDB){r(new Error("no indexeddb support available"));return}U.log("connecting to indexeddb ".concat(this.dbName));var n=this.indexedDB.open(this.dbName,Sz);n.onupgradeneeded=i=>{var a=n.result,o=i.oldVersion;hge(a,o)},n.onblocked=()=>{U.log("can't yet open IndexedDBCryptoStore because it is open elsewhere")},n.onerror=i=>{U.log("Error connecting to indexeddb",i),r(n.error)},n.onsuccess=()=>{var i=n.result;U.log("connected to indexeddb ".concat(this.dbName)),e(new fge(i))}}).then(e=>e.doTxn("readonly",[Dt.STORE_INBOUND_GROUP_SESSIONS,Dt.STORE_INBOUND_GROUP_SESSIONS_WITHHELD],r=>{e.getEndToEndInboundGroupSession("","",r,()=>{})}).then(()=>e)).catch(e=>{if(e.name==="VersionError")throw U.warn("Crypto DB is too new for us to use!",e),new f3(d3.TooNew);U.warn("unable to connect to indexeddb ".concat(this.dbName)+": falling back to localStorage store: ".concat(e));try{if(!(globalThis.localStorage instanceof Storage))throw new Error("localStorage is not available");return new d_(globalThis.localStorage)}catch(r){return U.warn("Unable to open localStorage: falling back to in-memory store: ".concat(r)),new zb}}).then(e=>(this.backend=e,e)),this.backendPromise)}deleteAllData(){return new Promise((e,r)=>{if(!this.indexedDB){r(new Error("no indexeddb support available"));return}U.log("Removing indexeddb instance: ".concat(this.dbName));var n=this.indexedDB.deleteDatabase(this.dbName);n.onblocked=()=>{U.log("can't yet delete IndexedDBCryptoStore because it is open elsewhere")},n.onerror=i=>{U.log("Error deleting data from indexeddb",i),r(n.error)},n.onsuccess=()=>{U.log("Removed indexeddb instance: ".concat(this.dbName)),e()}}).catch(e=>{U.warn("unable to delete IndexedDBCryptoStore: ".concat(e))})}getMigrationState(){return this.backend.getMigrationState()}setMigrationState(e){return this.backend.setMigrationState(e)}getAccount(e,r){this.backend.getAccount(e,r)}storeAccount(e,r){this.backend.storeAccount(e,r)}getCrossSigningKeys(e,r){this.backend.getCrossSigningKeys(e,r)}getSecretStorePrivateKey(e,r,n){this.backend.getSecretStorePrivateKey(e,r,n)}storeSecretStorePrivateKey(e,r,n){this.backend.storeSecretStorePrivateKey(e,r,n)}countEndToEndSessions(e,r){this.backend.countEndToEndSessions(e,r)}getEndToEndSession(e,r,n,i){this.backend.getEndToEndSession(e,r,n,i)}getEndToEndSessions(e,r,n){this.backend.getEndToEndSessions(e,r,n)}storeEndToEndSession(e,r,n,i){this.backend.storeEndToEndSession(e,r,n,i)}countEndToEndInboundGroupSessions(){return this.backend.countEndToEndInboundGroupSessions()}getEndToEndSessionsBatch(){return this.backend.getEndToEndSessionsBatch()}deleteEndToEndSessionsBatch(e){return this.backend.deleteEndToEndSessionsBatch(e)}getEndToEndInboundGroupSession(e,r,n,i){this.backend.getEndToEndInboundGroupSession(e,r,n,i)}storeEndToEndInboundGroupSession(e,r,n,i){this.backend.storeEndToEndInboundGroupSession(e,r,n,i)}getEndToEndInboundGroupSessionsBatch(){return this.backend.getEndToEndInboundGroupSessionsBatch()}deleteEndToEndInboundGroupSessionsBatch(e){return this.backend.deleteEndToEndInboundGroupSessionsBatch(e)}getEndToEndRooms(e,r){this.backend.getEndToEndRooms(e,r)}markSessionsNeedingBackup(e,r){return this.backend.markSessionsNeedingBackup(e,r)}doTxn(e,r,n,i){return this.backend.doTxn(e,r,n,i)}}E(Dt,"STORE_ACCOUNT","account");E(Dt,"STORE_SESSIONS","sessions");E(Dt,"STORE_INBOUND_GROUP_SESSIONS","inbound_group_sessions");E(Dt,"STORE_INBOUND_GROUP_SESSIONS_WITHHELD","inbound_group_sessions_withheld");E(Dt,"STORE_SHARED_HISTORY_INBOUND_GROUP_SESSIONS","shared_history_inbound_group_sessions");E(Dt,"STORE_PARKED_SHARED_HISTORY","parked_shared_history");E(Dt,"STORE_DEVICE_DATA","device_data");E(Dt,"STORE_ROOMS","rooms");E(Dt,"STORE_BACKUP","sessions_needing_backup");var vge=function(t){return t.Email="email",t.Phone="msisdn",t}({}),gge=new Rr("delegated_oidc_compatibility","org.matrix.msc3824.delegated_oidc_compatibility"),yge=function(t){return t.Gitlab="gitlab",t.Github="github",t.Apple="apple",t.Google="google",t.Facebook="facebook",t.Twitter="twitter",t}({}),bge=function(t){return t.LOGIN="login",t.REGISTER="register",t}({}),_ge="us.cloke.msc4175.tz";class Sge{constructor(e){E(this,"relations",void 0),this.relations=e.filter(r=>!!r)}getRelations(){return this.relations.reduce((e,r)=>[...e,...r.getRelations()],[])}on(e,r){this.relations.forEach(n=>n.on(e,r))}off(e,r){this.relations.forEach(n=>n.off(e,r))}}var wge=function(t){return t.Global="Global",t.SetItemError="setItem",t.GetItemError="getItem",t.RemoveItemError="removeItem",t.ClearError="clear",t.QuotaExceededError="QuotaExceededError",t}({});class Ege extends nr{}var xge=new Ege,wz=()=>new zb;function Ez(t){wz=t}function xz(t){var e,r,n;return t.store=(e=t.store)!==null&&e!==void 0?e:new _3({localStorage:globalThis.localStorage}),t.scheduler=(r=t.scheduler)!==null&&r!==void 0?r:new nf,t.cryptoStore=(n=t.cryptoStore)!==null&&n!==void 0?n:wz(),t}function fC(t){return new i_(xz(t))}function Cge(t,e,r,n){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0;return new hz(t,e,r,xz(n),i)}const Tge=Object.freeze(Object.defineProperty({__proto__:null,AuthType:dC,AutoDiscovery:tt,AutoDiscoveryAction:gi,AutoDiscoveryError:ua,Beacon:dV,BeaconEvent:er,CallEvent:ut,CallFeedEvent:Ua,Category:Co,ClientEvent:je,ClientPrefix:Ur,ClientStoppedError:yme,ConditionKind:Ar,ConditionOperator:Upe,ConnectionError:Xu,ContentHelpers:uhe,DELEGATED_OIDC_COMPATIBILITY:gge,DEVICE_CODE_SCOPE:Qme,DMMemberCountCondition:Fpe,Device:Xve,DeviceVerification:mz,Direction:st,DuplicateStrategy:fp,EVENT_VISIBILITY_CHANGE_TYPE:su,EventEmitterEvents:kj,EventStatus:Ze,EventTimeline:Be,EventTimelineSet:Qc,EventType:ge,FILTER_RELATED_BY_REL_TYPES:Md,FILTER_RELATED_BY_SENDERS:Rd,FeatureSupport:_n,Filter:Yn,GET_LOGIN_TOKEN_CAPABILITY:ave,GroupCall:n3,GroupCallEvent:Kt,GroupCallIntent:LV,GroupCallState:vr,GroupCallStatsReportEvent:Nh,GroupCallType:e_,GuestAccess:B0,HTTPError:gl,HistoryVisibility:s3,HttpApiEvent:Bx,IdentityPrefix:xo,IdentityProviderBrand:yge,IndexedDBCryptoStore:Dt,IndexedDBStore:oge,InteractiveAuth:tge,InvalidCryptoStoreError:f3,InvalidCryptoStoreState:d3,JoinRule:NV,KNOWN_SAFE_ROOM_VERSION:xV,KeySignatureUploadError:gme,KnownMembership:ct,LOCAL_NOTIFICATION_SETTINGS_PREFIX:Bj,LocalStorageCryptoStore:d_,LocalStorageErrors:wge,LocationAssetType:Qd,MAIN_ROOM_TIMELINE:Zm,MAXIMUM_MATRIX_VERSION:Gpe,MINIMUM_MATRIX_VERSION:Wpe,MSC3912_RELATION_BASED_REDACTIONS_PROP:fx,M_ASSET:Gm,M_BEACON:Zx,M_BEACON_INFO:l3,M_HTML:rhe,M_LOCATION:qm,M_MESSAGE:the,M_POLL_END:$0,M_POLL_KIND_DISCLOSED:dhe,M_POLL_KIND_UNDISCLOSED:fhe,M_POLL_RESPONSE:am,M_POLL_START:hhe,M_TEXT:Z4,M_TIMESTAMP:xl,M_TOPIC:Y4,MatrixClient:i_,MatrixError:ur,MatrixEvent:Bn,MatrixEventEvent:At,MatrixHttpApi:SV,MatrixScheduler:nf,MediaHandlerEvent:Zl,MediaPrefix:Ed,MemoryCryptoStore:zb,MemoryStore:_3,Method:_e,MsgType:Ma,NoAuthFlowFoundError:vz,NotificationCountType:It,OidcError:Sn,OidcTokenRefresher:tve,PUSHER_DEVICE_ID:Rce,PUSHER_ENABLED:hx,PendingEventOrdering:sf,Poll:pV,PollEvent:As,Preset:o3,ProfileKeyMSC4175Timezone:_ge,PushRuleActionName:ol,PushRuleKind:en,REFERENCE_RELATION:eV,ReceiptType:In,RelatedRelations:Sge,RelationType:gr,Relations:q4,RelationsEvent:ry,RestrictedAllowType:Ype,Room:Xb,RoomCreateTypeField:T0,RoomEvent:Ue,RoomMember:tm,RoomMemberEvent:Xn,RoomNameType:Na,RoomState:cm,RoomStateEvent:dt,RoomSummary:Xj,RoomType:Sd,RoomVersionStability:wV,RoomWidgetClient:hz,RoomWidgetClientEvent:cy,RuleId:Xr,SERVICE_TYPES:Gx,SSOAction:bge,SUPPORTED_MATRIX_VERSIONS:sm,SearchOrderBy:UV,SearchResult:t_,SecretStorage:mme,ServerCapabilities:EV,SetPresence:CV,SlidingSyncEvent:qx,StatsReport:jo,SyncAccumulator:pz,SyncState:Lt,THREAD_RELATION_TYPE:jt,Thread:Jt,ThreadEvent:Pn,ThreadFilterType:pa,ThreepidMedium:vge,TimelineIndex:cC,TimelineWindow:ege,ToDeviceMessageId:Gb,TokenRefreshError:yV,TokenRefreshLogoutError:Q4,TweakName:i3,TypedEventEmitter:nr,UNSIGNED_MEMBERSHIP_FIELD:Nj,UNSIGNED_THREAD_ID_FIELD:D0,UNSTABLE_ELEMENT_FUNCTIONAL_USERS:Lj,UNSTABLE_MSC2666_MUTUAL_ROOMS:az,UNSTABLE_MSC2666_QUERY_MUTUAL_ROOMS:oz,UNSTABLE_MSC2666_SHARED_ROOMS:iz,UNSTABLE_MSC2716_MARKER:$j,UNSTABLE_MSC3088_ENABLED:cx,UNSTABLE_MSC3088_PURPOSE:ux,UNSTABLE_MSC3089_BRANCH:Io,UNSTABLE_MSC3089_LEAF:Oj,UNSTABLE_MSC3089_TREE_SUBTYPE:dx,UNSTABLE_MSC3852_LAST_SEEN_UA:ive,UNSTABLE_MSC4133_EXTENDED_PROFILES:sz,UNSTABLE_MSC4140_DELAYED_EVENTS:Ka,UnsupportedDelayedEventsEndpointError:Gs,UpdateDelayedEventAction:Su,User:Zo,UserEvent:mi,Visibility:Zpe,anySignal:bV,calculateRetryBackoff:_V,completeAuthorizationCodeGrant:Xme,createClient:fC,createNewMatrixCall:om,createRoomWidgetClient:Cge,decodeBase64:xd,decodeIdToken:ez,determineFeatureSupport:ly,discoverAndValidateOIDCIssuerWellKnown:y3,encodeBase64:ny,encodeUnpaddedBase64:OV,encodeUnpaddedBase64Url:Qb,fixNotificationCountOnDecryption:lz,generateAuthorizationParams:qme,generateAuthorizationUrl:Zme,generateOidcAuthorizationUrl:Yme,generateScope:n_,getBeaconInfoIdentifier:O0,getHttpUriForMxc:Kb,inMainTimelineForReceipt:um,isDmMemberCountCondition:jpe,isEventTypeSame:nhe,isPollEvent:mV,isTimestampInDuration:$x,localStorageErrorsEventsEmitter:xge,parseErrorResponse:e3,registerOidcClient:eve,retryNetworkOperation:Nx,safeGetRetryAfterMs:X4,setCryptoStoreFactory:Ez,threadFilterTypeToFilter:uz,threadIdForReceipt:lf,timeoutSignal:Jb,validateAuthMetadata:QV,validateAuthMetadataAndKeys:b3,validateBearerTokenResponse:nz,validateIdToken:tz,validateStoredUserState:rz},Symbol.toStringTag,{value:"Module"}));if(globalThis.__js_sdk_entrypoint)throw new Error("Multiple matrix-js-sdk entrypoints detected!");globalThis.__js_sdk_entrypoint=!0;var hC;try{hC=globalThis.indexedDB}catch{}hC&&Ez(()=>new Dt(hC,"matrix-js-sdk:crypto"));globalThis.matrixcs=Tge;function Dge(t,e){const r=fC({baseUrl:"https://matrix.org"}),n={type:"m.login.password",user:t,password:e};return r.loginRequest(n).then(i=>(Sa({title:"Login successful",description:"Matrix login successful.",severity:"success"}),fC({baseUrl:"https://matrix.org",accessToken:i.access_token,userId:i.user_id})),i=>(Sa({title:"Login failed",description:"Matrix login failed. ("+i+")",severity:"danger"}),console.log(i),null))}function Rge(t,e,r){const n=JSON.stringify(r);return t.sendEvent(e,ge.RoomMessage,{msgtype:Ma.Text,body:n,format:"org.matrix.custom.html",formatted_body:`<pre>${n}</pre>`}).then(()=>(Sa({title:"Export successful",description:"Notes exported to Matrix.",severity:"success"}),!0),i=>(Sa({title:"Export failed",description:"Notes couldn't be exported to Matrix. ("+i+")",severity:"danger"}),console.log(i),!1))}function Mge(t,e,r,n){return t.joinRoom(e).catch(()=>{}).then(()=>t.createMessagesRequest(e,"",5,st.Backward)).then(i=>{if(i&&i.chunk&&i.chunk.length>0){for(const a of i.chunk)if(a.type===ge.RoomMessage&&a.content&&a.content.body)try{const o=JSON.parse(a.content.body);return r.current.transact(()=>{r.current.getArray(n).delete(0,r.current.getArray(n).length),r.current.getArray(n).insert(0,o)}),Sa({title:"Import successful",description:"Notes imported from Matrix.",severity:"success"}),!0}catch{}}return!1}).catch(i=>(Sa({title:"Import failed",description:"Notes couldn't be imported from Matrix. ("+i+")",severity:"danger"}),console.log(i),!1))}const Vl="notes",Ige="default";function Pge(){return Object.seal({id:crypto.randomUUID(),name:"",location:null,date:{start:new Bt(2025,1,1),end:new Bt(2025,1,1)},notes:[],participants:"",sleepingPlace:""})}const Cz=D.createContext(void 0);function Tz(t){return t.sort((e,r)=>e.date.start.year-r.date.start.year||e.date.start.month-r.date.start.month||e.date.start.day-r.date.start.day)}function Yk(t){return t instanceof Bt?t:new Bt(t.year,t.month,t.day)}function Age(t){return{...t,date:{start:Yk(t.date.start),end:Yk(t.date.end)}}}function kge({children:t}){const e=D.useRef(new Tf),[r]=D.useState(Ige),[n,i]=D.useState(null),[a,o]=D.useState(null),s=e.current.getArray(Vl),l=Due(s).map(Age);D.useEffect(()=>{a&&a.destroy();try{const y=new Vue(r,e.current);o(y)}catch(y){console.error("Error creating IndexedDB provider:",y)}return()=>{a&&a.destroy()}},[r]);const c=y=>{e.current.getArray(Vl).push([y])},d=(y,R)=>{const b=l.findIndex(_=>_.id===y);e.current.transact(()=>{e.current.getArray(Vl).delete(b),e.current.getArray(Vl).insert(b,[R])})},h=y=>{const R=l.findIndex(b=>b.id===y);R!==-1&&e.current.getArray(Vl).delete(R)},{isOpen:p,onOpen:m,onOpenChange:g}=EN();return D.useEffect(()=>{const y=R=>{R.key==="Escape"&&!p&&m()};return document.addEventListener("keydown",y),()=>{document.removeEventListener("keydown",y)}},[p,m]),O.jsxs(O.Fragment,{children:[O.jsx(Joe,{isOpen:p,onOpenChange:g,onMatrixLogin:(y,R)=>Dge(y,R).then(b=>(b&&i(b),b!=null)),exportToClipboard:()=>zue(l),importFromClipboard:()=>Kue(e,Vl),exportToMatrix:y=>Rge(n,y,l),importFromMatrix:y=>Mge(n,y,e,Vl)}),O.jsx(Cz.Provider,{value:{notes:l,addNote:c,updateNote:d,deleteNote:h},children:t})]})}function f_(){const t=D.useContext(Cz);if(t===void 0)throw new Error("useNotes must be used within a NoteProvider");return t}function z0(t,e){const r=e.findIndex(i=>i.id===t),n=_S.length-1;return r===-1?_S[n]:_S[Math.min(r,n)]}const Dz=D.createContext(null);function Oge({children:t}){const[e,r]=D.useState(null),[n]=D.useState(()=>new Set),i=o=>(n.add(o),()=>{n.delete(o)}),a=o=>{r(o),o&&n.forEach(s=>s(o))};return O.jsx(Dz.Provider,{value:{mapLocation:e,setMapLocation:a,onMapLocationChanged:i},children:t})}function Rz(){const t=D.useContext(Dz);if(t===void 0)throw new Error("useLocation must be used within a LocationProvider");return t}const $ge=t=>{const e=document.createElement("div");e.className="custom-marker";const r=document.createElement("div");return r.className="pin",r.style.borderColor=t,e.appendChild(r),e6.divIcon({className:"custom-div-icon",html:e,iconSize:[24,24],iconAnchor:[12,12]})},Lge={lat:35.6762,lng:139.6503},Bge=6;function Nge({selectedLocation:t,setSelectedLocation:e}){const r=i6();return D.useEffect(()=>{const n=i=>{e(i.latlng)};return r.on("click",n),()=>{r.off("click",n)}},[r,e]),null}function Uge(){const{notes:t}=f_(),{mapLocation:e,setMapLocation:r}=Rz(),n=d=>`${d.start.day} - ${d.end.day}`,i=t.filter(d=>d.location),o=(()=>{const d=[];for(let h=0;h<t.length-1;h++){const p=t[h],m=t[h+1];p.location&&m.location&&d.push([[p.location.lat,p.location.lng],[m.location.lat,m.location.lng]])}return d})(),s=D.useRef(null),l=D.useRef([]),c=()=>{const d=i6();return s.current=d,D.useEffect(()=>(l.current.forEach(h=>{d&&h.remove()}),l.current=[],d&&i.length>0&&i.forEach(h=>{if(h.location){const p=$ge(z0(h.id,t).hex),m=e6.marker(h.location,{icon:p}),g=document.createElement("div"),y=document.createElement("h3");y.textContent=h.name;const R=document.createElement("p");R.textContent=n(h.date);const b=document.createElement("p");b.textContent=`Participants: ${h.participants}`;const _=document.createElement("p");_.textContent=`Sleeping: ${h.sleepingPlace}`,_.style.fontStyle="italic",g.appendChild(y),g.appendChild(R),g.appendChild(b),g.appendChild(_),m.bindPopup(g),m.addTo(d),l.current.push(m)}}),()=>{l.current.forEach(h=>{d&&h.remove()}),l.current=[]}),[d,i,r]),null};return O.jsx("div",{className:"h-screen w-screen top-0 left-0",children:O.jsxs(bq,{center:Lge,zoom:Bge,style:{height:"100%",width:"100%"},children:[O.jsx(Sq,{attribution:' <a href="https://stadiamaps.com/">Stadia Maps</a>  <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>',url:"https://tiles.stadiamaps.com/tiles/alidade_bright/{z}/{x}/{y}.png"}),O.jsx(Nge,{selectedLocation:e,setSelectedLocation:r}),O.jsx(c,{}),o.map((d,h)=>O.jsx(_q,{positions:d,color:"oklch(44.2% 0.017 285.786)",weight:3,opacity:.7,dashArray:"5, 10"},h))]})})}function Fge({noteId:t,isOpen:e,onOpenChange:r}){const{notes:n,updateNote:i}=f_(),a=t?n.find(h=>h.id===t):null;let o=a?a.name:"",s=a?a.date:{start:new Bt(2025,0,1),end:new Bt(2025,0,1)},l=a?a.participants:"",c=a?a.sleepingPlace:"";const d=h=>{t&&i(t,{...a,name:o,date:{start:s.start,end:s.end},participants:l,sleepingPlace:c}),h()};return t?O.jsx(wN,{placement:"center",isOpen:e,onOpenChange:r,children:O.jsx(vN,{children:h=>O.jsxs(O.Fragment,{children:[O.jsx(_N,{children:"Edit Location"}),O.jsxs(pN,{children:[O.jsxs("div",{className:"flex flex-row gap-2",children:[O.jsx(gu,{label:"Name",placeholder:"Location Name",variant:"bordered",defaultValue:o,onValueChange:p=>o=p}),O.jsx(uoe,{isRequired:!0,label:"Date",firstDayOfWeek:"mon",defaultValue:{start:s.start,end:s.end},onChange:p=>s=p})]}),O.jsx(gu,{label:"Participants (comma separated)",placeholder:"No Participants",variant:"bordered",defaultValue:l,onValueChange:p=>l=p,endContent:O.jsx(s9,{className:"size-6 text-default-400 pointer-events-none"})}),O.jsx(gu,{label:"Sleeping Place",placeholder:"No Sleeping Place",variant:"bordered",defaultValue:c,onValueChange:p=>c=p,endContent:O.jsx(l9,{className:"size-6 text-default-400 pointer-events-none"})})]}),O.jsx(yN,{children:O.jsx(An,{color:"success",onPress:()=>d(h),children:"OK"})})]})})}):O.jsx(O.Fragment,{})}function jge(t){let e=t.length?t[0].date.end.add({days:1}):new Bt(2025,7,1);for(let r of t){if(e.compare(r.date.start)<0)break;e.compare(r.date.end)>0||(e=r.date.end.add({days:1}))}return e}function Vge(){const{notes:t,addNote:e,updateNote:r,deleteNote:n}=f_(),{mapLocation:i,onMapLocationChanged:a}=Rz(),[o,s]=D.useState(null),[l,c]=D.useState(null),[d,h]=D.useState(null),{isOpen:p,onOpen:m,onOpenChange:g}=EN(),y=D.useCallback(()=>new Promise((x,T)=>{const I=k=>{k.key==="Escape"&&(document.removeEventListener("keydown",I),T(new Error("Selection cancelled")))},C=a(k=>{document.removeEventListener("keydown",I),C(),x(k)});document.addEventListener("keydown",I)}),[]),R=(x,T)=>{const C={...t.find(k=>k.id===x),location:T};r(x,C)},b=()=>{const T={...t.find(I=>I.id===o),name:l};r(o,T),s(null)},_=x=>`${x.start.day}  ${x.end.day}`;return O.jsxs("div",{className:"flex flex-col gap-4 pb-4",children:[O.jsx(Fge,{isOpen:p,noteId:d,onOpenChange:g}),O.jsx(An,{isIconOnly:!0,"aria-label":"Add Location",variant:"solid",color:"primary",className:"w-fit text-zinc-800 mx-8",onPress:x=>{const T=Pge(),I=jge(t);T.date.start=I,T.date.end=I,e(T),h(T.id),m()},children:O.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:"size-6",children:O.jsx("path",{fillRule:"evenodd",d:"M12 3.75a.75.75 0 0 1 .75.75v6.75h6.75a.75.75 0 0 1 0 1.5h-6.75v6.75a.75.75 0 0 1-1.5 0v-6.75H4.5a.75.75 0 0 1 0-1.5h6.75V4.5a.75.75 0 0 1 .75-.75Z",clipRule:"evenodd"})})}),O.jsx("div",{className:"flex flex-row gap-6 px-8 overflow-x-scroll scrollbar-hide",children:Tz(t).map(x=>O.jsxs(a7,{isBlurred:!0,className:"border-none bg-background/60 dark:bg-default-100/50 min-w-64 h-fit self-end",shadow:"sm",children:[O.jsx(n7,{className:`${z0(x.id,t).light}`,children:o===x.id?O.jsx("div",{className:"w-full",children:O.jsx(gu,{type:"text",variant:"bordered",size:"sm",value:l,onChange:T=>c(T.target.value),onBlur:b,onKeyDown:T=>T.key==="Enter"&&b(),autoFocus:!0})}):O.jsxs("div",{className:"flex flex-row w-full items-center",children:[O.jsx("div",{className:"text-lg font-semibold flex-1",onClick:()=>{c(x.name),s(x.id)},children:x.name||"New Location"}),O.jsx(Dne,{className:`${z0(x.id,t).base} mr-2 font-semibold`,size:"md",children:_(x.date)||"?  ?"}),O.jsxs(kie,{children:[O.jsx(Rie,{children:O.jsx(An,{isIconOnly:!0,color:"primary",variant:"light","aria-label":"menu",size:"sm",className:"text-zinc-800",children:O.jsx(Hoe,{className:"size-4"})})}),O.jsxs(Die,{"aria-label":"Static Actions",onAction:T=>{switch(T){case"edit-details":h(x.id),m();break;case"select-location":y().then(I=>{I&&R(x.id,I)});break;case"delete":n(x.id);break}},children:[O.jsx(XS,{children:"Edit Details"},"edit-details"),O.jsx(XS,{children:"Select Location"},"select-location"),O.jsx(XS,{className:"text-danger",color:"danger",children:"Delete Card"},"delete")]})]})]})}),O.jsxs(t7,{children:[O.jsxs("div",{className:"text-sm text-zinc-600",children:[O.jsxs("div",{className:"flex flex-row items-center gap-2",children:[O.jsx(s9,{className:"size-4"}),x.participants.length>0?x.participants:"No participants"]}),O.jsxs("div",{className:"flex flex-row items-center gap-2",children:[O.jsx(l9,{className:"size-4"}),x.sleepingPlace?`${x.sleepingPlace}`:"No sleeping place"]})]}),O.jsx(iie,{minRows:1,variant:"underlined",color:"primary",className:"text-zinc-800",defaultValue:x.notes?x.notes.join(`
`):"",onChange:T=>{const I={...x,notes:T.target.value.split(`
`)};r(x.id,I)}})]})]},x.id))})]})}const zge=1,Kge=31;Intl.DateTimeFormat().resolvedOptions().timeZone;function Hge({}){const{notes:t}=f_(),e=()=>{const r=[];for(let n=0;n<zge;n++)r.push({day:null,color:null});for(let n=1;n<=Kge;n++){const i=new Bt(2025,7,n);let a=null,o=Tz(t);for(let s=t.length-1;s>=0;s--){const l=o[s];if(i.compare(l.date.start)>=0&&i.compare(l.date.end)<=0){a=z0(l.id,t);break}}r.push({day:n,color:a})}return r};return O.jsxs(a7,{isBlurred:!0,className:"border-none bg-background/60 dark:bg-default-100/50 m-8 max-w-[610px]",shadow:"md",children:[O.jsx(n7,{className:"py-2 px-4 flex-col items-start",children:O.jsx("h4",{className:"font-bold text-large",children:"July 2025"})}),O.jsx(WB,{}),O.jsxs(t7,{className:"text-zinc-800",children:[O.jsxs("div",{className:"grid grid-cols-7 gap-1 text-center *:size-8 *:font-bold",children:[O.jsx("div",{children:"M"}),O.jsx("div",{children:"T"}),O.jsx("div",{children:"W"}),O.jsx("div",{children:"T"}),O.jsx("div",{children:"F"}),O.jsx("div",{className:"text-zinc-500",children:"S"}),O.jsx("div",{className:"text-zinc-500",children:"S"})]}),O.jsx("div",{className:"grid grid-cols-7 gap-1 text-center",children:e().map(r=>O.jsx("div",{className:`p-1 rounded-full size-8 ${r.color?r.color.light+" "+r.color.hover:"hover:bg-zinc-400/20"}`,children:r.day},r.day))})]})]})}function Wge(){return O.jsxs(O.Fragment,{children:[O.jsx("div",{className:"absolute top-0 left-0 z-1",children:O.jsx(Uge,{})}),O.jsx("div",{className:"absolute bottom-4 left-0 z-2 w-full",children:O.jsx(Vge,{})}),O.jsx("div",{className:"absolute top-0 right-0 z-2",children:O.jsx(Hge,{})})]})}var Mz={},h_={};h_.byteLength=Zge;h_.toByteArray=Jge;h_.fromByteArray=eye;var Wa=[],Vi=[],Gge=typeof Uint8Array<"u"?Uint8Array:Array,Kw="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var Tc=0,qge=Kw.length;Tc<qge;++Tc)Wa[Tc]=Kw[Tc],Vi[Kw.charCodeAt(Tc)]=Tc;Vi[45]=62;Vi[95]=63;function Iz(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=t.indexOf("=");r===-1&&(r=e);var n=r===e?0:4-r%4;return[r,n]}function Zge(t){var e=Iz(t),r=e[0],n=e[1];return(r+n)*3/4-n}function Yge(t,e,r){return(e+r)*3/4-r}function Jge(t){var e,r=Iz(t),n=r[0],i=r[1],a=new Gge(Yge(t,n,i)),o=0,s=i>0?n-4:n,l;for(l=0;l<s;l+=4)e=Vi[t.charCodeAt(l)]<<18|Vi[t.charCodeAt(l+1)]<<12|Vi[t.charCodeAt(l+2)]<<6|Vi[t.charCodeAt(l+3)],a[o++]=e>>16&255,a[o++]=e>>8&255,a[o++]=e&255;return i===2&&(e=Vi[t.charCodeAt(l)]<<2|Vi[t.charCodeAt(l+1)]>>4,a[o++]=e&255),i===1&&(e=Vi[t.charCodeAt(l)]<<10|Vi[t.charCodeAt(l+1)]<<4|Vi[t.charCodeAt(l+2)]>>2,a[o++]=e>>8&255,a[o++]=e&255),a}function Xge(t){return Wa[t>>18&63]+Wa[t>>12&63]+Wa[t>>6&63]+Wa[t&63]}function Qge(t,e,r){for(var n,i=[],a=e;a<r;a+=3)n=(t[a]<<16&16711680)+(t[a+1]<<8&65280)+(t[a+2]&255),i.push(Xge(n));return i.join("")}function eye(t){for(var e,r=t.length,n=r%3,i=[],a=16383,o=0,s=r-n;o<s;o+=a)i.push(Qge(t,o,o+a>s?s:o+a));return n===1?(e=t[r-1],i.push(Wa[e>>2]+Wa[e<<4&63]+"==")):n===2&&(e=(t[r-2]<<8)+t[r-1],i.push(Wa[e>>10]+Wa[e>>4&63]+Wa[e<<2&63]+"=")),i.join("")}var x3={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */x3.read=function(t,e,r,n,i){var a,o,s=i*8-n-1,l=(1<<s)-1,c=l>>1,d=-7,h=r?i-1:0,p=r?-1:1,m=t[e+h];for(h+=p,a=m&(1<<-d)-1,m>>=-d,d+=s;d>0;a=a*256+t[e+h],h+=p,d-=8);for(o=a&(1<<-d)-1,a>>=-d,d+=n;d>0;o=o*256+t[e+h],h+=p,d-=8);if(a===0)a=1-c;else{if(a===l)return o?NaN:(m?-1:1)*(1/0);o=o+Math.pow(2,n),a=a-c}return(m?-1:1)*o*Math.pow(2,a-n)};x3.write=function(t,e,r,n,i,a){var o,s,l,c=a*8-i-1,d=(1<<c)-1,h=d>>1,p=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,m=n?0:a-1,g=n?1:-1,y=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,o=d):(o=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-o))<1&&(o--,l*=2),o+h>=1?e+=p/l:e+=p*Math.pow(2,1-h),e*l>=2&&(o++,l/=2),o+h>=d?(s=0,o=d):o+h>=1?(s=(e*l-1)*Math.pow(2,i),o=o+h):(s=e*Math.pow(2,h-1)*Math.pow(2,i),o=0));i>=8;t[r+m]=s&255,m+=g,s/=256,i-=8);for(o=o<<i|s,c+=i;c>0;t[r+m]=o&255,m+=g,o/=256,c-=8);t[r+m-g]|=y*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(t){const e=h_,r=x3,n=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=s,t.SlowBuffer=_,t.INSPECT_MAX_BYTES=50;const i=2147483647;t.kMaxLength=i,s.TYPED_ARRAY_SUPPORT=a(),!s.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function a(){try{const B=new Uint8Array(1),M={foo:function(){return 42}};return Object.setPrototypeOf(M,Uint8Array.prototype),Object.setPrototypeOf(B,M),B.foo()===42}catch{return!1}}Object.defineProperty(s.prototype,"parent",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.buffer}}),Object.defineProperty(s.prototype,"offset",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.byteOffset}});function o(B){if(B>i)throw new RangeError('The value "'+B+'" is invalid for option "size"');const M=new Uint8Array(B);return Object.setPrototypeOf(M,s.prototype),M}function s(B,M,P){if(typeof B=="number"){if(typeof M=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return h(B)}return l(B,M,P)}s.poolSize=8192;function l(B,M,P){if(typeof B=="string")return p(B,M);if(ArrayBuffer.isView(B))return g(B);if(B==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof B);if(ze(B,ArrayBuffer)||B&&ze(B.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(ze(B,SharedArrayBuffer)||B&&ze(B.buffer,SharedArrayBuffer)))return y(B,M,P);if(typeof B=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const G=B.valueOf&&B.valueOf();if(G!=null&&G!==B)return s.from(G,M,P);const re=R(B);if(re)return re;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof B[Symbol.toPrimitive]=="function")return s.from(B[Symbol.toPrimitive]("string"),M,P);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof B)}s.from=function(B,M,P){return l(B,M,P)},Object.setPrototypeOf(s.prototype,Uint8Array.prototype),Object.setPrototypeOf(s,Uint8Array);function c(B){if(typeof B!="number")throw new TypeError('"size" argument must be of type number');if(B<0)throw new RangeError('The value "'+B+'" is invalid for option "size"')}function d(B,M,P){return c(B),B<=0?o(B):M!==void 0?typeof P=="string"?o(B).fill(M,P):o(B).fill(M):o(B)}s.alloc=function(B,M,P){return d(B,M,P)};function h(B){return c(B),o(B<0?0:b(B)|0)}s.allocUnsafe=function(B){return h(B)},s.allocUnsafeSlow=function(B){return h(B)};function p(B,M){if((typeof M!="string"||M==="")&&(M="utf8"),!s.isEncoding(M))throw new TypeError("Unknown encoding: "+M);const P=x(B,M)|0;let G=o(P);const re=G.write(B,M);return re!==P&&(G=G.slice(0,re)),G}function m(B){const M=B.length<0?0:b(B.length)|0,P=o(M);for(let G=0;G<M;G+=1)P[G]=B[G]&255;return P}function g(B){if(ze(B,Uint8Array)){const M=new Uint8Array(B);return y(M.buffer,M.byteOffset,M.byteLength)}return m(B)}function y(B,M,P){if(M<0||B.byteLength<M)throw new RangeError('"offset" is outside of buffer bounds');if(B.byteLength<M+(P||0))throw new RangeError('"length" is outside of buffer bounds');let G;return M===void 0&&P===void 0?G=new Uint8Array(B):P===void 0?G=new Uint8Array(B,M):G=new Uint8Array(B,M,P),Object.setPrototypeOf(G,s.prototype),G}function R(B){if(s.isBuffer(B)){const M=b(B.length)|0,P=o(M);return P.length===0||B.copy(P,0,0,M),P}if(B.length!==void 0)return typeof B.length!="number"||Pe(B.length)?o(0):m(B);if(B.type==="Buffer"&&Array.isArray(B.data))return m(B.data)}function b(B){if(B>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return B|0}function _(B){return+B!=B&&(B=0),s.alloc(+B)}s.isBuffer=function(M){return M!=null&&M._isBuffer===!0&&M!==s.prototype},s.compare=function(M,P){if(ze(M,Uint8Array)&&(M=s.from(M,M.offset,M.byteLength)),ze(P,Uint8Array)&&(P=s.from(P,P.offset,P.byteLength)),!s.isBuffer(M)||!s.isBuffer(P))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(M===P)return 0;let G=M.length,re=P.length;for(let Q=0,ae=Math.min(G,re);Q<ae;++Q)if(M[Q]!==P[Q]){G=M[Q],re=P[Q];break}return G<re?-1:re<G?1:0},s.isEncoding=function(M){switch(String(M).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},s.concat=function(M,P){if(!Array.isArray(M))throw new TypeError('"list" argument must be an Array of Buffers');if(M.length===0)return s.alloc(0);let G;if(P===void 0)for(P=0,G=0;G<M.length;++G)P+=M[G].length;const re=s.allocUnsafe(P);let Q=0;for(G=0;G<M.length;++G){let ae=M[G];if(ze(ae,Uint8Array))Q+ae.length>re.length?(s.isBuffer(ae)||(ae=s.from(ae)),ae.copy(re,Q)):Uint8Array.prototype.set.call(re,ae,Q);else if(s.isBuffer(ae))ae.copy(re,Q);else throw new TypeError('"list" argument must be an Array of Buffers');Q+=ae.length}return re};function x(B,M){if(s.isBuffer(B))return B.length;if(ArrayBuffer.isView(B)||ze(B,ArrayBuffer))return B.byteLength;if(typeof B!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof B);const P=B.length,G=arguments.length>2&&arguments[2]===!0;if(!G&&P===0)return 0;let re=!1;for(;;)switch(M){case"ascii":case"latin1":case"binary":return P;case"utf8":case"utf-8":return $e(B).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return P*2;case"hex":return P>>>1;case"base64":return Ge(B).length;default:if(re)return G?-1:$e(B).length;M=(""+M).toLowerCase(),re=!0}}s.byteLength=x;function T(B,M,P){let G=!1;if((M===void 0||M<0)&&(M=0),M>this.length||((P===void 0||P>this.length)&&(P=this.length),P<=0)||(P>>>=0,M>>>=0,P<=M))return"";for(B||(B="utf8");;)switch(B){case"hex":return fe(this,M,P);case"utf8":case"utf-8":return le(this,M,P);case"ascii":return te(this,M,P);case"latin1":case"binary":return H(this,M,P);case"base64":return $(this,M,P);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ne(this,M,P);default:if(G)throw new TypeError("Unknown encoding: "+B);B=(B+"").toLowerCase(),G=!0}}s.prototype._isBuffer=!0;function I(B,M,P){const G=B[M];B[M]=B[P],B[P]=G}s.prototype.swap16=function(){const M=this.length;if(M%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let P=0;P<M;P+=2)I(this,P,P+1);return this},s.prototype.swap32=function(){const M=this.length;if(M%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let P=0;P<M;P+=4)I(this,P,P+3),I(this,P+1,P+2);return this},s.prototype.swap64=function(){const M=this.length;if(M%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let P=0;P<M;P+=8)I(this,P,P+7),I(this,P+1,P+6),I(this,P+2,P+5),I(this,P+3,P+4);return this},s.prototype.toString=function(){const M=this.length;return M===0?"":arguments.length===0?le(this,0,M):T.apply(this,arguments)},s.prototype.toLocaleString=s.prototype.toString,s.prototype.equals=function(M){if(!s.isBuffer(M))throw new TypeError("Argument must be a Buffer");return this===M?!0:s.compare(this,M)===0},s.prototype.inspect=function(){let M="";const P=t.INSPECT_MAX_BYTES;return M=this.toString("hex",0,P).replace(/(.{2})/g,"$1 ").trim(),this.length>P&&(M+=" ... "),"<Buffer "+M+">"},n&&(s.prototype[n]=s.prototype.inspect),s.prototype.compare=function(M,P,G,re,Q){if(ze(M,Uint8Array)&&(M=s.from(M,M.offset,M.byteLength)),!s.isBuffer(M))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof M);if(P===void 0&&(P=0),G===void 0&&(G=M?M.length:0),re===void 0&&(re=0),Q===void 0&&(Q=this.length),P<0||G>M.length||re<0||Q>this.length)throw new RangeError("out of range index");if(re>=Q&&P>=G)return 0;if(re>=Q)return-1;if(P>=G)return 1;if(P>>>=0,G>>>=0,re>>>=0,Q>>>=0,this===M)return 0;let ae=Q-re,ve=G-P;const xe=Math.min(ae,ve),Me=this.slice(re,Q),Ee=M.slice(P,G);for(let ke=0;ke<xe;++ke)if(Me[ke]!==Ee[ke]){ae=Me[ke],ve=Ee[ke];break}return ae<ve?-1:ve<ae?1:0};function C(B,M,P,G,re){if(B.length===0)return-1;if(typeof P=="string"?(G=P,P=0):P>2147483647?P=2147483647:P<-2147483648&&(P=-2147483648),P=+P,Pe(P)&&(P=re?0:B.length-1),P<0&&(P=B.length+P),P>=B.length){if(re)return-1;P=B.length-1}else if(P<0)if(re)P=0;else return-1;if(typeof M=="string"&&(M=s.from(M,G)),s.isBuffer(M))return M.length===0?-1:k(B,M,P,G,re);if(typeof M=="number")return M=M&255,typeof Uint8Array.prototype.indexOf=="function"?re?Uint8Array.prototype.indexOf.call(B,M,P):Uint8Array.prototype.lastIndexOf.call(B,M,P):k(B,[M],P,G,re);throw new TypeError("val must be string, number or Buffer")}function k(B,M,P,G,re){let Q=1,ae=B.length,ve=M.length;if(G!==void 0&&(G=String(G).toLowerCase(),G==="ucs2"||G==="ucs-2"||G==="utf16le"||G==="utf-16le")){if(B.length<2||M.length<2)return-1;Q=2,ae/=2,ve/=2,P/=2}function xe(Ee,ke){return Q===1?Ee[ke]:Ee.readUInt16BE(ke*Q)}let Me;if(re){let Ee=-1;for(Me=P;Me<ae;Me++)if(xe(B,Me)===xe(M,Ee===-1?0:Me-Ee)){if(Ee===-1&&(Ee=Me),Me-Ee+1===ve)return Ee*Q}else Ee!==-1&&(Me-=Me-Ee),Ee=-1}else for(P+ve>ae&&(P=ae-ve),Me=P;Me>=0;Me--){let Ee=!0;for(let ke=0;ke<ve;ke++)if(xe(B,Me+ke)!==xe(M,ke)){Ee=!1;break}if(Ee)return Me}return-1}s.prototype.includes=function(M,P,G){return this.indexOf(M,P,G)!==-1},s.prototype.indexOf=function(M,P,G){return C(this,M,P,G,!0)},s.prototype.lastIndexOf=function(M,P,G){return C(this,M,P,G,!1)};function S(B,M,P,G){P=Number(P)||0;const re=B.length-P;G?(G=Number(G),G>re&&(G=re)):G=re;const Q=M.length;G>Q/2&&(G=Q/2);let ae;for(ae=0;ae<G;++ae){const ve=parseInt(M.substr(ae*2,2),16);if(Pe(ve))return ae;B[P+ae]=ve}return ae}function V(B,M,P,G){return nt($e(M,B.length-P),B,P,G)}function z(B,M,P,G){return nt(Ne(M),B,P,G)}function j(B,M,P,G){return nt(Ge(M),B,P,G)}function J(B,M,P,G){return nt(Ie(M,B.length-P),B,P,G)}s.prototype.write=function(M,P,G,re){if(P===void 0)re="utf8",G=this.length,P=0;else if(G===void 0&&typeof P=="string")re=P,G=this.length,P=0;else if(isFinite(P))P=P>>>0,isFinite(G)?(G=G>>>0,re===void 0&&(re="utf8")):(re=G,G=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const Q=this.length-P;if((G===void 0||G>Q)&&(G=Q),M.length>0&&(G<0||P<0)||P>this.length)throw new RangeError("Attempt to write outside buffer bounds");re||(re="utf8");let ae=!1;for(;;)switch(re){case"hex":return S(this,M,P,G);case"utf8":case"utf-8":return V(this,M,P,G);case"ascii":case"latin1":case"binary":return z(this,M,P,G);case"base64":return j(this,M,P,G);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return J(this,M,P,G);default:if(ae)throw new TypeError("Unknown encoding: "+re);re=(""+re).toLowerCase(),ae=!0}},s.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function $(B,M,P){return M===0&&P===B.length?e.fromByteArray(B):e.fromByteArray(B.slice(M,P))}function le(B,M,P){P=Math.min(B.length,P);const G=[];let re=M;for(;re<P;){const Q=B[re];let ae=null,ve=Q>239?4:Q>223?3:Q>191?2:1;if(re+ve<=P){let xe,Me,Ee,ke;switch(ve){case 1:Q<128&&(ae=Q);break;case 2:xe=B[re+1],(xe&192)===128&&(ke=(Q&31)<<6|xe&63,ke>127&&(ae=ke));break;case 3:xe=B[re+1],Me=B[re+2],(xe&192)===128&&(Me&192)===128&&(ke=(Q&15)<<12|(xe&63)<<6|Me&63,ke>2047&&(ke<55296||ke>57343)&&(ae=ke));break;case 4:xe=B[re+1],Me=B[re+2],Ee=B[re+3],(xe&192)===128&&(Me&192)===128&&(Ee&192)===128&&(ke=(Q&15)<<18|(xe&63)<<12|(Me&63)<<6|Ee&63,ke>65535&&ke<1114112&&(ae=ke))}}ae===null?(ae=65533,ve=1):ae>65535&&(ae-=65536,G.push(ae>>>10&1023|55296),ae=56320|ae&1023),G.push(ae),re+=ve}return Z(G)}const ie=4096;function Z(B){const M=B.length;if(M<=ie)return String.fromCharCode.apply(String,B);let P="",G=0;for(;G<M;)P+=String.fromCharCode.apply(String,B.slice(G,G+=ie));return P}function te(B,M,P){let G="";P=Math.min(B.length,P);for(let re=M;re<P;++re)G+=String.fromCharCode(B[re]&127);return G}function H(B,M,P){let G="";P=Math.min(B.length,P);for(let re=M;re<P;++re)G+=String.fromCharCode(B[re]);return G}function fe(B,M,P){const G=B.length;(!M||M<0)&&(M=0),(!P||P<0||P>G)&&(P=G);let re="";for(let Q=M;Q<P;++Q)re+=vt[B[Q]];return re}function ne(B,M,P){const G=B.slice(M,P);let re="";for(let Q=0;Q<G.length-1;Q+=2)re+=String.fromCharCode(G[Q]+G[Q+1]*256);return re}s.prototype.slice=function(M,P){const G=this.length;M=~~M,P=P===void 0?G:~~P,M<0?(M+=G,M<0&&(M=0)):M>G&&(M=G),P<0?(P+=G,P<0&&(P=0)):P>G&&(P=G),P<M&&(P=M);const re=this.subarray(M,P);return Object.setPrototypeOf(re,s.prototype),re};function he(B,M,P){if(B%1!==0||B<0)throw new RangeError("offset is not uint");if(B+M>P)throw new RangeError("Trying to access beyond buffer length")}s.prototype.readUintLE=s.prototype.readUIntLE=function(M,P,G){M=M>>>0,P=P>>>0,G||he(M,P,this.length);let re=this[M],Q=1,ae=0;for(;++ae<P&&(Q*=256);)re+=this[M+ae]*Q;return re},s.prototype.readUintBE=s.prototype.readUIntBE=function(M,P,G){M=M>>>0,P=P>>>0,G||he(M,P,this.length);let re=this[M+--P],Q=1;for(;P>0&&(Q*=256);)re+=this[M+--P]*Q;return re},s.prototype.readUint8=s.prototype.readUInt8=function(M,P){return M=M>>>0,P||he(M,1,this.length),this[M]},s.prototype.readUint16LE=s.prototype.readUInt16LE=function(M,P){return M=M>>>0,P||he(M,2,this.length),this[M]|this[M+1]<<8},s.prototype.readUint16BE=s.prototype.readUInt16BE=function(M,P){return M=M>>>0,P||he(M,2,this.length),this[M]<<8|this[M+1]},s.prototype.readUint32LE=s.prototype.readUInt32LE=function(M,P){return M=M>>>0,P||he(M,4,this.length),(this[M]|this[M+1]<<8|this[M+2]<<16)+this[M+3]*16777216},s.prototype.readUint32BE=s.prototype.readUInt32BE=function(M,P){return M=M>>>0,P||he(M,4,this.length),this[M]*16777216+(this[M+1]<<16|this[M+2]<<8|this[M+3])},s.prototype.readBigUInt64LE=Tt(function(M){M=M>>>0,pe(M,"offset");const P=this[M],G=this[M+7];(P===void 0||G===void 0)&&be(M,this.length-8);const re=P+this[++M]*2**8+this[++M]*2**16+this[++M]*2**24,Q=this[++M]+this[++M]*2**8+this[++M]*2**16+G*2**24;return BigInt(re)+(BigInt(Q)<<BigInt(32))}),s.prototype.readBigUInt64BE=Tt(function(M){M=M>>>0,pe(M,"offset");const P=this[M],G=this[M+7];(P===void 0||G===void 0)&&be(M,this.length-8);const re=P*2**24+this[++M]*2**16+this[++M]*2**8+this[++M],Q=this[++M]*2**24+this[++M]*2**16+this[++M]*2**8+G;return(BigInt(re)<<BigInt(32))+BigInt(Q)}),s.prototype.readIntLE=function(M,P,G){M=M>>>0,P=P>>>0,G||he(M,P,this.length);let re=this[M],Q=1,ae=0;for(;++ae<P&&(Q*=256);)re+=this[M+ae]*Q;return Q*=128,re>=Q&&(re-=Math.pow(2,8*P)),re},s.prototype.readIntBE=function(M,P,G){M=M>>>0,P=P>>>0,G||he(M,P,this.length);let re=P,Q=1,ae=this[M+--re];for(;re>0&&(Q*=256);)ae+=this[M+--re]*Q;return Q*=128,ae>=Q&&(ae-=Math.pow(2,8*P)),ae},s.prototype.readInt8=function(M,P){return M=M>>>0,P||he(M,1,this.length),this[M]&128?(255-this[M]+1)*-1:this[M]},s.prototype.readInt16LE=function(M,P){M=M>>>0,P||he(M,2,this.length);const G=this[M]|this[M+1]<<8;return G&32768?G|4294901760:G},s.prototype.readInt16BE=function(M,P){M=M>>>0,P||he(M,2,this.length);const G=this[M+1]|this[M]<<8;return G&32768?G|4294901760:G},s.prototype.readInt32LE=function(M,P){return M=M>>>0,P||he(M,4,this.length),this[M]|this[M+1]<<8|this[M+2]<<16|this[M+3]<<24},s.prototype.readInt32BE=function(M,P){return M=M>>>0,P||he(M,4,this.length),this[M]<<24|this[M+1]<<16|this[M+2]<<8|this[M+3]},s.prototype.readBigInt64LE=Tt(function(M){M=M>>>0,pe(M,"offset");const P=this[M],G=this[M+7];(P===void 0||G===void 0)&&be(M,this.length-8);const re=this[M+4]+this[M+5]*2**8+this[M+6]*2**16+(G<<24);return(BigInt(re)<<BigInt(32))+BigInt(P+this[++M]*2**8+this[++M]*2**16+this[++M]*2**24)}),s.prototype.readBigInt64BE=Tt(function(M){M=M>>>0,pe(M,"offset");const P=this[M],G=this[M+7];(P===void 0||G===void 0)&&be(M,this.length-8);const re=(P<<24)+this[++M]*2**16+this[++M]*2**8+this[++M];return(BigInt(re)<<BigInt(32))+BigInt(this[++M]*2**24+this[++M]*2**16+this[++M]*2**8+G)}),s.prototype.readFloatLE=function(M,P){return M=M>>>0,P||he(M,4,this.length),r.read(this,M,!0,23,4)},s.prototype.readFloatBE=function(M,P){return M=M>>>0,P||he(M,4,this.length),r.read(this,M,!1,23,4)},s.prototype.readDoubleLE=function(M,P){return M=M>>>0,P||he(M,8,this.length),r.read(this,M,!0,52,8)},s.prototype.readDoubleBE=function(M,P){return M=M>>>0,P||he(M,8,this.length),r.read(this,M,!1,52,8)};function oe(B,M,P,G,re,Q){if(!s.isBuffer(B))throw new TypeError('"buffer" argument must be a Buffer instance');if(M>re||M<Q)throw new RangeError('"value" argument is out of bounds');if(P+G>B.length)throw new RangeError("Index out of range")}s.prototype.writeUintLE=s.prototype.writeUIntLE=function(M,P,G,re){if(M=+M,P=P>>>0,G=G>>>0,!re){const ve=Math.pow(2,8*G)-1;oe(this,M,P,G,ve,0)}let Q=1,ae=0;for(this[P]=M&255;++ae<G&&(Q*=256);)this[P+ae]=M/Q&255;return P+G},s.prototype.writeUintBE=s.prototype.writeUIntBE=function(M,P,G,re){if(M=+M,P=P>>>0,G=G>>>0,!re){const ve=Math.pow(2,8*G)-1;oe(this,M,P,G,ve,0)}let Q=G-1,ae=1;for(this[P+Q]=M&255;--Q>=0&&(ae*=256);)this[P+Q]=M/ae&255;return P+G},s.prototype.writeUint8=s.prototype.writeUInt8=function(M,P,G){return M=+M,P=P>>>0,G||oe(this,M,P,1,255,0),this[P]=M&255,P+1},s.prototype.writeUint16LE=s.prototype.writeUInt16LE=function(M,P,G){return M=+M,P=P>>>0,G||oe(this,M,P,2,65535,0),this[P]=M&255,this[P+1]=M>>>8,P+2},s.prototype.writeUint16BE=s.prototype.writeUInt16BE=function(M,P,G){return M=+M,P=P>>>0,G||oe(this,M,P,2,65535,0),this[P]=M>>>8,this[P+1]=M&255,P+2},s.prototype.writeUint32LE=s.prototype.writeUInt32LE=function(M,P,G){return M=+M,P=P>>>0,G||oe(this,M,P,4,4294967295,0),this[P+3]=M>>>24,this[P+2]=M>>>16,this[P+1]=M>>>8,this[P]=M&255,P+4},s.prototype.writeUint32BE=s.prototype.writeUInt32BE=function(M,P,G){return M=+M,P=P>>>0,G||oe(this,M,P,4,4294967295,0),this[P]=M>>>24,this[P+1]=M>>>16,this[P+2]=M>>>8,this[P+3]=M&255,P+4};function me(B,M,P,G,re){ue(M,G,re,B,P,7);let Q=Number(M&BigInt(4294967295));B[P++]=Q,Q=Q>>8,B[P++]=Q,Q=Q>>8,B[P++]=Q,Q=Q>>8,B[P++]=Q;let ae=Number(M>>BigInt(32)&BigInt(4294967295));return B[P++]=ae,ae=ae>>8,B[P++]=ae,ae=ae>>8,B[P++]=ae,ae=ae>>8,B[P++]=ae,P}function ee(B,M,P,G,re){ue(M,G,re,B,P,7);let Q=Number(M&BigInt(4294967295));B[P+7]=Q,Q=Q>>8,B[P+6]=Q,Q=Q>>8,B[P+5]=Q,Q=Q>>8,B[P+4]=Q;let ae=Number(M>>BigInt(32)&BigInt(4294967295));return B[P+3]=ae,ae=ae>>8,B[P+2]=ae,ae=ae>>8,B[P+1]=ae,ae=ae>>8,B[P]=ae,P+8}s.prototype.writeBigUInt64LE=Tt(function(M,P=0){return me(this,M,P,BigInt(0),BigInt("0xffffffffffffffff"))}),s.prototype.writeBigUInt64BE=Tt(function(M,P=0){return ee(this,M,P,BigInt(0),BigInt("0xffffffffffffffff"))}),s.prototype.writeIntLE=function(M,P,G,re){if(M=+M,P=P>>>0,!re){const xe=Math.pow(2,8*G-1);oe(this,M,P,G,xe-1,-xe)}let Q=0,ae=1,ve=0;for(this[P]=M&255;++Q<G&&(ae*=256);)M<0&&ve===0&&this[P+Q-1]!==0&&(ve=1),this[P+Q]=(M/ae>>0)-ve&255;return P+G},s.prototype.writeIntBE=function(M,P,G,re){if(M=+M,P=P>>>0,!re){const xe=Math.pow(2,8*G-1);oe(this,M,P,G,xe-1,-xe)}let Q=G-1,ae=1,ve=0;for(this[P+Q]=M&255;--Q>=0&&(ae*=256);)M<0&&ve===0&&this[P+Q+1]!==0&&(ve=1),this[P+Q]=(M/ae>>0)-ve&255;return P+G},s.prototype.writeInt8=function(M,P,G){return M=+M,P=P>>>0,G||oe(this,M,P,1,127,-128),M<0&&(M=255+M+1),this[P]=M&255,P+1},s.prototype.writeInt16LE=function(M,P,G){return M=+M,P=P>>>0,G||oe(this,M,P,2,32767,-32768),this[P]=M&255,this[P+1]=M>>>8,P+2},s.prototype.writeInt16BE=function(M,P,G){return M=+M,P=P>>>0,G||oe(this,M,P,2,32767,-32768),this[P]=M>>>8,this[P+1]=M&255,P+2},s.prototype.writeInt32LE=function(M,P,G){return M=+M,P=P>>>0,G||oe(this,M,P,4,2147483647,-2147483648),this[P]=M&255,this[P+1]=M>>>8,this[P+2]=M>>>16,this[P+3]=M>>>24,P+4},s.prototype.writeInt32BE=function(M,P,G){return M=+M,P=P>>>0,G||oe(this,M,P,4,2147483647,-2147483648),M<0&&(M=4294967295+M+1),this[P]=M>>>24,this[P+1]=M>>>16,this[P+2]=M>>>8,this[P+3]=M&255,P+4},s.prototype.writeBigInt64LE=Tt(function(M,P=0){return me(this,M,P,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),s.prototype.writeBigInt64BE=Tt(function(M,P=0){return ee(this,M,P,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function Y(B,M,P,G,re,Q){if(P+G>B.length)throw new RangeError("Index out of range");if(P<0)throw new RangeError("Index out of range")}function q(B,M,P,G,re){return M=+M,P=P>>>0,re||Y(B,M,P,4),r.write(B,M,P,G,23,4),P+4}s.prototype.writeFloatLE=function(M,P,G){return q(this,M,P,!0,G)},s.prototype.writeFloatBE=function(M,P,G){return q(this,M,P,!1,G)};function X(B,M,P,G,re){return M=+M,P=P>>>0,re||Y(B,M,P,8),r.write(B,M,P,G,52,8),P+8}s.prototype.writeDoubleLE=function(M,P,G){return X(this,M,P,!0,G)},s.prototype.writeDoubleBE=function(M,P,G){return X(this,M,P,!1,G)},s.prototype.copy=function(M,P,G,re){if(!s.isBuffer(M))throw new TypeError("argument should be a Buffer");if(G||(G=0),!re&&re!==0&&(re=this.length),P>=M.length&&(P=M.length),P||(P=0),re>0&&re<G&&(re=G),re===G||M.length===0||this.length===0)return 0;if(P<0)throw new RangeError("targetStart out of bounds");if(G<0||G>=this.length)throw new RangeError("Index out of range");if(re<0)throw new RangeError("sourceEnd out of bounds");re>this.length&&(re=this.length),M.length-P<re-G&&(re=M.length-P+G);const Q=re-G;return this===M&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(P,G,re):Uint8Array.prototype.set.call(M,this.subarray(G,re),P),Q},s.prototype.fill=function(M,P,G,re){if(typeof M=="string"){if(typeof P=="string"?(re=P,P=0,G=this.length):typeof G=="string"&&(re=G,G=this.length),re!==void 0&&typeof re!="string")throw new TypeError("encoding must be a string");if(typeof re=="string"&&!s.isEncoding(re))throw new TypeError("Unknown encoding: "+re);if(M.length===1){const ae=M.charCodeAt(0);(re==="utf8"&&ae<128||re==="latin1")&&(M=ae)}}else typeof M=="number"?M=M&255:typeof M=="boolean"&&(M=Number(M));if(P<0||this.length<P||this.length<G)throw new RangeError("Out of range index");if(G<=P)return this;P=P>>>0,G=G===void 0?this.length:G>>>0,M||(M=0);let Q;if(typeof M=="number")for(Q=P;Q<G;++Q)this[Q]=M;else{const ae=s.isBuffer(M)?M:s.from(M,re),ve=ae.length;if(ve===0)throw new TypeError('The value "'+M+'" is invalid for argument "value"');for(Q=0;Q<G-P;++Q)this[Q+P]=ae[Q%ve]}return this};const F={};function se(B,M,P){F[B]=class extends P{constructor(){super(),Object.defineProperty(this,"message",{value:M.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${B}]`,this.stack,delete this.name}get code(){return B}set code(re){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:re,writable:!0})}toString(){return`${this.name} [${B}]: ${this.message}`}}}se("ERR_BUFFER_OUT_OF_BOUNDS",function(B){return B?`${B} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),se("ERR_INVALID_ARG_TYPE",function(B,M){return`The "${B}" argument must be of type number. Received type ${typeof M}`},TypeError),se("ERR_OUT_OF_RANGE",function(B,M,P){let G=`The value of "${B}" is out of range.`,re=P;return Number.isInteger(P)&&Math.abs(P)>2**32?re=N(String(P)):typeof P=="bigint"&&(re=String(P),(P>BigInt(2)**BigInt(32)||P<-(BigInt(2)**BigInt(32)))&&(re=N(re)),re+="n"),G+=` It must be ${M}. Received ${re}`,G},RangeError);function N(B){let M="",P=B.length;const G=B[0]==="-"?1:0;for(;P>=G+4;P-=3)M=`_${B.slice(P-3,P)}${M}`;return`${B.slice(0,P)}${M}`}function ce(B,M,P){pe(M,"offset"),(B[M]===void 0||B[M+P]===void 0)&&be(M,B.length-(P+1))}function ue(B,M,P,G,re,Q){if(B>P||B<M){const ae=typeof M=="bigint"?"n":"";let ve;throw M===0||M===BigInt(0)?ve=`>= 0${ae} and < 2${ae} ** ${(Q+1)*8}${ae}`:ve=`>= -(2${ae} ** ${(Q+1)*8-1}${ae}) and < 2 ** ${(Q+1)*8-1}${ae}`,new F.ERR_OUT_OF_RANGE("value",ve,B)}ce(G,re,Q)}function pe(B,M){if(typeof B!="number")throw new F.ERR_INVALID_ARG_TYPE(M,"number",B)}function be(B,M,P){throw Math.floor(B)!==B?(pe(B,P),new F.ERR_OUT_OF_RANGE("offset","an integer",B)):M<0?new F.ERR_BUFFER_OUT_OF_BOUNDS:new F.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${M}`,B)}const we=/[^+/0-9A-Za-z-_]/g;function Ce(B){if(B=B.split("=")[0],B=B.trim().replace(we,""),B.length<2)return"";for(;B.length%4!==0;)B=B+"=";return B}function $e(B,M){M=M||1/0;let P;const G=B.length;let re=null;const Q=[];for(let ae=0;ae<G;++ae){if(P=B.charCodeAt(ae),P>55295&&P<57344){if(!re){if(P>56319){(M-=3)>-1&&Q.push(239,191,189);continue}else if(ae+1===G){(M-=3)>-1&&Q.push(239,191,189);continue}re=P;continue}if(P<56320){(M-=3)>-1&&Q.push(239,191,189),re=P;continue}P=(re-55296<<10|P-56320)+65536}else re&&(M-=3)>-1&&Q.push(239,191,189);if(re=null,P<128){if((M-=1)<0)break;Q.push(P)}else if(P<2048){if((M-=2)<0)break;Q.push(P>>6|192,P&63|128)}else if(P<65536){if((M-=3)<0)break;Q.push(P>>12|224,P>>6&63|128,P&63|128)}else if(P<1114112){if((M-=4)<0)break;Q.push(P>>18|240,P>>12&63|128,P>>6&63|128,P&63|128)}else throw new Error("Invalid code point")}return Q}function Ne(B){const M=[];for(let P=0;P<B.length;++P)M.push(B.charCodeAt(P)&255);return M}function Ie(B,M){let P,G,re;const Q=[];for(let ae=0;ae<B.length&&!((M-=2)<0);++ae)P=B.charCodeAt(ae),G=P>>8,re=P%256,Q.push(re),Q.push(G);return Q}function Ge(B){return e.toByteArray(Ce(B))}function nt(B,M,P,G){let re;for(re=0;re<G&&!(re+P>=M.length||re>=B.length);++re)M[re+P]=B[re];return re}function ze(B,M){return B instanceof M||B!=null&&B.constructor!=null&&B.constructor.name!=null&&B.constructor.name===M.name}function Pe(B){return B!==B}const vt=function(){const B="0123456789abcdef",M=new Array(256);for(let P=0;P<16;++P){const G=P*16;for(let re=0;re<16;++re)M[G+re]=B[P]+B[re]}return M}();function Tt(B){return typeof BigInt>"u"?ir:B}function ir(){throw new Error("BigInt not supported")}})(Mz);const tye={},rye=Object.freeze(Object.defineProperty({__proto__:null,default:tye},Symbol.toStringTag,{value:"Module"}));function nye(){window.Buffer=Mz.Buffer,window.process=rye}nye();aq.createRoot(document.getElementById("root")).render(O.jsx(We.StrictMode,{children:O.jsxs(Tte,{locale:"en-GB",children:[O.jsx(Koe,{}),O.jsx(kge,{children:O.jsx(Oge,{children:O.jsx(Wge,{})})})]})}));export{WJ as $,c2 as A,O as B,gI as C,fye as D,Nm as E,Q2 as F,f4 as G,xb as H,Wo as I,h2 as J,yB as K,u2 as L,aB as M,cQ as N,vye as O,hye as P,Qee as Q,Ree as R,Nee as S,pd as T,Sf as U,rt as V,yf as W,KJ as X,XQ as Y,cye as Z,Ln as _,rI as a,tee as a$,ta as a0,XJ as a1,SI as a2,p2 as a3,sye as a4,rte as a5,CI as a6,DI as a7,tte as a8,ite as a9,Tee as aA,PX as aB,jX as aC,j2 as aD,bte as aE,Ete as aF,Ste as aG,gte as aH,mB as aI,l0 as aJ,qX as aK,$m as aL,ZQ as aM,ao as aN,JQ as aO,lQ as aP,hB as aQ,Cb as aR,aye as aS,KM as aT,Gu as aU,Ca as aV,nB as aW,Ai as aX,HQ as aY,jT as aZ,iye as a_,nte as aa,mye as ab,pye as ac,gee as ad,E1 as ae,Mee as af,wee as ag,Xee as ah,xte as ai,mte as aj,WQ as ak,Cte as al,m2 as am,VX as an,aQ as ao,Eb as ap,oye as aq,$p as ar,e4 as as,_f as at,o4 as au,jQ as av,_B as aw,vte as ax,R1 as ay,Vee as az,x2 as b,US as b$,c0 as b0,see as b1,oB as b2,VT as b3,d2 as b4,f2 as b5,S2 as b6,KT as b7,_2 as b8,b2 as b9,O2 as bA,C2 as bB,uye as bC,Y2 as bD,$Q as bE,UQ as bF,X2 as bG,g1 as bH,JX as bI,iQ as bJ,H2 as bK,bf as bL,k2 as bM,qM as bN,jS as bO,YT as bP,A2 as bQ,MX as bR,DX as bS,o0 as bT,f1 as bU,CX as bV,oQ as bW,bn as bX,d1 as bY,Jc as bZ,wX as b_,HT as ba,w2 as bb,Lm as bc,QJ as bd,E2 as be,eX as bf,g2 as bg,y2 as bh,_Q as bi,lye as bj,hQ as bk,z2 as bl,wQ as bm,WT as bn,GT as bo,p1 as bp,KX as bq,ap as br,JT as bs,s0 as bt,AQ as bu,t4 as bv,rQ as bw,zX as bx,Ah as by,yQ as bz,Iu as c,nu as c0,Bp as c1,G2 as c2,aI as c3,MQ as c4,q2 as c5,r4 as c6,RQ as c7,Lp as c8,gf as c9,_V as cA,$u as cB,mz as cC,Xve as cD,kf as cE,Ma as cF,ml as cG,Dye as cH,ur as cI,Ur as cJ,xye as cK,yme as cL,ny as cM,Tye as cN,Cye as cO,Rye as cP,Yl as cQ,al as cR,At as cS,qo as cT,Ik as cU,mk as cV,Mye as cW,Iye as cX,Dt as cY,tf as cZ,hme as c_,Qv as ca,ws as cb,HM as cc,hX as cd,pX as ce,W2 as cf,Z2 as cg,zQ as ch,eB as ci,Eye as cj,K as ck,Uu as cl,E as cm,U as cn,ct as co,wye as cp,Sye as cq,dme as cr,ge as cs,s3 as ct,nr as cu,Yr as cv,_e as cw,xd as cx,Le as cy,Gb as cz,kQ as d,c1 as e,xa as f,sI as g,nQ as h,tX as i,n0 as j,i0 as k,a0 as l,zT as m,FX as n,fI as o,u0 as p,K2 as q,D as r,U2 as s,Ho as t,uQ as u,F2 as v,OQ as w,GJ as x,vf as y,Xv as z};
//# sourceMappingURL=index-B_dt6Md6.js.map
